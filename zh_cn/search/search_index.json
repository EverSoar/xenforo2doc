{"config":{"lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"\u5165\u95e8\u987b\u77e5 \u00b6 \u6b22\u8fce\u4f7f\u7528 XenForo 2\uff01 \u672c\u6587\u6863\u65e8\u5728\u5e2e\u52a9\u60a8\u5f00\u59cb XenForo 2.0 \u5f00\u53d1\u3002 \u672c\u6587\u6863\u7684\u524d\u63d0\u6761\u4ef6\u5047\u8bbe\u60a8\u5df2\u719f\u6089 PHP \u548c MySQL\u3002 \u5e76\u975e\u4e00\u5b9a\u8981\u62e5\u6709 XenForo \u4ee5\u524d\u7248\u672c\u7684\u7ecf\u9a8c\uff0c\u4f46\u8fd9\u5c06\u662f\u4e00\u4e2a\u4f18\u52bf\u3002 \u5728\u63a5\u4e0b\u6765\u7684\u9875\u9762\u4e2d\uff0c\u6211\u4eec\u5c06\u5411\u60a8\u7b80\u8981\u4ecb\u7ecd\u5982\u4f55\u8bbe\u7f6e\u672c\u5730\u670d\u52a1\u5668\uff0c\u51c6\u5907\u5b89\u88c5\uff0c\u5168\u65b0\u5b89\u88c5 XenForo 2.0 \u4ee5\u53ca\u8fd0\u884c XF2 \u5f00\u53d1\u7684\u4e00\u4e9b\u6982\u5ff5\u3002 \u5f00\u53d1\u4eba\u5458\u6709\u4ec0\u9ebd\u65b0\u529f\u80fd\uff1f \u00b6 \u5c3d\u7ba1 XenForo 2.0 \u4e3a\u60a8\u7684\u8bba\u575b\u53ca\u5176\u6210\u5458\u589e\u52a0\u4e86\u8bb8\u591a\u6539\u8fdb\uff0c\u4f46\u6211\u4eec\u4ecd\u6295\u5165\u4e86\u5927\u91cf\u7cbe\u529b\u6765\u6539\u8fdb XenForo \u7684\u5e95\u5c42\u6846\u67b6\u3002 \u60a8\u53ef\u4ee5\u5728\u4ee5\u4e0b\u5e16\u5b50\u4e2d\u9605\u8bfb\u66f4\u591a\u5173\u4e8e\u8fd9\u4e9b\u66f4\u6539\u7684\u66f4\u591a\u4fe1\u606f\uff1a XenForo 2 \u4e2d\u7684\u5f00\u53d1\u4eba\u5458\u65b0\u529f\u80fd\uff08\u7b2c1\u90e8\u5206\uff09 XenForo 2 \u5f00\u53d1\u4eba\u5458\u7684\u6dfb\u52a0\u529f\u80fd\uff08\u7b2c2\u90e8\u5206\uff09 \u5165\u95e8\u987b\u77e5 \u00b6 XF \u5f00\u53d1\u5165\u95e8\u5f88\u5bb9\u6613\u3002 \u60a8\u53ea\u9700\u8981\u4e0b\u8f7d\u6587\u4ef6\uff0c\u5c06\u5b83\u4eec\u4e0a\u4f20\u5230 Web \u670d\u52a1\u5668\u5e76\u89e6\u53d1\u5b89\u88c5\u5373\u53ef\u3002 \u5982\u679c\u4f60\u8fd8\u6ca1\u6709 Web \u670d\u52a1\u5668\uff0c\u4e0d\u7528\u62c5\u5fc3\uff0c\u4f60\u53ef\u4ee5\u5728\u672c\u5730\u7aef\u7535\u8111\u4e0a\u8bbe\u7f6e\u4e00\u4e2a\u3002 \u4e0b\u8f7d XF 2.0 \u00b6 \u8981\u4e0b\u8f7d XF 2.0\uff0c\u53ea\u9700\u8bbf\u95ee \u5ba2\u6237\u533a \u5e76\u6b63\u5e38\u767b\u5f55\u5373\u53ef\u3002 \u627e\u5230\u6b63\u786e\u7684\u8bb8\u53ef\u8bc1\uff0c\u7136\u540e\u5358\u51fb \"\u4e0b\u8f7d XenForo\" \u94fe\u63a5\u3002 \u9009\u62e9\u60a8\u8981\u4e0b\u8f7d\u7684\u7248\u672c\uff0c\u5957\u4ef6\u7c7b\u578b\u5e76\u63a5\u53d7\u8bb8\u53ef\u534f\u8bae\u3002 \u6700\u540e\uff0c\u5358\u51fb\u4e0b\u8f7d\u6309\u94ae\u4ee5\u4e0b\u8f7d\u6587\u4ef6\u3002 XF 2.0 \u73af\u5883\u8981\u6c42 \u00b6 \u4ece XF 1.5 \u5f00\u59cb\uff0c\u8fd0\u884c XF 2.0 \u7684\u73af\u5883\u8981\u6c42\u5df2\u66f4\u6539\u3002\u5efa\u8bae\u7684\u73af\u5883\u8981\u6c42\u5982\u4e0b\uff1a PHP: 5.4.0+ \u4ee5\u4e0a MySQL: 5.5+ \u4ee5\u4e0a PHP \u6269\u5145\u5957\u4ef6: MySQLi\uff0cGD (\u652f\u6301 JPEG)\uff0cPCRE\uff0cSPL\uff0cSimpleXML\uff0cDOM\uff0cJSON\uff0ciconv\uff0cctype\uff0ccURL \u4e0b\u8f7d\u73af\u5883\u8981\u6c42\u6d4b\u8bd5\u811a\u672c\u3002 \u8bbe\u7f6e\u672c\u5730\u670d\u52a1\u5668 \u00b6 \u8bbe\u7f6e\u7528\u4e8e\u5f00\u53d1\u7684\u672c\u5730 Web \u670d\u52a1\u5668\u901a\u5e38\u66f4\u65b9\u4fbf\u3002 \u901a\u5e38\u6709\u4e24\u79cd\u65b9\u6cd5\u53ef\u4ee5\u89e3\u51b3\u6b64\u95ee\u9898\uff1a \u81ea\u5df1\u5b89\u88c5 Apache\uff08\u6216 nginx \uff09\uff0cMySQL\uff08\u6216 MariaDB \uff09\u548c PHP\u3002 \u5b89\u88c5\u9884\u6784\u5efa\u7684\u865a\u62df\u673a \u5b89\u88c5\u9884\u6784\u5efa\u7684 Stack\u3002 \u81ea\u5df1\u8fdb\u884c\u8bbe\u7f6e\u6bd4\u8f83\u590d\u6742\uff0c\u4f46\u5f80\u5f80\u53ef\u4ee5\u8ba9\u60a8\u66f4\u597d\u5730\u63a7\u5236\u6240\u6709\u8bbe\u7f6e\u3002 \u9884\u5148\u6784\u5efa\u7684\u865a\u62df\u673a \u00b6 \u7f51\u7edc\u4e0a\u6709\u591a\u79cd\u9884\u6784\u5efa\u7684\u865a\u62df\u673a\uff0c\u8fd9\u4e9b\u865a\u62df\u673a\u7684\u4f18\u52bf\u5728\u4e8e\uff0c\u5c06\u6240\u9700\u7684\u6240\u6709\u670d\u52a1\u4ee5\u6574\u9f50\u7684\u65b9\u5f0f\u6253\u5305\u5230\u4e00\u4e2a\u5730\u65b9\u5373\u53ef\u8fd0\u884c XenForo\uff0c\u800c\u4e0d\u5fc5\u76f4\u63a5\u5728\u81ea\u5df1\u7684\u8ba1\u7b97\u673a\u4e0a\u5b89\u88c5\u548c\u7ef4\u62a4\u5b83\u4eec\u3002 \u4e00\u4e9b XenForo \u5f00\u53d1\u4eba\u5458\u4f7f\u7528\u540d\u4e3a Scotch Box \u7684\u865a\u62df\u673a\uff0c\u5b83\u5305\u542b\u4e86\u8fd0\u884c XenForo \u6240\u9700\u7684\u4e00\u5207\uff0c\u65e0\u9700\u4efb\u4f55\u914d\u7f6e\u3002 \u6211\u4eec\u6709\u9010\u6b65\u5b89\u88c5\u548c\u8fd0\u884c XenForo \u5f00\u53d1\u670d\u52a1\u5668\u7684 \u9010\u6b65\u6307\u5357 - \u60a8\u53ef\u4ee5\u901a\u8fc7\u8fd0\u884c\u4e00\u4e9b\u547d\u4ee4\uff0c\u5728\u77ed\u77ed\u51e0\u5206\u953a\u5185\u5c31\u4f7f\u865a\u62df\u7f51\u7edc\u548c\u6570\u636e\u5e93\u670d\u52a1\u5668\u6b63\u5e38\u8fd0\u884c\u3002 \u5b89\u88c5\u7528\u4e8e XenForo \u7684 Scotch Box \u865a\u62df\u673a \u9884\u6784\u5efa Stack \u00b6 \u90a3\u91cc\u6709\u8bb8\u591a\u9884\u6784\u5efa Stack\uff0c\u5b83\u4eec\u5728\u529f\u80fd\u96c6\uff0c\u6027\u80fd\u548c\u53ef\u9760\u6027\u65b9\u9762\u53ef\u80fd\u4f1a\u6709\u6240\u4e0d\u540c\u3002Bitnami \u7ef4\u62a4\u8bb8\u591a Stack\uff0c\u5305\u62ec\u5206\u522b\u7528\u4e8e Linux\uff0cMac \u548c Windows \u7684 LAMP , MAMP \u548c WAMP Stacks\u3002 \u5b83\u4eec\u90fd\u5305\u62ec\u5bf9 Apache\uff0cMySQL \u548c PHP \u7684\u5b8c\u5168\u914d\u7f6e\u5b89\u88c5\uff0c\u5e76\u5305\u62ec\u7528\u4e8e\u7ba1\u7406 MySQL \u7684 PhPMyAdmin\u3002 \u4e0a\u4f20 \u00b6 \u8981\u5b89\u88c5 XF 2.0\uff0c\u60a8\u53ea\u9700\u8981\u63d0\u53d6\u4ece\u5ba2\u6237\u533a\u4e0b\u8f7d\u7684 ZIP \u6587\u4ef6\u5e76\u4e0a\u4f20\u5176\u4e2d\u7684\u4e00\u4e9b\u6587\u4ef6\u548c\u76ee\u5f55\u3002 \u89e3\u538b\u7f29\u540e\uff0c\u60a8\u4f1a\u770b\u5230\u4e00\u4e2a\u540d\u4e3a upload \u7684\u76ee\u5f55\u3002 \u60a8\u9700\u8981\u8fdb\u5165\u8be5\u76ee\u5f55\uff0c\u7136\u540e\u5c06\u6587\u4ef6\u548c\u76ee\u5f55\u4e0a\u8f7d\u5230\u4f60\u670d\u52a1\u5668\u7684 Web \u6839\u76ee\u5f55\u3002 \u8fd9\u901a\u5e38\u4f1a\u5728\u4e00\u4e2a\u540d\u4e3a public_html , htdocs \u6216 www \u7684\u76ee\u5f55\u3002 \u521b\u5efa src/config.php \u00b6 \u5982\u679c\u4f7f\u7528 CLI \u5b89\u88c5 XF 2.0\uff0c\u5219\u9700\u8981\u624b\u52a8\u521b\u5efa config.php \u6587\u4ef6\u3002 \u8981\u505a\u5230\u8fd9\u4e00\u70b9\uff0c\u8bf7\u5728\u60a8\u4e0a\u8f7d\u5230\u670d\u52a1\u5668\u7684 XF 2.0 \u6587\u4ef6\u4e2d\u8f93\u5165 src \u76ee\u5f55\u3002 \u521b\u5efa\u4e00\u4e2a\u540d\u4e3a config.php \u7684\u65b0\u6587\u4ef6\uff0c\u5e76\u586b\u5165\u4f60\u7684 MySQL \u670d\u52a1\u5668\u7684\u4e3b\u673a\uff0c\u7aef\u53e3\uff0c\u7528\u6237\u540d\uff0c\u5bc6\u7801\u548c\u6570\u636e\u5e93\u540d\u79f0\u3002 Note \u786e\u4fdd\u5728 src \u76ee\u5f55\u4e2d\u521b\u5efa\u914d\u7f6e\u6587\u4ef6\u3002 \u8be5 library \u76ee\u5f55\u4ec5\u7528\u4e8e\u65e7\u7248\u76ee\u7684\u3002 \u5b8c\u6210\u540e\uff0c\u5b83\u5e94\u5982\u4e0b\u6240\u793a\uff1a <?php $config['db']['host'] = 'localhost'; $config['db']['port'] = '3306'; $config['db']['username'] = 'root'; $config['db']['password'] = 'mypassword'; $config['db']['dbname'] = 'xf2'; \u60a8\u73b0\u5728\u53ef\u4ee5\u5b89\u88c5\u4e86\uff01 \u5982\u679c\u60a8\u4f7f\u7528\u7684\u662f MySQL 5.5 \u53ca\u4ee5\u4e0a\u7248\u672c\uff0c\u5e76\u4e14\u5e0c\u671b\u83b7\u5f97\u5b8c\u6574\u7684 unicode \u652f\u6301\uff08\u4f8b\u5982 emoji \u8868\u60c5\uff09\uff0c\u5219\u8fd8\u5e94\u8be5\u5728\u5b89\u88c5\u524d\u6dfb\u52a0\u4ee5\u4e0b\u5185\u5bb9\uff1a $config['fullUnicode'] = true; \u5173\u4e8e\u6587\u4ef6\u6743\u9650\u8bf4\u660e \u00b6 XenForo \u5728\u8fd0\u884c\u65f6\u9700\u8981\u5c06\u6587\u4ef6\u5199\u5165\u7279\u5b9a\u4f4d\u7f6e\u3002 \u5728\u6b63\u5e38\u64cd\u4f5c\u4e2d\uff0c\u8fd9\u4ec5\u9650\u4e8e data \u548c internal_data \u76ee\u5f55\uff08\u53ca\u5176\u5b50\u76ee\u5f55\uff09\u3002 \u8fd9\u4e9b\u6587\u4ef6\u5199\u5165\u5c06\u7531\u9644\u4ef6\u4e0a\u4f20\u4e4b\u7c7b\u7684\u4e1c\u897f\u89e6\u53d1\uff0c\u56e0\u6b64\u5b83\u4eec\u901a\u5e38\u5c06\u7531\u7528\u6237 PHP \u8c61\u5728 Web \u670d\u52a1\u5668\u4e2d\u4e00\u6837\u8fd0\u884c\u6765\u89e6\u53d1\u3002 \u56e0\u6b64\uff0c\u5fc5\u987b\u786e\u4fdd\u5728\u8fd9\u4e9b\u76ee\u5f55\u4e2d\u8bbe\u7f6e\u4e86\u6743\u9650\uff0c\u4ee5\u4fbf Web \u4f3a\u52a1\u5668\u53ef\u4ee5\u5bf9\u5176\u8fdb\u884c\u5199\u5165\u3002 \u60a8\u5fc5\u987b\u5148\u8fd0\u884c\u6b64\u64cd\u4f5c\uff0c\u7136\u540e\u624d\u80fd\u5f00\u59cb\u5b89\u88c5\u3002 \u5f53\u6d89\u53ca\u5230 CLI \u65f6\uff0c\u8fd9\u79cd\u60c5\u51b5\u53d8\u5f97\u66f4\u52a0\u68d8\u624b\uff0c\u56e0\u4e3a\u73b0\u5728\u53ef\u80fd\u6709\u4e24\u4e2a\u7528\u6237\u9700\u8981\u80fd\u591f\u5199\u5165\u6587\u4ef6\u3002 \u56e0\u6b64\uff0c\u91c7\u53d6\u63aa\u65bd\u907f\u514d\u5199\u5165\u8fd9\u4e9b\u6587\u4ef6\u7684\u95ee\u9898\u5f88\u91cd\u8981\u3002 \u8fd9\u91cc\u6709\u51e0\u4e2a\u9009\u62e9\u3002 \u5728 CLI \u548c Web \u670d\u52a1\u5668\u4f7f\u7528\u76f8\u540c\u7684\u7528\u6237\u3002 \u8fd9\u53ef\u4ee5\u91c7\u53d6\u4ee5\u4e0b\u5f62\u5f0f\uff1a\u5728\u8fd0\u884c\u4efb\u4f55\u5b89\u88c5\u6216\u5347\u7ea7\u547d\u4ee4\uff08\u6216\u4efb\u4f55\u5176\u4ed6\u5c06\u5199\u5165\u6587\u4ef6\u7684\u547d\u4ee4\uff09\u4e4b\u524d\u5207\u6362\u5230 Web \u670d\u52a1\u5668\u7528\u6237\u3002 \u5982\u679c\u53ef\u7528\uff0c\u8bf7\u8003\u8651\u5c06 ACL \u5e94\u7528\u4e8e data \u548c internal_data \u76ee\u5f55\u4e2d\u3002 \u8be5\u6982\u5ff5\u56e0\u64cd\u4f5c\u7cfb\u7edf\u548c\u914d\u7f6e\u800c\u5f02\uff0c\u4f46 \u6b64\u5904 \u63cf\u8ff0\u7684\u662f\u603b\u4f53\u601d\u8def\u3002 \u5bf9 PHP \u5199\u5165\u7684\u5185\u5bb9\u5f3a\u5236\u6388\u4e88\u7279\u5b9a\u7684\u6743\u9650\u3002 \u8fd9\u53ef\u4ee5\u901a\u8fc7 src / config.php \u6587\u4ef6\u4e2d\u5e2f\u6709\u5982\u4e0b\u4e00\u884c\u7684\u4ee3\u7801\u6765\u5b8c\u6210\uff1a $config['chmodWritableValue'] = 0666; \u8fd9\u79cd\u65b9\u6cd5\u5bf9\u4e8e\u5f00\u53d1\u76ee\u7684\u6765\u8bf4\u53ef\u80fd\u662f\u6700\u7b80\u5358\u7684\u3002 \u8bf7\u6ce8\u610f\uff0c\u5982\u679c\u60a8\u6b63\u5728\u5f00\u53d1\u9644\u52a0\u7ec4\u4ef6\uff0c\u5219\u53ef\u80fd\u4f1a\u6709\u5176\u4ed6\u9700\u8981\u7531 CLI \u548c Web \u670d\u52a1\u5668\u7528\u6237\u5199\u5165\u7684\u4f4d\u7f6e\u3002 \u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0c\u8fd9\u5305\u62ec\u9644\u52a0\u7ec4\u4ef6\u4e2d\u7684 _output \u76ee\u5f55\u3002 \u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u4ee5\u60a8\u7684 CLI \u7528\u6237\u8eab\u5206\u8fd0\u884c Web \u670d\u52a1\u5668\u53ef\u80fd\u4f1a\u51cf\u5c11\u6469\u64e6\u3002 \u5982\u679c\u60a8\u91c7\u7528\u5176\u4ed6\u4efb\u4f55\u65b9\u6cd5\uff0c\u5219\u53ef\u80fd\u9700\u8981\u786e\u4fdd\u60a8\u7684 Web \u670d\u52a1\u5668\u53ef\u4ee5\u5199\u5165\u6574\u4e2a XenForo \u5b89\u88c5\uff1b\u5728\u751f\u4ea7\u4e2d\u4e0d\u5efa\u8bae\u8fd9\u6837\u505a\u3002 \u5b89\u88c5 \u00b6 \u5f53\u524d\u5b89\u88c5 XF 2.0 \u7684\u65b9\u5f0f\u662f\u901a\u8fc7\u65b0\u7684 CLI \u7cfb\u7edf\u3002 \u8bb8\u591a\u5f00\u53d1\u8fc7\u7a0b\u53ea\u80fd\u4f7f\u7528 CLI \u6765\u8fdb\u884c\uff0c\u6240\u4ee5\u6211\u4eec\u5c31\u6765\u4f7f\u7528\u5b83\u6765\u5b89\u88c5 XF 2.0\u3002 \u8981\u8fd0\u884c\u8fd9\u4e9b\u547d\u4ee4\uff0c\u60a8\u5c06\u9700\u8981\u8bbf\u95ee \u7ec8\u7aef/shell\uff0c\u4f7f\u7528 php CLI \u547d\u4ee4\u548c\u5f53\u524d\u5de5\u4f5c\u76ee\u5f55\u5e94\u8be5\u662f\u60a8\u4e0a\u4f20 XF 2.0 \u6587\u4ef6\u7684\u6839\u76ee\u5f55\u3002 Warning \u4e3a\u6d88\u9664\u6587\u4ef6\u6743\u9650\u95ee\u9898\uff0c\u6211\u4eec\u5efa\u8bae\u4ee5\u4e0e PHP \u5728 web \u670d\u52a1\u5668\u4e0a\u8fd0\u884c\u7684\u76f8\u540c\u7528\u6237\u6765\u8fd0\u884c\u5b89\u88c5\u7a0b\u5e8f\u3002 \u5982\u679c\u4e0d\u8fd9\u6837\u505a\uff0c\u5219\u5e94\u8be5\u91c7\u53d6\u63aa\u65bd\u786e\u4fdd\u6743\u9650\u8bbe\u7f6e\u6b63\u786e\u3002 \u6709\u5173\u66f4\u591a\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u89c1\u4e0a\u9762\u7684\u7ae0\u8282\u3002 \u8981\u5f00\u59cb\u5b89\u88c5\uff0c\u53ea\u9700\u8f93\u5165\u4ee5\u4e0b\u547d\u4ee4\uff1a Terminal $ php cmd.php xf:install \u60a8\u4f1a\u88ab\u95ee\u5230\u8bb8\u591a\u95ee\u9898\uff0c\u4f8b\u5982\u521d\u59cb\u7ba1\u7406\u5458\u7528\u6237\u540d\u548c\u5bc6\u7801\uff0c\u677f\u5757\u6807\u9898\u3002 \u6b64\u540e\uff0c\u5c06\u5bfc\u5165 XF 2.0 \u6570\u636e\u5e93\u8868\u548c\u4e3b\u8981\u7684\u6570\u636e\u3002 XF 2.0 \u73b0\u5728\u5df2\u5b89\u88c5\u5b8c\u6210\uff01 \u91cd\u65b0\u5b89\u88c5 \u00b6 \u6709\u65f6\u53ef\u80fd\u9700\u8981\u91cd\u65b0\u5b89\u88c5 XF2\u3002 \u5728\u4e0d\u652f\u6301\u5347\u7ea7\u7684 \"\u5f00\u53d1\u9884\u89c8\" \u9636\u6bb5\u5c24\u5176\u5982\u6b64\u3002 \u5982\u679c\u51c6\u5907\u597d\u91cd\u65b0\u5b89\u88c5\uff0c\u8bf7\u6309\u7167\u4e0a\u9762\u7684 \u4e0b\u8f7d XF 2.0 \u90e8\u5206\u4e0b\u8f7d\u65b0\u6587\u4ef6\uff08\u5982\u679c\u9002\u7528\uff09\u3002 \u4e00\u822c\u6765\u8bf4\uff0c\u5e94\u8be5\u53ef\u4ee5\u5408\u5e76\u548c\u590d\u76d6\u73b0\u6709\u6587\u4ef6\u3002 \u5982\u679c\u8981\u8fdb\u884c\u5b8c\u5168\u5e72\u51c0\u7684\u91cd\u65b0\u5b89\u88c5\uff0c\u5219\u53ef\u80fd\u9700\u8981\u4fdd\u5b58 config.php \u6587\u4ef6\u7684\u526f\u672c\uff0c\u6216\u8005\u6309\u7167 \u521b\u5efa src/config.php \u4e2d\u7684\u8bf4\u660e\u91cd\u65b0\u521b\u5efa\u5b83\u3002 \u5728\u4e0a\u4f20\u65b0\u6587\u4ef6\u4e4b\u524d\uff0c\u60a8\u5e94\u8be5\u5220\u9664 data \u548c internal_data \u76ee\u5f55\u7684\u5185\u5bb9\u3002 \u6700\u540e\uff0c\u60a8\u53ea\u9700\u8981\u5f00\u59cb\u5b89\u88c5\u5373\u53ef\uff0c\u4e0e\u4e0a\u9762\u7c7b\u4f3c\u3002 \u60a8\u5c06\u9700\u8981\u4f7f\u7528\u6b64 --clear \u9009\u9879\u6765\u5220\u9664\u6240\u6709\u73b0\u6709\u7684 xf_ \u8d44\u6599\u8868\u3002 Terminal $ php cmd.php xf:install --clear \u91cd\u65b0\u5b89\u88c5\u5b8c\u6210\u540e\uff0c\u60a8\u73b0\u5728\u5e94\u8be5\u53ef\u4ee5\u91cd\u65b0\u767b\u5f55\u4e86\u3002 \u5982\u679c\u60a8\u6b63\u5728\u5f00\u53d1\u9644\u52a0\u7ec4\u4ef6\uff0c\u5e76\u4e14\u9009\u62e9\u4fdd\u7559\u6216\u5907\u4efd\u73b0\u6709 src/addons \u76ee\u5f55\uff0c\u5219\u53ef\u4ee5\u4f7f\u7528 \u5bfc\u5165\u5f00\u53d1\u8f93\u51fa \u547d\u4ee4\u6765\u8fd8\u539f\u9644\u52a0\u7ec4\u4ef6\u6570\u636e\u3002 Warning \u5982\u679c\u9009\u62e9\u5907\u4efd\u548c\u8fd8\u539f src/addons \u76ee\u5f55\uff0c\u8bf7\u5c0f\u5fc3\u3002 \u5176\u4e2d\u7684 XF \u76ee\u5f55\u5305\u542b XF \u4e3b\u8981\u7684\u6570\u636e\uff0c\u56e0\u6b64\u4e0d\u5e94\u4ece\u5907\u4efd\u4e2d\u8fd8\u539f\uff0c\u4ee5\u786e\u4fdd\u60a8\u59cb\u7ec8\u62e5\u6709\u6700\u65b0\u7248\u672c\u7684\u6587\u4ef6\u3002 \u4ee5\u8fd9\u79cd\u65b9\u5f0f\u8fd0\u884c\u91cd\u65b0\u5b89\u88c5\u662f\u7834\u574f\u6027\u7684\u64cd\u4f5c\uff0c\u5b83\u5c06\u5220\u9664\u60a8\u521b\u5efa\u7684\u6240\u6709\u6570\u636e\u3002 \u6b64\u5916\uff0c\u8bf7\u8bb0\u4f4f\uff0c\u4ec5\u5e2f\u6709 xf_ \u524d\u7f00\u7684\u8d44\u6599\u8868\u624d\u4f1a\u88ab\u6e05\u9664\u3002 \u8fd9\u4e5f\u662f\u5efa\u8bae\u6240\u6709\u8d44\u6599\u8868\uff08\u751a\u81f3\u662f\u9644\u52a0\u7ec4\u4ef6\uff09\u90fd\u5e94\u8be5\u4ee5 xf_ \u4e3a\u524d\u7f00\u7684\u4e00\u4e2a\u91cd\u8981\u539f\u56e0\u3002 \u9a8c\u8bc1\u6587\u4ef6\u5b8c\u6574\u6027 \u00b6 \u5f53\u60a8\u5b89\u88c5 XF2 \u65f6\uff0c\u6211\u4eec\u4f1a\u5728\u5b89\u88c5\u8fc7\u7a0b\u4e2d\u8fd0\u884c\u6587\u4ef6\u5b8c\u6574\u6027\u68c0\u67e5\u3002 \u5982\u6709\u5fc5\u8981\uff0c\u5e76\u4e14\u60a8\u65e0\u6cd5\u901a\u8fc7 Admin CP \u4e2d\u7684\u9875\u9762\u8fd0\u884c\u68c0\u67e5\uff0c\u5219\u53ef\u4ee5\u8fd0\u884c CLI \u547d\u4ee4\u6765\u8fd0\u884c\u8be5\u68c0\u67e5\u3002 Terminal $ php cmd.php xf:file-check [addon_id] \u5982\u679c\u60a8\u5e0c\u671b\u5bf9\u6240\u6709\u6587\u4ef6\uff08\u5305\u62ec XF \u672c\u8eab\uff09\u8fdb\u884c\u6587\u4ef6\u8fd0\u884c\u5065\u5eb7\u68c0\u67e5\uff0c\u53ea\u9700\u7701\u7565 [addon_id] \u53c2\u6570\u5373\u53ef\u3002 \u4ec5\u5bf9\u4e8e XF\uff0c\u4ec5\u4f7f\u7528 XF \u4ee3\u66ff\u8be5\u53c2\u6570\uff0c\u6216\u8005\u5bf9\u4e8e\u7279\u5b9a\u7684\u9644\u52a0\u7ec4\u4ef6\uff0c\u53ea\u9700\u6307\u5b9a\u60a8\u8981\u68c0\u67e5\u7684\u9644\u52a0\u7ec4\u4ef6 ID\u3002 Add-on \u7ba1\u7406\u547d\u4ee4 \u00b6 \u9664\u4e86\u4e0a\u8ff0\u7528\u4e8e\u5b89\u88c5 XF2 \u7684\u547d\u4ee4\u4e4b\u5916\uff0c\u8fd8\u6709\u4e00\u4e9b\u7528\u4e8e\u7ba1\u7406\u9644\u52a0\u7ec4\u4ef6\u7684\u547d\u4ee4\u3002 \u5b89\u88c5 \u00b6 Terminal $ php cmd.php xf:addon-install [addon_id] \u5b89\u88c5\u6307\u5b9a\u7684\u9644\u52a0\u7ec4\u4ef6\uff0c\u53ea\u8981\u5b83\u662f\u53ef\u7528\u7684\uff0c\u5e76\u901a\u8fc7\u6587\u4ef6\u8fd0\u884c\u5065\u5eb7\u68c0\u67e5\u3002 \u5982\u679c\u6709\u53ef\u7528\u7684\u5f00\u53d1\u8f93\u51fa\uff0c\u60a8\u5c06\u88ab\u8981\u6c42\u786e\u8ba4\u662f\u5426\u8981\u5c06\u5176\u7528\u4e8e\u5b89\u88c5\uff0c\u800c\u4e0d\u662f\u5bfc\u51fa\u7684\u6570\u636e XML \u6587\u4ef6\u3002 \u5347\u7ea7 \u00b6 Terminal $ php cmd.php xf:addon-upgrade [addon_id] \u53ea\u8981\u6307\u5b9a\u7684\u9644\u52a0\u7ec4\u4ef6\u662f\u53ef\u5347\u7ea7\u7684\uff0c\u5c31\u5bf9\u5176\u8fdb\u884c\u5347\u7ea7\uff0c\u5e76\u901a\u8fc7\u6587\u4ef6\u8fd0\u884c\u5065\u5eb7\u68c0\u67e5\u3002 \u53ef\u4ee5\u9009\u62e9\u4ece\u5f00\u53d1\u8f93\u51fa\u4e2d\u8fdb\u884c\u5bfc\u5165\u3002 \u91cd\u5efa \u00b6 Terminal $ php cmd.php xf:addon-rebuild [addon_id] \u53ea\u8981\u6307\u5b9a\u7684\u9644\u52a0\u7ec4\u4ef6\u662f\u53ef\u91cd\u5efa\u7684\uff0c\u5c31\u4e3a\u5176\u91cd\u5efa\u4e3b\u8981\u7684\u6570\u636e\uff0c\u5e76\u901a\u8fc7\u6587\u4ef6\u8fd0\u884c\u5065\u5eb7\u68c0\u67e5\u3002 \u8fd9\u5c06\u91cd\u65b0\u5bfc\u5165\u9644\u52a0\u7ec4\u4ef6\u7684\u6570\u636e\u3002 \u53ef\u4ee5\u9009\u62e9\u6027\u5730\u8fd0\u884c\u4ece\u5f00\u53d1\u8f93\u51fa\u4e2d\u5bfc\u5165\u3002 \u5378\u8f7d \u00b6 Terminal $ php cmd.php xf:addon-uninstall [addon_id] \u5378\u8f7d\u6307\u5b9a\u7684\u9644\u52a0\u7ec4\u4ef6\uff0c\u53ea\u8981\u5b83\u662f\u4e0d\u53ef\u5378\u8f7d\u7684\u3002","title":"\u5165\u95e8\u987b\u77e5"},{"location":"#_1","text":"\u6b22\u8fce\u4f7f\u7528 XenForo 2\uff01 \u672c\u6587\u6863\u65e8\u5728\u5e2e\u52a9\u60a8\u5f00\u59cb XenForo 2.0 \u5f00\u53d1\u3002 \u672c\u6587\u6863\u7684\u524d\u63d0\u6761\u4ef6\u5047\u8bbe\u60a8\u5df2\u719f\u6089 PHP \u548c MySQL\u3002 \u5e76\u975e\u4e00\u5b9a\u8981\u62e5\u6709 XenForo \u4ee5\u524d\u7248\u672c\u7684\u7ecf\u9a8c\uff0c\u4f46\u8fd9\u5c06\u662f\u4e00\u4e2a\u4f18\u52bf\u3002 \u5728\u63a5\u4e0b\u6765\u7684\u9875\u9762\u4e2d\uff0c\u6211\u4eec\u5c06\u5411\u60a8\u7b80\u8981\u4ecb\u7ecd\u5982\u4f55\u8bbe\u7f6e\u672c\u5730\u670d\u52a1\u5668\uff0c\u51c6\u5907\u5b89\u88c5\uff0c\u5168\u65b0\u5b89\u88c5 XenForo 2.0 \u4ee5\u53ca\u8fd0\u884c XF2 \u5f00\u53d1\u7684\u4e00\u4e9b\u6982\u5ff5\u3002","title":"\u5165\u95e8\u987b\u77e5"},{"location":"#_2","text":"\u5c3d\u7ba1 XenForo 2.0 \u4e3a\u60a8\u7684\u8bba\u575b\u53ca\u5176\u6210\u5458\u589e\u52a0\u4e86\u8bb8\u591a\u6539\u8fdb\uff0c\u4f46\u6211\u4eec\u4ecd\u6295\u5165\u4e86\u5927\u91cf\u7cbe\u529b\u6765\u6539\u8fdb XenForo \u7684\u5e95\u5c42\u6846\u67b6\u3002 \u60a8\u53ef\u4ee5\u5728\u4ee5\u4e0b\u5e16\u5b50\u4e2d\u9605\u8bfb\u66f4\u591a\u5173\u4e8e\u8fd9\u4e9b\u66f4\u6539\u7684\u66f4\u591a\u4fe1\u606f\uff1a XenForo 2 \u4e2d\u7684\u5f00\u53d1\u4eba\u5458\u65b0\u529f\u80fd\uff08\u7b2c1\u90e8\u5206\uff09 XenForo 2 \u5f00\u53d1\u4eba\u5458\u7684\u6dfb\u52a0\u529f\u80fd\uff08\u7b2c2\u90e8\u5206\uff09","title":"\u5f00\u53d1\u4eba\u5458\u6709\u4ec0\u9ebd\u65b0\u529f\u80fd\uff1f"},{"location":"#_3","text":"XF \u5f00\u53d1\u5165\u95e8\u5f88\u5bb9\u6613\u3002 \u60a8\u53ea\u9700\u8981\u4e0b\u8f7d\u6587\u4ef6\uff0c\u5c06\u5b83\u4eec\u4e0a\u4f20\u5230 Web \u670d\u52a1\u5668\u5e76\u89e6\u53d1\u5b89\u88c5\u5373\u53ef\u3002 \u5982\u679c\u4f60\u8fd8\u6ca1\u6709 Web \u670d\u52a1\u5668\uff0c\u4e0d\u7528\u62c5\u5fc3\uff0c\u4f60\u53ef\u4ee5\u5728\u672c\u5730\u7aef\u7535\u8111\u4e0a\u8bbe\u7f6e\u4e00\u4e2a\u3002","title":"\u5165\u95e8\u987b\u77e5"},{"location":"#xf-20","text":"\u8981\u4e0b\u8f7d XF 2.0\uff0c\u53ea\u9700\u8bbf\u95ee \u5ba2\u6237\u533a \u5e76\u6b63\u5e38\u767b\u5f55\u5373\u53ef\u3002 \u627e\u5230\u6b63\u786e\u7684\u8bb8\u53ef\u8bc1\uff0c\u7136\u540e\u5358\u51fb \"\u4e0b\u8f7d XenForo\" \u94fe\u63a5\u3002 \u9009\u62e9\u60a8\u8981\u4e0b\u8f7d\u7684\u7248\u672c\uff0c\u5957\u4ef6\u7c7b\u578b\u5e76\u63a5\u53d7\u8bb8\u53ef\u534f\u8bae\u3002 \u6700\u540e\uff0c\u5358\u51fb\u4e0b\u8f7d\u6309\u94ae\u4ee5\u4e0b\u8f7d\u6587\u4ef6\u3002","title":"\u4e0b\u8f7d XF 2.0"},{"location":"#xf-20_1","text":"\u4ece XF 1.5 \u5f00\u59cb\uff0c\u8fd0\u884c XF 2.0 \u7684\u73af\u5883\u8981\u6c42\u5df2\u66f4\u6539\u3002\u5efa\u8bae\u7684\u73af\u5883\u8981\u6c42\u5982\u4e0b\uff1a PHP: 5.4.0+ \u4ee5\u4e0a MySQL: 5.5+ \u4ee5\u4e0a PHP \u6269\u5145\u5957\u4ef6: MySQLi\uff0cGD (\u652f\u6301 JPEG)\uff0cPCRE\uff0cSPL\uff0cSimpleXML\uff0cDOM\uff0cJSON\uff0ciconv\uff0cctype\uff0ccURL \u4e0b\u8f7d\u73af\u5883\u8981\u6c42\u6d4b\u8bd5\u811a\u672c\u3002","title":"XF 2.0 \u73af\u5883\u8981\u6c42"},{"location":"#_4","text":"\u8bbe\u7f6e\u7528\u4e8e\u5f00\u53d1\u7684\u672c\u5730 Web \u670d\u52a1\u5668\u901a\u5e38\u66f4\u65b9\u4fbf\u3002 \u901a\u5e38\u6709\u4e24\u79cd\u65b9\u6cd5\u53ef\u4ee5\u89e3\u51b3\u6b64\u95ee\u9898\uff1a \u81ea\u5df1\u5b89\u88c5 Apache\uff08\u6216 nginx \uff09\uff0cMySQL\uff08\u6216 MariaDB \uff09\u548c PHP\u3002 \u5b89\u88c5\u9884\u6784\u5efa\u7684\u865a\u62df\u673a \u5b89\u88c5\u9884\u6784\u5efa\u7684 Stack\u3002 \u81ea\u5df1\u8fdb\u884c\u8bbe\u7f6e\u6bd4\u8f83\u590d\u6742\uff0c\u4f46\u5f80\u5f80\u53ef\u4ee5\u8ba9\u60a8\u66f4\u597d\u5730\u63a7\u5236\u6240\u6709\u8bbe\u7f6e\u3002","title":"\u8bbe\u7f6e\u672c\u5730\u670d\u52a1\u5668"},{"location":"#_5","text":"\u7f51\u7edc\u4e0a\u6709\u591a\u79cd\u9884\u6784\u5efa\u7684\u865a\u62df\u673a\uff0c\u8fd9\u4e9b\u865a\u62df\u673a\u7684\u4f18\u52bf\u5728\u4e8e\uff0c\u5c06\u6240\u9700\u7684\u6240\u6709\u670d\u52a1\u4ee5\u6574\u9f50\u7684\u65b9\u5f0f\u6253\u5305\u5230\u4e00\u4e2a\u5730\u65b9\u5373\u53ef\u8fd0\u884c XenForo\uff0c\u800c\u4e0d\u5fc5\u76f4\u63a5\u5728\u81ea\u5df1\u7684\u8ba1\u7b97\u673a\u4e0a\u5b89\u88c5\u548c\u7ef4\u62a4\u5b83\u4eec\u3002 \u4e00\u4e9b XenForo \u5f00\u53d1\u4eba\u5458\u4f7f\u7528\u540d\u4e3a Scotch Box \u7684\u865a\u62df\u673a\uff0c\u5b83\u5305\u542b\u4e86\u8fd0\u884c XenForo \u6240\u9700\u7684\u4e00\u5207\uff0c\u65e0\u9700\u4efb\u4f55\u914d\u7f6e\u3002 \u6211\u4eec\u6709\u9010\u6b65\u5b89\u88c5\u548c\u8fd0\u884c XenForo \u5f00\u53d1\u670d\u52a1\u5668\u7684 \u9010\u6b65\u6307\u5357 - \u60a8\u53ef\u4ee5\u901a\u8fc7\u8fd0\u884c\u4e00\u4e9b\u547d\u4ee4\uff0c\u5728\u77ed\u77ed\u51e0\u5206\u953a\u5185\u5c31\u4f7f\u865a\u62df\u7f51\u7edc\u548c\u6570\u636e\u5e93\u670d\u52a1\u5668\u6b63\u5e38\u8fd0\u884c\u3002 \u5b89\u88c5\u7528\u4e8e XenForo \u7684 Scotch Box \u865a\u62df\u673a","title":"\u9884\u5148\u6784\u5efa\u7684\u865a\u62df\u673a"},{"location":"#stack","text":"\u90a3\u91cc\u6709\u8bb8\u591a\u9884\u6784\u5efa Stack\uff0c\u5b83\u4eec\u5728\u529f\u80fd\u96c6\uff0c\u6027\u80fd\u548c\u53ef\u9760\u6027\u65b9\u9762\u53ef\u80fd\u4f1a\u6709\u6240\u4e0d\u540c\u3002Bitnami \u7ef4\u62a4\u8bb8\u591a Stack\uff0c\u5305\u62ec\u5206\u522b\u7528\u4e8e Linux\uff0cMac \u548c Windows \u7684 LAMP , MAMP \u548c WAMP Stacks\u3002 \u5b83\u4eec\u90fd\u5305\u62ec\u5bf9 Apache\uff0cMySQL \u548c PHP \u7684\u5b8c\u5168\u914d\u7f6e\u5b89\u88c5\uff0c\u5e76\u5305\u62ec\u7528\u4e8e\u7ba1\u7406 MySQL \u7684 PhPMyAdmin\u3002","title":"\u9884\u6784\u5efa Stack"},{"location":"#_6","text":"\u8981\u5b89\u88c5 XF 2.0\uff0c\u60a8\u53ea\u9700\u8981\u63d0\u53d6\u4ece\u5ba2\u6237\u533a\u4e0b\u8f7d\u7684 ZIP \u6587\u4ef6\u5e76\u4e0a\u4f20\u5176\u4e2d\u7684\u4e00\u4e9b\u6587\u4ef6\u548c\u76ee\u5f55\u3002 \u89e3\u538b\u7f29\u540e\uff0c\u60a8\u4f1a\u770b\u5230\u4e00\u4e2a\u540d\u4e3a upload \u7684\u76ee\u5f55\u3002 \u60a8\u9700\u8981\u8fdb\u5165\u8be5\u76ee\u5f55\uff0c\u7136\u540e\u5c06\u6587\u4ef6\u548c\u76ee\u5f55\u4e0a\u8f7d\u5230\u4f60\u670d\u52a1\u5668\u7684 Web \u6839\u76ee\u5f55\u3002 \u8fd9\u901a\u5e38\u4f1a\u5728\u4e00\u4e2a\u540d\u4e3a public_html , htdocs \u6216 www \u7684\u76ee\u5f55\u3002","title":"\u4e0a\u4f20"},{"location":"#srcconfigphp","text":"\u5982\u679c\u4f7f\u7528 CLI \u5b89\u88c5 XF 2.0\uff0c\u5219\u9700\u8981\u624b\u52a8\u521b\u5efa config.php \u6587\u4ef6\u3002 \u8981\u505a\u5230\u8fd9\u4e00\u70b9\uff0c\u8bf7\u5728\u60a8\u4e0a\u8f7d\u5230\u670d\u52a1\u5668\u7684 XF 2.0 \u6587\u4ef6\u4e2d\u8f93\u5165 src \u76ee\u5f55\u3002 \u521b\u5efa\u4e00\u4e2a\u540d\u4e3a config.php \u7684\u65b0\u6587\u4ef6\uff0c\u5e76\u586b\u5165\u4f60\u7684 MySQL \u670d\u52a1\u5668\u7684\u4e3b\u673a\uff0c\u7aef\u53e3\uff0c\u7528\u6237\u540d\uff0c\u5bc6\u7801\u548c\u6570\u636e\u5e93\u540d\u79f0\u3002 Note \u786e\u4fdd\u5728 src \u76ee\u5f55\u4e2d\u521b\u5efa\u914d\u7f6e\u6587\u4ef6\u3002 \u8be5 library \u76ee\u5f55\u4ec5\u7528\u4e8e\u65e7\u7248\u76ee\u7684\u3002 \u5b8c\u6210\u540e\uff0c\u5b83\u5e94\u5982\u4e0b\u6240\u793a\uff1a <?php $config['db']['host'] = 'localhost'; $config['db']['port'] = '3306'; $config['db']['username'] = 'root'; $config['db']['password'] = 'mypassword'; $config['db']['dbname'] = 'xf2'; \u60a8\u73b0\u5728\u53ef\u4ee5\u5b89\u88c5\u4e86\uff01 \u5982\u679c\u60a8\u4f7f\u7528\u7684\u662f MySQL 5.5 \u53ca\u4ee5\u4e0a\u7248\u672c\uff0c\u5e76\u4e14\u5e0c\u671b\u83b7\u5f97\u5b8c\u6574\u7684 unicode \u652f\u6301\uff08\u4f8b\u5982 emoji \u8868\u60c5\uff09\uff0c\u5219\u8fd8\u5e94\u8be5\u5728\u5b89\u88c5\u524d\u6dfb\u52a0\u4ee5\u4e0b\u5185\u5bb9\uff1a $config['fullUnicode'] = true;","title":"\u521b\u5efa src/config.php"},{"location":"#_7","text":"XenForo \u5728\u8fd0\u884c\u65f6\u9700\u8981\u5c06\u6587\u4ef6\u5199\u5165\u7279\u5b9a\u4f4d\u7f6e\u3002 \u5728\u6b63\u5e38\u64cd\u4f5c\u4e2d\uff0c\u8fd9\u4ec5\u9650\u4e8e data \u548c internal_data \u76ee\u5f55\uff08\u53ca\u5176\u5b50\u76ee\u5f55\uff09\u3002 \u8fd9\u4e9b\u6587\u4ef6\u5199\u5165\u5c06\u7531\u9644\u4ef6\u4e0a\u4f20\u4e4b\u7c7b\u7684\u4e1c\u897f\u89e6\u53d1\uff0c\u56e0\u6b64\u5b83\u4eec\u901a\u5e38\u5c06\u7531\u7528\u6237 PHP \u8c61\u5728 Web \u670d\u52a1\u5668\u4e2d\u4e00\u6837\u8fd0\u884c\u6765\u89e6\u53d1\u3002 \u56e0\u6b64\uff0c\u5fc5\u987b\u786e\u4fdd\u5728\u8fd9\u4e9b\u76ee\u5f55\u4e2d\u8bbe\u7f6e\u4e86\u6743\u9650\uff0c\u4ee5\u4fbf Web \u4f3a\u52a1\u5668\u53ef\u4ee5\u5bf9\u5176\u8fdb\u884c\u5199\u5165\u3002 \u60a8\u5fc5\u987b\u5148\u8fd0\u884c\u6b64\u64cd\u4f5c\uff0c\u7136\u540e\u624d\u80fd\u5f00\u59cb\u5b89\u88c5\u3002 \u5f53\u6d89\u53ca\u5230 CLI \u65f6\uff0c\u8fd9\u79cd\u60c5\u51b5\u53d8\u5f97\u66f4\u52a0\u68d8\u624b\uff0c\u56e0\u4e3a\u73b0\u5728\u53ef\u80fd\u6709\u4e24\u4e2a\u7528\u6237\u9700\u8981\u80fd\u591f\u5199\u5165\u6587\u4ef6\u3002 \u56e0\u6b64\uff0c\u91c7\u53d6\u63aa\u65bd\u907f\u514d\u5199\u5165\u8fd9\u4e9b\u6587\u4ef6\u7684\u95ee\u9898\u5f88\u91cd\u8981\u3002 \u8fd9\u91cc\u6709\u51e0\u4e2a\u9009\u62e9\u3002 \u5728 CLI \u548c Web \u670d\u52a1\u5668\u4f7f\u7528\u76f8\u540c\u7684\u7528\u6237\u3002 \u8fd9\u53ef\u4ee5\u91c7\u53d6\u4ee5\u4e0b\u5f62\u5f0f\uff1a\u5728\u8fd0\u884c\u4efb\u4f55\u5b89\u88c5\u6216\u5347\u7ea7\u547d\u4ee4\uff08\u6216\u4efb\u4f55\u5176\u4ed6\u5c06\u5199\u5165\u6587\u4ef6\u7684\u547d\u4ee4\uff09\u4e4b\u524d\u5207\u6362\u5230 Web \u670d\u52a1\u5668\u7528\u6237\u3002 \u5982\u679c\u53ef\u7528\uff0c\u8bf7\u8003\u8651\u5c06 ACL \u5e94\u7528\u4e8e data \u548c internal_data \u76ee\u5f55\u4e2d\u3002 \u8be5\u6982\u5ff5\u56e0\u64cd\u4f5c\u7cfb\u7edf\u548c\u914d\u7f6e\u800c\u5f02\uff0c\u4f46 \u6b64\u5904 \u63cf\u8ff0\u7684\u662f\u603b\u4f53\u601d\u8def\u3002 \u5bf9 PHP \u5199\u5165\u7684\u5185\u5bb9\u5f3a\u5236\u6388\u4e88\u7279\u5b9a\u7684\u6743\u9650\u3002 \u8fd9\u53ef\u4ee5\u901a\u8fc7 src / config.php \u6587\u4ef6\u4e2d\u5e2f\u6709\u5982\u4e0b\u4e00\u884c\u7684\u4ee3\u7801\u6765\u5b8c\u6210\uff1a $config['chmodWritableValue'] = 0666; \u8fd9\u79cd\u65b9\u6cd5\u5bf9\u4e8e\u5f00\u53d1\u76ee\u7684\u6765\u8bf4\u53ef\u80fd\u662f\u6700\u7b80\u5358\u7684\u3002 \u8bf7\u6ce8\u610f\uff0c\u5982\u679c\u60a8\u6b63\u5728\u5f00\u53d1\u9644\u52a0\u7ec4\u4ef6\uff0c\u5219\u53ef\u80fd\u4f1a\u6709\u5176\u4ed6\u9700\u8981\u7531 CLI \u548c Web \u670d\u52a1\u5668\u7528\u6237\u5199\u5165\u7684\u4f4d\u7f6e\u3002 \u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0c\u8fd9\u5305\u62ec\u9644\u52a0\u7ec4\u4ef6\u4e2d\u7684 _output \u76ee\u5f55\u3002 \u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u4ee5\u60a8\u7684 CLI \u7528\u6237\u8eab\u5206\u8fd0\u884c Web \u670d\u52a1\u5668\u53ef\u80fd\u4f1a\u51cf\u5c11\u6469\u64e6\u3002 \u5982\u679c\u60a8\u91c7\u7528\u5176\u4ed6\u4efb\u4f55\u65b9\u6cd5\uff0c\u5219\u53ef\u80fd\u9700\u8981\u786e\u4fdd\u60a8\u7684 Web \u670d\u52a1\u5668\u53ef\u4ee5\u5199\u5165\u6574\u4e2a XenForo \u5b89\u88c5\uff1b\u5728\u751f\u4ea7\u4e2d\u4e0d\u5efa\u8bae\u8fd9\u6837\u505a\u3002","title":"\u5173\u4e8e\u6587\u4ef6\u6743\u9650\u8bf4\u660e"},{"location":"#_8","text":"\u5f53\u524d\u5b89\u88c5 XF 2.0 \u7684\u65b9\u5f0f\u662f\u901a\u8fc7\u65b0\u7684 CLI \u7cfb\u7edf\u3002 \u8bb8\u591a\u5f00\u53d1\u8fc7\u7a0b\u53ea\u80fd\u4f7f\u7528 CLI \u6765\u8fdb\u884c\uff0c\u6240\u4ee5\u6211\u4eec\u5c31\u6765\u4f7f\u7528\u5b83\u6765\u5b89\u88c5 XF 2.0\u3002 \u8981\u8fd0\u884c\u8fd9\u4e9b\u547d\u4ee4\uff0c\u60a8\u5c06\u9700\u8981\u8bbf\u95ee \u7ec8\u7aef/shell\uff0c\u4f7f\u7528 php CLI \u547d\u4ee4\u548c\u5f53\u524d\u5de5\u4f5c\u76ee\u5f55\u5e94\u8be5\u662f\u60a8\u4e0a\u4f20 XF 2.0 \u6587\u4ef6\u7684\u6839\u76ee\u5f55\u3002 Warning \u4e3a\u6d88\u9664\u6587\u4ef6\u6743\u9650\u95ee\u9898\uff0c\u6211\u4eec\u5efa\u8bae\u4ee5\u4e0e PHP \u5728 web \u670d\u52a1\u5668\u4e0a\u8fd0\u884c\u7684\u76f8\u540c\u7528\u6237\u6765\u8fd0\u884c\u5b89\u88c5\u7a0b\u5e8f\u3002 \u5982\u679c\u4e0d\u8fd9\u6837\u505a\uff0c\u5219\u5e94\u8be5\u91c7\u53d6\u63aa\u65bd\u786e\u4fdd\u6743\u9650\u8bbe\u7f6e\u6b63\u786e\u3002 \u6709\u5173\u66f4\u591a\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u89c1\u4e0a\u9762\u7684\u7ae0\u8282\u3002 \u8981\u5f00\u59cb\u5b89\u88c5\uff0c\u53ea\u9700\u8f93\u5165\u4ee5\u4e0b\u547d\u4ee4\uff1a Terminal $ php cmd.php xf:install \u60a8\u4f1a\u88ab\u95ee\u5230\u8bb8\u591a\u95ee\u9898\uff0c\u4f8b\u5982\u521d\u59cb\u7ba1\u7406\u5458\u7528\u6237\u540d\u548c\u5bc6\u7801\uff0c\u677f\u5757\u6807\u9898\u3002 \u6b64\u540e\uff0c\u5c06\u5bfc\u5165 XF 2.0 \u6570\u636e\u5e93\u8868\u548c\u4e3b\u8981\u7684\u6570\u636e\u3002 XF 2.0 \u73b0\u5728\u5df2\u5b89\u88c5\u5b8c\u6210\uff01","title":"\u5b89\u88c5"},{"location":"#_9","text":"\u6709\u65f6\u53ef\u80fd\u9700\u8981\u91cd\u65b0\u5b89\u88c5 XF2\u3002 \u5728\u4e0d\u652f\u6301\u5347\u7ea7\u7684 \"\u5f00\u53d1\u9884\u89c8\" \u9636\u6bb5\u5c24\u5176\u5982\u6b64\u3002 \u5982\u679c\u51c6\u5907\u597d\u91cd\u65b0\u5b89\u88c5\uff0c\u8bf7\u6309\u7167\u4e0a\u9762\u7684 \u4e0b\u8f7d XF 2.0 \u90e8\u5206\u4e0b\u8f7d\u65b0\u6587\u4ef6\uff08\u5982\u679c\u9002\u7528\uff09\u3002 \u4e00\u822c\u6765\u8bf4\uff0c\u5e94\u8be5\u53ef\u4ee5\u5408\u5e76\u548c\u590d\u76d6\u73b0\u6709\u6587\u4ef6\u3002 \u5982\u679c\u8981\u8fdb\u884c\u5b8c\u5168\u5e72\u51c0\u7684\u91cd\u65b0\u5b89\u88c5\uff0c\u5219\u53ef\u80fd\u9700\u8981\u4fdd\u5b58 config.php \u6587\u4ef6\u7684\u526f\u672c\uff0c\u6216\u8005\u6309\u7167 \u521b\u5efa src/config.php \u4e2d\u7684\u8bf4\u660e\u91cd\u65b0\u521b\u5efa\u5b83\u3002 \u5728\u4e0a\u4f20\u65b0\u6587\u4ef6\u4e4b\u524d\uff0c\u60a8\u5e94\u8be5\u5220\u9664 data \u548c internal_data \u76ee\u5f55\u7684\u5185\u5bb9\u3002 \u6700\u540e\uff0c\u60a8\u53ea\u9700\u8981\u5f00\u59cb\u5b89\u88c5\u5373\u53ef\uff0c\u4e0e\u4e0a\u9762\u7c7b\u4f3c\u3002 \u60a8\u5c06\u9700\u8981\u4f7f\u7528\u6b64 --clear \u9009\u9879\u6765\u5220\u9664\u6240\u6709\u73b0\u6709\u7684 xf_ \u8d44\u6599\u8868\u3002 Terminal $ php cmd.php xf:install --clear \u91cd\u65b0\u5b89\u88c5\u5b8c\u6210\u540e\uff0c\u60a8\u73b0\u5728\u5e94\u8be5\u53ef\u4ee5\u91cd\u65b0\u767b\u5f55\u4e86\u3002 \u5982\u679c\u60a8\u6b63\u5728\u5f00\u53d1\u9644\u52a0\u7ec4\u4ef6\uff0c\u5e76\u4e14\u9009\u62e9\u4fdd\u7559\u6216\u5907\u4efd\u73b0\u6709 src/addons \u76ee\u5f55\uff0c\u5219\u53ef\u4ee5\u4f7f\u7528 \u5bfc\u5165\u5f00\u53d1\u8f93\u51fa \u547d\u4ee4\u6765\u8fd8\u539f\u9644\u52a0\u7ec4\u4ef6\u6570\u636e\u3002 Warning \u5982\u679c\u9009\u62e9\u5907\u4efd\u548c\u8fd8\u539f src/addons \u76ee\u5f55\uff0c\u8bf7\u5c0f\u5fc3\u3002 \u5176\u4e2d\u7684 XF \u76ee\u5f55\u5305\u542b XF \u4e3b\u8981\u7684\u6570\u636e\uff0c\u56e0\u6b64\u4e0d\u5e94\u4ece\u5907\u4efd\u4e2d\u8fd8\u539f\uff0c\u4ee5\u786e\u4fdd\u60a8\u59cb\u7ec8\u62e5\u6709\u6700\u65b0\u7248\u672c\u7684\u6587\u4ef6\u3002 \u4ee5\u8fd9\u79cd\u65b9\u5f0f\u8fd0\u884c\u91cd\u65b0\u5b89\u88c5\u662f\u7834\u574f\u6027\u7684\u64cd\u4f5c\uff0c\u5b83\u5c06\u5220\u9664\u60a8\u521b\u5efa\u7684\u6240\u6709\u6570\u636e\u3002 \u6b64\u5916\uff0c\u8bf7\u8bb0\u4f4f\uff0c\u4ec5\u5e2f\u6709 xf_ \u524d\u7f00\u7684\u8d44\u6599\u8868\u624d\u4f1a\u88ab\u6e05\u9664\u3002 \u8fd9\u4e5f\u662f\u5efa\u8bae\u6240\u6709\u8d44\u6599\u8868\uff08\u751a\u81f3\u662f\u9644\u52a0\u7ec4\u4ef6\uff09\u90fd\u5e94\u8be5\u4ee5 xf_ \u4e3a\u524d\u7f00\u7684\u4e00\u4e2a\u91cd\u8981\u539f\u56e0\u3002","title":"\u91cd\u65b0\u5b89\u88c5"},{"location":"#_10","text":"\u5f53\u60a8\u5b89\u88c5 XF2 \u65f6\uff0c\u6211\u4eec\u4f1a\u5728\u5b89\u88c5\u8fc7\u7a0b\u4e2d\u8fd0\u884c\u6587\u4ef6\u5b8c\u6574\u6027\u68c0\u67e5\u3002 \u5982\u6709\u5fc5\u8981\uff0c\u5e76\u4e14\u60a8\u65e0\u6cd5\u901a\u8fc7 Admin CP \u4e2d\u7684\u9875\u9762\u8fd0\u884c\u68c0\u67e5\uff0c\u5219\u53ef\u4ee5\u8fd0\u884c CLI \u547d\u4ee4\u6765\u8fd0\u884c\u8be5\u68c0\u67e5\u3002 Terminal $ php cmd.php xf:file-check [addon_id] \u5982\u679c\u60a8\u5e0c\u671b\u5bf9\u6240\u6709\u6587\u4ef6\uff08\u5305\u62ec XF \u672c\u8eab\uff09\u8fdb\u884c\u6587\u4ef6\u8fd0\u884c\u5065\u5eb7\u68c0\u67e5\uff0c\u53ea\u9700\u7701\u7565 [addon_id] \u53c2\u6570\u5373\u53ef\u3002 \u4ec5\u5bf9\u4e8e XF\uff0c\u4ec5\u4f7f\u7528 XF \u4ee3\u66ff\u8be5\u53c2\u6570\uff0c\u6216\u8005\u5bf9\u4e8e\u7279\u5b9a\u7684\u9644\u52a0\u7ec4\u4ef6\uff0c\u53ea\u9700\u6307\u5b9a\u60a8\u8981\u68c0\u67e5\u7684\u9644\u52a0\u7ec4\u4ef6 ID\u3002","title":"\u9a8c\u8bc1\u6587\u4ef6\u5b8c\u6574\u6027"},{"location":"#add-on","text":"\u9664\u4e86\u4e0a\u8ff0\u7528\u4e8e\u5b89\u88c5 XF2 \u7684\u547d\u4ee4\u4e4b\u5916\uff0c\u8fd8\u6709\u4e00\u4e9b\u7528\u4e8e\u7ba1\u7406\u9644\u52a0\u7ec4\u4ef6\u7684\u547d\u4ee4\u3002","title":"Add-on \u7ba1\u7406\u547d\u4ee4"},{"location":"#_11","text":"Terminal $ php cmd.php xf:addon-install [addon_id] \u5b89\u88c5\u6307\u5b9a\u7684\u9644\u52a0\u7ec4\u4ef6\uff0c\u53ea\u8981\u5b83\u662f\u53ef\u7528\u7684\uff0c\u5e76\u901a\u8fc7\u6587\u4ef6\u8fd0\u884c\u5065\u5eb7\u68c0\u67e5\u3002 \u5982\u679c\u6709\u53ef\u7528\u7684\u5f00\u53d1\u8f93\u51fa\uff0c\u60a8\u5c06\u88ab\u8981\u6c42\u786e\u8ba4\u662f\u5426\u8981\u5c06\u5176\u7528\u4e8e\u5b89\u88c5\uff0c\u800c\u4e0d\u662f\u5bfc\u51fa\u7684\u6570\u636e XML \u6587\u4ef6\u3002","title":"\u5b89\u88c5"},{"location":"#_12","text":"Terminal $ php cmd.php xf:addon-upgrade [addon_id] \u53ea\u8981\u6307\u5b9a\u7684\u9644\u52a0\u7ec4\u4ef6\u662f\u53ef\u5347\u7ea7\u7684\uff0c\u5c31\u5bf9\u5176\u8fdb\u884c\u5347\u7ea7\uff0c\u5e76\u901a\u8fc7\u6587\u4ef6\u8fd0\u884c\u5065\u5eb7\u68c0\u67e5\u3002 \u53ef\u4ee5\u9009\u62e9\u4ece\u5f00\u53d1\u8f93\u51fa\u4e2d\u8fdb\u884c\u5bfc\u5165\u3002","title":"\u5347\u7ea7"},{"location":"#_13","text":"Terminal $ php cmd.php xf:addon-rebuild [addon_id] \u53ea\u8981\u6307\u5b9a\u7684\u9644\u52a0\u7ec4\u4ef6\u662f\u53ef\u91cd\u5efa\u7684\uff0c\u5c31\u4e3a\u5176\u91cd\u5efa\u4e3b\u8981\u7684\u6570\u636e\uff0c\u5e76\u901a\u8fc7\u6587\u4ef6\u8fd0\u884c\u5065\u5eb7\u68c0\u67e5\u3002 \u8fd9\u5c06\u91cd\u65b0\u5bfc\u5165\u9644\u52a0\u7ec4\u4ef6\u7684\u6570\u636e\u3002 \u53ef\u4ee5\u9009\u62e9\u6027\u5730\u8fd0\u884c\u4ece\u5f00\u53d1\u8f93\u51fa\u4e2d\u5bfc\u5165\u3002","title":"\u91cd\u5efa"},{"location":"#_14","text":"Terminal $ php cmd.php xf:addon-uninstall [addon_id] \u5378\u8f7d\u6307\u5b9a\u7684\u9644\u52a0\u7ec4\u4ef6\uff0c\u53ea\u8981\u5b83\u662f\u4e0d\u53ef\u5378\u8f7d\u7684\u3002","title":"\u5378\u8f7d"},{"location":"add-on-structure/","text":"\u9644\u52a0\u7ec4\u4ef6\u7ed3\u6784 \u00b6 \u5728\u4ee5\u524d\u7684 XF \u7248\u672c\u4e2d\uff0c\u5f88\u5c11\u6709\u5173\u4e8e\u9644\u52a0\u7ec4\u4ef6\u5f00\u53d1\u7684\u6807\u51c6\u548c\u7ea6\u5b9a\u3002 \u5728 XF 2.0 \u7684\u529f\u80fd\u4e2d\uff0c\u6211\u4eec\u5df2\u7ecf\u505a\u4e86\u5f88\u591a\u4fee\u6539\u3002 \u8ba9\u6211\u4eec\u6765\u770b\u770b\u5176\u4e2d\u7684\u4e00\u4e9b\u53d8\u5316\uff1a \u9644\u52a0\u7ec4\u4ef6 ID \u548c\u9644\u52a0\u7ec4\u4ef6\u8def\u5f84 \u00b6 \u6bcf\u4e2a\u5b89\u88c5\u7684\u9644\u52a0\u7ec4\u4ef6\u90fd\u5fc5\u987b\u6709\u4e00\u4e2a\u552f\u4e00\u7684 ID\uff0c\u8fd9\u4e2a ID \u51b3\u5b9a\u4e86\u9644\u52a0\u7ec4\u4ef6\u5e94\u8be5\u5728\u6587\u4ef6\u7cfb\u7edf\u4e2d\u7684\u54ea\u4e2a\u4f4d\u7f6e\u4fdd\u5b58\u5176\u6587\u4ef6\u3002\u9644\u52a0\u7ec4\u4ef6\u7684 ID \u6709\u4e24\u79cd\u53ef\u80fd\u7684\u683c\u5f0f\u3002 \u7b2c\u4e00\u4e2a \"\u7b80\u5358\" \u7c7b\u578b\u5e94\u8be5\u662f\u4e00\u4e2a\u5358\u5b57\uff0c\u4e0d\u5305\u542b\u4efb\u4f55\u7279\u6b8a\u5b57\u7b26\u3002\u4f8b\u5982\uff0c Demo \u3002 \u7b80\u5358\u7684\u9644\u52a0\u7ec4\u4ef6 ID \u5fc5\u987b\u9075\u5b88\u4ee5\u4e0b\u89c4\u5219\uff1a \u5fc5\u987b\u53ea\u5305\u542b a-z \u6216 A-Z\u3002 \u53ef\u4ee5\u5305\u542b 0-9\uff0c\u4f46\u4e0d\u80fd\u653e\u5728 ID \u5f00\u5934\u3002 \u4e0d\u80fd\u5305\u542b\u4efb\u4f55\u7279\u6b8a\u5b57\u7b26\uff0c\u4f8b\u5982\u659c\u7ebf\u3001\u7834\u6298\u53f7\u6216\u4e0b\u5212\u7ebf\u3002 \u7b2c\u4e8c\u4e2a\u5305\u542b\u4e00\u4e2a\u4f9b\u5e94\u5546\u524d\u7f00\uff0c\u6240\u4ee5\u5982\u679c\u4f60\u5728\u4e00\u4e2a\u7279\u5b9a\u7684\u54c1\u724c\u6216\u516c\u53f8\u4e0b\u53d1\u5e03\u9644\u52a0\u7ec4\u4ef6\uff0c\u9644\u52a0\u7ec4\u4ef6 ID \u53ef\u4ee5\u8868\u660e\u8fd9\u4e00\u70b9\u3002\u4f8b\u5982\uff0c SomeVendor/Demo \u3002 \u4f9b\u5e94\u5546\u7c7b\u578b\u7684\u9644\u52a0 ID \u5e94\u9075\u5b88\u4ee5\u4e0b\u89c4\u5219\uff1a \u5fc5\u987b\u53ea\u5305\u542b a-z \u6216 A-Z \u53ef\u5305\u542b\u4e00\u4e2a / \u5b57\u7b26\uff0c\u4f46\u4e0d\u80fd\u5728\u5f00\u5934\u6216\u7ed3\u5c3e\u5904 \u53ef\u4ee5\u5305\u542b 0-9\uff0c\u4f46\u4e0d\u5728\u9644\u52a0\u7ec4\u4ef6 ID \u7684\u4efb\u4f55\u4e00\u4e2a\u90e8\u5206\u7684\u5f00\u5934 \u4e00\u65e6\u60a8\u51b3\u5b9a\u4e86\u9644\u52a0\u7ec4\u4ef6\u7684 ID\uff0c\u6211\u4eec\u5c31\u77e5\u9053\u8fd9\u4e2a\u9644\u52a0\u7ec4\u4ef6\u7684\u6587\u4ef6\u5c06\u4fdd\u5b58\u5728\u54ea\u91cc\u3002 \u6240\u6709 XF 2.0 \u9644\u52a0\u7ec4\u4ef6\u90fd\u4fdd\u5b58\u5728 src/addons \u76ee\u5f55\u7684\u5b50\u76ee\u5f55\u4e2d\u3002 \u5982\u679c\u4f60\u6709\u4e00\u4e2a\u7b80\u5358\u7684\u9644\u52a0\u7ec4\u4ef6 ID\uff0c\u4f8b\u5982 Demo \uff0c\u4f60\u7684\u9644\u52a0\u7ec4\u4ef6\u6587\u4ef6\u5c06\u4fdd\u5b58\u5728\u4ee5\u4e0b\u4f4d\u7f6e\uff1a src/addons/Demo \u3002 \u5982\u679c\u4f60\u6709\u4e00\u4e2a\u57fa\u4e8e\u5382\u5546\u7684\u9644\u52a0\u7ec4\u4ef6 ID\uff0c\u4f8b\u5982 SomeVendor/Demo \uff0c\u6587\u4ef6\u5c06\u4fdd\u5b58\u5728\u4ee5\u4e0b\u4f4d\u7f6e\uff1a src/addons/SomeVendor/Demo \u3002 \u60a8\u9009\u62e9\u7684\u9644\u52a0\u7ec4\u4ef6 ID \u4e5f\u5c06\u6210\u4e3a\u60a8\u7684\u7c7b\u522b\u547d\u540d\u7a7a\u95f4\u524d\u7f00\uff08\u66f4\u591a\u4fe1\u606f\u8bf7\u53c2\u89c1 \u547d\u540d\u7a7a\u95f4 \uff09\u3002 \u5efa\u8bae\u7248\u672c\u5b57\u7b26\u4e32\u683c\u5f0f \u00b6 XF \u672c\u8eab\u4f7f\u7528 MAJOR.MINOR.PATCH \u539f\u5219\uff08\u4f8b\u5982 2.0.0 \u4ee3\u8868\u7b2c\u4e00\u4e2a\u7a33\u5b9a\u7684 XF2 \u7248\u672c\uff09\u6765\u8fdb\u884c\u7248\u672c\u7f16\u53f7\uff0c\u6211\u4eec\u5efa\u8bae\u5bf9\u60a8\u81ea\u5df1\u7684\u9644\u52a0\u7ec4\u4ef6\u7684\u7248\u672c\u7f16\u53f7\u91c7\u53d6\u7c7b\u4f3c\u7684\u65b9\u6cd5\u3002 \u57fa\u672c\u4e0a\uff0c\u5728\u7248\u672c\u53f7\u4e2d\u589e\u52a0 MAJOR \u7248\u672c\uff0c\u5f53\u4f60\u505a\u4e86\u91cd\u5927\u7684\u529f\u80fd\u6539\u53d8\uff0c\u7279\u522b\u662f\u7834\u574f\u4e86\u5411\u540e\u517c\u5bb9\u6027\u7684\u6539\u53d8 MINOR \u7248\u672c\uff0c\u5f53\u4f60\u6dfb\u52a0\u529f\u80fd\u65f6\uff0c\u6700\u597d\u662f\u4ee5\u5411\u540e\u517c\u5bb9\u7684\u65b9\u5f0f\u6dfb\u52a0 PATCH \u7248\u672c\uff0c\u5f53\u4f60\u8fdb\u884c\u5411\u540e\u517c\u5bb9\u7684 Bug \u4fee\u590d\u65f6\u4f7f\u7528 \u5efa\u8bae\u7248\u672c ID \u683c\u5f0f \u00b6 \u9644\u52a0\u7ec4\u4ef6\u7684\u7248\u672c ID \u662f\u57fa\u672c\u7684\u6574\u6570\uff0c\u7528\u4e8e\u5185\u90e8\u7248\u672c\u6bd4\u8f83\u3002 \u5b83\u8ba9\u6211\u4eec\u53ef\u4ee5\u66f4\u5bb9\u6613\u5730\u68c0\u6d4b\u5230\u4e00\u4e2a\u7248\u672c\u6bd4\u53e6\u4e00\u4e2a\u7248\u672c\u65e7\u3002 \u60a8\u7684\u9644\u52a0\u7ec4\u4ef6\u6bcf\u4e2a\u7248\u672c\u90fd\u5e94\u8be5\u5c06\u7248\u672c\u53f7 ID \u81f3\u5c11\u589e\u52a0 1\uff0c\u4f46\u6211\u4eec\u5185\u90e8\u5bf9 XF \u672c\u8eab\u4f7f\u7528\u7684\u60ef\u4f8b\uff0c\u5bf9\u9644\u52a0\u7ec4\u4ef6\u4e5f\u6709\u6f5c\u5728\u7684\u4f5c\u7528\u3002 \u6211\u4eec\u7684\u7248\u672c ID \u7684\u683c\u5f0f\u4e3a aabbccde \u3002 aa \u4ee3\u8868 MAJOR \u7248\u672c bb \u4ee3\u8868 MINOR \u7248\u672c cc \u4ee3\u8868 PATCH \u7248\u672c d \u4ee3\u8868\u72b6\u6001\uff0c\u4f8b\u5982 1 \u4ee3\u8868 alpha \u7248\u672c\uff0c 3 \u4ee3\u8868 beta \u7248\u672c\uff0c 5 \u4ee3\u8868\u5019\u9009\u7248\u672c\uff0c 7 \u4ee3\u8868\u7a33\u5b9a\u7248\u672c e \u4ee3\u8868\u7248\u672c Level \u72b6\u6001 \u4f8b\u5982\uff0c\u4e00\u4e2a\u7248\u672c\u53f7\u662f 1.7.3 \u5019\u9009\u7248\u672c 4 \u5b83\u7684\u9644\u52a0\u7ec4\u4ef6 ID \u4e3a \"1070354\"\u3002 \u6700\u7ec8\u7a33\u5b9a\u7248 XF2 \u7684ID\u4e3a 2000070 \u3002 XF \u7684 1.5.0 Beta 3 \u7248\u672c\u7684 ID \u4e3a 1050033 \u3002 \u7a33\u5b9a\u7248 99.99.99 \u4f1a\u6709\u4e00\u4e2aID\u4e3a 99999970 ... \u4e5f\u8bb8\u4f60\u5e94\u8be5\u6162\u4e00\u70b9 \ud83d\ude09\u3002 \u5e38\u89c1\u7684\u9644\u52a0\u7ec4\u4ef6\u6587\u4ef6\u548c\u76ee\u5f55 \u00b6 \u5728\u9644\u52a0\u7ec4\u4ef6\u7684\u76ee\u5f55\u4e2d\uff0c\u6709\u4e00\u4e9b\u6587\u4ef6\u548c\u76ee\u5f55\u6709\u7279\u6b8a\u7684\u7528\u9014\u548c\u610f\u4e49\u3002 addon.json \u6587\u4ef6 \u00b6 addon.json \u662f\u4e00\u4e2a\u5305\u542b\u4e00\u4e9b\u4fe1\u606f\u7684\u6587\u4ef6\uff0c\u8fd9\u4e9b\u4fe1\u606f\u662f\u5e2e\u52a9 XF 2.0 \u8bc6\u522b\u9644\u52a0\u7ec4\u4ef6\u5e76\u5728 Admin CP \u4e2d\u663e\u793a\u5176\u4fe1\u606f\u6240\u5fc5\u9700\u7684\u3002 \u6700\u8d77\u7801\uff0c\u4f60\u7684 addon.json \u6587\u4ef6\u5e94\u8be5\u770b\u8d77\u6765\u8c61\u8fd9\u6837\uff1a { \"title\": \"My Add-on by Some Company\", \"version_string\": \"2.0.0\", \"version_id\": 2000070, \"dev\": \"Some Company\" } \u521b\u5efa\u9644\u52a0\u7ec4\u4ef6\u65f6\uff0c\u4f1a\u81ea\u52a8\u4e3a\u60a8\u521b\u5efa\u4e00\u4e2a\u57fa\u672c\u6587\u4ef6\u3002 \u5305\u542b\u4e00\u4e2a\u6709\u6548\u7684 addon.json \u6587\u4ef6\u662f\u4f60\u7684\u9644\u52a0\u7ec4\u4ef6\u88ab\u8bc6\u522b\u7684\u5fc5\u8981\u6761\u4ef6\uff0c\u4f60\u53ef\u4ee5\u968f\u65f6 \u9a8c\u8bc1\u4f60\u7684 addon.json \u6587\u4ef6 \u3002 \u5c5e\u6027 \u00b6 Property Description legacy_addon_id \u5f53\u4ece XenForo 1 \u5347\u7ea7\u81f3 XenForo 2 \u65f6\uff0c\u7528\u6765\u5f00\u542f\u81ea\u52a8\u5904\u7406\u9644\u52a0\u7ec4\u4ef6 ID \u66f4\u6539\u3002 title \u9644\u52a0\u7ec4\u4ef6\u7684\u6807\u9898\u3002 \u8fd9\u5c06\u663e\u793a\u5728\u7ba1\u7406\u9762\u677f\u4e2d\u3002 description \u9644\u52a0\u7ec4\u4ef6\u7684\u63cf\u8ff0\u3002\u8fd9\u5c06\u663e\u793a\u5728\u7ba1\u7406\u9762\u677f\u4e2d\u3002 version_id XenForo \u7528\u6765\u8ffd\u8e2a\u9644\u52a0\u7ec4\u4ef6\u66f4\u65b0\u7684\u5185\u90e8 ID\u3002 \u6bcf\u6b21\u53d1\u5e03\u65f6\u5fc5\u987b\u9012\u589e\u3002 version_string \u4eba\u7c7b\u53ef\u4ee5\u8bfb\u61c2\u7684\u9644\u52a0\u7ec4\u4ef6\u7248\u672c\u3002 \u8fd9\u5c06\u5728\u7ba1\u7406\u9762\u677f\u4e2d\u663e\u793a\uff0c\u800c\u4e0d\u662f version_id \u5c5e\u6027\u3002 dev \u9644\u52a0\u7ec4\u4ef6\u5f00\u53d1\u8005\u7684\u540d\u5b57\u3002\u8fd9\u5c06\u663e\u793a\u5728\u7ba1\u7406\u9762\u677f\u4e2d\u3002 dev_url \u5982\u679c\u8bbe\u7f6e\u4e86\uff0c\u5f00\u53d1\u8005\u7684\u540d\u5b57\u5c06\u4ee5\u8d85\u94fe\u63a5\u7684\u5f62\u5f0f\u663e\u793a\u5728\u7ba1\u7406\u9762\u677f\u4e2d\uff0c\u5e76\u4ee5 (href) \u6b64\u4e3a\u76ee\u6807\u3002 faq_url \u5982\u679c\u8bbe\u7f6e\u4e86\uff0c\u4e00\u4e2a FAQ \u7684\u8d85\u94fe\u63a5\u5c06\u663e\u793a\u5728\u7ba1\u7406\u9762\u677f\u4e2d\uff0c\u5e76\u4ee5 (href) \u6b64\u4e3a\u76ee\u6807\u3002 support_url \u5982\u679c\u8bbe\u7f6e\u4e86\uff0c\u652f\u63f4\u5e2e\u52a9\u7684\u8d85\u94fe\u63a5\u5c06\u663e\u793a\u5728\u7ba1\u7406\u9762\u677f\u4e2d\uff0c\u5e76\u4ee5 (href) \u6b64\u4e3a\u76ee\u6807\u3002 extra_urls \u8fd9\u5141\u8bb8\u60a8\u663e\u793a\u4e0e\u9644\u52a0\u7ec4\u4ef6\u76f8\u5173\u7684\u5176\u4ed6\u5185\u5bb9\u94fe\u63a5\uff08\u53ef\u80fd\u662f\u9519\u8bef\u62a5\u544a\u94fe\u63a5\uff0c\u624b\u518c - \u968f\u60a8\u559c\u6b22\uff09\u3002 \u4e00\u4e2a JSON \u7269\u4ef6\u7684\u6570\u7ec4\uff0c\u5176\u4e2d key \u662f\u94fe\u63a5\u6587\u672c\uff0cvalue \u662f\u94fe\u63a5\u76ee\u6807 (href)\u3002 require XenForo \u5141\u8bb8\u5b89\u88c5\u9644\u52a0\u7ec4\u4ef6\u65f6\u9700\u8981\u6ee1\u8db3\u7684\u4e00\u7cfb\u5217\u8981\u6c42\u3002 \u66f4\u591a\u4fe1\u606f\u8bf7\u53c2\u89c1 'require \u5c5e\u6027' \u3002 icon \u8d44\u6e90\u7684\u56fe\u6807\u3002 \u8fd9\u53ef\u4ee5\u662f\u4e00\u4e2a Font Awesome \u56fe\u6807\u540d\u79f0\uff08\u4f8b\u5982 fa-shopping-bag \uff0c\u6216\u4e00\u4e2a\u56fe\u50cf\u6587\u4ef6\u7684\u8def\u5f84\uff09\u3002 require \u5c5e\u6027 \u00b6 \u5982\u679c\u73af\u5883\u4e0d\u652f\u63f4\u6216\u4e0d\u6ee1\u8db3\u8981\u6c42\uff0crequire \u5c5e\u6027\u662f\u963b\u6b62\u9644\u52a0\u7ec4\u4ef6\u5b89\u88c5\u6216\u5347\u7ea7\u7684\u6807\u51c6\u65b9\u6cd5\u3002 \u4f60\u53ef\u4ee5\u7528\u5b83\u6765\u8981\u6c42\u5148\u5b89\u88c5\u5176\u4ed6\u9644\u52a0\u7ec4\u4ef6\uff0c\u8981\u6c42\u67d0\u4e9b PHP \u6269\u5c55\u5fc5\u987b\u5b58\u5728\u6216\u6fc0\u6d3b\uff0c\u548c/\u6216 \u5f3a\u5236\u6267\u884c\u4e00\u4e2a\u6700\u4f4e\u7684 PHP \u7248\u672c\u3002 \u8fd9\u662f\u4e00\u4e2a\u793a\u4f8b\u7247\u6bb5\uff1a ... \"require\": { \"XF\": [2000010, \"XenForo 2.0.0+\"], \"php\": [\"5.4.0\", \"PHP 5.4.0+\"], \"php-ext/json\": [\"*\", \"JSON extension\"] } ... \u6bcf\u4e2a require\uff0c\u90fd\u662f\u4e00\u4e2a\u547d\u540d\u6570\u7ec4\u3002 \u6570\u7ec4\u7684\u540d\u79f0\u662f\u4ea7\u54c1 ID (\u5982 XF \u6216 php )\u3002 \u7b2c\u4e00\u4e2a\u6570\u7ec4\u5143\u7d20\u662f\u4ea7\u54c1\u7684\u7248\u672c (\u5982 2000010 \u6216 5.4.0 )\u3002 \u4f60\u53ef\u4ee5\u4f7f\u7528 * \u6765\u8868\u793a\u4ea7\u54c1\u7684\u4efb\u4f55\u7248\u672c\u3002 \u7b2c\u4e8c\u4e2a\u6570\u7ec4\u5143\u7d20\u662f\u8be5 require \u4eba\u7c7b\u53ef\u4ee5\u9605\u8bfb\u7684\u6587\u672c\uff0c\u8fd9\u662f\u5728\u6d88\u606f\u4e2d\u4f7f\u7528\u7684\u5185\u5bb9\uff08\u4f8b\u5982 XenForo 2.0.0+ \u6216 PHP 5.4.0+ \uff09\u3002 \u4e0b\u9762\u662f\u53d7\u652f\u63f4\u7684\u4ea7\u54c1 ID \u7684\u6982\u8ff0\uff1a \u4ea7\u54c1 / Require \u540d\u79f0 \u53c2\u8003... \u503c XF XenForo \u7684\u5b89\u88c5\u7248\u672c\u3002 XenForo \u7248\u672c ID\uff0c\u4f8b\u5982 200010 \u3002 \u4f60\u53ef\u4ee5\u901a\u8fc7\u68c0\u67e5 /src/XF.php \u6587\u4ef6\u9876\u90e8\u7684 $versionId \u5b9a\u4e49\u6216\u8005\u6253\u5370 /XF::$versionId \u7684\u503c\u6765\u83b7\u53d6\u5f53\u524d XenForo \u7684\u7248\u672c\u3002 php PHP \u7248\u672c\u3002 PHP \u7248\u672c\uff0c\u4f8b\u5982 5.4.0 \u3002 \u5efa\u8bae\u4f60\u5c3d\u53ef\u80fd\u964d\u4f4e\u8fd9\u4e2a\u503c\uff1b\u66f4\u65b0\u4e00\u4e2a PHP \u7248\u672c\u53ef\u80fd\u662f\u4e00\u4e2a\u76f8\u5f53\u590d\u6742\u7684\u5de5\u4f5c - \u7279\u522b\u662f\u5f53\u5176\u4ed6\u9644\u52a0\u7ec4\u4ef6\u4e0e\u65b0\u7684 PHP \u7248\u672c\u51b2\u7a81\u65f6\u3002 php-ext / (extension name) \u4e00\u4e2a PHP \u6269\u5c55 - \u5176\u4e2d (extension name) \u662f\u6269\u5c55\u7684\u540d\u79f0\u3002 PHP \u6269\u5c55\u7248\u672c\u3002 \u8fd9\u662f\u7528 PHP \u7684 version_compare \u51fd\u6570\u6765\u68c0\u67e5\u7684\uff0c\u6240\u4ee5\u5b83\u751a\u81f3\u9002\u7528\u4e8e\u5b98\u65b9\u5b8c\u6574 PHP \u683c\u5f0f\u7684\u7248\u672c\u5b57\u7b26\u4e32\uff0c\u6bd4\u5982 7.1.19-1+ubuntu16.04.1+deb.sury.org+1 \u3002 (any addon ID) \u4efb\u4f55 XenForo \u9644\u52a0\u7ec4\u4ef6\uff0c\u5982 Demo/Addon \u3002\u5982\u679c\u60a8\u4e0d\u786e\u5b9a\u67d0\u4e2a\u9644\u52a0\u7ec4\u4ef6\u7684 ID\uff0c\u8bf7\u67e5\u770b\u5b83\u7684 addon.json \u6587\u4ef6\u3002 \u9644\u52a0\u7ec4\u4ef6\u7684\u7248\u672c ID\u3002 \u60a8\u53ef\u4ee5\u53c2\u8003 \u5efa\u8bae\u7248\u672c ID \u683c\u5f0f \u4e86\u89e3\u66f4\u591a\u4fe1\u606f\u3002 hashes.json \u6587\u4ef6 \u00b6 hashes.json \u662f\u4e3a\u6587\u4ef6\u5065\u68c0\u7cfb\u7edf\u6dfb\u52a0\u652f\u63f4\u7684\u65b0\u65b9\u6cd5\uff0c\u800c\u4e14\u6700\u597d\u7684\u90e8\u5206\u662f - \u5b83\u662f\u81ea\u52a8\u751f\u6210\u7684\uff01 \u4f5c\u4e3a\u6784\u5efa\u8fc7\u7a0b\u7684\u4e00\u90e8\u5206\uff08\u7a0d\u540e\u4f1a\u6709\u66f4\u591a\u8bf4\u660e\uff09\uff0c\u6211\u4eec\u5c06\u5bf9\u60a8\u6240\u6709\u9644\u52a0\u7ec4\u4ef6\u7684\u6587\u4ef6\u8fdb\u884c\u5feb\u901f\u6e05\u70b9\uff0c\u5e76\u5c06\u8ba1\u7b97\u51fa\u7684\u6587\u4ef6\u5185\u5bb9\u54c8\u5e0c\u7801\u5199\u5165\u5176\u4e2d\u3002 Setup.php \u6587\u4ef6 \u00b6 Setup.php \u662f\u60a8\u5b89\u88c5\u3001\u5347\u7ea7\u6216\u5378\u8f7d\u9644\u52a0\u7ec4\u4ef6\u65f6\u9700\u8981\u8fd0\u884c\u7684\u4efb\u4f55\u4ee3\u7801\u7684\u65b0\u4e3b\u9875\u3002 \u4e0b\u9762 \u6211\u4eec\u5c06\u8be6\u7ec6\u4ecb\u7ecd\u5982\u4f55\u521b\u5efa\u4e00\u4e2a Setup \u7c7b\u3002 _data \u76ee\u5f55 \u00b6 _data \u76ee\u5f55\u662f\u4fdd\u5b58\u60a8\u7684\u9644\u52a0\u7ec4\u4ef6\u4e3b\u8981\u6570\u636e\u7684\u5730\u65b9\u3002 \u6bcf\u4e2a\u9644\u52a0\u7ec4\u4ef6\u7684\u6570\u636e\u7c7b\u578b\u90fd\u4f1a\u6709\u81ea\u5df1\u7684 XML \u6587\u4ef6\uff08\u800c\u4e0d\u662f\u6240\u6709\u7c7b\u578b\u7684\u5358\u4e2a\u6587\u4ef6\uff09\u3002\u8fd9\u4e9b\u6587\u4ef6\u7684\u54c8\u5e0c\u503c\u88ab\u5305\u542b\u5728 hashes.json \u4e2d\uff0c\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u5728\u5141\u8bb8\u5b89\u88c5\u9644\u52a0\u7ec4\u4ef6\u4e4b\u524d\u786e\u4fdd\u9644\u52a0\u7ec4\u4ef6\u62e5\u6709\u5b8c\u6574\u548c\u4e00\u81f4\u7684\u6570\u636e\u3002 _output \u76ee\u5f55 \u00b6 _output \u76ee\u5f55\u4e0d\u662f\u6210\u529f\u5b89\u88c5\u9644\u52a0\u7ec4\u4ef6\u6240\u5fc5\u9700\u7684\uff0c\u800c\u4e14\u5728\u53d1\u5e03\u9644\u52a0\u7ec4\u4ef6\u65f6\u4e5f\u4e0d\u5e94\u8be5\u5305\u62ec\u5728\u5185\u3002 \u8fd9\u4e2a\u76ee\u5f55\u7eaf\u7cb9\u662f\u4e3a\u4e86\u5f00\u53d1\u76ee\u7684\uff0c\u53ea\u6709\u5728\u6fc0\u6d3b\u5f00\u53d1\u6a21\u5f0f\u65f6\u624d\u4f1a\u4f7f\u7528\uff08\u53c2\u89c1 \u6fc0\u6d3b\u5f00\u53d1\u6a21\u5f0f \uff09\u3002 \u6bcf\u9879\u9644\u52a0\u7ec4\u4ef6\u6570\u636e\u90fd\u4fdd\u5b58\u5728\u4e00\u4e2a\u5358\u72ec\u7684\u6587\u4ef6\u4e2d\u3002 \u5927\u591a\u6570\u60c5\u51b5\u4e0b\uff0c\u5b83\u4eec\u88ab\u4fdd\u5b58\u6210 JSON \u6587\u4ef6\uff0c\u4f46\u5bf9\u4e8e\u77ed\u8bed\uff0c\u5b83\u4eec\u88ab\u4fdd\u5b58\u4e3a TXT \u6587\u4ef6\uff0c\u5bf9\u4e8e\u6a21\u677f\uff0c\u5b83\u4eec\u88ab\u4fdd\u5b58\u4e3a HTML/CSS/LESS \u6587\u4ef6\u3002 \u6240\u6709\u7684\u6a21\u677f\u7c7b\u578b\u90fd\u53ef\u4ee5\u5728\u6587\u4ef6\u7cfb\u7edf\u4e2d\u76f4\u63a5\u7f16\u8f91\uff0c\u5bf9\u8fd9\u4e9b\u6587\u4ef6\u7684\u4fee\u6539\u4f1a\u5728\u52a0\u8f7d\u65f6\u81ea\u52a8\u5199\u56de\u6570\u636e\u5e93\u3002 Setup \u7c7b \u00b6 \u8981\u4e3a\u60a8\u7684\u9644\u52a0\u7ec4\u4ef6\u521b\u5efa\u4e00\u4e2a Setup \u7c7b\uff0c\u60a8\u9700\u8981\u505a\u7684\u5c31\u662f\u5728\u60a8\u9644\u52a0\u7ec4\u4ef6\u76ee\u5f55\u7684\u6839\u76ee\u5f55\u4e0b\u521b\u5efa\u4e00\u4e2a\u540d\u4e3a Setup.php \u7684\u6587\u4ef6\u3002 Setup \u7c7b\u5e94\u8be5\u7ee7\u627f /XF/AddOn/AbstractSetup \uff0c\u5b83\u81f3\u5c11\u9700\u8981\u5b9e\u4f5c install() \u3001 upgrade() \u548c uninstall() \u65b9\u6cd5\u3002 \u4e0b\u9762\u662f\u4e00\u4e2a\u7b80\u5358\u7684\u9644\u52a0\u7ec4\u4ef6 Setup \u7c7b\u7684\u6837\u5b50\u3002 <?php namespace Demo; class Setup extends \\XF\\AddOn\\AbstractSetup { public function install(array $stepParams = []) { $this->schemaManager()->createTable('xf_demo', function(\\XF\\Db\\Schema\\Create $table) { $table->addColumn('demo_id', 'int'); }); } public function upgrade(array $stepParams = []) { if ($this->addOn->version_id < 1000170) { $this->schemaManager()->alterTable('xf_demo', function(\\XF\\Db\\Schema\\Alter $table) { $table->addColumn('foo', 'varchar', 10)->setDefault(''); }); } } public function uninstall(array $stepParams = []) { $this->schemaManager()->dropTable('xf_demo'); } } Setup \u7c7b\u4e5f\u652f\u63f4\u5728\u4e0d\u540c\u7684\u6b65\u9aa4\u4e2d\u8fd0\u884c\u6bcf\u4e2a\u64cd\u4f5c\u3002 \u4e3a\u4e86\u5b9e\u73b0\u8fd9\u79cd\u884c\u4e3a\uff0c\u60a8\u7684 Setup \u7c7b\u53ef\u4ee5\u4f7f\u7528 StepRunnerInstallTrait \u3001 StepRunnerUpgradeTrait \u548c/\u6216 StepRunnerUninstallTrait \u7279\u6027 \u3002 \u8fd9\u4e9b\u90fd\u4f1a\u81ea\u52a8\u5b9e\u4f5c\u6240\u9700\u7684\u65b9\u6cd5\uff0c\u4f60\u53ea\u9700\u8981\u6dfb\u52a0\u76f8\u5173\u7684\u6b65\u9aa4\uff0c\u4f8b\u5982 installStep1() \u3001 upgrade1000170Step1() \u3001 upgrade1000170Step2() \u548c uninstallStep1() \uff0c\u5176\u4e2d\u5347\u7ea7\u65b9\u6cd5\u4e2d\u7684 1000170 \u7b49... \u662f\u9644\u52a0\u7ec4\u4ef6\u7684\u7248\u672c ID (\u53c2\u89c1 \u5efa\u8bae\u7248\u672c ID \u683c\u5f0f )\u3002","title":"\u9644\u52a0\u7ec4\u4ef6\u67b6\u6784"},{"location":"add-on-structure/#_1","text":"\u5728\u4ee5\u524d\u7684 XF \u7248\u672c\u4e2d\uff0c\u5f88\u5c11\u6709\u5173\u4e8e\u9644\u52a0\u7ec4\u4ef6\u5f00\u53d1\u7684\u6807\u51c6\u548c\u7ea6\u5b9a\u3002 \u5728 XF 2.0 \u7684\u529f\u80fd\u4e2d\uff0c\u6211\u4eec\u5df2\u7ecf\u505a\u4e86\u5f88\u591a\u4fee\u6539\u3002 \u8ba9\u6211\u4eec\u6765\u770b\u770b\u5176\u4e2d\u7684\u4e00\u4e9b\u53d8\u5316\uff1a","title":"\u9644\u52a0\u7ec4\u4ef6\u7ed3\u6784"},{"location":"add-on-structure/#id","text":"\u6bcf\u4e2a\u5b89\u88c5\u7684\u9644\u52a0\u7ec4\u4ef6\u90fd\u5fc5\u987b\u6709\u4e00\u4e2a\u552f\u4e00\u7684 ID\uff0c\u8fd9\u4e2a ID \u51b3\u5b9a\u4e86\u9644\u52a0\u7ec4\u4ef6\u5e94\u8be5\u5728\u6587\u4ef6\u7cfb\u7edf\u4e2d\u7684\u54ea\u4e2a\u4f4d\u7f6e\u4fdd\u5b58\u5176\u6587\u4ef6\u3002\u9644\u52a0\u7ec4\u4ef6\u7684 ID \u6709\u4e24\u79cd\u53ef\u80fd\u7684\u683c\u5f0f\u3002 \u7b2c\u4e00\u4e2a \"\u7b80\u5358\" \u7c7b\u578b\u5e94\u8be5\u662f\u4e00\u4e2a\u5358\u5b57\uff0c\u4e0d\u5305\u542b\u4efb\u4f55\u7279\u6b8a\u5b57\u7b26\u3002\u4f8b\u5982\uff0c Demo \u3002 \u7b80\u5358\u7684\u9644\u52a0\u7ec4\u4ef6 ID \u5fc5\u987b\u9075\u5b88\u4ee5\u4e0b\u89c4\u5219\uff1a \u5fc5\u987b\u53ea\u5305\u542b a-z \u6216 A-Z\u3002 \u53ef\u4ee5\u5305\u542b 0-9\uff0c\u4f46\u4e0d\u80fd\u653e\u5728 ID \u5f00\u5934\u3002 \u4e0d\u80fd\u5305\u542b\u4efb\u4f55\u7279\u6b8a\u5b57\u7b26\uff0c\u4f8b\u5982\u659c\u7ebf\u3001\u7834\u6298\u53f7\u6216\u4e0b\u5212\u7ebf\u3002 \u7b2c\u4e8c\u4e2a\u5305\u542b\u4e00\u4e2a\u4f9b\u5e94\u5546\u524d\u7f00\uff0c\u6240\u4ee5\u5982\u679c\u4f60\u5728\u4e00\u4e2a\u7279\u5b9a\u7684\u54c1\u724c\u6216\u516c\u53f8\u4e0b\u53d1\u5e03\u9644\u52a0\u7ec4\u4ef6\uff0c\u9644\u52a0\u7ec4\u4ef6 ID \u53ef\u4ee5\u8868\u660e\u8fd9\u4e00\u70b9\u3002\u4f8b\u5982\uff0c SomeVendor/Demo \u3002 \u4f9b\u5e94\u5546\u7c7b\u578b\u7684\u9644\u52a0 ID \u5e94\u9075\u5b88\u4ee5\u4e0b\u89c4\u5219\uff1a \u5fc5\u987b\u53ea\u5305\u542b a-z \u6216 A-Z \u53ef\u5305\u542b\u4e00\u4e2a / \u5b57\u7b26\uff0c\u4f46\u4e0d\u80fd\u5728\u5f00\u5934\u6216\u7ed3\u5c3e\u5904 \u53ef\u4ee5\u5305\u542b 0-9\uff0c\u4f46\u4e0d\u5728\u9644\u52a0\u7ec4\u4ef6 ID \u7684\u4efb\u4f55\u4e00\u4e2a\u90e8\u5206\u7684\u5f00\u5934 \u4e00\u65e6\u60a8\u51b3\u5b9a\u4e86\u9644\u52a0\u7ec4\u4ef6\u7684 ID\uff0c\u6211\u4eec\u5c31\u77e5\u9053\u8fd9\u4e2a\u9644\u52a0\u7ec4\u4ef6\u7684\u6587\u4ef6\u5c06\u4fdd\u5b58\u5728\u54ea\u91cc\u3002 \u6240\u6709 XF 2.0 \u9644\u52a0\u7ec4\u4ef6\u90fd\u4fdd\u5b58\u5728 src/addons \u76ee\u5f55\u7684\u5b50\u76ee\u5f55\u4e2d\u3002 \u5982\u679c\u4f60\u6709\u4e00\u4e2a\u7b80\u5358\u7684\u9644\u52a0\u7ec4\u4ef6 ID\uff0c\u4f8b\u5982 Demo \uff0c\u4f60\u7684\u9644\u52a0\u7ec4\u4ef6\u6587\u4ef6\u5c06\u4fdd\u5b58\u5728\u4ee5\u4e0b\u4f4d\u7f6e\uff1a src/addons/Demo \u3002 \u5982\u679c\u4f60\u6709\u4e00\u4e2a\u57fa\u4e8e\u5382\u5546\u7684\u9644\u52a0\u7ec4\u4ef6 ID\uff0c\u4f8b\u5982 SomeVendor/Demo \uff0c\u6587\u4ef6\u5c06\u4fdd\u5b58\u5728\u4ee5\u4e0b\u4f4d\u7f6e\uff1a src/addons/SomeVendor/Demo \u3002 \u60a8\u9009\u62e9\u7684\u9644\u52a0\u7ec4\u4ef6 ID \u4e5f\u5c06\u6210\u4e3a\u60a8\u7684\u7c7b\u522b\u547d\u540d\u7a7a\u95f4\u524d\u7f00\uff08\u66f4\u591a\u4fe1\u606f\u8bf7\u53c2\u89c1 \u547d\u540d\u7a7a\u95f4 \uff09\u3002","title":"\u9644\u52a0\u7ec4\u4ef6 ID \u548c\u9644\u52a0\u7ec4\u4ef6\u8def\u5f84"},{"location":"add-on-structure/#_2","text":"XF \u672c\u8eab\u4f7f\u7528 MAJOR.MINOR.PATCH \u539f\u5219\uff08\u4f8b\u5982 2.0.0 \u4ee3\u8868\u7b2c\u4e00\u4e2a\u7a33\u5b9a\u7684 XF2 \u7248\u672c\uff09\u6765\u8fdb\u884c\u7248\u672c\u7f16\u53f7\uff0c\u6211\u4eec\u5efa\u8bae\u5bf9\u60a8\u81ea\u5df1\u7684\u9644\u52a0\u7ec4\u4ef6\u7684\u7248\u672c\u7f16\u53f7\u91c7\u53d6\u7c7b\u4f3c\u7684\u65b9\u6cd5\u3002 \u57fa\u672c\u4e0a\uff0c\u5728\u7248\u672c\u53f7\u4e2d\u589e\u52a0 MAJOR \u7248\u672c\uff0c\u5f53\u4f60\u505a\u4e86\u91cd\u5927\u7684\u529f\u80fd\u6539\u53d8\uff0c\u7279\u522b\u662f\u7834\u574f\u4e86\u5411\u540e\u517c\u5bb9\u6027\u7684\u6539\u53d8 MINOR \u7248\u672c\uff0c\u5f53\u4f60\u6dfb\u52a0\u529f\u80fd\u65f6\uff0c\u6700\u597d\u662f\u4ee5\u5411\u540e\u517c\u5bb9\u7684\u65b9\u5f0f\u6dfb\u52a0 PATCH \u7248\u672c\uff0c\u5f53\u4f60\u8fdb\u884c\u5411\u540e\u517c\u5bb9\u7684 Bug \u4fee\u590d\u65f6\u4f7f\u7528","title":"\u5efa\u8bae\u7248\u672c\u5b57\u7b26\u4e32\u683c\u5f0f"},{"location":"add-on-structure/#id_1","text":"\u9644\u52a0\u7ec4\u4ef6\u7684\u7248\u672c ID \u662f\u57fa\u672c\u7684\u6574\u6570\uff0c\u7528\u4e8e\u5185\u90e8\u7248\u672c\u6bd4\u8f83\u3002 \u5b83\u8ba9\u6211\u4eec\u53ef\u4ee5\u66f4\u5bb9\u6613\u5730\u68c0\u6d4b\u5230\u4e00\u4e2a\u7248\u672c\u6bd4\u53e6\u4e00\u4e2a\u7248\u672c\u65e7\u3002 \u60a8\u7684\u9644\u52a0\u7ec4\u4ef6\u6bcf\u4e2a\u7248\u672c\u90fd\u5e94\u8be5\u5c06\u7248\u672c\u53f7 ID \u81f3\u5c11\u589e\u52a0 1\uff0c\u4f46\u6211\u4eec\u5185\u90e8\u5bf9 XF \u672c\u8eab\u4f7f\u7528\u7684\u60ef\u4f8b\uff0c\u5bf9\u9644\u52a0\u7ec4\u4ef6\u4e5f\u6709\u6f5c\u5728\u7684\u4f5c\u7528\u3002 \u6211\u4eec\u7684\u7248\u672c ID \u7684\u683c\u5f0f\u4e3a aabbccde \u3002 aa \u4ee3\u8868 MAJOR \u7248\u672c bb \u4ee3\u8868 MINOR \u7248\u672c cc \u4ee3\u8868 PATCH \u7248\u672c d \u4ee3\u8868\u72b6\u6001\uff0c\u4f8b\u5982 1 \u4ee3\u8868 alpha \u7248\u672c\uff0c 3 \u4ee3\u8868 beta \u7248\u672c\uff0c 5 \u4ee3\u8868\u5019\u9009\u7248\u672c\uff0c 7 \u4ee3\u8868\u7a33\u5b9a\u7248\u672c e \u4ee3\u8868\u7248\u672c Level \u72b6\u6001 \u4f8b\u5982\uff0c\u4e00\u4e2a\u7248\u672c\u53f7\u662f 1.7.3 \u5019\u9009\u7248\u672c 4 \u5b83\u7684\u9644\u52a0\u7ec4\u4ef6 ID \u4e3a \"1070354\"\u3002 \u6700\u7ec8\u7a33\u5b9a\u7248 XF2 \u7684ID\u4e3a 2000070 \u3002 XF \u7684 1.5.0 Beta 3 \u7248\u672c\u7684 ID \u4e3a 1050033 \u3002 \u7a33\u5b9a\u7248 99.99.99 \u4f1a\u6709\u4e00\u4e2aID\u4e3a 99999970 ... \u4e5f\u8bb8\u4f60\u5e94\u8be5\u6162\u4e00\u70b9 \ud83d\ude09\u3002","title":"\u5efa\u8bae\u7248\u672c ID \u683c\u5f0f"},{"location":"add-on-structure/#_3","text":"\u5728\u9644\u52a0\u7ec4\u4ef6\u7684\u76ee\u5f55\u4e2d\uff0c\u6709\u4e00\u4e9b\u6587\u4ef6\u548c\u76ee\u5f55\u6709\u7279\u6b8a\u7684\u7528\u9014\u548c\u610f\u4e49\u3002","title":"\u5e38\u89c1\u7684\u9644\u52a0\u7ec4\u4ef6\u6587\u4ef6\u548c\u76ee\u5f55"},{"location":"add-on-structure/#addonjson","text":"addon.json \u662f\u4e00\u4e2a\u5305\u542b\u4e00\u4e9b\u4fe1\u606f\u7684\u6587\u4ef6\uff0c\u8fd9\u4e9b\u4fe1\u606f\u662f\u5e2e\u52a9 XF 2.0 \u8bc6\u522b\u9644\u52a0\u7ec4\u4ef6\u5e76\u5728 Admin CP \u4e2d\u663e\u793a\u5176\u4fe1\u606f\u6240\u5fc5\u9700\u7684\u3002 \u6700\u8d77\u7801\uff0c\u4f60\u7684 addon.json \u6587\u4ef6\u5e94\u8be5\u770b\u8d77\u6765\u8c61\u8fd9\u6837\uff1a { \"title\": \"My Add-on by Some Company\", \"version_string\": \"2.0.0\", \"version_id\": 2000070, \"dev\": \"Some Company\" } \u521b\u5efa\u9644\u52a0\u7ec4\u4ef6\u65f6\uff0c\u4f1a\u81ea\u52a8\u4e3a\u60a8\u521b\u5efa\u4e00\u4e2a\u57fa\u672c\u6587\u4ef6\u3002 \u5305\u542b\u4e00\u4e2a\u6709\u6548\u7684 addon.json \u6587\u4ef6\u662f\u4f60\u7684\u9644\u52a0\u7ec4\u4ef6\u88ab\u8bc6\u522b\u7684\u5fc5\u8981\u6761\u4ef6\uff0c\u4f60\u53ef\u4ee5\u968f\u65f6 \u9a8c\u8bc1\u4f60\u7684 addon.json \u6587\u4ef6 \u3002","title":"addon.json \u6587\u4ef6"},{"location":"add-on-structure/#_4","text":"Property Description legacy_addon_id \u5f53\u4ece XenForo 1 \u5347\u7ea7\u81f3 XenForo 2 \u65f6\uff0c\u7528\u6765\u5f00\u542f\u81ea\u52a8\u5904\u7406\u9644\u52a0\u7ec4\u4ef6 ID \u66f4\u6539\u3002 title \u9644\u52a0\u7ec4\u4ef6\u7684\u6807\u9898\u3002 \u8fd9\u5c06\u663e\u793a\u5728\u7ba1\u7406\u9762\u677f\u4e2d\u3002 description \u9644\u52a0\u7ec4\u4ef6\u7684\u63cf\u8ff0\u3002\u8fd9\u5c06\u663e\u793a\u5728\u7ba1\u7406\u9762\u677f\u4e2d\u3002 version_id XenForo \u7528\u6765\u8ffd\u8e2a\u9644\u52a0\u7ec4\u4ef6\u66f4\u65b0\u7684\u5185\u90e8 ID\u3002 \u6bcf\u6b21\u53d1\u5e03\u65f6\u5fc5\u987b\u9012\u589e\u3002 version_string \u4eba\u7c7b\u53ef\u4ee5\u8bfb\u61c2\u7684\u9644\u52a0\u7ec4\u4ef6\u7248\u672c\u3002 \u8fd9\u5c06\u5728\u7ba1\u7406\u9762\u677f\u4e2d\u663e\u793a\uff0c\u800c\u4e0d\u662f version_id \u5c5e\u6027\u3002 dev \u9644\u52a0\u7ec4\u4ef6\u5f00\u53d1\u8005\u7684\u540d\u5b57\u3002\u8fd9\u5c06\u663e\u793a\u5728\u7ba1\u7406\u9762\u677f\u4e2d\u3002 dev_url \u5982\u679c\u8bbe\u7f6e\u4e86\uff0c\u5f00\u53d1\u8005\u7684\u540d\u5b57\u5c06\u4ee5\u8d85\u94fe\u63a5\u7684\u5f62\u5f0f\u663e\u793a\u5728\u7ba1\u7406\u9762\u677f\u4e2d\uff0c\u5e76\u4ee5 (href) \u6b64\u4e3a\u76ee\u6807\u3002 faq_url \u5982\u679c\u8bbe\u7f6e\u4e86\uff0c\u4e00\u4e2a FAQ \u7684\u8d85\u94fe\u63a5\u5c06\u663e\u793a\u5728\u7ba1\u7406\u9762\u677f\u4e2d\uff0c\u5e76\u4ee5 (href) \u6b64\u4e3a\u76ee\u6807\u3002 support_url \u5982\u679c\u8bbe\u7f6e\u4e86\uff0c\u652f\u63f4\u5e2e\u52a9\u7684\u8d85\u94fe\u63a5\u5c06\u663e\u793a\u5728\u7ba1\u7406\u9762\u677f\u4e2d\uff0c\u5e76\u4ee5 (href) \u6b64\u4e3a\u76ee\u6807\u3002 extra_urls \u8fd9\u5141\u8bb8\u60a8\u663e\u793a\u4e0e\u9644\u52a0\u7ec4\u4ef6\u76f8\u5173\u7684\u5176\u4ed6\u5185\u5bb9\u94fe\u63a5\uff08\u53ef\u80fd\u662f\u9519\u8bef\u62a5\u544a\u94fe\u63a5\uff0c\u624b\u518c - \u968f\u60a8\u559c\u6b22\uff09\u3002 \u4e00\u4e2a JSON \u7269\u4ef6\u7684\u6570\u7ec4\uff0c\u5176\u4e2d key \u662f\u94fe\u63a5\u6587\u672c\uff0cvalue \u662f\u94fe\u63a5\u76ee\u6807 (href)\u3002 require XenForo \u5141\u8bb8\u5b89\u88c5\u9644\u52a0\u7ec4\u4ef6\u65f6\u9700\u8981\u6ee1\u8db3\u7684\u4e00\u7cfb\u5217\u8981\u6c42\u3002 \u66f4\u591a\u4fe1\u606f\u8bf7\u53c2\u89c1 'require \u5c5e\u6027' \u3002 icon \u8d44\u6e90\u7684\u56fe\u6807\u3002 \u8fd9\u53ef\u4ee5\u662f\u4e00\u4e2a Font Awesome \u56fe\u6807\u540d\u79f0\uff08\u4f8b\u5982 fa-shopping-bag \uff0c\u6216\u4e00\u4e2a\u56fe\u50cf\u6587\u4ef6\u7684\u8def\u5f84\uff09\u3002","title":"\u5c5e\u6027"},{"location":"add-on-structure/#require","text":"\u5982\u679c\u73af\u5883\u4e0d\u652f\u63f4\u6216\u4e0d\u6ee1\u8db3\u8981\u6c42\uff0crequire \u5c5e\u6027\u662f\u963b\u6b62\u9644\u52a0\u7ec4\u4ef6\u5b89\u88c5\u6216\u5347\u7ea7\u7684\u6807\u51c6\u65b9\u6cd5\u3002 \u4f60\u53ef\u4ee5\u7528\u5b83\u6765\u8981\u6c42\u5148\u5b89\u88c5\u5176\u4ed6\u9644\u52a0\u7ec4\u4ef6\uff0c\u8981\u6c42\u67d0\u4e9b PHP \u6269\u5c55\u5fc5\u987b\u5b58\u5728\u6216\u6fc0\u6d3b\uff0c\u548c/\u6216 \u5f3a\u5236\u6267\u884c\u4e00\u4e2a\u6700\u4f4e\u7684 PHP \u7248\u672c\u3002 \u8fd9\u662f\u4e00\u4e2a\u793a\u4f8b\u7247\u6bb5\uff1a ... \"require\": { \"XF\": [2000010, \"XenForo 2.0.0+\"], \"php\": [\"5.4.0\", \"PHP 5.4.0+\"], \"php-ext/json\": [\"*\", \"JSON extension\"] } ... \u6bcf\u4e2a require\uff0c\u90fd\u662f\u4e00\u4e2a\u547d\u540d\u6570\u7ec4\u3002 \u6570\u7ec4\u7684\u540d\u79f0\u662f\u4ea7\u54c1 ID (\u5982 XF \u6216 php )\u3002 \u7b2c\u4e00\u4e2a\u6570\u7ec4\u5143\u7d20\u662f\u4ea7\u54c1\u7684\u7248\u672c (\u5982 2000010 \u6216 5.4.0 )\u3002 \u4f60\u53ef\u4ee5\u4f7f\u7528 * \u6765\u8868\u793a\u4ea7\u54c1\u7684\u4efb\u4f55\u7248\u672c\u3002 \u7b2c\u4e8c\u4e2a\u6570\u7ec4\u5143\u7d20\u662f\u8be5 require \u4eba\u7c7b\u53ef\u4ee5\u9605\u8bfb\u7684\u6587\u672c\uff0c\u8fd9\u662f\u5728\u6d88\u606f\u4e2d\u4f7f\u7528\u7684\u5185\u5bb9\uff08\u4f8b\u5982 XenForo 2.0.0+ \u6216 PHP 5.4.0+ \uff09\u3002 \u4e0b\u9762\u662f\u53d7\u652f\u63f4\u7684\u4ea7\u54c1 ID \u7684\u6982\u8ff0\uff1a \u4ea7\u54c1 / Require \u540d\u79f0 \u53c2\u8003... \u503c XF XenForo \u7684\u5b89\u88c5\u7248\u672c\u3002 XenForo \u7248\u672c ID\uff0c\u4f8b\u5982 200010 \u3002 \u4f60\u53ef\u4ee5\u901a\u8fc7\u68c0\u67e5 /src/XF.php \u6587\u4ef6\u9876\u90e8\u7684 $versionId \u5b9a\u4e49\u6216\u8005\u6253\u5370 /XF::$versionId \u7684\u503c\u6765\u83b7\u53d6\u5f53\u524d XenForo \u7684\u7248\u672c\u3002 php PHP \u7248\u672c\u3002 PHP \u7248\u672c\uff0c\u4f8b\u5982 5.4.0 \u3002 \u5efa\u8bae\u4f60\u5c3d\u53ef\u80fd\u964d\u4f4e\u8fd9\u4e2a\u503c\uff1b\u66f4\u65b0\u4e00\u4e2a PHP \u7248\u672c\u53ef\u80fd\u662f\u4e00\u4e2a\u76f8\u5f53\u590d\u6742\u7684\u5de5\u4f5c - \u7279\u522b\u662f\u5f53\u5176\u4ed6\u9644\u52a0\u7ec4\u4ef6\u4e0e\u65b0\u7684 PHP \u7248\u672c\u51b2\u7a81\u65f6\u3002 php-ext / (extension name) \u4e00\u4e2a PHP \u6269\u5c55 - \u5176\u4e2d (extension name) \u662f\u6269\u5c55\u7684\u540d\u79f0\u3002 PHP \u6269\u5c55\u7248\u672c\u3002 \u8fd9\u662f\u7528 PHP \u7684 version_compare \u51fd\u6570\u6765\u68c0\u67e5\u7684\uff0c\u6240\u4ee5\u5b83\u751a\u81f3\u9002\u7528\u4e8e\u5b98\u65b9\u5b8c\u6574 PHP \u683c\u5f0f\u7684\u7248\u672c\u5b57\u7b26\u4e32\uff0c\u6bd4\u5982 7.1.19-1+ubuntu16.04.1+deb.sury.org+1 \u3002 (any addon ID) \u4efb\u4f55 XenForo \u9644\u52a0\u7ec4\u4ef6\uff0c\u5982 Demo/Addon \u3002\u5982\u679c\u60a8\u4e0d\u786e\u5b9a\u67d0\u4e2a\u9644\u52a0\u7ec4\u4ef6\u7684 ID\uff0c\u8bf7\u67e5\u770b\u5b83\u7684 addon.json \u6587\u4ef6\u3002 \u9644\u52a0\u7ec4\u4ef6\u7684\u7248\u672c ID\u3002 \u60a8\u53ef\u4ee5\u53c2\u8003 \u5efa\u8bae\u7248\u672c ID \u683c\u5f0f \u4e86\u89e3\u66f4\u591a\u4fe1\u606f\u3002","title":"require \u5c5e\u6027"},{"location":"add-on-structure/#hashesjson","text":"hashes.json \u662f\u4e3a\u6587\u4ef6\u5065\u68c0\u7cfb\u7edf\u6dfb\u52a0\u652f\u63f4\u7684\u65b0\u65b9\u6cd5\uff0c\u800c\u4e14\u6700\u597d\u7684\u90e8\u5206\u662f - \u5b83\u662f\u81ea\u52a8\u751f\u6210\u7684\uff01 \u4f5c\u4e3a\u6784\u5efa\u8fc7\u7a0b\u7684\u4e00\u90e8\u5206\uff08\u7a0d\u540e\u4f1a\u6709\u66f4\u591a\u8bf4\u660e\uff09\uff0c\u6211\u4eec\u5c06\u5bf9\u60a8\u6240\u6709\u9644\u52a0\u7ec4\u4ef6\u7684\u6587\u4ef6\u8fdb\u884c\u5feb\u901f\u6e05\u70b9\uff0c\u5e76\u5c06\u8ba1\u7b97\u51fa\u7684\u6587\u4ef6\u5185\u5bb9\u54c8\u5e0c\u7801\u5199\u5165\u5176\u4e2d\u3002","title":"hashes.json \u6587\u4ef6"},{"location":"add-on-structure/#setupphp","text":"Setup.php \u662f\u60a8\u5b89\u88c5\u3001\u5347\u7ea7\u6216\u5378\u8f7d\u9644\u52a0\u7ec4\u4ef6\u65f6\u9700\u8981\u8fd0\u884c\u7684\u4efb\u4f55\u4ee3\u7801\u7684\u65b0\u4e3b\u9875\u3002 \u4e0b\u9762 \u6211\u4eec\u5c06\u8be6\u7ec6\u4ecb\u7ecd\u5982\u4f55\u521b\u5efa\u4e00\u4e2a Setup \u7c7b\u3002","title":"Setup.php \u6587\u4ef6"},{"location":"add-on-structure/#_data","text":"_data \u76ee\u5f55\u662f\u4fdd\u5b58\u60a8\u7684\u9644\u52a0\u7ec4\u4ef6\u4e3b\u8981\u6570\u636e\u7684\u5730\u65b9\u3002 \u6bcf\u4e2a\u9644\u52a0\u7ec4\u4ef6\u7684\u6570\u636e\u7c7b\u578b\u90fd\u4f1a\u6709\u81ea\u5df1\u7684 XML \u6587\u4ef6\uff08\u800c\u4e0d\u662f\u6240\u6709\u7c7b\u578b\u7684\u5358\u4e2a\u6587\u4ef6\uff09\u3002\u8fd9\u4e9b\u6587\u4ef6\u7684\u54c8\u5e0c\u503c\u88ab\u5305\u542b\u5728 hashes.json \u4e2d\uff0c\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u5728\u5141\u8bb8\u5b89\u88c5\u9644\u52a0\u7ec4\u4ef6\u4e4b\u524d\u786e\u4fdd\u9644\u52a0\u7ec4\u4ef6\u62e5\u6709\u5b8c\u6574\u548c\u4e00\u81f4\u7684\u6570\u636e\u3002","title":"_data \u76ee\u5f55"},{"location":"add-on-structure/#_output","text":"_output \u76ee\u5f55\u4e0d\u662f\u6210\u529f\u5b89\u88c5\u9644\u52a0\u7ec4\u4ef6\u6240\u5fc5\u9700\u7684\uff0c\u800c\u4e14\u5728\u53d1\u5e03\u9644\u52a0\u7ec4\u4ef6\u65f6\u4e5f\u4e0d\u5e94\u8be5\u5305\u62ec\u5728\u5185\u3002 \u8fd9\u4e2a\u76ee\u5f55\u7eaf\u7cb9\u662f\u4e3a\u4e86\u5f00\u53d1\u76ee\u7684\uff0c\u53ea\u6709\u5728\u6fc0\u6d3b\u5f00\u53d1\u6a21\u5f0f\u65f6\u624d\u4f1a\u4f7f\u7528\uff08\u53c2\u89c1 \u6fc0\u6d3b\u5f00\u53d1\u6a21\u5f0f \uff09\u3002 \u6bcf\u9879\u9644\u52a0\u7ec4\u4ef6\u6570\u636e\u90fd\u4fdd\u5b58\u5728\u4e00\u4e2a\u5358\u72ec\u7684\u6587\u4ef6\u4e2d\u3002 \u5927\u591a\u6570\u60c5\u51b5\u4e0b\uff0c\u5b83\u4eec\u88ab\u4fdd\u5b58\u6210 JSON \u6587\u4ef6\uff0c\u4f46\u5bf9\u4e8e\u77ed\u8bed\uff0c\u5b83\u4eec\u88ab\u4fdd\u5b58\u4e3a TXT \u6587\u4ef6\uff0c\u5bf9\u4e8e\u6a21\u677f\uff0c\u5b83\u4eec\u88ab\u4fdd\u5b58\u4e3a HTML/CSS/LESS \u6587\u4ef6\u3002 \u6240\u6709\u7684\u6a21\u677f\u7c7b\u578b\u90fd\u53ef\u4ee5\u5728\u6587\u4ef6\u7cfb\u7edf\u4e2d\u76f4\u63a5\u7f16\u8f91\uff0c\u5bf9\u8fd9\u4e9b\u6587\u4ef6\u7684\u4fee\u6539\u4f1a\u5728\u52a0\u8f7d\u65f6\u81ea\u52a8\u5199\u56de\u6570\u636e\u5e93\u3002","title":"_output \u76ee\u5f55"},{"location":"add-on-structure/#setup","text":"\u8981\u4e3a\u60a8\u7684\u9644\u52a0\u7ec4\u4ef6\u521b\u5efa\u4e00\u4e2a Setup \u7c7b\uff0c\u60a8\u9700\u8981\u505a\u7684\u5c31\u662f\u5728\u60a8\u9644\u52a0\u7ec4\u4ef6\u76ee\u5f55\u7684\u6839\u76ee\u5f55\u4e0b\u521b\u5efa\u4e00\u4e2a\u540d\u4e3a Setup.php \u7684\u6587\u4ef6\u3002 Setup \u7c7b\u5e94\u8be5\u7ee7\u627f /XF/AddOn/AbstractSetup \uff0c\u5b83\u81f3\u5c11\u9700\u8981\u5b9e\u4f5c install() \u3001 upgrade() \u548c uninstall() \u65b9\u6cd5\u3002 \u4e0b\u9762\u662f\u4e00\u4e2a\u7b80\u5358\u7684\u9644\u52a0\u7ec4\u4ef6 Setup \u7c7b\u7684\u6837\u5b50\u3002 <?php namespace Demo; class Setup extends \\XF\\AddOn\\AbstractSetup { public function install(array $stepParams = []) { $this->schemaManager()->createTable('xf_demo', function(\\XF\\Db\\Schema\\Create $table) { $table->addColumn('demo_id', 'int'); }); } public function upgrade(array $stepParams = []) { if ($this->addOn->version_id < 1000170) { $this->schemaManager()->alterTable('xf_demo', function(\\XF\\Db\\Schema\\Alter $table) { $table->addColumn('foo', 'varchar', 10)->setDefault(''); }); } } public function uninstall(array $stepParams = []) { $this->schemaManager()->dropTable('xf_demo'); } } Setup \u7c7b\u4e5f\u652f\u63f4\u5728\u4e0d\u540c\u7684\u6b65\u9aa4\u4e2d\u8fd0\u884c\u6bcf\u4e2a\u64cd\u4f5c\u3002 \u4e3a\u4e86\u5b9e\u73b0\u8fd9\u79cd\u884c\u4e3a\uff0c\u60a8\u7684 Setup \u7c7b\u53ef\u4ee5\u4f7f\u7528 StepRunnerInstallTrait \u3001 StepRunnerUpgradeTrait \u548c/\u6216 StepRunnerUninstallTrait \u7279\u6027 \u3002 \u8fd9\u4e9b\u90fd\u4f1a\u81ea\u52a8\u5b9e\u4f5c\u6240\u9700\u7684\u65b9\u6cd5\uff0c\u4f60\u53ea\u9700\u8981\u6dfb\u52a0\u76f8\u5173\u7684\u6b65\u9aa4\uff0c\u4f8b\u5982 installStep1() \u3001 upgrade1000170Step1() \u3001 upgrade1000170Step2() \u548c uninstallStep1() \uff0c\u5176\u4e2d\u5347\u7ea7\u65b9\u6cd5\u4e2d\u7684 1000170 \u7b49... \u662f\u9644\u52a0\u7ec4\u4ef6\u7684\u7248\u672c ID (\u53c2\u89c1 \u5efa\u8bae\u7248\u672c ID \u683c\u5f0f )\u3002","title":"Setup \u7c7b"},{"location":"controller-basics/","text":"\u63a7\u5236\u5668\u57fa\u7840\u77e5\u8bc6 \u00b6 \u5728\u57fa\u672c\u5c42\u9762\u4e0a\uff0cController \u662f\u5f53\u4f60\u5728 XF \u4e2d\u8bbf\u95ee\u4e00\u4e2a\u9875\u9762\u65f6\u8fd0\u884c\u7684\u4ee3\u7801\u3002 \u5728\u57fa\u672c\u5c42\u9762\u4e0a\uff0cController \u4e00\u822c\u8d1f\u8d23\u5904\u7406\u7528\u6237\u7684\u8f93\u5165\uff0c\u5e76\u5c06\u7528\u6237\u7684\u8f93\u5165\u4f20\u9012\u5230\u9002\u5f53\u7684\u5730\u65b9\uff0c\u901a\u5e38\u662f\u8fd0\u884c\u67d0\u79cd\u6570\u636e\u5e93\u64cd\u4f5c\uff08Model\uff09\u6216\u52a0\u8f7d\u53ef\u89c6\u5316\u5185\u5bb9\uff08View\uff09\u3002 \u5f53\u7528\u6237\u70b9\u51fb\u94fe\u63a5\u65f6\uff0c\u8bf7\u6c42\u7684 URL \u4f1a\u88ab\u8def\u7531\u5bfc\u5230\u7279\u5b9a\u7684 Controller \u548c Controller action\u3002 \u53c2\u89c1 \u8def\u7531\u57fa\u7840\u77e5\u8bc6 \u3002 \u4f8b\u5982\uff0c\u5728 XF \u4e2d\uff0c\u5982\u679c\u4f60\u70b9\u51fb\u4e00\u4e2a\u7c7b\u4f3c\u4e8e index.php?conversations/add \u7684 URL\uff0c\u4f60\u5c06\u88ab\u8def\u7531\u5bfc\u5230 XF\\Pub\\Controller\\Conversation Controller \u548c add action\u3002 \u5982\u679c\u4f60\u5728\u6587\u4ef6\u7cfb\u7edf\u4e2d\u67e5\u770b\u8fd9\u4e2a class\uff08\u53c2\u89c1 \u81ea\u52a8\u52a0\u8f7d\u5668 \uff0c\u4ee5\u4e86\u89e3 class \u548c\u6587\u4ef6\u8def\u5f84\u5982\u4f55\u76f8\u4e92\u6620\u5c04\u7684\u63cf\u8ff0\uff09\uff0c\u4f60\u4f1a\u6ce8\u610f\u5230\u6709\u8bb8\u591a\u65b9\u6cd5\u4ee5 action \u4e3a\u524d\u7f00\u547d\u540d\u3002 \u6240\u6709\u8fd9\u4e9b\u65b9\u6cd5\u90fd\u8868\u793a\u4e00\u4e2a\u7279\u5b9a\u7684 Controller action\u3002 \u6240\u4ee5\uff0c\u8981\u60f3\u5728\u67e5\u770b\u4e0a\u9762\u63d0\u5230\u7684 conversations/add \u9875\u9762\u65f6\u770b\u5230\u76f8\u5173\u4ee3\u7801\uff0c\u8bf7\u5728\u8fd9\u4e2a\u6587\u4ef6\u4e2d\u67e5\u627e public function actionAdd() \u3002 XF Controller \u8d1f\u8d23\u8fd4\u56de\u4e00\u4e2a reply \u7269\u4ef6\uff0c\u8be5\u7269\u4ef6\u4e00\u822c\u5305\u62ec\u4ee5\u4e0b\u7c7b\u578b\u4e4b\u4e00\uff1a View \u56de\u5e94 \u00b6 \u8fd9\u662f XF \u5f00\u53d1\u8fc7\u7a0b\u4e2d\u6700\u5e38\u89c1\u7684\u56de\u5e94\u4e4b\u4e00\u3002 \u4e00\u4e2a\u8fd4\u56de View \u56de\u5e94\u7684 Controller \u901a\u5e38\u9700\u8981\u4f20\u9012\u591a\u8fbe\u4e09\u4e2a\u53c2\u6570\u3002 \u4e00\u4e2a View class (\u4e0b\u9762\u4f1a\u6709\u66f4\u591a\u7684\u4ecb\u7ecd)\uff0c\u4e00\u4e2a\u6a21\u677f\u540d\u79f0\uff0c\u4ee5\u53ca\u4e00\u4e2a\u7531 $viewParams \u7ec4\u6210\u7684\u6570\u7ec4\uff0c\u8fd9\u4e2a\u6570\u7ec4\u662f\u6a21\u677f\u5e94\u8be5\u6709\u7684\u6570\u636e\u3002 \u8fd9\u91cc\u662f\u4e00\u4e2a\u5178\u578b\u7684 Controller action \u7684\u4f8b\u5b50\uff0c\u5b83\u8fd4\u56de\u4e00\u4e2a View \u56de\u5e94\uff1a public function actionExample() { $hello = 'Hello'; $world = 'world!'; $viewParams = [ 'hello' => $hello, 'world' => $world ]; return $this->view('Demo:Example', 'demo_example', $viewParams); } \u7b2c\u4e00\u4e2a\u53c2\u6570\u662f\u4e00\u4e2a\u7279\u5b9a View class \u7684\u7b80\u77ed class \u540d\u3002 \u8fd9\u4e2a class \u53ef\u80fd\u5b58\u5728\uff0c\u4e5f\u53ef\u80fd\u4e0d\u5b58\u5728\uff08\u901a\u5e38\u60c5\u51b5\u4e0b\uff0c\u5b83\u4e0d\u9700\u8981\u5b58\u5728\uff0c\u6211\u4eec\u5728\u540e\u9762\u4f1a\u4ecb\u7ecd\u66f4\u591a\u5730 View class \uff09\uff0c\u4f46\u5b83\u5e94\u8be5\u6709\u4e00\u4e2a Controller \u548c action \u7684\u5927\u81f4\u552f\u4e00\u540d\u79f0\u3002 \u4e0e\u5176\u4ed6 \u77ed\u7c7b\u540d \u4e00\u6837\uff0c\u4e0a\u9762\u7684\u7279\u5b9a\u77ed\u7c7b\u540d\u5c06\u89e3\u6790\u4e3a Demo/Pub/View/Example \u3002 \u540c\u6837\uff0c Pub \u662f\u7531 Controller \u7c7b\u578b\u81ea\u52a8\u63a8\u65ad\u51fa\u6765\u7684\u3002 \u7b2c\u4e8c\u4e2a\u53c2\u6570\u662f\u6a21\u677f\u540d\u79f0\u3002 \u5728\u672c\u4f8b\u4e2d\uff0c\u6211\u4eec\u6b63\u5728\u5bfb\u627e\u4e00\u4e2a\u540d\u4e3a demo_example \u7684\u6a21\u677f\u3002 \u7b2c\u4e09\u4e2a\u53c2\u6570\u662f \u5e94\u8be5\u63d0\u4f9b\u7ed9 view \u6a21\u677f \u53c2\u6570/\u503c \u7684\u6570\u7ec4\u3002 \u8fd9\u4e2a\u6570\u7ec4\u4e00\u822c\u5e94\u8be5\u662f\u4e00\u5bf9 key => value \u3002 \u4e0a\u9762\u7684\u4f8b\u5b50\u662f\u5c06\u4e24\u4e2a\u6a21\u677f\u53c2\u6570\u4f20\u9012\u7ed9\u6a21\u677f\u3002 \u6570\u7ec4\u4e2d\u7684 key \u90e8\u5206\u8868\u793a\u6a21\u677f\u4e2d\u53ef\u7528\u7684\u53d8\u91cf\u540d\u79f0\u3002 \u6570\u7ec4\u4e2d\u7684 value \u90e8\u5206\u8868\u793a\u503c\u3002 \u56e0\u6b64\uff0c\u5982\u679c\u6211\u4eec\u5728 demo_example \u6a21\u677f\u4e2d\u6709\u4ee5\u4e0b\u5185\u5bb9\uff1a {$hello} {$world} \u8be5\u6a21\u677f\u5c06\u8f93\u51fa\u4ee5\u4e0b\u5185\u5bb9\uff1a Hello world! \u91cd\u65b0\u5bfc\u5411\u56de\u5e94 \u00b6 \u5f53\u4f60\u5e0c\u671b\u5728\u7528\u6237\u5b8c\u6210\u67d0\u79cd\u64cd\u4f5c\u540e\u5c06\u5176\u91cd\u65b0\u5bfc\u5411\u5230\u4e0d\u540c\u7684 URL \u65f6\uff0c\u4f1a\u8fd4\u56de\u8fd9\u4e2a\u56de\u5e94\u3002 \u4e00\u4e2a\u5e38\u89c1\u7684\u4f7f\u7528\u6848\u4f8b\u662f\u5728\u7528\u6237\u901a\u8fc7\u8868\u5355\u63d0\u4ea4\u6570\u636e\u540e\uff0c\u4f60\u53ef\u80fd\u5e0c\u671b\u5c06\u4ed6\u4eec\u91cd\u65b0\u5bfc\u5411\u5230\u4e0d\u540c\u7684\u9875\u9762\uff0c\u4f8b\u5982\u5c06\u7528\u6237\u8fd4\u56de\u5230\u4e00\u4e2a\u9879\u76ee\u6e05\u5358\u3002 \u4e0b\u9762\u662f\u4e00\u4e2a\u5178\u578b\u7684 Controller action \u7684\u4f8b\u5b50\uff0c\u5b83\u8fd0\u884c\u4e86\u4e00\u4e2a\u91cd\u65b0\u5bfc\u5411\uff1a public function actionRedirect() { return $this->redirect($this->buildLink('demo/example'), '\u8fd9\u662f\u4e00\u4e2a\u91cd\u5b9a\u5411\u4fe1\u606f\u3002', 'permanent'); } \u7b2c\u4e00\u4e2a\u53c2\u6570\u662f\u8981\u91cd\u65b0\u5bfc\u5411\u7684 URL\u3002 \u8fd9\u4e2a\u4f8b\u5b50\u5c06\u628a\u7528\u6237\u91cd\u65b0\u5bfc\u5411\u5230 index.php?demo/example \u7684 URL\u3002 \u7b2c\u4e8c\u4e2a\u53c2\u6570\u53ea\u6709\u5728\u8868\u5355\u901a\u8fc7 AJAX \u8bf7\u6c42\u63d0\u4ea4\u65f6\u624d\u4f1a\u663e\u793a\uff0cAJAX \u8bf7\u6c42\u9009\u62e9\u9632\u6b62\u91cd\u65b0\u5bfc\u5411\u3002 \u7ed3\u679c\u5c06\u662f\u4e00\u4e2a \"\u5373\u65f6\u6d88\u606f\"\uff0c\u4ece\u8367\u5e55\u9876\u90e8\u51fa\u73b0\u60a8\u9009\u62e9\u7684\u6d88\u606f\u3002 \u60a8\u4e0d\u5fc5\u63d0\u4f9b\u60a8\u81ea\u5df1\u7684\u4fe1\u606f\u3002 \u5982\u679c\u6ca1\u6709\u63d0\u4f9b\uff0c\u5b83\u5c06\u9ed8\u8ba4\u4e3a \"\u60a8\u7684\u66f4\u6539\u5df2\u88ab\u4fdd\u5b58\"\u3002 \u7b2c\u4e09\u4e2a\u53c2\u6570\u9ed8\u8ba4\u4e3a temporary \uff0c\u4f46\u4f60\u4e5f\u53ef\u4ee5\u9009\u62e9\u5c06\u5176\u8bbe\u7f6e\u4e3a permanent\uff0c\u5c31\u8c61\u672c\u4f8b\u4e00\u6837\u3002 \u8fd9\u91cc\u552f\u4e00\u7684\u533a\u522b\u662f\u670d\u52a1\u5668\u63d0\u4f9b\u7684 HTTP \u56de\u5e94\u7801\u7684\u7c7b\u578b\u3002 \u5728\u5927\u591a\u6570\u60c5\u51b5\u4e0b\uff0c\u4e34\u65f6\u662f\u7406\u60f3\u7684\uff0c\u8fd9\u5c06\u4ee5 303 \u7801\u56de\u5e94\u3002 permanent \u5c06\u53d1\u51fa 301 \u56de\u5e94\u7801\u3002 \u867d\u7136\u4f60\u53ef\u4ee5\u901a\u8fc7\u8fd9\u79cd\u65b9\u5f0f\u89e6\u53d1\u4e00\u4e2a permanent \u91cd\u65b0\u5bfc\u5411\uff0c\u4f46\u5b9e\u9645\u4e0a\u6709\u4e00\u4e2a\u7279\u5b9a\u7684\u65b9\u6cd5\uff0c\u53ef\u4ee5\u4f7f\u7528\u5982\u4e0b\u3002 \u5b83\u4e5f\u9700\u8981\u4e00\u4e2a 'message' \u53c2\u6570\uff0c\u4f46\u548c\u4e0a\u9762\u4e00\u6837\uff0c\u5b83\u662f\u53ef\u9009\u7684\u3002 public function actionRedirect() { return $this->redirectPermanently($this->buildLink('demo/example')); } \u9519\u8bef\u56de\u5e94 \u00b6 \u987e\u540d\u601d\u4e49\uff0c\u8fd9\u4e2a\u56de\u5e94\u5c31\u662f\u4f60\u9700\u8981\u5411\u7528\u6237\u663e\u793a\u9519\u8bef\u65f6\u8fd4\u56de\u7684\u5185\u5bb9\u3002 \u8fd9\u7a0d\u7a0d\u7b80\u5358\uff0c\u4e0b\u9762\u662f\u4e00\u4e2a\u4f8b\u5b50\uff1a public function actionError() { return $this->error('\u5f88\u4e0d\u5e78\uff0c\u4f60\u8981\u627e\u7684\u4e1c\u897f\u65e0\u6cd5\u627e\u5230\u3002', 404); } \u8fd9\u91cc\u53ea\u652f\u63f4\u4e24\u4e2a\u53c2\u6570\u3002 \u7b2c\u4e00\u4e2a\u662f\u4f60\u60f3\u663e\u793a\u7684\u9519\u8bef\u4fe1\u606f\uff0c\u7b2c\u4e8c\u4e2a\u662f\u4f60\u60f3\u8ba9\u670d\u52a1\u5668\u53d1\u9001\u7684 HTTP \u56de\u5e94\u7801\u3002 404 \u5c06\u4ee3\u8868\u5728\u6ca1\u6709\u627e\u5230\u4e1c\u897f\u65f6\u7684\u9002\u5f53\u56de\u5e94\u3002 \u6d88\u606f\u56de\u5e94 \u00b6 \u8fd9\u4e2a\u56de\u5e94\u4e0e\u9519\u8bef\u56de\u5e94\u975e\u5e38\u76f8\u4f3c\uff0c\u652f\u63f4\u76f8\u540c\u7684\u53c2\u6570\u3002 \u4e3b\u8981\u7684\u533a\u522b\u662f\uff0c\u5728\u5916\u89b3\u4e0a\uff0c\u663e\u793a\u7684\u4fe1\u606f\u4e0d\u662f\u4ee5\u9519\u8bef\u7684\u5f62\u5f0f\u51fa\u73b0\u3002 \u5f02\u5e38\u56de\u5e94 \u00b6 \u6709\u65f6\u6709\u5fc5\u8981\u4e2d\u65ad Controller \u4ee3\u7801\u7684\u6b63\u5e38\u6d41\u7a0b\uff0c\u5e76\u7528\u5f02\u5e38\u56de\u5e94\u6765\u4ee3\u66ff\u3002 \u5f02\u5e38\u56de\u5e94\u4e0d\u4e00\u5b9a\u4ee3\u8868\u4e00\u4e2a\u9519\u8bef\uff1b\u4f8b\u5982\uff0c\u5b83\u4eec\u53ef\u4ee5\u7528\u6765\u5f3a\u5236 Controller \u8fd0\u884c\u4e00\u4e2a\u91cd\u65b0\u5bfc\u5411\u3002 \u7136\u800c\uff0c\u901a\u5e38\u60c5\u51b5\u4e0b\uff0c\u5b83\u4eec\u901a\u5e38\u4f1a\u88ab\u7528\u6765\u4e2d\u65ad Controller \u7684\u6d41\u7a0b\u4ee5\u663e\u793a\u4e00\u4e2a\u9519\u8bef\uff0c\u5c31\u8c61\u4e0b\u9762\u7684\u4f8b\u5b50\u4e00\u6837\uff1a public function actionException() { throw $this->exception($this->error('\u53d1\u751f\u610f\u5916\u9519\u8bef')); } \u5f02\u5e38\u56de\u5e94\u53ea\u63a5\u53d7\u4e00\u4e2a\u53c2\u6570\uff0c\u5b9e\u9645\u4e0a\u8fd9\u4e2a\u53c2\u6570\u5fc5\u987b\u662f\u5176\u4ed6\u5f62\u5f0f\u7684 Reply \u7269\u4ef6\uff0c\u6bd4\u5982 \u9519\u8bef\u56de\u5e94 \u3002 \u8fd9\u4e2a\u7279\u6b8a\u7684\u4f8b\u5b50\u4f1a\u629b\u51fa\u4e00\u4e2a\u5f02\u5e38\uff0c\u6b64\u65f6\u6574\u4e2a\u63a7\u5236\u5668\u7684\u4ee3\u7801\u4f1a\u505c\u6b62\uff0c\u5e76\u663e\u793a\u4e00\u4e2a\u6807\u51c6\u7684\u9519\u8bef\u3002 \u8bf7\u6ce8\u610f\uff0c\u5f02\u5e38\u56de\u5e94\u5fc5\u987b\u7528 throw \u6765 \"\u629b\u51fa\"\uff0c\u800c\u4e0d\u662f\u7528 return \u6765 \"\u8fd4\u56de\"\u3002 \u91cd\u5b9a\u8def\u7531\u56de\u5e94 \u00b6 \u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\uff0c\u9700\u8981\u5c06\u7528\u6237\u91cd\u65b0\u5bfc\u5411\u5230\u4e00\u4e2a\u5b8c\u5168\u4e0d\u540c\u7684 Controller \u6216\u540c\u4e00 Controller \u5185\u7684 action\uff0c\u800c\u4e0d\u9700\u8981\u8fd0\u884c\u5b8c\u5168\u7684\u91cd\u65b0\u5bfc\u5411\uff0c\u4e0d\u9700\u8981\u6539\u53d8\u7528\u6237\u767b\u9646\u7684 URL\uff0c\u4e5f\u4e0d\u9700\u8981\u91cd\u590d\u76ee\u6807 action \u7684\u4ee3\u7801\u3002 \u8fd9\u770b\u8d77\u6765\u6709\u70b9\u8c61\u8fd9\u6837\uff1a public function actionReroute() { return $this->rerouteController(__CLASS__, 'error'); } public function actionError() { return $this->error('\u7cdf\u4e86\uff01\u51fa\u4e86\u70b9\u95ee\u9898\uff01'); } \u5728\u8fd9\u4e2a\u7279\u6b8a\u7684\u4f8b\u5b50\u4e2d\uff0c\u5982\u679c\u7528\u6237\u5bfc\u89c8\u5230 index.php?demo/reroute URL\uff0c\u4ed6\u4eec\u4f1a\u770b\u5230 actionError() \u65b9\u6cd5\u7684\u9519\u8bef\u56de\u5e94\u3002 \u4ed6\u4eec\u4e0d\u4f1a\u88ab\u91cd\u65b0\u5bfc\u5411\uff0c\u6d4f\u89c8\u5668\u4e2d\u7684 URL \u4e5f\u4e0d\u4f1a\u6539\u53d8\uff0c\u4ed6\u4eec\u53ea\u662f\u53ce\u5230\u9519\u8bef action \u7684\u56de\u5e94\u3002 \u91cd\u5b9a\u8def\u7531\u56de\u5e94\u8fd8\u652f\u6301\u7b2c\u4e09\u4e2a\u53c2\u6570\uff0c\u5b83\u5141\u8bb8\u5c06\u5404\u79cd\u53c2\u6570\u4ece\u4e00\u4e2a Controller action \u4f20\u9012\u5230\u53e6\u4e00\u4e2a Controller\u3002 \u8fd9\u53ef\u4ee5\u662f\u4e00\u4e2a\u6570\u7ec4\u6216\u4e00\u4e2a ParameterBag \u7269\u4ef6\uff08\u7a0d\u540e\u5c06\u8be6\u7ec6\u4ecb\u7ecd\uff09\u3002 \u4fee\u6539 Controller Action \u56de\u5e94 \uff08properly\uff09 \u00b6 \u5728 \u7ee7\u627f class \u7ae0\u8282\u4e2d\uff0c\u6211\u4eec\u5df2\u7ecf\u770b\u5230\u4e86\u7ee7\u627f\u4e00\u4e2a class \u662f\u591a\u4e48\u7684\u7b80\u5358\uff0c\u4f46\u662f\u5f53\u7ee7\u627f\u4e00\u4e2a\u5df2\u7ecf\u5b58\u5728\u7684 Controller action \u65f6\uff0c\u9700\u8981\u683c\u5916\u5c0f\u5fc3\u3002 \u9664\u975e\u4f60\u6709\u7279\u6b8a\u7684\u987b\u6c42\uff0c\u9700\u8981\u5b8c\u5168\u590d\u76d6\u4e00\u4e2a\u73b0\u6709\u7684 action\uff0c\u5e76\u7528\u65b0\u7684\u4e1c\u897f\u6765\u4ee3\u66ff\u5b83\uff08\u4e00\u822c\u4e0d\u5efa\u8bae\u8fd9\u6837\u505a\uff09\uff0c\u5426\u5219\u4f60\u5e94\u8be5\u4fee\u6539\u7236\u7c7b\u7684\u73b0\u6709\u56de\u5e94\u3002 \u8fd9\u975e\u5e38\u7b80\u5358\uff0c\u4e3e\u4e2a\u4f8b\u5b50\uff0c\u8ba9\u6211\u4eec\u4fee\u6539\u4e0a\u9762 view \u56de\u5e94 \u4f8b\u5b50\u4e2d\u7684 view \u56de\u5e94\u3002 public function actionExample() { $reply = parent::actionExample(); return $reply; } \u5047\u8bbe\u4e0a\u9762\u7684\u5185\u5bb9\u88ab\u6dfb\u52a0\u5230\u4e00\u4e2a\u5df2\u7ecf\u5b58\u5728 actionExample() \u65b9\u6cd5\u7684\u7ee7\u627f Controller \u4e2d\uff0c\u4e0a\u9762\u7684\u5185\u5bb9\u9664\u4e86\u8fd4\u56de\u539f\u6765\u7684 view \u56de\u5e94\u5916\uff0c\u5b9e\u9645\u4e0a\u5e76\u6ca1\u6709\u505a\u4efb\u4f55\u4e8b\u60c5\u3002 \u73b0\u5728\u8ba9\u6211\u4eec\u628a\u73b0\u6709\u7684 hello \u53c2\u6570\u6539\u4e3a \"Bonjour\" \u800c\u4e0d\u662f \"Hello\"\u3002 public function actionExample() { $reply = parent::actionExample(); if ($reply instanceof \\XF\\Mvc\\Reply\\View) { $reply->setParam('hello', 'Bonjour'); } return $reply; } \u56e0\u4e3a\u4e00\u4e2a Controller \u56de\u5e94\u5b9e\u9645\u4e0a\u53ef\u4ee5\u4ee3\u8868\u8bb8\u591a\u4e0d\u540c\u7684\u7269\u4ef6\uff0c\u8fd9\u4e9b\u7269\u4ef6\u5177\u6709\u4e0d\u540c\u7684\u884c\u4e3a\u548c\u65b9\u6cd5\uff0c\u6240\u4ee5\u6211\u4eec\u5fc5\u987b\u53ea\u5c1d\u8bd5\u7ee7\u627f\u6b63\u786e\u7684\u56de\u5e94\u7c7b\u578b\u3002 \u5728\u4e0a\u9762\u7684\u4f8b\u5b50\u4e2d\uff0c\u6211\u4eec\u901a\u8fc7\u68c0\u67e5\u7236 $reply \u7269\u4ef6\u662f\u5426\u771f\u7684\u662f View \u7c7b\u578b\u6765\u505a\u5230\u8fd9\u4e00\u70b9\u3002 \u5982\u679c\u6211\u4eec\u6ca1\u6709\u8fd9\u6837\u505a\uff0c\u6211\u4eec\u7ee7\u627f\u4e86\u8fd9\u4e2a action\uff0c\u800c Controller action \u5374\u7528\u91cd\u65b0\u5bfc\u5411\u6765\u56de\u5e94\uff0c\u90a3\u9ebd\u5f88\u53ef\u80fd\u4f1a\u51fa\u73b0\u9519\u8bef\u3002 \u5728\u7ee7\u627f\u8fd9\u4e2a\u52a8\u4f5c\u4e4b\u524d\uff0c\u8bbf\u95ee\u8fd9\u4e2a\u9875\u9762\u4f1a\u663e\u793a \"Hello world\uff01\"\u3002 \u7ee7\u627f\u540e\uff0c\u73b0\u5728 view \u5c06\u663e\u793a \"Bonjour world\uff01\"\u3002","title":"\u63a7\u5236\u5668\u57fa\u7840\u77e5\u8bc6"},{"location":"controller-basics/#_1","text":"\u5728\u57fa\u672c\u5c42\u9762\u4e0a\uff0cController \u662f\u5f53\u4f60\u5728 XF \u4e2d\u8bbf\u95ee\u4e00\u4e2a\u9875\u9762\u65f6\u8fd0\u884c\u7684\u4ee3\u7801\u3002 \u5728\u57fa\u672c\u5c42\u9762\u4e0a\uff0cController \u4e00\u822c\u8d1f\u8d23\u5904\u7406\u7528\u6237\u7684\u8f93\u5165\uff0c\u5e76\u5c06\u7528\u6237\u7684\u8f93\u5165\u4f20\u9012\u5230\u9002\u5f53\u7684\u5730\u65b9\uff0c\u901a\u5e38\u662f\u8fd0\u884c\u67d0\u79cd\u6570\u636e\u5e93\u64cd\u4f5c\uff08Model\uff09\u6216\u52a0\u8f7d\u53ef\u89c6\u5316\u5185\u5bb9\uff08View\uff09\u3002 \u5f53\u7528\u6237\u70b9\u51fb\u94fe\u63a5\u65f6\uff0c\u8bf7\u6c42\u7684 URL \u4f1a\u88ab\u8def\u7531\u5bfc\u5230\u7279\u5b9a\u7684 Controller \u548c Controller action\u3002 \u53c2\u89c1 \u8def\u7531\u57fa\u7840\u77e5\u8bc6 \u3002 \u4f8b\u5982\uff0c\u5728 XF \u4e2d\uff0c\u5982\u679c\u4f60\u70b9\u51fb\u4e00\u4e2a\u7c7b\u4f3c\u4e8e index.php?conversations/add \u7684 URL\uff0c\u4f60\u5c06\u88ab\u8def\u7531\u5bfc\u5230 XF\\Pub\\Controller\\Conversation Controller \u548c add action\u3002 \u5982\u679c\u4f60\u5728\u6587\u4ef6\u7cfb\u7edf\u4e2d\u67e5\u770b\u8fd9\u4e2a class\uff08\u53c2\u89c1 \u81ea\u52a8\u52a0\u8f7d\u5668 \uff0c\u4ee5\u4e86\u89e3 class \u548c\u6587\u4ef6\u8def\u5f84\u5982\u4f55\u76f8\u4e92\u6620\u5c04\u7684\u63cf\u8ff0\uff09\uff0c\u4f60\u4f1a\u6ce8\u610f\u5230\u6709\u8bb8\u591a\u65b9\u6cd5\u4ee5 action \u4e3a\u524d\u7f00\u547d\u540d\u3002 \u6240\u6709\u8fd9\u4e9b\u65b9\u6cd5\u90fd\u8868\u793a\u4e00\u4e2a\u7279\u5b9a\u7684 Controller action\u3002 \u6240\u4ee5\uff0c\u8981\u60f3\u5728\u67e5\u770b\u4e0a\u9762\u63d0\u5230\u7684 conversations/add \u9875\u9762\u65f6\u770b\u5230\u76f8\u5173\u4ee3\u7801\uff0c\u8bf7\u5728\u8fd9\u4e2a\u6587\u4ef6\u4e2d\u67e5\u627e public function actionAdd() \u3002 XF Controller \u8d1f\u8d23\u8fd4\u56de\u4e00\u4e2a reply \u7269\u4ef6\uff0c\u8be5\u7269\u4ef6\u4e00\u822c\u5305\u62ec\u4ee5\u4e0b\u7c7b\u578b\u4e4b\u4e00\uff1a","title":"\u63a7\u5236\u5668\u57fa\u7840\u77e5\u8bc6"},{"location":"controller-basics/#view","text":"\u8fd9\u662f XF \u5f00\u53d1\u8fc7\u7a0b\u4e2d\u6700\u5e38\u89c1\u7684\u56de\u5e94\u4e4b\u4e00\u3002 \u4e00\u4e2a\u8fd4\u56de View \u56de\u5e94\u7684 Controller \u901a\u5e38\u9700\u8981\u4f20\u9012\u591a\u8fbe\u4e09\u4e2a\u53c2\u6570\u3002 \u4e00\u4e2a View class (\u4e0b\u9762\u4f1a\u6709\u66f4\u591a\u7684\u4ecb\u7ecd)\uff0c\u4e00\u4e2a\u6a21\u677f\u540d\u79f0\uff0c\u4ee5\u53ca\u4e00\u4e2a\u7531 $viewParams \u7ec4\u6210\u7684\u6570\u7ec4\uff0c\u8fd9\u4e2a\u6570\u7ec4\u662f\u6a21\u677f\u5e94\u8be5\u6709\u7684\u6570\u636e\u3002 \u8fd9\u91cc\u662f\u4e00\u4e2a\u5178\u578b\u7684 Controller action \u7684\u4f8b\u5b50\uff0c\u5b83\u8fd4\u56de\u4e00\u4e2a View \u56de\u5e94\uff1a public function actionExample() { $hello = 'Hello'; $world = 'world!'; $viewParams = [ 'hello' => $hello, 'world' => $world ]; return $this->view('Demo:Example', 'demo_example', $viewParams); } \u7b2c\u4e00\u4e2a\u53c2\u6570\u662f\u4e00\u4e2a\u7279\u5b9a View class \u7684\u7b80\u77ed class \u540d\u3002 \u8fd9\u4e2a class \u53ef\u80fd\u5b58\u5728\uff0c\u4e5f\u53ef\u80fd\u4e0d\u5b58\u5728\uff08\u901a\u5e38\u60c5\u51b5\u4e0b\uff0c\u5b83\u4e0d\u9700\u8981\u5b58\u5728\uff0c\u6211\u4eec\u5728\u540e\u9762\u4f1a\u4ecb\u7ecd\u66f4\u591a\u5730 View class \uff09\uff0c\u4f46\u5b83\u5e94\u8be5\u6709\u4e00\u4e2a Controller \u548c action \u7684\u5927\u81f4\u552f\u4e00\u540d\u79f0\u3002 \u4e0e\u5176\u4ed6 \u77ed\u7c7b\u540d \u4e00\u6837\uff0c\u4e0a\u9762\u7684\u7279\u5b9a\u77ed\u7c7b\u540d\u5c06\u89e3\u6790\u4e3a Demo/Pub/View/Example \u3002 \u540c\u6837\uff0c Pub \u662f\u7531 Controller \u7c7b\u578b\u81ea\u52a8\u63a8\u65ad\u51fa\u6765\u7684\u3002 \u7b2c\u4e8c\u4e2a\u53c2\u6570\u662f\u6a21\u677f\u540d\u79f0\u3002 \u5728\u672c\u4f8b\u4e2d\uff0c\u6211\u4eec\u6b63\u5728\u5bfb\u627e\u4e00\u4e2a\u540d\u4e3a demo_example \u7684\u6a21\u677f\u3002 \u7b2c\u4e09\u4e2a\u53c2\u6570\u662f \u5e94\u8be5\u63d0\u4f9b\u7ed9 view \u6a21\u677f \u53c2\u6570/\u503c \u7684\u6570\u7ec4\u3002 \u8fd9\u4e2a\u6570\u7ec4\u4e00\u822c\u5e94\u8be5\u662f\u4e00\u5bf9 key => value \u3002 \u4e0a\u9762\u7684\u4f8b\u5b50\u662f\u5c06\u4e24\u4e2a\u6a21\u677f\u53c2\u6570\u4f20\u9012\u7ed9\u6a21\u677f\u3002 \u6570\u7ec4\u4e2d\u7684 key \u90e8\u5206\u8868\u793a\u6a21\u677f\u4e2d\u53ef\u7528\u7684\u53d8\u91cf\u540d\u79f0\u3002 \u6570\u7ec4\u4e2d\u7684 value \u90e8\u5206\u8868\u793a\u503c\u3002 \u56e0\u6b64\uff0c\u5982\u679c\u6211\u4eec\u5728 demo_example \u6a21\u677f\u4e2d\u6709\u4ee5\u4e0b\u5185\u5bb9\uff1a {$hello} {$world} \u8be5\u6a21\u677f\u5c06\u8f93\u51fa\u4ee5\u4e0b\u5185\u5bb9\uff1a Hello world!","title":"View \u56de\u5e94"},{"location":"controller-basics/#_2","text":"\u5f53\u4f60\u5e0c\u671b\u5728\u7528\u6237\u5b8c\u6210\u67d0\u79cd\u64cd\u4f5c\u540e\u5c06\u5176\u91cd\u65b0\u5bfc\u5411\u5230\u4e0d\u540c\u7684 URL \u65f6\uff0c\u4f1a\u8fd4\u56de\u8fd9\u4e2a\u56de\u5e94\u3002 \u4e00\u4e2a\u5e38\u89c1\u7684\u4f7f\u7528\u6848\u4f8b\u662f\u5728\u7528\u6237\u901a\u8fc7\u8868\u5355\u63d0\u4ea4\u6570\u636e\u540e\uff0c\u4f60\u53ef\u80fd\u5e0c\u671b\u5c06\u4ed6\u4eec\u91cd\u65b0\u5bfc\u5411\u5230\u4e0d\u540c\u7684\u9875\u9762\uff0c\u4f8b\u5982\u5c06\u7528\u6237\u8fd4\u56de\u5230\u4e00\u4e2a\u9879\u76ee\u6e05\u5358\u3002 \u4e0b\u9762\u662f\u4e00\u4e2a\u5178\u578b\u7684 Controller action \u7684\u4f8b\u5b50\uff0c\u5b83\u8fd0\u884c\u4e86\u4e00\u4e2a\u91cd\u65b0\u5bfc\u5411\uff1a public function actionRedirect() { return $this->redirect($this->buildLink('demo/example'), '\u8fd9\u662f\u4e00\u4e2a\u91cd\u5b9a\u5411\u4fe1\u606f\u3002', 'permanent'); } \u7b2c\u4e00\u4e2a\u53c2\u6570\u662f\u8981\u91cd\u65b0\u5bfc\u5411\u7684 URL\u3002 \u8fd9\u4e2a\u4f8b\u5b50\u5c06\u628a\u7528\u6237\u91cd\u65b0\u5bfc\u5411\u5230 index.php?demo/example \u7684 URL\u3002 \u7b2c\u4e8c\u4e2a\u53c2\u6570\u53ea\u6709\u5728\u8868\u5355\u901a\u8fc7 AJAX \u8bf7\u6c42\u63d0\u4ea4\u65f6\u624d\u4f1a\u663e\u793a\uff0cAJAX \u8bf7\u6c42\u9009\u62e9\u9632\u6b62\u91cd\u65b0\u5bfc\u5411\u3002 \u7ed3\u679c\u5c06\u662f\u4e00\u4e2a \"\u5373\u65f6\u6d88\u606f\"\uff0c\u4ece\u8367\u5e55\u9876\u90e8\u51fa\u73b0\u60a8\u9009\u62e9\u7684\u6d88\u606f\u3002 \u60a8\u4e0d\u5fc5\u63d0\u4f9b\u60a8\u81ea\u5df1\u7684\u4fe1\u606f\u3002 \u5982\u679c\u6ca1\u6709\u63d0\u4f9b\uff0c\u5b83\u5c06\u9ed8\u8ba4\u4e3a \"\u60a8\u7684\u66f4\u6539\u5df2\u88ab\u4fdd\u5b58\"\u3002 \u7b2c\u4e09\u4e2a\u53c2\u6570\u9ed8\u8ba4\u4e3a temporary \uff0c\u4f46\u4f60\u4e5f\u53ef\u4ee5\u9009\u62e9\u5c06\u5176\u8bbe\u7f6e\u4e3a permanent\uff0c\u5c31\u8c61\u672c\u4f8b\u4e00\u6837\u3002 \u8fd9\u91cc\u552f\u4e00\u7684\u533a\u522b\u662f\u670d\u52a1\u5668\u63d0\u4f9b\u7684 HTTP \u56de\u5e94\u7801\u7684\u7c7b\u578b\u3002 \u5728\u5927\u591a\u6570\u60c5\u51b5\u4e0b\uff0c\u4e34\u65f6\u662f\u7406\u60f3\u7684\uff0c\u8fd9\u5c06\u4ee5 303 \u7801\u56de\u5e94\u3002 permanent \u5c06\u53d1\u51fa 301 \u56de\u5e94\u7801\u3002 \u867d\u7136\u4f60\u53ef\u4ee5\u901a\u8fc7\u8fd9\u79cd\u65b9\u5f0f\u89e6\u53d1\u4e00\u4e2a permanent \u91cd\u65b0\u5bfc\u5411\uff0c\u4f46\u5b9e\u9645\u4e0a\u6709\u4e00\u4e2a\u7279\u5b9a\u7684\u65b9\u6cd5\uff0c\u53ef\u4ee5\u4f7f\u7528\u5982\u4e0b\u3002 \u5b83\u4e5f\u9700\u8981\u4e00\u4e2a 'message' \u53c2\u6570\uff0c\u4f46\u548c\u4e0a\u9762\u4e00\u6837\uff0c\u5b83\u662f\u53ef\u9009\u7684\u3002 public function actionRedirect() { return $this->redirectPermanently($this->buildLink('demo/example')); }","title":"\u91cd\u65b0\u5bfc\u5411\u56de\u5e94"},{"location":"controller-basics/#_3","text":"\u987e\u540d\u601d\u4e49\uff0c\u8fd9\u4e2a\u56de\u5e94\u5c31\u662f\u4f60\u9700\u8981\u5411\u7528\u6237\u663e\u793a\u9519\u8bef\u65f6\u8fd4\u56de\u7684\u5185\u5bb9\u3002 \u8fd9\u7a0d\u7a0d\u7b80\u5358\uff0c\u4e0b\u9762\u662f\u4e00\u4e2a\u4f8b\u5b50\uff1a public function actionError() { return $this->error('\u5f88\u4e0d\u5e78\uff0c\u4f60\u8981\u627e\u7684\u4e1c\u897f\u65e0\u6cd5\u627e\u5230\u3002', 404); } \u8fd9\u91cc\u53ea\u652f\u63f4\u4e24\u4e2a\u53c2\u6570\u3002 \u7b2c\u4e00\u4e2a\u662f\u4f60\u60f3\u663e\u793a\u7684\u9519\u8bef\u4fe1\u606f\uff0c\u7b2c\u4e8c\u4e2a\u662f\u4f60\u60f3\u8ba9\u670d\u52a1\u5668\u53d1\u9001\u7684 HTTP \u56de\u5e94\u7801\u3002 404 \u5c06\u4ee3\u8868\u5728\u6ca1\u6709\u627e\u5230\u4e1c\u897f\u65f6\u7684\u9002\u5f53\u56de\u5e94\u3002","title":"\u9519\u8bef\u56de\u5e94"},{"location":"controller-basics/#_4","text":"\u8fd9\u4e2a\u56de\u5e94\u4e0e\u9519\u8bef\u56de\u5e94\u975e\u5e38\u76f8\u4f3c\uff0c\u652f\u63f4\u76f8\u540c\u7684\u53c2\u6570\u3002 \u4e3b\u8981\u7684\u533a\u522b\u662f\uff0c\u5728\u5916\u89b3\u4e0a\uff0c\u663e\u793a\u7684\u4fe1\u606f\u4e0d\u662f\u4ee5\u9519\u8bef\u7684\u5f62\u5f0f\u51fa\u73b0\u3002","title":"\u6d88\u606f\u56de\u5e94"},{"location":"controller-basics/#_5","text":"\u6709\u65f6\u6709\u5fc5\u8981\u4e2d\u65ad Controller \u4ee3\u7801\u7684\u6b63\u5e38\u6d41\u7a0b\uff0c\u5e76\u7528\u5f02\u5e38\u56de\u5e94\u6765\u4ee3\u66ff\u3002 \u5f02\u5e38\u56de\u5e94\u4e0d\u4e00\u5b9a\u4ee3\u8868\u4e00\u4e2a\u9519\u8bef\uff1b\u4f8b\u5982\uff0c\u5b83\u4eec\u53ef\u4ee5\u7528\u6765\u5f3a\u5236 Controller \u8fd0\u884c\u4e00\u4e2a\u91cd\u65b0\u5bfc\u5411\u3002 \u7136\u800c\uff0c\u901a\u5e38\u60c5\u51b5\u4e0b\uff0c\u5b83\u4eec\u901a\u5e38\u4f1a\u88ab\u7528\u6765\u4e2d\u65ad Controller \u7684\u6d41\u7a0b\u4ee5\u663e\u793a\u4e00\u4e2a\u9519\u8bef\uff0c\u5c31\u8c61\u4e0b\u9762\u7684\u4f8b\u5b50\u4e00\u6837\uff1a public function actionException() { throw $this->exception($this->error('\u53d1\u751f\u610f\u5916\u9519\u8bef')); } \u5f02\u5e38\u56de\u5e94\u53ea\u63a5\u53d7\u4e00\u4e2a\u53c2\u6570\uff0c\u5b9e\u9645\u4e0a\u8fd9\u4e2a\u53c2\u6570\u5fc5\u987b\u662f\u5176\u4ed6\u5f62\u5f0f\u7684 Reply \u7269\u4ef6\uff0c\u6bd4\u5982 \u9519\u8bef\u56de\u5e94 \u3002 \u8fd9\u4e2a\u7279\u6b8a\u7684\u4f8b\u5b50\u4f1a\u629b\u51fa\u4e00\u4e2a\u5f02\u5e38\uff0c\u6b64\u65f6\u6574\u4e2a\u63a7\u5236\u5668\u7684\u4ee3\u7801\u4f1a\u505c\u6b62\uff0c\u5e76\u663e\u793a\u4e00\u4e2a\u6807\u51c6\u7684\u9519\u8bef\u3002 \u8bf7\u6ce8\u610f\uff0c\u5f02\u5e38\u56de\u5e94\u5fc5\u987b\u7528 throw \u6765 \"\u629b\u51fa\"\uff0c\u800c\u4e0d\u662f\u7528 return \u6765 \"\u8fd4\u56de\"\u3002","title":"\u5f02\u5e38\u56de\u5e94"},{"location":"controller-basics/#_6","text":"\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\uff0c\u9700\u8981\u5c06\u7528\u6237\u91cd\u65b0\u5bfc\u5411\u5230\u4e00\u4e2a\u5b8c\u5168\u4e0d\u540c\u7684 Controller \u6216\u540c\u4e00 Controller \u5185\u7684 action\uff0c\u800c\u4e0d\u9700\u8981\u8fd0\u884c\u5b8c\u5168\u7684\u91cd\u65b0\u5bfc\u5411\uff0c\u4e0d\u9700\u8981\u6539\u53d8\u7528\u6237\u767b\u9646\u7684 URL\uff0c\u4e5f\u4e0d\u9700\u8981\u91cd\u590d\u76ee\u6807 action \u7684\u4ee3\u7801\u3002 \u8fd9\u770b\u8d77\u6765\u6709\u70b9\u8c61\u8fd9\u6837\uff1a public function actionReroute() { return $this->rerouteController(__CLASS__, 'error'); } public function actionError() { return $this->error('\u7cdf\u4e86\uff01\u51fa\u4e86\u70b9\u95ee\u9898\uff01'); } \u5728\u8fd9\u4e2a\u7279\u6b8a\u7684\u4f8b\u5b50\u4e2d\uff0c\u5982\u679c\u7528\u6237\u5bfc\u89c8\u5230 index.php?demo/reroute URL\uff0c\u4ed6\u4eec\u4f1a\u770b\u5230 actionError() \u65b9\u6cd5\u7684\u9519\u8bef\u56de\u5e94\u3002 \u4ed6\u4eec\u4e0d\u4f1a\u88ab\u91cd\u65b0\u5bfc\u5411\uff0c\u6d4f\u89c8\u5668\u4e2d\u7684 URL \u4e5f\u4e0d\u4f1a\u6539\u53d8\uff0c\u4ed6\u4eec\u53ea\u662f\u53ce\u5230\u9519\u8bef action \u7684\u56de\u5e94\u3002 \u91cd\u5b9a\u8def\u7531\u56de\u5e94\u8fd8\u652f\u6301\u7b2c\u4e09\u4e2a\u53c2\u6570\uff0c\u5b83\u5141\u8bb8\u5c06\u5404\u79cd\u53c2\u6570\u4ece\u4e00\u4e2a Controller action \u4f20\u9012\u5230\u53e6\u4e00\u4e2a Controller\u3002 \u8fd9\u53ef\u4ee5\u662f\u4e00\u4e2a\u6570\u7ec4\u6216\u4e00\u4e2a ParameterBag \u7269\u4ef6\uff08\u7a0d\u540e\u5c06\u8be6\u7ec6\u4ecb\u7ecd\uff09\u3002","title":"\u91cd\u5b9a\u8def\u7531\u56de\u5e94"},{"location":"controller-basics/#controller-action-properly","text":"\u5728 \u7ee7\u627f class \u7ae0\u8282\u4e2d\uff0c\u6211\u4eec\u5df2\u7ecf\u770b\u5230\u4e86\u7ee7\u627f\u4e00\u4e2a class \u662f\u591a\u4e48\u7684\u7b80\u5358\uff0c\u4f46\u662f\u5f53\u7ee7\u627f\u4e00\u4e2a\u5df2\u7ecf\u5b58\u5728\u7684 Controller action \u65f6\uff0c\u9700\u8981\u683c\u5916\u5c0f\u5fc3\u3002 \u9664\u975e\u4f60\u6709\u7279\u6b8a\u7684\u987b\u6c42\uff0c\u9700\u8981\u5b8c\u5168\u590d\u76d6\u4e00\u4e2a\u73b0\u6709\u7684 action\uff0c\u5e76\u7528\u65b0\u7684\u4e1c\u897f\u6765\u4ee3\u66ff\u5b83\uff08\u4e00\u822c\u4e0d\u5efa\u8bae\u8fd9\u6837\u505a\uff09\uff0c\u5426\u5219\u4f60\u5e94\u8be5\u4fee\u6539\u7236\u7c7b\u7684\u73b0\u6709\u56de\u5e94\u3002 \u8fd9\u975e\u5e38\u7b80\u5358\uff0c\u4e3e\u4e2a\u4f8b\u5b50\uff0c\u8ba9\u6211\u4eec\u4fee\u6539\u4e0a\u9762 view \u56de\u5e94 \u4f8b\u5b50\u4e2d\u7684 view \u56de\u5e94\u3002 public function actionExample() { $reply = parent::actionExample(); return $reply; } \u5047\u8bbe\u4e0a\u9762\u7684\u5185\u5bb9\u88ab\u6dfb\u52a0\u5230\u4e00\u4e2a\u5df2\u7ecf\u5b58\u5728 actionExample() \u65b9\u6cd5\u7684\u7ee7\u627f Controller \u4e2d\uff0c\u4e0a\u9762\u7684\u5185\u5bb9\u9664\u4e86\u8fd4\u56de\u539f\u6765\u7684 view \u56de\u5e94\u5916\uff0c\u5b9e\u9645\u4e0a\u5e76\u6ca1\u6709\u505a\u4efb\u4f55\u4e8b\u60c5\u3002 \u73b0\u5728\u8ba9\u6211\u4eec\u628a\u73b0\u6709\u7684 hello \u53c2\u6570\u6539\u4e3a \"Bonjour\" \u800c\u4e0d\u662f \"Hello\"\u3002 public function actionExample() { $reply = parent::actionExample(); if ($reply instanceof \\XF\\Mvc\\Reply\\View) { $reply->setParam('hello', 'Bonjour'); } return $reply; } \u56e0\u4e3a\u4e00\u4e2a Controller \u56de\u5e94\u5b9e\u9645\u4e0a\u53ef\u4ee5\u4ee3\u8868\u8bb8\u591a\u4e0d\u540c\u7684\u7269\u4ef6\uff0c\u8fd9\u4e9b\u7269\u4ef6\u5177\u6709\u4e0d\u540c\u7684\u884c\u4e3a\u548c\u65b9\u6cd5\uff0c\u6240\u4ee5\u6211\u4eec\u5fc5\u987b\u53ea\u5c1d\u8bd5\u7ee7\u627f\u6b63\u786e\u7684\u56de\u5e94\u7c7b\u578b\u3002 \u5728\u4e0a\u9762\u7684\u4f8b\u5b50\u4e2d\uff0c\u6211\u4eec\u901a\u8fc7\u68c0\u67e5\u7236 $reply \u7269\u4ef6\u662f\u5426\u771f\u7684\u662f View \u7c7b\u578b\u6765\u505a\u5230\u8fd9\u4e00\u70b9\u3002 \u5982\u679c\u6211\u4eec\u6ca1\u6709\u8fd9\u6837\u505a\uff0c\u6211\u4eec\u7ee7\u627f\u4e86\u8fd9\u4e2a action\uff0c\u800c Controller action \u5374\u7528\u91cd\u65b0\u5bfc\u5411\u6765\u56de\u5e94\uff0c\u90a3\u9ebd\u5f88\u53ef\u80fd\u4f1a\u51fa\u73b0\u9519\u8bef\u3002 \u5728\u7ee7\u627f\u8fd9\u4e2a\u52a8\u4f5c\u4e4b\u524d\uff0c\u8bbf\u95ee\u8fd9\u4e2a\u9875\u9762\u4f1a\u663e\u793a \"Hello world\uff01\"\u3002 \u7ee7\u627f\u540e\uff0c\u73b0\u5728 view \u5c06\u663e\u793a \"Bonjour world\uff01\"\u3002","title":"\u4fee\u6539 Controller Action \u56de\u5e94 \uff08properly\uff09"},{"location":"criteria/","text":"\u51c6\u5219 \u00b6 \u5f53 XenForo \u9700\u8981\u6839\u636e\u4e00\u4e9b \u7528\u6237\u9009\u62e9\u7684 \u6761\u4ef6\uff08\u51c6\u5219\uff09\u6765\u6d4b\u8bd5\u67d0\u4e9b\u4e1c\u897f\uff08\u7528\u6237/\u9875\u9762/\u5e16\u5b50......\uff09\u65f6\uff0c\u5b83\u4f7f\u7528\u51c6\u5219\u7cfb\u7edf\u3002 \u4f7f\u7528\u5230\u51c6\u5219\u7cfb\u7edf\u7684\u4e00\u4e9b\u5730\u65b9\uff1a \u6210\u5c31 \u7528\u6237\u7ec4\u63d0\u5347 \u8bba\u575b\u516c\u544a \u9644\u52a0\u7ec4\u4ef6\u4e5f\u53ef\u4ee5\u4f7f\u7528\u8fd9\u4e2a\u7cfb\u7edf\u3002 \u51c6\u5219\u7c7b\u578b \u00b6 \u8003\u8651\u4ee5\u4e0b\u51c6\u5219\uff1a - \u7528\u6237 \u6709/\u6ca1\u6709 \u5934\u50cf - \u7528\u6237\u6709 300 \u591a\u6761\u7559\u8a00 - \u7528\u6237\u6b63\u5728\u521b\u5efa\u4e00\u4e2a\u4e3b\u9898 - \u5f53\u524d\u7528\u6237\u9009\u62e9\u7684\u5bfc\u89c8\u6807\u7b7e\u4e3a \"\u4f1a\u5458\" \u524d\u4e24\u4e2a\u51c6\u5219\u662f\u6307\u7528\u6237\u672c\u4eba\u3002 \u5176\u4f59\u7684\u51c6\u5219\u662f\u6307\u4ed6\u5f53\u524d\u5728\u8bba\u575b\u4e0a\u7684\u4f4d\u7f6e\u3002 \u8fd9\u6837\u770b\u8d77\u6765\u6211\u4eec\u5e94\u8be5\u6709\u4e0d\u540c\u7c7b\u522b\u6216 \u7c7b\u578b \u7684\u51c6\u5219\u3002 \u5728 XenForo \u4e2d\uff0c\u6709\u4e24\u79cd\u5f00\u7bb1\u5373\u7528\u7684\u51c6\u5219\u7c7b\u578b\uff1a \u7528\u6237\u51c6\u5219 \u2014 \u5904\u7406\u5173\u4e8e\u7528\u6237\u672c\u8eab\u7684\u51c6\u5219 \u9875\u9762\u51c6\u5219 \u2014 \u5904\u7406\u7528\u6237\u5f53\u524d\u4f4d\u7f6e\u7684\u51c6\u5219 + \u65f6\u95f4\u51c6\u5219 \u4e00\u4e9b\u9644\u52a0\u7ec4\u4ef6\u4e5f\u53ef\u4ee5\u6dfb\u52a0\u81ea\u5df1\u7684\u51c6\u5219\u7c7b\u578b\u3002 \u4ece\u4ee3\u7801\u7684\u89d2\u5ea6\u6765\u770b\uff0c\u51c6\u5219\u7c7b\u578b\u53ea\u662f\u4e00\u4e2a\u62bd\u8c61\u7c7b AbstractCriteria \u7684\u5b50\u7c7b\u3002 \u5b83\u4eec\u5305\u542b\u7528\u4e8e\u5904\u7406\u67d0\u4e9b\u7c7b\u578b\u7684\u9009\u5b9a\u51c6\u5219\u4ee3\u7801\u3002 \u53cd\u4e4b\uff0c AbstractCriteria \u5219\u63d0\u4f9b\u4e86\u5904\u7406\u51c6\u5219\u7684\u901a\u7528\u65b9\u6cd5\uff0c\u800c\u4e0d\u8bba\u5176\u542b\u4e49\u5982\u4f55\u3002 \u51c6\u5219 \u00b6 \u51c6\u5219\u662f\u4e00\u4e2a\u7528\u6237\u53ef\u9009\u62e9\u7684\u9884\u5b9a\u4e49\u6761\u4ef6\u3002 \u4e3a\u4ec0\u9ebd\u662f\u53ef\u9009\u7684\uff1f \u56e0\u4e3a\u7ba1\u7406\u5458/\u7528\u6237\u53ef\u4ee5\u9009\u62e9\u5b83\u4eec\uff08\u8bb0\u5f97\u6210\u5c31\u521b\u5efa\u8fc7\u7a0b\uff09\u3002 \u4e3a\u4ec0\u9ebd\u662f\u9884\u5b9a\u4e49\uff1f \u56e0\u4e3a XenForo \u5df2\u7ecf\u77e5\u9053\u5982\u4f55\u5904\u7406\u5b83\u4eec\uff08\u4f7f\u7528\u51c6\u5219\u7c7b\u65b9\u6cd5\uff09\u3002 \u6bcf\u4e2a\u51c6\u5219\u7531\u4e24\u90e8\u5206\u7ec4\u6210\uff1a \u89c4\u5219 \u548c\uff08\u53ef\u9009\uff09 \u6570\u636e \u3002 \u89c4\u5219 \u00b6 \u51c6\u5219\u89c4\u5219\u7b80\u76f4\u5c31\u662f \u86c7\u5f62\u547d\u540d \u7684\u75db\u5904 (words_are_separated_with_underscore_character)\u3002 \u5b83\u6709\u4e24\u4e2a\u57fa\u672c\u5b97\u65e8\uff1a \u5b83\u7528\u4e8e\u533a\u5206\u51c6\u5219 \u5728\u8fdb\u884c\u5339\u914d\u65f6\uff0c\u8be5\u89c4\u5219\u88ab\u8ee2\u6362\u4e3a\u5904\u7406\u8be5\u51c6\u5219\u65b9\u6cd5\u7684 \u9a7c\u5cf0\u5f0f \u547d\u540d (\u8bf7\u53c2\u9605 \"\u51c6\u5219\u5982\u4f55\u8fd0\u4f5c\" )\u3002 \u6570\u636e \u00b6 \u5b83\u53ea\u662f\u4e00\u4e2a\u53ef\u9009\u7684\u9644\u52a0\u51c6\u5219\u6570\u636e\u6570\u7ec4\u3002 \u4f8b\u5982\uff0c\"\u7528\u6237\u81f3\u5c11\u53d1\u5e03\u4e86 X \u6761\u7559\u8a00\" \u51c6\u5219\u6709\u4e00\u4e2a\u5305\u542b\u4e00\u4e2a\u8981\u7d20\u7684\u6570\u636e\u6570\u7ec4\uff1a\u6570\u5219\u6d88\u606f\u3002 \u51c6\u5219\u7cfb\u7edf\u5982\u4f55\u8fd0\u4f5c \u00b6 \u5728\u672c\u8282\u4e2d\uff0c\u6211\u4eec\u5c06\u4ecb\u7ecd\u51c6\u5219\u7cfb\u7edf\u662f\u5982\u4f55\u4ece A \u5230 Z \u8fd0\u4f5c\u7684\u3002 \u6a21\u677f \u00b6 \u8fd9\u4e00\u5207\u90fd\u8981\u4ece\u6a21\u677f\u4ee3\u7801\u8bf4\u8d77\u3002 \u4ee5\u4e0b\u662f\u51c6\u5219\u5728\u6a21\u677f\u4e2d\u770b\u8d77\u6765\u7684\u6837\u5b50\uff1a <xf:checkbox label=\"Criteria container\"> <!-- \u51c6\u5219 --> <xf:option name=\"foo_criteria[criterion_1_rule][rule]\" value=\"criterion_1_rule\" ... /> <!-- \u542b\u6570\u636e\u7684\u51c6\u5219 --> <xf:option name=\"bar_criteria[criterion_2_rule][rule]\" value=\"criterion_2_rule\" ... > <xf:... name=\"bar_criteria[criterion_2_rule][data][param_1]\" ... /> <xf:... name=\"bar_criteria[criterion_2_rule][data][param_2]\" ... /> </xf:option> </xf:checkbox> \u5982\u4f60\u6240\u89c1\uff0c\u51c6\u5219\u53ea\u662f\u4e00\u4e2a\u590d\u9009\u6846\uff0c\u91cc\u9762\u6709\u53ef\u9009\u7684\u8f93\u5165\u5b57\u6bb5\uff08\u51c6\u5219\u6570\u636e\uff09\u3002 \u6211\u4eec\u6765\u5206\u6790\u4e00\u4e0b\u4ee3\u7801\uff1a foo_criteria \u548c bar_criteria \u662f input \u5bb9\u5668\uff0c\u901a\u5e38 foo \u548c bar \u90e8\u5206\u662f\u6307\u51c6\u5219\u7c7b\u578b\u3002 \u4f8b\u5982\uff0c user_criteria[...] \u8ba9\u6211\u4eec\u77e5\u9053\u8fd9\u4e2a\u51c6\u5219\u5c5e\u65bc\u7528\u6237\u51c6\u5219\u3002 value=\"criterion_1_rule\" \u548c value=\"criterion_2_rule\" \u663e\u7136\u662f\u51c6\u5219\u7684\u89c4\u5219\u3002 Note \u8bf7\u8bb0\u4f4f\uff0c name \u5c5e\u6027\u4e2d\u7684 criterion_1/2_rule \u4e0d\u4e00\u5b9a\u662f\u51c6\u5219\u89c4\u5219\uff01 \u8fd9\u4e9b\u53ea\u662f input \u5bb9\u5668\u7684\u540d\u79f0\u3002 \u4f60\u53ef\u4ee5\u8f7b\u800c\u6613\u4e3e\u5730\u5199\u4e0b <xf:option name=\"foo[bar][rule]\" value=\"criterion_rule\" /> \uff0c\u5b83\u5c31\u4f1a\u6b63\u786e\u5730\u8fd0\u4f5c\u3002 \u51c6\u5219\u89c4\u5219\u4f1a\u662f criterion_rule \uff0c\u800c\u4e0d\u662f bar \u3002 (\u53ef\u9009) \u4fdd\u5b58\u9009\u5b9a\u7684\u51c6\u5219 \u00b6 \u5728 Controller \u5185\u90e8\uff0c\u53ef\u4ee5\u5c06\u4e0a\u4e00\u8282\u7684\u51c6\u5219\u8868\u5355\u6570\u636e\u8fdb\u884c\u7b5b\u9009\u3001\u7f16\u7801\uff0c\u5e76\u4fdd\u5b58\u5728 mediumblob \u7c7b\u578b\u7684\u6570\u636e\u5e93 Column \u4e2d\uff0c\u4ee5\u4fbf\u66f4\u597d\u5730\u4f7f\u7528\uff1a $fooCriteriaInput = $this->filter('foo_criteria', 'array'); $barCriteriaInput = $this->filter('bar_criteria', 'array'); $form->basicEntitySave($bazEntity, [ 'foo_criteria' => $fooCriteriaInput, 'bar_criteria' => $barCriteriaInput ]); $bazEntity Structure \u793a\u4f8b\uff1a public static function getStructure(Structure $structure) { $structure->table = 'xf_baz'; $structure->shortName = 'XF:Baz'; $structure->primaryKey = 'baz_id'; $structure->columns = [ 'baz_id' => ['type' => self::UINT, 'autoIncrement' => true], 'foo_criteria' => ['type' => self::JSON_ARRAY, 'default' => [], 'required' => 'please_select_criteria_that_must_be_met'], 'bar_criteria' => ['type' => self::JSON_ARRAY, 'default' => []] ]; return $structure; } \u51c6\u5219\u7269\u4ef6 \u00b6 \u4e3a\u4e86\u4f7f\u7528\u51c6\u5219\u7cfb\u7edf\uff0c\u6211\u4eec\u9700\u8981\u4ece\u9009\u5b9a\u7684\u51c6\u5219\u8868\u5355\u6570\u636e\u4e2d\u521b\u5efa\u4e00\u4e2a\u51c6\u5219\u7269\u4ef6\uff0c\u8fd9\u53ef\u4ee5\u901a\u8fc7 app \u7684 criteria() \u65b9\u6cd5\u6765\u5b8c\u6210\uff1a /** @var \\Qux\\Criteria\\Foo $fooCriteria */ $fooCriteria = \\XF::app()->criteria('Qux:Foo', $bazEntity->foo_criteria); /** @var \\Qux\\Criteria\\Bar $barCriteria */ $barCriteria = \\XF::app()->criteria('Qux:Bar', $bazEntity->bar_criteria); \u4ece\u73b0\u5728\u5f00\u59cb\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u6240\u6709\u7684 AbstractCriteria \u529f\u80fd\uff0c\u52a0\u4e0a\u6211\u4eec\u5728\u5b50\u7c7b Foo / Bar \u4e2d\u989d\u5916\u7f16\u5199\u7684\u6240\u6709\u5185\u5bb9\u3002 \u5339\u914d \u00b6 \u5f53\u6211\u4eec\u60f3\u68c0\u67e5\u67d0\u4e2a\u4e1c\u897f\uff08User\uff09\u662f\u5426\u7b26\u5408\u9009\u5b9a\u7684\u51c6\u5219\u65f6\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 isMatched \u65b9\u6cd5\uff1a $visitor= \\XF::visitor(); if ($fooCriteria->isMatched($visitor)) { // \u8bbf\u5ba2\u7b26\u5408\u6240\u6709\u9009\u5b9a\u7684\u51c6\u5219 } else { // \u8bbf\u5ba2\u4e0d\u7b26\u5408\u4e00\u4e2a\u6216\u591a\u4e2a\u51c6\u5219 } isMacthed() \u5c06\u51c6\u5219\u89c4\u5219\u8ee2\u6362\u4e3a\u5e2f\u6709 _match \u524d\u7f00\u7684\u9a7c\u5cf0\u5f0f\u547d\u540d\u65b9\u6cd5\uff1a criterion_1_rule > _matchCriterion1Rule \uff0c\u5e76\u5c1d\u8bd5\u5728\u51c6\u5219\uff1a\u578b class \u4e2d\u627e\u5230\u8fd9\u6837\u4e00\u4e2a\u65b9\u6cd5\uff08\u5728\u6211\u4eec\u7684\u4f8b\u5b50\u4e2d\u662f Foo \u7c7b\uff09\uff1a // Qux/Criteria/Foo.php protected function _matchCriterion1Rule(array $data, \\XF\\Entity\\User $user) { /* ... \u5904\u7406\u51c6\u5219 ... */ return true; // \u7528\u6237\u7b26\u5408\u5f53\u524d\u51c6\u5219 /* \u6216\u8005 */ return false; // \u7528\u6237\u4e0d\u7b26\u5408\u5f53\u524d\u51c6\u5219 } \u5982\u679c\u5728 class \u4e2d\u627e\u4e0d\u5230\u67d0\u4e2a\u65b9\u6cd5\uff0c isMatched() \u4f1a\u8c03\u7528 isUnknownMatched() \uff0c\u5176\u884c\u4e3a\u53ef\u4ee5\u5728 AbstractCriteria \u7956\u5148\u4e2d\u8bbe\u7f6e\uff08\u9ed8\u8ba4\u8fd4\u56de false \uff09\u3002 \u5982\u679c\u6ca1\u6709\u9009\u5b9a\u4efb\u4f55\u51c6\u5219\uff0c isMatched() \u5c06\u8fd4\u56de $matchOnEmpty \u53d8\u91cf\uff0c\u9ed8\u8ba4\u4e3a true \u3002 \u4f60\u53ef\u4ee5\u5728\u4f7f\u7528 isMatched() \u65b9\u6cd5 \u4e4b\u524d \u8c03\u7528 $crteriaObj->setMatchOnEmpty(false) \u6765\u6539\u53d8\u8fd9\u79cd\u884c\u4e3a\uff1a $visitor= \\XF::visitor(); $fooCriteria->setMatchOnEmpty(false); if ($fooCriteria->isMatched($visitor)) { // \u8bbf\u5ba2\u7b26\u5408\u6240\u6709\u9009\u5b9a\u7684\u51c6\u5219 } else { // \u8bbf\u5ba2\u4e0d\u7b26\u5408\u4e00\u4e2a\u6216\u591a\u4e2a\u51c6\u5219 } \u51c6\u5219\u662f\u5982\u4f55\u8fd0\u4f5c\u7684 (\u4f8b\u5b50) \u00b6 \u60f3\u8c61\u4e00\u4e0b\uff0c\u4f60\u60f3\u7ed9\u6240\u6709\u62e5\u6709\u5934\u50cf\u5e76\u83b7\u5f97\u81f3\u5c11 5 \u4e2a\u8d5e\u7684\u7528\u6237\u9881\u53d1\u4e00\u4e2a\u6210\u5c31\u3002 \u5728\u521b\u5efa\u6210\u5c31\u65f6\uff0c\u4f60\u9009\u62e9 \"\u7528\u6237\u6709\u5934\u50cf\"\uff08\u89c4\u5219 has_avatar \uff09\u548c \"\u7528\u6237\u81f3\u5c11\u53ce\u5230 X \u4e2a\u8cdb\"\uff08\u89c4\u5219 like_count \uff09\u51c6\u5219\u3002 \u6700\u540e\u4e00\u4e2a\u8fd8\u5177\u6709\u4e00\u4e2a\u5305\u542b\u4e00\u4e2a\u5143\u7d20\u7684\u6570\u636e\u6570\u7ec4\uff1a\u559c\u6b22\u7684\u6570\u91cf\u3002 \u60a8\u6240\u9009\u62e9\u7684\u51c6\u5219\u4fdd\u5b58\u5728 xf_trophy \u8d44\u6599\u8868\u4e2d\u7684 user_criteria column\u3002 \u5f53 XenForo \u51b3\u5b9a\u68c0\u67e5\uff0c\u662f\u5426\u7ed9\u7528\u6237\u9881\u53d1\u6210\u5c31\u65f6\uff0c\u5b83\u4f1a\u5c06\u89c4\u5219\u8ee2\u6362\u4e3a\u9a7c\u5cf0\u5f0f\u547d\u540d\u65b9\u6cd5\uff1a like_count > _matchLikeCount() has_avatar > _matchHasAvatar() \u7531\u4e8e\u6240\u9009\u7684\u4e24\u4e2a\u51c6\u5219\u90fd\u662f\u7528\u6237\u51c6\u5219\uff0c\u56e0\u6b64 XenForo \u6ee1\u8db3\u7528\u6237\u51c6\u5219 class\uff0c\u5e76\u8bd5\u56fe\u5728\u5176\u4e2d\u627e\u5230\u8fd9\u4e9b\u65b9\u6cd5\uff1a // XF/Criteria/User.php //... protected function _matchLikeCount(array $data, \\XF\\Entity\\User $user) { return ($user->like_count && $user->like_count >= $data['likes']); } //... protected function _matchHasAvatar(array $data, \\XF\\Entity\\User $user) { return $user->user_id && ($user->avatar_date || $user->gravatar); } //... \u5982\u679c \u6240\u6709 \u4f4d\u7f6e\u7684\u65b9\u6cd5\u90fd\u8fd4\u56de true \uff0c\u6211\u4eec\u7684\u7528\u6237\u5c31\u7b26\u5408\u9009\u5b9a\u7684\u51c6\u5219\uff0c\u56e0\u6b64\u5c06\u83b7\u5f97\u4e00\u4e2a\u6210\u5c31\u3002 \u5982\u679c\u5728 User \u51c6\u5219\u7c7b\u4e2d\u627e\u4e0d\u5230\u67d0\u4e9b\u65b9\u6cd5\uff0cXenForo \u4f1a\u8c03\u7528 isUnknownMatched() \u65b9\u6cd5\uff0c\u8fdb\u800c\u89e6\u53d1 criteria_user \u4e8b\u4ef6\uff0c\u5141\u8bb8\u9644\u52a0\u7ec4\u4ef6\u5236\u4f5c\u8005\u6dfb\u52a0\u4ed6\u4eec\u7684\u81ea\u5b9a\u4e49\u51c6\u5219\u5904\u7406\u7a0b\u5e8f\u3002 \uff08\u53c2\u89c1 \"\u81ea\u5b9a\u4e49\u7528\u6237/\u9875\u9762\u51c6\u5219\u8303\u4f8b\" \uff09\u3002 \u989d\u5916\u51c6\u5219\u6570\u636e \u00b6 \u6709\u65f6\uff0c\u5728\u7f16\u5199\u51c6\u5219\u6a21\u677f\u4ee3\u7801\u65f6\uff0c\u4f60\u9700\u8981\u8bbf\u95ee\u989d\u5916\u7684\u6570\u636e\uff0c\u800c\u8fd9\u4e9b\u6570\u636e\u4e0d\u662f\u901a\u8fc7 view \u53c2\u6570\u4f20\u9012\u7684\u3002 \u8fd9\u5c31\u662f getExtraTemplateData() \u65b9\u6cd5\u5b58\u5728\u7684\u610f\u4e49\u3002 \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5b83\u5305\u542b\u73b0\u6709\u7684\u7528\u6237\u7ec4\u3001\u8bed\u8a00\u3001\u98ce\u683c\u6837\u5f0f\u3001\u65f6\u533a\u3002 \u4f60\u53ef\u4ee5\u5728\u4f60\u7684\u81ea\u5b9a\u4e49\u51c6\u5219\u7c7b\u578b class \u4e2d\u590d\u76d6\u8fd9\u4e2a\u65b9\u6cd5\u3002 \u5728\u81ea\u5b9a\u4e49\u51c6\u5219\u7c7b\u578b\u4e2d\u6dfb\u52a0\u6570\u636e \u00b6 \u5728\u60a8\u7684\u81ea\u5b9a\u4e49\u51c6\u5219 class \u4e2d\u590d\u76d6 getExtraTemplateData() \u65b9\u6cd5\uff1a public function getExtraTemplateData() { $templateData = parent::getExtraTemplateData(); $additionalData = []; /** @var \\XF\\Repository\\Smilie $smilieRepo */ $smilieRepo = \\XF::repository('XF:Smilie'); $additionalData['smilies'] = $smilieRepo->findSmiliesForList()->fetch(); return array_merge($templateData, $additionalData); } \u5728\u73b0\u6709\u51c6\u5219\u7c7b\u578b\u4e2d\u6dfb\u52a0\u6570\u636e \u00b6 \u4f60\u53ef\u4ee5\u4f7f\u7528 criteria_template_data \u4e8b\u4ef6\u76d1\u542c\u5668\u6765\u6dfb\u52a0\u4f60\u81ea\u5df1\u7684\u989d\u5916\u51c6\u5219\u6570\u636e\uff1a public static function criteriaTemplateData(array &$templateData) { /** @var \\XF\\Repository\\Smilie $smilieRepo */ $smilieRepo = \\XF::repository('XF:Smilie'); $templateData['smilies'] = $smilieRepo->findSmiliesForList()->fetch(); } \"helper_criteria\" \u6a21\u677f \u00b6 \u6bcf\u5f53\u4f60\u4f5c\u4e3a\u9644\u52a0\u7ec4\u4ef6\u5236\u4f5c\u8005\u60f3\u8ba9\u76ee\u6807 \u7528\u6237/\u7ba1\u7406\u5458 \u6709\u529e\u6cd5\u9009\u62e9 \u7528\u6237/\u9875\u9762/\u5176\u4ed6\u9644\u52a0\u7ec4\u4ef6 \u7684\u51c6\u5219\u65f6\uff08\u751a\u81f3\u5168\u90e8\u4e00\u8d77\uff09\uff0c\u4f60\u53ef\u4ee5\u7b80\u5358\u5730\u4f7f\u7528 helper_criteria \u3002 \u7b80\u800c\u8a00\u4e4b\uff0c helper_criteria \u662f\u4e00\u4e2a\u5141\u8bb8\u5728\u591a\u5904\u4f7f\u7528\u57fa\u4e8e\u51c6\u5219\u7c7b\u578b\u7684\u6838\u53d6\u65b9\u5757\u4ecb\u9762\u7684\u7ba1\u7406\u6a21\u677f\uff0c\u65e0\u9700\u590d\u5236\u7c98\u8d34\u76f8\u540c\u4ee3\u7801\u3002 helper_criteria \u5305\u542b \u4e24\u4e2a \u7c7b\u578b\u7684\u5de8\u96c6\uff1a *criteria_name*_tabs \u548c *criteria_name*_panes \uff0c\u9002\u7528\u4e8e\u6bcf\u4e2a\u51c6\u5219\u7c7b\u578b\u3002 \u4f8b\u5982\uff1a\u7528\u6237\u51c6\u5219\u7c7b\u578b\u7684 user_tabs \u548c user_panes \u5de8\u96c6\u3002 \u6807\u7b7e \u00b6 \u6807\u7b7e\u7528\u4e8e\u533a\u5206\u4ed6\u4eec\u6240\u4f7f\u7528\u6a21\u677f\u5185\u7684\u4e0d\u540c\u51c6\u5219\u7c7b\u578b\uff1a \u4f7f\u7528\u6807\u7b7e\u65f6\uff0c\u7b2c\u4e00\u4e2a\u6807\u7b7e\u5f80\u5f80\u5305\u542b\u4e0e\u51c6\u5219\u65e0\u5173\u7684\u5b57\u6bb5/\u9009\u9879\u3002 \u7136\u540e\u5230\u51c6\u5219\u6807\u7b7e\u3002 \u5728\u4e0a\u56fe\u4e2d\uff0c\u7b2c\u4e00\u4e2a\u6807\u7b7e\u5305\u542b\u901a\u77e5\u7684\u9009\u9879\u3002 \u7ea2\u6846\u4e2d\u7684\u524d\u4e24\u4e2a\u6807\u7b7e\u4e0e\u7528\u6237\u51c6\u5219\u7c7b\u578b\u6709\u5173\u3002 \u6700\u540e\u4e00\u4e2a\u4e0e\u9875\u9762\u51c6\u5219\u7c7b\u578b\u6709\u5173\u3002 helper_criteria \u4e2d\u7684\u6807\u7b7e\u88ab\u5f52\u7c7b\u5728\u51c6\u5219\u7c7b\u578b\u5de8\u96c6\u4e0b\uff1a <xf:macro name=\"foo_tabs\" arg-container=\"\" arg-active=\"\"> <xf:set var=\"$tabs\"> <a class=\"tabs-tab{{ $active == 'foo' ? ' is-active' : '' }}\" role=\"tab\" tabindex=\"0\" aria-controls=\"{{ unique_id('criteriaFoo') }}\">Foo criteria</a> <a class=\"tabs-tab{{ $active == 'foo_extra' ? ' is-active' : '' }}\" role=\"tab\" tabindex=\"0\" aria-controls=\"{{ unique_id('criteriaFooExtra') }}\">Foo criteria extra</a> </xf:set> <xf:if is=\"$container\"> <div class=\"tabs\" role=\"tablist\"> {$tabs|raw} </div> <xf:else /> {$tabs|raw} </xf:if> </xf:macro> In the code above, foo is a criteria type. It has two tabs, one for general foo criteria and another for extra foo criteria. \u5728\u4e0a\u9762\u7684\u4ee3\u7801\u4e2d\uff0c foo \u662f\u4e00\u4e2a\u51c6\u5219\u7c7b\u578b\u3002 \u5b83\u6709\u4e24\u4e2a\u6807\u7b7e\uff0c\u4e00\u4e2a\u7528\u4e8e\u4e00\u822c\u7684 foo \u51c6\u5219\uff0c\u53e6\u4e00\u4e2a\u7528\u4e8e\u989d\u5916\u7684 foo \u51c6\u5219\u3002 Panes (\u7a97\u683c) \u00b6 Panes \u4ec5\u4ec5\u5305\u542b\u51c6\u5219\u3002 \u548c\u6807\u7b7e\u4e00\u6837\uff0c helper_criteria \u4e2d\u7684 Panes \u4e5f\u662f\u6309\u7167\u51c6\u5219\u7c7b\u578b\u5de8\u96c6\u6765\u5f52\u7c7b\u7684\uff1a <xf:macro name=\"foo_panes\" arg-container=\"\" arg-active=\"\" arg-criteria=\"!\" arg-data=\"!\"> <xf:set var=\"$panes\"> <li class=\"{{ $active == 'foo' ? ' is-active' : '' }}\" role=\"tabpanel\" id=\"{{ unique_id('criteriaFoo') }}\"> <xf:checkboxrow label=\"Criteria group 1\"> <xf:option name=\"foo_criteria[criterion_1_rule][rule]\" value=\"criterion_1_rule\" ... /> <xf:option name=\"foo_criteria[criterion_2_rule][rule]\" value=\"criterion_2_rule\" ... /> </xf:checkboxrow> <xf:checkboxrow label=\"Criteria group 2\"> <xf:option name=\"foo_criteria[criterion_3_rule][rule]\" value=\"criterion_3_rule\" ... /> <xf:option name=\"foo_criteria[criterion_4_rule][rule]\" value=\"criterion_4_rule\" ... /> </xf:checkboxrow> </li> </xf:set> <xf:if is=\"$container\"> <ul class=\"tabPanes\"> {$panes|raw} </ul> <xf:else /> {$panes|raw} </xf:if> </xf:macro> \u4f7f\u7528 \"helper_criteria\" \u00b6 \u8981\u4f7f\u7528 \"helper_criteria\" \u7684\u529f\u80fd\uff0c\u4f60\u9700\u8981\u52a0\u5165\u5b83\u7684\u5de8\u96c6\u3002 \u51c6\u5907\u6570\u636e \u00b6 \u5982\u679c\u60a8 \u6ca1\u6709 \u60a8\u6240\u9009\u5b9a\u7684\u51c6\u5219\u4fdd\u5b58\u5728\u6570\u636e\u5e93\u4e2d\u7684\u67d0\u4e2a\u5730\u65b9\uff0c\u6216\u8005\u60a8\u8981\u4f7f\u7528\u7684\u51c6\u5219\u7c7b\u578b \u4e0d\u9700\u8981 \u4efb\u4f55\u989d\u5916\u7684\u6570\u636e\uff0c\u53ef\u4ee5\u8df3\u8fc7\u672c\u8282\u3002 \u9996\u5148\uff0c\u60a8\u9700\u8981\u68c0\u7d22\u5df2\u4fdd\u5b58\u7684\u9009\u5b9a\u51c6\u5219\uff0c\u5e76\u4ece\u4e2d\u521b\u5efa\u4e00\u4e2a\u51c6\u5219\u7269\u4ef6\u3002 \u5728\u672c\u8282\u4e2d\uff0c\u6211\u4eec\u5c06\u4ee5 Page \u51c6\u5219\u4e3a\u4f8b\u5b50\uff1a $savedCriteria = /* Retrieve it somehow... */ // \u51c6\u5219\u7269\u4ef6 $criteria = $this->app()->criteria('XF:Page', $savedCriteria)->getCriteriaForTemplate(); // \u51c6\u5219\u989d\u5916\u6570\u636e $criteriaData = $criteria->getExtraTemplateData(); $viewParams = [ /* ... */ 'criteria' => $criteria, 'criteriaData' => $criteriaData ]; return $this->view(/* ... */, $viewParams); \u5305\u542b\u6ca1\u6709\u5185\u5bb9\u7684\u6807\u7b7e \u00b6 \u8981\u5305\u542b\u6ca1\u6709\u5185\u5bb9\u7684\u6807\u7b7e\u51c6\u5219\uff0c\u4f60\u9700\u8981\u4f7f\u7528 <xf:macro... \u6807\u7b7e\uff0c\u5e76\u5c06 arg-container \u5c5e\u6027\u8bbe\u7f6e\u4e3a 0 \u3002 <xf:macro template=\"helper_criteria\" name=\"page_panes\" arg-container=\"0\" arg-criteria=\"{$criteria}\" arg-data=\"{$criteriaData}\" /> \u5982\u679c\u4f60\u6ca1\u6709\u4fdd\u5b58\u51c6\u5219\uff0c\u4f60\u53ef\u4ee5\u76f4\u63a5\u5c06\u7a7a\u6570\u7ec4 {{ [] }} \u4f20\u9012\u7ed9 arg-criteria \u5c5e\u6027\u3002 \u4e0d\u8981\u5fd8\u8bb0\u628a page_panes \u4e2d\u7684 page \u66ff\u6362\u6210\u4f60\u60f3\u4f7f\u7528\u7684\u51c6\u5219\u7c7b\u578b\u540d\u79f0\u3002 \u8bf7\u8bb0\u4f4f\uff0c\u6240\u6709\u7684\u51c6\u5219\u90fd\u662f\u7528 <li> \u6807\u7b7e\u5305\u4f4f\u7684\uff0c\u6240\u4ee5\u4f60\u9700\u8981\u5e94\u7528\u4e00\u4e9b CSS \u6837\u5f0f\uff08\u4f8b\u5982 list-style-type: none; \uff09\u3002 \u6709\u5185\u5bb9\u7684\u6807\u7b7e \u00b6 \u4e3a\u4e86\u4f7f\u7528\u51c6\u5219\u6807\u7b7e\uff0c\u4f60\u9700\u8981\u7ec4\u7ec7\u9875\u9762\u3002 \u575a\u6301\u4ee5\u4e0b\u8303\u4f8b\u7ed3\u6784\uff1a <xf:form ... class=\"block\"> <div class=\"block-container\"> <!-- \u6807\u7b7e --> <h2 class=\"block-tabHeader tabs hScroller\" data-xf-init=\"h-scroller tabs\" role=\"tablist\"> <span class=\"hScroller-scroll\"> <!-- Main tab where fields/options are located --> <a class=\"tabs-tab is-active\" role=\"tab\" tabindex=\"0\" aria-controls=\"MAIN_TAB_ID\">Main tab title</a> <!-- \u51c6\u5219\u6807\u7b7e --> <xf:macro template=\"helper_criteria\" name=\"page_tabs\" arg-userTabTitle=\"Custom tab name (optionally)\" /> </span> </h2> <!-- \u7a97\u683c --> <ul class=\"block-body tabPanes\"> <!-- Main pane --> <li class=\"is-active\" role=\"tabpanel\" id=\"MAIN_TAB_ID\"> <!-- Fields and options --> </li> <!-- \u51c6\u5219\u7a97\u683c --> <xf:macro template=\"helper_criteria\" name=\"page_panes\" arg-criteria=\"{$criteria}\" arg-data=\"{$criteriaData}\" /> </ul> <xf:submitrow sticky=\"true\" icon=\"save\" /> </div> </xf:form> \u540c\u6837\uff0c\u5982\u679c\u4f60\u6ca1\u6709\u4efb\u4f55\u51c6\u5219\u6570\u636e\uff0c\u6216\u8005\u751a\u81f3\u5047\u8bbe\u6ca1\u6709\uff0c\u8bf7\u5c06 {{ [] }} \u4f20\u9012\u7ed9 arg-criteria \u5c5e\u6027\u3002 \u5728 \"helper_criteria\" \u4e2d\u6dfb\u52a0\u81ea\u5b9a\u4e49\u51c6\u5219\u7c7b\u578b \u00b6 \u5982\u679c\u4f60\u60f3\u5728 helper_criteira \u6a21\u677f\u4e2d\u6dfb\u52a0\u81ea\u5b9a\u4e49\u51c6\u5219\u7c7b\u578b\uff0c\u4f60\u9700\u8981\u521b\u5efa\u4e00\u4e2a helper_criteria \u6a21\u677f\u7684\u6a21\u677f\u4fee\u6539\u3002 \u8fdb\u5165 Admin CP \u4e2d\u7684 \"\u5916\u89b3 > \u6a21\u677f\u4fee\u6539\"\uff0c\u5207\u6362\u5230 \"\u7ba1\u7406\" \u6807\u7b7e\uff0c\u70b9\u51fb \"\u6dfb\u52a0\u6a21\u677f\u4fee\u6539\" \u6309\u94ae\u3002 \u6211\u4eec\u8981\u5728\u6a21\u677f\u7684\u6700\u5e95\u90e8\u6dfb\u52a0\u6211\u4eec\u7684\u6807\u7b7e\u548c\u7a97\u683c\uff0c\u6240\u4ee5\u5c06 \"\u641c\u5bfb\u7c7b\u578b\" \u5207\u6362\u4e3a \"\u6b63\u89c4\u8868\u8fbe\u5f0f\"\u3002 \u5728 \"\u67e5\u627e\" \u680f\u4e2d\u8f93\u5165 /$/ \u3002 \u6700\u540e\uff0c\u5728 \"\u66ff\u6362\" \u5b57\u6bb5\u4e2d\u6dfb\u52a0\u6807\u7b7e\u548c\u7a97\u683c\u7684\u5de8\u96c6\u4ee3\u7801\u3002 \u4e3e\u4f8b\uff1a <xf:macro name=\"foo_tabs\" arg-container=\"\" arg-active=\"\"> <xf:set var=\"$tabs\"> <a class=\"tabs-tab{{ $active == 'foo' ? ' is-active' : '' }}\" role=\"tab\" tabindex=\"0\" aria-controls=\"{{ unique_id('criteriaFoo') }}\">Foo criteria</a> <a class=\"tabs-tab{{ $active == 'foo_extra' ? ' is-active' : '' }}\" role=\"tab\" tabindex=\"0\" aria-controls=\"{{ unique_id('criteriaFooExtra') }}\">Foo criteria extra</a> </xf:set> <xf:if is=\"$container\"> <div class=\"tabs\" role=\"tablist\"> {$tabs|raw} </div> <xf:else /> {$tabs|raw} </xf:if> </xf:macro> <xf:macro name=\"foo_panes\" arg-container=\"\" arg-active=\"\" arg-criteria=\"!\" arg-data=\"!\"> <xf:set var=\"$panes\"> <li class=\"{{ $active == 'foo' ? ' is-active' : '' }}\" role=\"tabpanel\" id=\"{{ unique_id('criteriaFoo') }}\"> <xf:checkboxrow label=\"Criteria group 1\"> <xf:option name=\"foo_criteria[criterion_1_rule][rule]\" value=\"criterion_1_rule\" ... /> <xf:option name=\"foo_criteria[criterion_2_rule][rule]\" value=\"criterion_2_rule\" ... /> </xf:checkboxrow> <xf:checkboxrow label=\"Criteria group 2\"> <xf:option name=\"foo_criteria[criterion_3_rule][rule]\" value=\"criterion_3_rule\" ... /> <xf:option name=\"foo_criteria[criterion_4_rule][rule]\" value=\"criterion_4_rule\" ... /> </xf:checkboxrow> </li> </xf:set> <xf:if is=\"$container\"> <ul class=\"tabPanes\"> {$panes|raw} </ul> <xf:else /> {$panes|raw} </xf:if> </xf:macro> \u73b0\u5728\uff0c\u60a8\u53ef\u4ee5\u5728\u4efb\u4f55\u5730\u65b9\u4f7f\u7528\u60a8\u7684\u51c6\u5219\uff08\u8bf7\u53c2\u89c1 \"\u4f7f\u7528helper_criteria\" )\u3002 \u81ea\u5b9a\u4e49\u7528\u6237/\u9875\u9762\u51c6\u5219\u8303\u4f8b \u00b6 \u6bd4\u65b9\u8bf4\uff0c\u6211\u4eec\u60f3\u521b\u5efa\u4e00\u4e2a\u51c6\u5219\u6765\u68c0\u67e5\u6211\u4eec\u7684\u7528\u6237\u662f\u5426\u5728\u5358\u5219\u7559\u8a00\u4e0a\u6709 X \u4e2a\u6216\u66f4\u591a\u7684\u8cdb\u3002 \u7531\u4e8e\u6211\u4eec\u7684\u51c6\u5219\u662f\u6307\u7528\u6237\uff0c\u6240\u4ee5\u6211\u4eec\u5c06\u521b\u5efa\u4e00\u4e2a\u5c5e\u65bc\u7528\u6237\u51c6\u5219\u7684\u51c6\u5219\u3002 \u589e\u52a0\u6a21\u677f\u4fee\u6539 \u00b6 \u9996\u5148\uff0c\u6211\u4eec\u9700\u8981\u5c06\u6211\u4eec\u7684\u51c6\u5219\u6dfb\u52a0\u5230\u7528\u6237\u51c6\u5219\u5217\u8868\u4e2d\u3002 \u8fdb\u5165 Admin CP \u4e2d\u7684 \"\u6a21\u677f\u4fee\u6539\" \u9875\u9762\uff0c\u9009\u62e9 \"Admin\" \u6807\u7b7e\uff0c\u70b9\u51fb\u53f3\u4e0a\u89d2\u7684 \"\u6dfb\u52a0\u6a21\u677f\u4fee\u6539\" \u6309\u94ae\u3002 Warning \u5982\u679c\u6ca1\u6709 \"Admin\" \u6807\u7b7e\uff0c\u8bf7\u786e\u4fdd\u4f60\u5df2\u7ecf\u6fc0\u6d3b\u4e86 \u5f00\u53d1\u6a21\u5f0f \u3002 \u6211\u4eec\u5c06\u4fee\u6539 helper_criteria \u6a21\u677f\uff0c\u56e0\u6b64\u5c06\u5176\u5199\u5165\u5230 \"\u6a21\u677f\" \u5b57\u6bb5\u3002 \u5728\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\uff0c\u6211\u5c06\u4f7f\u7528 likes_on_single_message \"\u4fee\u6539 key \u503c\" \u6765\u4fee\u6539\u8fd9\u4e2a\u6a21\u677f\u3002 \u6211\u4eec\u7684\u51c6\u5219\u662f\u5173\u4e8e\u7559\u8a00\u7684\u70b9\u8cdb\u6570\u3002 \u8fd9\u610f\u5473\u7740\u5b83\u5e94\u8be5\u5728 \"\u5185\u5bb9\u548c\u6210\u5c31\" \u90e8\u5206\u4e0b\u3002 \u8fd9\u8868\u793a\u6211\u4eec\u53ea\u9700\u8981\u627e\u5230 <\uff01--[XF:user:content_bottom]--> \uff0c\u7136\u540e\u7528\u4e0b\u9762\u7684\u4ee3\u7801\u66ff\u6362\u3002 <xf:option name=\"user_criteria[likes_on_single][rule]\" value=\"likes_on_single\" selected=\"{$criteria.likes_on_single}\" label=\"Likes on single message:\"> <xf:numberbox name=\"user_criteria[likes_on_single][data][likes]\" value=\"{$criteria.likes_on_single.likes}\" size=\"5\" min=\"0\" step=\"1\" /> </xf:option> $0 \u4ece\u8fd9\u4e00\u523b\u8d77\uff0c\u6211\u4eec\u5df2\u7ecf\u53ef\u4ee5\u770b\u5230\uff0c\u751a\u81f3\u53ef\u4ee5\u5728\u521b\u5efa\u6210\u5c31\u3001\u901a\u77e5\u548c\u63d0\u5347\u7528\u6237\u7ec4\u65f6\u4e3a\u6211\u4eec\u7684\u51c6\u5219\u8bbe\u7f6e\u4e00\u4e2a\u503c\u3002 \u589e\u52a0\u4ee3\u7801\u4e8b\u4ef6\u76d1\u542c\u5668 \u00b6 \u6211\u4eec\u5df2\u7ecf\u521b\u5efa\u4e86\u6211\u4eec\u7684\u51c6\u5219\u3002 \u4f46\u5bf9\u4e8e XenForo \u6765\u8bf4\uff0c\u5b83\u662f\u672a\u77e5\u7684\uff0c\u5f53\u7b26\u5408\u8fd9\u79cd\u51c6\u5219\u65f6\uff0c\u5b83\u603b\u662f\u8fd4\u56de \"false\"\u3002 \u6211\u4eec\u9700\u8981\u544a\u8bc9 XenForo\uff0c\u5f53\u5b83\u7b26\u5408\u672a\u77e5\u51c6\u5219\u65f6\u8be5\u600e\u9ebd\u505a\u3002 \u8fdb\u5165 \"\u5f00\u53d1 > \u4ee3\u7801\u4e8b\u4ef6\u76d1\u542c\u5668\" \u9875\u9762\uff0c\u70b9\u51fb \"\u6dfb\u52a0\u4ee3\u7801\u4e8b\u4ef6\u76d1\u542c\u5668\" \u6309\u94ae\u3002 \u5728 \"\u76d1\u542c\u4e8b\u4ef6\" \u5b57\u6bb5\u4e2d\u9009\u62e9 criteria_user \uff08 user \u56e0\u4e3a\u6211\u4eec\u7684\u51c6\u5219\u5c5e\u65bc\u7528\u6237\u51c6\u5219\uff09\u3002 \u5728 \"\u8fd0\u884c callback\" \u5b57\u6bb5\u4e2d\uff0c\u6211\u4eec\u5e94\u8be5\u6307\u5b9a\u5339\u914d\u51c6\u5219\u65f6\u8981\u8c03\u7528\u7684\u7c7b\u548c\u65b9\u6cd5\u3002 \u5728 addon \u6839\u76ee\u5f55\u4e0b\u521b\u5efa\u4e00\u4e2a\u6587\u4ef6 Listener.php \uff0c\u5982\u679c\u4f60\u8fd8\u6ca1\u6709\u7684\u8bdd\uff0c\u5728\u90a3\u91cc\u6dfb\u52a0\u4e00\u4e2a\u65b0\u7684\u65b9\u6cd5 criteriaUser \uff1a <?php namespace YOUR_ADDON_ID; class Listener { public static function criteriaUser($rule, array $data, \\XF\\Entity\\User $user, &$returnValue) { } } \u4f60\u53ef\u4ee5\u7528 YOUR_ADDON_ID\\Listener \u548c criteriaUser \u5206\u522b\u586b\u5199 \"Class\" \u548c \"Method\" \u5b57\u6bb5\u3002 \u5904\u7406\u51c6\u5219 \u00b6 \u7531\u4e8e\u6211\u4eec\u7684 criteriaUser \u65b9\u6cd5\u5bf9\u6bcf\u4e2a\u672a\u77e5\u7684\u51c6\u5219\u90fd\u4f1a\u88ab\u89e6\u53d1\uff0c\u6211\u4eec\u9700\u8981\u786e\u4fdd $rule \u7b49\u4e8e likes_on_single \uff08\u6211\u4eec\u5728 HTML \u6807\u7b7e\u4e2d\u6307\u5b9a\u7684\u89c4\u5219\uff09\u3002 public static function criteriaUser($rule, array $data, \\XF\\Entity\\User $user, &$returnValue) { switch ($rule) { case 'likes_on_single': /** \u5904\u7406\u4ee3\u7801\u5728\u8fd9\u91cc! */ break; } } \u73b0\u5728\uff0c\u6211\u4eec\u9700\u8981\u5199\u4ee3\u7801\u6765\u5b9e\u9645\u68c0\u67e5\u4e00\u4e2a\u7528\u6237\u662f\u5426\u6709 X \u4e2a\u6216\u66f4\u591a\u8d5e\u7684\u7559\u8a00\u3002 \u8fd9\u53ef\u4ee5\u901a\u8fc7\u7b80\u5358\u7684 SQL \u67e5\u627e\u8f7b\u677e\u5b9e\u73b0\uff0c\u4ece xf_post \u4e2d\u9009\u62e9\u4e00\u6761\u8d85\u8fc7 X \u4e2a\u8d5e\u7684\u8bb0\u5f55\uff08 likes column \uff09\uff0c\u5e76\u4e14 user_id \u7b49\u4e8e\u5f53\u524d\u5339\u914d\u7684\u7528\u6237 ID\u3002 \u6240\u4ee5\uff0c\u4e0b\u9762\u662f\u67e5\u627e\u8bed\u53e5\uff1a SELECT `likes` FROM `xf_post` WHERE `user_id` = ? ORDER BY `likes` DESC LIMIT 1 \u4ee5\u53ca\u65b9\u6cd5\u4ee3\u7801\uff1a public static function criteriaUser($rule, array $data, \\XF\\Entity\\User $user, &$returnValue) { switch ($rule) { case 'likes_on_single': // \u83b7\u53d6\u6570\u636e\u5e93 $db = \\XF::db(); // \u7528\u4e8e\u9009\u62e9\u5358\u4e2a\u7528\u6237\u5e16\u5b50\u7684\u6700\u5927\u70b9\u8cdb\u6570\u7684\u6570\u636e\u5e93\u67e5\u627e $query = \"SELECT `likes` FROM `xf_post` WHERE `user_id` = ? ORDER BY `likes` DESC LIMIT 1\"; // \u68c0\u7d22\u6700\u5927\u70b9\u8cdb\u6570 $likes = $db->fetchOne($query, [$user->user_id]); // \u68c0\u67e5\u6211\u4eec\u662f\u5426\u6709\u6765\u81ea\u6570\u636e\u5e93\u7684\u7ed3\u679c(\u6211\u4eec\u671f\u671b\u6709\u4e00\u4e2a\u6570\u5b57) if (is_int($likes)) { // \u5982\u679c\u7528\u6237\u7684\u4fe1\u606f\u6709 X \u4e2a\u6216\u66f4\u591a\u7684\u8cdb\uff0c\u5219\u8fd4\u56de true\uff1b\u5982\u679c\u6ca1\u6709\uff0c\u5219\u8fd4\u56de false $returnValue = ($likes >= $data['likes']); } else { $returnValue = false; } break; } } \u8981\u6ce8\u610f\u4ee5\u4e0b\u51e0\u70b9\uff1a \u6211\u4eec\u4f7f\u7528 $user \u53d8\u91cf\u6765\u68c0\u7d22\u5f53\u524d\u5339\u914d\u7684\u7528\u6237\u3002 \u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u8fd9\u4e2a\u53d8\u91cf\uff0c\u56e0\u4e3a\u6211\u4eec\u7684\u51c6\u5219\u5c5e\u65bc \u7528\u6237 \u51c6\u5219\u3002 \u6211\u4eec\u53ef\u4ee5\u901a\u8fc7 $data \u6570\u7ec4\u8bbf\u95ee\u6570\u636e\u3002 \u5b83\u5305\u542b\u4e86\u6211\u4eec\u5728 \u6a21\u677f\u4fee\u6539\u4e2d\u5df2\u6dfb\u52a0 \u7684\u5b57\u6bb5\u7684\u6570\u636e\u3002 \u6211\u4eec\u53ea\u6dfb\u52a0\u4e86\u4e00\u4e2a <xf:numberbox... \uff0c\u5176\u4e2d name \u5c5e\u6027\u7b49\u4e8e user_criteria[likes_on_single][data][likes] \u3002 \u8fd9\u5c31\u662f\u4e3a\u4ec0\u9ebd\u6211\u4eec\u53ef\u4ee5\u5728\u4e0a\u9762\u7684\u4ee3\u7801\u4e2d\u4f7f\u7528 $data['likes'] \u3002 \u73b0\u5728\u4e00\u5207\u90fd\u641e\u5b9a\u4e86\u3002 \u8ba9\u6211\u4eec\u6d4b\u8bd5\u4e00\u4e0b\u5427\uff01 \u6d4b\u8bd5\uff08\u6210\u5c31\uff09 \u00b6 \u521b\u5efa\u4e00\u4e2a \"\u4eba\u4eba\u4e3a\u6211\" \u7684\u6210\u5c31\u3002 \u5728 \"\u7528\u6237\u51c6\u5219\" \u6807\u7b7e\u4e0a\uff0c\"\u5358\u5219\u7559\u8a00\u7684\u70b9\u8cdb\u6570\" \u5b57\u6bb5\uff0c\u4f8b\u5982\uff0c5\u3002 \u63a5\u4e0b\u6765\uff0c\u5728\u4f60\u8bba\u575b\u7684\u67d0\u5904\u521b\u5efa\u4e00\u4e2a\u6d4b\u8bd5\u7559\u8a00\uff0c\u7136\u540e\u7528\u4e94\u4e2a\u4e0d\u540c\u7684\u7528\u6237\u70b9\u8cdb\u4e94\u6b21\uff08\u6216\u8005\u76f4\u63a5\u624b\u52a8\u8bbe\u7f6e likes \u680f\u7684\u503c\uff09\u3002 \u7136\u540e\uff0c\u8fdb\u5165 \"\u5de5\u5177 > \u8ba1\u753b\u4efb\u52a1\"\uff0c\u901a\u8fc7\u70b9\u51fb\u8fd0\u884c\u6309\u94ae (\u5faa\u73af-\u7bad\u5934) \"\u66f4\u65b0\u7528\u6237\u6210\u5c31\u503c\" \u8ba1\u753b\u3002 \u5f88\u597d\uff01 Warning \u5982\u679c\u60a8\u6ca1\u6709\u83b7\u5f97 \"\u4eba\u4eba\u4e3a\u6211\" \u6210\u5c31\uff0c\u8bf7\u5c1d\u8bd5\u767b\u51fa\u3001\u767b\u5f55\u5e76\u91cd\u65b0\u8fd0\u884c \"\u66f4\u65b0\u7528\u6237\u6210\u5c31\u503c\" \u8ba1\u753b\u3002 \u6d4b\u8bd5\uff08\u901a\u77e5\uff09 \u00b6 \u8fdb\u5165 \"\u8054\u7cfb > \u901a\u77e5\"\uff0c\u70b9\u51fb \"\u6dfb\u52a0\u901a\u77e5\" \u6309\u94ae\u3002 \u5728 \"\u7528\u6237\u51c6\u5219\" \u6807\u7b7e\u4e0a\uff0c\u5c06 \"\u5358\u5219\u7559\u8a00\u7684\u70b9\u8cdb\u6570\" \u5b57\u6bb5\u540c\u6837\u8bbe\u7f6e\u4e3a 5\u3002 \u4fdd\u5b58\u901a\u77e5\u3002 \u63a5\u4e0b\u6765\uff0c\u5728\u4f60\u8bba\u575b\u7684\u67d0\u5904\u521b\u5efa\u4e00\u4e2a\u6d4b\u8bd5\u7559\u8a00\uff0c\u7136\u540e\u7528\u4e94\u4e2a\u4e0d\u540c\u7684\u7528\u6237\u70b9\u8cdb\u4e94\u6b21\uff08\u6216\u8005\u76f4\u63a5\u624b\u52a8\u8bbe\u7f6e likes \u680f\u7684\u503c\uff09\u3002 \u73b0\u5728\uff0c\u4f60\u5e94\u8be5\u4f1a\u770b\u5230\u4e00\u5219\u901a\u77e5\uff1a \u4f60\u53ef\u4ee5 \u4e0b\u8f7d \u57fa\u4e8e\u8fd9\u4e2a\u8303\u4f8b\u6784\u5efa\u7684\u9644\u52a0\u7ec4\u4ef6\u8d44\u6e90 (2.0.10)\u3002 \u81ea\u5b9a\u4e49\u51c6\u5219\u7c7b\u578b\u8303\u4f8b \u00b6 \u60f3\u8c61\u4e00\u4e0b\uff0c\u6211\u4eec\u6b63\u5728\u521b\u5efa\u4e00\u4e2a\u9644\u52a0\u7ec4\u4ef6\uff08\u9644\u52a0\u7ec4\u4ef6 ID\uff1a PostsRemover \uff09\uff0c\u7528\u4e8e\u5220\u9664\u6240\u6709\u7b26\u5408\u9009\u5b9a\u51c6\u5219\u7684\u5e16\u5b50\u3002 \u4e00\u4e2a\u53ef\u7528\u51c6\u5219\u7684\u5217\u8868\uff1a \u5e16\u5b50\u81f3\u5c11\u6709 X \u4e2a\u70b9\u8cdb\u6570 \u5e16\u5b50\u4f5c\u8005\u6709\u4e00\u4e2a X \u7528\u6237\u540d \u5e16\u5b50\u81f3\u5c11\u88ab\u7f16\u8f91\u4e86 X \u6b21 \u5e16\u5b50\u88ab\u7f16\u8f91\u7684\u6b21\u6570\u4e0d\u8d85\u8fc7 X \u6b21 \u5e16\u5b50\u5728 X \u4e4b\u524d\u53d1\u8868 \u5e16\u5b50\u53d1\u8868\u4e8e X \u4e4b\u540e \u663e\u7136\uff0c\u5bf9\u4e8e\u8fd9\u6837\u7684\u51c6\u5219\uff0c\u6211\u4eec\u9700\u8981\u4e00\u79cd\u65b0\u7684\u51c6\u5219\u7c7b\u578b\uff1a\u5e16\u5b50\u51c6\u5219\u3002 Criteria type class \u51c6\u5219\u7c7b\u578b class \u00b6 \u6211\u4eec\u5e94\u8be5\u5148\u5728 addon \u7684 Criteria \u76ee\u5f55\u4e0b\u521b\u5efa\u4e00\u4e2a\u7ee7\u627f AbstractCriteria \u7684\u65b0 class Post \uff1a <?php namespace PostsRemover\\Criteria; use XF\\Criteria\\AbstractCriteria; class Post extends AbstractCriteria { } \u73b0\u5728\u6211\u4eec\u9700\u8981\u4e3a addon \u652f\u63f4\u7684\u6240\u6709\u51c6\u5219\u5199\u4ee3\u7801\u3002 \u5728\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\uff0c\u6211\u5c06\u4e3a\u4e0a\u9762\u5217\u8868\u4e2d\u7684\u524d\u4e09\u4e2a\u51c6\u5219\u5199\u4ee3\u7801\uff1a <?php namespace PostsRemover\\Criteria; use XF\\Criteria\\AbstractCriteria; class Post extends AbstractCriteria { // \u5e16\u5b50\u81f3\u5c11\u6709 X \u4e2a\u70b9\u8cdb\u6570 protected function _matchLikeCount(array $data, \\XF\\Entity\\Post $post) { return ($post->likes && $post->likes >= $data['likes']); } // \u5e16\u5b50\u4f5c\u8005\u6709\u4e00\u4e2a X \u7528\u6237\u540d protected function _matchUsername(array $data, \\XF\\Entity\\Post $post) { return $post->username === $data['name']; } // \u5e16\u5b50\u81f3\u5c11\u88ab\u7f16\u8f91\u4e86 X \u6b21 protected function _matchEditedCount(array $data, \\XF\\Entity\\Post $post) { return $post->edit_count && $post->edit_count >= $data['count']; } /* ================ \u5904\u7406\u5176\u4ed6\u51c6\u5219 ================ */ } isMatched(...) \u65b9\u6cd5\u7528\u4e8e\u8c03\u7528\u6211\u4eec\u521a\u624d\u521b\u5efa\u7684 _match \u65b9\u6cd5\uff0c\u53ea\u63a5\u53d7 User \u5b9e\u4f53\uff0c\u6211\u4eec\u8981\u5199\u4e00\u4e2a\u81ea\u5b9a\u4e49\u7684 isMatched() \u3001 isUnknownMatched() \u548c isSpecialMatched() \u65b9\u6cd5\u7684\u53d8\u4f53\u3002 \u7531\u4e8e\u6211\u4eec\u6b63\u5728\u521b\u5efa\u5e16\u5b50\u51c6\u5219\uff0c\u6211\u4eec\u9700\u8981\u521b\u5efa\u81ea\u5df1\u7684 isMatchedPost() \u65b9\u6cd5\uff1a public function isMatchedPost(\\XF\\Entity\\Post $post) { if (!$this->criteria) { return $this->matchOnEmpty; } foreach ($this->criteria AS $criterion) { $rule = $criterion['rule']; $data = $criterion['data']; $specialResult = $this->isSpecialMatchedPost($rule, $data, $post); if ($specialResult === false) { return false; } else if ($specialResult === true) { continue; } $method = '_match' . \\XF\\Util\\Php::camelCase($rule); if (method_exists($this, $method)) { $result = $this->$method($data, $post); if (!$result) { return false; } } else { if (!$this->isUnknownMatched($rule, $data, $post)) { return false; } } } return true; } protected function isSpecialMatchedPost($rule, array $data, \\XF\\Entity\\Post $post) { return null; } protected function isUnknownMatchedPost($rule, array $data, \\XF\\Entity\\Post $post) { return false; } \u6211\u4eec\u53ea\u9700\u7528 isMatched(...) \u65b9\u6cd5\u4ee3\u7801\u5c06 User \u5b9e\u4f53\u7c7b\u578b\u7684 $user \u53d8\u91cf\u66ff\u6362\u4e3a Post \u5b9e\u4f53\u7c7b\u578b\u7684 $post \u53d8\u91cf\u3002 \u7531\u4e8e\u6211\u4eec\u4e0d\u6253\u7b97\u5904\u7406\u7279\u6b8a\u548c\u672a\u77e5\u7684\u51c6\u5219\uff0c\u6211\u4eec\u5728 isSpecialMatchedPost \u4e2d\u8fd4\u56de null\uff0c\u5728 isUnknownMathcedPost \u65b9\u6cd5\u4e2d\u8fd4\u56de false \u3002 \u6a21\u677f \u00b6 \u629b\u5f00\u6dfb\u52a0 admin \u8def\u7531\u3001\u7f16\u5199 Controller \u548c\u5728\u540e\u53f0\u505a\u5176\u4ed6\u64cd\u4f5c\u7684\u8fc7\u7a0b\uff0c\u76f4\u63a5\u8df3\u5230\u6211\u4eec\u9875\u9762\u7684\u6a21\u677f\u4ee3\u7801\uff1a <xf:title>Posts Remover</xf:title> <xf:form action=\"{{ link('posts-remover/remove') }}\" ajax=\"true\" class=\"block\"> <div class=\"block-container\"> <xf:checkboxrow label=\"Post criteria\"> <xf:option label=\"Post has at least X likes\" name=\"post_criteria[like_count][rule]\" value=\"like_count\"> <xf:numberbox name=\"post_criteria[like_count][data][likes]\" size=\"5\" min=\"0\" step=\"1\" /> </xf:option> <xf:option label=\"Post author has an X username\" name=\"post_criteria[username][rule]\" value=\"username\"> <xf:textbox name=\"post_criteria[username][data][name]\" ac=\"true\" /> </xf:option> <xf:option label=\"Post was edited at least X times\" name=\"post_criteria[edited_count][rule]\" value=\"edited_count\"> <xf:numberbox name=\"post_criteria[edited_count][data][count]\" size=\"5\" min=\"0\" step=\"1\" /> </xf:option> </xf:checkboxrow> <!-- \u5176\u4ed6\u51c6\u5219\u7684\u6a21\u677f\u4ee3\u7801 --> <xf:submitrow sticky=\"true\" icon=\"delete\"/> </div> </xf:form> \u5339\u914d\u51c6\u5219 \u00b6 \u5728\u6211\u4eec\u9875\u9762\u7684 Controller \u4e2d\uff0c\u6211\u4eec\u9700\u8981\u521b\u5efa\u4e00\u4e2a\u540d\u4e3a actionRemove \u7684\u65b9\u6cd5\u6765\u5904\u7406 \"\u79fb\u9664\" \u6309\u94ae\u7684\u70b9\u51fb\uff1a public function actionRemove() { } \u9996\u5148\uff0c\u8ba9\u6211\u4eec\u4ece\u9875\u9762\u8868\u5355\u4e2d\u68c0\u7d22 post_criteria \u6570\u7ec4\uff1a public function actionRemove() { $postCriteriaInput = $this->filter('post_criteria', 'array'); } \u5176\u6b21\uff0c\u6211\u4eec\u9700\u8981\u4ece\u68c0\u7d22\u5230\u7684\u9875\u9762\u8868\u5355\u6570\u636e\u4e2d\u521b\u5efa\u4e00\u4e2a\u51c6\u5219\u7269\u4ef6\uff1a public function actionRemove() { $postCriteriaInput = $this->filter('post_criteria', 'array'); /** @var \\PostsRemover\\Criteria\\Post $postCriteria */ $postCriteria = $this->app()->criteria('PostsRemover:Post', $postCriteriaInput); } \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u53d1\u5e03\u5e16\u5b50 \u5c06\u5339\u914d empty \u51c6\u5219\uff08\u5f53\u6ca1\u6709\u9009\u62e9\u4efb\u4f55\u5185\u5bb9\u65f6\uff09\uff0c\u8fd9\u5c06\u5bfc\u81f4\u6240\u6709\u8bba\u575b\u5e16\u5b50\u90fd\u88ab\u5220\u9664\u3002 \u4e3a\u4e86\u907f\u514d\u8fd9\u79cd\u60c5\u51b5\uff0c\u6211\u4eec\u9700\u8981\u901a\u8fc7 setMatchOnEmpty() \u65b9\u6cd5\u624b\u52a8\u8bbe\u7f6e\u5339\u914d empty \u51c6\u5219\u7684\u7ed3\u679c\uff1a public function actionRemove() { $postCriteriaInput = $this->filter('post_criteria', 'array'); /** @var \\PostsRemover\\Criteria\\Post $postCriteria */ $postCriteria = $this->app()->criteria('PostsRemover:Post', $postCriteriaInput); $postCriteria->setMatchOnEmpty(false); // \u5982\u679c\u6ca1\u6709\u9009\u5b9a\u51c6\u5219\uff0c\u5219\u4e0d\u4f1a\u5220\u9664\u4efb\u4f55\u5185\u5bb9 } \u6700\u540e\uff0c\u6211\u4eec\u9700\u8981\u6839\u636e\u9009\u5b9a\u7684\u51c6\u5219\u6765\u5339\u914d\u6240\u6709\u8bba\u575b\u5e16\u5b50\u3002 \u5982\u679c\u5e16\u5b50\u7b26\u5408\u51c6\u5219\uff0c\u6211\u4eec\u5c06\u5220\u9664\u5b83\u3002 public function actionRemove() { $postCriteriaInput = $this->filter('post_criteria', 'array'); /** @var \\PostsRemover\\Criteria\\Post $postCriteria */ $postCriteria = $this->app()->criteria('PostsRemover:Post', $postCriteriaInput); $postCriteria->setMatchOnEmpty(false); // \u5982\u679c\u6ca1\u6709\u9009\u62e9\u51c6\u5219\uff0c\u5219\u4e0d\u4f1a\u5220\u9664\u4efb\u4f55\u5185\u5bb9 // \u53d6\u5f97\u6240\u6709\u8bba\u575b\u5e16\u5b50 $posts = $this->finder('XF:Post')->fetch(); $deletedCounter = 0; /** @var \\XF\\Entity\\Post $post */ foreach ($posts as $post) { if ($postCriteria->isMatchedPost($post)) // \u9488\u5bf9\u6240\u9009\u5b9a\u7684\u51c6\u5219\u68c0\u67e5\u5e16\u5b50 { $post->delete(); // \u5982\u679c\u5e16\u5b50\u7b26\u5408\u9009\u5b9a\u7684\u51c6\u5219\uff0c\u5219\u5c06\u5176\u5220\u9664\u3002 $deletedCounter++; } } return $this->message('Done! ' . $deletedCounter . ' posts were removed!'); } Note \u8bf7\u6ce8\u610f\uff0c\u5bf9\u4e8e XenForo 2.1 \u4ee5\u4e0b\u7684\u7248\u672c\uff0c\u6211\u4eec\u4f7f\u7528 isMatchedPost($post) \u65b9\u6cd5\uff01 Warning \u4e00\u822c\u6765\u8bf4\uff0c\u4e00\u6b21\u4ece\u6570\u636e\u5e93\u4e2d\u68c0\u7d22\u6240\u6709\u7684\u5b9e\u4f53\u662f\u4e00\u79cd\u4e0d\u597d\u7684\u505a\u6cd5\uff08\u4e0a\u9762\u4ee3\u7801\u4e2d\u7684 $this->finder('XF:Post')->fetch(); \uff09\u3002 \u8bba\u575b\u7684\u5e16\u5b50\u53ef\u80fd\u6709\u51e0\u767e\u4e07\u4e2a\uff0c\u5982\u679c\u4e00\u6b21\u5168\u90e8\u9009\u53d6\u4f1a\u662f\u4e00\u4e2a\u975e\u5e38\u6f2b\u957f\u7684\u8fc7\u7a0b\uff0c\u6700\u540e\u53ef\u80fd\u8fd8\u4f1a\u51fa\u73b0\u9519\u8bef\u3002 \u8003\u8651\u4f7f\u7528 Job \u7cfb\u7edf\u6765\u5904\u7406\u6570\u5341\u4e2a\uff08100+\uff09\u6570\u636e\u5e93\u9879\u76ee\u3002 \u6d4b\u8bd5 \u00b6 \u662f\u65f6\u5019\u6d4b\u8bd5\u6211\u4eec\u7684\u81ea\u5b9a\u4e49\u51c6\u5219\u7c7b\u578b\u4e86\uff01 \u6211\u5728\u6211\u7684\u6d4b\u8bd5\u8bba\u575b\u4e0a\u521b\u5efa\u4e86\u4e09\u4e2a\u5e16\u5b50\u3002 \u7b2c\u4e00\u4e2a\u5e16\u5b50\u88ab\u70b9\u8cdb 500 \u6b21\uff0c\u7b2c\u4e8c\u4e2a\u5e16\u5b50\u88ab\u7f16\u8f91 5 \u6b21\u3002 \u7b2c\u4e09\u4e2a\u53ea\u662f\u4e00\u4e2a\u539f\u5c01\u4e0d\u52a8\u7684\u6ca1\u6709\u88ab\u70b9\u8d5e\u7684\u5e16\u5b50\u3002 \u73b0\u5728\uff0c\u5728\u6211\u4eec\u7684 \"\u5e16\u5b50\u5220\u9664\u5668\" Admin CP \u9875\u9762\u4e0a\uff0c\u8ba9\u6211\u4eec\u9009\u62e9 \"\u5e16\u5b50\u81f3\u5c11\u6709 X \u4e2a\u70b9\u8cdb\u6570\"\uff08\u503c\u4e3a 250\uff09\u548c \"\u5e16\u5b50\u81f3\u5c11\u88ab\u7f16\u8f91\u8fc7 X \u6b21\"\uff08\u503c\u4e3a 5\uff09\u3002 \u5f53\u6211\u6309\u4e0b \"\u5220\u9664\" \u952e\u65f6\uff0c\u6211\u770b\u5230\u4e00\u6761\u5373\u65f6\u6d88\u606f\uff0c\u544a\u8bc9\u6211\u4ec0\u9ebd\u90fd\u6ca1\u6709\u5220\u9664\u3002 \u4e3a\u4ec0\u9ebd\u5462\uff1f \u5f88\u663e\u7136\uff0c\u56e0\u4e3a\u5728 \u540c\u4e00\u65f6\u95f4\u5185 \u6ca1\u6709\u81f3\u5c11 250 \u4e2a\u70b9\u8cdb\u6570\u548c\u81f3\u5c11\u7f16\u8f91\u8fc7 5 \u6b21\u7684\u5e16\u5b50\u3002 \u6240\u4ee5\u6211\u4eec\u53ea\u9700\u8981\u9009\u62e9\u7b2c\u4e00\u4e2a\u51c6\u5219\uff0c\u7136\u540e\u70b9\u51fb \"\u5220\u9664\"\u3002 \u8fd9\u6837\u5c31\u4f1a\u5220\u9664\u4e00\u4e2a\u6709 500 \u4e2a\u70b9\u8cdb\u6570\u7684\u5e16\u5b50\u3002 \u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u53ea\u9700\u8981\u9009\u62e9\u6700\u540e\u4e00\u4e2a\u51c6\u5219\uff0c\u7136\u540e\u9884\u5148\u8fdb\u884c\u5220\u9664\u3002 \u6709\u7f16\u8f91\u8fc7 5 \u6b21\u7684\u5e16\u5b50\u5c06\u88ab\u5220\u9664\u3002 \u7ed3\u679c\uff0c\u53ea\u6709\u4e00\u4e2a\u6d4b\u8bd5\u5e16\u5b50\u5728\u6d4b\u8bd5\u4e2d\u5e78\u5b58\u4e0b\u6765\uff1a \u4f60\u53ef\u4ee5 \u4e0b\u8f7d \u57fa\u4e8e\u8fd9\u4e2a\u8303\u4f8b (2.0.10) \u6240\u6784\u5efa\u7684\u63d2\u4ef6\u539f\u4ee3\u7801\u3002 \u5728 Admin CP \u91cc\u4f60\u53ef\u4ee5\u5728 \"\u5de5\u5177\" \u7684\u90e8\u5206\u627e\u5230 \"\u5e16\u5b50\u5220\u9664\u5668\"\u3002","title":"\u51c6\u5219"},{"location":"criteria/#_1","text":"\u5f53 XenForo \u9700\u8981\u6839\u636e\u4e00\u4e9b \u7528\u6237\u9009\u62e9\u7684 \u6761\u4ef6\uff08\u51c6\u5219\uff09\u6765\u6d4b\u8bd5\u67d0\u4e9b\u4e1c\u897f\uff08\u7528\u6237/\u9875\u9762/\u5e16\u5b50......\uff09\u65f6\uff0c\u5b83\u4f7f\u7528\u51c6\u5219\u7cfb\u7edf\u3002 \u4f7f\u7528\u5230\u51c6\u5219\u7cfb\u7edf\u7684\u4e00\u4e9b\u5730\u65b9\uff1a \u6210\u5c31 \u7528\u6237\u7ec4\u63d0\u5347 \u8bba\u575b\u516c\u544a \u9644\u52a0\u7ec4\u4ef6\u4e5f\u53ef\u4ee5\u4f7f\u7528\u8fd9\u4e2a\u7cfb\u7edf\u3002","title":"\u51c6\u5219"},{"location":"criteria/#_2","text":"\u8003\u8651\u4ee5\u4e0b\u51c6\u5219\uff1a - \u7528\u6237 \u6709/\u6ca1\u6709 \u5934\u50cf - \u7528\u6237\u6709 300 \u591a\u6761\u7559\u8a00 - \u7528\u6237\u6b63\u5728\u521b\u5efa\u4e00\u4e2a\u4e3b\u9898 - \u5f53\u524d\u7528\u6237\u9009\u62e9\u7684\u5bfc\u89c8\u6807\u7b7e\u4e3a \"\u4f1a\u5458\" \u524d\u4e24\u4e2a\u51c6\u5219\u662f\u6307\u7528\u6237\u672c\u4eba\u3002 \u5176\u4f59\u7684\u51c6\u5219\u662f\u6307\u4ed6\u5f53\u524d\u5728\u8bba\u575b\u4e0a\u7684\u4f4d\u7f6e\u3002 \u8fd9\u6837\u770b\u8d77\u6765\u6211\u4eec\u5e94\u8be5\u6709\u4e0d\u540c\u7c7b\u522b\u6216 \u7c7b\u578b \u7684\u51c6\u5219\u3002 \u5728 XenForo \u4e2d\uff0c\u6709\u4e24\u79cd\u5f00\u7bb1\u5373\u7528\u7684\u51c6\u5219\u7c7b\u578b\uff1a \u7528\u6237\u51c6\u5219 \u2014 \u5904\u7406\u5173\u4e8e\u7528\u6237\u672c\u8eab\u7684\u51c6\u5219 \u9875\u9762\u51c6\u5219 \u2014 \u5904\u7406\u7528\u6237\u5f53\u524d\u4f4d\u7f6e\u7684\u51c6\u5219 + \u65f6\u95f4\u51c6\u5219 \u4e00\u4e9b\u9644\u52a0\u7ec4\u4ef6\u4e5f\u53ef\u4ee5\u6dfb\u52a0\u81ea\u5df1\u7684\u51c6\u5219\u7c7b\u578b\u3002 \u4ece\u4ee3\u7801\u7684\u89d2\u5ea6\u6765\u770b\uff0c\u51c6\u5219\u7c7b\u578b\u53ea\u662f\u4e00\u4e2a\u62bd\u8c61\u7c7b AbstractCriteria \u7684\u5b50\u7c7b\u3002 \u5b83\u4eec\u5305\u542b\u7528\u4e8e\u5904\u7406\u67d0\u4e9b\u7c7b\u578b\u7684\u9009\u5b9a\u51c6\u5219\u4ee3\u7801\u3002 \u53cd\u4e4b\uff0c AbstractCriteria \u5219\u63d0\u4f9b\u4e86\u5904\u7406\u51c6\u5219\u7684\u901a\u7528\u65b9\u6cd5\uff0c\u800c\u4e0d\u8bba\u5176\u542b\u4e49\u5982\u4f55\u3002","title":"\u51c6\u5219\u7c7b\u578b"},{"location":"criteria/#_3","text":"\u51c6\u5219\u662f\u4e00\u4e2a\u7528\u6237\u53ef\u9009\u62e9\u7684\u9884\u5b9a\u4e49\u6761\u4ef6\u3002 \u4e3a\u4ec0\u9ebd\u662f\u53ef\u9009\u7684\uff1f \u56e0\u4e3a\u7ba1\u7406\u5458/\u7528\u6237\u53ef\u4ee5\u9009\u62e9\u5b83\u4eec\uff08\u8bb0\u5f97\u6210\u5c31\u521b\u5efa\u8fc7\u7a0b\uff09\u3002 \u4e3a\u4ec0\u9ebd\u662f\u9884\u5b9a\u4e49\uff1f \u56e0\u4e3a XenForo \u5df2\u7ecf\u77e5\u9053\u5982\u4f55\u5904\u7406\u5b83\u4eec\uff08\u4f7f\u7528\u51c6\u5219\u7c7b\u65b9\u6cd5\uff09\u3002 \u6bcf\u4e2a\u51c6\u5219\u7531\u4e24\u90e8\u5206\u7ec4\u6210\uff1a \u89c4\u5219 \u548c\uff08\u53ef\u9009\uff09 \u6570\u636e \u3002","title":"\u51c6\u5219"},{"location":"criteria/#_4","text":"\u51c6\u5219\u89c4\u5219\u7b80\u76f4\u5c31\u662f \u86c7\u5f62\u547d\u540d \u7684\u75db\u5904 (words_are_separated_with_underscore_character)\u3002 \u5b83\u6709\u4e24\u4e2a\u57fa\u672c\u5b97\u65e8\uff1a \u5b83\u7528\u4e8e\u533a\u5206\u51c6\u5219 \u5728\u8fdb\u884c\u5339\u914d\u65f6\uff0c\u8be5\u89c4\u5219\u88ab\u8ee2\u6362\u4e3a\u5904\u7406\u8be5\u51c6\u5219\u65b9\u6cd5\u7684 \u9a7c\u5cf0\u5f0f \u547d\u540d (\u8bf7\u53c2\u9605 \"\u51c6\u5219\u5982\u4f55\u8fd0\u4f5c\" )\u3002","title":"\u89c4\u5219"},{"location":"criteria/#_5","text":"\u5b83\u53ea\u662f\u4e00\u4e2a\u53ef\u9009\u7684\u9644\u52a0\u51c6\u5219\u6570\u636e\u6570\u7ec4\u3002 \u4f8b\u5982\uff0c\"\u7528\u6237\u81f3\u5c11\u53d1\u5e03\u4e86 X \u6761\u7559\u8a00\" \u51c6\u5219\u6709\u4e00\u4e2a\u5305\u542b\u4e00\u4e2a\u8981\u7d20\u7684\u6570\u636e\u6570\u7ec4\uff1a\u6570\u5219\u6d88\u606f\u3002","title":"\u6570\u636e"},{"location":"criteria/#_6","text":"\u5728\u672c\u8282\u4e2d\uff0c\u6211\u4eec\u5c06\u4ecb\u7ecd\u51c6\u5219\u7cfb\u7edf\u662f\u5982\u4f55\u4ece A \u5230 Z \u8fd0\u4f5c\u7684\u3002","title":"\u51c6\u5219\u7cfb\u7edf\u5982\u4f55\u8fd0\u4f5c"},{"location":"criteria/#_7","text":"\u8fd9\u4e00\u5207\u90fd\u8981\u4ece\u6a21\u677f\u4ee3\u7801\u8bf4\u8d77\u3002 \u4ee5\u4e0b\u662f\u51c6\u5219\u5728\u6a21\u677f\u4e2d\u770b\u8d77\u6765\u7684\u6837\u5b50\uff1a <xf:checkbox label=\"Criteria container\"> <!-- \u51c6\u5219 --> <xf:option name=\"foo_criteria[criterion_1_rule][rule]\" value=\"criterion_1_rule\" ... /> <!-- \u542b\u6570\u636e\u7684\u51c6\u5219 --> <xf:option name=\"bar_criteria[criterion_2_rule][rule]\" value=\"criterion_2_rule\" ... > <xf:... name=\"bar_criteria[criterion_2_rule][data][param_1]\" ... /> <xf:... name=\"bar_criteria[criterion_2_rule][data][param_2]\" ... /> </xf:option> </xf:checkbox> \u5982\u4f60\u6240\u89c1\uff0c\u51c6\u5219\u53ea\u662f\u4e00\u4e2a\u590d\u9009\u6846\uff0c\u91cc\u9762\u6709\u53ef\u9009\u7684\u8f93\u5165\u5b57\u6bb5\uff08\u51c6\u5219\u6570\u636e\uff09\u3002 \u6211\u4eec\u6765\u5206\u6790\u4e00\u4e0b\u4ee3\u7801\uff1a foo_criteria \u548c bar_criteria \u662f input \u5bb9\u5668\uff0c\u901a\u5e38 foo \u548c bar \u90e8\u5206\u662f\u6307\u51c6\u5219\u7c7b\u578b\u3002 \u4f8b\u5982\uff0c user_criteria[...] \u8ba9\u6211\u4eec\u77e5\u9053\u8fd9\u4e2a\u51c6\u5219\u5c5e\u65bc\u7528\u6237\u51c6\u5219\u3002 value=\"criterion_1_rule\" \u548c value=\"criterion_2_rule\" \u663e\u7136\u662f\u51c6\u5219\u7684\u89c4\u5219\u3002 Note \u8bf7\u8bb0\u4f4f\uff0c name \u5c5e\u6027\u4e2d\u7684 criterion_1/2_rule \u4e0d\u4e00\u5b9a\u662f\u51c6\u5219\u89c4\u5219\uff01 \u8fd9\u4e9b\u53ea\u662f input \u5bb9\u5668\u7684\u540d\u79f0\u3002 \u4f60\u53ef\u4ee5\u8f7b\u800c\u6613\u4e3e\u5730\u5199\u4e0b <xf:option name=\"foo[bar][rule]\" value=\"criterion_rule\" /> \uff0c\u5b83\u5c31\u4f1a\u6b63\u786e\u5730\u8fd0\u4f5c\u3002 \u51c6\u5219\u89c4\u5219\u4f1a\u662f criterion_rule \uff0c\u800c\u4e0d\u662f bar \u3002","title":"\u6a21\u677f"},{"location":"criteria/#_8","text":"\u5728 Controller \u5185\u90e8\uff0c\u53ef\u4ee5\u5c06\u4e0a\u4e00\u8282\u7684\u51c6\u5219\u8868\u5355\u6570\u636e\u8fdb\u884c\u7b5b\u9009\u3001\u7f16\u7801\uff0c\u5e76\u4fdd\u5b58\u5728 mediumblob \u7c7b\u578b\u7684\u6570\u636e\u5e93 Column \u4e2d\uff0c\u4ee5\u4fbf\u66f4\u597d\u5730\u4f7f\u7528\uff1a $fooCriteriaInput = $this->filter('foo_criteria', 'array'); $barCriteriaInput = $this->filter('bar_criteria', 'array'); $form->basicEntitySave($bazEntity, [ 'foo_criteria' => $fooCriteriaInput, 'bar_criteria' => $barCriteriaInput ]); $bazEntity Structure \u793a\u4f8b\uff1a public static function getStructure(Structure $structure) { $structure->table = 'xf_baz'; $structure->shortName = 'XF:Baz'; $structure->primaryKey = 'baz_id'; $structure->columns = [ 'baz_id' => ['type' => self::UINT, 'autoIncrement' => true], 'foo_criteria' => ['type' => self::JSON_ARRAY, 'default' => [], 'required' => 'please_select_criteria_that_must_be_met'], 'bar_criteria' => ['type' => self::JSON_ARRAY, 'default' => []] ]; return $structure; }","title":"(\u53ef\u9009) \u4fdd\u5b58\u9009\u5b9a\u7684\u51c6\u5219"},{"location":"criteria/#_9","text":"\u4e3a\u4e86\u4f7f\u7528\u51c6\u5219\u7cfb\u7edf\uff0c\u6211\u4eec\u9700\u8981\u4ece\u9009\u5b9a\u7684\u51c6\u5219\u8868\u5355\u6570\u636e\u4e2d\u521b\u5efa\u4e00\u4e2a\u51c6\u5219\u7269\u4ef6\uff0c\u8fd9\u53ef\u4ee5\u901a\u8fc7 app \u7684 criteria() \u65b9\u6cd5\u6765\u5b8c\u6210\uff1a /** @var \\Qux\\Criteria\\Foo $fooCriteria */ $fooCriteria = \\XF::app()->criteria('Qux:Foo', $bazEntity->foo_criteria); /** @var \\Qux\\Criteria\\Bar $barCriteria */ $barCriteria = \\XF::app()->criteria('Qux:Bar', $bazEntity->bar_criteria); \u4ece\u73b0\u5728\u5f00\u59cb\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u6240\u6709\u7684 AbstractCriteria \u529f\u80fd\uff0c\u52a0\u4e0a\u6211\u4eec\u5728\u5b50\u7c7b Foo / Bar \u4e2d\u989d\u5916\u7f16\u5199\u7684\u6240\u6709\u5185\u5bb9\u3002","title":"\u51c6\u5219\u7269\u4ef6"},{"location":"criteria/#_10","text":"\u5f53\u6211\u4eec\u60f3\u68c0\u67e5\u67d0\u4e2a\u4e1c\u897f\uff08User\uff09\u662f\u5426\u7b26\u5408\u9009\u5b9a\u7684\u51c6\u5219\u65f6\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 isMatched \u65b9\u6cd5\uff1a $visitor= \\XF::visitor(); if ($fooCriteria->isMatched($visitor)) { // \u8bbf\u5ba2\u7b26\u5408\u6240\u6709\u9009\u5b9a\u7684\u51c6\u5219 } else { // \u8bbf\u5ba2\u4e0d\u7b26\u5408\u4e00\u4e2a\u6216\u591a\u4e2a\u51c6\u5219 } isMacthed() \u5c06\u51c6\u5219\u89c4\u5219\u8ee2\u6362\u4e3a\u5e2f\u6709 _match \u524d\u7f00\u7684\u9a7c\u5cf0\u5f0f\u547d\u540d\u65b9\u6cd5\uff1a criterion_1_rule > _matchCriterion1Rule \uff0c\u5e76\u5c1d\u8bd5\u5728\u51c6\u5219\uff1a\u578b class \u4e2d\u627e\u5230\u8fd9\u6837\u4e00\u4e2a\u65b9\u6cd5\uff08\u5728\u6211\u4eec\u7684\u4f8b\u5b50\u4e2d\u662f Foo \u7c7b\uff09\uff1a // Qux/Criteria/Foo.php protected function _matchCriterion1Rule(array $data, \\XF\\Entity\\User $user) { /* ... \u5904\u7406\u51c6\u5219 ... */ return true; // \u7528\u6237\u7b26\u5408\u5f53\u524d\u51c6\u5219 /* \u6216\u8005 */ return false; // \u7528\u6237\u4e0d\u7b26\u5408\u5f53\u524d\u51c6\u5219 } \u5982\u679c\u5728 class \u4e2d\u627e\u4e0d\u5230\u67d0\u4e2a\u65b9\u6cd5\uff0c isMatched() \u4f1a\u8c03\u7528 isUnknownMatched() \uff0c\u5176\u884c\u4e3a\u53ef\u4ee5\u5728 AbstractCriteria \u7956\u5148\u4e2d\u8bbe\u7f6e\uff08\u9ed8\u8ba4\u8fd4\u56de false \uff09\u3002 \u5982\u679c\u6ca1\u6709\u9009\u5b9a\u4efb\u4f55\u51c6\u5219\uff0c isMatched() \u5c06\u8fd4\u56de $matchOnEmpty \u53d8\u91cf\uff0c\u9ed8\u8ba4\u4e3a true \u3002 \u4f60\u53ef\u4ee5\u5728\u4f7f\u7528 isMatched() \u65b9\u6cd5 \u4e4b\u524d \u8c03\u7528 $crteriaObj->setMatchOnEmpty(false) \u6765\u6539\u53d8\u8fd9\u79cd\u884c\u4e3a\uff1a $visitor= \\XF::visitor(); $fooCriteria->setMatchOnEmpty(false); if ($fooCriteria->isMatched($visitor)) { // \u8bbf\u5ba2\u7b26\u5408\u6240\u6709\u9009\u5b9a\u7684\u51c6\u5219 } else { // \u8bbf\u5ba2\u4e0d\u7b26\u5408\u4e00\u4e2a\u6216\u591a\u4e2a\u51c6\u5219 }","title":"\u5339\u914d"},{"location":"criteria/#_11","text":"\u60f3\u8c61\u4e00\u4e0b\uff0c\u4f60\u60f3\u7ed9\u6240\u6709\u62e5\u6709\u5934\u50cf\u5e76\u83b7\u5f97\u81f3\u5c11 5 \u4e2a\u8d5e\u7684\u7528\u6237\u9881\u53d1\u4e00\u4e2a\u6210\u5c31\u3002 \u5728\u521b\u5efa\u6210\u5c31\u65f6\uff0c\u4f60\u9009\u62e9 \"\u7528\u6237\u6709\u5934\u50cf\"\uff08\u89c4\u5219 has_avatar \uff09\u548c \"\u7528\u6237\u81f3\u5c11\u53ce\u5230 X \u4e2a\u8cdb\"\uff08\u89c4\u5219 like_count \uff09\u51c6\u5219\u3002 \u6700\u540e\u4e00\u4e2a\u8fd8\u5177\u6709\u4e00\u4e2a\u5305\u542b\u4e00\u4e2a\u5143\u7d20\u7684\u6570\u636e\u6570\u7ec4\uff1a\u559c\u6b22\u7684\u6570\u91cf\u3002 \u60a8\u6240\u9009\u62e9\u7684\u51c6\u5219\u4fdd\u5b58\u5728 xf_trophy \u8d44\u6599\u8868\u4e2d\u7684 user_criteria column\u3002 \u5f53 XenForo \u51b3\u5b9a\u68c0\u67e5\uff0c\u662f\u5426\u7ed9\u7528\u6237\u9881\u53d1\u6210\u5c31\u65f6\uff0c\u5b83\u4f1a\u5c06\u89c4\u5219\u8ee2\u6362\u4e3a\u9a7c\u5cf0\u5f0f\u547d\u540d\u65b9\u6cd5\uff1a like_count > _matchLikeCount() has_avatar > _matchHasAvatar() \u7531\u4e8e\u6240\u9009\u7684\u4e24\u4e2a\u51c6\u5219\u90fd\u662f\u7528\u6237\u51c6\u5219\uff0c\u56e0\u6b64 XenForo \u6ee1\u8db3\u7528\u6237\u51c6\u5219 class\uff0c\u5e76\u8bd5\u56fe\u5728\u5176\u4e2d\u627e\u5230\u8fd9\u4e9b\u65b9\u6cd5\uff1a // XF/Criteria/User.php //... protected function _matchLikeCount(array $data, \\XF\\Entity\\User $user) { return ($user->like_count && $user->like_count >= $data['likes']); } //... protected function _matchHasAvatar(array $data, \\XF\\Entity\\User $user) { return $user->user_id && ($user->avatar_date || $user->gravatar); } //... \u5982\u679c \u6240\u6709 \u4f4d\u7f6e\u7684\u65b9\u6cd5\u90fd\u8fd4\u56de true \uff0c\u6211\u4eec\u7684\u7528\u6237\u5c31\u7b26\u5408\u9009\u5b9a\u7684\u51c6\u5219\uff0c\u56e0\u6b64\u5c06\u83b7\u5f97\u4e00\u4e2a\u6210\u5c31\u3002 \u5982\u679c\u5728 User \u51c6\u5219\u7c7b\u4e2d\u627e\u4e0d\u5230\u67d0\u4e9b\u65b9\u6cd5\uff0cXenForo \u4f1a\u8c03\u7528 isUnknownMatched() \u65b9\u6cd5\uff0c\u8fdb\u800c\u89e6\u53d1 criteria_user \u4e8b\u4ef6\uff0c\u5141\u8bb8\u9644\u52a0\u7ec4\u4ef6\u5236\u4f5c\u8005\u6dfb\u52a0\u4ed6\u4eec\u7684\u81ea\u5b9a\u4e49\u51c6\u5219\u5904\u7406\u7a0b\u5e8f\u3002 \uff08\u53c2\u89c1 \"\u81ea\u5b9a\u4e49\u7528\u6237/\u9875\u9762\u51c6\u5219\u8303\u4f8b\" \uff09\u3002","title":"\u51c6\u5219\u662f\u5982\u4f55\u8fd0\u4f5c\u7684 (\u4f8b\u5b50)"},{"location":"criteria/#_12","text":"\u6709\u65f6\uff0c\u5728\u7f16\u5199\u51c6\u5219\u6a21\u677f\u4ee3\u7801\u65f6\uff0c\u4f60\u9700\u8981\u8bbf\u95ee\u989d\u5916\u7684\u6570\u636e\uff0c\u800c\u8fd9\u4e9b\u6570\u636e\u4e0d\u662f\u901a\u8fc7 view \u53c2\u6570\u4f20\u9012\u7684\u3002 \u8fd9\u5c31\u662f getExtraTemplateData() \u65b9\u6cd5\u5b58\u5728\u7684\u610f\u4e49\u3002 \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5b83\u5305\u542b\u73b0\u6709\u7684\u7528\u6237\u7ec4\u3001\u8bed\u8a00\u3001\u98ce\u683c\u6837\u5f0f\u3001\u65f6\u533a\u3002 \u4f60\u53ef\u4ee5\u5728\u4f60\u7684\u81ea\u5b9a\u4e49\u51c6\u5219\u7c7b\u578b class \u4e2d\u590d\u76d6\u8fd9\u4e2a\u65b9\u6cd5\u3002","title":"\u989d\u5916\u51c6\u5219\u6570\u636e"},{"location":"criteria/#_13","text":"\u5728\u60a8\u7684\u81ea\u5b9a\u4e49\u51c6\u5219 class \u4e2d\u590d\u76d6 getExtraTemplateData() \u65b9\u6cd5\uff1a public function getExtraTemplateData() { $templateData = parent::getExtraTemplateData(); $additionalData = []; /** @var \\XF\\Repository\\Smilie $smilieRepo */ $smilieRepo = \\XF::repository('XF:Smilie'); $additionalData['smilies'] = $smilieRepo->findSmiliesForList()->fetch(); return array_merge($templateData, $additionalData); }","title":"\u5728\u81ea\u5b9a\u4e49\u51c6\u5219\u7c7b\u578b\u4e2d\u6dfb\u52a0\u6570\u636e"},{"location":"criteria/#_14","text":"\u4f60\u53ef\u4ee5\u4f7f\u7528 criteria_template_data \u4e8b\u4ef6\u76d1\u542c\u5668\u6765\u6dfb\u52a0\u4f60\u81ea\u5df1\u7684\u989d\u5916\u51c6\u5219\u6570\u636e\uff1a public static function criteriaTemplateData(array &$templateData) { /** @var \\XF\\Repository\\Smilie $smilieRepo */ $smilieRepo = \\XF::repository('XF:Smilie'); $templateData['smilies'] = $smilieRepo->findSmiliesForList()->fetch(); }","title":"\u5728\u73b0\u6709\u51c6\u5219\u7c7b\u578b\u4e2d\u6dfb\u52a0\u6570\u636e"},{"location":"criteria/#helper_criteria","text":"\u6bcf\u5f53\u4f60\u4f5c\u4e3a\u9644\u52a0\u7ec4\u4ef6\u5236\u4f5c\u8005\u60f3\u8ba9\u76ee\u6807 \u7528\u6237/\u7ba1\u7406\u5458 \u6709\u529e\u6cd5\u9009\u62e9 \u7528\u6237/\u9875\u9762/\u5176\u4ed6\u9644\u52a0\u7ec4\u4ef6 \u7684\u51c6\u5219\u65f6\uff08\u751a\u81f3\u5168\u90e8\u4e00\u8d77\uff09\uff0c\u4f60\u53ef\u4ee5\u7b80\u5358\u5730\u4f7f\u7528 helper_criteria \u3002 \u7b80\u800c\u8a00\u4e4b\uff0c helper_criteria \u662f\u4e00\u4e2a\u5141\u8bb8\u5728\u591a\u5904\u4f7f\u7528\u57fa\u4e8e\u51c6\u5219\u7c7b\u578b\u7684\u6838\u53d6\u65b9\u5757\u4ecb\u9762\u7684\u7ba1\u7406\u6a21\u677f\uff0c\u65e0\u9700\u590d\u5236\u7c98\u8d34\u76f8\u540c\u4ee3\u7801\u3002 helper_criteria \u5305\u542b \u4e24\u4e2a \u7c7b\u578b\u7684\u5de8\u96c6\uff1a *criteria_name*_tabs \u548c *criteria_name*_panes \uff0c\u9002\u7528\u4e8e\u6bcf\u4e2a\u51c6\u5219\u7c7b\u578b\u3002 \u4f8b\u5982\uff1a\u7528\u6237\u51c6\u5219\u7c7b\u578b\u7684 user_tabs \u548c user_panes \u5de8\u96c6\u3002","title":"\"helper_criteria\" \u6a21\u677f"},{"location":"criteria/#_15","text":"\u6807\u7b7e\u7528\u4e8e\u533a\u5206\u4ed6\u4eec\u6240\u4f7f\u7528\u6a21\u677f\u5185\u7684\u4e0d\u540c\u51c6\u5219\u7c7b\u578b\uff1a \u4f7f\u7528\u6807\u7b7e\u65f6\uff0c\u7b2c\u4e00\u4e2a\u6807\u7b7e\u5f80\u5f80\u5305\u542b\u4e0e\u51c6\u5219\u65e0\u5173\u7684\u5b57\u6bb5/\u9009\u9879\u3002 \u7136\u540e\u5230\u51c6\u5219\u6807\u7b7e\u3002 \u5728\u4e0a\u56fe\u4e2d\uff0c\u7b2c\u4e00\u4e2a\u6807\u7b7e\u5305\u542b\u901a\u77e5\u7684\u9009\u9879\u3002 \u7ea2\u6846\u4e2d\u7684\u524d\u4e24\u4e2a\u6807\u7b7e\u4e0e\u7528\u6237\u51c6\u5219\u7c7b\u578b\u6709\u5173\u3002 \u6700\u540e\u4e00\u4e2a\u4e0e\u9875\u9762\u51c6\u5219\u7c7b\u578b\u6709\u5173\u3002 helper_criteria \u4e2d\u7684\u6807\u7b7e\u88ab\u5f52\u7c7b\u5728\u51c6\u5219\u7c7b\u578b\u5de8\u96c6\u4e0b\uff1a <xf:macro name=\"foo_tabs\" arg-container=\"\" arg-active=\"\"> <xf:set var=\"$tabs\"> <a class=\"tabs-tab{{ $active == 'foo' ? ' is-active' : '' }}\" role=\"tab\" tabindex=\"0\" aria-controls=\"{{ unique_id('criteriaFoo') }}\">Foo criteria</a> <a class=\"tabs-tab{{ $active == 'foo_extra' ? ' is-active' : '' }}\" role=\"tab\" tabindex=\"0\" aria-controls=\"{{ unique_id('criteriaFooExtra') }}\">Foo criteria extra</a> </xf:set> <xf:if is=\"$container\"> <div class=\"tabs\" role=\"tablist\"> {$tabs|raw} </div> <xf:else /> {$tabs|raw} </xf:if> </xf:macro> In the code above, foo is a criteria type. It has two tabs, one for general foo criteria and another for extra foo criteria. \u5728\u4e0a\u9762\u7684\u4ee3\u7801\u4e2d\uff0c foo \u662f\u4e00\u4e2a\u51c6\u5219\u7c7b\u578b\u3002 \u5b83\u6709\u4e24\u4e2a\u6807\u7b7e\uff0c\u4e00\u4e2a\u7528\u4e8e\u4e00\u822c\u7684 foo \u51c6\u5219\uff0c\u53e6\u4e00\u4e2a\u7528\u4e8e\u989d\u5916\u7684 foo \u51c6\u5219\u3002","title":"\u6807\u7b7e"},{"location":"criteria/#panes","text":"Panes \u4ec5\u4ec5\u5305\u542b\u51c6\u5219\u3002 \u548c\u6807\u7b7e\u4e00\u6837\uff0c helper_criteria \u4e2d\u7684 Panes \u4e5f\u662f\u6309\u7167\u51c6\u5219\u7c7b\u578b\u5de8\u96c6\u6765\u5f52\u7c7b\u7684\uff1a <xf:macro name=\"foo_panes\" arg-container=\"\" arg-active=\"\" arg-criteria=\"!\" arg-data=\"!\"> <xf:set var=\"$panes\"> <li class=\"{{ $active == 'foo' ? ' is-active' : '' }}\" role=\"tabpanel\" id=\"{{ unique_id('criteriaFoo') }}\"> <xf:checkboxrow label=\"Criteria group 1\"> <xf:option name=\"foo_criteria[criterion_1_rule][rule]\" value=\"criterion_1_rule\" ... /> <xf:option name=\"foo_criteria[criterion_2_rule][rule]\" value=\"criterion_2_rule\" ... /> </xf:checkboxrow> <xf:checkboxrow label=\"Criteria group 2\"> <xf:option name=\"foo_criteria[criterion_3_rule][rule]\" value=\"criterion_3_rule\" ... /> <xf:option name=\"foo_criteria[criterion_4_rule][rule]\" value=\"criterion_4_rule\" ... /> </xf:checkboxrow> </li> </xf:set> <xf:if is=\"$container\"> <ul class=\"tabPanes\"> {$panes|raw} </ul> <xf:else /> {$panes|raw} </xf:if> </xf:macro>","title":"Panes (\u7a97\u683c)"},{"location":"criteria/#helper_criteria_1","text":"\u8981\u4f7f\u7528 \"helper_criteria\" \u7684\u529f\u80fd\uff0c\u4f60\u9700\u8981\u52a0\u5165\u5b83\u7684\u5de8\u96c6\u3002","title":"\u4f7f\u7528 \"helper_criteria\""},{"location":"criteria/#_16","text":"\u5982\u679c\u60a8 \u6ca1\u6709 \u60a8\u6240\u9009\u5b9a\u7684\u51c6\u5219\u4fdd\u5b58\u5728\u6570\u636e\u5e93\u4e2d\u7684\u67d0\u4e2a\u5730\u65b9\uff0c\u6216\u8005\u60a8\u8981\u4f7f\u7528\u7684\u51c6\u5219\u7c7b\u578b \u4e0d\u9700\u8981 \u4efb\u4f55\u989d\u5916\u7684\u6570\u636e\uff0c\u53ef\u4ee5\u8df3\u8fc7\u672c\u8282\u3002 \u9996\u5148\uff0c\u60a8\u9700\u8981\u68c0\u7d22\u5df2\u4fdd\u5b58\u7684\u9009\u5b9a\u51c6\u5219\uff0c\u5e76\u4ece\u4e2d\u521b\u5efa\u4e00\u4e2a\u51c6\u5219\u7269\u4ef6\u3002 \u5728\u672c\u8282\u4e2d\uff0c\u6211\u4eec\u5c06\u4ee5 Page \u51c6\u5219\u4e3a\u4f8b\u5b50\uff1a $savedCriteria = /* Retrieve it somehow... */ // \u51c6\u5219\u7269\u4ef6 $criteria = $this->app()->criteria('XF:Page', $savedCriteria)->getCriteriaForTemplate(); // \u51c6\u5219\u989d\u5916\u6570\u636e $criteriaData = $criteria->getExtraTemplateData(); $viewParams = [ /* ... */ 'criteria' => $criteria, 'criteriaData' => $criteriaData ]; return $this->view(/* ... */, $viewParams);","title":"\u51c6\u5907\u6570\u636e"},{"location":"criteria/#_17","text":"\u8981\u5305\u542b\u6ca1\u6709\u5185\u5bb9\u7684\u6807\u7b7e\u51c6\u5219\uff0c\u4f60\u9700\u8981\u4f7f\u7528 <xf:macro... \u6807\u7b7e\uff0c\u5e76\u5c06 arg-container \u5c5e\u6027\u8bbe\u7f6e\u4e3a 0 \u3002 <xf:macro template=\"helper_criteria\" name=\"page_panes\" arg-container=\"0\" arg-criteria=\"{$criteria}\" arg-data=\"{$criteriaData}\" /> \u5982\u679c\u4f60\u6ca1\u6709\u4fdd\u5b58\u51c6\u5219\uff0c\u4f60\u53ef\u4ee5\u76f4\u63a5\u5c06\u7a7a\u6570\u7ec4 {{ [] }} \u4f20\u9012\u7ed9 arg-criteria \u5c5e\u6027\u3002 \u4e0d\u8981\u5fd8\u8bb0\u628a page_panes \u4e2d\u7684 page \u66ff\u6362\u6210\u4f60\u60f3\u4f7f\u7528\u7684\u51c6\u5219\u7c7b\u578b\u540d\u79f0\u3002 \u8bf7\u8bb0\u4f4f\uff0c\u6240\u6709\u7684\u51c6\u5219\u90fd\u662f\u7528 <li> \u6807\u7b7e\u5305\u4f4f\u7684\uff0c\u6240\u4ee5\u4f60\u9700\u8981\u5e94\u7528\u4e00\u4e9b CSS \u6837\u5f0f\uff08\u4f8b\u5982 list-style-type: none; \uff09\u3002","title":"\u5305\u542b\u6ca1\u6709\u5185\u5bb9\u7684\u6807\u7b7e"},{"location":"criteria/#_18","text":"\u4e3a\u4e86\u4f7f\u7528\u51c6\u5219\u6807\u7b7e\uff0c\u4f60\u9700\u8981\u7ec4\u7ec7\u9875\u9762\u3002 \u575a\u6301\u4ee5\u4e0b\u8303\u4f8b\u7ed3\u6784\uff1a <xf:form ... class=\"block\"> <div class=\"block-container\"> <!-- \u6807\u7b7e --> <h2 class=\"block-tabHeader tabs hScroller\" data-xf-init=\"h-scroller tabs\" role=\"tablist\"> <span class=\"hScroller-scroll\"> <!-- Main tab where fields/options are located --> <a class=\"tabs-tab is-active\" role=\"tab\" tabindex=\"0\" aria-controls=\"MAIN_TAB_ID\">Main tab title</a> <!-- \u51c6\u5219\u6807\u7b7e --> <xf:macro template=\"helper_criteria\" name=\"page_tabs\" arg-userTabTitle=\"Custom tab name (optionally)\" /> </span> </h2> <!-- \u7a97\u683c --> <ul class=\"block-body tabPanes\"> <!-- Main pane --> <li class=\"is-active\" role=\"tabpanel\" id=\"MAIN_TAB_ID\"> <!-- Fields and options --> </li> <!-- \u51c6\u5219\u7a97\u683c --> <xf:macro template=\"helper_criteria\" name=\"page_panes\" arg-criteria=\"{$criteria}\" arg-data=\"{$criteriaData}\" /> </ul> <xf:submitrow sticky=\"true\" icon=\"save\" /> </div> </xf:form> \u540c\u6837\uff0c\u5982\u679c\u4f60\u6ca1\u6709\u4efb\u4f55\u51c6\u5219\u6570\u636e\uff0c\u6216\u8005\u751a\u81f3\u5047\u8bbe\u6ca1\u6709\uff0c\u8bf7\u5c06 {{ [] }} \u4f20\u9012\u7ed9 arg-criteria \u5c5e\u6027\u3002","title":"\u6709\u5185\u5bb9\u7684\u6807\u7b7e"},{"location":"criteria/#helper_criteria_2","text":"\u5982\u679c\u4f60\u60f3\u5728 helper_criteira \u6a21\u677f\u4e2d\u6dfb\u52a0\u81ea\u5b9a\u4e49\u51c6\u5219\u7c7b\u578b\uff0c\u4f60\u9700\u8981\u521b\u5efa\u4e00\u4e2a helper_criteria \u6a21\u677f\u7684\u6a21\u677f\u4fee\u6539\u3002 \u8fdb\u5165 Admin CP \u4e2d\u7684 \"\u5916\u89b3 > \u6a21\u677f\u4fee\u6539\"\uff0c\u5207\u6362\u5230 \"\u7ba1\u7406\" \u6807\u7b7e\uff0c\u70b9\u51fb \"\u6dfb\u52a0\u6a21\u677f\u4fee\u6539\" \u6309\u94ae\u3002 \u6211\u4eec\u8981\u5728\u6a21\u677f\u7684\u6700\u5e95\u90e8\u6dfb\u52a0\u6211\u4eec\u7684\u6807\u7b7e\u548c\u7a97\u683c\uff0c\u6240\u4ee5\u5c06 \"\u641c\u5bfb\u7c7b\u578b\" \u5207\u6362\u4e3a \"\u6b63\u89c4\u8868\u8fbe\u5f0f\"\u3002 \u5728 \"\u67e5\u627e\" \u680f\u4e2d\u8f93\u5165 /$/ \u3002 \u6700\u540e\uff0c\u5728 \"\u66ff\u6362\" \u5b57\u6bb5\u4e2d\u6dfb\u52a0\u6807\u7b7e\u548c\u7a97\u683c\u7684\u5de8\u96c6\u4ee3\u7801\u3002 \u4e3e\u4f8b\uff1a <xf:macro name=\"foo_tabs\" arg-container=\"\" arg-active=\"\"> <xf:set var=\"$tabs\"> <a class=\"tabs-tab{{ $active == 'foo' ? ' is-active' : '' }}\" role=\"tab\" tabindex=\"0\" aria-controls=\"{{ unique_id('criteriaFoo') }}\">Foo criteria</a> <a class=\"tabs-tab{{ $active == 'foo_extra' ? ' is-active' : '' }}\" role=\"tab\" tabindex=\"0\" aria-controls=\"{{ unique_id('criteriaFooExtra') }}\">Foo criteria extra</a> </xf:set> <xf:if is=\"$container\"> <div class=\"tabs\" role=\"tablist\"> {$tabs|raw} </div> <xf:else /> {$tabs|raw} </xf:if> </xf:macro> <xf:macro name=\"foo_panes\" arg-container=\"\" arg-active=\"\" arg-criteria=\"!\" arg-data=\"!\"> <xf:set var=\"$panes\"> <li class=\"{{ $active == 'foo' ? ' is-active' : '' }}\" role=\"tabpanel\" id=\"{{ unique_id('criteriaFoo') }}\"> <xf:checkboxrow label=\"Criteria group 1\"> <xf:option name=\"foo_criteria[criterion_1_rule][rule]\" value=\"criterion_1_rule\" ... /> <xf:option name=\"foo_criteria[criterion_2_rule][rule]\" value=\"criterion_2_rule\" ... /> </xf:checkboxrow> <xf:checkboxrow label=\"Criteria group 2\"> <xf:option name=\"foo_criteria[criterion_3_rule][rule]\" value=\"criterion_3_rule\" ... /> <xf:option name=\"foo_criteria[criterion_4_rule][rule]\" value=\"criterion_4_rule\" ... /> </xf:checkboxrow> </li> </xf:set> <xf:if is=\"$container\"> <ul class=\"tabPanes\"> {$panes|raw} </ul> <xf:else /> {$panes|raw} </xf:if> </xf:macro> \u73b0\u5728\uff0c\u60a8\u53ef\u4ee5\u5728\u4efb\u4f55\u5730\u65b9\u4f7f\u7528\u60a8\u7684\u51c6\u5219\uff08\u8bf7\u53c2\u89c1 \"\u4f7f\u7528helper_criteria\" )\u3002","title":"\u5728 \"helper_criteria\" \u4e2d\u6dfb\u52a0\u81ea\u5b9a\u4e49\u51c6\u5219\u7c7b\u578b"},{"location":"criteria/#_19","text":"\u6bd4\u65b9\u8bf4\uff0c\u6211\u4eec\u60f3\u521b\u5efa\u4e00\u4e2a\u51c6\u5219\u6765\u68c0\u67e5\u6211\u4eec\u7684\u7528\u6237\u662f\u5426\u5728\u5358\u5219\u7559\u8a00\u4e0a\u6709 X \u4e2a\u6216\u66f4\u591a\u7684\u8cdb\u3002 \u7531\u4e8e\u6211\u4eec\u7684\u51c6\u5219\u662f\u6307\u7528\u6237\uff0c\u6240\u4ee5\u6211\u4eec\u5c06\u521b\u5efa\u4e00\u4e2a\u5c5e\u65bc\u7528\u6237\u51c6\u5219\u7684\u51c6\u5219\u3002","title":"\u81ea\u5b9a\u4e49\u7528\u6237/\u9875\u9762\u51c6\u5219\u8303\u4f8b"},{"location":"criteria/#_20","text":"\u9996\u5148\uff0c\u6211\u4eec\u9700\u8981\u5c06\u6211\u4eec\u7684\u51c6\u5219\u6dfb\u52a0\u5230\u7528\u6237\u51c6\u5219\u5217\u8868\u4e2d\u3002 \u8fdb\u5165 Admin CP \u4e2d\u7684 \"\u6a21\u677f\u4fee\u6539\" \u9875\u9762\uff0c\u9009\u62e9 \"Admin\" \u6807\u7b7e\uff0c\u70b9\u51fb\u53f3\u4e0a\u89d2\u7684 \"\u6dfb\u52a0\u6a21\u677f\u4fee\u6539\" \u6309\u94ae\u3002 Warning \u5982\u679c\u6ca1\u6709 \"Admin\" \u6807\u7b7e\uff0c\u8bf7\u786e\u4fdd\u4f60\u5df2\u7ecf\u6fc0\u6d3b\u4e86 \u5f00\u53d1\u6a21\u5f0f \u3002 \u6211\u4eec\u5c06\u4fee\u6539 helper_criteria \u6a21\u677f\uff0c\u56e0\u6b64\u5c06\u5176\u5199\u5165\u5230 \"\u6a21\u677f\" \u5b57\u6bb5\u3002 \u5728\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\uff0c\u6211\u5c06\u4f7f\u7528 likes_on_single_message \"\u4fee\u6539 key \u503c\" \u6765\u4fee\u6539\u8fd9\u4e2a\u6a21\u677f\u3002 \u6211\u4eec\u7684\u51c6\u5219\u662f\u5173\u4e8e\u7559\u8a00\u7684\u70b9\u8cdb\u6570\u3002 \u8fd9\u610f\u5473\u7740\u5b83\u5e94\u8be5\u5728 \"\u5185\u5bb9\u548c\u6210\u5c31\" \u90e8\u5206\u4e0b\u3002 \u8fd9\u8868\u793a\u6211\u4eec\u53ea\u9700\u8981\u627e\u5230 <\uff01--[XF:user:content_bottom]--> \uff0c\u7136\u540e\u7528\u4e0b\u9762\u7684\u4ee3\u7801\u66ff\u6362\u3002 <xf:option name=\"user_criteria[likes_on_single][rule]\" value=\"likes_on_single\" selected=\"{$criteria.likes_on_single}\" label=\"Likes on single message:\"> <xf:numberbox name=\"user_criteria[likes_on_single][data][likes]\" value=\"{$criteria.likes_on_single.likes}\" size=\"5\" min=\"0\" step=\"1\" /> </xf:option> $0 \u4ece\u8fd9\u4e00\u523b\u8d77\uff0c\u6211\u4eec\u5df2\u7ecf\u53ef\u4ee5\u770b\u5230\uff0c\u751a\u81f3\u53ef\u4ee5\u5728\u521b\u5efa\u6210\u5c31\u3001\u901a\u77e5\u548c\u63d0\u5347\u7528\u6237\u7ec4\u65f6\u4e3a\u6211\u4eec\u7684\u51c6\u5219\u8bbe\u7f6e\u4e00\u4e2a\u503c\u3002","title":"\u589e\u52a0\u6a21\u677f\u4fee\u6539"},{"location":"criteria/#_21","text":"\u6211\u4eec\u5df2\u7ecf\u521b\u5efa\u4e86\u6211\u4eec\u7684\u51c6\u5219\u3002 \u4f46\u5bf9\u4e8e XenForo \u6765\u8bf4\uff0c\u5b83\u662f\u672a\u77e5\u7684\uff0c\u5f53\u7b26\u5408\u8fd9\u79cd\u51c6\u5219\u65f6\uff0c\u5b83\u603b\u662f\u8fd4\u56de \"false\"\u3002 \u6211\u4eec\u9700\u8981\u544a\u8bc9 XenForo\uff0c\u5f53\u5b83\u7b26\u5408\u672a\u77e5\u51c6\u5219\u65f6\u8be5\u600e\u9ebd\u505a\u3002 \u8fdb\u5165 \"\u5f00\u53d1 > \u4ee3\u7801\u4e8b\u4ef6\u76d1\u542c\u5668\" \u9875\u9762\uff0c\u70b9\u51fb \"\u6dfb\u52a0\u4ee3\u7801\u4e8b\u4ef6\u76d1\u542c\u5668\" \u6309\u94ae\u3002 \u5728 \"\u76d1\u542c\u4e8b\u4ef6\" \u5b57\u6bb5\u4e2d\u9009\u62e9 criteria_user \uff08 user \u56e0\u4e3a\u6211\u4eec\u7684\u51c6\u5219\u5c5e\u65bc\u7528\u6237\u51c6\u5219\uff09\u3002 \u5728 \"\u8fd0\u884c callback\" \u5b57\u6bb5\u4e2d\uff0c\u6211\u4eec\u5e94\u8be5\u6307\u5b9a\u5339\u914d\u51c6\u5219\u65f6\u8981\u8c03\u7528\u7684\u7c7b\u548c\u65b9\u6cd5\u3002 \u5728 addon \u6839\u76ee\u5f55\u4e0b\u521b\u5efa\u4e00\u4e2a\u6587\u4ef6 Listener.php \uff0c\u5982\u679c\u4f60\u8fd8\u6ca1\u6709\u7684\u8bdd\uff0c\u5728\u90a3\u91cc\u6dfb\u52a0\u4e00\u4e2a\u65b0\u7684\u65b9\u6cd5 criteriaUser \uff1a <?php namespace YOUR_ADDON_ID; class Listener { public static function criteriaUser($rule, array $data, \\XF\\Entity\\User $user, &$returnValue) { } } \u4f60\u53ef\u4ee5\u7528 YOUR_ADDON_ID\\Listener \u548c criteriaUser \u5206\u522b\u586b\u5199 \"Class\" \u548c \"Method\" \u5b57\u6bb5\u3002","title":"\u589e\u52a0\u4ee3\u7801\u4e8b\u4ef6\u76d1\u542c\u5668"},{"location":"criteria/#_22","text":"\u7531\u4e8e\u6211\u4eec\u7684 criteriaUser \u65b9\u6cd5\u5bf9\u6bcf\u4e2a\u672a\u77e5\u7684\u51c6\u5219\u90fd\u4f1a\u88ab\u89e6\u53d1\uff0c\u6211\u4eec\u9700\u8981\u786e\u4fdd $rule \u7b49\u4e8e likes_on_single \uff08\u6211\u4eec\u5728 HTML \u6807\u7b7e\u4e2d\u6307\u5b9a\u7684\u89c4\u5219\uff09\u3002 public static function criteriaUser($rule, array $data, \\XF\\Entity\\User $user, &$returnValue) { switch ($rule) { case 'likes_on_single': /** \u5904\u7406\u4ee3\u7801\u5728\u8fd9\u91cc! */ break; } } \u73b0\u5728\uff0c\u6211\u4eec\u9700\u8981\u5199\u4ee3\u7801\u6765\u5b9e\u9645\u68c0\u67e5\u4e00\u4e2a\u7528\u6237\u662f\u5426\u6709 X \u4e2a\u6216\u66f4\u591a\u8d5e\u7684\u7559\u8a00\u3002 \u8fd9\u53ef\u4ee5\u901a\u8fc7\u7b80\u5358\u7684 SQL \u67e5\u627e\u8f7b\u677e\u5b9e\u73b0\uff0c\u4ece xf_post \u4e2d\u9009\u62e9\u4e00\u6761\u8d85\u8fc7 X \u4e2a\u8d5e\u7684\u8bb0\u5f55\uff08 likes column \uff09\uff0c\u5e76\u4e14 user_id \u7b49\u4e8e\u5f53\u524d\u5339\u914d\u7684\u7528\u6237 ID\u3002 \u6240\u4ee5\uff0c\u4e0b\u9762\u662f\u67e5\u627e\u8bed\u53e5\uff1a SELECT `likes` FROM `xf_post` WHERE `user_id` = ? ORDER BY `likes` DESC LIMIT 1 \u4ee5\u53ca\u65b9\u6cd5\u4ee3\u7801\uff1a public static function criteriaUser($rule, array $data, \\XF\\Entity\\User $user, &$returnValue) { switch ($rule) { case 'likes_on_single': // \u83b7\u53d6\u6570\u636e\u5e93 $db = \\XF::db(); // \u7528\u4e8e\u9009\u62e9\u5358\u4e2a\u7528\u6237\u5e16\u5b50\u7684\u6700\u5927\u70b9\u8cdb\u6570\u7684\u6570\u636e\u5e93\u67e5\u627e $query = \"SELECT `likes` FROM `xf_post` WHERE `user_id` = ? ORDER BY `likes` DESC LIMIT 1\"; // \u68c0\u7d22\u6700\u5927\u70b9\u8cdb\u6570 $likes = $db->fetchOne($query, [$user->user_id]); // \u68c0\u67e5\u6211\u4eec\u662f\u5426\u6709\u6765\u81ea\u6570\u636e\u5e93\u7684\u7ed3\u679c(\u6211\u4eec\u671f\u671b\u6709\u4e00\u4e2a\u6570\u5b57) if (is_int($likes)) { // \u5982\u679c\u7528\u6237\u7684\u4fe1\u606f\u6709 X \u4e2a\u6216\u66f4\u591a\u7684\u8cdb\uff0c\u5219\u8fd4\u56de true\uff1b\u5982\u679c\u6ca1\u6709\uff0c\u5219\u8fd4\u56de false $returnValue = ($likes >= $data['likes']); } else { $returnValue = false; } break; } } \u8981\u6ce8\u610f\u4ee5\u4e0b\u51e0\u70b9\uff1a \u6211\u4eec\u4f7f\u7528 $user \u53d8\u91cf\u6765\u68c0\u7d22\u5f53\u524d\u5339\u914d\u7684\u7528\u6237\u3002 \u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u8fd9\u4e2a\u53d8\u91cf\uff0c\u56e0\u4e3a\u6211\u4eec\u7684\u51c6\u5219\u5c5e\u65bc \u7528\u6237 \u51c6\u5219\u3002 \u6211\u4eec\u53ef\u4ee5\u901a\u8fc7 $data \u6570\u7ec4\u8bbf\u95ee\u6570\u636e\u3002 \u5b83\u5305\u542b\u4e86\u6211\u4eec\u5728 \u6a21\u677f\u4fee\u6539\u4e2d\u5df2\u6dfb\u52a0 \u7684\u5b57\u6bb5\u7684\u6570\u636e\u3002 \u6211\u4eec\u53ea\u6dfb\u52a0\u4e86\u4e00\u4e2a <xf:numberbox... \uff0c\u5176\u4e2d name \u5c5e\u6027\u7b49\u4e8e user_criteria[likes_on_single][data][likes] \u3002 \u8fd9\u5c31\u662f\u4e3a\u4ec0\u9ebd\u6211\u4eec\u53ef\u4ee5\u5728\u4e0a\u9762\u7684\u4ee3\u7801\u4e2d\u4f7f\u7528 $data['likes'] \u3002 \u73b0\u5728\u4e00\u5207\u90fd\u641e\u5b9a\u4e86\u3002 \u8ba9\u6211\u4eec\u6d4b\u8bd5\u4e00\u4e0b\u5427\uff01","title":"\u5904\u7406\u51c6\u5219"},{"location":"criteria/#_23","text":"\u521b\u5efa\u4e00\u4e2a \"\u4eba\u4eba\u4e3a\u6211\" \u7684\u6210\u5c31\u3002 \u5728 \"\u7528\u6237\u51c6\u5219\" \u6807\u7b7e\u4e0a\uff0c\"\u5358\u5219\u7559\u8a00\u7684\u70b9\u8cdb\u6570\" \u5b57\u6bb5\uff0c\u4f8b\u5982\uff0c5\u3002 \u63a5\u4e0b\u6765\uff0c\u5728\u4f60\u8bba\u575b\u7684\u67d0\u5904\u521b\u5efa\u4e00\u4e2a\u6d4b\u8bd5\u7559\u8a00\uff0c\u7136\u540e\u7528\u4e94\u4e2a\u4e0d\u540c\u7684\u7528\u6237\u70b9\u8cdb\u4e94\u6b21\uff08\u6216\u8005\u76f4\u63a5\u624b\u52a8\u8bbe\u7f6e likes \u680f\u7684\u503c\uff09\u3002 \u7136\u540e\uff0c\u8fdb\u5165 \"\u5de5\u5177 > \u8ba1\u753b\u4efb\u52a1\"\uff0c\u901a\u8fc7\u70b9\u51fb\u8fd0\u884c\u6309\u94ae (\u5faa\u73af-\u7bad\u5934) \"\u66f4\u65b0\u7528\u6237\u6210\u5c31\u503c\" \u8ba1\u753b\u3002 \u5f88\u597d\uff01 Warning \u5982\u679c\u60a8\u6ca1\u6709\u83b7\u5f97 \"\u4eba\u4eba\u4e3a\u6211\" \u6210\u5c31\uff0c\u8bf7\u5c1d\u8bd5\u767b\u51fa\u3001\u767b\u5f55\u5e76\u91cd\u65b0\u8fd0\u884c \"\u66f4\u65b0\u7528\u6237\u6210\u5c31\u503c\" \u8ba1\u753b\u3002","title":"\u6d4b\u8bd5\uff08\u6210\u5c31\uff09"},{"location":"criteria/#_24","text":"\u8fdb\u5165 \"\u8054\u7cfb > \u901a\u77e5\"\uff0c\u70b9\u51fb \"\u6dfb\u52a0\u901a\u77e5\" \u6309\u94ae\u3002 \u5728 \"\u7528\u6237\u51c6\u5219\" \u6807\u7b7e\u4e0a\uff0c\u5c06 \"\u5358\u5219\u7559\u8a00\u7684\u70b9\u8cdb\u6570\" \u5b57\u6bb5\u540c\u6837\u8bbe\u7f6e\u4e3a 5\u3002 \u4fdd\u5b58\u901a\u77e5\u3002 \u63a5\u4e0b\u6765\uff0c\u5728\u4f60\u8bba\u575b\u7684\u67d0\u5904\u521b\u5efa\u4e00\u4e2a\u6d4b\u8bd5\u7559\u8a00\uff0c\u7136\u540e\u7528\u4e94\u4e2a\u4e0d\u540c\u7684\u7528\u6237\u70b9\u8cdb\u4e94\u6b21\uff08\u6216\u8005\u76f4\u63a5\u624b\u52a8\u8bbe\u7f6e likes \u680f\u7684\u503c\uff09\u3002 \u73b0\u5728\uff0c\u4f60\u5e94\u8be5\u4f1a\u770b\u5230\u4e00\u5219\u901a\u77e5\uff1a \u4f60\u53ef\u4ee5 \u4e0b\u8f7d \u57fa\u4e8e\u8fd9\u4e2a\u8303\u4f8b\u6784\u5efa\u7684\u9644\u52a0\u7ec4\u4ef6\u8d44\u6e90 (2.0.10)\u3002","title":"\u6d4b\u8bd5\uff08\u901a\u77e5\uff09"},{"location":"criteria/#_25","text":"\u60f3\u8c61\u4e00\u4e0b\uff0c\u6211\u4eec\u6b63\u5728\u521b\u5efa\u4e00\u4e2a\u9644\u52a0\u7ec4\u4ef6\uff08\u9644\u52a0\u7ec4\u4ef6 ID\uff1a PostsRemover \uff09\uff0c\u7528\u4e8e\u5220\u9664\u6240\u6709\u7b26\u5408\u9009\u5b9a\u51c6\u5219\u7684\u5e16\u5b50\u3002 \u4e00\u4e2a\u53ef\u7528\u51c6\u5219\u7684\u5217\u8868\uff1a \u5e16\u5b50\u81f3\u5c11\u6709 X \u4e2a\u70b9\u8cdb\u6570 \u5e16\u5b50\u4f5c\u8005\u6709\u4e00\u4e2a X \u7528\u6237\u540d \u5e16\u5b50\u81f3\u5c11\u88ab\u7f16\u8f91\u4e86 X \u6b21 \u5e16\u5b50\u88ab\u7f16\u8f91\u7684\u6b21\u6570\u4e0d\u8d85\u8fc7 X \u6b21 \u5e16\u5b50\u5728 X \u4e4b\u524d\u53d1\u8868 \u5e16\u5b50\u53d1\u8868\u4e8e X \u4e4b\u540e \u663e\u7136\uff0c\u5bf9\u4e8e\u8fd9\u6837\u7684\u51c6\u5219\uff0c\u6211\u4eec\u9700\u8981\u4e00\u79cd\u65b0\u7684\u51c6\u5219\u7c7b\u578b\uff1a\u5e16\u5b50\u51c6\u5219\u3002","title":"\u81ea\u5b9a\u4e49\u51c6\u5219\u7c7b\u578b\u8303\u4f8b"},{"location":"criteria/#criteria-type-class-class","text":"\u6211\u4eec\u5e94\u8be5\u5148\u5728 addon \u7684 Criteria \u76ee\u5f55\u4e0b\u521b\u5efa\u4e00\u4e2a\u7ee7\u627f AbstractCriteria \u7684\u65b0 class Post \uff1a <?php namespace PostsRemover\\Criteria; use XF\\Criteria\\AbstractCriteria; class Post extends AbstractCriteria { } \u73b0\u5728\u6211\u4eec\u9700\u8981\u4e3a addon \u652f\u63f4\u7684\u6240\u6709\u51c6\u5219\u5199\u4ee3\u7801\u3002 \u5728\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\uff0c\u6211\u5c06\u4e3a\u4e0a\u9762\u5217\u8868\u4e2d\u7684\u524d\u4e09\u4e2a\u51c6\u5219\u5199\u4ee3\u7801\uff1a <?php namespace PostsRemover\\Criteria; use XF\\Criteria\\AbstractCriteria; class Post extends AbstractCriteria { // \u5e16\u5b50\u81f3\u5c11\u6709 X \u4e2a\u70b9\u8cdb\u6570 protected function _matchLikeCount(array $data, \\XF\\Entity\\Post $post) { return ($post->likes && $post->likes >= $data['likes']); } // \u5e16\u5b50\u4f5c\u8005\u6709\u4e00\u4e2a X \u7528\u6237\u540d protected function _matchUsername(array $data, \\XF\\Entity\\Post $post) { return $post->username === $data['name']; } // \u5e16\u5b50\u81f3\u5c11\u88ab\u7f16\u8f91\u4e86 X \u6b21 protected function _matchEditedCount(array $data, \\XF\\Entity\\Post $post) { return $post->edit_count && $post->edit_count >= $data['count']; } /* ================ \u5904\u7406\u5176\u4ed6\u51c6\u5219 ================ */ } isMatched(...) \u65b9\u6cd5\u7528\u4e8e\u8c03\u7528\u6211\u4eec\u521a\u624d\u521b\u5efa\u7684 _match \u65b9\u6cd5\uff0c\u53ea\u63a5\u53d7 User \u5b9e\u4f53\uff0c\u6211\u4eec\u8981\u5199\u4e00\u4e2a\u81ea\u5b9a\u4e49\u7684 isMatched() \u3001 isUnknownMatched() \u548c isSpecialMatched() \u65b9\u6cd5\u7684\u53d8\u4f53\u3002 \u7531\u4e8e\u6211\u4eec\u6b63\u5728\u521b\u5efa\u5e16\u5b50\u51c6\u5219\uff0c\u6211\u4eec\u9700\u8981\u521b\u5efa\u81ea\u5df1\u7684 isMatchedPost() \u65b9\u6cd5\uff1a public function isMatchedPost(\\XF\\Entity\\Post $post) { if (!$this->criteria) { return $this->matchOnEmpty; } foreach ($this->criteria AS $criterion) { $rule = $criterion['rule']; $data = $criterion['data']; $specialResult = $this->isSpecialMatchedPost($rule, $data, $post); if ($specialResult === false) { return false; } else if ($specialResult === true) { continue; } $method = '_match' . \\XF\\Util\\Php::camelCase($rule); if (method_exists($this, $method)) { $result = $this->$method($data, $post); if (!$result) { return false; } } else { if (!$this->isUnknownMatched($rule, $data, $post)) { return false; } } } return true; } protected function isSpecialMatchedPost($rule, array $data, \\XF\\Entity\\Post $post) { return null; } protected function isUnknownMatchedPost($rule, array $data, \\XF\\Entity\\Post $post) { return false; } \u6211\u4eec\u53ea\u9700\u7528 isMatched(...) \u65b9\u6cd5\u4ee3\u7801\u5c06 User \u5b9e\u4f53\u7c7b\u578b\u7684 $user \u53d8\u91cf\u66ff\u6362\u4e3a Post \u5b9e\u4f53\u7c7b\u578b\u7684 $post \u53d8\u91cf\u3002 \u7531\u4e8e\u6211\u4eec\u4e0d\u6253\u7b97\u5904\u7406\u7279\u6b8a\u548c\u672a\u77e5\u7684\u51c6\u5219\uff0c\u6211\u4eec\u5728 isSpecialMatchedPost \u4e2d\u8fd4\u56de null\uff0c\u5728 isUnknownMathcedPost \u65b9\u6cd5\u4e2d\u8fd4\u56de false \u3002","title":"Criteria type class \u51c6\u5219\u7c7b\u578b class"},{"location":"criteria/#_26","text":"\u629b\u5f00\u6dfb\u52a0 admin \u8def\u7531\u3001\u7f16\u5199 Controller \u548c\u5728\u540e\u53f0\u505a\u5176\u4ed6\u64cd\u4f5c\u7684\u8fc7\u7a0b\uff0c\u76f4\u63a5\u8df3\u5230\u6211\u4eec\u9875\u9762\u7684\u6a21\u677f\u4ee3\u7801\uff1a <xf:title>Posts Remover</xf:title> <xf:form action=\"{{ link('posts-remover/remove') }}\" ajax=\"true\" class=\"block\"> <div class=\"block-container\"> <xf:checkboxrow label=\"Post criteria\"> <xf:option label=\"Post has at least X likes\" name=\"post_criteria[like_count][rule]\" value=\"like_count\"> <xf:numberbox name=\"post_criteria[like_count][data][likes]\" size=\"5\" min=\"0\" step=\"1\" /> </xf:option> <xf:option label=\"Post author has an X username\" name=\"post_criteria[username][rule]\" value=\"username\"> <xf:textbox name=\"post_criteria[username][data][name]\" ac=\"true\" /> </xf:option> <xf:option label=\"Post was edited at least X times\" name=\"post_criteria[edited_count][rule]\" value=\"edited_count\"> <xf:numberbox name=\"post_criteria[edited_count][data][count]\" size=\"5\" min=\"0\" step=\"1\" /> </xf:option> </xf:checkboxrow> <!-- \u5176\u4ed6\u51c6\u5219\u7684\u6a21\u677f\u4ee3\u7801 --> <xf:submitrow sticky=\"true\" icon=\"delete\"/> </div> </xf:form>","title":"\u6a21\u677f"},{"location":"criteria/#_27","text":"\u5728\u6211\u4eec\u9875\u9762\u7684 Controller \u4e2d\uff0c\u6211\u4eec\u9700\u8981\u521b\u5efa\u4e00\u4e2a\u540d\u4e3a actionRemove \u7684\u65b9\u6cd5\u6765\u5904\u7406 \"\u79fb\u9664\" \u6309\u94ae\u7684\u70b9\u51fb\uff1a public function actionRemove() { } \u9996\u5148\uff0c\u8ba9\u6211\u4eec\u4ece\u9875\u9762\u8868\u5355\u4e2d\u68c0\u7d22 post_criteria \u6570\u7ec4\uff1a public function actionRemove() { $postCriteriaInput = $this->filter('post_criteria', 'array'); } \u5176\u6b21\uff0c\u6211\u4eec\u9700\u8981\u4ece\u68c0\u7d22\u5230\u7684\u9875\u9762\u8868\u5355\u6570\u636e\u4e2d\u521b\u5efa\u4e00\u4e2a\u51c6\u5219\u7269\u4ef6\uff1a public function actionRemove() { $postCriteriaInput = $this->filter('post_criteria', 'array'); /** @var \\PostsRemover\\Criteria\\Post $postCriteria */ $postCriteria = $this->app()->criteria('PostsRemover:Post', $postCriteriaInput); } \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u53d1\u5e03\u5e16\u5b50 \u5c06\u5339\u914d empty \u51c6\u5219\uff08\u5f53\u6ca1\u6709\u9009\u62e9\u4efb\u4f55\u5185\u5bb9\u65f6\uff09\uff0c\u8fd9\u5c06\u5bfc\u81f4\u6240\u6709\u8bba\u575b\u5e16\u5b50\u90fd\u88ab\u5220\u9664\u3002 \u4e3a\u4e86\u907f\u514d\u8fd9\u79cd\u60c5\u51b5\uff0c\u6211\u4eec\u9700\u8981\u901a\u8fc7 setMatchOnEmpty() \u65b9\u6cd5\u624b\u52a8\u8bbe\u7f6e\u5339\u914d empty \u51c6\u5219\u7684\u7ed3\u679c\uff1a public function actionRemove() { $postCriteriaInput = $this->filter('post_criteria', 'array'); /** @var \\PostsRemover\\Criteria\\Post $postCriteria */ $postCriteria = $this->app()->criteria('PostsRemover:Post', $postCriteriaInput); $postCriteria->setMatchOnEmpty(false); // \u5982\u679c\u6ca1\u6709\u9009\u5b9a\u51c6\u5219\uff0c\u5219\u4e0d\u4f1a\u5220\u9664\u4efb\u4f55\u5185\u5bb9 } \u6700\u540e\uff0c\u6211\u4eec\u9700\u8981\u6839\u636e\u9009\u5b9a\u7684\u51c6\u5219\u6765\u5339\u914d\u6240\u6709\u8bba\u575b\u5e16\u5b50\u3002 \u5982\u679c\u5e16\u5b50\u7b26\u5408\u51c6\u5219\uff0c\u6211\u4eec\u5c06\u5220\u9664\u5b83\u3002 public function actionRemove() { $postCriteriaInput = $this->filter('post_criteria', 'array'); /** @var \\PostsRemover\\Criteria\\Post $postCriteria */ $postCriteria = $this->app()->criteria('PostsRemover:Post', $postCriteriaInput); $postCriteria->setMatchOnEmpty(false); // \u5982\u679c\u6ca1\u6709\u9009\u62e9\u51c6\u5219\uff0c\u5219\u4e0d\u4f1a\u5220\u9664\u4efb\u4f55\u5185\u5bb9 // \u53d6\u5f97\u6240\u6709\u8bba\u575b\u5e16\u5b50 $posts = $this->finder('XF:Post')->fetch(); $deletedCounter = 0; /** @var \\XF\\Entity\\Post $post */ foreach ($posts as $post) { if ($postCriteria->isMatchedPost($post)) // \u9488\u5bf9\u6240\u9009\u5b9a\u7684\u51c6\u5219\u68c0\u67e5\u5e16\u5b50 { $post->delete(); // \u5982\u679c\u5e16\u5b50\u7b26\u5408\u9009\u5b9a\u7684\u51c6\u5219\uff0c\u5219\u5c06\u5176\u5220\u9664\u3002 $deletedCounter++; } } return $this->message('Done! ' . $deletedCounter . ' posts were removed!'); } Note \u8bf7\u6ce8\u610f\uff0c\u5bf9\u4e8e XenForo 2.1 \u4ee5\u4e0b\u7684\u7248\u672c\uff0c\u6211\u4eec\u4f7f\u7528 isMatchedPost($post) \u65b9\u6cd5\uff01 Warning \u4e00\u822c\u6765\u8bf4\uff0c\u4e00\u6b21\u4ece\u6570\u636e\u5e93\u4e2d\u68c0\u7d22\u6240\u6709\u7684\u5b9e\u4f53\u662f\u4e00\u79cd\u4e0d\u597d\u7684\u505a\u6cd5\uff08\u4e0a\u9762\u4ee3\u7801\u4e2d\u7684 $this->finder('XF:Post')->fetch(); \uff09\u3002 \u8bba\u575b\u7684\u5e16\u5b50\u53ef\u80fd\u6709\u51e0\u767e\u4e07\u4e2a\uff0c\u5982\u679c\u4e00\u6b21\u5168\u90e8\u9009\u53d6\u4f1a\u662f\u4e00\u4e2a\u975e\u5e38\u6f2b\u957f\u7684\u8fc7\u7a0b\uff0c\u6700\u540e\u53ef\u80fd\u8fd8\u4f1a\u51fa\u73b0\u9519\u8bef\u3002 \u8003\u8651\u4f7f\u7528 Job \u7cfb\u7edf\u6765\u5904\u7406\u6570\u5341\u4e2a\uff08100+\uff09\u6570\u636e\u5e93\u9879\u76ee\u3002","title":"\u5339\u914d\u51c6\u5219"},{"location":"criteria/#_28","text":"\u662f\u65f6\u5019\u6d4b\u8bd5\u6211\u4eec\u7684\u81ea\u5b9a\u4e49\u51c6\u5219\u7c7b\u578b\u4e86\uff01 \u6211\u5728\u6211\u7684\u6d4b\u8bd5\u8bba\u575b\u4e0a\u521b\u5efa\u4e86\u4e09\u4e2a\u5e16\u5b50\u3002 \u7b2c\u4e00\u4e2a\u5e16\u5b50\u88ab\u70b9\u8cdb 500 \u6b21\uff0c\u7b2c\u4e8c\u4e2a\u5e16\u5b50\u88ab\u7f16\u8f91 5 \u6b21\u3002 \u7b2c\u4e09\u4e2a\u53ea\u662f\u4e00\u4e2a\u539f\u5c01\u4e0d\u52a8\u7684\u6ca1\u6709\u88ab\u70b9\u8d5e\u7684\u5e16\u5b50\u3002 \u73b0\u5728\uff0c\u5728\u6211\u4eec\u7684 \"\u5e16\u5b50\u5220\u9664\u5668\" Admin CP \u9875\u9762\u4e0a\uff0c\u8ba9\u6211\u4eec\u9009\u62e9 \"\u5e16\u5b50\u81f3\u5c11\u6709 X \u4e2a\u70b9\u8cdb\u6570\"\uff08\u503c\u4e3a 250\uff09\u548c \"\u5e16\u5b50\u81f3\u5c11\u88ab\u7f16\u8f91\u8fc7 X \u6b21\"\uff08\u503c\u4e3a 5\uff09\u3002 \u5f53\u6211\u6309\u4e0b \"\u5220\u9664\" \u952e\u65f6\uff0c\u6211\u770b\u5230\u4e00\u6761\u5373\u65f6\u6d88\u606f\uff0c\u544a\u8bc9\u6211\u4ec0\u9ebd\u90fd\u6ca1\u6709\u5220\u9664\u3002 \u4e3a\u4ec0\u9ebd\u5462\uff1f \u5f88\u663e\u7136\uff0c\u56e0\u4e3a\u5728 \u540c\u4e00\u65f6\u95f4\u5185 \u6ca1\u6709\u81f3\u5c11 250 \u4e2a\u70b9\u8cdb\u6570\u548c\u81f3\u5c11\u7f16\u8f91\u8fc7 5 \u6b21\u7684\u5e16\u5b50\u3002 \u6240\u4ee5\u6211\u4eec\u53ea\u9700\u8981\u9009\u62e9\u7b2c\u4e00\u4e2a\u51c6\u5219\uff0c\u7136\u540e\u70b9\u51fb \"\u5220\u9664\"\u3002 \u8fd9\u6837\u5c31\u4f1a\u5220\u9664\u4e00\u4e2a\u6709 500 \u4e2a\u70b9\u8cdb\u6570\u7684\u5e16\u5b50\u3002 \u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u53ea\u9700\u8981\u9009\u62e9\u6700\u540e\u4e00\u4e2a\u51c6\u5219\uff0c\u7136\u540e\u9884\u5148\u8fdb\u884c\u5220\u9664\u3002 \u6709\u7f16\u8f91\u8fc7 5 \u6b21\u7684\u5e16\u5b50\u5c06\u88ab\u5220\u9664\u3002 \u7ed3\u679c\uff0c\u53ea\u6709\u4e00\u4e2a\u6d4b\u8bd5\u5e16\u5b50\u5728\u6d4b\u8bd5\u4e2d\u5e78\u5b58\u4e0b\u6765\uff1a \u4f60\u53ef\u4ee5 \u4e0b\u8f7d \u57fa\u4e8e\u8fd9\u4e2a\u8303\u4f8b (2.0.10) \u6240\u6784\u5efa\u7684\u63d2\u4ef6\u539f\u4ee3\u7801\u3002 \u5728 Admin CP \u91cc\u4f60\u53ef\u4ee5\u5728 \"\u5de5\u5177\" \u7684\u90e8\u5206\u627e\u5230 \"\u5e16\u5b50\u5220\u9664\u5668\"\u3002","title":"\u6d4b\u8bd5"},{"location":"designing-styles/","text":"\u8bbe\u8ba1\u6837\u5f0f \u00b6 \u5728 XF2 \u4e2d\uff0c\u6211\u4eec\u5f15\u5165\u4e86\u4e00\u79cd\u5168\u65b0\u7684\u65b9\u5f0f\u6765\u521b\u5efa\u548c\u7f16\u8f91\u6837\u5f0f\uff0c\u79f0\u4e3a \"\u8bbe\u8ba1\u5e08\u6a21\u5f0f\"\u3002 \u8bbe\u8ba1\u5e08\u6a21\u5f0f\u662f\u4e00\u4e2a CLI \u5de5\u5177\u96c6\u5408\uff0c\u5141\u8bb8\u60a8\u76f4\u63a5\u5728\u6587\u4ef6\u7cfb\u7edf\u4e2d\u4fee\u6539\u6837\u5f0f\u4e2d\u7684\u67d0\u4e9b\u6a21\u677f\u3002 \u5b83\u8fd8\u8f93\u51fa\u5404\u79cd metadata \u548c\u6837\u5f0f\u5c5e\u6027\u4fe1\u606f\uff0c\u8fd9\u5bf9\u7248\u672c\u63a7\u5236\u548c\u534f\u540c\u5408\u4f5c\u975e\u5e38\u6709\u5e2e\u52a9\u3002 \u5f00\u542f\u8bbe\u8ba1\u5e08\u6a21\u5f0f \u00b6 \u5f00\u542f\u8bbe\u8ba1\u5e08\u6a21\u5f0f\u7684\u7b2c\u4e00\u6b65\u662f\u5728 config.php \u4e2d\u6fc0\u6d3b\u5b83\u3002 $config['designer']['enabled'] = true; \u60a8\u4e5f\u53ef\u4ee5\u9009\u62e9\u4e3a\u8bbe\u8ba1\u5668\u6a21\u5f0f\u6587\u4ef6\u6307\u5b9a\u4e0d\u540c\u7684\u8def\u5f84\u5b58\u5728\u4e8e\u6587\u4ef6\u7cfb\u7edf\u4e2d\u3002 \u4ee5\u4e0b\u662f\u9ed8\u8ba4\u8def\u5f84\u3002 \u8981\u6539\u53d8\u8def\u5f84\uff0c\u8bf7\u5728\u4f60\u7684 config.php \u4e2d\u6dfb\u52a0\u4ee5\u4e0b\u5185\u5bb9\uff0c\u5e76\u76f8\u5e94\u4fee\u6539\u8def\u5f84\u3002 $config['designer']['basePath'] = 'src/styles'; \u5f00\u542f\u6837\u5f0f\u8bbe\u8ba1\u5e08\u6a21\u5f0f \u00b6 \u8bbe\u8ba1\u5e08\u6a21\u5f0f\u5fc5\u987b\u4e3a\u6bcf\u4e2a\u6837\u5f0f\u660e\u786e\u6fc0\u6d3b\u3002 \u6211\u4eec\u901a\u8fc7\u4f7f\u7528 CLI \u548c\u6307\u5b9a\u6837\u5f0f\u7684\u6837\u5f0f ID\uff0c\u5e76\u9009\u62e9 \"\u8bbe\u8ba1\u5e08\u6a21\u5f0f ID\" \u6765\u6fc0\u6d3b\u6837\u5f0f\u7684\u8bbe\u8ba1\u5e08\u6a21\u5f0f\uff1a Terminal $ php cmd.php xf-designer:enable [style_id] [designer_mode_id] \u8bbe\u8ba1\u5e08\u6a21\u5f0f ID \u662f\u672a\u6765\u4e0e\u8bbe\u8ba1\u5e08\u6a21\u5f0f\u76f8\u5173\u7684\u547d\u4ee4\u4e2d\u4f7f\u7528\u7684\u6807\u8bc6\u7b26\u3002 \u4e00\u65e6\u5f00\u542f\uff0c\u5f53\u524d\u4fee\u6539\u540e\u7684\u6837\u5f0f\u7ec4\u4ef6\u5c06\u88ab\u5bfc\u51fa\u5230 [basePath]/[designer_mode_id] \u76ee\u5f55\u4e2d\u3002 \u5f53\u5f00\u542f\u8be5\u6837\u5f0f\u7684\u8bbe\u8ba1\u5e08\u6a21\u5f0f\u65f6\uff0c\u5982\u679c\u8be5\u76ee\u5f55\u5df2\u7ecf\u5b58\u5728\uff0c\u4f60\u4f1a\u6709\u4e00\u4e2a\u9009\u62e9\uff0c\u5373\u6211\u4eec\u662f\u5426\u5e94\u8be5\u4ece\u6837\u5f0f\u4e2d\u590d\u76d6\u8be5\u76ee\u5f55\u7684\u5f53\u524d\u5185\u5bb9\uff0c\u6216\u8005\u662f\u5426\u5e94\u8be5\u4ece\u8be5\u76ee\u5f55\u7684\u5f53\u524d\u5185\u5bb9\u4e2d\u590d\u76d6\u5f53\u524d\u6837\u5f0f\u3002 \u5173\u95ed\u6837\u5f0f\u8bbe\u8ba1\u5e08\u6a21\u5f0f \u00b6 \u8981\u5173\u95ed\u67d0\u4e2a\u6837\u5f0f\u7684\u8bbe\u8ba1\u5e08\u6a21\u5f0f\uff0c\u60a8\u53ea\u9700\u8fd0\u884c\u4ee5\u4e0b CLI \u547d\u4ee4\u3002 Terminal $ php cmd.php xf-designer:disable [designer_mode_id] \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u8fd9\u5c06\u5728\u6587\u4ef6\u7cfb\u7edf\u4e2d\u4fdd\u7559\u8bbe\u8ba1\u5e08\u6a21\u5f0f\u7684\u8f93\u51fa\u526f\u672c\u3002 \u8981\u5220\u9664\u6570\u636e\uff0c\u4f60\u53ef\u4ee5\u7528 --clear \u9009\u9879\u8fd0\u884c\u540c\u6837\u7684\u547d\u4ee4\u3002 Terminal $ php cmd.php xf-designer:disable [designer_mode_id] --clear \u4ec0\u9ebd\u662f\u8f93\u51fa\uff0c\u5728\u54ea\u91cc\u8f93\u51fa\uff1f \u00b6 \u91cd\u8981\u7684\u662f\u8981\u8bb0\u4f4f\uff0cXF \u4e2d\u7684\u6837\u5f0f\u53ea\u7531\u5728\u8be5\u6837\u5f0f\u4e2d \u4fee\u6539\u7684\u5185\u5bb9 \u7ec4\u6210\u3002 \u8fd9\u610f\u5473\u7740\u8bbe\u8ba1\u5e08\u6a21\u5f0f\u7684\u8f93\u51fa\u5c06\u53ea\u5305\u62ec\u5728\u6837\u5f0f\u4e2d\u88ab\u4fee\u6539\u7684\u5185\u5bb9\u3002 \u5728\u7236\u6837\u5f0f\u4e2d\u88ab\u4fee\u6539\u7684\u6a21\u677f\u548c\u6837\u5f0f\u5c5e\u6027\u4e0d\u4f1a\u88ab\u8f93\u51fa\u3002 \u6a21\u677f \u00b6 \u6a21\u677f\u5c06\u88ab\u8f93\u51fa\u5230 [basePath]/[designer_mode_id]/templates \u76ee\u5f55\u4e2d\u3002 \u5728\u8be5\u76ee\u5f55\u4e2d\uff0c\u60a8\u53ef\u4ee5\u4e3a\u6bcf\u79cd\u7c7b\u578b\uff08\u5982 admin\u3001email \u548c public\uff09\u8bbe\u7f6e\u53e6\u4e00\u4e2a\u76ee\u5f55\u3002 \u6a21\u677f\u5c06\u4ee5 HTML \u683c\u5f0f\u8f93\u51fa\uff0c\u5e76\u53ef\u5728\u6587\u4ef6\u7cfb\u7edf\u4e2d\u76f4\u63a5\u7f16\u8f91\u3002 \u5728\u6587\u4ef6\u7cfb\u7edf\u4e0a\u6240\u505a\u7684\u66f4\u6539\u4f1a\u5728\u8be5\u6a21\u677f\u52a0\u8f7d\u5230\u9875\u9762\u65f6\u88ab\u5bfc\u5165\u5e76\u7f16\u8bd1\u3002 \u540c\u6837\uff0c\u60a8\u4e5f\u53ef\u4ee5\u901a\u8fc7\u4ece\u6587\u4ef6\u7cfb\u7edf\u4e2d\u5220\u9664\u6a21\u677f\uff08\u5982\u679c\u5b83\u4ee5\u524d\u88ab\u4fee\u6539\u8fc7\uff09\u6765\u6062\u590d\u5b83\u3002 \u6837\u5f0f\u5c5e\u6027\u548c\u7fa4\u7ec4 \u00b6 \u6837\u5f0f\u5c5e\u6027\u548c\u7fa4\u7ec4\u5c06\u88ab\u8f93\u51fa\u5230 [basePath]/[designer_mode_id]/style_properties \u548c [basePath]/[designer_mode_id]/style_property_groups \u76ee\u5f55\u4e0b\u3002 \u5b83\u4eec\u4ee5 JSON \u683c\u5f0f\u5bfc\u51fa\uff0c\u4f5c\u4e3a\u4e00\u79cd\u6709\u7528\u7684\u65b9\u5f0f\uff0c\u901a\u8fc7\u7248\u672c\u63a7\u5236\u7cfb\u7edf\u76d1\u63a7\u8fd9\u4e9b\u6587\u4ef6\u7684\u53d8\u5316\u3002 \u4e0d\u5efa\u8bae\u76f4\u63a5\u4fee\u6539\u8fd9\u4e9b\u6587\u4ef6\uff0c\u56e0\u4e3a\u5bf9\u5b83\u4eec\u7684\u4fee\u6539 \u4e0d\u4f1a \u50cf\u6a21\u677f\u90a3\u6837\u81ea\u52a8\u5bfc\u5165\u3002 \u4fee\u6539\u7279\u5b9a\u6a21\u677f \u00b6 \u8003\u8651\u5230\u4e00\u4e2a\u6837\u5f0f\u53ea\u4ee3\u8868\u5728\u8be5\u6837\u5f0f\u4e2d\u88ab\u4fee\u6539\u7684\u7ec4\u4ef6\uff0c\u5f53\u8bbe\u8ba1\u5e08\u6a21\u5f0f\u5f00\u542f\u65f6\uff0c\u6587\u4ef6\u7cfb\u7edf\u4e5f\u5c06\u53ea\u5305\u542b\u5728\u8be5\u6837\u5f0f\u4e2d\u88ab\u4fee\u6539\u7684\u7ec4\u4ef6\u3002 \u8fd9\u6837\u5c31\u65e0\u6cd5\u8f93\u51fa\u6bcf\u4e2a\u6a21\u677f\u548c\u6837\u5f0f\u5c5e\u6027\u7684\u6709\u6548\u7248\u672c\u3002 \u8981\u5c06\u4e00\u4e2a\u6a21\u677f\u6807\u8bb0\u4e3a\u6837\u5f0f\u4e2d\u5df2\u4fee\u6539\u7684\uff0c\u60a8\u53ef\u4ee5\u901a\u8fc7\u5728 Admin CP \u4e2d\u7f16\u8f91\u5b83\u7684\u5e38\u89c4\u65b9\u5f0f\u8fdb\u884c\u3002 \u5982\u679c\u6fc0\u6d3b\u4e86\u8bbe\u8ba1\u5668\u6a21\u5f0f\uff0c\u5728 Admin CP \u4e2d\u4fee\u6539\u7684\u6a21\u677f\u548c\u6837\u5f0f\u5c5e\u6027\u5c06\u81ea\u52a8\u5199\u5165\u6587\u4ef6\u7cfb\u7edf\u3002 \u7136\u800c\uff0c\u4f7f\u7528 CLI \u547d\u4ee4\u6765\u4fee\u6539\u6216 \"touch\" \u4e00\u4e2a\u6a21\u677f\u53ef\u80fd\u4f1a\u66f4\u65b9\u4fbf\u3002 Terminal $ php cmd.php xf-designer:touch-template [designer_mode_id] [template_type:template_title] \u53ea\u8981\u6307\u5b9a\u7684\u6a21\u677f\u5b58\u5728\u4e8e\u7236\u6837\u5f0f\u6216\u4e3b\u6837\u5f0f\u4e2d\uff0c\u5b83\u5c31\u4f1a\u88ab\u590d\u5236\u5230\u5f53\u524d\u6837\u5f0f\u4e2d\uff0c\u5e76\u8f93\u51fa\u5230\u6587\u4ef6\u7cfb\u7edf\u4e2d\u3002 \u7136\u540e\u4f60\u53ef\u4ee5\u76f4\u63a5\u5728\u6587\u4ef6\u7cfb\u7edf\u4e2d\u4fee\u6539\u6a21\u677f\u3002 \u5982\u679c\u4f60\u60f3\u5728\u4f60\u7684\u6837\u5f0f\u4e2d\u521b\u5efa\u4e00\u4e2a\u5b8c\u5168\u81ea\u5b9a\u4e49\u7684\u6a21\u677f\uff08\u5728\u6811\u72b6\u7ed3\u6784\u4e2d\u7684\u4efb\u4f55\u5176\u4ed6\u6837\u5f0f\u4e2d\u90fd\u4e0d\u5b58\u5728\uff09\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528\u540c\u6837\u7684\u547d\u4ee4\uff0c\u4f46\u4f60\u53ea\u9700\u8981\u4f20\u9012 --custom \u9009\u9879\uff1a Terminal $ php cmd.php xf-designer:touch-template [designer_mode_id] [template_type:template_title] --custom \u5176\u4ed6\u6709\u7528\u7684\u547d\u4ee4 \u00b6 \u8fd8\u6709\u5176\u4ed6\u4e00\u4e9b\u4e0e\u8bbe\u8ba1\u5e08\u6a21\u5f0f\u6709\u5173\u7684\u6709\u7528\u547d\u4ee4\uff1a \u4ece\u6570\u636e\u5e93\u4e2d\u5bfc\u51fa \u00b6 \u5f53\u8bbe\u8ba1\u5e08\u6a21\u5f0f\u88ab\u6fc0\u6d3b\u65f6\uff0c\u8fd9\u4e2a\u547d\u4ee4\u901a\u5e38\u4f1a\u81ea\u52a8\u8fd0\u884c\uff0c\u4f46\u5982\u679c\u51fa\u4e8e\u67d0\u79cd\u539f\u56e0\uff0c\u4f60\u60f3\u7528\u5f53\u524d\u6570\u636e\u5e93\u4e2d\u7684\u5185\u5bb9\u590d\u76d6\u6587\u4ef6\u7cfb\u7edf\u526f\u672c\uff0c\u90a3\u9ebd\u4f60\u53ef\u4ee5\u8fd0\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a Terminal $ php cmd.php xf-designer:export [designer_mode_id] \u4e5f\u53ef\u4ee5\u53ea\u5bfc\u51fa\u7279\u5b9a\u7684\u7c7b\u578b\uff0c\u4f8b\u5982 xf-designer:export-templates \u3002 \u4ece\u6587\u4ef6\u7cfb\u7edf\u5bfc\u5165 \u00b6 \u8fd9\u6761\u547d\u4ee4\u5c06\u7528\u6587\u4ef6\u7cfb\u7edf\u4e2d\u7684\u5185\u5bb9\u590d\u76d6\u6570\u636e\u5e93\u4e2d\u7684\u6837\u5f0f\u526f\u672c\uff1a Terminal $ php cmd.php xf-designer:import [designer_mode_id] \u4e5f\u53ef\u4ee5\u53ea\u5bfc\u5165\u7279\u5b9a\u7684\u7c7b\u578b\uff0c\u4f8b\u5982 xf-designer:import-templates \u3002 \u540c\u6b65\u6a21\u677f \u00b6 \u8be5\u547d\u4ee4\u7c7b\u4f3c\u4e8e\u5bfc\u5165\u6a21\u677f\uff08\u89c1\u4e0a\u6587\uff09\uff0c\u4f46\u5b83\u4e0d\u4f1a\u590d\u76d6\u6240\u6709\u5185\u5bb9\uff0c\u800c\u53ea\u4f1a\u5bfc\u5165\u6a21\u677f\uff0c\u5e76\u5728 metadata \u53d1\u751f\u53d8\u5316\u65f6\u91cd\u65b0\u7f16\u8bd1\u3002 \u5b83\u8fd8\u4f1a\u76f8\u5e94\u5730\u5e94\u7528\u7248\u672c\u53f7\u66f4\u65b0\u3002 Terminal $ php cmd.php xf-designer:sync-templates [designer_mode_id] \u8fd8\u539f\u6a21\u677f \u00b6 \u8fd9\u4e2a\u547d\u4ee4\u53ef\u4ee5\u7528\u6765\u6062\u590d\u6a21\u677f\uff0c\u6709\u6548\u5730\u4ece\u5f53\u524d\u6837\u5f0f\u4e2d\u5220\u9664\u81ea\u5b9a\u4e49\u7248\u672c\u3002 Terminal $ php cmd.php xf-designer:revert-template [designer_mode_id] [template_type:template_title] \u4e5f\u53ef\u4ee5\u901a\u8fc7\u4ece\u6587\u4ef6\u7cfb\u7edf\u4e2d\u5220\u9664\u6a21\u677f\u6765\u89e6\u53d1\u8fd8\u539f\u3002","title":"\u8bbe\u8ba1\u6837\u5f0f"},{"location":"designing-styles/#_1","text":"\u5728 XF2 \u4e2d\uff0c\u6211\u4eec\u5f15\u5165\u4e86\u4e00\u79cd\u5168\u65b0\u7684\u65b9\u5f0f\u6765\u521b\u5efa\u548c\u7f16\u8f91\u6837\u5f0f\uff0c\u79f0\u4e3a \"\u8bbe\u8ba1\u5e08\u6a21\u5f0f\"\u3002 \u8bbe\u8ba1\u5e08\u6a21\u5f0f\u662f\u4e00\u4e2a CLI \u5de5\u5177\u96c6\u5408\uff0c\u5141\u8bb8\u60a8\u76f4\u63a5\u5728\u6587\u4ef6\u7cfb\u7edf\u4e2d\u4fee\u6539\u6837\u5f0f\u4e2d\u7684\u67d0\u4e9b\u6a21\u677f\u3002 \u5b83\u8fd8\u8f93\u51fa\u5404\u79cd metadata \u548c\u6837\u5f0f\u5c5e\u6027\u4fe1\u606f\uff0c\u8fd9\u5bf9\u7248\u672c\u63a7\u5236\u548c\u534f\u540c\u5408\u4f5c\u975e\u5e38\u6709\u5e2e\u52a9\u3002","title":"\u8bbe\u8ba1\u6837\u5f0f"},{"location":"designing-styles/#_2","text":"\u5f00\u542f\u8bbe\u8ba1\u5e08\u6a21\u5f0f\u7684\u7b2c\u4e00\u6b65\u662f\u5728 config.php \u4e2d\u6fc0\u6d3b\u5b83\u3002 $config['designer']['enabled'] = true; \u60a8\u4e5f\u53ef\u4ee5\u9009\u62e9\u4e3a\u8bbe\u8ba1\u5668\u6a21\u5f0f\u6587\u4ef6\u6307\u5b9a\u4e0d\u540c\u7684\u8def\u5f84\u5b58\u5728\u4e8e\u6587\u4ef6\u7cfb\u7edf\u4e2d\u3002 \u4ee5\u4e0b\u662f\u9ed8\u8ba4\u8def\u5f84\u3002 \u8981\u6539\u53d8\u8def\u5f84\uff0c\u8bf7\u5728\u4f60\u7684 config.php \u4e2d\u6dfb\u52a0\u4ee5\u4e0b\u5185\u5bb9\uff0c\u5e76\u76f8\u5e94\u4fee\u6539\u8def\u5f84\u3002 $config['designer']['basePath'] = 'src/styles';","title":"\u5f00\u542f\u8bbe\u8ba1\u5e08\u6a21\u5f0f"},{"location":"designing-styles/#_3","text":"\u8bbe\u8ba1\u5e08\u6a21\u5f0f\u5fc5\u987b\u4e3a\u6bcf\u4e2a\u6837\u5f0f\u660e\u786e\u6fc0\u6d3b\u3002 \u6211\u4eec\u901a\u8fc7\u4f7f\u7528 CLI \u548c\u6307\u5b9a\u6837\u5f0f\u7684\u6837\u5f0f ID\uff0c\u5e76\u9009\u62e9 \"\u8bbe\u8ba1\u5e08\u6a21\u5f0f ID\" \u6765\u6fc0\u6d3b\u6837\u5f0f\u7684\u8bbe\u8ba1\u5e08\u6a21\u5f0f\uff1a Terminal $ php cmd.php xf-designer:enable [style_id] [designer_mode_id] \u8bbe\u8ba1\u5e08\u6a21\u5f0f ID \u662f\u672a\u6765\u4e0e\u8bbe\u8ba1\u5e08\u6a21\u5f0f\u76f8\u5173\u7684\u547d\u4ee4\u4e2d\u4f7f\u7528\u7684\u6807\u8bc6\u7b26\u3002 \u4e00\u65e6\u5f00\u542f\uff0c\u5f53\u524d\u4fee\u6539\u540e\u7684\u6837\u5f0f\u7ec4\u4ef6\u5c06\u88ab\u5bfc\u51fa\u5230 [basePath]/[designer_mode_id] \u76ee\u5f55\u4e2d\u3002 \u5f53\u5f00\u542f\u8be5\u6837\u5f0f\u7684\u8bbe\u8ba1\u5e08\u6a21\u5f0f\u65f6\uff0c\u5982\u679c\u8be5\u76ee\u5f55\u5df2\u7ecf\u5b58\u5728\uff0c\u4f60\u4f1a\u6709\u4e00\u4e2a\u9009\u62e9\uff0c\u5373\u6211\u4eec\u662f\u5426\u5e94\u8be5\u4ece\u6837\u5f0f\u4e2d\u590d\u76d6\u8be5\u76ee\u5f55\u7684\u5f53\u524d\u5185\u5bb9\uff0c\u6216\u8005\u662f\u5426\u5e94\u8be5\u4ece\u8be5\u76ee\u5f55\u7684\u5f53\u524d\u5185\u5bb9\u4e2d\u590d\u76d6\u5f53\u524d\u6837\u5f0f\u3002","title":"\u5f00\u542f\u6837\u5f0f\u8bbe\u8ba1\u5e08\u6a21\u5f0f"},{"location":"designing-styles/#_4","text":"\u8981\u5173\u95ed\u67d0\u4e2a\u6837\u5f0f\u7684\u8bbe\u8ba1\u5e08\u6a21\u5f0f\uff0c\u60a8\u53ea\u9700\u8fd0\u884c\u4ee5\u4e0b CLI \u547d\u4ee4\u3002 Terminal $ php cmd.php xf-designer:disable [designer_mode_id] \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u8fd9\u5c06\u5728\u6587\u4ef6\u7cfb\u7edf\u4e2d\u4fdd\u7559\u8bbe\u8ba1\u5e08\u6a21\u5f0f\u7684\u8f93\u51fa\u526f\u672c\u3002 \u8981\u5220\u9664\u6570\u636e\uff0c\u4f60\u53ef\u4ee5\u7528 --clear \u9009\u9879\u8fd0\u884c\u540c\u6837\u7684\u547d\u4ee4\u3002 Terminal $ php cmd.php xf-designer:disable [designer_mode_id] --clear","title":"\u5173\u95ed\u6837\u5f0f\u8bbe\u8ba1\u5e08\u6a21\u5f0f"},{"location":"designing-styles/#_5","text":"\u91cd\u8981\u7684\u662f\u8981\u8bb0\u4f4f\uff0cXF \u4e2d\u7684\u6837\u5f0f\u53ea\u7531\u5728\u8be5\u6837\u5f0f\u4e2d \u4fee\u6539\u7684\u5185\u5bb9 \u7ec4\u6210\u3002 \u8fd9\u610f\u5473\u7740\u8bbe\u8ba1\u5e08\u6a21\u5f0f\u7684\u8f93\u51fa\u5c06\u53ea\u5305\u62ec\u5728\u6837\u5f0f\u4e2d\u88ab\u4fee\u6539\u7684\u5185\u5bb9\u3002 \u5728\u7236\u6837\u5f0f\u4e2d\u88ab\u4fee\u6539\u7684\u6a21\u677f\u548c\u6837\u5f0f\u5c5e\u6027\u4e0d\u4f1a\u88ab\u8f93\u51fa\u3002","title":"\u4ec0\u9ebd\u662f\u8f93\u51fa\uff0c\u5728\u54ea\u91cc\u8f93\u51fa\uff1f"},{"location":"designing-styles/#_6","text":"\u6a21\u677f\u5c06\u88ab\u8f93\u51fa\u5230 [basePath]/[designer_mode_id]/templates \u76ee\u5f55\u4e2d\u3002 \u5728\u8be5\u76ee\u5f55\u4e2d\uff0c\u60a8\u53ef\u4ee5\u4e3a\u6bcf\u79cd\u7c7b\u578b\uff08\u5982 admin\u3001email \u548c public\uff09\u8bbe\u7f6e\u53e6\u4e00\u4e2a\u76ee\u5f55\u3002 \u6a21\u677f\u5c06\u4ee5 HTML \u683c\u5f0f\u8f93\u51fa\uff0c\u5e76\u53ef\u5728\u6587\u4ef6\u7cfb\u7edf\u4e2d\u76f4\u63a5\u7f16\u8f91\u3002 \u5728\u6587\u4ef6\u7cfb\u7edf\u4e0a\u6240\u505a\u7684\u66f4\u6539\u4f1a\u5728\u8be5\u6a21\u677f\u52a0\u8f7d\u5230\u9875\u9762\u65f6\u88ab\u5bfc\u5165\u5e76\u7f16\u8bd1\u3002 \u540c\u6837\uff0c\u60a8\u4e5f\u53ef\u4ee5\u901a\u8fc7\u4ece\u6587\u4ef6\u7cfb\u7edf\u4e2d\u5220\u9664\u6a21\u677f\uff08\u5982\u679c\u5b83\u4ee5\u524d\u88ab\u4fee\u6539\u8fc7\uff09\u6765\u6062\u590d\u5b83\u3002","title":"\u6a21\u677f"},{"location":"designing-styles/#_7","text":"\u6837\u5f0f\u5c5e\u6027\u548c\u7fa4\u7ec4\u5c06\u88ab\u8f93\u51fa\u5230 [basePath]/[designer_mode_id]/style_properties \u548c [basePath]/[designer_mode_id]/style_property_groups \u76ee\u5f55\u4e0b\u3002 \u5b83\u4eec\u4ee5 JSON \u683c\u5f0f\u5bfc\u51fa\uff0c\u4f5c\u4e3a\u4e00\u79cd\u6709\u7528\u7684\u65b9\u5f0f\uff0c\u901a\u8fc7\u7248\u672c\u63a7\u5236\u7cfb\u7edf\u76d1\u63a7\u8fd9\u4e9b\u6587\u4ef6\u7684\u53d8\u5316\u3002 \u4e0d\u5efa\u8bae\u76f4\u63a5\u4fee\u6539\u8fd9\u4e9b\u6587\u4ef6\uff0c\u56e0\u4e3a\u5bf9\u5b83\u4eec\u7684\u4fee\u6539 \u4e0d\u4f1a \u50cf\u6a21\u677f\u90a3\u6837\u81ea\u52a8\u5bfc\u5165\u3002","title":"\u6837\u5f0f\u5c5e\u6027\u548c\u7fa4\u7ec4"},{"location":"designing-styles/#_8","text":"\u8003\u8651\u5230\u4e00\u4e2a\u6837\u5f0f\u53ea\u4ee3\u8868\u5728\u8be5\u6837\u5f0f\u4e2d\u88ab\u4fee\u6539\u7684\u7ec4\u4ef6\uff0c\u5f53\u8bbe\u8ba1\u5e08\u6a21\u5f0f\u5f00\u542f\u65f6\uff0c\u6587\u4ef6\u7cfb\u7edf\u4e5f\u5c06\u53ea\u5305\u542b\u5728\u8be5\u6837\u5f0f\u4e2d\u88ab\u4fee\u6539\u7684\u7ec4\u4ef6\u3002 \u8fd9\u6837\u5c31\u65e0\u6cd5\u8f93\u51fa\u6bcf\u4e2a\u6a21\u677f\u548c\u6837\u5f0f\u5c5e\u6027\u7684\u6709\u6548\u7248\u672c\u3002 \u8981\u5c06\u4e00\u4e2a\u6a21\u677f\u6807\u8bb0\u4e3a\u6837\u5f0f\u4e2d\u5df2\u4fee\u6539\u7684\uff0c\u60a8\u53ef\u4ee5\u901a\u8fc7\u5728 Admin CP \u4e2d\u7f16\u8f91\u5b83\u7684\u5e38\u89c4\u65b9\u5f0f\u8fdb\u884c\u3002 \u5982\u679c\u6fc0\u6d3b\u4e86\u8bbe\u8ba1\u5668\u6a21\u5f0f\uff0c\u5728 Admin CP \u4e2d\u4fee\u6539\u7684\u6a21\u677f\u548c\u6837\u5f0f\u5c5e\u6027\u5c06\u81ea\u52a8\u5199\u5165\u6587\u4ef6\u7cfb\u7edf\u3002 \u7136\u800c\uff0c\u4f7f\u7528 CLI \u547d\u4ee4\u6765\u4fee\u6539\u6216 \"touch\" \u4e00\u4e2a\u6a21\u677f\u53ef\u80fd\u4f1a\u66f4\u65b9\u4fbf\u3002 Terminal $ php cmd.php xf-designer:touch-template [designer_mode_id] [template_type:template_title] \u53ea\u8981\u6307\u5b9a\u7684\u6a21\u677f\u5b58\u5728\u4e8e\u7236\u6837\u5f0f\u6216\u4e3b\u6837\u5f0f\u4e2d\uff0c\u5b83\u5c31\u4f1a\u88ab\u590d\u5236\u5230\u5f53\u524d\u6837\u5f0f\u4e2d\uff0c\u5e76\u8f93\u51fa\u5230\u6587\u4ef6\u7cfb\u7edf\u4e2d\u3002 \u7136\u540e\u4f60\u53ef\u4ee5\u76f4\u63a5\u5728\u6587\u4ef6\u7cfb\u7edf\u4e2d\u4fee\u6539\u6a21\u677f\u3002 \u5982\u679c\u4f60\u60f3\u5728\u4f60\u7684\u6837\u5f0f\u4e2d\u521b\u5efa\u4e00\u4e2a\u5b8c\u5168\u81ea\u5b9a\u4e49\u7684\u6a21\u677f\uff08\u5728\u6811\u72b6\u7ed3\u6784\u4e2d\u7684\u4efb\u4f55\u5176\u4ed6\u6837\u5f0f\u4e2d\u90fd\u4e0d\u5b58\u5728\uff09\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528\u540c\u6837\u7684\u547d\u4ee4\uff0c\u4f46\u4f60\u53ea\u9700\u8981\u4f20\u9012 --custom \u9009\u9879\uff1a Terminal $ php cmd.php xf-designer:touch-template [designer_mode_id] [template_type:template_title] --custom","title":"\u4fee\u6539\u7279\u5b9a\u6a21\u677f"},{"location":"designing-styles/#_9","text":"\u8fd8\u6709\u5176\u4ed6\u4e00\u4e9b\u4e0e\u8bbe\u8ba1\u5e08\u6a21\u5f0f\u6709\u5173\u7684\u6709\u7528\u547d\u4ee4\uff1a","title":"\u5176\u4ed6\u6709\u7528\u7684\u547d\u4ee4"},{"location":"designing-styles/#_10","text":"\u5f53\u8bbe\u8ba1\u5e08\u6a21\u5f0f\u88ab\u6fc0\u6d3b\u65f6\uff0c\u8fd9\u4e2a\u547d\u4ee4\u901a\u5e38\u4f1a\u81ea\u52a8\u8fd0\u884c\uff0c\u4f46\u5982\u679c\u51fa\u4e8e\u67d0\u79cd\u539f\u56e0\uff0c\u4f60\u60f3\u7528\u5f53\u524d\u6570\u636e\u5e93\u4e2d\u7684\u5185\u5bb9\u590d\u76d6\u6587\u4ef6\u7cfb\u7edf\u526f\u672c\uff0c\u90a3\u9ebd\u4f60\u53ef\u4ee5\u8fd0\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a Terminal $ php cmd.php xf-designer:export [designer_mode_id] \u4e5f\u53ef\u4ee5\u53ea\u5bfc\u51fa\u7279\u5b9a\u7684\u7c7b\u578b\uff0c\u4f8b\u5982 xf-designer:export-templates \u3002","title":"\u4ece\u6570\u636e\u5e93\u4e2d\u5bfc\u51fa"},{"location":"designing-styles/#_11","text":"\u8fd9\u6761\u547d\u4ee4\u5c06\u7528\u6587\u4ef6\u7cfb\u7edf\u4e2d\u7684\u5185\u5bb9\u590d\u76d6\u6570\u636e\u5e93\u4e2d\u7684\u6837\u5f0f\u526f\u672c\uff1a Terminal $ php cmd.php xf-designer:import [designer_mode_id] \u4e5f\u53ef\u4ee5\u53ea\u5bfc\u5165\u7279\u5b9a\u7684\u7c7b\u578b\uff0c\u4f8b\u5982 xf-designer:import-templates \u3002","title":"\u4ece\u6587\u4ef6\u7cfb\u7edf\u5bfc\u5165"},{"location":"designing-styles/#_12","text":"\u8be5\u547d\u4ee4\u7c7b\u4f3c\u4e8e\u5bfc\u5165\u6a21\u677f\uff08\u89c1\u4e0a\u6587\uff09\uff0c\u4f46\u5b83\u4e0d\u4f1a\u590d\u76d6\u6240\u6709\u5185\u5bb9\uff0c\u800c\u53ea\u4f1a\u5bfc\u5165\u6a21\u677f\uff0c\u5e76\u5728 metadata \u53d1\u751f\u53d8\u5316\u65f6\u91cd\u65b0\u7f16\u8bd1\u3002 \u5b83\u8fd8\u4f1a\u76f8\u5e94\u5730\u5e94\u7528\u7248\u672c\u53f7\u66f4\u65b0\u3002 Terminal $ php cmd.php xf-designer:sync-templates [designer_mode_id]","title":"\u540c\u6b65\u6a21\u677f"},{"location":"designing-styles/#_13","text":"\u8fd9\u4e2a\u547d\u4ee4\u53ef\u4ee5\u7528\u6765\u6062\u590d\u6a21\u677f\uff0c\u6709\u6548\u5730\u4ece\u5f53\u524d\u6837\u5f0f\u4e2d\u5220\u9664\u81ea\u5b9a\u4e49\u7248\u672c\u3002 Terminal $ php cmd.php xf-designer:revert-template [designer_mode_id] [template_type:template_title] \u4e5f\u53ef\u4ee5\u901a\u8fc7\u4ece\u6587\u4ef6\u7cfb\u7edf\u4e2d\u5220\u9664\u6a21\u677f\u6765\u89e6\u53d1\u8fd8\u539f\u3002","title":"\u8fd8\u539f\u6a21\u677f"},{"location":"development-tools/","text":"\u5f00\u53d1\u5de5\u5177 \u00b6 XF2 \u4e3a\u5f00\u53d1\u8005\u63d0\u4f9b\u4e86\u5927\u91cf\u7684\u5185\u7f6e\u5de5\u5177\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528\u8fd9\u4e9b\u5de5\u5177\u6765\u52a0\u5feb\u9644\u52a0\u7ec4\u4ef6\u7684\u5f00\u53d1\uff0c\u4e0b\u9762\u6211\u4eec\u5c06\u4ecb\u7ecd\u5176\u4e2d\u7684\u4e00\u4e9b\u3002 \u8c03\u8bd5\u6a21\u5f0f \u00b6 \u8c03\u8bd5\u6a21\u5f0f\u53ef\u4ee5\u5728\u4f60\u7684 config.php \u4e2d\u6fc0\u6d3b\uff0c\u8fd9\u5c06\u5141\u8bb8\u4f60\u8bbf\u95ee Admin CP \u4e2d\u7684\u67d0\u4e9b\u5f00\u53d1\u5de5\u5177\uff08\u5982\u521b\u5efa\u8def\u7531\uff0c\u6743\u9650\uff0c\u7ba1\u7406\u5bfc\u89c8\u7b49\uff09\uff0c\u5b83\u8fd8\u5c06\u5728\u6bcf\u4e2a\u9875\u9762\u7684\u5e95\u90e8\u6fc0\u6d3b\u4e00\u4e2a\u63a7\u5236\u53f0\u8f93\u51fa\uff0c\u8be6\u7ec6\u8bf4\u660e\u9875\u9762\u5904\u7406\u7684\u65f6\u95f4\uff0c\u6709\u591a\u5c11\u67e5\u627e\u88ab\u8fd0\u884c\u6765\u55a7\u67d3\u9875\u9762\u548c\u4f7f\u7528\u4e86\u591a\u5c11\u5185\u5b58\u3002 \u60ac\u505c\u65f6\uff0c\u4f1a\u6709\u4e00\u4e2a\u5305\u542b\u5f53\u524d Controller\u3001 Action \u548c\u6a21\u677f\u540d\u79f0\u7b49\u4fe1\u606f\u7684\u5de5\u5177\u63d0\u793a\u3002 \u4f60\u4e5f\u53ef\u4ee5\u70b9\u51fb\u65f6\u95f4\u8f93\u51fa\uff0c\u8fd9\u5c06\u8ba9\u4f60\u8be6\u7ec6\u4e86\u89e3\u5230\u5e95\u8fd0\u884c\u4e86\u54ea\u4e9b\u67e5\u627e\uff0c\u4ee5\u53ca\u5bfc\u81f4\u8be5\u67e5\u627e\u88ab\u8fd0\u884c\u7684\u5806\u6808\u8ffd\u8e2a\u3002 \u4f60\u53ef\u4ee5\u901a\u8fc7\u5728 config.php \u4e2d\u6dfb\u52a0\u4ee5\u4e0b\u5185\u5bb9\u6765\u6fc0\u6d3b\u8c03\u8bd5\u6a21\u5f0f\uff1a $config['debug'] = true; \u6fc0\u6d3b\u5f00\u53d1\u6a21\u5f0f \u00b6 \u5f00\u53d1\u6a21\u5f0f\u662f\u4e00\u79cd\u7279\u6b8a\u7684\u6a21\u5f0f\uff0c\u5728\u60a8\u7684 config.php \u6587\u4ef6\u4e2d\u6fc0\u6d3b\uff0c\u5b83\u5c06\u89e6\u53d1 XF \u81ea\u52a8\u5c06\u60a8\u7684\u5f00\u53d1\u6587\u4ef6\u5199\u5165 _output \u76ee\u5f55\u3002 \u8fd9\u4e2a\u6a21\u5f0f\u9700\u8981\u5728\u6587\u4ef6\u7cfb\u7edf\u6a21\u677f\u7f16\u8f91\u65f6\u6fc0\u6d3b\u3002 \u7531\u4e8e\u5f00\u53d1\u6a21\u5f0f\u4f1a\u5c06\u6587\u4ef6\u5199\u5165\u4f60\u7684\u6587\u4ef6\u7cfb\u7edf\uff0c\u786e\u4fdd\u4f60\u6709\u9002\u5f53\u7684\u6587\u4ef6\u6743\u9650\u662f\u5f88\u91cd\u8981\u7684\u3002 \u8fd9\u53ef\u80fd\u4f1a\u6839\u636e\u73af\u5883\u7684\u4e0d\u540c\u800c\u6709\u6240\u4e0d\u540c\uff0c\u4f46\u5178\u578b\u7684\u914d\u7f6e\u662f\u786e\u4fdd\u4f60\u6b63\u5728\u4f7f\u7528\u7684\u4efb\u4f55\u9644\u52a0\u7ec4\u4ef6\u7684 _output \u76ee\u5f55\u7684 chmod \u8bbe\u7f6e\u4e3a 0777 \u3002 \u4f8b\u5982\uff0c\u5982\u679c\u4f60\u6b63\u5728\u4f7f\u7528\u4e00\u4e2a ID \u4e3a Demo \u7684\u9644\u52a0\u7ec4\u4ef6\uff0c\u5b83\u7684\u5f00\u53d1\u8f93\u51fa\u5c06\u88ab\u5199\u5165\u5230 src/addons/Demo/_output \uff0c\u56e0\u6b64\u8be5\u76ee\u5f55\u9700\u8981\u662f\u5b8c\u5168\u53ef\u5199\u7684\u3002 \u6fc0\u6d3b\u5f00\u53d1\u6a21\u5f0f\uff0c\u4e5f\u4f1a\u81ea\u52a8\u6fc0\u6d3b \u8c03\u8bd5\u6a21\u5f0f \u3002 \u8981\u6fc0\u6d3b\u5f00\u53d1\u6a21\u5f0f\uff0c\u8bf7\u5728\u4f60\u7684 config.php \u6587\u4ef6\u4e2d\u6dfb\u52a0\u4ee5\u4e0b\u884c\uff1a $config['development']['enabled'] = true; $config['development']['defaultAddOn'] = 'SomeCompany/MyAddOn'; defaultAddOn \u503c\u662f\u53ef\u9009\u7684\uff0c\u4f46\u5f53\u521b\u5efa\u65b0\u5185\u5bb9\u65f6\uff0c\u6dfb\u52a0\u8be5\u503c\u4f1a\u5728 XF Admin CP \u4e2d\u81ea\u52a8\u586b\u5145\u6307\u5b9a\u7684\u9644\u52a0\u7ec4\u4ef6\uff0c\u8be5\u9644\u52a0\u7ec4\u4ef6\u5c06\u4e0e\u9644\u52a0\u7ec4\u4ef6\u76f8\u5173\u8054\u3002 \u9664\u4e86\u4e0a\u8ff0\uff0c\u4f60\u53ef\u80fd\u4f1a\u53d1\u73b0\u6709\u5fc5\u8981\u6dfb\u52a0\u4e00\u4e9b\u989d\u5916\u7684\u914d\u7f6e\uff0c\u7279\u522b\u662f\u5f53\u4f60\u4f7f\u7528\u591a\u4e2a XF \u5b89\u88c5\u65f6\u3002 $config['enableMail'] = false; \u8fd9\u5c06\u5173\u95ed\u6240\u6709\u4ece\u60a8\u7684\u8bba\u575b\u53d1\u9001\u7684\u90ae\u4ef6\u3002 \u5982\u679c\u60a8\u4f7f\u7528\u7684\u662f\u771f\u5b9e\u7528\u6237\u548c\u771f\u5b9e\u90ae\u4ef6\u5730\u5740\u7684\u5b9e\u65f6\u6570\u636e\u526f\u672c\uff0c\u8fd9\u4e00\u70b9\u5c24\u4e3a\u91cd\u8981\uff08\u5c3d\u7ba1\u6211\u4eec\u5efa\u8bae\u4e0d\u8981\u8fd9\u6837\u505a\uff01\uff09\u3002 \u9664\u4e86\u76f4\u63a5\u5173\u95ed\u90ae\u4ef6\u4e4b\u5916, \u60a8\u53ef\u4ee5\u8003\u8651\u4f7f\u7528\u4e00\u4e2a\u670d\u52a1, \u4f8b\u5982 MailTrap.io \u3002 \u8fd9\u5c06\u4e3a\u60a8\u63d0\u4f9b\u4e00\u4e2a\u514d\u8d39\u7684\u90ae\u7bb1\uff0c\u53ef\u4ee5\u63a5\u53ce\u6240\u6709\u4ece\u60a8\u7684\u8bba\u575b\u53d1\u9001\u7684\u90ae\u4ef6\uff0c\u8fd9\u5bf9\u4e8e\u6d4b\u8bd5\u60a8\u7684\u65b0\u9644\u52a0\u7ec4\u4ef6\u53ef\u80fd\u53d1\u9001\u7684\u4efb\u4f55\u7535\u5b50\u90ae\u4ef6\u975e\u5e38\u6709\u7528\u3002 $config['cookie']['prefix'] = 'anything_'; \u5982\u679c\u60a8\u5728\u540c\u4e00\u57df\u540d\u4e0a\u4f7f\u7528\u4e24\u4e2a\u6216\u66f4\u591a\u7684 XF \u5b89\u88c5\uff0c\u60a8\u53ef\u80fd\u4f1a\u9047\u5230 Cookie \u88ab\u590d\u76d6\u7684\u95ee\u9898\uff0c\u8fd9\u662f\u7531\u5b89\u88c5\u5171\u4eab\u76f8\u540c\u7684 Cookie \u524d\u7f00\u5f15\u8d77\u7684\u3002 \u56e0\u6b64\uff0c\u5efa\u8bae\u60a8\u786e\u4fdd\u4e3a\u60a8\u8bbe\u7f6e\u7684\u6bcf\u4e2a XF \u5b89\u88c5\u66f4\u6539 Cookie \u524d\u7f00\u3002 \u5982\u679c\u4e0d\u8fd9\u6837\u505a\uff0c\u60a8\u5c06\u4f1a\u9047\u5230\u4e00\u4e9b\u95ee\u9898\uff0c\u4f8b\u5982\uff0c\u5f53\u767b\u5f55\u5230\u53e6\u4e00\u4e2a XF \u5b89\u88c5\u65f6\uff0c\u4f1a\u88ab\u6ce8\u9500\u3002 \u5f00\u53d1\u547d\u4ee4 \u00b6 XF 2.0 \u63d0\u4f9b\u4e86\u4e00\u4e9b\u901a\u7528\u7684\u5f00\u53d1\u548c\u9644\u52a0\u7ec4\u4ef6\u7684 CLI \u547d\u4ee4\uff0c\u8fd9\u4e9b\u547d\u4ee4\u7684\u76ee\u7684\u662f\u5e2e\u52a9\u60a8\u66f4\u6709\u6548\u5730\u5f00\u53d1\uff0c\u751a\u81f3\u53ef\u80fd\u4f7f\u4e00\u4e9b\u5e38\u89c1\u7684\u8fc7\u7a0b\u81ea\u52a8\u5316/\u811a\u672c\u5316\u3002 \u5728\u672c\u8282\u4e2d\uff0c\u6211\u4eec\u5c06\u4ecb\u7ecd\u4e00\u4e9b\u5e38\u7528\u7684\u5de5\u5177\uff0c\u5e76\u89e3\u91ca\u5b83\u4eec\u7684\u4f5c\u7528\u3002 \u9644\u52a0\u7ec4\u4ef6\u7279\u5b9a\u547d\u4ee4 \u00b6 \u65b0\u5efa\u4e00\u4e2a\u9644\u52a0\u7ec4\u4ef6 \u00b6 Terminal $ php cmd.php xf-addon:create xf-addon:create \u547d\u4ee4\u662f\u5982\u4f55\u521d\u59cb\u8bbe\u7f6e\u548c\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u9644\u52a0\u7ec4\u4ef6\u3002 \u4e00\u65e6\u5b83\u8fd0\u884c\uff0c\u4f60\u53ea\u9700\u8981\u56de\u7b54\u4e00\u4e9b\u57fa\u672c\u95ee\u9898\uff1a \u8f93\u5165\u6b64\u9644\u52a0\u7ec4\u4ef6\u7684 ID \u8f93\u5165\u6807\u9898 \u8f93\u5165\u7248\u672c ID\uff08\u5982 1000010 \uff09\u3002 \u8f93\u5165\u7248\u672c\u5b57\u7b26\u4e32\uff08\u5982 1.0.0 Alpha\uff09\u3002 \u7136\u540e\u4f60\u4f1a\u5f97\u5230\u4e00\u4e2a\u9009\u9879\u6765\u521b\u5efa\u9644\u52a0\u7ec4\u4ef6\u5e76\u5199\u51fa\u5b83\u7684 addon.json \u6587\u4ef6\uff0c\u5e76\u8be2\u95ee\u4f60\u4e00\u4e9b\u5173\u4e8e\u662f\u5426\u8981\u6dfb\u52a0 Setup.php \u6587\u4ef6\u7684\u95ee\u9898\u3002 \u5bfc\u51fa _data .XML \u6587\u4ef6 \u00b6 Terminal $ php cmd.php xf-addon:export [addon_id] \u8fd9\u6761\u547d\u4ee4\u5c06\u7528\u4e8e\u5bfc\u51fa\u6240\u6709\u9644\u52a0\u7ec4\u4ef6\u7684\u6570\u636e\u5230 _data \u76ee\u5f55\u4e0b\u7684 XML \u6587\u4ef6\u3002 \u5b83\u4ece\u5f53\u524d\u6570\u636e\u5e93\u4e2d\u5bfc\u51fa\u6570\u636e\uff08\u800c\u4e0d\u662f\u4ece\u5f00\u53d1\u8f93\u51fa\u6587\u4ef6\u4e2d\u5bfc\u51fa\uff09\u3002 \u5347\u7ea7\u60a8\u7684\u9644\u52a0\u7ec4\u4ef6\u7248\u672c \u00b6 Terminal $ php cmd.php xf-addon:bump-version [addon_id] --version-id 1020370 --version-string 1.2.3 Note \u5982\u679c\u4f60\u7684\u7248\u672c\u5b57\u7b26\u4e32\u5305\u542b\u7a7a\u683c\uff0c\u4f60\u9700\u8981\u7528\u5f15\u53f7\u5c06\u5176\u5305\u56f4\u3002 \u8be5\u547d\u4ee4\u83b7\u53d6\u60a8\u7684\u9644\u52a0\u7ec4\u4ef6\u7684\u9644\u52a0\u7ec4\u4ef6 ID\u3001\u65b0\u7248\u672c ID \u548c\u65b0\u7248\u672c\u5b57\u7b26\u4e32\u3002 \u8fd9\u6837\u60a8\u5c31\u53ef\u4ee5\u8f7b\u677e\u5b8c\u6210\u5347\u7ea7\u9644\u52a0\u7ec4\u4ef6\u7684\u7248\u672c\uff0c\u800c\u65e0\u9700\u81ea\u5df1\u8fd0\u884c\u5347\u7ea7\u548c\u91cd\u5efa\u3002 \u4e0a\u9762\u7684\u9009\u9879\u662f\u53ef\u9009\u7684\uff0c\u5982\u679c\u6ca1\u6709\u63d0\u4f9b\u8fd9\u4e9b\u9009\u9879\uff0c\u7cfb\u7edf\u4f1a\u63d0\u793a\u60a8\u8f93\u5165\u3002 \u5982\u679c\u60a8\u53ea\u6307\u5b9a\u7248\u672c ID\uff0c\u5982\u679c\u5b83\u7b26\u5408\u6211\u4eec \u63a8\u8350\u7684\u7248\u672cID\u683c\u5f0f \uff0c\u6211\u4eec\u5c06\u5c1d\u8bd5\u5e76\u81ea\u52a8\u4ece\u4e2d\u63a8\u65ad\u51fa\u6b63\u786e\u7684\u7248\u672c\u5b57\u7b26\u4e32\u3002 \u4e00\u65e6\u547d\u4ee4\u5b8c\u6210\uff0c\u5b83\u5c06\u81ea\u52a8\u66f4\u65b0 addon.json \u6587\u4ef6\u548c\u6570\u636e\u5e93\uff0c\u5e76\u63d0\u4f9b\u6b63\u786e\u7684\u7248\u672c\u8be6\u7ec6\u4fe1\u606f\u3002 \u540c\u6b65\u4f60\u7684 addon.json \u5230\u6570\u636e\u5e93 \u00b6 Terminal $ php cmd.php xf-addon:sync-json [addon_id] \u6709\u65f6\u4f60\u53ef\u80fd\u66f4\u559c\u6b22\u76f4\u63a5\u7f16\u8f91 JSON \u6587\u4ef6\u4e2d\u7684\u67d0\u4e9b\u7ec6\u8282\uff0c\u8fd9\u53ef\u80fd\u662f\u7248\u672c\uff0c\u6216\u65b0\u7684\u56fe\u6807\uff0c\u6216\u66f4\u6539\u6807\u9898\u6216\u63cf\u8ff0\u3002 \u4ee5\u8fd9\u79cd\u65b9\u5f0f\u66f4\u6539 JSON \u53ef\u80fd\u4f1a\u5bfc\u81f4\u9644\u52a0\u7ec4\u4ef6\u7cfb\u7edf\u8ba4\u4e3a\u6709\u5f85\u5b9a\u7684\u66f4\u6539\u6216\u9644\u52a0\u7ec4\u4ef6\u662f\u53ef\u5347\u7ea7\u7684\u3002 \u5982\u679c\u60a8\u5c1a\u672a\u5bfc\u51fa\u5f53\u524d\u6570\u636e\uff0c\u5219\u91cd\u5efa\u6216\u5347\u7ea7\u53ef\u80fd\u662f\u4e00\u79cd\u7834\u574f\u6027\u7684\u64cd\u4f5c\u3002 \u56e0\u6b64\uff0c\u5efa\u8bae\u8fd0\u884c\u6b64\u547d\u4ee4\u4f5c\u4e3a\u5bfc\u5165\u8be5\u6570\u636e\u7684\u65b9\u5f0f\uff0c\u800c\u4e0d\u5f71\u54cd\u60a8\u7684\u73b0\u6709\u6570\u636e\u3002 \u9a8c\u8bc1\u60a8\u7684 addon.json \u6587\u4ef6 \u00b6 Terminal $ php cmd.php xf-addon:validate-json [addon_id] \u5982\u679c\u4f60\u60f3\u68c0\u67e5\u4f60\u7684 JSON \u6587\u4ef6\u662f\u5426\u5305\u542b\u6b63\u786e\u7684\u5185\u5bb9\u548c\u6b63\u786e\u7684\u683c\u5f0f\uff0c\u4f60\u73b0\u5728\u53ef\u4ee5\u9a8c\u8bc1\u5b83\u3002 \u9a8c\u8bc1\u5668\u5c06\u68c0\u67e5\u5185\u5bb9\u662f\u5426\u53ef\u4ee5\u89e3\u7801\uff0c\u662f\u5426\u5305\u542b\u6240\u6709\u6b63\u786e\u7684\u5fc5\u586b\u5b57\u6bb5\uff08\u5982\u6807\u9898\u548c\u7248\u672c ID \uff09\uff0c\u8fd8\u68c0\u67e5\u662f\u5426\u5b58\u5728\u53ef\u9009\u7684 Key\uff08\u5982\u63cf\u8ff0\u548c\u56fe\u6807\uff09\u3002 \u5982\u679c\u6709\u4efb\u4f55 Key \u4e22\u5931\uff0c\u6211\u4eec\u5c06\u4e3a\u60a8\u63d0\u4f9b\u4fee\u590d\u95ee\u9898\u7684\u670d\u52a1\u3002 \u6211\u4eec\u8fd8\u68c0\u67e5 JSON \u6587\u4ef6\u4e2d\u662f\u5426\u6709\u4efb\u4f55\u610f\u5916\u7684\u5b57\u6bb5\u3002 \u8fd9\u4e9b\u53ef\u80fd\u662f\u6545\u610f\u7684\uff0c\u4e5f\u53ef\u80fd\u662f\u9519\u522b\u5b57\u3002 \u60a8\u53ef\u4ee5\u624b\u52a8\u8fd0\u884c\u8be5\u547d\u4ee4\uff0c\u6216\u8005\u5728\u6784\u5efa\u53d1\u884c\u7248\u65f6\u81ea\u52a8\u8fd0\u884c\u8be5\u547d\u4ee4\u3002 \u8fd0\u884c\u7279\u5b9a\u7684\u8bbe\u7f6e\u6b65\u9aa4 \u00b6 \u6709\u65f6\uff0c\u65e0\u9700\u8fdb\u884c\u5378\u8f7d\u548c\u91cd\u65b0\u5b89\u88c5\u8fc7\u7a0b\u5373\u53ef\u68c0\u67e5 Setup class \u6b65\u9aa4\u662f\u5426\u6b63\u5e38\u8fd0\u884c\uff0c\u8fd9\u662f\u5f88\u6709\u5e2e\u52a9\u7684\u3002 \u6709\u4e09\u6761\u547d\u4ee4\u53ef\u4ee5\u5e2e\u52a9\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0c\u8fd9\u4e9b\u547d\u4ee4\u53ea\u9002\u7528\u4e8e\u4f7f\u7528\u9ed8\u8ba4\u7684 StepRunner \u7279\u6027\u521b\u5efa\u7684 Setup class\u3002 \u8fd0\u884c\u5b89\u88c5\u6b65\u9aa4 \u00b6 Terminal $ php cmd.php xf-addon:install-step [addon_id] [step] \u8fd0\u884c\u5347\u7ea7\u6b65\u9aa4 \u00b6 Terminal $ php cmd.php xf-addon:upgrade-step [addon_id] [version] [step] \u8fd0\u884c\u5378\u8f7d\u6b65\u9aa4 \u00b6 Terminal $ php cmd.php xf-addon:uninstall-step [addon_id] [step] \u6784\u5efa\u9644\u52a0\u7ec4\u4ef6\u53d1\u884c\u7248 \u00b6 \u4e00\u65e6\u6240\u6709\u7684\u8270\u82e6\u5de5\u4f5c\u90fd\u5b8c\u6210\u4e86\uff0c\u5f88\u9057\u64bc\uff0c\u5728\u771f\u6b63\u53d1\u5e03\u4e4b\u524d\u8fd8\u8981\u7ecf\u5386\u4e00\u4e9b\u5176\u4ed6\u7684\u8fc7\u7a0b\u3002 \u5373\u4f7f\u662f\u5c06\u6240\u6709\u7684\u6587\u4ef6\u53ce\u96c6\u5230\u6b63\u786e\u7684\u5730\u65b9\uff0c\u5e76\u624b\u52a8\u521b\u5efa ZIP \u6587\u4ef6\u7684\u8fc7\u7a0b\u4e5f\u662f\u5f88\u8017\u65f6\u7684\uff0c\u800c\u4e14\u5bb9\u6613\u51fa\u73b0\u9519\u8bef\u3002 \u6211\u4eec\u53ef\u4ee5\u81ea\u52a8\u5904\u7406\u8fd9\u4e9b\u95ee\u9898\uff0c\u5305\u62ec\u7528\u4e00\u4e2a\u7b80\u5358\u7684\u547d\u4ee4\u751f\u6210 hash.json \u6587\u4ef6\u3002 Terminal $ php cmd.php xf-addon:build-release [addon_id] \u5f53\u4f60\u8fd0\u884c\u8fd9\u4e2a\u547d\u4ee4\u65f6\uff0c\u5b83\u4f1a\u5148\u8fd0\u884c xf-addon:export \u547d\u4ee4\uff0c\u7136\u540e\u5c06\u6240\u6709\u7684\u6587\u4ef6\u4e00\u8d77\u53ce\u96c6\u5230\u4e00\u4e2a\u4e34\u65f6\u7684 _build \u76ee\u5f55\u4e2d\uff0c\u5e76\u5c06\u5b83\u4eec\u5199\u5165\u4e00\u4e2a ZIP \u6587\u4ef6\u3002 \u5b8c\u6210\u540e\u7684 ZIP \u6587\u4ef6\u8fd8\u5c06\u5305\u542b hashes.json \u6587\u4ef6\u3002 \u4e00\u65e6 ZIP \u6587\u4ef6\u88ab\u521b\u5efa\uff0c\u5b83\u5c06\u88ab\u4fdd\u5b58\u5230\u4f60\u7684 _releases \u76ee\u5f55\u4e2d\uff0c\u5e76\u547d\u540d\u4e3a <ADDON ID>-<VERSION STRING>.zip \u3002 \u81ea\u5b9a\u4e49\u6784\u5efa\u8fc7\u7a0b \u00b6 \u9664\u4e86\u521b\u5efa\u53d1\u5e03\u7684 ZIP \u4e4b\u5916\uff0c\u60a8\u53ef\u80fd\u8fd8\u5e0c\u671b\u5728 ZIP \u4e2d\u5305\u542b\u5176\u4ed6\u7684\u6587\u4ef6\uff0c\u60a8\u5e0c\u671b\u8fd0\u884c\u5176\u4ed6\u66f4\u9ad8\u7ea7\u7684\u6784\u5efa\u8fc7\u7a0b\uff0c\u5982\u6700\u5c0f\u5316\u6216\u8fde\u63a5 JS \u6216\u8fd0\u884c\u67d0\u4e9b shell \u547d\u4ee4\u3002 \u6240\u6709\u8fd9\u4e9b\u90fd\u53ef\u4ee5\u5728\u4f60\u7684 build.json \u6587\u4ef6\u4e2d\u5904\u7406\u3002 \u8fd9\u662f\u4e00\u4e2a\u5178\u578b\u7684 build.json \u6587\u4ef6\u3002 { \"additional_files\": [ \"js/demo/portal\" ], \"minify\": [ \"js/demo/portal/a.js\", \"js/demo/portal/b.js\" ], \"rollup\": { \"js/demo/portal/ab-rollup.js\": [ \"js/demo/portal/a.min.js\", \"js/demo/portal/b.min.js\" ] }, \"exec\": [ \"echo '{title} version {version_string} ({version_id}) has been built successfully!' > 'src/addons/Demo/Portal/_build/built.txt'\" ] } \u5982\u679c\u4f60\u6709\u4e00\u4e9b\u9700\u8981\u5728 add-on \u76ee\u5f55\u4e4b\u5916\u63d0\u4f9b\u670d\u52a1\u7684 assets\uff0c\u6bd4\u5982 JavaScript\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528 build.json \u4e2d\u7684 additional_files \u6570\u7ec4\u544a\u8bc9\u6784\u5efa\u8fc7\u7a0b\u590d\u5236\u6587\u4ef6\u6216\u76ee\u5f55\u3002 \u5728\u5f00\u53d1\u8fc7\u7a0b\u4e2d\uff0c\u5c06\u6587\u4ef6\u4fdd\u5b58\u5728 add-on \u76ee\u5f55\u4e4b\u5916\u5e76\u4e0d\u603b\u662f\u53ef\u884c\u7684\uff0c\u6240\u4ee5\u5982\u679c\u4f60\u613f\u610f\uff0c\u4f60\u53ef\u4ee5\u5c06\u6587\u4ef6\u4fdd\u5b58\u5728 add-on \u7684 _files \u76ee\u5f55\u4e2d\u3002 \u5728\u590d\u5236\u9644\u52a0\u6587\u4ef6\u65f6\uff0c\u6211\u4eec\u5c06\u9996\u5148\u68c0\u67e5\u8be5\u6587\u4ef6\u3002 \u5982\u679c\u60a8\u7684\u9644\u52a0\u7ec4\u4ef6\u9644\u5e26\u4e86\u4e00\u4e9b JS \u6587\u4ef6\uff0c\u51fa\u4e8e\u6027\u80fd\u8003\u8651\uff0c\u60a8\u53ef\u80fd\u4f1a\u5e0c\u671b\u5bf9\u8fd9\u4e9b\u6587\u4ef6\u8fdb\u884c\u6700\u5c0f\u5316\u3002 \u60a8\u53ef\u4ee5\u5728\u60a8\u7684 build.json \u4e2d\u6307\u5b9a\u60a8\u8981\u6700\u5c0f\u5316\u7684\u6587\u4ef6\u3002 \u60a8\u53ef\u4ee5\u5c06\u8fd9\u4e9b\u6587\u4ef6\u4ee5\u6570\u7ec4\u7684\u5f62\u5f0f\u5217\u51fa\uff0c\u4e5f\u53ef\u4ee5\u76f4\u63a5\u6307\u5b9a\u4e3a '*' \uff0c\u8fd9\u6837\u5c31\u4f1a\u5bf9 js \u76ee\u5f55\u4e2d\u7684\u6240\u6709\u6587\u4ef6\u8fdb\u884c\u6700\u5c0f\u5316\uff0c\u53ea\u8981\u8be5\u8def\u5f84\u4e2d\u5b58\u5728 JS \u6587\u4ef6\uff0c\u5e76\u5c06\u989d\u5916\u7684\u6587\u4ef6\u590d\u5236\u5230\u6784\u5efa\u4e2d\u5373\u53ef\u3002 \u4efb\u4f55\u88ab\u6700\u5c0f\u5316\u7684\u6587\u4ef6\u90fd\u4f1a\u81ea\u52a8\u4ee5 .min.js \u4f5c\u4e3a\u540e\u7f00\uff0c\u800c\u4e0d\u662f .js \uff0c\u5e76\u4e14\u6e90\u6587\u4ef6\u6848\u4ecd\u7136\u5728\u5305\u4e2d\u3002 \u4f60\u53ef\u80fd\u66f4\u559c\u6b22\u5c06\u591a\u4e2a JS \u6587\u4ef6\u6346\u6210\u4e00\u4e2a\u6587\u4ef6\u3002 \u5982\u679c\u4f60\u8fd9\u6837\u505a\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528 rollup \u6570\u7ec4\u6765\u5b9a\u4e49\u3002 key \u662f\u5408\u5e76\u540e\u7684\u6587\u4ef6\u540d\uff0c\u6570\u7ec4\u4e2d\u7684 item \u662f JS \u6587\u4ef6\u7684\u8def\u5f84\uff0c\u8fd9\u4e9b\u6587\u4ef6\u5c06\u88ab\u5408\u5e76\u6210\u4e00\u4e2a\u6587\u4ef6\u3002 \u6700\u540e\uff0c\u60a8\u53ef\u80fd\u9700\u8981\u5728\u6253\u5305\u6784\u5efa\u548c\u6700\u7ec8\u5b9a\u6848\u4e4b\u524d\u8fd0\u884c\u67d0\u4e9b\u8fdb\u7a0b\u3002 \u8fd9\u53ef\u80fd\u662f\u4efb\u4f55\u4e1c\u897f\u7684\u7ec4\u5408\u3002 \u5f52\u6839\u7ed3\u5e95\uff0c\u5982\u679c\u5b83\u662f\u4e00\u4e2a\u53ef\u4ee5\u4ece shell \u4e2d\u8fd0\u884c\u7684\u547d\u4ee4\uff08\u5305\u62ec PHP \u811a\u672c\uff09\uff0c\u90a3\u9ebd\u4f60\u53ef\u4ee5\u5728\u8fd9\u91cc\u6307\u5b9a\u5b83\u3002 \u5f53\u7136\uff0c\u4e0a\u9762\u7684\u793a\u4f8b\u662f\u6beb\u65e0\u7528\u5904\u7684\uff0c\u4f46\u5b83\u81f3\u5c11\u8bc1\u660e\u4e86\u67d0\u4e9b\u4fdd\u7559\u533a\u662f\u53ef\u4ee5\u4f7f\u7528\u7684\u3002 \u8fd9\u4e9b\u4fdd\u7559\u533a\u88ab\u66ff\u6362\u4e3a\u6807\u91cf\u503c\uff0c\u4f60\u53ef\u4ee5\u4ece XF\\AddOn\\AddOn \u7269\u4ef6\u4e2d\u83b7\u5f97\uff0c\u4e00\u822c\u6765\u8bf4\uff0c\u8fd9\u4e2a\u7269\u4ef6\u662f addon.json \u6587\u4ef6\u4e2d\u7684\u4efb\u4f55\u53ef\u7528\u503c\uff0c\u6216\u8005 AddOn \u5b9e\u4f53\u3002 \u5f00\u53d1\u547d\u4ee4 \u00b6 \u5176\u5b9e\u4e0e\u5f00\u53d1\u76f8\u5173\u7684\u547d\u4ee4\u6709\u4e0d\u5c11\uff0c\u4f46\u8fd9\u91cc\u53ea\u4ecb\u7ecd\u6700\u91cd\u8981\u7684\u4e24\u4e2a\u3002 \u8981\u4f7f\u7528\u8fd9\u4e9b\u547d\u4ee4\uff0c\u4f60\u5fc5\u987b\u5728\u4f60\u7684 config.php \u6587\u4ef6\u4e2d\u6fc0\u6d3b \u5f00\u53d1\u6a21\u5f0f \u3002 Warning \u5982\u679c\u51fa\u73b0\u6570\u636e\u5e93\u548c _output \u76ee\u5f55\u4e0d\u540c\u6b65\u7684\u60c5\u51b5\uff0c\u4ee5\u4e0b\u4e24\u4e2a\u547d\u4ee4\u90fd\u6709\u53ef\u80fd\u5bfc\u81f4\u6570\u636e\u4e22\u5931\u3002\u5efa\u8bae\u4f7f\u7528 VCS (\u7248\u672c\u63a7\u5236\u7cfb\u7edf)\uff0c\u5982 GitHub \u6765\u51cf\u8f7b\u8fd9\u79cd\u9519\u8bef\u7684\u5f71\u54cd\u3002 \u5bfc\u5165\u5f00\u53d1\u8f93\u51fa \u00b6 Terminal $ php cmd.php xf-dev:import --addon [addon_id] \u8fd0\u884c\u6b64\u547d\u4ee4\u5c06\u628a\u4f60\u7684\u9644\u52a0\u7ec4\u4ef6 _output \u76ee\u5f55\u4e0b\u7684\u6240\u6709\u5f00\u53d1\u65f6\u8f93\u51fa\u7684\u6587\u4ef6\u5bfc\u5165\u8fdb\u6570\u636e\u5e93\u91cc\u3002 \u5bfc\u51fa\u5f00\u53d1\u8f93\u51fa \u00b6 Terminal $ php cmd.php xf-dev:export --addon [addon_id] \u8fd9\u5c06\u628a\u5f53\u524d\u6570\u636e\u5e93\u4e2d\u4e0e\u9644\u52a0\u7ec4\u4ef6\u76f8\u5173\u8054\u7684\u6240\u6709\u6570\u636e\u5bfc\u51fa\u5230 _output \u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\u4e2d\u3002 \u8c03\u8bd5\u4ee3\u7801 \u00b6 \u5e94\u8be5\u53ef\u4ee5\u8bbe\u7f6e\u4f60\u559c\u6b22\u7684\u8c03\u8bd5\u5de5\u5177\uff08 XDebug\uff0cZend Debugger \u7b49\uff09\u6765\u4e0e XF2 \u4e00\u8d77\u8fd0\u4f5c\u3002 \u867d\u7136\uff0c\u6709\u65f6\u5019\uff0c\u8c03\u8bd5\u4ee3\u7801\u53ef\u80fd\u8c61\u5feb\u901f\u67e5\u770b\u4e00\u4e2a\u53d8\u91cf\u5728\u7ed9\u5b9a\u65f6\u95f4\u5185\u6301\u6709\u7684\u503c\uff08\u6216\u503c\u7c7b\u578b\uff09\u4e00\u6837\u7b80\u964b\u3002 Dump \u53d8\u91cf \u00b6 \u5f53\u7136 PHP \u6709\u4e00\u4e2a\u5185\u7f6e\u7684\u5de5\u5177\u6765\u5904\u7406\u8fd9\u4e2a\u95ee\u9898\uff0c\u60a8\u53ef\u80fd\u5c06\u5176\u79f0\u4e3a var_dump() \u3002 XF \u63d0\u4f9b\u4e86\u4e24\u4e2a\u66ff\u4ee3\u65b9\u6cd5\u6765\u5904\u7406\u8fd9\u4e2a\u95ee\u9898\uff1a \\XF::dump($var); \\XF::dumpSimple($var); \u7b80\u5358\u7248\u672c\u4e3b\u8981\u662f\u5c06\u4e00\u4e2a\u53d8\u91cf\u7684\u503c\u4ee5\u7eaf\u6587\u672c\u7684\u5f62\u5f0f\u8ee2\u50a8\u51fa\u6765\u3002 \u4f8b\u5982\uff0c\u5982\u679c\u4f60\u53ea\u662f\u7528\u5b83\u6765\u8ee2\u50a8\u4e00\u4e2a\u6570\u7ec4\u7684\u503c\uff0c\u4f60\u4f1a\u5728\u9875\u9762\u9876\u90e8\u770b\u5230\u8fd9\u6837\u7684\u8f93\u51fa\uff1a array(2) { [\"user_id\"] => int(1) [\"username\"] => string(5) \"Admin\" } \u8fd9\u5b9e\u9645\u4e0a\u662f\u4e0e\u6807\u51c6\u7684 var_dump \u76f8\u540c\u7684\u8f93\u51fa\uff0c\u4f46\u4e3a\u4e86\u53ef\u8bfb\u6027\u7a0d\u4f5c\u4fee\u6539\uff0c\u5e76\u5c06\u5176\u5305\u88f9\u5728 <pre> \u6807\u7b7e\u4e2d\uff0c\u4ee5\u786e\u4fdd\u5728\u55a7\u67d3\u65f6\u4fdd\u7559\u7a7a\u767d\u3002 \u8fd9\u4e2a\u66ff\u4ee3\u65b9\u6848\u5b9e\u9645\u4e0a\u662f Symfony \u9879\u76ee\u4e2d\u7684\u4e00\u4e2a\u540d\u4e3a VarDumper \u7684\u7ec4\u4ef6\u3002 \u5b83\u8f93\u51fa HTML\u3001 CSS \u548c JS \u6765\u521b\u5efa\u4e00\u4e2a\u529f\u80fd\u66f4\u5f3a\u3001\u66f4\u5bb9\u6613\u9605\u8bfb\u7684\u8f93\u51fa\u3002 \u5b83\u5141\u8bb8\u4f60\u6298\u53e0\u67d0\u4e9b\u90e8\u5206\uff0c\u5bf9\u4e8e\u67d0\u4e9b\u53ef\u4ee5\u8f93\u51fa\u5927\u91cf\u6570\u636e\u7684\u503c\uff0c\u6bd4\u5982\u7269\u4ef6\uff0c\u5b83\u53ef\u4ee5\u81ea\u52a8\u6298\u53e0\u8fd9\u4e9b\u90e8\u5206\u3002","title":"\u5f00\u53d1\u5de5\u5177"},{"location":"development-tools/#_1","text":"XF2 \u4e3a\u5f00\u53d1\u8005\u63d0\u4f9b\u4e86\u5927\u91cf\u7684\u5185\u7f6e\u5de5\u5177\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528\u8fd9\u4e9b\u5de5\u5177\u6765\u52a0\u5feb\u9644\u52a0\u7ec4\u4ef6\u7684\u5f00\u53d1\uff0c\u4e0b\u9762\u6211\u4eec\u5c06\u4ecb\u7ecd\u5176\u4e2d\u7684\u4e00\u4e9b\u3002","title":"\u5f00\u53d1\u5de5\u5177"},{"location":"development-tools/#_2","text":"\u8c03\u8bd5\u6a21\u5f0f\u53ef\u4ee5\u5728\u4f60\u7684 config.php \u4e2d\u6fc0\u6d3b\uff0c\u8fd9\u5c06\u5141\u8bb8\u4f60\u8bbf\u95ee Admin CP \u4e2d\u7684\u67d0\u4e9b\u5f00\u53d1\u5de5\u5177\uff08\u5982\u521b\u5efa\u8def\u7531\uff0c\u6743\u9650\uff0c\u7ba1\u7406\u5bfc\u89c8\u7b49\uff09\uff0c\u5b83\u8fd8\u5c06\u5728\u6bcf\u4e2a\u9875\u9762\u7684\u5e95\u90e8\u6fc0\u6d3b\u4e00\u4e2a\u63a7\u5236\u53f0\u8f93\u51fa\uff0c\u8be6\u7ec6\u8bf4\u660e\u9875\u9762\u5904\u7406\u7684\u65f6\u95f4\uff0c\u6709\u591a\u5c11\u67e5\u627e\u88ab\u8fd0\u884c\u6765\u55a7\u67d3\u9875\u9762\u548c\u4f7f\u7528\u4e86\u591a\u5c11\u5185\u5b58\u3002 \u60ac\u505c\u65f6\uff0c\u4f1a\u6709\u4e00\u4e2a\u5305\u542b\u5f53\u524d Controller\u3001 Action \u548c\u6a21\u677f\u540d\u79f0\u7b49\u4fe1\u606f\u7684\u5de5\u5177\u63d0\u793a\u3002 \u4f60\u4e5f\u53ef\u4ee5\u70b9\u51fb\u65f6\u95f4\u8f93\u51fa\uff0c\u8fd9\u5c06\u8ba9\u4f60\u8be6\u7ec6\u4e86\u89e3\u5230\u5e95\u8fd0\u884c\u4e86\u54ea\u4e9b\u67e5\u627e\uff0c\u4ee5\u53ca\u5bfc\u81f4\u8be5\u67e5\u627e\u88ab\u8fd0\u884c\u7684\u5806\u6808\u8ffd\u8e2a\u3002 \u4f60\u53ef\u4ee5\u901a\u8fc7\u5728 config.php \u4e2d\u6dfb\u52a0\u4ee5\u4e0b\u5185\u5bb9\u6765\u6fc0\u6d3b\u8c03\u8bd5\u6a21\u5f0f\uff1a $config['debug'] = true;","title":"\u8c03\u8bd5\u6a21\u5f0f"},{"location":"development-tools/#_3","text":"\u5f00\u53d1\u6a21\u5f0f\u662f\u4e00\u79cd\u7279\u6b8a\u7684\u6a21\u5f0f\uff0c\u5728\u60a8\u7684 config.php \u6587\u4ef6\u4e2d\u6fc0\u6d3b\uff0c\u5b83\u5c06\u89e6\u53d1 XF \u81ea\u52a8\u5c06\u60a8\u7684\u5f00\u53d1\u6587\u4ef6\u5199\u5165 _output \u76ee\u5f55\u3002 \u8fd9\u4e2a\u6a21\u5f0f\u9700\u8981\u5728\u6587\u4ef6\u7cfb\u7edf\u6a21\u677f\u7f16\u8f91\u65f6\u6fc0\u6d3b\u3002 \u7531\u4e8e\u5f00\u53d1\u6a21\u5f0f\u4f1a\u5c06\u6587\u4ef6\u5199\u5165\u4f60\u7684\u6587\u4ef6\u7cfb\u7edf\uff0c\u786e\u4fdd\u4f60\u6709\u9002\u5f53\u7684\u6587\u4ef6\u6743\u9650\u662f\u5f88\u91cd\u8981\u7684\u3002 \u8fd9\u53ef\u80fd\u4f1a\u6839\u636e\u73af\u5883\u7684\u4e0d\u540c\u800c\u6709\u6240\u4e0d\u540c\uff0c\u4f46\u5178\u578b\u7684\u914d\u7f6e\u662f\u786e\u4fdd\u4f60\u6b63\u5728\u4f7f\u7528\u7684\u4efb\u4f55\u9644\u52a0\u7ec4\u4ef6\u7684 _output \u76ee\u5f55\u7684 chmod \u8bbe\u7f6e\u4e3a 0777 \u3002 \u4f8b\u5982\uff0c\u5982\u679c\u4f60\u6b63\u5728\u4f7f\u7528\u4e00\u4e2a ID \u4e3a Demo \u7684\u9644\u52a0\u7ec4\u4ef6\uff0c\u5b83\u7684\u5f00\u53d1\u8f93\u51fa\u5c06\u88ab\u5199\u5165\u5230 src/addons/Demo/_output \uff0c\u56e0\u6b64\u8be5\u76ee\u5f55\u9700\u8981\u662f\u5b8c\u5168\u53ef\u5199\u7684\u3002 \u6fc0\u6d3b\u5f00\u53d1\u6a21\u5f0f\uff0c\u4e5f\u4f1a\u81ea\u52a8\u6fc0\u6d3b \u8c03\u8bd5\u6a21\u5f0f \u3002 \u8981\u6fc0\u6d3b\u5f00\u53d1\u6a21\u5f0f\uff0c\u8bf7\u5728\u4f60\u7684 config.php \u6587\u4ef6\u4e2d\u6dfb\u52a0\u4ee5\u4e0b\u884c\uff1a $config['development']['enabled'] = true; $config['development']['defaultAddOn'] = 'SomeCompany/MyAddOn'; defaultAddOn \u503c\u662f\u53ef\u9009\u7684\uff0c\u4f46\u5f53\u521b\u5efa\u65b0\u5185\u5bb9\u65f6\uff0c\u6dfb\u52a0\u8be5\u503c\u4f1a\u5728 XF Admin CP \u4e2d\u81ea\u52a8\u586b\u5145\u6307\u5b9a\u7684\u9644\u52a0\u7ec4\u4ef6\uff0c\u8be5\u9644\u52a0\u7ec4\u4ef6\u5c06\u4e0e\u9644\u52a0\u7ec4\u4ef6\u76f8\u5173\u8054\u3002 \u9664\u4e86\u4e0a\u8ff0\uff0c\u4f60\u53ef\u80fd\u4f1a\u53d1\u73b0\u6709\u5fc5\u8981\u6dfb\u52a0\u4e00\u4e9b\u989d\u5916\u7684\u914d\u7f6e\uff0c\u7279\u522b\u662f\u5f53\u4f60\u4f7f\u7528\u591a\u4e2a XF \u5b89\u88c5\u65f6\u3002 $config['enableMail'] = false; \u8fd9\u5c06\u5173\u95ed\u6240\u6709\u4ece\u60a8\u7684\u8bba\u575b\u53d1\u9001\u7684\u90ae\u4ef6\u3002 \u5982\u679c\u60a8\u4f7f\u7528\u7684\u662f\u771f\u5b9e\u7528\u6237\u548c\u771f\u5b9e\u90ae\u4ef6\u5730\u5740\u7684\u5b9e\u65f6\u6570\u636e\u526f\u672c\uff0c\u8fd9\u4e00\u70b9\u5c24\u4e3a\u91cd\u8981\uff08\u5c3d\u7ba1\u6211\u4eec\u5efa\u8bae\u4e0d\u8981\u8fd9\u6837\u505a\uff01\uff09\u3002 \u9664\u4e86\u76f4\u63a5\u5173\u95ed\u90ae\u4ef6\u4e4b\u5916, \u60a8\u53ef\u4ee5\u8003\u8651\u4f7f\u7528\u4e00\u4e2a\u670d\u52a1, \u4f8b\u5982 MailTrap.io \u3002 \u8fd9\u5c06\u4e3a\u60a8\u63d0\u4f9b\u4e00\u4e2a\u514d\u8d39\u7684\u90ae\u7bb1\uff0c\u53ef\u4ee5\u63a5\u53ce\u6240\u6709\u4ece\u60a8\u7684\u8bba\u575b\u53d1\u9001\u7684\u90ae\u4ef6\uff0c\u8fd9\u5bf9\u4e8e\u6d4b\u8bd5\u60a8\u7684\u65b0\u9644\u52a0\u7ec4\u4ef6\u53ef\u80fd\u53d1\u9001\u7684\u4efb\u4f55\u7535\u5b50\u90ae\u4ef6\u975e\u5e38\u6709\u7528\u3002 $config['cookie']['prefix'] = 'anything_'; \u5982\u679c\u60a8\u5728\u540c\u4e00\u57df\u540d\u4e0a\u4f7f\u7528\u4e24\u4e2a\u6216\u66f4\u591a\u7684 XF \u5b89\u88c5\uff0c\u60a8\u53ef\u80fd\u4f1a\u9047\u5230 Cookie \u88ab\u590d\u76d6\u7684\u95ee\u9898\uff0c\u8fd9\u662f\u7531\u5b89\u88c5\u5171\u4eab\u76f8\u540c\u7684 Cookie \u524d\u7f00\u5f15\u8d77\u7684\u3002 \u56e0\u6b64\uff0c\u5efa\u8bae\u60a8\u786e\u4fdd\u4e3a\u60a8\u8bbe\u7f6e\u7684\u6bcf\u4e2a XF \u5b89\u88c5\u66f4\u6539 Cookie \u524d\u7f00\u3002 \u5982\u679c\u4e0d\u8fd9\u6837\u505a\uff0c\u60a8\u5c06\u4f1a\u9047\u5230\u4e00\u4e9b\u95ee\u9898\uff0c\u4f8b\u5982\uff0c\u5f53\u767b\u5f55\u5230\u53e6\u4e00\u4e2a XF \u5b89\u88c5\u65f6\uff0c\u4f1a\u88ab\u6ce8\u9500\u3002","title":"\u6fc0\u6d3b\u5f00\u53d1\u6a21\u5f0f"},{"location":"development-tools/#_4","text":"XF 2.0 \u63d0\u4f9b\u4e86\u4e00\u4e9b\u901a\u7528\u7684\u5f00\u53d1\u548c\u9644\u52a0\u7ec4\u4ef6\u7684 CLI \u547d\u4ee4\uff0c\u8fd9\u4e9b\u547d\u4ee4\u7684\u76ee\u7684\u662f\u5e2e\u52a9\u60a8\u66f4\u6709\u6548\u5730\u5f00\u53d1\uff0c\u751a\u81f3\u53ef\u80fd\u4f7f\u4e00\u4e9b\u5e38\u89c1\u7684\u8fc7\u7a0b\u81ea\u52a8\u5316/\u811a\u672c\u5316\u3002 \u5728\u672c\u8282\u4e2d\uff0c\u6211\u4eec\u5c06\u4ecb\u7ecd\u4e00\u4e9b\u5e38\u7528\u7684\u5de5\u5177\uff0c\u5e76\u89e3\u91ca\u5b83\u4eec\u7684\u4f5c\u7528\u3002","title":"\u5f00\u53d1\u547d\u4ee4"},{"location":"development-tools/#_5","text":"","title":"\u9644\u52a0\u7ec4\u4ef6\u7279\u5b9a\u547d\u4ee4"},{"location":"development-tools/#_6","text":"Terminal $ php cmd.php xf-addon:create xf-addon:create \u547d\u4ee4\u662f\u5982\u4f55\u521d\u59cb\u8bbe\u7f6e\u548c\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u9644\u52a0\u7ec4\u4ef6\u3002 \u4e00\u65e6\u5b83\u8fd0\u884c\uff0c\u4f60\u53ea\u9700\u8981\u56de\u7b54\u4e00\u4e9b\u57fa\u672c\u95ee\u9898\uff1a \u8f93\u5165\u6b64\u9644\u52a0\u7ec4\u4ef6\u7684 ID \u8f93\u5165\u6807\u9898 \u8f93\u5165\u7248\u672c ID\uff08\u5982 1000010 \uff09\u3002 \u8f93\u5165\u7248\u672c\u5b57\u7b26\u4e32\uff08\u5982 1.0.0 Alpha\uff09\u3002 \u7136\u540e\u4f60\u4f1a\u5f97\u5230\u4e00\u4e2a\u9009\u9879\u6765\u521b\u5efa\u9644\u52a0\u7ec4\u4ef6\u5e76\u5199\u51fa\u5b83\u7684 addon.json \u6587\u4ef6\uff0c\u5e76\u8be2\u95ee\u4f60\u4e00\u4e9b\u5173\u4e8e\u662f\u5426\u8981\u6dfb\u52a0 Setup.php \u6587\u4ef6\u7684\u95ee\u9898\u3002","title":"\u65b0\u5efa\u4e00\u4e2a\u9644\u52a0\u7ec4\u4ef6"},{"location":"development-tools/#_data-xml","text":"Terminal $ php cmd.php xf-addon:export [addon_id] \u8fd9\u6761\u547d\u4ee4\u5c06\u7528\u4e8e\u5bfc\u51fa\u6240\u6709\u9644\u52a0\u7ec4\u4ef6\u7684\u6570\u636e\u5230 _data \u76ee\u5f55\u4e0b\u7684 XML \u6587\u4ef6\u3002 \u5b83\u4ece\u5f53\u524d\u6570\u636e\u5e93\u4e2d\u5bfc\u51fa\u6570\u636e\uff08\u800c\u4e0d\u662f\u4ece\u5f00\u53d1\u8f93\u51fa\u6587\u4ef6\u4e2d\u5bfc\u51fa\uff09\u3002","title":"\u5bfc\u51fa _data .XML \u6587\u4ef6"},{"location":"development-tools/#_7","text":"Terminal $ php cmd.php xf-addon:bump-version [addon_id] --version-id 1020370 --version-string 1.2.3 Note \u5982\u679c\u4f60\u7684\u7248\u672c\u5b57\u7b26\u4e32\u5305\u542b\u7a7a\u683c\uff0c\u4f60\u9700\u8981\u7528\u5f15\u53f7\u5c06\u5176\u5305\u56f4\u3002 \u8be5\u547d\u4ee4\u83b7\u53d6\u60a8\u7684\u9644\u52a0\u7ec4\u4ef6\u7684\u9644\u52a0\u7ec4\u4ef6 ID\u3001\u65b0\u7248\u672c ID \u548c\u65b0\u7248\u672c\u5b57\u7b26\u4e32\u3002 \u8fd9\u6837\u60a8\u5c31\u53ef\u4ee5\u8f7b\u677e\u5b8c\u6210\u5347\u7ea7\u9644\u52a0\u7ec4\u4ef6\u7684\u7248\u672c\uff0c\u800c\u65e0\u9700\u81ea\u5df1\u8fd0\u884c\u5347\u7ea7\u548c\u91cd\u5efa\u3002 \u4e0a\u9762\u7684\u9009\u9879\u662f\u53ef\u9009\u7684\uff0c\u5982\u679c\u6ca1\u6709\u63d0\u4f9b\u8fd9\u4e9b\u9009\u9879\uff0c\u7cfb\u7edf\u4f1a\u63d0\u793a\u60a8\u8f93\u5165\u3002 \u5982\u679c\u60a8\u53ea\u6307\u5b9a\u7248\u672c ID\uff0c\u5982\u679c\u5b83\u7b26\u5408\u6211\u4eec \u63a8\u8350\u7684\u7248\u672cID\u683c\u5f0f \uff0c\u6211\u4eec\u5c06\u5c1d\u8bd5\u5e76\u81ea\u52a8\u4ece\u4e2d\u63a8\u65ad\u51fa\u6b63\u786e\u7684\u7248\u672c\u5b57\u7b26\u4e32\u3002 \u4e00\u65e6\u547d\u4ee4\u5b8c\u6210\uff0c\u5b83\u5c06\u81ea\u52a8\u66f4\u65b0 addon.json \u6587\u4ef6\u548c\u6570\u636e\u5e93\uff0c\u5e76\u63d0\u4f9b\u6b63\u786e\u7684\u7248\u672c\u8be6\u7ec6\u4fe1\u606f\u3002","title":"\u5347\u7ea7\u60a8\u7684\u9644\u52a0\u7ec4\u4ef6\u7248\u672c"},{"location":"development-tools/#addonjson","text":"Terminal $ php cmd.php xf-addon:sync-json [addon_id] \u6709\u65f6\u4f60\u53ef\u80fd\u66f4\u559c\u6b22\u76f4\u63a5\u7f16\u8f91 JSON \u6587\u4ef6\u4e2d\u7684\u67d0\u4e9b\u7ec6\u8282\uff0c\u8fd9\u53ef\u80fd\u662f\u7248\u672c\uff0c\u6216\u65b0\u7684\u56fe\u6807\uff0c\u6216\u66f4\u6539\u6807\u9898\u6216\u63cf\u8ff0\u3002 \u4ee5\u8fd9\u79cd\u65b9\u5f0f\u66f4\u6539 JSON \u53ef\u80fd\u4f1a\u5bfc\u81f4\u9644\u52a0\u7ec4\u4ef6\u7cfb\u7edf\u8ba4\u4e3a\u6709\u5f85\u5b9a\u7684\u66f4\u6539\u6216\u9644\u52a0\u7ec4\u4ef6\u662f\u53ef\u5347\u7ea7\u7684\u3002 \u5982\u679c\u60a8\u5c1a\u672a\u5bfc\u51fa\u5f53\u524d\u6570\u636e\uff0c\u5219\u91cd\u5efa\u6216\u5347\u7ea7\u53ef\u80fd\u662f\u4e00\u79cd\u7834\u574f\u6027\u7684\u64cd\u4f5c\u3002 \u56e0\u6b64\uff0c\u5efa\u8bae\u8fd0\u884c\u6b64\u547d\u4ee4\u4f5c\u4e3a\u5bfc\u5165\u8be5\u6570\u636e\u7684\u65b9\u5f0f\uff0c\u800c\u4e0d\u5f71\u54cd\u60a8\u7684\u73b0\u6709\u6570\u636e\u3002","title":"\u540c\u6b65\u4f60\u7684 addon.json \u5230\u6570\u636e\u5e93"},{"location":"development-tools/#addonjson_1","text":"Terminal $ php cmd.php xf-addon:validate-json [addon_id] \u5982\u679c\u4f60\u60f3\u68c0\u67e5\u4f60\u7684 JSON \u6587\u4ef6\u662f\u5426\u5305\u542b\u6b63\u786e\u7684\u5185\u5bb9\u548c\u6b63\u786e\u7684\u683c\u5f0f\uff0c\u4f60\u73b0\u5728\u53ef\u4ee5\u9a8c\u8bc1\u5b83\u3002 \u9a8c\u8bc1\u5668\u5c06\u68c0\u67e5\u5185\u5bb9\u662f\u5426\u53ef\u4ee5\u89e3\u7801\uff0c\u662f\u5426\u5305\u542b\u6240\u6709\u6b63\u786e\u7684\u5fc5\u586b\u5b57\u6bb5\uff08\u5982\u6807\u9898\u548c\u7248\u672c ID \uff09\uff0c\u8fd8\u68c0\u67e5\u662f\u5426\u5b58\u5728\u53ef\u9009\u7684 Key\uff08\u5982\u63cf\u8ff0\u548c\u56fe\u6807\uff09\u3002 \u5982\u679c\u6709\u4efb\u4f55 Key \u4e22\u5931\uff0c\u6211\u4eec\u5c06\u4e3a\u60a8\u63d0\u4f9b\u4fee\u590d\u95ee\u9898\u7684\u670d\u52a1\u3002 \u6211\u4eec\u8fd8\u68c0\u67e5 JSON \u6587\u4ef6\u4e2d\u662f\u5426\u6709\u4efb\u4f55\u610f\u5916\u7684\u5b57\u6bb5\u3002 \u8fd9\u4e9b\u53ef\u80fd\u662f\u6545\u610f\u7684\uff0c\u4e5f\u53ef\u80fd\u662f\u9519\u522b\u5b57\u3002 \u60a8\u53ef\u4ee5\u624b\u52a8\u8fd0\u884c\u8be5\u547d\u4ee4\uff0c\u6216\u8005\u5728\u6784\u5efa\u53d1\u884c\u7248\u65f6\u81ea\u52a8\u8fd0\u884c\u8be5\u547d\u4ee4\u3002","title":"\u9a8c\u8bc1\u60a8\u7684 addon.json \u6587\u4ef6"},{"location":"development-tools/#_8","text":"\u6709\u65f6\uff0c\u65e0\u9700\u8fdb\u884c\u5378\u8f7d\u548c\u91cd\u65b0\u5b89\u88c5\u8fc7\u7a0b\u5373\u53ef\u68c0\u67e5 Setup class \u6b65\u9aa4\u662f\u5426\u6b63\u5e38\u8fd0\u884c\uff0c\u8fd9\u662f\u5f88\u6709\u5e2e\u52a9\u7684\u3002 \u6709\u4e09\u6761\u547d\u4ee4\u53ef\u4ee5\u5e2e\u52a9\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0c\u8fd9\u4e9b\u547d\u4ee4\u53ea\u9002\u7528\u4e8e\u4f7f\u7528\u9ed8\u8ba4\u7684 StepRunner \u7279\u6027\u521b\u5efa\u7684 Setup class\u3002","title":"\u8fd0\u884c\u7279\u5b9a\u7684\u8bbe\u7f6e\u6b65\u9aa4"},{"location":"development-tools/#_9","text":"Terminal $ php cmd.php xf-addon:install-step [addon_id] [step]","title":"\u8fd0\u884c\u5b89\u88c5\u6b65\u9aa4"},{"location":"development-tools/#_10","text":"Terminal $ php cmd.php xf-addon:upgrade-step [addon_id] [version] [step]","title":"\u8fd0\u884c\u5347\u7ea7\u6b65\u9aa4"},{"location":"development-tools/#_11","text":"Terminal $ php cmd.php xf-addon:uninstall-step [addon_id] [step]","title":"\u8fd0\u884c\u5378\u8f7d\u6b65\u9aa4"},{"location":"development-tools/#_12","text":"\u4e00\u65e6\u6240\u6709\u7684\u8270\u82e6\u5de5\u4f5c\u90fd\u5b8c\u6210\u4e86\uff0c\u5f88\u9057\u64bc\uff0c\u5728\u771f\u6b63\u53d1\u5e03\u4e4b\u524d\u8fd8\u8981\u7ecf\u5386\u4e00\u4e9b\u5176\u4ed6\u7684\u8fc7\u7a0b\u3002 \u5373\u4f7f\u662f\u5c06\u6240\u6709\u7684\u6587\u4ef6\u53ce\u96c6\u5230\u6b63\u786e\u7684\u5730\u65b9\uff0c\u5e76\u624b\u52a8\u521b\u5efa ZIP \u6587\u4ef6\u7684\u8fc7\u7a0b\u4e5f\u662f\u5f88\u8017\u65f6\u7684\uff0c\u800c\u4e14\u5bb9\u6613\u51fa\u73b0\u9519\u8bef\u3002 \u6211\u4eec\u53ef\u4ee5\u81ea\u52a8\u5904\u7406\u8fd9\u4e9b\u95ee\u9898\uff0c\u5305\u62ec\u7528\u4e00\u4e2a\u7b80\u5358\u7684\u547d\u4ee4\u751f\u6210 hash.json \u6587\u4ef6\u3002 Terminal $ php cmd.php xf-addon:build-release [addon_id] \u5f53\u4f60\u8fd0\u884c\u8fd9\u4e2a\u547d\u4ee4\u65f6\uff0c\u5b83\u4f1a\u5148\u8fd0\u884c xf-addon:export \u547d\u4ee4\uff0c\u7136\u540e\u5c06\u6240\u6709\u7684\u6587\u4ef6\u4e00\u8d77\u53ce\u96c6\u5230\u4e00\u4e2a\u4e34\u65f6\u7684 _build \u76ee\u5f55\u4e2d\uff0c\u5e76\u5c06\u5b83\u4eec\u5199\u5165\u4e00\u4e2a ZIP \u6587\u4ef6\u3002 \u5b8c\u6210\u540e\u7684 ZIP \u6587\u4ef6\u8fd8\u5c06\u5305\u542b hashes.json \u6587\u4ef6\u3002 \u4e00\u65e6 ZIP \u6587\u4ef6\u88ab\u521b\u5efa\uff0c\u5b83\u5c06\u88ab\u4fdd\u5b58\u5230\u4f60\u7684 _releases \u76ee\u5f55\u4e2d\uff0c\u5e76\u547d\u540d\u4e3a <ADDON ID>-<VERSION STRING>.zip \u3002","title":"\u6784\u5efa\u9644\u52a0\u7ec4\u4ef6\u53d1\u884c\u7248"},{"location":"development-tools/#_13","text":"\u9664\u4e86\u521b\u5efa\u53d1\u5e03\u7684 ZIP \u4e4b\u5916\uff0c\u60a8\u53ef\u80fd\u8fd8\u5e0c\u671b\u5728 ZIP \u4e2d\u5305\u542b\u5176\u4ed6\u7684\u6587\u4ef6\uff0c\u60a8\u5e0c\u671b\u8fd0\u884c\u5176\u4ed6\u66f4\u9ad8\u7ea7\u7684\u6784\u5efa\u8fc7\u7a0b\uff0c\u5982\u6700\u5c0f\u5316\u6216\u8fde\u63a5 JS \u6216\u8fd0\u884c\u67d0\u4e9b shell \u547d\u4ee4\u3002 \u6240\u6709\u8fd9\u4e9b\u90fd\u53ef\u4ee5\u5728\u4f60\u7684 build.json \u6587\u4ef6\u4e2d\u5904\u7406\u3002 \u8fd9\u662f\u4e00\u4e2a\u5178\u578b\u7684 build.json \u6587\u4ef6\u3002 { \"additional_files\": [ \"js/demo/portal\" ], \"minify\": [ \"js/demo/portal/a.js\", \"js/demo/portal/b.js\" ], \"rollup\": { \"js/demo/portal/ab-rollup.js\": [ \"js/demo/portal/a.min.js\", \"js/demo/portal/b.min.js\" ] }, \"exec\": [ \"echo '{title} version {version_string} ({version_id}) has been built successfully!' > 'src/addons/Demo/Portal/_build/built.txt'\" ] } \u5982\u679c\u4f60\u6709\u4e00\u4e9b\u9700\u8981\u5728 add-on \u76ee\u5f55\u4e4b\u5916\u63d0\u4f9b\u670d\u52a1\u7684 assets\uff0c\u6bd4\u5982 JavaScript\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528 build.json \u4e2d\u7684 additional_files \u6570\u7ec4\u544a\u8bc9\u6784\u5efa\u8fc7\u7a0b\u590d\u5236\u6587\u4ef6\u6216\u76ee\u5f55\u3002 \u5728\u5f00\u53d1\u8fc7\u7a0b\u4e2d\uff0c\u5c06\u6587\u4ef6\u4fdd\u5b58\u5728 add-on \u76ee\u5f55\u4e4b\u5916\u5e76\u4e0d\u603b\u662f\u53ef\u884c\u7684\uff0c\u6240\u4ee5\u5982\u679c\u4f60\u613f\u610f\uff0c\u4f60\u53ef\u4ee5\u5c06\u6587\u4ef6\u4fdd\u5b58\u5728 add-on \u7684 _files \u76ee\u5f55\u4e2d\u3002 \u5728\u590d\u5236\u9644\u52a0\u6587\u4ef6\u65f6\uff0c\u6211\u4eec\u5c06\u9996\u5148\u68c0\u67e5\u8be5\u6587\u4ef6\u3002 \u5982\u679c\u60a8\u7684\u9644\u52a0\u7ec4\u4ef6\u9644\u5e26\u4e86\u4e00\u4e9b JS \u6587\u4ef6\uff0c\u51fa\u4e8e\u6027\u80fd\u8003\u8651\uff0c\u60a8\u53ef\u80fd\u4f1a\u5e0c\u671b\u5bf9\u8fd9\u4e9b\u6587\u4ef6\u8fdb\u884c\u6700\u5c0f\u5316\u3002 \u60a8\u53ef\u4ee5\u5728\u60a8\u7684 build.json \u4e2d\u6307\u5b9a\u60a8\u8981\u6700\u5c0f\u5316\u7684\u6587\u4ef6\u3002 \u60a8\u53ef\u4ee5\u5c06\u8fd9\u4e9b\u6587\u4ef6\u4ee5\u6570\u7ec4\u7684\u5f62\u5f0f\u5217\u51fa\uff0c\u4e5f\u53ef\u4ee5\u76f4\u63a5\u6307\u5b9a\u4e3a '*' \uff0c\u8fd9\u6837\u5c31\u4f1a\u5bf9 js \u76ee\u5f55\u4e2d\u7684\u6240\u6709\u6587\u4ef6\u8fdb\u884c\u6700\u5c0f\u5316\uff0c\u53ea\u8981\u8be5\u8def\u5f84\u4e2d\u5b58\u5728 JS \u6587\u4ef6\uff0c\u5e76\u5c06\u989d\u5916\u7684\u6587\u4ef6\u590d\u5236\u5230\u6784\u5efa\u4e2d\u5373\u53ef\u3002 \u4efb\u4f55\u88ab\u6700\u5c0f\u5316\u7684\u6587\u4ef6\u90fd\u4f1a\u81ea\u52a8\u4ee5 .min.js \u4f5c\u4e3a\u540e\u7f00\uff0c\u800c\u4e0d\u662f .js \uff0c\u5e76\u4e14\u6e90\u6587\u4ef6\u6848\u4ecd\u7136\u5728\u5305\u4e2d\u3002 \u4f60\u53ef\u80fd\u66f4\u559c\u6b22\u5c06\u591a\u4e2a JS \u6587\u4ef6\u6346\u6210\u4e00\u4e2a\u6587\u4ef6\u3002 \u5982\u679c\u4f60\u8fd9\u6837\u505a\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528 rollup \u6570\u7ec4\u6765\u5b9a\u4e49\u3002 key \u662f\u5408\u5e76\u540e\u7684\u6587\u4ef6\u540d\uff0c\u6570\u7ec4\u4e2d\u7684 item \u662f JS \u6587\u4ef6\u7684\u8def\u5f84\uff0c\u8fd9\u4e9b\u6587\u4ef6\u5c06\u88ab\u5408\u5e76\u6210\u4e00\u4e2a\u6587\u4ef6\u3002 \u6700\u540e\uff0c\u60a8\u53ef\u80fd\u9700\u8981\u5728\u6253\u5305\u6784\u5efa\u548c\u6700\u7ec8\u5b9a\u6848\u4e4b\u524d\u8fd0\u884c\u67d0\u4e9b\u8fdb\u7a0b\u3002 \u8fd9\u53ef\u80fd\u662f\u4efb\u4f55\u4e1c\u897f\u7684\u7ec4\u5408\u3002 \u5f52\u6839\u7ed3\u5e95\uff0c\u5982\u679c\u5b83\u662f\u4e00\u4e2a\u53ef\u4ee5\u4ece shell \u4e2d\u8fd0\u884c\u7684\u547d\u4ee4\uff08\u5305\u62ec PHP \u811a\u672c\uff09\uff0c\u90a3\u9ebd\u4f60\u53ef\u4ee5\u5728\u8fd9\u91cc\u6307\u5b9a\u5b83\u3002 \u5f53\u7136\uff0c\u4e0a\u9762\u7684\u793a\u4f8b\u662f\u6beb\u65e0\u7528\u5904\u7684\uff0c\u4f46\u5b83\u81f3\u5c11\u8bc1\u660e\u4e86\u67d0\u4e9b\u4fdd\u7559\u533a\u662f\u53ef\u4ee5\u4f7f\u7528\u7684\u3002 \u8fd9\u4e9b\u4fdd\u7559\u533a\u88ab\u66ff\u6362\u4e3a\u6807\u91cf\u503c\uff0c\u4f60\u53ef\u4ee5\u4ece XF\\AddOn\\AddOn \u7269\u4ef6\u4e2d\u83b7\u5f97\uff0c\u4e00\u822c\u6765\u8bf4\uff0c\u8fd9\u4e2a\u7269\u4ef6\u662f addon.json \u6587\u4ef6\u4e2d\u7684\u4efb\u4f55\u53ef\u7528\u503c\uff0c\u6216\u8005 AddOn \u5b9e\u4f53\u3002","title":"\u81ea\u5b9a\u4e49\u6784\u5efa\u8fc7\u7a0b"},{"location":"development-tools/#_14","text":"\u5176\u5b9e\u4e0e\u5f00\u53d1\u76f8\u5173\u7684\u547d\u4ee4\u6709\u4e0d\u5c11\uff0c\u4f46\u8fd9\u91cc\u53ea\u4ecb\u7ecd\u6700\u91cd\u8981\u7684\u4e24\u4e2a\u3002 \u8981\u4f7f\u7528\u8fd9\u4e9b\u547d\u4ee4\uff0c\u4f60\u5fc5\u987b\u5728\u4f60\u7684 config.php \u6587\u4ef6\u4e2d\u6fc0\u6d3b \u5f00\u53d1\u6a21\u5f0f \u3002 Warning \u5982\u679c\u51fa\u73b0\u6570\u636e\u5e93\u548c _output \u76ee\u5f55\u4e0d\u540c\u6b65\u7684\u60c5\u51b5\uff0c\u4ee5\u4e0b\u4e24\u4e2a\u547d\u4ee4\u90fd\u6709\u53ef\u80fd\u5bfc\u81f4\u6570\u636e\u4e22\u5931\u3002\u5efa\u8bae\u4f7f\u7528 VCS (\u7248\u672c\u63a7\u5236\u7cfb\u7edf)\uff0c\u5982 GitHub \u6765\u51cf\u8f7b\u8fd9\u79cd\u9519\u8bef\u7684\u5f71\u54cd\u3002","title":"\u5f00\u53d1\u547d\u4ee4"},{"location":"development-tools/#_15","text":"Terminal $ php cmd.php xf-dev:import --addon [addon_id] \u8fd0\u884c\u6b64\u547d\u4ee4\u5c06\u628a\u4f60\u7684\u9644\u52a0\u7ec4\u4ef6 _output \u76ee\u5f55\u4e0b\u7684\u6240\u6709\u5f00\u53d1\u65f6\u8f93\u51fa\u7684\u6587\u4ef6\u5bfc\u5165\u8fdb\u6570\u636e\u5e93\u91cc\u3002","title":"\u5bfc\u5165\u5f00\u53d1\u8f93\u51fa"},{"location":"development-tools/#_16","text":"Terminal $ php cmd.php xf-dev:export --addon [addon_id] \u8fd9\u5c06\u628a\u5f53\u524d\u6570\u636e\u5e93\u4e2d\u4e0e\u9644\u52a0\u7ec4\u4ef6\u76f8\u5173\u8054\u7684\u6240\u6709\u6570\u636e\u5bfc\u51fa\u5230 _output \u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\u4e2d\u3002","title":"\u5bfc\u51fa\u5f00\u53d1\u8f93\u51fa"},{"location":"development-tools/#_17","text":"\u5e94\u8be5\u53ef\u4ee5\u8bbe\u7f6e\u4f60\u559c\u6b22\u7684\u8c03\u8bd5\u5de5\u5177\uff08 XDebug\uff0cZend Debugger \u7b49\uff09\u6765\u4e0e XF2 \u4e00\u8d77\u8fd0\u4f5c\u3002 \u867d\u7136\uff0c\u6709\u65f6\u5019\uff0c\u8c03\u8bd5\u4ee3\u7801\u53ef\u80fd\u8c61\u5feb\u901f\u67e5\u770b\u4e00\u4e2a\u53d8\u91cf\u5728\u7ed9\u5b9a\u65f6\u95f4\u5185\u6301\u6709\u7684\u503c\uff08\u6216\u503c\u7c7b\u578b\uff09\u4e00\u6837\u7b80\u964b\u3002","title":"\u8c03\u8bd5\u4ee3\u7801"},{"location":"development-tools/#dump","text":"\u5f53\u7136 PHP \u6709\u4e00\u4e2a\u5185\u7f6e\u7684\u5de5\u5177\u6765\u5904\u7406\u8fd9\u4e2a\u95ee\u9898\uff0c\u60a8\u53ef\u80fd\u5c06\u5176\u79f0\u4e3a var_dump() \u3002 XF \u63d0\u4f9b\u4e86\u4e24\u4e2a\u66ff\u4ee3\u65b9\u6cd5\u6765\u5904\u7406\u8fd9\u4e2a\u95ee\u9898\uff1a \\XF::dump($var); \\XF::dumpSimple($var); \u7b80\u5358\u7248\u672c\u4e3b\u8981\u662f\u5c06\u4e00\u4e2a\u53d8\u91cf\u7684\u503c\u4ee5\u7eaf\u6587\u672c\u7684\u5f62\u5f0f\u8ee2\u50a8\u51fa\u6765\u3002 \u4f8b\u5982\uff0c\u5982\u679c\u4f60\u53ea\u662f\u7528\u5b83\u6765\u8ee2\u50a8\u4e00\u4e2a\u6570\u7ec4\u7684\u503c\uff0c\u4f60\u4f1a\u5728\u9875\u9762\u9876\u90e8\u770b\u5230\u8fd9\u6837\u7684\u8f93\u51fa\uff1a array(2) { [\"user_id\"] => int(1) [\"username\"] => string(5) \"Admin\" } \u8fd9\u5b9e\u9645\u4e0a\u662f\u4e0e\u6807\u51c6\u7684 var_dump \u76f8\u540c\u7684\u8f93\u51fa\uff0c\u4f46\u4e3a\u4e86\u53ef\u8bfb\u6027\u7a0d\u4f5c\u4fee\u6539\uff0c\u5e76\u5c06\u5176\u5305\u88f9\u5728 <pre> \u6807\u7b7e\u4e2d\uff0c\u4ee5\u786e\u4fdd\u5728\u55a7\u67d3\u65f6\u4fdd\u7559\u7a7a\u767d\u3002 \u8fd9\u4e2a\u66ff\u4ee3\u65b9\u6848\u5b9e\u9645\u4e0a\u662f Symfony \u9879\u76ee\u4e2d\u7684\u4e00\u4e2a\u540d\u4e3a VarDumper \u7684\u7ec4\u4ef6\u3002 \u5b83\u8f93\u51fa HTML\u3001 CSS \u548c JS \u6765\u521b\u5efa\u4e00\u4e2a\u529f\u80fd\u66f4\u5f3a\u3001\u66f4\u5bb9\u6613\u9605\u8bfb\u7684\u8f93\u51fa\u3002 \u5b83\u5141\u8bb8\u4f60\u6298\u53e0\u67d0\u4e9b\u90e8\u5206\uff0c\u5bf9\u4e8e\u67d0\u4e9b\u53ef\u4ee5\u8f93\u51fa\u5927\u91cf\u6570\u636e\u7684\u503c\uff0c\u6bd4\u5982\u7269\u4ef6\uff0c\u5b83\u53ef\u4ee5\u81ea\u52a8\u6298\u53e0\u8fd9\u4e9b\u90e8\u5206\u3002","title":"Dump \u53d8\u91cf"},{"location":"entities-finders-repositories/","text":"\u6570\u636e\u5b9e\u4f53\u3001\u67e5\u627e\u5668\u3001\u4fdd\u5b58\u5e93 \u00b6 \u5728 XF2 \u4e2d\uff0c\u6709\u8bb8\u591a\u4e0e\u6570\u636e\u4ea4\u4e92\u7684\u65b9\u6cd5\u3002 \u5728 XF1 \u4e2d\uff0c\u8fd9\u4e3b\u8981\u662f\u9488\u5bf9\u5728 Model \u6587\u4ef6\u4e2d\u5199\u51fa\u539f\u59cb SQL \u8bed\u53e5\u3002 XF2 \u4e2d\u7684\u65b9\u6cd5\u5df2\u7ecf\u8131\u79bb\u4e86\u8fd9\u4e00\u70b9\uff0c\u6211\u4eec\u589e\u52a0\u4e86\u4e00\u4e9b\u65b0\u7684\u65b9\u6cd5\u3002 \u6211\u4eec\u9996\u5148\u6765\u770b\u4e00\u4e0b\u8fd0\u884c\u6570\u636e\u5e93\u67e5\u627e\u7684\u9996\u9009\u65b9\u6cd5 - Finder\u3002 Finder (\u67e5\u627e\u5668\u7cfb\u7edf) \u00b6 \u6211\u4eec\u5f15\u5165\u4e86\u4e00\u4e2a\u65b0\u7684 \"Finder\" \u7cfb\u7edf\uff0c\u5b83\u5141\u8bb8\u4ee5\u7269\u4ef6\u5bfc\u5411\u7684\u65b9\u5f0f\u4ee5\u7f16\u7a0b\u65b9\u5f0f\u521b\u5efa\u67e5\u627e\uff0c\u8fd9\u6837\u5c31\u4e0d\u9700\u8981\u7f16\u5199\u539f\u59cb\u6570\u636e\u5e93\u67e5\u627e\u3002 Finder \u7cfb\u7edf\u4e0e Entity \u7cfb\u7edf\u643a\u624b\u5408\u4f5c\uff0c\u6211\u4eec\u5728\u4e0b\u9762\u8be6\u7ec6\u4ecb\u7ecd\u3002 \u4f20\u5165 finder \u65b9\u6cd5\u7684\u7b2c\u4e00\u4e2a\u53c2\u6570\u662f\u4f60\u8981\u5904\u7406\u7684 Entity \u7684\u77ed\u7c7b\u540d\u3002 \u6211\u4eec\u5c31\u628a\u4e0a\u9762\u4e00\u8282\u4e2d\u63d0\u5230\u7684\u4e00\u4e9b\u67e5\u627e\u8ee2\u6362\u4e3a\u4f7f\u7528 finder \u7cfb\u7edf\u6765\u4ee3\u66ff\u3002 \u4f8b\u5982\uff0c\u8981\u8bbf\u95ee\u5358\u4e2a\u7528\u6237\u8bb0\u5f55\uff1a $finder = \\XF::finder('XF:User'); $user = $finder->where('user_id', 1)->fetchOne(); \u76f4\u63a5\u67e5\u627e\u65b9\u6cd5\u4e0e\u4f7f\u7528 Finder \u4e4b\u95f4\u7684\u4e3b\u8981\u533a\u522b\u4e4b\u4e00\u662f Finder \u8fd4\u56de\u7684\u6570\u636e\u57fa\u672c\u5358\u4f4d\u4e0d\u662f\u4e00\u4e2a\u6570\u7ec4\u3002 \u5728 Finder \u7269\u4ef6\u8c03\u7528 fetchOne \u65b9\u6cd5\u7684\u60c5\u51b5\u4e0b\uff08\u8be5\u65b9\u6cd5\u53ea\u4ece\u6570\u636e\u5e93\u4e2d\u8fd4\u56de\u5358\u4e2a row \uff09\uff0c\u5c06\u8fd4\u56de\u5358\u4e2a Entity \u7269\u4ef6\u3002 \u8ba9\u6211\u4eec\u770b\u770b\u4e00\u4e2a\u7a0d\u5fae\u4e0d\u540c\u7684\u65b9\u6cd5\uff0c\u5b83\u5c06\u8fd4\u56de\u591a\u4e2a row\uff1a $finder = \\XF::finder('XF:User'); $users = $finder->limit(10)->fetch(); \u8fd9\u4e2a\u4f8b\u5b50\u5c06\u4ece xf_user \u8d44\u6599\u8868\u4e2d\u67e5\u627e 10 \u6761\u8bb0\u5f55\uff0c\u5e76\u4ee5 ArrayCollection \u7269\u4ef6\u7684\u5f62\u5f0f\u8fd4\u56de\u3002 \u8fd9\u662f\u4e00\u4e2a\u7279\u6b8a\u7684\u7269\u4ef6\uff0c\u5b83\u7684\u4f5c\u7528\u7c7b\u4f3c\u4e8e\u4e00\u4e2a\u6570\u7ec4\uff0c\u56e0\u4e3a\u5b83\u662f\u53ef\u4ee5\u904d\u5386\u7684\uff08\u4f60\u53ef\u4ee5\u5728\u5b83\u91cc\u9762\u5faa\u73af\uff09\uff0c\u800c\u4e14\u5b83\u6709\u4e00\u4e9b\u7279\u6b8a\u7684\u65b9\u6cd5\uff0c\u53ef\u4ee5\u544a\u8bc9\u4f60\u5b83\u6240\u62e5\u6709\u7684\u6761\u76ee\u603b\u6570\uff0c\u901a\u8fc7\u67d0\u4e9b\u503c\u8fdb\u884c\u5206\u7ec4\uff0c\u6216\u8005\u5176\u4ed6\u7c7b\u4f3c\u4e8e\u6570\u7ec4\u7684\u64cd\u4f5c\uff0c\u5982\u8fc7\u6ee4\u3001\u5408\u5e76\u3001\u83b7\u53d6\u7b2c\u4e00\u4e2a\u6216\u6700\u540e\u4e00\u4e2a\u6761\u76ee\u7b49\u3002 Finder \u67e5\u627e\uff0c\u4e00\u822c\u5e94\u8be5\u662f\u671f\u671b\u4ece\u8d44\u6599\u8868\u4e2d\u68c0\u7d22\u6240\u6709\u7684 Column\uff0c\u56e0\u6b64\uff0c\u6ca1\u6709\u7279\u5b9a\u7684\u5bf9\u5e94\u5173\u7cfb\u4ec5\u83b7\u53d6\u67d0\u4e9b Column \u4e2d\u7684\u67d0\u4e9b\u503c\u3002 \u76f8\u53cd\uff0c\u5982\u679c\u8981\u83b7\u5f97\u5358\u4e2a\u503c\uff0c\u4f60\u53ea\u9700\u8981\u83b7\u53d6\u4e00\u4e2a Entity\uff0c\u7136\u540e\u76f4\u63a5\u4ece\u8fd9\u4e2a Entity \u4e2d\u8bfb\u53d6\u503c\uff1a $finder = \\XF::finder('XF:User'); $username = $finder->where('user_id', 1)->fetchOne()->username; \u540c\u6837\u5730\uff0c\u5982\u679c\u8981\u4ece Column \u4e2d\u83b7\u53d6\u4e00\u4e2a\u6570\u7ec4\u7684\u503c\uff0c\u53ef\u4ee5\u4f7f\u7528 pluckFrom \u65b9\u6cd5\uff1a $finder = \\XF::finder('XF:User'); $usernames = $finder->limit(10)->pluckFrom('username')->fetch(); \u5230\u5f53\u524d\u4e3a\u6b62\uff0c\u6211\u4eec\u5df2\u7ecf\u770b\u5230 Finder \u5e94\u7528\u4e86\u4e00\u4e9b\u7b80\u5358\u7684 where \u548c limit \u7ea6\u675f\u3002 \u6240\u4ee5\u6211\u4eec\u6765\u770b\u770b Finder \u7684\u66f4\u591a\u8be6\u7ec6\u5185\u5bb9\uff0c\u5305\u62ec\u5173\u4e8e where \u65b9\u6cd5\u672c\u8eab\u7684\u66f4\u591a\u7ec6\u8282\u3002 where \u65b9\u6cd5 \u00b6 where \u65b9\u6cd5\u6700\u591a\u53ef\u4ee5\u652f\u63f4\u4e09\u4e2a\u53c2\u6570\u3002 \u7b2c\u4e00\u4e2a\u53c2\u6570\u662f\u6761\u4ef6\u672c\u8eab\uff0c\u4f8b\u5982\u4f60\u8981\u641c\u5bfb\u7684 Column\u3002 \u7b2c\u4e8c\u4e2a\u53c2\u6570\u901a\u5e38\u662f\u8fd0\u7b97\u7b26\u3002 \u7b2c\u4e09\u4e2a\u662f\u88ab\u641c\u5bfb\u7684 value\u3002 \u5982\u679c\u4f60\u53ea\u63d0\u4f9b\u4e86\u4e24\u4e2a\u53c2\u6570\uff0c\u5c31\u8c61\u4f60\u5728\u4e0a\u9762\u770b\u5230\u7684\u90a3\u6837\uff0c\u90a3\u9ebd\u5b83\u81ea\u52a8\u610f\u5473\u7740\u8fd0\u7b97\u7b26\u662f = \u3002 \u4ee5\u4e0b\u662f\u5176\u4ed6\u6709\u6548\u7684\u8fd0\u7b97\u7b26\u5217\u8868\uff1a = <> != > >= < <= LIKE BETWEEN \u6240\u4ee5\uff0c\u5982\u679c\u6211\u4eec\u60f3\u8981\u5f97\u5230\u6700\u8fd1 7 \u5929\u5185\u6ce8\u518c\u7684\u6709\u6548\u7528\u6237\u540d\u5358\uff1a $finder = \\XF::finder('XF:User'); $users = $finder->where('user_state', 'valid')->where('register_date', '>=', time() - 86400 * 7)->fetch(); \u6b63\u5982\u4f60\u6240\u770b\u5230\u7684\uff0c\u4f60\u53ef\u4ee5\u968f\u610f\u8c03\u7528 where \u65b9\u6cd5\uff0c\u4f46\u9664\u6b64\u4e4b\u5916\uff0c\u4f60\u8fd8\u53ef\u4ee5\u9009\u62e9\u4f20\u5165\u4e00\u4e2a\u6570\u7ec4\u505a\u4e3a\u8be5\u65b9\u6cd5\u7684\u552f\u4e00\u53c2\u6570\uff0c\u5e76\u5728\u4e00\u6b21\u8c03\u7528\u4e2d\u521b\u5efa\u4f60\u7684\u6761\u4ef6\u3002 \u6570\u7ec4\u65b9\u6cd5\u652f\u63f4\u4e24\u79cd\u7c7b\u578b\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u4e0a\u9762\u521b\u5efa\u7684\u67e5\u627e\u4e2d\u4f7f\u7528\u8fd9\u4e24\u79cd\u7c7b\u578b\uff1a $finder = \\XF::finder('XF:User'); $users = $finder->where([ 'user_state' => 'valid', ['register_date', '>=', time() - 86400 * 7] ]) ->fetch(); \u901a\u5e38\u4e0d\u5efa\u8bae\u6216\u660e\u786e\u5730\u8fd9\u6837\u6df7\u5408\u4f7f\u7528\uff0c\u4f46\u5b83\u786e\u5b9e\u5728\u4e00\u5b9a\u7a0b\u5ea6\u4e0a\u5c55\u793a\u4e86\u8be5\u65b9\u6cd5\u7684\u970a\u6d3b\u6027\u3002 \u73b0\u5728\u6761\u4ef6\u5df2\u7ecf\u5728\u4e00\u4e2a\u6570\u7ec4\u4e2d\uff0c\u6211\u4eec\u53ef\u4ee5\u6307\u5b9a Column \u540d\uff08\u4f5c\u4e3a\u6570\u7ec4\u7684 key\uff09\u548c\u9690\u5f0f\u7684 = \u8fd0\u7b97\u7b26\u7684 value\uff0c\u6216\u8005\u6211\u4eec\u53ef\u4ee5\u5b9e\u9645\u5b9a\u4e49\u53e6\u4e00\u4e2a\u5305\u542b column\u3001\u8fd0\u7b97\u7b26\u548c value \u7684\u6570\u7ec4\u3002 whereOr \u65b9\u6cd5 \u00b6 \u5728\u4e0a\u9762\u7684\u4f8b\u5b50\u4e2d\uff0c\u4e24\u4e2a\u6761\u4ef6\u90fd\u9700\u8981\u6ee1\u8db3\uff0c\u5373\u6bcf\u4e2a\u6761\u4ef6\u90fd\u7531 AND \u8fd0\u7b97\u7b26\u8fde\u63a5\u3002 \u7136\u800c\uff0c\u6709\u65f6\u9700\u8981\u53ea\u6ee1\u8db3\u90e8\u5206\u6761\u4ef6\uff0c\u8fd9\u53ef\u4ee5\u901a\u8fc7\u4f7f\u7528 whereOr \u65b9\u6cd5\u6765\u5b9e\u73b0\u3002 \u4f8b\u5982\uff0c\u5982\u679c\u4f60\u60f3\u641c\u5bfb\u90a3\u4e9b\u65e0\u6548\u7684\u7528\u6237\u6216\u8005\u662f\u53d1\u5e03\u4e86\u96f6\u5219\u7559\u8a00\u7684\u7528\u6237\uff0c\u4f60\u53ef\u4ee5\u521b\u5efa\u5982\u4e0b\uff1a $finder = \\XF::finder('XF:User'); $users = $finder->whereOr( ['user_state', '<>', 'valid'], ['message_count', 0] )->fetch(); \u4e0e\u4e0a\u4e00\u8282\u7684\u4f8b\u5b50\u7c7b\u4f3c\uff0c\u9664\u4e86\u4f20\u9012\u6700\u591a\u4e24\u4e2a\u6761\u4ef6\u4f5c\u4e3a\u5358\u72ec\u7684\u53c2\u6570\u5916\uff0c\u4f60\u4e5f\u53ef\u4ee5\u53ea\u4f20\u9012\u4e00\u4e2a\u6761\u4ef6\u6570\u7ec4\u5230\u7b2c\u4e00\u4e2a\u53c2\u6570\uff1a $finder = \\XF::finder('XF:User'); $users = $finder->whereOr([ ['user_state', '<>', 'valid'], ['message_count', 0], ['is_banned', 1] ])->fetch(); with \u65b9\u6cd5 \u00b6 with \u65b9\u6cd5\u672c\u8d28\u4e0a\u7b49\u540c\u4e8e\u4f7f\u7528 INNER|LEFT JOIN \u8bed\u53e5\uff0c\u5c3d\u7ba1\u5b83\u4f9d\u8d56\u4e8e Entity \u5df2\u7ecf\u5b9a\u4e49\u4e86\u5b83\u7684 \"Relation\"\u3002 \u6211\u4eec\u5728\u4e0b\u4e00\u9875\u624d\u4f1a\u8ba8\u8bba\u8fd9\u4e2a\u95ee\u9898\uff0c\u4f46\u8fd9\u5e94\u8be5\u53ea\u662f\u8ba9\u4f60\u4e86\u89e3\u5b83\u662f\u5982\u4f55\u8fd0\u4f5c\u7684\u3002 \u73b0\u5728\u8ba9\u6211\u4eec\u4f7f\u7528\u4e3b\u9898 finder \u6765\u68c0\u7d22\u4e00\u4e2a\u7279\u5b9a\u7684\u4e3b\u9898\uff1a $finder = \\XF::finder('XF:Thread'); $thread = $finder->with('Forum', true)->where('thread_id', 123)->fetchOne(); \u8fd9\u4e2a\u67e5\u627e\u5c06\u83b7\u53d6 thread_id = 123 \u7684\u4e3b\u9898\u5b9e\u4f53\uff0c\u4f46\u5b83\u4e5f\u4f1a\u5728\u80cc\u666f\u4e0e xf_forum \u8d44\u6599\u8868\u8fdb\u884c join\u3002 \u5728\u63a7\u5236\u5982\u4f55\u505a INNER JOIN \u800c\u4e0d\u662f LEFT JOIN \u65b9\u9762\uff0c\u8fd9\u5c31\u662f\u7b2c\u4e8c\u4e2a\u53c2\u6570\u7684\u4f5c\u7528\u3002 \u5728\u672c\u4f8b\u4e2d\uff0c\u6211\u4eec\u5c06 \"must exist\" \u53c2\u6570\u8bbe\u7f6e\u4e3a true\uff0c\u6240\u4ee5\u5b83\u4f1a\u628a\u8fde\u63a5\u8bed\u53e5\u8ee2\u6362\u4e3a\u4f7f\u7528 INNER \u800c\u4e0d\u662f\u9ed8\u8ba4\u7684 LEFT \u3002 \u6211\u4eec\u5c06\u5728\u4e0b\u4e00\u8282\u8be6\u7ec6\u4ecb\u7ecd\u5982\u4f55\u8bbf\u95ee\u4ece\u8fd9\u4e2a join \u83b7\u53d6\u7684\u6570\u636e\u3002 \u4e5f\u53ef\u4ee5\u5728 with \u65b9\u6cd5\u4e2d\u4f20\u9012\u4e00\u4e2a Relation \u6570\u7ec4\u6765\u8fdb\u884c\u591a\u91cd join\u3002 $finder = \\XF::finder('XF:Thread'); $thread = $finder->with(['Forum', 'User'], true)->where('thread_id', 123)->fetchOne(); \u8fd9\u5c06\u4f1a join \u5230 xf_user \u8d44\u6599\u8868\u4ee5\u83b7\u5f97\u4e3b\u9898\u4f5c\u8005\u3002 \u7136\u800c\uff0c\u7531\u4e8e\u7b2c\u4e8c\u4e2a\u53c2\u6570\u4ecd\u7136\u662f true \uff0c\u6211\u4eec\u53ef\u80fd\u4e0d\u9700\u8981\u4e3a User join \u505a\u4e00\u4e2a INNER join\uff0c\u6240\u4ee5\uff0c\u6211\u4eec\u53ef\u4ee5\u7528 chain \u65b9\u6cd5\u4ee3\u66ff\uff1a $finder = \\XF::finder('XF:Thread'); $thread = $finder->with('Forum', true)->with('User')->where('thread_id', 123)->fetchOne(); order, limit \u548c limitByPage \u65b9\u6cd5 \u00b6 order \u65b9\u6cd5 \u00b6 \u8fd9\u4e2a\u65b9\u6cd5\u5141\u8bb8\u4f60\u6309\u7167\u7279\u5b9a\u7684\u987a\u5e8f\u6765\u4fee\u6539\u4f60\u7684\u67e5\u627e\u83b7\u53d6\u7ed3\u679c\u3002 \u5b83\u9700\u8981\u4e24\u4e2a\u53c2\u6570\uff0c\u7b2c\u4e00\u4e2a\u662f column \u540d\uff0c\u7b2c\u4e8c\u4e2a\u662f\u53ef\u9009\u7684\u6392\u5e8f\u65b9\u5411\u3002 \u6240\u4ee5\uff0c\u5982\u679c\u4f60\u60f3\u5217\u51fa\u62e5\u6709\u6700\u591a\u7559\u8a00\u7684 10 \u4e2a\u7528\u6237\uff0c\u4f60\u53ef\u4ee5\u521b\u5efa\u50cf\u8fd9\u6837\u7684\u67e5\u627e\uff1a $finder = \\XF::finder('XF:User'); $users = $finder->order('message_count', 'DESC')->limit(10); Note \u73b0\u5728\u53ef\u80fd\u662f\u4e00\u4e2a\u5f88\u597d\u7684\u65f6\u673a\u6765\u63d0\u53ca\uff0cfinder \u65b9\u6cd5\u5927\u591a\u53ef\u4ee5\u6309\u7167\u4efb\u4f55\u987a\u5e8f\u8c03\u7528\u3002 \u4f8b\u5982\uff1a $threads = $finder->limit(10)->where('thread_id', '>', 123)->order('post_date')->with('User')->fetch(); \u867d\u7136\u5982\u679c\u4f60\u6309\u7167\u8fd9\u4e2a\u987a\u5e8f\u5199\u4e00\u4e2a MySQL \u67e5\u627e\uff0c\u80af\u5b9a\u4f1a\u9047\u5230\u4e00\u4e9b\u8bed\u6cd5\u95ee\u9898\uff0c\u4f46 Finder \u7cfb\u7edf\u8fd8\u662f\u4f1a\u6309\u7167\u6b63\u786e\u7684\u987a\u5e8f\u6765\u6784\u5efa\uff0c\u4e0a\u9762\u7684\u4ee3\u7801\u867d\u7136\u770b\u8d77\u6765\u5f88\u5947\u602a\uff0c\u53ef\u80fd\u4e5f\u4e0d\u5efa\u8bae\u4f7f\u7528\uff0c\u4f46\u90a3\u6837\u5199\u786e\u5b9e\u662f\u5b8c\u5168\u6b63\u786e\u7684\u3002 \u4e0e\u6807\u51c6\u7684 MySQL \u67e5\u627e\u4e00\u6837\uff0c\u53ef\u4ee5\u5bf9\u591a\u4e2a Column \u7684\u7ed3\u679c\u96c6\u8fdb\u884c\u6392\u5e8f\u3002 \u8981\u505a\u5230\u8fd9\u4e00\u70b9\uff0c\u4f60\u53ef\u4ee5\u518d\u6b21\u8c03\u7528 order \u65b9\u6cd5\u3002 \u4e5f\u53ef\u4ee5\u4f7f\u7528\u6570\u7ec4\u5c06\u591a\u4e2a order \u5b50\u53e5\u4f20\u9012\u5230 order \u65b9\u6cd5\u4e2d\u3002 $finder = \\XF::finder('XF:User'); $users = $finder->order('message_count', 'DESC')->order('register_date')->limit(10); limit \u65b9\u6cd5 \u00b6 \u6211\u4eec\u5df2\u7ecf\u770b\u5230\u4e86\u5982\u4f55\u5c06\u67e5\u627e limit \u5728\u7279\u5b9a\u6570\u91cf\u7684\u8bb0\u5f55\u4e0a\uff1a $finder = \\XF::finder('XF:User'); $users = $finder->limit(10)->fetch(); \u4e0d\u8fc7\uff0c\u5176\u5b9e\u8fd8\u6709\u4e00\u4e2a\u529e\u6cd5\u53ef\u4ee5\u76f4\u63a5\u8c03\u7528 limit \u65b9\u6cd5\uff1a $finder = \\XF::finder('XF:User'); $users = $finder->fetch(10); \u53ef\u4ee5\u76f4\u63a5\u5c06\u4f60\u7684 limit \u4f20\u5165 fetch() \u65b9\u6cd5\u3002 \u53e6\u5916\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0c limit \uff08\u548c fetch \uff09\u65b9\u6cd5\u652f\u63f4\u4e24\u4e2a\u53c2\u6570\u3002 \u7b2c\u4e00\u4e2a\u663e\u7136\u662f limit\uff0c\u7b2c\u4e8c\u4e2a\u662f offset\u3002 $finder = \\XF::finder('XF:User'); $users = $finder->limit(10, 100)->fetch(); \u8fd9\u91cc\u7684 offset \u57fa\u672c\u4e0a\u610f\u5473\u7740\u524d 100 \u4e2a\u7ed3\u679c\u5c06\u88ab\u5f03\u7528\uff0c\u4e4b\u540e\u7684\u524d 10 \u4e2a\u7ed3\u679c\u5c06\u88ab\u8fd4\u56de\u3002 \u8fd9\u79cd\u65b9\u6cd5\u5bf9\u4e8e\u63d0\u4f9b\u5206\u9875\u7ed3\u679c\u662f\u5f88\u6709\u7528\u7684\uff0c\u4e0d\u8fc7\u6211\u4eec\u5176\u5b9e\u4e5f\u6709\u4e00\u4e2a\u66f4\u7b80\u5358\u7684\u65b9\u6cd5... limitByPage \u65b9\u6cd5 \u00b6 \u8fd9\u4e2a\u65b9\u6cd5\u662f\u4e00\u79cd\u8f85\u52a9\u65b9\u6cd5\uff0c\u6700\u7ec8\u4f1a\u6839\u636e\u4f60\u5f53\u524d\u89c6\u56fe\u7684 \"\u9875\u9762\" \u548c\u4f60\u6240\u9700\u8981\u7684 \"\u6bcf\u9875\" \u6570\u91cf\u6765\u8bbe\u7f6e\u76f8\u5e94\u7684 limit \u548c offset\u3002 $finder = \\XF::finder('XF:User'); $users = $finder->limitByPage(3, 20); \u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0climit \u5c06\u88ab\u8bbe\u7f6e\u4e3a 20\uff08\u8fd9\u662f\u6211\u4eec\u6bcf\u9875\u7684\u503c\uff09\uff0coffset \u5c06\u88ab\u8bbe\u7f6e\u4e3a 40\uff0c\u56e0\u4e3a\u6211\u4eec\u4ece\u7b2c 3 \u9875\u5f00\u59cb\u3002 \u5076\u5c14\uff0c\u6211\u4eec\u9700\u8981\u6293\u53d6\u8d85\u8fc7 limit \u7684\u989d\u5916\u6570\u636e\u3002 Over-fetching \u53ef\u4ee5\u5e2e\u52a9\u4fa6\u6d4b\u4f60\u5728\u5f53\u524d\u9875\u9762\u4e4b\u540e\u662f\u5426\u6709\u989d\u5916\u7684\u6570\u636e\u8981\u663e\u793a\uff0c\u6216\u8005\u4f60\u662f\u5426\u9700\u8981\u6839\u636e\u6743\u9650\u8fc7\u6ee4\u8bbe\u7f6e\u4e0b\u6765\u7684\u521d\u59cb\u7ed3\u679c\u3002 \u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u7b2c\u4e09\u4e2a\u53c2\u6570\u6765\u5b9e\u73b0\uff1a $finder = \\XF::finder('XF:User'); $users = $finder->limitByPage(3, 20, 1); \u8fd9\u6837\u4e00\u6765\uff0c\u4ece\u7b2c 3 \u9875\u5f00\u59cb\uff0c\u603b\u5171\u6700\u591a\u53ef\u83b7\u5f97 21\u4e2a \u7528\u6237\uff0820+1\uff09\u3002 getQuery \u65b9\u6cd5 \u00b6 \u5f53\u4f60\u7b2c\u4e00\u6b21\u5f00\u59cb\u4f7f\u7528 finder \u65f6\uff0c\u5c3d\u7ba1\u5b83\u5f88\u76f4\u89b3\uff0c\u4f46\u4f60\u53ef\u80fd\u5076\u5c14\u4f1a\u60f3\u77e5\u9053\u4f60\u662f\u5426\u6b63\u786e\u5730\u4f7f\u7528\u4e86\u5b83\uff0c\u4ee5\u53ca\u5b83\u662f\u5426\u4f1a\u521b\u5efa\u4f60\u671f\u671b\u7684\u67e5\u627e\u3002 \u6211\u4eec\u6709\u4e00\u4e2a\u540d\u4e3a getQuery \u7684\u65b9\u6cd5\uff0c\u5b83\u53ef\u4ee5\u544a\u8bc9\u6211\u4eec\u5f53\u524d\u7684 finder \u7269\u4ef6\u5c06\u521b\u5efa\u7684\u67e5\u627e\u3002 \u4f8b\u5982\uff1a $finder = \\XF::finder('XF:User') ->where('user_id', 1); \\XF::dumpSimple($finder->getQuery()); \u8fd9\u5c06\u8f93\u51fa\u7c7b\u4f3c\u4e8e\u4ee5\u4e0b\u7684\u8bed\u53e5\uff1a string(67) \"SELECT `xf_user`.* FROM `xf_user` WHERE (`xf_user`.`user_id` = 1)\" \u4f60\u53ef\u80fd\u4e0d\u4f1a\u7ecf\u5e38\u9700\u8981\u5b83\uff0c\u4f46\u5982\u679c finder \u6ca1\u6709\u8fd4\u56de\u4f60\u6240\u671f\u671b\u7684\u7ed3\u679c\uff0c\u90a3\u5b83\u53ef\u80fd\u4f1a\u5f88\u6709\u5e2e\u52a9\u3002 \u5728 Dump \u53d8\u91cf \u90e8\u5206\u9605\u8bfb\u66f4\u591a\u5173\u4e8e dumpSimple \u65b9\u6cd5\u7684\u5185\u5bb9\u3002 \u81ea\u5b9a\u4e49 finder \u65b9\u6cd5 \u00b6 \u5230\u5f53\u524d\u4e3a\u6b62\uff0c\u6211\u4eec\u5df2\u7ecf\u770b\u5230 finder \u7269\u4ef6\u88ab\u8bbe\u7f6e\u4e86\u4e00\u4e2a\u7c7b\u4f3c\u4e8e XF:User \u548c XF:Thread \u7684\u53c2\u6570\u3002 \u5728\u5927\u591a\u6570\u60c5\u51b5\u4e0b\uff0c\u8fd9\u6807\u8bc6\u4e86 finder \u6b63\u5728\u5904\u7406\u7684 Entity \u7c7b\uff0c\u5e76\u5c06\u89e3\u6790\u4e3a\uff0c\u4f8b\u5982\uff0c XF/Entity/User \u3002 \u7136\u800c\uff0c\u5b83\u4e5f\u53ef\u4ee5\u53e6\u5916\u4ee3\u8868\u4e00\u4e2a finder \u7c7b\u3002 finder \u7c7b\u662f\u53ef\u9009\u7684\uff0c\u4f46\u5b83\u4eec\u53ef\u4ee5\u4f5c\u4e3a\u4e00\u79cd\u65b9\u6cd5\u6765\u4e3a\u7279\u5b9a\u7684 finder \u7c7b\u578b\u6dfb\u52a0\u81ea\u5b9a\u4e49 finder \u65b9\u6cd5\u3002 \u4e3a\u4e86\u770b\u5230\u8fd9\u4e00\u70b9\uff0c\u8ba9\u6211\u4eec\u770b\u770b\u4e0e XF:User \u76f8\u5173\u7684 finder \u7c7b\uff0c\u5b83\u53ef\u4ee5\u5728 XF\\FinderUser \u7c7b\u4e2d\u627e\u5230\u3002 \u4e0b\u9762\u793a\u4f8b\u662f\u8be5 class \u4e2d\u7684\u4e00\u4e2a finder \u65b9\u6cd5\uff1a public function isRecentlyActive($days = 180) { $this->where('last_activity', '>', time() - ($days * 86400)); return $this; } \u73b0\u5728\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u4efb\u4f55 User finder \u7269\u4ef6\u4e0a\u8c03\u7528\u8be5\u65b9\u6cd5\u3002 \u6240\u4ee5\uff0c\u5982\u679c\u6211\u4eec\u62ff\u524d\u9762\u7684\u4e00\u4e2a\u4f8b\u5b50\u6765\u8bf4\uff1a $finder = \\XF::finder('XF:User'); $users = $finder->isRecentlyActive(20)->order('message_count', 'DESC')->limit(10); \u8fd9\u4e2a\u67e5\u627e\uff0c\u4e4b\u524d\u53ea\u662f\u6309\u7167\u7559\u8a00\u6570\u964d\u5e8f\u8fd4\u56de 10 \u4e2a\u7528\u6237\uff0c\u73b0\u5728\u5c06\u6309\u8fd9\u4e2a\u987a\u5e8f\u8fd4\u56de\u6700\u8fd1 20 \u5929\u5185\u6d3b\u8dc3\u7684 10 \u4e2a\u7528\u6237\u3002 \u5c3d\u7ba1\u5bf9\u4e8e\u5f88\u591a Entity \u7c7b\u578b\u6765\u8bf4\uff0cfinder \u7c7b\u662f\u4e0d\u5b58\u5728\u7684\uff0c\u4f46\u4ecd\u7136\u53ef\u4ee5\u901a\u8fc7 \u7ee7\u627f\u7c7b \u4e00\u8282\u4e2d\u63d0\u5230\u7684\u76f8\u540c\u65b9\u5f0f\u6765\u7ee7\u627f\u8fd9\u4e9b\u4e0d\u5b58\u5728\u7684\u7c7b\u3002 The Entity system (\u5b9e\u4f53\u7cfb\u7edf) \u00b6 \u5982\u679c\u60a8\u719f\u6089 XF1\uff0c\u60a8\u53ef\u80fd\u4f1a\u719f\u6089 Entity \u80cc\u540e\u7684\u4e00\u4e9b\u6982\u5ff5\uff0c\u56e0\u4e3a\u5b83\u4eec\u6700\u7ec8\u662f\u4ece\u90a3\u91cc\u7684 DataWriter \u7cfb\u7edf\u884d\u751f\u51fa\u6765\u7684\u3002 \u5982\u679c\u60a8\u5bf9\u5b83\u4eec\u4e0d\u662f\u5f88\u719f\u6089\uff0c\u4e0b\u9762\u7684\u90e8\u5206\u5e94\u8be5\u4f1a\u8ba9\u60a8\u6709\u6240\u4e86\u89e3\u3002 Entity structure (\u5b9e\u4f53\u7ed3\u6784) \u00b6 Structure \u7269\u4ef6\u7531\u4e00\u4e9b\u5c5e\u6027\u7ec4\u6210\uff0c\u8fd9\u4e9b\u5c5e\u6027\u5b9a\u4e49\u4e86 Entity \u7684 Structure \u548c\u5b83\u6240\u6d89\u53ca\u7684\u8d44\u6599\u8868\u3002 Structure \u7269\u4ef6\u672c\u8eab\u5c31\u8bbe\u7f6e\u5728\u5b83\u6240\u6d89\u53ca\u7684 Entity \u5185\u90e8\u3002 \u6211\u4eec\u6765\u770b\u770b User Entity \u4e2d\u7684\u4e00\u4e9b\u5e38\u7528\u5c5e\u6027\uff1a Table (\u8d44\u6599\u8868) \u00b6 $structure->table = 'xf_user'; \u5b83\u8bf4\u660e\u4e86 Entity \u5728 Update \u548c Insert \u8bb0\u5f55\u65f6\u4f7f\u7528\u54ea\u5f20\u8d44\u6599\u8868\uff0c\u4e5f\u544a\u8bc9\u6211\u4eec Finder \u5728\u6784\u5efa\u67e5\u627e\u8fd0\u884c\u65f6\u4ece\u54ea\u5f20\u8d44\u6599\u8868\u8bfb\u53d6\u3002 \u6b64\u5916\uff0c\u5b83\u8fd8\u77e5\u9053\u4f60\u7684\u67e5\u627e\u9700\u8981 join \u5230\u54ea\u4e9b\u5176\u4ed6\u8d44\u6599\u8868\u4e2d\u8d77\u5230\u4e86\u4f5c\u7528\u3002 Short name (\u7b80\u77ed\u540d) \u00b6 $structure->shortName = 'XF:User'; \u8fd9\u53ea\u662f Entity \u672c\u8eab\u548c Finder \u7c7b\uff08\u5982\u679c\u9002\u7528\uff09\u7684\u77ed\u7c7b\u540d\u3002 Content type (\u5185\u5bb9\u7c7b\u578b) \u00b6 $structure->contentType = 'user'; \u8fd9\u5b9a\u4e49\u4e86\u8fd9\u4e2a Entity \u4ee3\u8868\u7684\u5185\u5bb9\u7c7b\u578b\u3002 \u5728\u5927\u591a\u6570 Entity \u7ed3\u6784\u4e2d\u4e0d\u4f1a\u9700\u8981\u8fd9\u4e2a\u3002 \u5b83\u7528\u4e8e\u8fde\u63a5\u5230 \"content type\" \u7cfb\u7edf\u4f7f\u7528\u7684\u7279\u5b9a\u4e8b\u7269\uff08\u8fd9\u5c06\u5728\u53e6\u4e00\u8282\u4e2d\u4ecb\u7ecd\uff09\u3002 Primary key (\u4e3b\u952e) \u00b6 $structure->primaryKey = 'user_id'; \u5b9a\u4e49\u4e86\u4ee3\u8868\u8d44\u6599\u8868\u4e2d Primary key \u7684 Column\uff0c\u5982\u679c\u4e00\u4e2a\u8d44\u6599\u8868\u652f\u63f4\u591a\u4e2a Column \u4f5c\u4e3a Primary key\uff0c\u90a3\u9ebd\u53ef\u4ee5\u5b9a\u4e49\u4e3a\u6570\u7ec4\u3002 Columns (\u591a\u884c\u6570\u636e) \u00b6 $structure->columns = [ 'user_id' => ['type' => self::UINT, 'autoIncrement' => true, 'nullable' => true, 'changeLog' => false], 'username' => ['type' => self::STR, 'maxLength' => 50, 'required' => 'please_enter_valid_name' ] // \u8fd8\u6709\u66f4\u591a\u7684 columns... ]; \u8fd9\u662f Entity \u8bbe\u7f6e\u7684\u5173\u952e\u90e8\u5206\uff0c\u56e0\u4e3a\u8fd9\u91cc\u9762\u4f1a\u8be6\u7ec6\u89e3\u91ca Entity \u8d1f\u8d23\u7684\u6bcf\u4e2a\u6570\u636e\u5e93 column \u7684\u5177\u4f53\u60c5\u51b5\u3002 \u8fd9\u544a\u8bc9\u6211\u4eec\u9884\u671f\u7684\u6570\u636e\u7c7b\u578b\uff0c\u662f\u5426\u9700\u8981\u4e00\u4e2a\u503c\uff0c\u5b83\u5e94\u8be5\u5339\u914d\u4ec0\u9ebd\u683c\u5f0f\uff0c\u662f\u5426\u5e94\u8be5\u662f\u552f\u4e00\u503c\uff0c\u5b83\u7684\u9ed8\u8ba4\u503c\u662f\u4ec0\u9ebd\uff0c\u7b49\u7b49\u3002 \u6839\u636e type \uff0cEntity \u7ba1\u7406\u5668\u77e5\u9053\u662f\u5426\u4ee5\u67d0\u79cd\u65b9\u5f0f\u5bf9\u4e00\u4e2a\u503c\u8fdb\u884c\u7f16\u7801\u6216\u89e3\u7801\u3002 \u8fd9\u53ef\u4ee5\u662f\u4e00\u4e2a\u7b80\u5358\u7684\u8fc7\u7a0b\uff0c\u5c06\u4e00\u4e2a\u503c\u8ee2\u6362\u4e3a\u4e00\u4e2a\u5b57\u7b26\u4e32\u6216\u6574\u6570\uff0c\u6216\u8005\u7a0d\u5fae\u590d\u6742\u4e00\u70b9\uff0c\u4f8b\u5982\u5728\u5411\u6570\u636e\u5e93\u5199\u5165\u65f6\uff0c\u5bf9\u4e00\u4e2a\u6570\u7ec4\u4f7f\u7528 json_encode() \uff0c\u6216\u8005\u5728\u4ece\u6570\u636e\u5e93\u8bfb\u53d6\u65f6\uff0c\u5bf9\u4e00\u4e2a JSON \u5b57\u7b26\u4e32\u4f7f\u7528 json_decode() \uff0c\u4ee5\u4fbf\u5c06\u8be5\u503c\u4f5c\u4e3a\u4e00\u4e2a\u6570\u7ec4\u6b63\u786e\u5730\u8fd4\u56de\u7ed9 Entity \u7269\u4ef6\uff0c\u800c\u4e0d\u9700\u8981\u6211\u4eec\u624b\u52a8\u8fd9\u6837\u505a\u3002 \u5b83\u8fd8\u53ef\u4ee5\u652f\u63f4\u5bf9\u9017\u53f7\u5206\u9694\u7684\u503c\u8fdb\u884c\u9002\u5f53\u7684\u7f16\u7801/\u89e3\u7801\u3002 \u5076\u5c14\u9700\u8981\u5728\u5199\u5165\u4e00\u4e2a\u503c\u4e4b\u524d\u5bf9\u5176\u8fdb\u884c\u4e00\u4e9b\u989d\u5916\u7684\u9a8c\u8bc1\u6216\u4fee\u6539\u3002 \u4e3e\u4e2a\u4f8b\u5b50\uff0c\u5728 User Entity \u4e2d\uff0c\u8bf7\u770b verifyStyleId() \u65b9\u6cd5\u3002 \u5f53\u5728 style_id \u5b57\u6bb5\u4e0a\u8bbe\u7f6e\u4e00\u4e2a\u503c\u65f6\uff0c\u6211\u4eec\u4f1a\u81ea\u52a8\u68c0\u67e5\u662f\u5426\u5b58\u5728\u4e00\u4e2a\u540d\u4e3a verifyStyleId() \u7684\u65b9\u6cd5\uff0c\u5982\u679c\u5b58\u5728\uff0c\u6211\u4eec\u4f1a\u5148\u901a\u8fc7\u8be5\u65b9\u6cd5\u8fd0\u884c\u8be5\u503c\u3002 Behaviors (\u884c\u4e3a) \u00b6 $structure->behaviors = [ 'XF:ChangeLoggable' => [] ]; \u8fd9\u662f\u8be5 Entity \u5e94\u4f7f\u7528\u7684 Behaviors \u7c7b\u6570\u7ec4\u3002 Behaviors \u7c7b\u662f\u4e00\u79cd\u5141\u8bb8\u67d0\u4e9b\u4ee3\u7801\u5728\u591a\u79cd Entity \u7c7b\u578b\u4e2d\u901a\u7528\u91cd\u590d\u4f7f\u7528\u7684\u65b9\u5f0f\uff08\u4ec5\u5728 Entity \u53d8\u5316\u65f6\uff0c\u800c\u4e0d\u662f\u5728\u8bfb\u53d6\u65f6\uff09\u3002 \u4e00\u4e2a\u5f88\u597d\u7684\u4f8b\u5b50\u662f XF:Likeable Behaviors\uff0c\u5b83\u80fd\u591f\u5bf9\u652f\u63f4\u53ef\u88ab \"\u70b9\u8cdb\" \u7684\u5185\u5bb9\u5b9e\u4f53\u81ea\u52a8\u8fd0\u884c\u67d0\u4e9b\u64cd\u4f5c\u3002 \u8fd9\u5305\u62ec\u5f53\u5185\u5bb9\u4e2d\u53d1\u751f\u53ef\u89c1\u6027\u53d8\u5316\u65f6\u81ea\u52a8\u91cd\u65b0\u8ba1\u6570\uff0c\u4ee5\u53ca\u5f53\u5185\u5bb9\u88ab\u5220\u9664\u65f6\u81ea\u52a8\u5220\u9664\u70b9\u8cdb\u6570\u3002 Getters (\u83b7\u53d6\u5668) \u00b6 $structure->getters = [ 'is_super_admin' => true, 'last_activity' => true ]; \u5f53\u8c03\u7528 name \u5b57\u6bb5\u65f6\uff0c\u4f1a\u81ea\u52a8\u8c03\u7528 Getter \u65b9\u6cd5\u3002 \u4f8b\u5982\uff0c\u5982\u679c\u6211\u4eec\u4ece User Entity \u4e2d\u8bf7\u6c42 is_super_admin \uff0c\u5c31\u4f1a\u81ea\u52a8\u68c0\u67e5\u5e76\u4f7f\u7528 getIsSuperAdmin() \u65b9\u6cd5\u3002 \u6709\u8da3\u7684\u662f\uff0cxf_user \u8d44\u6599\u8868\u5b9e\u9645\u4e0a\u5e76\u6ca1\u6709\u4e00\u4e2a\u540d\u4e3a is_super_admin \u7684\u5b57\u6bb5\u3002 \u8fd9\u4e2a\u5b57\u6bb5\u5b9e\u9645\u4e0a\u5b58\u5728\u4e8e Admin Entity \u4e2d\uff0c\u4f46\u6211\u4eec\u5c06\u5176\u4f5c\u4e3a\u4e00\u4e2a getter \u65b9\u6cd5\u6dfb\u52a0\u5230\u4e86\u8d44\u6599\u8868\u4e2d\uff0c\u4f5c\u4e3a\u8bbf\u95ee\u8be5\u503c\u7684\u4e00\u79cd\u7b80\u5199\u65b9\u5f0f\u3002 Getter \u65b9\u6cd5\u4e5f\u53ef\u4ee5\u7528\u6765\u76f4\u63a5\u590d\u76d6\u73b0\u6709\u5b57\u6bb5\u7684\u503c\uff0c\u8fd9\u91cc\u7684 last_activity \u503c\u5c31\u662f\u5982\u6b64\u3002 last_activity \u5b9e\u9645\u4e0a\u662f\u4e00\u4e2a\u7f13\u5b58\u503c\uff0c\u901a\u5e38\u5728\u7528\u6237\u767b\u51fa\u65f6\u624d\u4f1a\u66f4\u65b0\u3002 \u7136\u800c\uff0c\u6211\u4eec\u5728 xf_session_activity \u8d44\u6599\u8868\u4e2d\u4fdd\u5b58\u4e86\u7528\u6237\u6700\u65b0\u7684\u6d3b\u52a8\u65e5\u671f\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 getLastActivity \u65b9\u6cd5\u6765\u8fd4\u56de\u8be5\u503c\u800c\u4e0d\u662f\u7f13\u5b58\u7684\u6700\u540e\u6d3b\u52a8\u503c\u3002 \u5982\u679c\u4f60\u9700\u8981\u5b8c\u5168\u7ed5\u8fc7 getter \u65b9\u6cd5\uff0c\u53ea\u9700\u8981\u5f97\u5230\u771f\u6b63\u7684 Entity \u503c\uff0c\u53ea\u9700\u8981\u5728 column \u540d\u540e\u52a0\u4e0a\u4e0b\u5212\u7ebf\uff0c\u4f8b\u5982 $user->last_activity_ \u3002 \u56e0\u4e3a\u4e00\u4e2a Entity \u5c31\u8c61\u5176\u4ed6\u7684 PHP \u7269\u4ef6\u4e00\u6837\uff0c\u4f60\u53ef\u4ee5\u7ed9\u5b83\u4eec\u6dfb\u52a0\u66f4\u591a\u7684\u65b9\u6cd5\u3002 \u4e00\u4e2a\u5e38\u89c1\u7684\u4f7f\u7528\u6848\u4f8b\u662f\u6dfb\u52a0\u4e00\u4e9b\u8c61\u6743\u9650\u68c0\u67e5\u8fd9\u6837\u7684\u65b9\u6cd5\uff0c\u8fd9\u4e9b\u65b9\u6cd5\u53ef\u4ee5\u5728 Entity \u81ea\u8eab\u4e0a\u9762\u8c03\u7528\u3002 Relations (\u5173\u8054) \u00b6 $structure->relations = [ 'Admin' => [ 'entity' => 'XF:Admin', 'type' => self::TO_ONE, 'conditions' => 'user_id', 'primary' => true ] ]; \u8fd9\u5c31\u662f Relations \u7684\u5b9a\u4e49\u3002 \u4ec0\u9ebd\u662f Relations\uff1f \u5b83\u4eec\u5b9a\u4e49\u4e86 Entity \u4e4b\u95f4\u7684\u5173\u8054\uff0c\u8fd9\u4e9b\u5173\u8054\u53ef\u4ee5\u88ab\u7528\u6765\u5bf9\u5176\u4ed6\u8d44\u6599\u8868\u8fd0\u884c join \u67e5\u627e\uff0c\u6216\u8005\u5feb\u901f\u83b7\u53d6\u4e0e Entity \u76f8\u5173\u7684\u8bb0\u5f55\u3002 \u5982\u679c\u6211\u4eec\u8fd8\u8bb0\u5f97 finder \u4e2d\u7684 with \u65b9\u6cd5\uff0c\u5047\u5982\u6211\u4eec\u60f3\u83b7\u53d6\u4e00\u4e2a\u7279\u5b9a\u7684\u7528\u6237\uff0c\u5e76\u9884\u5148\u83b7\u53d6\u8be5\u7528\u6237\u7684 Admin \u8bb0\u5f55\uff08\u5982\u679c\u5b83\u5b58\u5728\u7684\u8bdd\uff09\uff0c\u90a3\u9ebd\u6211\u4eec\u5c06\u505a\u5982\u4e0b\u64cd\u4f5c\uff1a $finder = \\XF::finder('XF:User'); $user = $finder->where('user_id', 1)->with('Admin')->fetchOne(); \u8fd9\u5c06\u4f7f\u7528 User Entity \u4e2d\u5b9a\u4e49\u7684 Admin \u76f8\u5173\u7684\u4fe1\u606f\u548c XF:Admin Entity Structure \u7684\u7ec6\u8282\uff0c\u77e5\u9053\u8fd9\u4e2a\u7528\u6237\u67e5\u627e\u5e94\u8be5\u5728 xf_admin \u8d44\u6599\u8868\u548c user_id column \u4e0a\u8fd0\u884c LEFT JOIN \u3002 \u8981\u4ece User Entity \u4e2d\u83b7\u53d6 Admin \u6700\u540e\u767b\u5f55\u65e5\u671f\uff0c\u8bf7\u8fd0\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a $lastLogin = $user->Admin->last_login; // \u8fd4\u56de\u6700\u540e\u4e00\u6b21 Admin \u767b\u5f55\u7684\u65f6\u95f4\u6233 \u7136\u800c\uff0c\u5e76\u4e0d\u603b\u662f\u9700\u8981\u5728 finder \u4e2d\u8fdb\u884c join \u6765\u83b7\u53d6 Entity \u7684\u76f8\u5173\u4fe1\u606f\u3002 \u4f8b\u5982\uff0c\u5982\u679c\u6211\u4eec\u4ee5\u4e0a\u9762\u7684\u4f8b\u5b50\u4e3a\u4f8b\uff0c\u4e0d\u8c03\u7528 with \u65b9\u6cd5\uff1a $finder = \\XF::finder('XF:User'); $user = $finder->where('user_id', 1)->fetchOne(); $lastLogin = $user->Admin->last_login; // \u8fd4\u56de\u6700\u540e\u4e00\u6b21 Admin \u767b\u5f55\u7684\u65f6\u95f4\u6233 \u6211\u4eec\u5728\u8fd9\u91cc\u4ecd\u7136\u5f97\u5230 last_login \u503c\u3002 \u5b83\u662f\u901a\u8fc7\u8fd0\u884c\u989d\u5916\u7684\u67e5\u627e\u6765\u5feb\u901f\u83b7\u53d6 Admin Entity \u7684\u3002 \u4e0a\u9762\u7684\u4f8b\u5b50\u4f7f\u7528\u4e86 TO_ONE \u7c7b\u578b\uff0c\u56e0\u6b64\uff0c\u8fd9\u79cd\u5173\u8054\u5c06\u4e00\u4e2a Entity \u4e0e\u53e6\u4e00\u4e2a Entity \u8054\u7cfb\u8d77\u6765\u3002 \u6211\u4eec\u8fd8\u6709\u4e00\u4e2a TO_MANY \u7c7b\u578b\u3002 \u5b83\u4e0d\u53ef\u80fd\u83b7\u53d6\u6574\u4e2a TO_MANY \u5173\u8054\uff08\u4f8b\u5982\u5728 finder \u4e0a\u4f7f\u7528 join / with \u65b9\u6cd5\uff09\uff0c\u4f46\u4ee5\u67e5\u627e\u4e3a\u4ee3\u4ef7\uff0c\u5b83\u53ef\u4ee5\u5728\u4efb\u4f55\u65f6\u5019\u5feb\u901f\u8bfb\u53d6\uff0c\u4f8b\u5982\u5728\u4e0a\u9762\u6700\u540e\u7684 last_login \u4f8b\u5b50\u4e2d\u3002 \u5728 User Entity \u4e0a\u5b9a\u4e49\u7684\u4e00\u4e2a\u8fd9\u6837\u7684 Relation \u662f ConnectedAccounts \u5173\u8054\uff1a $structure->relations = [ 'ConnectedAccounts' => [ 'entity' => 'XF:UserConnectedAccount', 'type' => self::TO_MANY, 'conditions' => 'user_id', 'key' => 'provider' ] ]; \u8fd9\u4e2a relation \u80fd\u591f\u4ece xf_user_connected_account \u8d44\u6599\u8868\u4e2d\u8fd4\u56de\u4e0e\u5f53\u524d\u7528\u6237 ID \u76f8\u5339\u914d\u7684\u8bb0\u5f55\uff0c\u4f5c\u4e3a\u4e00\u4e2a FinderCollection \u3002 \u8fd9\u7c7b\u4f3c\u4e8e\u6211\u4eec\u5728\u4e0a\u9762 Finder \u90e8\u5206\u63d0\u5230\u7684 ArrayCollection \u7269\u4ef6\u3002 \u5728 Relation \u5b9a\u4e49\u4e2d\uff0c\u6307\u5b9a\u8be5\u96c6\u5408\u5e94\u8be5\u7531 provider \u5b57\u6bb5\u4f5c\u4e3a key\u3002 \u867d\u7136\u5728\u8fd0\u884c finder \u67e5\u627e\u65f6\u4e0d\u53ef\u80fd\u83b7\u53d6\u591a\u6761\u8bb0\u5f55\uff0c\u4f46\u53ef\u4ee5\u4f7f\u7528 TO_MANY \u5173\u8054\u4ece\u8be5 Relation \u4e2d\u83b7\u53d6 \u5358\u4e2a \u8bb0\u5f55\u3002 \u4e3e\u4e2a\u4f8b\u5b50\uff0c\u5982\u679c\u6211\u4eec\u60f3\u67e5\u770b\u7528\u6237\u662f\u5426\u4e0e\u7279\u5b9a\u7684\u5173\u8054\u5e10\u6237\u63d0\u4f9b\u5546\u76f8\u5173\u8054\uff0c\u6211\u4eec\u81f3\u5c11\u53ef\u4ee5\u5728\u67e5\u627e\u65f6\u83b7\u53d6\u8be5\u8bb0\u5f55\uff1a $finder = \\XF::finder('XF:User'); $user = $finder->where('user_id', 1)->with('ConnectedAccounts|facebook')->fetchOne(); Options (\u9009\u9879) \u00b6 $structure->options = [ 'custom_title_disallowed' => preg_split('/\\r?\\n/', $options->disallowedCustomTitles), 'admin_edit' => false, 'skip_email_confirm' => false ]; Entity Option \u662f\u5728\u67d0\u4e9b\u6761\u4ef6\u4e0b\u4fee\u6539 Entity Behavior \u7684\u4e00\u79cd\u65b9\u5f0f\u3002 \u4f8b\u5982\uff0c\u5982\u679c\u6211\u4eec\u5c06 admin_edit \u8bbe\u7f6e\u4e3a true\uff08\u5728 Admin CP \u4e2d\u7f16\u8f91\u7528\u6237\u65f6\u5c31\u662f\u5982\u6b64\uff09\uff0c\u90a3\u9ebd\u67d0\u4e9b\u68c0\u67e5\u5c06\u88ab\u8df3\u8fc7\uff0c\u4f8b\u5982\u5141\u8bb8\u7528\u6237\u7684\u7535\u5b50\u90ae\u4ef6\u5730\u5740\u4e3a\u7a7a\u3002 Entity \u751f\u547d\u5468\u671f \u00b6 Entity \u5728\u7ba1\u7406\u6570\u636e\u5e93\u5185\u8bb0\u5f55\u7684\u751f\u547d\u5468\u671f\u65b9\u9762\u626e\u6f14\u7740\u91cd\u8981\u89d2\u8272\u3002 \u9664\u4e86\u4ece\u5b83\u90a3\u91cc\u8bfb\u53d6\u503c\uff0c\u5411\u5b83\u5199\u5165\u503c\u4e4b\u5916\uff0cEntity \u8fd8\u53ef\u4ee5\u7528\u6765\u5220\u9664\u8bb0\u5f55\uff0c\u5e76\u5728\u6240\u6709\u8fd9\u4e9b\u64cd\u4f5c\u53d1\u751f\u65f6\u89e6\u53d1\u67d0\u4e9b\u4e8b\u4ef6\uff0c\u4ece\u800c\u53ef\u4ee5\u8fd0\u884c\u67d0\u4e9b\u4efb\u52a1\uff0c\u6216\u8005\u4e5f\u53ef\u4ee5\u66f4\u65b0\u67d0\u4e9b\u76f8\u5173\u8bb0\u5f55\u3002 \u8ba9\u6211\u4eec\u6765\u770b\u770b Entity \u5728\u4fdd\u5b58\u65f6\u53d1\u751f\u7684\u4e00\u4e9b\u4e8b\u4ef6\uff1a _preSave() - \u5728\u4fdd\u5b58\u8fc7\u7a0b\u5f00\u59cb\u4e4b\u524d\u53d1\u751f\uff0c\u4e3b\u8981\u7528\u4e8e\u8fd0\u884c\u4efb\u4f55\u5176\u4ed6\u4fdd\u5b58\u524d\u7684\u9a8c\u8bc1\u6216\u5728\u4fdd\u5b58\u53d1\u751f\u4e4b\u524d\u8bbe\u7f6e\u5176\u4ed6\u6570\u636e\u3002 _postSave() - \u5728\u6570\u636e\u88ab\u4fdd\u5b58\u540e\uff0c\u4f46\u5728\u4efb\u4f55\u4ea4\u6613\u88ab\u63d0\u4ea4\u4e4b\u524d\uff0c\u5c06\u8c03\u7528\u6b64\u65b9\u6cd5\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528\u6b64\u65b9\u6cd5\u6765\u8fd0\u884c Entity \u88ab\u4fdd\u5b58\u540e\u5e94\u89e6\u53d1\u7684\u4efb\u4f55\u5176\u4ed6\u4e8b\u3002 \u53e6\u5916\u8fd8\u6709 _preDelete() \u548c _postDelete() \uff0c\u5b83\u4eec\u7684\u8fd0\u4f5c\u65b9\u5f0f\u7c7b\u4f3c\uff0c\u4f46\u5728\u5220\u9664\u53d1\u751f\u65f6\u3002 Entity \u8fd8\u80fd\u591f\u63d0\u4f9b\u6709\u5173\u5b83\u5f53\u524d\u72b6\u6001\u7684\u4fe1\u606f\u3002 \u4f8b\u5982\uff0c\u6709\u4e00\u4e2a isInsert() \u548c isUpdate() \u65b9\u6cd5\uff0c\u8fd9\u6837\u4f60\u5c31\u53ef\u4ee5\u68c0\u6d4b\u5230\u8fd9\u662f\u4e00\u4e2a\u65b0\u8bb0\u5f55\u88ab\u63d2\u5165\u8fd8\u662f\u4e00\u4e2a\u73b0\u6709\u8bb0\u5f55\u88ab\u66f4\u65b0\u3002 \u8fd8\u6709\u4e00\u4e2a isChanged() \u65b9\u6cd5\uff0c\u53ef\u4ee5\u544a\u8bc9\u4f60\u81ea\u4e0a\u6b21\u4fdd\u5b58\u540e\uff0c\u67d0\u4e2a\u7279\u5b9a\u5b57\u6bb5\u662f\u5426\u53d1\u751f\u4e86\u53d8\u5316\u3002 \u8ba9\u6211\u4eec\u770b\u770b\u8fd9\u4e9b\u65b9\u6cd5\u5728 User Entity \u4e2d\u7684\u4e00\u4e9b\u5b9e\u9645\u4f8b\u5b50\u3002 protected function _preSave() { if ($this->isChanged('user_group_id') || $this->isChanged('secondary_group_ids')) { $groupRepo = $this->getUserGroupRepo(); $this->display_style_group_id = $groupRepo->getDisplayGroupIdForUser($this); } // ... } protected function _postSave() { // ... if ($this->isUpdate() && $this->isChanged('username') && $this->getExistingValue('username') != null) { $this->app()->jobManager()->enqueue('XF:UserRenameCleanUp', [ 'originalUserId' => $this->user_id, 'originalUserName' => $this->getExistingValue('username'), 'newUserName' => $this->username ]); } // ... \u5728 _preSave() \u7684\u4f8b\u5b50\u4e2d\uff0c\u6211\u4eec\u6839\u636e\u7528\u6237\u6539\u53d8\u540e\u7684\u7528\u6237\u7ec4\u6765\u83b7\u53d6\u5e76\u7f13\u5b58\u65b0\u7684\u663e\u793a Group ID\u3002 \u5728 _postSave() \u7684\u4f8b\u5b50\u4e2d\uff0c\u6211\u4eec\u5728\u7528\u6237\u7684\u540d\u5b57\u88ab\u66f4\u6539\u540e\u89e6\u53d1\u4e00\u4e2a\u4f5c\u4e1a\u6765\u8fd0\u884c\u3002 Repository (\u4fdd\u5b58\u5e93) \u00b6 \u5bf9\u4e8e XF2 \u6765\u8bf4\uff0cRepository \u662f\u4e00\u4e2a\u65b0\u7684\u6982\u5ff5\uff0c\u4f46\u662f\u5982\u679c\u628a\u5b83\u4eec\u4e0e XF1 \u4e2d\u7684 \"Model\" \u7269\u4ef6\u8fdb\u884c\u6bd4\u8f83\uff0c\u4f60\u53ef\u80fd\u4e0d\u4f1a\u53d7\u5230\u6307\u8d23\u3002 \u6211\u4eec\u5728 XF2 \u4e2d\u6ca1\u6709 Model \u7269\u4ef6\uff0c\u56e0\u4e3a\u6211\u4eec\u6709\u66f4\u597d\u7684\u5730\u65b9\u548c\u65b9\u6cd5\u6765\u83b7\u53d6\u548c\u5199\u5165\u6570\u636e\u5230\u6570\u636e\u5e93\u3002 \u6240\u4ee5\uff0c\u4e0e\u5176\u8bf4\u6211\u4eec\u6709\u4e00\u4e2a\u5e9e\u5927\u7684 class\uff0c\u5176\u4e2d\u5305\u542b\u4e86\u4f60\u7684\u9644\u52a0\u7ec4\u4ef6\u6240\u9700\u8981\u7684\u6240\u6709\u67e5\u627e\uff0c\u4ee5\u53ca\u5404\u79cd\u4e0d\u540c\u7684\u65b9\u6cd5\u6765\u64cd\u4f5c\u8fd9\u4e9b\u67e5\u627e\uff0c\u4e0d\u5982\u8bf4\u6211\u4eec\u6709 finder\uff0c\u5b83\u589e\u52a0\u4e86\u66f4\u591a\u7684\u5f3e\u6027\u3002 \u53e6\u5916\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0c\u5728 XF1 \u4e2d\uff0cModel \u7269\u4ef6\u5bf9\u4e8e\u8bb8\u591a\u4e1c\u897f\u6765\u8bf4\u6709\u70b9\u8c61 \"dumping ground\"\u3002 \u5176\u4e2d\u5f88\u591a\u4e1c\u897f\u73b0\u5728\u90fd\u662f\u591a\u4f59\u7684\u3002 \u4f8b\u5982\uff0c\u5728 XF1 \u4e2d\uff0c\u6240\u6709\u7684\u6743\u9650\u91cd\u5efa\u4ee3\u7801\u90fd\u5728\u6743\u9650 Model \u4e2d\u3002 \u5728 XF2 \u4e2d\uff0c\u6211\u4eec\u6709\u7279\u5b9a\u7684\u670d\u52a1\u548c\u7269\u4ef6\u6765\u5904\u7406\u8fd9\u4e2a\u95ee\u9898\u3002 \u90a3\u9ebd\uff0c\u4ec0\u9ebd\u662f Repository \u5462\uff1f \u5b83\u4eec\u5bf9\u5e94\u7740\u4e00\u4e2a Entity \u548c\u4e00\u4e2a Finder\uff0c\u5e76\u6301\u6709\u65b9\u6cd5\uff0c\u4e00\u822c\u4f1a\u8fd4\u56de\u4e00\u4e2a\u4e3a\u7279\u5b9a\u76ee\u7684\u8bbe\u7f6e\u7684 Finder \u7269\u4ef6\u3002 \u4e3a\u4ec0\u9ebd\u4e0d\u76f4\u63a5\u8fd4\u56de Finder \u67e5\u627e\u7684\u7ed3\u679c\u5462\uff1f \u597d\u5427\uff0c\u5982\u679c\u6211\u4eec\u8fd4\u56de Finder \u7269\u4ef6\u672c\u8eab\uff0c\u90a3\u9ebd\u5b83\u53ef\u4ee5\u4f5c\u4e3a\u4e00\u4e2a\u6709\u7528\u7684\u7ee7\u627f\u70b9\uff0c\u8ba9\u9644\u52a0\u7ec4\u4ef6\u5728 Entity \u6216\u96c6\u5408\u8fd4\u56de\u4e4b\u524d\uff0c\u5bf9\u5176\u8fdb\u884c\u7ee7\u627f\u5e76\u4fee\u6539 Finder \u7269\u4ef6\u3002 Repository \u4e5f\u53ef\u4ee5\u5305\u542b\u4e00\u4e9b\u5177\u4f53\u7684\u65b9\u6cd5\uff0c\u6bd4\u5982\u7f13\u5b58\u91cd\u5efa\u3002","title":"\u6570\u636e\u5b9e\u4f53\u3001\u67e5\u627e\u5668\u3001\u4fdd\u5b58\u5e93"},{"location":"entities-finders-repositories/#_1","text":"\u5728 XF2 \u4e2d\uff0c\u6709\u8bb8\u591a\u4e0e\u6570\u636e\u4ea4\u4e92\u7684\u65b9\u6cd5\u3002 \u5728 XF1 \u4e2d\uff0c\u8fd9\u4e3b\u8981\u662f\u9488\u5bf9\u5728 Model \u6587\u4ef6\u4e2d\u5199\u51fa\u539f\u59cb SQL \u8bed\u53e5\u3002 XF2 \u4e2d\u7684\u65b9\u6cd5\u5df2\u7ecf\u8131\u79bb\u4e86\u8fd9\u4e00\u70b9\uff0c\u6211\u4eec\u589e\u52a0\u4e86\u4e00\u4e9b\u65b0\u7684\u65b9\u6cd5\u3002 \u6211\u4eec\u9996\u5148\u6765\u770b\u4e00\u4e0b\u8fd0\u884c\u6570\u636e\u5e93\u67e5\u627e\u7684\u9996\u9009\u65b9\u6cd5 - Finder\u3002","title":"\u6570\u636e\u5b9e\u4f53\u3001\u67e5\u627e\u5668\u3001\u4fdd\u5b58\u5e93"},{"location":"entities-finders-repositories/#finder","text":"\u6211\u4eec\u5f15\u5165\u4e86\u4e00\u4e2a\u65b0\u7684 \"Finder\" \u7cfb\u7edf\uff0c\u5b83\u5141\u8bb8\u4ee5\u7269\u4ef6\u5bfc\u5411\u7684\u65b9\u5f0f\u4ee5\u7f16\u7a0b\u65b9\u5f0f\u521b\u5efa\u67e5\u627e\uff0c\u8fd9\u6837\u5c31\u4e0d\u9700\u8981\u7f16\u5199\u539f\u59cb\u6570\u636e\u5e93\u67e5\u627e\u3002 Finder \u7cfb\u7edf\u4e0e Entity \u7cfb\u7edf\u643a\u624b\u5408\u4f5c\uff0c\u6211\u4eec\u5728\u4e0b\u9762\u8be6\u7ec6\u4ecb\u7ecd\u3002 \u4f20\u5165 finder \u65b9\u6cd5\u7684\u7b2c\u4e00\u4e2a\u53c2\u6570\u662f\u4f60\u8981\u5904\u7406\u7684 Entity \u7684\u77ed\u7c7b\u540d\u3002 \u6211\u4eec\u5c31\u628a\u4e0a\u9762\u4e00\u8282\u4e2d\u63d0\u5230\u7684\u4e00\u4e9b\u67e5\u627e\u8ee2\u6362\u4e3a\u4f7f\u7528 finder \u7cfb\u7edf\u6765\u4ee3\u66ff\u3002 \u4f8b\u5982\uff0c\u8981\u8bbf\u95ee\u5358\u4e2a\u7528\u6237\u8bb0\u5f55\uff1a $finder = \\XF::finder('XF:User'); $user = $finder->where('user_id', 1)->fetchOne(); \u76f4\u63a5\u67e5\u627e\u65b9\u6cd5\u4e0e\u4f7f\u7528 Finder \u4e4b\u95f4\u7684\u4e3b\u8981\u533a\u522b\u4e4b\u4e00\u662f Finder \u8fd4\u56de\u7684\u6570\u636e\u57fa\u672c\u5358\u4f4d\u4e0d\u662f\u4e00\u4e2a\u6570\u7ec4\u3002 \u5728 Finder \u7269\u4ef6\u8c03\u7528 fetchOne \u65b9\u6cd5\u7684\u60c5\u51b5\u4e0b\uff08\u8be5\u65b9\u6cd5\u53ea\u4ece\u6570\u636e\u5e93\u4e2d\u8fd4\u56de\u5358\u4e2a row \uff09\uff0c\u5c06\u8fd4\u56de\u5358\u4e2a Entity \u7269\u4ef6\u3002 \u8ba9\u6211\u4eec\u770b\u770b\u4e00\u4e2a\u7a0d\u5fae\u4e0d\u540c\u7684\u65b9\u6cd5\uff0c\u5b83\u5c06\u8fd4\u56de\u591a\u4e2a row\uff1a $finder = \\XF::finder('XF:User'); $users = $finder->limit(10)->fetch(); \u8fd9\u4e2a\u4f8b\u5b50\u5c06\u4ece xf_user \u8d44\u6599\u8868\u4e2d\u67e5\u627e 10 \u6761\u8bb0\u5f55\uff0c\u5e76\u4ee5 ArrayCollection \u7269\u4ef6\u7684\u5f62\u5f0f\u8fd4\u56de\u3002 \u8fd9\u662f\u4e00\u4e2a\u7279\u6b8a\u7684\u7269\u4ef6\uff0c\u5b83\u7684\u4f5c\u7528\u7c7b\u4f3c\u4e8e\u4e00\u4e2a\u6570\u7ec4\uff0c\u56e0\u4e3a\u5b83\u662f\u53ef\u4ee5\u904d\u5386\u7684\uff08\u4f60\u53ef\u4ee5\u5728\u5b83\u91cc\u9762\u5faa\u73af\uff09\uff0c\u800c\u4e14\u5b83\u6709\u4e00\u4e9b\u7279\u6b8a\u7684\u65b9\u6cd5\uff0c\u53ef\u4ee5\u544a\u8bc9\u4f60\u5b83\u6240\u62e5\u6709\u7684\u6761\u76ee\u603b\u6570\uff0c\u901a\u8fc7\u67d0\u4e9b\u503c\u8fdb\u884c\u5206\u7ec4\uff0c\u6216\u8005\u5176\u4ed6\u7c7b\u4f3c\u4e8e\u6570\u7ec4\u7684\u64cd\u4f5c\uff0c\u5982\u8fc7\u6ee4\u3001\u5408\u5e76\u3001\u83b7\u53d6\u7b2c\u4e00\u4e2a\u6216\u6700\u540e\u4e00\u4e2a\u6761\u76ee\u7b49\u3002 Finder \u67e5\u627e\uff0c\u4e00\u822c\u5e94\u8be5\u662f\u671f\u671b\u4ece\u8d44\u6599\u8868\u4e2d\u68c0\u7d22\u6240\u6709\u7684 Column\uff0c\u56e0\u6b64\uff0c\u6ca1\u6709\u7279\u5b9a\u7684\u5bf9\u5e94\u5173\u7cfb\u4ec5\u83b7\u53d6\u67d0\u4e9b Column \u4e2d\u7684\u67d0\u4e9b\u503c\u3002 \u76f8\u53cd\uff0c\u5982\u679c\u8981\u83b7\u5f97\u5358\u4e2a\u503c\uff0c\u4f60\u53ea\u9700\u8981\u83b7\u53d6\u4e00\u4e2a Entity\uff0c\u7136\u540e\u76f4\u63a5\u4ece\u8fd9\u4e2a Entity \u4e2d\u8bfb\u53d6\u503c\uff1a $finder = \\XF::finder('XF:User'); $username = $finder->where('user_id', 1)->fetchOne()->username; \u540c\u6837\u5730\uff0c\u5982\u679c\u8981\u4ece Column \u4e2d\u83b7\u53d6\u4e00\u4e2a\u6570\u7ec4\u7684\u503c\uff0c\u53ef\u4ee5\u4f7f\u7528 pluckFrom \u65b9\u6cd5\uff1a $finder = \\XF::finder('XF:User'); $usernames = $finder->limit(10)->pluckFrom('username')->fetch(); \u5230\u5f53\u524d\u4e3a\u6b62\uff0c\u6211\u4eec\u5df2\u7ecf\u770b\u5230 Finder \u5e94\u7528\u4e86\u4e00\u4e9b\u7b80\u5358\u7684 where \u548c limit \u7ea6\u675f\u3002 \u6240\u4ee5\u6211\u4eec\u6765\u770b\u770b Finder \u7684\u66f4\u591a\u8be6\u7ec6\u5185\u5bb9\uff0c\u5305\u62ec\u5173\u4e8e where \u65b9\u6cd5\u672c\u8eab\u7684\u66f4\u591a\u7ec6\u8282\u3002","title":"Finder (\u67e5\u627e\u5668\u7cfb\u7edf)"},{"location":"entities-finders-repositories/#where","text":"where \u65b9\u6cd5\u6700\u591a\u53ef\u4ee5\u652f\u63f4\u4e09\u4e2a\u53c2\u6570\u3002 \u7b2c\u4e00\u4e2a\u53c2\u6570\u662f\u6761\u4ef6\u672c\u8eab\uff0c\u4f8b\u5982\u4f60\u8981\u641c\u5bfb\u7684 Column\u3002 \u7b2c\u4e8c\u4e2a\u53c2\u6570\u901a\u5e38\u662f\u8fd0\u7b97\u7b26\u3002 \u7b2c\u4e09\u4e2a\u662f\u88ab\u641c\u5bfb\u7684 value\u3002 \u5982\u679c\u4f60\u53ea\u63d0\u4f9b\u4e86\u4e24\u4e2a\u53c2\u6570\uff0c\u5c31\u8c61\u4f60\u5728\u4e0a\u9762\u770b\u5230\u7684\u90a3\u6837\uff0c\u90a3\u9ebd\u5b83\u81ea\u52a8\u610f\u5473\u7740\u8fd0\u7b97\u7b26\u662f = \u3002 \u4ee5\u4e0b\u662f\u5176\u4ed6\u6709\u6548\u7684\u8fd0\u7b97\u7b26\u5217\u8868\uff1a = <> != > >= < <= LIKE BETWEEN \u6240\u4ee5\uff0c\u5982\u679c\u6211\u4eec\u60f3\u8981\u5f97\u5230\u6700\u8fd1 7 \u5929\u5185\u6ce8\u518c\u7684\u6709\u6548\u7528\u6237\u540d\u5358\uff1a $finder = \\XF::finder('XF:User'); $users = $finder->where('user_state', 'valid')->where('register_date', '>=', time() - 86400 * 7)->fetch(); \u6b63\u5982\u4f60\u6240\u770b\u5230\u7684\uff0c\u4f60\u53ef\u4ee5\u968f\u610f\u8c03\u7528 where \u65b9\u6cd5\uff0c\u4f46\u9664\u6b64\u4e4b\u5916\uff0c\u4f60\u8fd8\u53ef\u4ee5\u9009\u62e9\u4f20\u5165\u4e00\u4e2a\u6570\u7ec4\u505a\u4e3a\u8be5\u65b9\u6cd5\u7684\u552f\u4e00\u53c2\u6570\uff0c\u5e76\u5728\u4e00\u6b21\u8c03\u7528\u4e2d\u521b\u5efa\u4f60\u7684\u6761\u4ef6\u3002 \u6570\u7ec4\u65b9\u6cd5\u652f\u63f4\u4e24\u79cd\u7c7b\u578b\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u4e0a\u9762\u521b\u5efa\u7684\u67e5\u627e\u4e2d\u4f7f\u7528\u8fd9\u4e24\u79cd\u7c7b\u578b\uff1a $finder = \\XF::finder('XF:User'); $users = $finder->where([ 'user_state' => 'valid', ['register_date', '>=', time() - 86400 * 7] ]) ->fetch(); \u901a\u5e38\u4e0d\u5efa\u8bae\u6216\u660e\u786e\u5730\u8fd9\u6837\u6df7\u5408\u4f7f\u7528\uff0c\u4f46\u5b83\u786e\u5b9e\u5728\u4e00\u5b9a\u7a0b\u5ea6\u4e0a\u5c55\u793a\u4e86\u8be5\u65b9\u6cd5\u7684\u970a\u6d3b\u6027\u3002 \u73b0\u5728\u6761\u4ef6\u5df2\u7ecf\u5728\u4e00\u4e2a\u6570\u7ec4\u4e2d\uff0c\u6211\u4eec\u53ef\u4ee5\u6307\u5b9a Column \u540d\uff08\u4f5c\u4e3a\u6570\u7ec4\u7684 key\uff09\u548c\u9690\u5f0f\u7684 = \u8fd0\u7b97\u7b26\u7684 value\uff0c\u6216\u8005\u6211\u4eec\u53ef\u4ee5\u5b9e\u9645\u5b9a\u4e49\u53e6\u4e00\u4e2a\u5305\u542b column\u3001\u8fd0\u7b97\u7b26\u548c value \u7684\u6570\u7ec4\u3002","title":"where \u65b9\u6cd5"},{"location":"entities-finders-repositories/#whereor","text":"\u5728\u4e0a\u9762\u7684\u4f8b\u5b50\u4e2d\uff0c\u4e24\u4e2a\u6761\u4ef6\u90fd\u9700\u8981\u6ee1\u8db3\uff0c\u5373\u6bcf\u4e2a\u6761\u4ef6\u90fd\u7531 AND \u8fd0\u7b97\u7b26\u8fde\u63a5\u3002 \u7136\u800c\uff0c\u6709\u65f6\u9700\u8981\u53ea\u6ee1\u8db3\u90e8\u5206\u6761\u4ef6\uff0c\u8fd9\u53ef\u4ee5\u901a\u8fc7\u4f7f\u7528 whereOr \u65b9\u6cd5\u6765\u5b9e\u73b0\u3002 \u4f8b\u5982\uff0c\u5982\u679c\u4f60\u60f3\u641c\u5bfb\u90a3\u4e9b\u65e0\u6548\u7684\u7528\u6237\u6216\u8005\u662f\u53d1\u5e03\u4e86\u96f6\u5219\u7559\u8a00\u7684\u7528\u6237\uff0c\u4f60\u53ef\u4ee5\u521b\u5efa\u5982\u4e0b\uff1a $finder = \\XF::finder('XF:User'); $users = $finder->whereOr( ['user_state', '<>', 'valid'], ['message_count', 0] )->fetch(); \u4e0e\u4e0a\u4e00\u8282\u7684\u4f8b\u5b50\u7c7b\u4f3c\uff0c\u9664\u4e86\u4f20\u9012\u6700\u591a\u4e24\u4e2a\u6761\u4ef6\u4f5c\u4e3a\u5358\u72ec\u7684\u53c2\u6570\u5916\uff0c\u4f60\u4e5f\u53ef\u4ee5\u53ea\u4f20\u9012\u4e00\u4e2a\u6761\u4ef6\u6570\u7ec4\u5230\u7b2c\u4e00\u4e2a\u53c2\u6570\uff1a $finder = \\XF::finder('XF:User'); $users = $finder->whereOr([ ['user_state', '<>', 'valid'], ['message_count', 0], ['is_banned', 1] ])->fetch();","title":"whereOr \u65b9\u6cd5"},{"location":"entities-finders-repositories/#with","text":"with \u65b9\u6cd5\u672c\u8d28\u4e0a\u7b49\u540c\u4e8e\u4f7f\u7528 INNER|LEFT JOIN \u8bed\u53e5\uff0c\u5c3d\u7ba1\u5b83\u4f9d\u8d56\u4e8e Entity \u5df2\u7ecf\u5b9a\u4e49\u4e86\u5b83\u7684 \"Relation\"\u3002 \u6211\u4eec\u5728\u4e0b\u4e00\u9875\u624d\u4f1a\u8ba8\u8bba\u8fd9\u4e2a\u95ee\u9898\uff0c\u4f46\u8fd9\u5e94\u8be5\u53ea\u662f\u8ba9\u4f60\u4e86\u89e3\u5b83\u662f\u5982\u4f55\u8fd0\u4f5c\u7684\u3002 \u73b0\u5728\u8ba9\u6211\u4eec\u4f7f\u7528\u4e3b\u9898 finder \u6765\u68c0\u7d22\u4e00\u4e2a\u7279\u5b9a\u7684\u4e3b\u9898\uff1a $finder = \\XF::finder('XF:Thread'); $thread = $finder->with('Forum', true)->where('thread_id', 123)->fetchOne(); \u8fd9\u4e2a\u67e5\u627e\u5c06\u83b7\u53d6 thread_id = 123 \u7684\u4e3b\u9898\u5b9e\u4f53\uff0c\u4f46\u5b83\u4e5f\u4f1a\u5728\u80cc\u666f\u4e0e xf_forum \u8d44\u6599\u8868\u8fdb\u884c join\u3002 \u5728\u63a7\u5236\u5982\u4f55\u505a INNER JOIN \u800c\u4e0d\u662f LEFT JOIN \u65b9\u9762\uff0c\u8fd9\u5c31\u662f\u7b2c\u4e8c\u4e2a\u53c2\u6570\u7684\u4f5c\u7528\u3002 \u5728\u672c\u4f8b\u4e2d\uff0c\u6211\u4eec\u5c06 \"must exist\" \u53c2\u6570\u8bbe\u7f6e\u4e3a true\uff0c\u6240\u4ee5\u5b83\u4f1a\u628a\u8fde\u63a5\u8bed\u53e5\u8ee2\u6362\u4e3a\u4f7f\u7528 INNER \u800c\u4e0d\u662f\u9ed8\u8ba4\u7684 LEFT \u3002 \u6211\u4eec\u5c06\u5728\u4e0b\u4e00\u8282\u8be6\u7ec6\u4ecb\u7ecd\u5982\u4f55\u8bbf\u95ee\u4ece\u8fd9\u4e2a join \u83b7\u53d6\u7684\u6570\u636e\u3002 \u4e5f\u53ef\u4ee5\u5728 with \u65b9\u6cd5\u4e2d\u4f20\u9012\u4e00\u4e2a Relation \u6570\u7ec4\u6765\u8fdb\u884c\u591a\u91cd join\u3002 $finder = \\XF::finder('XF:Thread'); $thread = $finder->with(['Forum', 'User'], true)->where('thread_id', 123)->fetchOne(); \u8fd9\u5c06\u4f1a join \u5230 xf_user \u8d44\u6599\u8868\u4ee5\u83b7\u5f97\u4e3b\u9898\u4f5c\u8005\u3002 \u7136\u800c\uff0c\u7531\u4e8e\u7b2c\u4e8c\u4e2a\u53c2\u6570\u4ecd\u7136\u662f true \uff0c\u6211\u4eec\u53ef\u80fd\u4e0d\u9700\u8981\u4e3a User join \u505a\u4e00\u4e2a INNER join\uff0c\u6240\u4ee5\uff0c\u6211\u4eec\u53ef\u4ee5\u7528 chain \u65b9\u6cd5\u4ee3\u66ff\uff1a $finder = \\XF::finder('XF:Thread'); $thread = $finder->with('Forum', true)->with('User')->where('thread_id', 123)->fetchOne();","title":"with \u65b9\u6cd5"},{"location":"entities-finders-repositories/#order-limit-limitbypage","text":"","title":"order, limit \u548c limitByPage \u65b9\u6cd5"},{"location":"entities-finders-repositories/#order","text":"\u8fd9\u4e2a\u65b9\u6cd5\u5141\u8bb8\u4f60\u6309\u7167\u7279\u5b9a\u7684\u987a\u5e8f\u6765\u4fee\u6539\u4f60\u7684\u67e5\u627e\u83b7\u53d6\u7ed3\u679c\u3002 \u5b83\u9700\u8981\u4e24\u4e2a\u53c2\u6570\uff0c\u7b2c\u4e00\u4e2a\u662f column \u540d\uff0c\u7b2c\u4e8c\u4e2a\u662f\u53ef\u9009\u7684\u6392\u5e8f\u65b9\u5411\u3002 \u6240\u4ee5\uff0c\u5982\u679c\u4f60\u60f3\u5217\u51fa\u62e5\u6709\u6700\u591a\u7559\u8a00\u7684 10 \u4e2a\u7528\u6237\uff0c\u4f60\u53ef\u4ee5\u521b\u5efa\u50cf\u8fd9\u6837\u7684\u67e5\u627e\uff1a $finder = \\XF::finder('XF:User'); $users = $finder->order('message_count', 'DESC')->limit(10); Note \u73b0\u5728\u53ef\u80fd\u662f\u4e00\u4e2a\u5f88\u597d\u7684\u65f6\u673a\u6765\u63d0\u53ca\uff0cfinder \u65b9\u6cd5\u5927\u591a\u53ef\u4ee5\u6309\u7167\u4efb\u4f55\u987a\u5e8f\u8c03\u7528\u3002 \u4f8b\u5982\uff1a $threads = $finder->limit(10)->where('thread_id', '>', 123)->order('post_date')->with('User')->fetch(); \u867d\u7136\u5982\u679c\u4f60\u6309\u7167\u8fd9\u4e2a\u987a\u5e8f\u5199\u4e00\u4e2a MySQL \u67e5\u627e\uff0c\u80af\u5b9a\u4f1a\u9047\u5230\u4e00\u4e9b\u8bed\u6cd5\u95ee\u9898\uff0c\u4f46 Finder \u7cfb\u7edf\u8fd8\u662f\u4f1a\u6309\u7167\u6b63\u786e\u7684\u987a\u5e8f\u6765\u6784\u5efa\uff0c\u4e0a\u9762\u7684\u4ee3\u7801\u867d\u7136\u770b\u8d77\u6765\u5f88\u5947\u602a\uff0c\u53ef\u80fd\u4e5f\u4e0d\u5efa\u8bae\u4f7f\u7528\uff0c\u4f46\u90a3\u6837\u5199\u786e\u5b9e\u662f\u5b8c\u5168\u6b63\u786e\u7684\u3002 \u4e0e\u6807\u51c6\u7684 MySQL \u67e5\u627e\u4e00\u6837\uff0c\u53ef\u4ee5\u5bf9\u591a\u4e2a Column \u7684\u7ed3\u679c\u96c6\u8fdb\u884c\u6392\u5e8f\u3002 \u8981\u505a\u5230\u8fd9\u4e00\u70b9\uff0c\u4f60\u53ef\u4ee5\u518d\u6b21\u8c03\u7528 order \u65b9\u6cd5\u3002 \u4e5f\u53ef\u4ee5\u4f7f\u7528\u6570\u7ec4\u5c06\u591a\u4e2a order \u5b50\u53e5\u4f20\u9012\u5230 order \u65b9\u6cd5\u4e2d\u3002 $finder = \\XF::finder('XF:User'); $users = $finder->order('message_count', 'DESC')->order('register_date')->limit(10);","title":"order \u65b9\u6cd5"},{"location":"entities-finders-repositories/#limit","text":"\u6211\u4eec\u5df2\u7ecf\u770b\u5230\u4e86\u5982\u4f55\u5c06\u67e5\u627e limit \u5728\u7279\u5b9a\u6570\u91cf\u7684\u8bb0\u5f55\u4e0a\uff1a $finder = \\XF::finder('XF:User'); $users = $finder->limit(10)->fetch(); \u4e0d\u8fc7\uff0c\u5176\u5b9e\u8fd8\u6709\u4e00\u4e2a\u529e\u6cd5\u53ef\u4ee5\u76f4\u63a5\u8c03\u7528 limit \u65b9\u6cd5\uff1a $finder = \\XF::finder('XF:User'); $users = $finder->fetch(10); \u53ef\u4ee5\u76f4\u63a5\u5c06\u4f60\u7684 limit \u4f20\u5165 fetch() \u65b9\u6cd5\u3002 \u53e6\u5916\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0c limit \uff08\u548c fetch \uff09\u65b9\u6cd5\u652f\u63f4\u4e24\u4e2a\u53c2\u6570\u3002 \u7b2c\u4e00\u4e2a\u663e\u7136\u662f limit\uff0c\u7b2c\u4e8c\u4e2a\u662f offset\u3002 $finder = \\XF::finder('XF:User'); $users = $finder->limit(10, 100)->fetch(); \u8fd9\u91cc\u7684 offset \u57fa\u672c\u4e0a\u610f\u5473\u7740\u524d 100 \u4e2a\u7ed3\u679c\u5c06\u88ab\u5f03\u7528\uff0c\u4e4b\u540e\u7684\u524d 10 \u4e2a\u7ed3\u679c\u5c06\u88ab\u8fd4\u56de\u3002 \u8fd9\u79cd\u65b9\u6cd5\u5bf9\u4e8e\u63d0\u4f9b\u5206\u9875\u7ed3\u679c\u662f\u5f88\u6709\u7528\u7684\uff0c\u4e0d\u8fc7\u6211\u4eec\u5176\u5b9e\u4e5f\u6709\u4e00\u4e2a\u66f4\u7b80\u5358\u7684\u65b9\u6cd5...","title":"limit \u65b9\u6cd5"},{"location":"entities-finders-repositories/#limitbypage","text":"\u8fd9\u4e2a\u65b9\u6cd5\u662f\u4e00\u79cd\u8f85\u52a9\u65b9\u6cd5\uff0c\u6700\u7ec8\u4f1a\u6839\u636e\u4f60\u5f53\u524d\u89c6\u56fe\u7684 \"\u9875\u9762\" \u548c\u4f60\u6240\u9700\u8981\u7684 \"\u6bcf\u9875\" \u6570\u91cf\u6765\u8bbe\u7f6e\u76f8\u5e94\u7684 limit \u548c offset\u3002 $finder = \\XF::finder('XF:User'); $users = $finder->limitByPage(3, 20); \u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0climit \u5c06\u88ab\u8bbe\u7f6e\u4e3a 20\uff08\u8fd9\u662f\u6211\u4eec\u6bcf\u9875\u7684\u503c\uff09\uff0coffset \u5c06\u88ab\u8bbe\u7f6e\u4e3a 40\uff0c\u56e0\u4e3a\u6211\u4eec\u4ece\u7b2c 3 \u9875\u5f00\u59cb\u3002 \u5076\u5c14\uff0c\u6211\u4eec\u9700\u8981\u6293\u53d6\u8d85\u8fc7 limit \u7684\u989d\u5916\u6570\u636e\u3002 Over-fetching \u53ef\u4ee5\u5e2e\u52a9\u4fa6\u6d4b\u4f60\u5728\u5f53\u524d\u9875\u9762\u4e4b\u540e\u662f\u5426\u6709\u989d\u5916\u7684\u6570\u636e\u8981\u663e\u793a\uff0c\u6216\u8005\u4f60\u662f\u5426\u9700\u8981\u6839\u636e\u6743\u9650\u8fc7\u6ee4\u8bbe\u7f6e\u4e0b\u6765\u7684\u521d\u59cb\u7ed3\u679c\u3002 \u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u7b2c\u4e09\u4e2a\u53c2\u6570\u6765\u5b9e\u73b0\uff1a $finder = \\XF::finder('XF:User'); $users = $finder->limitByPage(3, 20, 1); \u8fd9\u6837\u4e00\u6765\uff0c\u4ece\u7b2c 3 \u9875\u5f00\u59cb\uff0c\u603b\u5171\u6700\u591a\u53ef\u83b7\u5f97 21\u4e2a \u7528\u6237\uff0820+1\uff09\u3002","title":"limitByPage \u65b9\u6cd5"},{"location":"entities-finders-repositories/#getquery","text":"\u5f53\u4f60\u7b2c\u4e00\u6b21\u5f00\u59cb\u4f7f\u7528 finder \u65f6\uff0c\u5c3d\u7ba1\u5b83\u5f88\u76f4\u89b3\uff0c\u4f46\u4f60\u53ef\u80fd\u5076\u5c14\u4f1a\u60f3\u77e5\u9053\u4f60\u662f\u5426\u6b63\u786e\u5730\u4f7f\u7528\u4e86\u5b83\uff0c\u4ee5\u53ca\u5b83\u662f\u5426\u4f1a\u521b\u5efa\u4f60\u671f\u671b\u7684\u67e5\u627e\u3002 \u6211\u4eec\u6709\u4e00\u4e2a\u540d\u4e3a getQuery \u7684\u65b9\u6cd5\uff0c\u5b83\u53ef\u4ee5\u544a\u8bc9\u6211\u4eec\u5f53\u524d\u7684 finder \u7269\u4ef6\u5c06\u521b\u5efa\u7684\u67e5\u627e\u3002 \u4f8b\u5982\uff1a $finder = \\XF::finder('XF:User') ->where('user_id', 1); \\XF::dumpSimple($finder->getQuery()); \u8fd9\u5c06\u8f93\u51fa\u7c7b\u4f3c\u4e8e\u4ee5\u4e0b\u7684\u8bed\u53e5\uff1a string(67) \"SELECT `xf_user`.* FROM `xf_user` WHERE (`xf_user`.`user_id` = 1)\" \u4f60\u53ef\u80fd\u4e0d\u4f1a\u7ecf\u5e38\u9700\u8981\u5b83\uff0c\u4f46\u5982\u679c finder \u6ca1\u6709\u8fd4\u56de\u4f60\u6240\u671f\u671b\u7684\u7ed3\u679c\uff0c\u90a3\u5b83\u53ef\u80fd\u4f1a\u5f88\u6709\u5e2e\u52a9\u3002 \u5728 Dump \u53d8\u91cf \u90e8\u5206\u9605\u8bfb\u66f4\u591a\u5173\u4e8e dumpSimple \u65b9\u6cd5\u7684\u5185\u5bb9\u3002","title":"getQuery \u65b9\u6cd5"},{"location":"entities-finders-repositories/#finder_1","text":"\u5230\u5f53\u524d\u4e3a\u6b62\uff0c\u6211\u4eec\u5df2\u7ecf\u770b\u5230 finder \u7269\u4ef6\u88ab\u8bbe\u7f6e\u4e86\u4e00\u4e2a\u7c7b\u4f3c\u4e8e XF:User \u548c XF:Thread \u7684\u53c2\u6570\u3002 \u5728\u5927\u591a\u6570\u60c5\u51b5\u4e0b\uff0c\u8fd9\u6807\u8bc6\u4e86 finder \u6b63\u5728\u5904\u7406\u7684 Entity \u7c7b\uff0c\u5e76\u5c06\u89e3\u6790\u4e3a\uff0c\u4f8b\u5982\uff0c XF/Entity/User \u3002 \u7136\u800c\uff0c\u5b83\u4e5f\u53ef\u4ee5\u53e6\u5916\u4ee3\u8868\u4e00\u4e2a finder \u7c7b\u3002 finder \u7c7b\u662f\u53ef\u9009\u7684\uff0c\u4f46\u5b83\u4eec\u53ef\u4ee5\u4f5c\u4e3a\u4e00\u79cd\u65b9\u6cd5\u6765\u4e3a\u7279\u5b9a\u7684 finder \u7c7b\u578b\u6dfb\u52a0\u81ea\u5b9a\u4e49 finder \u65b9\u6cd5\u3002 \u4e3a\u4e86\u770b\u5230\u8fd9\u4e00\u70b9\uff0c\u8ba9\u6211\u4eec\u770b\u770b\u4e0e XF:User \u76f8\u5173\u7684 finder \u7c7b\uff0c\u5b83\u53ef\u4ee5\u5728 XF\\FinderUser \u7c7b\u4e2d\u627e\u5230\u3002 \u4e0b\u9762\u793a\u4f8b\u662f\u8be5 class \u4e2d\u7684\u4e00\u4e2a finder \u65b9\u6cd5\uff1a public function isRecentlyActive($days = 180) { $this->where('last_activity', '>', time() - ($days * 86400)); return $this; } \u73b0\u5728\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u4efb\u4f55 User finder \u7269\u4ef6\u4e0a\u8c03\u7528\u8be5\u65b9\u6cd5\u3002 \u6240\u4ee5\uff0c\u5982\u679c\u6211\u4eec\u62ff\u524d\u9762\u7684\u4e00\u4e2a\u4f8b\u5b50\u6765\u8bf4\uff1a $finder = \\XF::finder('XF:User'); $users = $finder->isRecentlyActive(20)->order('message_count', 'DESC')->limit(10); \u8fd9\u4e2a\u67e5\u627e\uff0c\u4e4b\u524d\u53ea\u662f\u6309\u7167\u7559\u8a00\u6570\u964d\u5e8f\u8fd4\u56de 10 \u4e2a\u7528\u6237\uff0c\u73b0\u5728\u5c06\u6309\u8fd9\u4e2a\u987a\u5e8f\u8fd4\u56de\u6700\u8fd1 20 \u5929\u5185\u6d3b\u8dc3\u7684 10 \u4e2a\u7528\u6237\u3002 \u5c3d\u7ba1\u5bf9\u4e8e\u5f88\u591a Entity \u7c7b\u578b\u6765\u8bf4\uff0cfinder \u7c7b\u662f\u4e0d\u5b58\u5728\u7684\uff0c\u4f46\u4ecd\u7136\u53ef\u4ee5\u901a\u8fc7 \u7ee7\u627f\u7c7b \u4e00\u8282\u4e2d\u63d0\u5230\u7684\u76f8\u540c\u65b9\u5f0f\u6765\u7ee7\u627f\u8fd9\u4e9b\u4e0d\u5b58\u5728\u7684\u7c7b\u3002","title":"\u81ea\u5b9a\u4e49 finder \u65b9\u6cd5"},{"location":"entities-finders-repositories/#the-entity-system","text":"\u5982\u679c\u60a8\u719f\u6089 XF1\uff0c\u60a8\u53ef\u80fd\u4f1a\u719f\u6089 Entity \u80cc\u540e\u7684\u4e00\u4e9b\u6982\u5ff5\uff0c\u56e0\u4e3a\u5b83\u4eec\u6700\u7ec8\u662f\u4ece\u90a3\u91cc\u7684 DataWriter \u7cfb\u7edf\u884d\u751f\u51fa\u6765\u7684\u3002 \u5982\u679c\u60a8\u5bf9\u5b83\u4eec\u4e0d\u662f\u5f88\u719f\u6089\uff0c\u4e0b\u9762\u7684\u90e8\u5206\u5e94\u8be5\u4f1a\u8ba9\u60a8\u6709\u6240\u4e86\u89e3\u3002","title":"The Entity system (\u5b9e\u4f53\u7cfb\u7edf)"},{"location":"entities-finders-repositories/#entity-structure","text":"Structure \u7269\u4ef6\u7531\u4e00\u4e9b\u5c5e\u6027\u7ec4\u6210\uff0c\u8fd9\u4e9b\u5c5e\u6027\u5b9a\u4e49\u4e86 Entity \u7684 Structure \u548c\u5b83\u6240\u6d89\u53ca\u7684\u8d44\u6599\u8868\u3002 Structure \u7269\u4ef6\u672c\u8eab\u5c31\u8bbe\u7f6e\u5728\u5b83\u6240\u6d89\u53ca\u7684 Entity \u5185\u90e8\u3002 \u6211\u4eec\u6765\u770b\u770b User Entity \u4e2d\u7684\u4e00\u4e9b\u5e38\u7528\u5c5e\u6027\uff1a","title":"Entity structure (\u5b9e\u4f53\u7ed3\u6784)"},{"location":"entities-finders-repositories/#table","text":"$structure->table = 'xf_user'; \u5b83\u8bf4\u660e\u4e86 Entity \u5728 Update \u548c Insert \u8bb0\u5f55\u65f6\u4f7f\u7528\u54ea\u5f20\u8d44\u6599\u8868\uff0c\u4e5f\u544a\u8bc9\u6211\u4eec Finder \u5728\u6784\u5efa\u67e5\u627e\u8fd0\u884c\u65f6\u4ece\u54ea\u5f20\u8d44\u6599\u8868\u8bfb\u53d6\u3002 \u6b64\u5916\uff0c\u5b83\u8fd8\u77e5\u9053\u4f60\u7684\u67e5\u627e\u9700\u8981 join \u5230\u54ea\u4e9b\u5176\u4ed6\u8d44\u6599\u8868\u4e2d\u8d77\u5230\u4e86\u4f5c\u7528\u3002","title":"Table (\u8d44\u6599\u8868)"},{"location":"entities-finders-repositories/#short-name","text":"$structure->shortName = 'XF:User'; \u8fd9\u53ea\u662f Entity \u672c\u8eab\u548c Finder \u7c7b\uff08\u5982\u679c\u9002\u7528\uff09\u7684\u77ed\u7c7b\u540d\u3002","title":"Short name (\u7b80\u77ed\u540d)"},{"location":"entities-finders-repositories/#content-type","text":"$structure->contentType = 'user'; \u8fd9\u5b9a\u4e49\u4e86\u8fd9\u4e2a Entity \u4ee3\u8868\u7684\u5185\u5bb9\u7c7b\u578b\u3002 \u5728\u5927\u591a\u6570 Entity \u7ed3\u6784\u4e2d\u4e0d\u4f1a\u9700\u8981\u8fd9\u4e2a\u3002 \u5b83\u7528\u4e8e\u8fde\u63a5\u5230 \"content type\" \u7cfb\u7edf\u4f7f\u7528\u7684\u7279\u5b9a\u4e8b\u7269\uff08\u8fd9\u5c06\u5728\u53e6\u4e00\u8282\u4e2d\u4ecb\u7ecd\uff09\u3002","title":"Content type (\u5185\u5bb9\u7c7b\u578b)"},{"location":"entities-finders-repositories/#primary-key","text":"$structure->primaryKey = 'user_id'; \u5b9a\u4e49\u4e86\u4ee3\u8868\u8d44\u6599\u8868\u4e2d Primary key \u7684 Column\uff0c\u5982\u679c\u4e00\u4e2a\u8d44\u6599\u8868\u652f\u63f4\u591a\u4e2a Column \u4f5c\u4e3a Primary key\uff0c\u90a3\u9ebd\u53ef\u4ee5\u5b9a\u4e49\u4e3a\u6570\u7ec4\u3002","title":"Primary key (\u4e3b\u952e)"},{"location":"entities-finders-repositories/#columns","text":"$structure->columns = [ 'user_id' => ['type' => self::UINT, 'autoIncrement' => true, 'nullable' => true, 'changeLog' => false], 'username' => ['type' => self::STR, 'maxLength' => 50, 'required' => 'please_enter_valid_name' ] // \u8fd8\u6709\u66f4\u591a\u7684 columns... ]; \u8fd9\u662f Entity \u8bbe\u7f6e\u7684\u5173\u952e\u90e8\u5206\uff0c\u56e0\u4e3a\u8fd9\u91cc\u9762\u4f1a\u8be6\u7ec6\u89e3\u91ca Entity \u8d1f\u8d23\u7684\u6bcf\u4e2a\u6570\u636e\u5e93 column \u7684\u5177\u4f53\u60c5\u51b5\u3002 \u8fd9\u544a\u8bc9\u6211\u4eec\u9884\u671f\u7684\u6570\u636e\u7c7b\u578b\uff0c\u662f\u5426\u9700\u8981\u4e00\u4e2a\u503c\uff0c\u5b83\u5e94\u8be5\u5339\u914d\u4ec0\u9ebd\u683c\u5f0f\uff0c\u662f\u5426\u5e94\u8be5\u662f\u552f\u4e00\u503c\uff0c\u5b83\u7684\u9ed8\u8ba4\u503c\u662f\u4ec0\u9ebd\uff0c\u7b49\u7b49\u3002 \u6839\u636e type \uff0cEntity \u7ba1\u7406\u5668\u77e5\u9053\u662f\u5426\u4ee5\u67d0\u79cd\u65b9\u5f0f\u5bf9\u4e00\u4e2a\u503c\u8fdb\u884c\u7f16\u7801\u6216\u89e3\u7801\u3002 \u8fd9\u53ef\u4ee5\u662f\u4e00\u4e2a\u7b80\u5358\u7684\u8fc7\u7a0b\uff0c\u5c06\u4e00\u4e2a\u503c\u8ee2\u6362\u4e3a\u4e00\u4e2a\u5b57\u7b26\u4e32\u6216\u6574\u6570\uff0c\u6216\u8005\u7a0d\u5fae\u590d\u6742\u4e00\u70b9\uff0c\u4f8b\u5982\u5728\u5411\u6570\u636e\u5e93\u5199\u5165\u65f6\uff0c\u5bf9\u4e00\u4e2a\u6570\u7ec4\u4f7f\u7528 json_encode() \uff0c\u6216\u8005\u5728\u4ece\u6570\u636e\u5e93\u8bfb\u53d6\u65f6\uff0c\u5bf9\u4e00\u4e2a JSON \u5b57\u7b26\u4e32\u4f7f\u7528 json_decode() \uff0c\u4ee5\u4fbf\u5c06\u8be5\u503c\u4f5c\u4e3a\u4e00\u4e2a\u6570\u7ec4\u6b63\u786e\u5730\u8fd4\u56de\u7ed9 Entity \u7269\u4ef6\uff0c\u800c\u4e0d\u9700\u8981\u6211\u4eec\u624b\u52a8\u8fd9\u6837\u505a\u3002 \u5b83\u8fd8\u53ef\u4ee5\u652f\u63f4\u5bf9\u9017\u53f7\u5206\u9694\u7684\u503c\u8fdb\u884c\u9002\u5f53\u7684\u7f16\u7801/\u89e3\u7801\u3002 \u5076\u5c14\u9700\u8981\u5728\u5199\u5165\u4e00\u4e2a\u503c\u4e4b\u524d\u5bf9\u5176\u8fdb\u884c\u4e00\u4e9b\u989d\u5916\u7684\u9a8c\u8bc1\u6216\u4fee\u6539\u3002 \u4e3e\u4e2a\u4f8b\u5b50\uff0c\u5728 User Entity \u4e2d\uff0c\u8bf7\u770b verifyStyleId() \u65b9\u6cd5\u3002 \u5f53\u5728 style_id \u5b57\u6bb5\u4e0a\u8bbe\u7f6e\u4e00\u4e2a\u503c\u65f6\uff0c\u6211\u4eec\u4f1a\u81ea\u52a8\u68c0\u67e5\u662f\u5426\u5b58\u5728\u4e00\u4e2a\u540d\u4e3a verifyStyleId() \u7684\u65b9\u6cd5\uff0c\u5982\u679c\u5b58\u5728\uff0c\u6211\u4eec\u4f1a\u5148\u901a\u8fc7\u8be5\u65b9\u6cd5\u8fd0\u884c\u8be5\u503c\u3002","title":"Columns (\u591a\u884c\u6570\u636e)"},{"location":"entities-finders-repositories/#behaviors","text":"$structure->behaviors = [ 'XF:ChangeLoggable' => [] ]; \u8fd9\u662f\u8be5 Entity \u5e94\u4f7f\u7528\u7684 Behaviors \u7c7b\u6570\u7ec4\u3002 Behaviors \u7c7b\u662f\u4e00\u79cd\u5141\u8bb8\u67d0\u4e9b\u4ee3\u7801\u5728\u591a\u79cd Entity \u7c7b\u578b\u4e2d\u901a\u7528\u91cd\u590d\u4f7f\u7528\u7684\u65b9\u5f0f\uff08\u4ec5\u5728 Entity \u53d8\u5316\u65f6\uff0c\u800c\u4e0d\u662f\u5728\u8bfb\u53d6\u65f6\uff09\u3002 \u4e00\u4e2a\u5f88\u597d\u7684\u4f8b\u5b50\u662f XF:Likeable Behaviors\uff0c\u5b83\u80fd\u591f\u5bf9\u652f\u63f4\u53ef\u88ab \"\u70b9\u8cdb\" \u7684\u5185\u5bb9\u5b9e\u4f53\u81ea\u52a8\u8fd0\u884c\u67d0\u4e9b\u64cd\u4f5c\u3002 \u8fd9\u5305\u62ec\u5f53\u5185\u5bb9\u4e2d\u53d1\u751f\u53ef\u89c1\u6027\u53d8\u5316\u65f6\u81ea\u52a8\u91cd\u65b0\u8ba1\u6570\uff0c\u4ee5\u53ca\u5f53\u5185\u5bb9\u88ab\u5220\u9664\u65f6\u81ea\u52a8\u5220\u9664\u70b9\u8cdb\u6570\u3002","title":"Behaviors (\u884c\u4e3a)"},{"location":"entities-finders-repositories/#getters","text":"$structure->getters = [ 'is_super_admin' => true, 'last_activity' => true ]; \u5f53\u8c03\u7528 name \u5b57\u6bb5\u65f6\uff0c\u4f1a\u81ea\u52a8\u8c03\u7528 Getter \u65b9\u6cd5\u3002 \u4f8b\u5982\uff0c\u5982\u679c\u6211\u4eec\u4ece User Entity \u4e2d\u8bf7\u6c42 is_super_admin \uff0c\u5c31\u4f1a\u81ea\u52a8\u68c0\u67e5\u5e76\u4f7f\u7528 getIsSuperAdmin() \u65b9\u6cd5\u3002 \u6709\u8da3\u7684\u662f\uff0cxf_user \u8d44\u6599\u8868\u5b9e\u9645\u4e0a\u5e76\u6ca1\u6709\u4e00\u4e2a\u540d\u4e3a is_super_admin \u7684\u5b57\u6bb5\u3002 \u8fd9\u4e2a\u5b57\u6bb5\u5b9e\u9645\u4e0a\u5b58\u5728\u4e8e Admin Entity \u4e2d\uff0c\u4f46\u6211\u4eec\u5c06\u5176\u4f5c\u4e3a\u4e00\u4e2a getter \u65b9\u6cd5\u6dfb\u52a0\u5230\u4e86\u8d44\u6599\u8868\u4e2d\uff0c\u4f5c\u4e3a\u8bbf\u95ee\u8be5\u503c\u7684\u4e00\u79cd\u7b80\u5199\u65b9\u5f0f\u3002 Getter \u65b9\u6cd5\u4e5f\u53ef\u4ee5\u7528\u6765\u76f4\u63a5\u590d\u76d6\u73b0\u6709\u5b57\u6bb5\u7684\u503c\uff0c\u8fd9\u91cc\u7684 last_activity \u503c\u5c31\u662f\u5982\u6b64\u3002 last_activity \u5b9e\u9645\u4e0a\u662f\u4e00\u4e2a\u7f13\u5b58\u503c\uff0c\u901a\u5e38\u5728\u7528\u6237\u767b\u51fa\u65f6\u624d\u4f1a\u66f4\u65b0\u3002 \u7136\u800c\uff0c\u6211\u4eec\u5728 xf_session_activity \u8d44\u6599\u8868\u4e2d\u4fdd\u5b58\u4e86\u7528\u6237\u6700\u65b0\u7684\u6d3b\u52a8\u65e5\u671f\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 getLastActivity \u65b9\u6cd5\u6765\u8fd4\u56de\u8be5\u503c\u800c\u4e0d\u662f\u7f13\u5b58\u7684\u6700\u540e\u6d3b\u52a8\u503c\u3002 \u5982\u679c\u4f60\u9700\u8981\u5b8c\u5168\u7ed5\u8fc7 getter \u65b9\u6cd5\uff0c\u53ea\u9700\u8981\u5f97\u5230\u771f\u6b63\u7684 Entity \u503c\uff0c\u53ea\u9700\u8981\u5728 column \u540d\u540e\u52a0\u4e0a\u4e0b\u5212\u7ebf\uff0c\u4f8b\u5982 $user->last_activity_ \u3002 \u56e0\u4e3a\u4e00\u4e2a Entity \u5c31\u8c61\u5176\u4ed6\u7684 PHP \u7269\u4ef6\u4e00\u6837\uff0c\u4f60\u53ef\u4ee5\u7ed9\u5b83\u4eec\u6dfb\u52a0\u66f4\u591a\u7684\u65b9\u6cd5\u3002 \u4e00\u4e2a\u5e38\u89c1\u7684\u4f7f\u7528\u6848\u4f8b\u662f\u6dfb\u52a0\u4e00\u4e9b\u8c61\u6743\u9650\u68c0\u67e5\u8fd9\u6837\u7684\u65b9\u6cd5\uff0c\u8fd9\u4e9b\u65b9\u6cd5\u53ef\u4ee5\u5728 Entity \u81ea\u8eab\u4e0a\u9762\u8c03\u7528\u3002","title":"Getters (\u83b7\u53d6\u5668)"},{"location":"entities-finders-repositories/#relations","text":"$structure->relations = [ 'Admin' => [ 'entity' => 'XF:Admin', 'type' => self::TO_ONE, 'conditions' => 'user_id', 'primary' => true ] ]; \u8fd9\u5c31\u662f Relations \u7684\u5b9a\u4e49\u3002 \u4ec0\u9ebd\u662f Relations\uff1f \u5b83\u4eec\u5b9a\u4e49\u4e86 Entity \u4e4b\u95f4\u7684\u5173\u8054\uff0c\u8fd9\u4e9b\u5173\u8054\u53ef\u4ee5\u88ab\u7528\u6765\u5bf9\u5176\u4ed6\u8d44\u6599\u8868\u8fd0\u884c join \u67e5\u627e\uff0c\u6216\u8005\u5feb\u901f\u83b7\u53d6\u4e0e Entity \u76f8\u5173\u7684\u8bb0\u5f55\u3002 \u5982\u679c\u6211\u4eec\u8fd8\u8bb0\u5f97 finder \u4e2d\u7684 with \u65b9\u6cd5\uff0c\u5047\u5982\u6211\u4eec\u60f3\u83b7\u53d6\u4e00\u4e2a\u7279\u5b9a\u7684\u7528\u6237\uff0c\u5e76\u9884\u5148\u83b7\u53d6\u8be5\u7528\u6237\u7684 Admin \u8bb0\u5f55\uff08\u5982\u679c\u5b83\u5b58\u5728\u7684\u8bdd\uff09\uff0c\u90a3\u9ebd\u6211\u4eec\u5c06\u505a\u5982\u4e0b\u64cd\u4f5c\uff1a $finder = \\XF::finder('XF:User'); $user = $finder->where('user_id', 1)->with('Admin')->fetchOne(); \u8fd9\u5c06\u4f7f\u7528 User Entity \u4e2d\u5b9a\u4e49\u7684 Admin \u76f8\u5173\u7684\u4fe1\u606f\u548c XF:Admin Entity Structure \u7684\u7ec6\u8282\uff0c\u77e5\u9053\u8fd9\u4e2a\u7528\u6237\u67e5\u627e\u5e94\u8be5\u5728 xf_admin \u8d44\u6599\u8868\u548c user_id column \u4e0a\u8fd0\u884c LEFT JOIN \u3002 \u8981\u4ece User Entity \u4e2d\u83b7\u53d6 Admin \u6700\u540e\u767b\u5f55\u65e5\u671f\uff0c\u8bf7\u8fd0\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a $lastLogin = $user->Admin->last_login; // \u8fd4\u56de\u6700\u540e\u4e00\u6b21 Admin \u767b\u5f55\u7684\u65f6\u95f4\u6233 \u7136\u800c\uff0c\u5e76\u4e0d\u603b\u662f\u9700\u8981\u5728 finder \u4e2d\u8fdb\u884c join \u6765\u83b7\u53d6 Entity \u7684\u76f8\u5173\u4fe1\u606f\u3002 \u4f8b\u5982\uff0c\u5982\u679c\u6211\u4eec\u4ee5\u4e0a\u9762\u7684\u4f8b\u5b50\u4e3a\u4f8b\uff0c\u4e0d\u8c03\u7528 with \u65b9\u6cd5\uff1a $finder = \\XF::finder('XF:User'); $user = $finder->where('user_id', 1)->fetchOne(); $lastLogin = $user->Admin->last_login; // \u8fd4\u56de\u6700\u540e\u4e00\u6b21 Admin \u767b\u5f55\u7684\u65f6\u95f4\u6233 \u6211\u4eec\u5728\u8fd9\u91cc\u4ecd\u7136\u5f97\u5230 last_login \u503c\u3002 \u5b83\u662f\u901a\u8fc7\u8fd0\u884c\u989d\u5916\u7684\u67e5\u627e\u6765\u5feb\u901f\u83b7\u53d6 Admin Entity \u7684\u3002 \u4e0a\u9762\u7684\u4f8b\u5b50\u4f7f\u7528\u4e86 TO_ONE \u7c7b\u578b\uff0c\u56e0\u6b64\uff0c\u8fd9\u79cd\u5173\u8054\u5c06\u4e00\u4e2a Entity \u4e0e\u53e6\u4e00\u4e2a Entity \u8054\u7cfb\u8d77\u6765\u3002 \u6211\u4eec\u8fd8\u6709\u4e00\u4e2a TO_MANY \u7c7b\u578b\u3002 \u5b83\u4e0d\u53ef\u80fd\u83b7\u53d6\u6574\u4e2a TO_MANY \u5173\u8054\uff08\u4f8b\u5982\u5728 finder \u4e0a\u4f7f\u7528 join / with \u65b9\u6cd5\uff09\uff0c\u4f46\u4ee5\u67e5\u627e\u4e3a\u4ee3\u4ef7\uff0c\u5b83\u53ef\u4ee5\u5728\u4efb\u4f55\u65f6\u5019\u5feb\u901f\u8bfb\u53d6\uff0c\u4f8b\u5982\u5728\u4e0a\u9762\u6700\u540e\u7684 last_login \u4f8b\u5b50\u4e2d\u3002 \u5728 User Entity \u4e0a\u5b9a\u4e49\u7684\u4e00\u4e2a\u8fd9\u6837\u7684 Relation \u662f ConnectedAccounts \u5173\u8054\uff1a $structure->relations = [ 'ConnectedAccounts' => [ 'entity' => 'XF:UserConnectedAccount', 'type' => self::TO_MANY, 'conditions' => 'user_id', 'key' => 'provider' ] ]; \u8fd9\u4e2a relation \u80fd\u591f\u4ece xf_user_connected_account \u8d44\u6599\u8868\u4e2d\u8fd4\u56de\u4e0e\u5f53\u524d\u7528\u6237 ID \u76f8\u5339\u914d\u7684\u8bb0\u5f55\uff0c\u4f5c\u4e3a\u4e00\u4e2a FinderCollection \u3002 \u8fd9\u7c7b\u4f3c\u4e8e\u6211\u4eec\u5728\u4e0a\u9762 Finder \u90e8\u5206\u63d0\u5230\u7684 ArrayCollection \u7269\u4ef6\u3002 \u5728 Relation \u5b9a\u4e49\u4e2d\uff0c\u6307\u5b9a\u8be5\u96c6\u5408\u5e94\u8be5\u7531 provider \u5b57\u6bb5\u4f5c\u4e3a key\u3002 \u867d\u7136\u5728\u8fd0\u884c finder \u67e5\u627e\u65f6\u4e0d\u53ef\u80fd\u83b7\u53d6\u591a\u6761\u8bb0\u5f55\uff0c\u4f46\u53ef\u4ee5\u4f7f\u7528 TO_MANY \u5173\u8054\u4ece\u8be5 Relation \u4e2d\u83b7\u53d6 \u5358\u4e2a \u8bb0\u5f55\u3002 \u4e3e\u4e2a\u4f8b\u5b50\uff0c\u5982\u679c\u6211\u4eec\u60f3\u67e5\u770b\u7528\u6237\u662f\u5426\u4e0e\u7279\u5b9a\u7684\u5173\u8054\u5e10\u6237\u63d0\u4f9b\u5546\u76f8\u5173\u8054\uff0c\u6211\u4eec\u81f3\u5c11\u53ef\u4ee5\u5728\u67e5\u627e\u65f6\u83b7\u53d6\u8be5\u8bb0\u5f55\uff1a $finder = \\XF::finder('XF:User'); $user = $finder->where('user_id', 1)->with('ConnectedAccounts|facebook')->fetchOne();","title":"Relations (\u5173\u8054)"},{"location":"entities-finders-repositories/#options","text":"$structure->options = [ 'custom_title_disallowed' => preg_split('/\\r?\\n/', $options->disallowedCustomTitles), 'admin_edit' => false, 'skip_email_confirm' => false ]; Entity Option \u662f\u5728\u67d0\u4e9b\u6761\u4ef6\u4e0b\u4fee\u6539 Entity Behavior \u7684\u4e00\u79cd\u65b9\u5f0f\u3002 \u4f8b\u5982\uff0c\u5982\u679c\u6211\u4eec\u5c06 admin_edit \u8bbe\u7f6e\u4e3a true\uff08\u5728 Admin CP \u4e2d\u7f16\u8f91\u7528\u6237\u65f6\u5c31\u662f\u5982\u6b64\uff09\uff0c\u90a3\u9ebd\u67d0\u4e9b\u68c0\u67e5\u5c06\u88ab\u8df3\u8fc7\uff0c\u4f8b\u5982\u5141\u8bb8\u7528\u6237\u7684\u7535\u5b50\u90ae\u4ef6\u5730\u5740\u4e3a\u7a7a\u3002","title":"Options (\u9009\u9879)"},{"location":"entities-finders-repositories/#entity","text":"Entity \u5728\u7ba1\u7406\u6570\u636e\u5e93\u5185\u8bb0\u5f55\u7684\u751f\u547d\u5468\u671f\u65b9\u9762\u626e\u6f14\u7740\u91cd\u8981\u89d2\u8272\u3002 \u9664\u4e86\u4ece\u5b83\u90a3\u91cc\u8bfb\u53d6\u503c\uff0c\u5411\u5b83\u5199\u5165\u503c\u4e4b\u5916\uff0cEntity \u8fd8\u53ef\u4ee5\u7528\u6765\u5220\u9664\u8bb0\u5f55\uff0c\u5e76\u5728\u6240\u6709\u8fd9\u4e9b\u64cd\u4f5c\u53d1\u751f\u65f6\u89e6\u53d1\u67d0\u4e9b\u4e8b\u4ef6\uff0c\u4ece\u800c\u53ef\u4ee5\u8fd0\u884c\u67d0\u4e9b\u4efb\u52a1\uff0c\u6216\u8005\u4e5f\u53ef\u4ee5\u66f4\u65b0\u67d0\u4e9b\u76f8\u5173\u8bb0\u5f55\u3002 \u8ba9\u6211\u4eec\u6765\u770b\u770b Entity \u5728\u4fdd\u5b58\u65f6\u53d1\u751f\u7684\u4e00\u4e9b\u4e8b\u4ef6\uff1a _preSave() - \u5728\u4fdd\u5b58\u8fc7\u7a0b\u5f00\u59cb\u4e4b\u524d\u53d1\u751f\uff0c\u4e3b\u8981\u7528\u4e8e\u8fd0\u884c\u4efb\u4f55\u5176\u4ed6\u4fdd\u5b58\u524d\u7684\u9a8c\u8bc1\u6216\u5728\u4fdd\u5b58\u53d1\u751f\u4e4b\u524d\u8bbe\u7f6e\u5176\u4ed6\u6570\u636e\u3002 _postSave() - \u5728\u6570\u636e\u88ab\u4fdd\u5b58\u540e\uff0c\u4f46\u5728\u4efb\u4f55\u4ea4\u6613\u88ab\u63d0\u4ea4\u4e4b\u524d\uff0c\u5c06\u8c03\u7528\u6b64\u65b9\u6cd5\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528\u6b64\u65b9\u6cd5\u6765\u8fd0\u884c Entity \u88ab\u4fdd\u5b58\u540e\u5e94\u89e6\u53d1\u7684\u4efb\u4f55\u5176\u4ed6\u4e8b\u3002 \u53e6\u5916\u8fd8\u6709 _preDelete() \u548c _postDelete() \uff0c\u5b83\u4eec\u7684\u8fd0\u4f5c\u65b9\u5f0f\u7c7b\u4f3c\uff0c\u4f46\u5728\u5220\u9664\u53d1\u751f\u65f6\u3002 Entity \u8fd8\u80fd\u591f\u63d0\u4f9b\u6709\u5173\u5b83\u5f53\u524d\u72b6\u6001\u7684\u4fe1\u606f\u3002 \u4f8b\u5982\uff0c\u6709\u4e00\u4e2a isInsert() \u548c isUpdate() \u65b9\u6cd5\uff0c\u8fd9\u6837\u4f60\u5c31\u53ef\u4ee5\u68c0\u6d4b\u5230\u8fd9\u662f\u4e00\u4e2a\u65b0\u8bb0\u5f55\u88ab\u63d2\u5165\u8fd8\u662f\u4e00\u4e2a\u73b0\u6709\u8bb0\u5f55\u88ab\u66f4\u65b0\u3002 \u8fd8\u6709\u4e00\u4e2a isChanged() \u65b9\u6cd5\uff0c\u53ef\u4ee5\u544a\u8bc9\u4f60\u81ea\u4e0a\u6b21\u4fdd\u5b58\u540e\uff0c\u67d0\u4e2a\u7279\u5b9a\u5b57\u6bb5\u662f\u5426\u53d1\u751f\u4e86\u53d8\u5316\u3002 \u8ba9\u6211\u4eec\u770b\u770b\u8fd9\u4e9b\u65b9\u6cd5\u5728 User Entity \u4e2d\u7684\u4e00\u4e9b\u5b9e\u9645\u4f8b\u5b50\u3002 protected function _preSave() { if ($this->isChanged('user_group_id') || $this->isChanged('secondary_group_ids')) { $groupRepo = $this->getUserGroupRepo(); $this->display_style_group_id = $groupRepo->getDisplayGroupIdForUser($this); } // ... } protected function _postSave() { // ... if ($this->isUpdate() && $this->isChanged('username') && $this->getExistingValue('username') != null) { $this->app()->jobManager()->enqueue('XF:UserRenameCleanUp', [ 'originalUserId' => $this->user_id, 'originalUserName' => $this->getExistingValue('username'), 'newUserName' => $this->username ]); } // ... \u5728 _preSave() \u7684\u4f8b\u5b50\u4e2d\uff0c\u6211\u4eec\u6839\u636e\u7528\u6237\u6539\u53d8\u540e\u7684\u7528\u6237\u7ec4\u6765\u83b7\u53d6\u5e76\u7f13\u5b58\u65b0\u7684\u663e\u793a Group ID\u3002 \u5728 _postSave() \u7684\u4f8b\u5b50\u4e2d\uff0c\u6211\u4eec\u5728\u7528\u6237\u7684\u540d\u5b57\u88ab\u66f4\u6539\u540e\u89e6\u53d1\u4e00\u4e2a\u4f5c\u4e1a\u6765\u8fd0\u884c\u3002","title":"Entity \u751f\u547d\u5468\u671f"},{"location":"entities-finders-repositories/#repository","text":"\u5bf9\u4e8e XF2 \u6765\u8bf4\uff0cRepository \u662f\u4e00\u4e2a\u65b0\u7684\u6982\u5ff5\uff0c\u4f46\u662f\u5982\u679c\u628a\u5b83\u4eec\u4e0e XF1 \u4e2d\u7684 \"Model\" \u7269\u4ef6\u8fdb\u884c\u6bd4\u8f83\uff0c\u4f60\u53ef\u80fd\u4e0d\u4f1a\u53d7\u5230\u6307\u8d23\u3002 \u6211\u4eec\u5728 XF2 \u4e2d\u6ca1\u6709 Model \u7269\u4ef6\uff0c\u56e0\u4e3a\u6211\u4eec\u6709\u66f4\u597d\u7684\u5730\u65b9\u548c\u65b9\u6cd5\u6765\u83b7\u53d6\u548c\u5199\u5165\u6570\u636e\u5230\u6570\u636e\u5e93\u3002 \u6240\u4ee5\uff0c\u4e0e\u5176\u8bf4\u6211\u4eec\u6709\u4e00\u4e2a\u5e9e\u5927\u7684 class\uff0c\u5176\u4e2d\u5305\u542b\u4e86\u4f60\u7684\u9644\u52a0\u7ec4\u4ef6\u6240\u9700\u8981\u7684\u6240\u6709\u67e5\u627e\uff0c\u4ee5\u53ca\u5404\u79cd\u4e0d\u540c\u7684\u65b9\u6cd5\u6765\u64cd\u4f5c\u8fd9\u4e9b\u67e5\u627e\uff0c\u4e0d\u5982\u8bf4\u6211\u4eec\u6709 finder\uff0c\u5b83\u589e\u52a0\u4e86\u66f4\u591a\u7684\u5f3e\u6027\u3002 \u53e6\u5916\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0c\u5728 XF1 \u4e2d\uff0cModel \u7269\u4ef6\u5bf9\u4e8e\u8bb8\u591a\u4e1c\u897f\u6765\u8bf4\u6709\u70b9\u8c61 \"dumping ground\"\u3002 \u5176\u4e2d\u5f88\u591a\u4e1c\u897f\u73b0\u5728\u90fd\u662f\u591a\u4f59\u7684\u3002 \u4f8b\u5982\uff0c\u5728 XF1 \u4e2d\uff0c\u6240\u6709\u7684\u6743\u9650\u91cd\u5efa\u4ee3\u7801\u90fd\u5728\u6743\u9650 Model \u4e2d\u3002 \u5728 XF2 \u4e2d\uff0c\u6211\u4eec\u6709\u7279\u5b9a\u7684\u670d\u52a1\u548c\u7269\u4ef6\u6765\u5904\u7406\u8fd9\u4e2a\u95ee\u9898\u3002 \u90a3\u9ebd\uff0c\u4ec0\u9ebd\u662f Repository \u5462\uff1f \u5b83\u4eec\u5bf9\u5e94\u7740\u4e00\u4e2a Entity \u548c\u4e00\u4e2a Finder\uff0c\u5e76\u6301\u6709\u65b9\u6cd5\uff0c\u4e00\u822c\u4f1a\u8fd4\u56de\u4e00\u4e2a\u4e3a\u7279\u5b9a\u76ee\u7684\u8bbe\u7f6e\u7684 Finder \u7269\u4ef6\u3002 \u4e3a\u4ec0\u9ebd\u4e0d\u76f4\u63a5\u8fd4\u56de Finder \u67e5\u627e\u7684\u7ed3\u679c\u5462\uff1f \u597d\u5427\uff0c\u5982\u679c\u6211\u4eec\u8fd4\u56de Finder \u7269\u4ef6\u672c\u8eab\uff0c\u90a3\u9ebd\u5b83\u53ef\u4ee5\u4f5c\u4e3a\u4e00\u4e2a\u6709\u7528\u7684\u7ee7\u627f\u70b9\uff0c\u8ba9\u9644\u52a0\u7ec4\u4ef6\u5728 Entity \u6216\u96c6\u5408\u8fd4\u56de\u4e4b\u524d\uff0c\u5bf9\u5176\u8fdb\u884c\u7ee7\u627f\u5e76\u4fee\u6539 Finder \u7269\u4ef6\u3002 Repository \u4e5f\u53ef\u4ee5\u5305\u542b\u4e00\u4e9b\u5177\u4f53\u7684\u65b9\u6cd5\uff0c\u6bd4\u5982\u7f13\u5b58\u91cd\u5efa\u3002","title":"Repository (\u4fdd\u5b58\u5e93)"},{"location":"general-concepts/","text":"\u901a\u7528\u6982\u5ff5 \u00b6 \u4ee5\u4e0b\u90e8\u5206\u5c06\u8be6\u7ec6\u4ecb\u7ecd\u5f00\u53d1 XenForo \u9644\u52a0\u7ec4\u4ef6\u65f6\u5c06\u4f1a\u9047\u5230\u7684\u4e00\u4e9b\u901a\u7528\u7cfb\u7edf\u548c\u6982\u5ff5\u3002 \u5982\u679c\u60a8\u719f\u6089 XenForo 1.x \u7684\u5f00\u53d1\uff0c\u90a3\u9ebd\u8fd9\u4e9b\u6982\u5ff5\u4e2d\u7684\u5f88\u591a\u5185\u5bb9\u60a8\u90fd\u4f1a\u899a\u5f97\u5f88\u719f\u6089\uff0c\u4e0d\u8fc7\u503c\u5f97\u56de\u987e\u4e00\u4e0b\uff0c\u56e0\u4e3a\u6709\u4e00\u4e9b\u4f18\u79c0\u7684\u65b0\u5de5\u5177\u548c\u529f\u80fd\u53ef\u4ee5\u5e2e\u52a9\u60a8\u5f00\u53d1\u9644\u52a0\u7ec4\u4ef6\u3002 Vendor \u7ec4\u4ef6 \u00b6 XF2 \u5e76\u4e0d\u50cf XF1 \u90a3\u6837\u7531\u4e00\u4e2a\u7279\u5b9a\u7684\u6846\u67b6\u6765\u9a71\u52a8\uff0c\u7136\u800c\uff0c\u6211\u4eec\u4f7f\u7528\u4e86\u67d0\u4e9b\u6d41\u884c\u7684\u3001\u7ecf\u8fc7\u826f\u597d\u6d4b\u8bd5\u7684\u3001\u5f00\u6e90\u7684\u8f6f\u4ef6\u5305\u6765\u5e2e\u52a9\u5b8c\u6210\u7279\u5b9a\u7684\u4efb\u52a1\u3002 \u4f8b\u5982\uff0c\u6211\u4eec\u4f7f\u7528\u4e00\u4e2a\u540d\u4e3a SwiftMailer \u7684\u9879\u76ee\u6765\u53d1\u9001\u7535\u5b50\u90ae\u4ef6\uff0c\u4ee5\u53ca\u4e00\u4e2a\u540d\u4e3a Guzzle \u7684\u9879\u76ee\u4f5c\u4e3a HTTP \u5ba2\u6237\u7aef\u3002 \u6240\u6709\u7684\u7b2c\u4e09\u65b9\u9879\u76ee\u90fd\u662f\u4ece src/vendor \u76ee\u5f55\u4e0b\u52a0\u8f7d\u7684\u3002 \u5f53\u524d\uff0c\u9644\u52a0\u7ec4\u4ef6\u5f00\u53d1\u8005\u8fd8\u4e0d\u80fd\u5c06\u81ea\u5df1\u7684\u4f9d\u8d56\u5173\u7cfb\u6dfb\u52a0\u5230\u8fd9\u4e2a\u4f4d\u7f6e\u3002 \u6574\u5408\u5f00\u53d1\u73af\u5883 (IDE) \u00b6 \u5728\u5f00\u59cb XF2 \u5f00\u53d1\u5de5\u4f5c\u4e4b\u524d\uff0c\u4f60\u53ef\u80fd\u9700\u8981\u82b1\u4e00\u4e9b\u65f6\u95f4\u6765\u8bc4\u4f30\u4f60\u5c06\u5b9e\u9645\u521b\u5efa\u548c\u7f16\u8f91 PHP \u6587\u4ef6\u7684\u5e94\u7528\u7a0b\u5e8f\u3002 \u8fd9\u901a\u5e38\u88ab\u79f0\u4e3a IDE\u3002 \u6709\u8bb8\u591a\u53ef\u7528\u7684\u9009\u9879\uff0c\u4ece\u57fa\u672c\u7684\u8bb0\u4e8b\u672c\u5230\u50cf Sublime Text \u8fd9\u6837\u53ef\u4ee5\u901a\u8fc7\u9644\u52a0\u7ec4\u4ef6\u6269\u5c55\u4ee5\u83b7\u5f97\u66f4\u597d\u7684 PHP \u652f\u6301\u7684\u4e1c\u897f\uff0c\u76f4\u5230\u4e00\u4e2a\u5408\u9002\u7684 IDE\uff0c\u5982 PhpStorm \u3002 \u5728\u5185\u90e8\uff0c\u6211\u4eec\u4f7f\u7528 PhpStorm \u4f5c\u4e3a\u6211\u4eec\u7684\u9996\u9009 IDE\u3002 \u8fd9\u662f\u4e00\u4e2a\u9ad8\u7ea7\u7684\u5546\u4e1a\u4ea7\u54c1\uff0c\u4f46\u4e5f\u6709\u53ef\u80fd\u662f\u514d\u8d39\u7684\u3002 \u65e0\u8bba\u54ea\u79cd\u65b9\u5f0f\uff0c\u6ca1\u6709\u4eba\u80fd\u544a\u8bc9\u4f60\u6700\u7b26\u5408\u60a8\u987b\u6c42\u7684\u6700\u4f73\u5e94\u7528\u8fdb\u7a0b\u662f\u54ea\u4e2a\uff0c\u4f60\u5e94\u8be5\u82b1\u4e9b\u65f6\u95f4\u591a\u4f7f\u7528\u4e00\u4e9b\u4ea7\u54c1\uff08\u751a\u81f3\u662f\u514d\u8d39\u7684\uff09\uff0c\u5e76\u4f7f\u7528\u8fd9\u4e9b\u7ecf\u9a8c\u6765\u627e\u51fa\u4f60\u7684\u559c\u597d\u3002 \u81ea\u52a8\u52a0\u8f7d\u5668 \u00b6 XF2 \u4f7f\u7528\u4e00\u4e2a\u7531 Composer \u81ea\u52a8\u751f\u6210\u7684\u81ea\u52a8\u52a0\u8f7d\u5668\u3002 \u8fd9\u5141\u8bb8\u6240\u6709\u7684 XF \u4ee3\u7801\u3001\u7b2c\u4e09\u65b9\u4f9b\u5e94\u5546\u4ee3\u7801\uff0c\u4ee5\u53ca\u4efb\u4f55\u9644\u52a0\u7ec4\u4ef6\u7684\u5f00\u53d1\u8005\u4ee3\u7801\u5728\u6574\u4e2a\u9879\u76ee\u4e2d\u81ea\u52a8\u5305\u542b\u8fdb\u53bb\uff0c\u800c\u4e0d\u9700\u8981\u624b\u52a8 include/require \u4f60\u7684 class\u3002 \u6240\u6709 XF \u9644\u52a0\u7ec4\u4ef6\u7684\u81ea\u52a8\u52a0\u8f7d\u6839\u76ee\u5f55\u662f src/addons \u76ee\u5f55\u3002 \u8fd9\u610f\u5473\u7740\u4f60\u6240\u6709\u7684 class \u540d\u90fd\u4f1a\u76f8\u5bf9\u4e8e\u8fd9\u4e2a\u57fa\u7840\u4f4d\u7f6e\u3002 \u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0cXF2 \u91c7\u7528\u4e86\u4e25\u683c\u7684 \"\u6bcf\u4e2a\u6587\u4ef6\u4e00\u4e2a\u7c7b\" \u7684\u547d\u540d\u6a21\u5f0f\u3002 \u6bcf\u4e2a\u6587\u4ef6\u5e94\u8be5\u53ea\u5305\u542b\u4e00\u4e2a\u7c7b\uff0c\u800c\u4e14\u8fd9\u4e2a\u7c7b\u7684\u540d\u5b57\u5e94\u8be5\u786e\u5b9a\u8be5\u7c7b\u7684 PHP \u6587\u4ef6\u5728\u6587\u4ef6\u7cfb\u7edf\u4e2d\u7684\u786e\u5207\u4f4d\u7f6e\u3002 \u4f8b\u5982\uff0c\u5982\u679c\u4f60\u60f3\u5728\u4e00\u4e2a\u540d\u4e3a src/addons/Demo/Setup.php \u7684\u6587\u4ef6\u4e2d\u521b\u5efa\u4e00\u4e2a\u65b0\u7684 class\uff08\u5176\u4e2d Demo \u662f\u4f60\u7684 \u9644\u52a0\u7ec4\u4ef6 ID\uff09\uff0c\u90a3\u9ebd\u8fd9\u4e2a class \u5c06\u88ab\u547d\u540d\u4e3a Demo\\Setup \u3002 \u76f8\u53cd\uff0c\u5982\u679c\u4f60\u6709\u4e00\u4e2a\u540d\u4e3a Demo\\Entity\\Thing \u7684 class\uff0c\u90a3\u9ebd\u4f60\u4f1a\u77e5\u9053\u8fd9\u4e2a class \u7684\u6587\u4ef6\u4f4d\u4e8e\u8def\u5f84 src/addons/Demo/Entity/Thing.php \u4e2d\u3002 \u547d\u540d\u7a7a\u95f4 \u00b6 \u5728\u6574\u4e2a XF \u4e2d\uff0c\u6211\u4eec\u4f7f\u7528\u4e86 \u547d\u540d\u7a7a\u95f4 \uff0c\u8fd9\u6837\u6211\u4eec\u53ef\u4ee5\u66f4\u7b80\u6d01\u5730\u53c2\u8003\u540c\u4e00\u547d\u540d\u7a7a\u95f4\u4e2d\u7684\u7c7b\u3002\u5efa\u8bae\u6240\u6709\u7684\u9644\u52a0\u7ec4\u4ef6\u4e5f\u4f7f\u7528\u547d\u540d\u7a7a\u95f4\u3002 \u5728\u4e0a\u9762\u7684\u4f8b\u5b50\u4e2d\uff0c\u6211\u4eec\u8c08\u5230\u4e86\u4e00\u4e2a\u540d\u4e3a Demo\\Setup \u7684\u7c7b\u3002 \u4f7f\u7528\u547d\u540d\u7a7a\u95f4\uff0c\u8fd9\u4e2a\u7c7b\u5b9e\u9645\u4e0a\u4f1a\u88ab\u7b80\u5358\u5730\u547d\u540d\u4e3a Setup \uff0c\u4f46\u547d\u540d\u7a7a\u95f4\u4f1a\u88ab\u8bbe\u7f6e\u4e3a Demo \u3002 \u4f5c\u4e3a\u4e00\u4e2a\u66f4\u5177\u4f53\u7684\u4f8b\u5b50\uff0c\u6211\u4eec\u5728\u4e0a\u9762\u4e5f\u8c08\u5230\u4e86\u4e00\u4e2a\u540d\u4e3a Demo\\Entity\\Thing \u7684\u7c7b\u3002 \u8ba9\u6211\u4eec\u6765\u770b\u770b\u8fd9\u4e2a\u7c7b\u7684 PHP \u4ee3\u7801\u662f\u4ec0\u9ebd\u6837\u5b50\u7684\uff1a <?php namespace Demo\\Entity; class Thing { } \u5982\u679c\u5728 src/addons/Demo/Entity \u76ee\u5f55\u4e0b\u6709\u4e00\u4e2a\u540d\u4e3a AnotherThing \u7684 class\uff0c\u6211\u4eec\u53ef\u4ee5\u5728 Thing class \u4e2d\u7b80\u5358\u5730\u5c06\u8fd9\u4e2a class \u5f15\u7528\u4e3a AnotherThing \uff0c\u56e0\u4e3a\u8fd9\u4e2a class \u5728\u540c\u4e00\u4e2a Demo\\Entity \u547d\u540d\u7a7a\u95f4\u4e2d\u3002 \u77ed\u7c7b\u540d \u00b6 \u5076\u5c14\uff0cXF \u4e2d\u53c2\u8003\u7684 class \u4f1a\u88ab\u7f29\u77ed\u3002 \u4f8b\u5982\uff0c\u5982\u679c\u60a8\u5e0c\u671b\u8c03\u7528 User \u5b9e\u4f53\uff08\u66f4\u591a\u5173\u4e8e\u5b9e\u4f53\u7684\u5185\u5bb9\u89c1\u4e0b\u6587\uff09\uff0c\u90a3\u9ebd\u60a8\u53ef\u80fd\u4f1a\u770b\u5230\u88ab\u5f15\u7528\u7684 class \u540d\u53ea\u662f XF:User \u3002 \u77ed\u7c7b\u540d\u7684\u4f7f\u7528\u548c\u5b83\u4eec\u6240\u89e3\u6790\u7684\u5168\u7c7b\u540d\uff0c\u5b8c\u5168\u662f\u4f9d\u7167 context sensitive \u7684\u3002 \u56e0\u6b64\uff0c\u5728\u8c03\u7528\u5b9e\u4f53\u7684 context \u4e2d\uff0c\u77ed\u7c7b\u540d\u5c06\u89e3\u6790\u4e3a\u4ee5\u4e0b\u5168\u7c7b\u540d XF/Entity/User \u3002 XF \u90e8\u5206\u8868\u793a\u6587\u4ef6\u8def\u5f84 (\u57fa\u4e8e\u9644\u52a0\u7684 ID )\uff0c Entity \u90e8\u5206\u662f\u901a\u8fc7\u8c03\u7528\u5b9e\u4f53\u6697\u793a\u7684\uff0c User \u90e8\u5206\u8868\u793a\u7279\u5b9a\u7684\u5b9e\u4f53\u3002 \u540c\u6837\u5f53\u4f60\u5f00\u59cb\u521b\u5efa\u81ea\u5df1\u7684 class \u65f6\uff0c\u4f60\u4e5f\u4f1a\u4f7f\u7528\u7b80\u77ed\u7684 class \u540d\u6765\u5f15\u7528\u81ea\u5df1\u7684 class\u3002 \u4f8b\u5982\uff0c\u5982\u679c\u4f60\u9700\u8981\u4e3a\u4f60\u7684 Demo \u9644\u52a0\u7ec4\u4ef6\u521b\u5efa\u4e00\u4e2a\u65b0\u7684 Thing \u5b9e\u4f53\uff0c\u90a3\u9ebd\u4f60\u4f1a\u5199\u51fa\u4ee5\u4e0b\u5185\u5bb9\u3002 \\XF::em()->create('Demo:Thing'); \u8fd9\u5c06\u89e3\u6790\u4e3a Demo\\Entity\\Thing class\u3002 \u540c\u6837\uff0c\u5982\u679c\u4f60\u60f3\u8bbf\u95ee\u4e00\u4e2a Thing \u4fdd\u5b58\u5e93\uff0c\u4f60\u53ef\u4ee5\u8fd9\u6837\u5199\u3002 \\XF::repository('Demo:Thing'); \u8bf7\u6ce8\u610f\u8fd9\u4e9b\u77ed\u7c7b\u540d\u662f\u5982\u4f55\u76f8\u540c\u7684\u3002 \u4fdd\u5b58\u5e93\u7684\u8c03\u7528\u5b9e\u9645\u4e0a\u4f1a\u89e3\u6790\u4e3a Demo\\Repository\\Thing \u3002 \u7ee7\u627f\u7c7b \u00b6 XF2 \u4e2d\u5927\u591a\u6570\u7684 class \u90fd\u662f\u53ef\u7ee7\u627f\u7684\uff0c\u8fd9\u4f7f\u5f97\u5f00\u53d1\u4eba\u5458\u53ef\u4ee5\u7ee7\u627f\u548c\u590d\u76d6\u6838\u5fc3\u4ee3\u7801\uff0c\u800c\u65e0\u9700\u76f4\u63a5\u7f16\u8f91\u5b83\u3002 \u5982\u679c\u4f60\u719f\u6089 XF1 \u7684\u5f00\u53d1\uff0c\u4f60\u4f1a\u5bf9\u4e0b\u9762\u7684\u8fc7\u7a0b\u6709\u4e9b\u719f\u6089\uff1a \u521b\u5efa\u4e00\u4e2a\u76d1\u542c\u5668 PHP \u6587\u4ef6 \u521b\u5efa\u4e00\u4e2a class\uff0c\u8be5 class \u6700\u7ec8\u5c06\u7ee7\u627f\u539f\u6709\u7684 class \u7f16\u5199\u4e00\u4e2a function\uff0c\u8be5 function \u4e0e\u9884\u671f\u7684 load_class \u4e8b\u4ef6\u7684 callback \u7b7e\u7ae0\u76f8\u7b26\u5408\uff0c\u5e76\u6dfb\u52a0\u7ee7\u627f class \u7684\u540d\u79f0 \u5728 Admin CP \u4e2d\u6dfb\u52a0\u4e00\u4e2a \"\u4ee3\u7801\u4e8b\u4ef6\u76d1\u542c\u5668\"\uff0c\u6307\u5b9a\u4e0a\u8ff0 function \u7684\u76d1\u542c\u5668 class \u548c method \u540d\uff0c\u5e76\u53ef\u9009\u5730\u63d0\u793a\u7ee7\u627f\u7684\u662f\u54ea\u4e2a class \u5728 XF2 \u4e2d\uff0c\u6211\u4eec\u53bb\u6389\u4e86\u8fd9\u4e9b\u4e8b\u4ef6\uff0c\u800c\u91c7\u7528\u4e86\u4e00\u4e2a\u540d\u4e3a \"Class extensions\" \u7684\u7279\u5b9a\u7cfb\u7edf\u3002 \u8fd9\u4e2a\u8fc7\u7a0b\u5982\u4e0b\u3002 \u521b\u5efa\u4e00\u4e2a class\uff0c\u8be5 class \u6700\u7ec8\u5c06\u7ee7\u627f\u539f\u6709\u7684 class \u5728 Admin CP \u4e2d\u6dfb\u52a0\u4e00\u4e2a \"Class extension\"\uff0c\u6307\u5b9a\u4f60\u8981\u7ee7\u627f\u7684 class \u7684\u540d\u79f0\u548c\u6b63\u5728\u7ee7\u627f\u7684 class \u7684\u540d\u79f0\u3002 \u8fd9\u663e\u7136\u51cf\u5c11\u4e86\u4e00\u4e9b\u7ee7\u627f class \u6240\u9700\u7684\u6a21\u677f\uff0c\u4e5f\u63d0\u4f9b\u4e86\u4e00\u4e2a\u4e13\u95e8\u7684 UI \u6765\u67e5\u770b\u548c\u7ba1\u7406\u8fd9\u4e9b\u7ee7\u627f\u3002 \u8ba9\u6211\u4eec\u901a\u8fc7\u7ee7\u627f public Member controller \u6765\u770b\u770b\u8fd9\u4e2a\u8fc7\u7a0b\uff0c\u5e76\u6dfb\u52a0\u4e00\u4e2a\u65b0\u7684\u52a8\u4f5c\u6765\u663e\u793a\u4e00\u4e2a\u7b80\u5358\u7684\u6d88\u606f\u3002 \u9996\u5148\u8981\u505a\u7684\u662f\u521b\u5efa\u4e00\u4e2a\u9644\u52a0\u7ec4\u4ef6\u3002 \u6211\u4eec\u4e4b\u524d\u5df2\u7ecf\u4ecb\u7ecd\u8fc7\u5982\u4f55\u4f7f\u7528 xf-addon:create \u547d\u4ee4 \u5728\u8fd9\u91cc \u3002 \u5728\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\uff0c\u6211\u4eec\u5c06\u5047\u8bbe\u4f60\u521b\u5efa\u4e86\u4e00\u4e2a ID \u548c\u6807\u9898\u4e3a \"Demo\" \u7684\u9644\u52a0\u7ec4\u4ef6\u3002 \u73b0\u5728\uff0c\u60a8\u5c06\u5728\u4ee5\u4e0b\u4f4d\u7f6e\u4e2d\u51fa\u73b0\u6b64\u9644\u52a0\u7ec4\u4ef6\u7684 addon.json \u6587\u4ef6 src/addons/Demo/addon.json \u3002 Note \u867d\u7136\u4e25\u683c\u6765\u8bf4\uff0c\u4f60\u53ef\u4ee5\u628a\u7ee7\u627f class \u653e\u5728\u9644\u52a0\u7ec4\u4ef6\u76ee\u5f55\u4e0b\u4efb\u4f55\u4f60\u559c\u6b22\u7684\u5730\u65b9\uff0c\u4f46\u5efa\u8bae\u628a\u7ee7\u627f class \u653e\u5728\u4e00\u4e2a\u5bb9\u6613\u8bc6\u522b\u7684\u76ee\u5f55\u4e0b a) class \u6240\u5c5e\u7684\u9644\u52a0\u7ec4\u4ef6 b) \u88ab\u7ee7\u627f \u7684 class \u7c7b\u578b c) \u88ab\u7ee7\u627f\u7684 class \u540d\u79f0 \u5728\u4e0b\u9762\u7684\u4f8b\u5b50\u4e2d\uff0c\u6211\u4eec\u8981\u7ee7\u627f public \u7684 XF Member Controller\uff0c\u6240\u4ee5\u6211\u4eec\u5c06\u6211\u4eec\u7684\u7ee7\u627f class \u653e\u5728\u4e0b\u9762\u7684\u8def\u5f84\u4e2d\uff1a src/addons/Demo/XF/Pub/Controller/Member.php \u3002 \u5728\u6211\u4eec\u5c06 Class extension \u6dfb\u52a0\u5230 Admin CP \u4e4b\u524d\uff0c\u7ee7\u627f\u7684 class \u9700\u8981\u5b58\u5728\u3002 \u6240\u4ee5\uff0c\u8bf7\u6309\u7167\u4e0b\u9762\u7684\u8bf4\u660e\u8fdb\u884c\u64cd\u4f5c\uff1a \u5728 src/addons/Demo \u5185\u65b0\u5efa\u4e00\u4e2a\u540d\u4e3a XF \u7684\u76ee\u5f55\u3002 \u5728 src/addons/Demo/XF \u5185\u65b0\u5efa\u4e00\u4e2a\u540d\u4e3a Pub \u7684\u76ee\u5f55\u3002 \u5728 src/addons/Demo/XF/Pub \u5185\u65b0\u5efa\u4e00\u4e2a\u540d\u4e3a Controller \u7684\u76ee\u5f55\u3002 \u5728 src/addons/Demo/XF/Pub/Controller \u5185\u65b0\u5efa\u4e00\u4e2a\u540d\u4e3a Member.php \u7684\u6587\u4ef6\u3002 \u4f60\u7684PHP\u6587\u4ef6\u521d\u59cb\u5185\u5bb9\uff0c\u5e94\u8be5\u5982\u4e0b\u6240\u793a\uff1a <?php namespace Demo\\XF\\Pub\\Controller; class Member extends XFCP_Member { } \u5982\u679c\u4f60\u5bf9\u4e00\u822c\u7684 PHP class \u7ee7\u627f\u6bd4\u8f83\u719f\u6089\uff0c\u4f46\u5bf9 XF \u4e0d\u719f\u6089\uff0c\u4e0a\u9762\u7684\u4f8b\u5b50\u6700\u521d\u53ef\u80fd\u4f1a\u8ba9\u4f60\u611f\u5230\u56f0\u60d1\u3002 \u539f\u56e0\u662f\u4f60\u53ef\u80fd\u671f\u671b\u76f4\u63a5\u7ee7\u627f XF\\Pub\\Controller\\Member \u7c7b\u76ee\u5f55\uff0c\u800c\u4e0d\u662f XFCP_Member \u3002 \u5728 XF \u4e2d\uff0c\u6211\u4eec\u4f7f\u7528 \"XenForo Class Proxy\" \u7cfb\u7edf\uff08\u7b80\u79f0 XFCP \uff09\u6765\u6784\u5efa\u4e00\u4e2a \"inheritance chain\"\uff0c\u6700\u7ec8\u5141\u8bb8\u4e00\u4e2a class \u88ab\u591a\u4e2a\u9644\u52a0\u7ec4\u4ef6\u7ee7\u627f\u3002 \u60ef\u4f8b\u662f\u53c2\u8003\u4e00\u4e2a\u865a\u62df\u7684\u7ee7\u627f class\uff0c\u4e5f\u5c31\u662f\u5f53\u524d\u7684 class \u540d Member \uff0c\u5e76\u4ee5 XFCP_ \u4e3a\u524d\u7f00\u3002 \u73b0\u5728 class \u5df2\u7ecf\u521b\u5efa\u597d\u4e86\uff0c\u6211\u4eec\u53ef\u4ee5\u5728 Admin CP > \u5f00\u53d1 > Class extensions > \u6dfb\u52a0 Class extensions \u9875\u9762\u4e0a\u521b\u5efa Class extension\u3002 \u4f60\u9700\u8981\u505a\u7684\u5c31\u662f\u5728\u7b2c\u4e00\u4e2a\u5b57\u6bb5\u4e2d\u8f93\u5165\u57fa\u672c class \u540d\uff08 XF\\Pub\\Controller\\Member \uff09\uff0c\u5728\u7b2c\u4e8c\u4e2a\u5b57\u6bb5\u4e2d\u8f93\u5165\u7ee7\u627f class \u540d\uff08\u4f60\u521a\u521a\u521b\u5efa\u7684\uff09\uff08 Demo\\XF\\Pub\\Controller\\Member \uff09\uff0c\u7136\u540e\u70b9\u51fb \"\u4fdd\u5b58\" \u6309\u94ae\u3002 \u4f60\u7684 Class extension \u73b0\u5728\u5e94\u8be5\u662f\u88ab\u6fc0\u6d3b\u7684\uff0c\u4f46\u5f53\u524d\u6ca1\u6709\u505a\u4efb\u4f55\u4e8b\u60c5\u3002 \u8981\u505a\u4e00\u4e9b\u4e8b\u60c5\uff0c\u6211\u4eec\u9700\u8981\u901a\u8fc7\u521b\u5efa\u4e00\u4e2a\u4e0e\u73b0\u6709 method \u540c\u540d\u7684 method \u6765 override \u8fd9\u4e2a class \u4e2d\u7684\u73b0\u6709 method\uff0c\u6216\u8005\u521b\u5efa\u4e00\u4e2a\u5168\u65b0\u7684 method\u3002 \u8ba9\u6211\u4eec\u6765\u505a\u540e\u8005\uff0c\u521b\u5efa\u5168\u65b0\u7684 method\u3002 <?php namespace Demo\\XF\\Pub\\Controller; class Member extends XFCP_Member { public function actionHelloWorld() { return $this->message('Hello world!'); } } \u6211\u4eec\u5728 Controller \u57fa\u7840\u77e5\u8bc6 \u7684\u9875\u9762\u4e2d\u4f1a\u66f4\u591a\u7684\u8bb2\u5230 Controller \u3001 Action \u548c Reply\uff0c\u6240\u4ee5\u73b0\u5728\u4e0d\u7528\u7279\u522b\u62c5\u5fc3\u4e86\u89e3\u8fd9\u4e9b\u3002 \u73b0\u5728\u6211\u4eec\u5df2\u7ecf\u6dfb\u52a0\u4e86\u4e00\u4e9b\u4ee3\u7801\u5230\u6211\u4eec\u7684\u7ee7\u627f Controller \u4e2d\uff0c\u8ba9\u6211\u4eec\u6765\u770b\u770b\u5b83\u7684\u8fd0\u4f5c\u3002 \u7b80\u5358\u5730\u8f93\u5165\u4ee5\u4e0b\u7f51\u5740 (\u76f8\u5bf9\u4e8e\u4f60\u7684\u8bba\u575bURL): index.php?members/hello-world \u3002 \u73b0\u5728\u4f60\u5e94\u8be5\u4f1a\u770b\u5230\u4e00\u4e2a \"Hello world!\" \u7684\u6d88\u606f\uff01 \u5982\u524d\u6240\u8ff0\uff0c\u5728\u4e00\u4e2a class \u4e2d\u4e5f\u53ef\u4ee5\u590d\u76d6\u73b0\u6709\u7684\u65b9\u6cd5\u3002 \u4f8b\u5982\uff0c\u5982\u679c\u6211\u4eec\u5c06 actionHelloWorld() \u6539\u4e3a actionIndex() \uff0c\u90a3\u9ebd\u4f60\u5c06\u4e0d\u518d\u6709 \"Notable members\" \u5217\u8868\uff0c\u800c\u662f\u663e\u793a \"Hello world!\" \u6d88\u606f\uff01 \u4e8b\u5b9e\u4e0a\uff0c\u8fd9\u5e76\u4e0d\u662f\u7ee7\u627f\u73b0\u6709 Controller \u52a8\u4f5c\uff08\u6216\u4efb\u4f55 class \u65b9\u6cd5\uff09\u7684\u6b63\u786e\u65b9\u5f0f\uff0c\u4f46\u6211\u4eec\u4f1a\u5728 \u4fee\u6539 Controller Action Reply\uff08properly\uff09 \u4e00\u8282\u4e2d\u8be6\u7ec6\u4ecb\u7ecd\u3002 \u7c7b\u578b\u63d0\u793a \u00b6 XF \u4e2d\u7684\u5f88\u591a\u7269\u4ef6\u90fd\u662f\u901a\u8fc7\u5de5\u5382\u65b9\u6cd5\u5b9e\u4f53\u5316\u7684\u3002 \u4f8b\u5982\uff0c\u5982\u679c\u6211\u4eec\u60f3\u5b9e\u4f53\u5316\u4e00\u4e2a\u7279\u5b9a\u7684\u4fdd\u5b58\u5e93\uff0c\u6211\u4eec\u4f1a\u5199\u4ee5\u4e0b\u5185\u5bb9\uff1a $repo = \\XF::repository('Demo:Thing'); \u8fd9\u662f\u4e00\u79cd\u975e\u5e38\u65b9\u4fbf\u548c\u4e00\u81f4\u7684\u5b9e\u4f53\u5316\u7269\u4ef6\u7684\u65b9\u5f0f\u3002 \u6211\u4eec\u53ea\u8981\u770b\u4e00\u773c\uff0c\u5c31\u77e5\u9053\u4f1a\u5b9e\u4f53\u5316\u4ec0\u9ebd\u7269\u4ef6\u3002 \u8be5\u65b9\u6cd5\u4e2d\u751f\u6210\u7684\u4ee3\u7801\u77e5\u9053\u5982\u4f55\u4e3a\u6211\u4eec\u8bf7\u6c42\u7684\u4e1c\u897f\u8fd4\u56de\u6b63\u786e\u7684\u7269\u4ef6\u3002 \u7136\u800c\uff0c\u4e0d\u5e78\u7684\u662f\uff0c\u4f60\u7684 IDE \u53ef\u80fd\u4e0d\u77e5\u9053\uff08\u81f3\u5c11\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u662f\u8fd9\u6837\uff09\u3002 \u5c31 IDE \u800c\u8a00\uff0c\u8fd9\u4e2a\u65b9\u6cd5\u5c06\u8fd4\u56de\u4e00\u4e2a XF\\Mvc\\Entity\\Repository \u7684\u7269\u4ef6\u5b9e\u4f53\u3002 \u8fd9\u5728\u4e00\u5b9a\u7a0b\u5ea6\u4e0a\u662f\u6709\u7528\u7684\uff0c\u4f46\u662f\u5728\u7279\u5b9a\u7684 Demo\\Repository\\Thing \u7269\u4ef6\u4e2d\u53ef\u80fd\u6709\u5f88\u591a\u65b9\u6cd5\u662f\u4f60\u7684 IDE \u4e0d\u77e5\u9053\u7684\u3002 \u8fd9\u6700\u7ec8\u610f\u5473\u7740\uff0c\u5f53\u4f60\u8bd5\u56fe\u5728\u4ee3\u7801\u4e2d\u4f7f\u7528\u4f60\u7684 $repo \u7269\u4ef6\u65f6\uff0c\u4f60\u7684 IDE \u5c06\u65e0\u6cd5\u63d0\u51fa\u5efa\u8bae\u6216\u81ea\u52a8\u5b8c\u6210\u65b9\u6cd5\u540d\u548c\u5b83\u6240\u9700\u8981\u7684\u53c2\u6570\u3002 \u8fd9\u5c31\u662f\u7c7b\u578b\u63d0\u793a\u7684\u7528\u5904\uff0c\u800c\u4e14\u5927\u591a\u6570 IDE \u548c\u4e00\u4e9b\u80fd\u591f \"\u8bc6\u522b PHP\" \u7684\u6587\u672c\u7f16\u8f91\u5668\u90fd\u5e94\u8be5\u6807\u51c6\u5730\u652f\u63f4\u8fd9\u79cd\u8bed\u6cd5\u3002 \u6211\u4eec\u53ea\u9700\u5c06\u4fdd\u5b58\u5e93\u7684\u8c03\u7528\u4fee\u6539\u5982\u4e0b\uff1a /** @var \\Demo\\Repository\\Thing $repo */ $repo = \\XF::repository('Demo:Thing'); \u4fdd\u5b58\u5e93\u8c03\u7528\u4e0a\u9762\u7684\u7c7b\u578b\u63d0\u793a\u73b0\u5728\u544a\u8bc9 IDE\uff0c $repo \u6d89\u53ca\u5230\u4e00\u4e2a\u7531 Demo\\Repository\\Thing class \u8868\u793a\u7684\u7269\u4ef6\uff0c\u800c\u4e0d\u662f\u539f\u6765\u81ea\u52a8\u63a8\u65ad\u7684\u7269\u4ef6\u3002 \u7c7b\u578b\u63d0\u793a\u5728\u7ee7\u627f class \u7684\u65f6\u5019\u4e5f\u7279\u522b\u6709\u7528\u3002 \u6211\u4eec\u7684 Class extension \u65b9\u6cd5\u6709\u4e00\u4e2a\u6f5c\u5728\u7684\u95ee\u9898\uff0c\u90a3\u5c31\u662f\u57fa\u672c\u4e0a\u4f60\u7684 class \u5e76\u6ca1\u6709\u7ee7\u627f\u4f60\u8981\u7ee7\u627f\u7684\u539f class\uff0c\u800c\u662f\u901a\u8fc7\u4e00\u4e2a\u5b9e\u9645\u4e0a\u5e76\u4e0d\u5b58\u5728\u7684 class \u6765\u4ee3\u7406\u8fd9\u4e2a class\uff0c\u6bd4\u5982 \u4e0a\u9762\u4f8b\u5b50 \u4e2d\u7684 XFCP_Member \u3002 \u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0c\u6211\u4eec\u4f1a\u81ea\u52a8\u751f\u6210\u4e00\u4e2a\u540d\u4e3a extension_hint.php \u7684\u6587\u4ef6\uff0c\u5e76\u5c06\u5176\u4fdd\u5b58\u5728\u4f60\u7684 _output \u76ee\u5f55\u4e0b\u3002 \u8fd9\u5c31\u589e\u52a0\u4e86\u4e00\u4e2a IDE \u53ef\u4ee5\u8bfb\u53d6\u4f46 PHP \u4e0d\u80fd\u8bfb\u53d6\u7684\u53c2\u8003\uff0c\u6240\u4ee5 IDE \u73b0\u5728\u53ef\u4ee5\u7406\u89e3\uff0c\u5f53\u6211\u4eec\u5728\u8fd9\u4e2a\u7ee7\u627f class \u7684\u4efb\u4f55\u65b9\u6cd5\u4e2d\u4f7f\u7528 $this \u65f6\uff0c\u5b83\u53ef\u4ee5\u5efa\u8bae\u5e76\u81ea\u52a8\u5b8c\u6210\u5728 Member Controller \u6216\u5176\u7236\u7c7b\u4e2d\u53ef\u7528\u7684\u65b9\u6cd5\u548c\u5c5e\u6027\u3002","title":"\u901a\u7528\u6982\u5ff5"},{"location":"general-concepts/#_1","text":"\u4ee5\u4e0b\u90e8\u5206\u5c06\u8be6\u7ec6\u4ecb\u7ecd\u5f00\u53d1 XenForo \u9644\u52a0\u7ec4\u4ef6\u65f6\u5c06\u4f1a\u9047\u5230\u7684\u4e00\u4e9b\u901a\u7528\u7cfb\u7edf\u548c\u6982\u5ff5\u3002 \u5982\u679c\u60a8\u719f\u6089 XenForo 1.x \u7684\u5f00\u53d1\uff0c\u90a3\u9ebd\u8fd9\u4e9b\u6982\u5ff5\u4e2d\u7684\u5f88\u591a\u5185\u5bb9\u60a8\u90fd\u4f1a\u899a\u5f97\u5f88\u719f\u6089\uff0c\u4e0d\u8fc7\u503c\u5f97\u56de\u987e\u4e00\u4e0b\uff0c\u56e0\u4e3a\u6709\u4e00\u4e9b\u4f18\u79c0\u7684\u65b0\u5de5\u5177\u548c\u529f\u80fd\u53ef\u4ee5\u5e2e\u52a9\u60a8\u5f00\u53d1\u9644\u52a0\u7ec4\u4ef6\u3002","title":"\u901a\u7528\u6982\u5ff5"},{"location":"general-concepts/#vendor","text":"XF2 \u5e76\u4e0d\u50cf XF1 \u90a3\u6837\u7531\u4e00\u4e2a\u7279\u5b9a\u7684\u6846\u67b6\u6765\u9a71\u52a8\uff0c\u7136\u800c\uff0c\u6211\u4eec\u4f7f\u7528\u4e86\u67d0\u4e9b\u6d41\u884c\u7684\u3001\u7ecf\u8fc7\u826f\u597d\u6d4b\u8bd5\u7684\u3001\u5f00\u6e90\u7684\u8f6f\u4ef6\u5305\u6765\u5e2e\u52a9\u5b8c\u6210\u7279\u5b9a\u7684\u4efb\u52a1\u3002 \u4f8b\u5982\uff0c\u6211\u4eec\u4f7f\u7528\u4e00\u4e2a\u540d\u4e3a SwiftMailer \u7684\u9879\u76ee\u6765\u53d1\u9001\u7535\u5b50\u90ae\u4ef6\uff0c\u4ee5\u53ca\u4e00\u4e2a\u540d\u4e3a Guzzle \u7684\u9879\u76ee\u4f5c\u4e3a HTTP \u5ba2\u6237\u7aef\u3002 \u6240\u6709\u7684\u7b2c\u4e09\u65b9\u9879\u76ee\u90fd\u662f\u4ece src/vendor \u76ee\u5f55\u4e0b\u52a0\u8f7d\u7684\u3002 \u5f53\u524d\uff0c\u9644\u52a0\u7ec4\u4ef6\u5f00\u53d1\u8005\u8fd8\u4e0d\u80fd\u5c06\u81ea\u5df1\u7684\u4f9d\u8d56\u5173\u7cfb\u6dfb\u52a0\u5230\u8fd9\u4e2a\u4f4d\u7f6e\u3002","title":"Vendor \u7ec4\u4ef6"},{"location":"general-concepts/#ide","text":"\u5728\u5f00\u59cb XF2 \u5f00\u53d1\u5de5\u4f5c\u4e4b\u524d\uff0c\u4f60\u53ef\u80fd\u9700\u8981\u82b1\u4e00\u4e9b\u65f6\u95f4\u6765\u8bc4\u4f30\u4f60\u5c06\u5b9e\u9645\u521b\u5efa\u548c\u7f16\u8f91 PHP \u6587\u4ef6\u7684\u5e94\u7528\u7a0b\u5e8f\u3002 \u8fd9\u901a\u5e38\u88ab\u79f0\u4e3a IDE\u3002 \u6709\u8bb8\u591a\u53ef\u7528\u7684\u9009\u9879\uff0c\u4ece\u57fa\u672c\u7684\u8bb0\u4e8b\u672c\u5230\u50cf Sublime Text \u8fd9\u6837\u53ef\u4ee5\u901a\u8fc7\u9644\u52a0\u7ec4\u4ef6\u6269\u5c55\u4ee5\u83b7\u5f97\u66f4\u597d\u7684 PHP \u652f\u6301\u7684\u4e1c\u897f\uff0c\u76f4\u5230\u4e00\u4e2a\u5408\u9002\u7684 IDE\uff0c\u5982 PhpStorm \u3002 \u5728\u5185\u90e8\uff0c\u6211\u4eec\u4f7f\u7528 PhpStorm \u4f5c\u4e3a\u6211\u4eec\u7684\u9996\u9009 IDE\u3002 \u8fd9\u662f\u4e00\u4e2a\u9ad8\u7ea7\u7684\u5546\u4e1a\u4ea7\u54c1\uff0c\u4f46\u4e5f\u6709\u53ef\u80fd\u662f\u514d\u8d39\u7684\u3002 \u65e0\u8bba\u54ea\u79cd\u65b9\u5f0f\uff0c\u6ca1\u6709\u4eba\u80fd\u544a\u8bc9\u4f60\u6700\u7b26\u5408\u60a8\u987b\u6c42\u7684\u6700\u4f73\u5e94\u7528\u8fdb\u7a0b\u662f\u54ea\u4e2a\uff0c\u4f60\u5e94\u8be5\u82b1\u4e9b\u65f6\u95f4\u591a\u4f7f\u7528\u4e00\u4e9b\u4ea7\u54c1\uff08\u751a\u81f3\u662f\u514d\u8d39\u7684\uff09\uff0c\u5e76\u4f7f\u7528\u8fd9\u4e9b\u7ecf\u9a8c\u6765\u627e\u51fa\u4f60\u7684\u559c\u597d\u3002","title":"\u6574\u5408\u5f00\u53d1\u73af\u5883 (IDE)"},{"location":"general-concepts/#_2","text":"XF2 \u4f7f\u7528\u4e00\u4e2a\u7531 Composer \u81ea\u52a8\u751f\u6210\u7684\u81ea\u52a8\u52a0\u8f7d\u5668\u3002 \u8fd9\u5141\u8bb8\u6240\u6709\u7684 XF \u4ee3\u7801\u3001\u7b2c\u4e09\u65b9\u4f9b\u5e94\u5546\u4ee3\u7801\uff0c\u4ee5\u53ca\u4efb\u4f55\u9644\u52a0\u7ec4\u4ef6\u7684\u5f00\u53d1\u8005\u4ee3\u7801\u5728\u6574\u4e2a\u9879\u76ee\u4e2d\u81ea\u52a8\u5305\u542b\u8fdb\u53bb\uff0c\u800c\u4e0d\u9700\u8981\u624b\u52a8 include/require \u4f60\u7684 class\u3002 \u6240\u6709 XF \u9644\u52a0\u7ec4\u4ef6\u7684\u81ea\u52a8\u52a0\u8f7d\u6839\u76ee\u5f55\u662f src/addons \u76ee\u5f55\u3002 \u8fd9\u610f\u5473\u7740\u4f60\u6240\u6709\u7684 class \u540d\u90fd\u4f1a\u76f8\u5bf9\u4e8e\u8fd9\u4e2a\u57fa\u7840\u4f4d\u7f6e\u3002 \u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0cXF2 \u91c7\u7528\u4e86\u4e25\u683c\u7684 \"\u6bcf\u4e2a\u6587\u4ef6\u4e00\u4e2a\u7c7b\" \u7684\u547d\u540d\u6a21\u5f0f\u3002 \u6bcf\u4e2a\u6587\u4ef6\u5e94\u8be5\u53ea\u5305\u542b\u4e00\u4e2a\u7c7b\uff0c\u800c\u4e14\u8fd9\u4e2a\u7c7b\u7684\u540d\u5b57\u5e94\u8be5\u786e\u5b9a\u8be5\u7c7b\u7684 PHP \u6587\u4ef6\u5728\u6587\u4ef6\u7cfb\u7edf\u4e2d\u7684\u786e\u5207\u4f4d\u7f6e\u3002 \u4f8b\u5982\uff0c\u5982\u679c\u4f60\u60f3\u5728\u4e00\u4e2a\u540d\u4e3a src/addons/Demo/Setup.php \u7684\u6587\u4ef6\u4e2d\u521b\u5efa\u4e00\u4e2a\u65b0\u7684 class\uff08\u5176\u4e2d Demo \u662f\u4f60\u7684 \u9644\u52a0\u7ec4\u4ef6 ID\uff09\uff0c\u90a3\u9ebd\u8fd9\u4e2a class \u5c06\u88ab\u547d\u540d\u4e3a Demo\\Setup \u3002 \u76f8\u53cd\uff0c\u5982\u679c\u4f60\u6709\u4e00\u4e2a\u540d\u4e3a Demo\\Entity\\Thing \u7684 class\uff0c\u90a3\u9ebd\u4f60\u4f1a\u77e5\u9053\u8fd9\u4e2a class \u7684\u6587\u4ef6\u4f4d\u4e8e\u8def\u5f84 src/addons/Demo/Entity/Thing.php \u4e2d\u3002","title":"\u81ea\u52a8\u52a0\u8f7d\u5668"},{"location":"general-concepts/#_3","text":"\u5728\u6574\u4e2a XF \u4e2d\uff0c\u6211\u4eec\u4f7f\u7528\u4e86 \u547d\u540d\u7a7a\u95f4 \uff0c\u8fd9\u6837\u6211\u4eec\u53ef\u4ee5\u66f4\u7b80\u6d01\u5730\u53c2\u8003\u540c\u4e00\u547d\u540d\u7a7a\u95f4\u4e2d\u7684\u7c7b\u3002\u5efa\u8bae\u6240\u6709\u7684\u9644\u52a0\u7ec4\u4ef6\u4e5f\u4f7f\u7528\u547d\u540d\u7a7a\u95f4\u3002 \u5728\u4e0a\u9762\u7684\u4f8b\u5b50\u4e2d\uff0c\u6211\u4eec\u8c08\u5230\u4e86\u4e00\u4e2a\u540d\u4e3a Demo\\Setup \u7684\u7c7b\u3002 \u4f7f\u7528\u547d\u540d\u7a7a\u95f4\uff0c\u8fd9\u4e2a\u7c7b\u5b9e\u9645\u4e0a\u4f1a\u88ab\u7b80\u5358\u5730\u547d\u540d\u4e3a Setup \uff0c\u4f46\u547d\u540d\u7a7a\u95f4\u4f1a\u88ab\u8bbe\u7f6e\u4e3a Demo \u3002 \u4f5c\u4e3a\u4e00\u4e2a\u66f4\u5177\u4f53\u7684\u4f8b\u5b50\uff0c\u6211\u4eec\u5728\u4e0a\u9762\u4e5f\u8c08\u5230\u4e86\u4e00\u4e2a\u540d\u4e3a Demo\\Entity\\Thing \u7684\u7c7b\u3002 \u8ba9\u6211\u4eec\u6765\u770b\u770b\u8fd9\u4e2a\u7c7b\u7684 PHP \u4ee3\u7801\u662f\u4ec0\u9ebd\u6837\u5b50\u7684\uff1a <?php namespace Demo\\Entity; class Thing { } \u5982\u679c\u5728 src/addons/Demo/Entity \u76ee\u5f55\u4e0b\u6709\u4e00\u4e2a\u540d\u4e3a AnotherThing \u7684 class\uff0c\u6211\u4eec\u53ef\u4ee5\u5728 Thing class \u4e2d\u7b80\u5358\u5730\u5c06\u8fd9\u4e2a class \u5f15\u7528\u4e3a AnotherThing \uff0c\u56e0\u4e3a\u8fd9\u4e2a class \u5728\u540c\u4e00\u4e2a Demo\\Entity \u547d\u540d\u7a7a\u95f4\u4e2d\u3002","title":"\u547d\u540d\u7a7a\u95f4"},{"location":"general-concepts/#_4","text":"\u5076\u5c14\uff0cXF \u4e2d\u53c2\u8003\u7684 class \u4f1a\u88ab\u7f29\u77ed\u3002 \u4f8b\u5982\uff0c\u5982\u679c\u60a8\u5e0c\u671b\u8c03\u7528 User \u5b9e\u4f53\uff08\u66f4\u591a\u5173\u4e8e\u5b9e\u4f53\u7684\u5185\u5bb9\u89c1\u4e0b\u6587\uff09\uff0c\u90a3\u9ebd\u60a8\u53ef\u80fd\u4f1a\u770b\u5230\u88ab\u5f15\u7528\u7684 class \u540d\u53ea\u662f XF:User \u3002 \u77ed\u7c7b\u540d\u7684\u4f7f\u7528\u548c\u5b83\u4eec\u6240\u89e3\u6790\u7684\u5168\u7c7b\u540d\uff0c\u5b8c\u5168\u662f\u4f9d\u7167 context sensitive \u7684\u3002 \u56e0\u6b64\uff0c\u5728\u8c03\u7528\u5b9e\u4f53\u7684 context \u4e2d\uff0c\u77ed\u7c7b\u540d\u5c06\u89e3\u6790\u4e3a\u4ee5\u4e0b\u5168\u7c7b\u540d XF/Entity/User \u3002 XF \u90e8\u5206\u8868\u793a\u6587\u4ef6\u8def\u5f84 (\u57fa\u4e8e\u9644\u52a0\u7684 ID )\uff0c Entity \u90e8\u5206\u662f\u901a\u8fc7\u8c03\u7528\u5b9e\u4f53\u6697\u793a\u7684\uff0c User \u90e8\u5206\u8868\u793a\u7279\u5b9a\u7684\u5b9e\u4f53\u3002 \u540c\u6837\u5f53\u4f60\u5f00\u59cb\u521b\u5efa\u81ea\u5df1\u7684 class \u65f6\uff0c\u4f60\u4e5f\u4f1a\u4f7f\u7528\u7b80\u77ed\u7684 class \u540d\u6765\u5f15\u7528\u81ea\u5df1\u7684 class\u3002 \u4f8b\u5982\uff0c\u5982\u679c\u4f60\u9700\u8981\u4e3a\u4f60\u7684 Demo \u9644\u52a0\u7ec4\u4ef6\u521b\u5efa\u4e00\u4e2a\u65b0\u7684 Thing \u5b9e\u4f53\uff0c\u90a3\u9ebd\u4f60\u4f1a\u5199\u51fa\u4ee5\u4e0b\u5185\u5bb9\u3002 \\XF::em()->create('Demo:Thing'); \u8fd9\u5c06\u89e3\u6790\u4e3a Demo\\Entity\\Thing class\u3002 \u540c\u6837\uff0c\u5982\u679c\u4f60\u60f3\u8bbf\u95ee\u4e00\u4e2a Thing \u4fdd\u5b58\u5e93\uff0c\u4f60\u53ef\u4ee5\u8fd9\u6837\u5199\u3002 \\XF::repository('Demo:Thing'); \u8bf7\u6ce8\u610f\u8fd9\u4e9b\u77ed\u7c7b\u540d\u662f\u5982\u4f55\u76f8\u540c\u7684\u3002 \u4fdd\u5b58\u5e93\u7684\u8c03\u7528\u5b9e\u9645\u4e0a\u4f1a\u89e3\u6790\u4e3a Demo\\Repository\\Thing \u3002","title":"\u77ed\u7c7b\u540d"},{"location":"general-concepts/#_5","text":"XF2 \u4e2d\u5927\u591a\u6570\u7684 class \u90fd\u662f\u53ef\u7ee7\u627f\u7684\uff0c\u8fd9\u4f7f\u5f97\u5f00\u53d1\u4eba\u5458\u53ef\u4ee5\u7ee7\u627f\u548c\u590d\u76d6\u6838\u5fc3\u4ee3\u7801\uff0c\u800c\u65e0\u9700\u76f4\u63a5\u7f16\u8f91\u5b83\u3002 \u5982\u679c\u4f60\u719f\u6089 XF1 \u7684\u5f00\u53d1\uff0c\u4f60\u4f1a\u5bf9\u4e0b\u9762\u7684\u8fc7\u7a0b\u6709\u4e9b\u719f\u6089\uff1a \u521b\u5efa\u4e00\u4e2a\u76d1\u542c\u5668 PHP \u6587\u4ef6 \u521b\u5efa\u4e00\u4e2a class\uff0c\u8be5 class \u6700\u7ec8\u5c06\u7ee7\u627f\u539f\u6709\u7684 class \u7f16\u5199\u4e00\u4e2a function\uff0c\u8be5 function \u4e0e\u9884\u671f\u7684 load_class \u4e8b\u4ef6\u7684 callback \u7b7e\u7ae0\u76f8\u7b26\u5408\uff0c\u5e76\u6dfb\u52a0\u7ee7\u627f class \u7684\u540d\u79f0 \u5728 Admin CP \u4e2d\u6dfb\u52a0\u4e00\u4e2a \"\u4ee3\u7801\u4e8b\u4ef6\u76d1\u542c\u5668\"\uff0c\u6307\u5b9a\u4e0a\u8ff0 function \u7684\u76d1\u542c\u5668 class \u548c method \u540d\uff0c\u5e76\u53ef\u9009\u5730\u63d0\u793a\u7ee7\u627f\u7684\u662f\u54ea\u4e2a class \u5728 XF2 \u4e2d\uff0c\u6211\u4eec\u53bb\u6389\u4e86\u8fd9\u4e9b\u4e8b\u4ef6\uff0c\u800c\u91c7\u7528\u4e86\u4e00\u4e2a\u540d\u4e3a \"Class extensions\" \u7684\u7279\u5b9a\u7cfb\u7edf\u3002 \u8fd9\u4e2a\u8fc7\u7a0b\u5982\u4e0b\u3002 \u521b\u5efa\u4e00\u4e2a class\uff0c\u8be5 class \u6700\u7ec8\u5c06\u7ee7\u627f\u539f\u6709\u7684 class \u5728 Admin CP \u4e2d\u6dfb\u52a0\u4e00\u4e2a \"Class extension\"\uff0c\u6307\u5b9a\u4f60\u8981\u7ee7\u627f\u7684 class \u7684\u540d\u79f0\u548c\u6b63\u5728\u7ee7\u627f\u7684 class \u7684\u540d\u79f0\u3002 \u8fd9\u663e\u7136\u51cf\u5c11\u4e86\u4e00\u4e9b\u7ee7\u627f class \u6240\u9700\u7684\u6a21\u677f\uff0c\u4e5f\u63d0\u4f9b\u4e86\u4e00\u4e2a\u4e13\u95e8\u7684 UI \u6765\u67e5\u770b\u548c\u7ba1\u7406\u8fd9\u4e9b\u7ee7\u627f\u3002 \u8ba9\u6211\u4eec\u901a\u8fc7\u7ee7\u627f public Member controller \u6765\u770b\u770b\u8fd9\u4e2a\u8fc7\u7a0b\uff0c\u5e76\u6dfb\u52a0\u4e00\u4e2a\u65b0\u7684\u52a8\u4f5c\u6765\u663e\u793a\u4e00\u4e2a\u7b80\u5358\u7684\u6d88\u606f\u3002 \u9996\u5148\u8981\u505a\u7684\u662f\u521b\u5efa\u4e00\u4e2a\u9644\u52a0\u7ec4\u4ef6\u3002 \u6211\u4eec\u4e4b\u524d\u5df2\u7ecf\u4ecb\u7ecd\u8fc7\u5982\u4f55\u4f7f\u7528 xf-addon:create \u547d\u4ee4 \u5728\u8fd9\u91cc \u3002 \u5728\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\uff0c\u6211\u4eec\u5c06\u5047\u8bbe\u4f60\u521b\u5efa\u4e86\u4e00\u4e2a ID \u548c\u6807\u9898\u4e3a \"Demo\" \u7684\u9644\u52a0\u7ec4\u4ef6\u3002 \u73b0\u5728\uff0c\u60a8\u5c06\u5728\u4ee5\u4e0b\u4f4d\u7f6e\u4e2d\u51fa\u73b0\u6b64\u9644\u52a0\u7ec4\u4ef6\u7684 addon.json \u6587\u4ef6 src/addons/Demo/addon.json \u3002 Note \u867d\u7136\u4e25\u683c\u6765\u8bf4\uff0c\u4f60\u53ef\u4ee5\u628a\u7ee7\u627f class \u653e\u5728\u9644\u52a0\u7ec4\u4ef6\u76ee\u5f55\u4e0b\u4efb\u4f55\u4f60\u559c\u6b22\u7684\u5730\u65b9\uff0c\u4f46\u5efa\u8bae\u628a\u7ee7\u627f class \u653e\u5728\u4e00\u4e2a\u5bb9\u6613\u8bc6\u522b\u7684\u76ee\u5f55\u4e0b a) class \u6240\u5c5e\u7684\u9644\u52a0\u7ec4\u4ef6 b) \u88ab\u7ee7\u627f \u7684 class \u7c7b\u578b c) \u88ab\u7ee7\u627f\u7684 class \u540d\u79f0 \u5728\u4e0b\u9762\u7684\u4f8b\u5b50\u4e2d\uff0c\u6211\u4eec\u8981\u7ee7\u627f public \u7684 XF Member Controller\uff0c\u6240\u4ee5\u6211\u4eec\u5c06\u6211\u4eec\u7684\u7ee7\u627f class \u653e\u5728\u4e0b\u9762\u7684\u8def\u5f84\u4e2d\uff1a src/addons/Demo/XF/Pub/Controller/Member.php \u3002 \u5728\u6211\u4eec\u5c06 Class extension \u6dfb\u52a0\u5230 Admin CP \u4e4b\u524d\uff0c\u7ee7\u627f\u7684 class \u9700\u8981\u5b58\u5728\u3002 \u6240\u4ee5\uff0c\u8bf7\u6309\u7167\u4e0b\u9762\u7684\u8bf4\u660e\u8fdb\u884c\u64cd\u4f5c\uff1a \u5728 src/addons/Demo \u5185\u65b0\u5efa\u4e00\u4e2a\u540d\u4e3a XF \u7684\u76ee\u5f55\u3002 \u5728 src/addons/Demo/XF \u5185\u65b0\u5efa\u4e00\u4e2a\u540d\u4e3a Pub \u7684\u76ee\u5f55\u3002 \u5728 src/addons/Demo/XF/Pub \u5185\u65b0\u5efa\u4e00\u4e2a\u540d\u4e3a Controller \u7684\u76ee\u5f55\u3002 \u5728 src/addons/Demo/XF/Pub/Controller \u5185\u65b0\u5efa\u4e00\u4e2a\u540d\u4e3a Member.php \u7684\u6587\u4ef6\u3002 \u4f60\u7684PHP\u6587\u4ef6\u521d\u59cb\u5185\u5bb9\uff0c\u5e94\u8be5\u5982\u4e0b\u6240\u793a\uff1a <?php namespace Demo\\XF\\Pub\\Controller; class Member extends XFCP_Member { } \u5982\u679c\u4f60\u5bf9\u4e00\u822c\u7684 PHP class \u7ee7\u627f\u6bd4\u8f83\u719f\u6089\uff0c\u4f46\u5bf9 XF \u4e0d\u719f\u6089\uff0c\u4e0a\u9762\u7684\u4f8b\u5b50\u6700\u521d\u53ef\u80fd\u4f1a\u8ba9\u4f60\u611f\u5230\u56f0\u60d1\u3002 \u539f\u56e0\u662f\u4f60\u53ef\u80fd\u671f\u671b\u76f4\u63a5\u7ee7\u627f XF\\Pub\\Controller\\Member \u7c7b\u76ee\u5f55\uff0c\u800c\u4e0d\u662f XFCP_Member \u3002 \u5728 XF \u4e2d\uff0c\u6211\u4eec\u4f7f\u7528 \"XenForo Class Proxy\" \u7cfb\u7edf\uff08\u7b80\u79f0 XFCP \uff09\u6765\u6784\u5efa\u4e00\u4e2a \"inheritance chain\"\uff0c\u6700\u7ec8\u5141\u8bb8\u4e00\u4e2a class \u88ab\u591a\u4e2a\u9644\u52a0\u7ec4\u4ef6\u7ee7\u627f\u3002 \u60ef\u4f8b\u662f\u53c2\u8003\u4e00\u4e2a\u865a\u62df\u7684\u7ee7\u627f class\uff0c\u4e5f\u5c31\u662f\u5f53\u524d\u7684 class \u540d Member \uff0c\u5e76\u4ee5 XFCP_ \u4e3a\u524d\u7f00\u3002 \u73b0\u5728 class \u5df2\u7ecf\u521b\u5efa\u597d\u4e86\uff0c\u6211\u4eec\u53ef\u4ee5\u5728 Admin CP > \u5f00\u53d1 > Class extensions > \u6dfb\u52a0 Class extensions \u9875\u9762\u4e0a\u521b\u5efa Class extension\u3002 \u4f60\u9700\u8981\u505a\u7684\u5c31\u662f\u5728\u7b2c\u4e00\u4e2a\u5b57\u6bb5\u4e2d\u8f93\u5165\u57fa\u672c class \u540d\uff08 XF\\Pub\\Controller\\Member \uff09\uff0c\u5728\u7b2c\u4e8c\u4e2a\u5b57\u6bb5\u4e2d\u8f93\u5165\u7ee7\u627f class \u540d\uff08\u4f60\u521a\u521a\u521b\u5efa\u7684\uff09\uff08 Demo\\XF\\Pub\\Controller\\Member \uff09\uff0c\u7136\u540e\u70b9\u51fb \"\u4fdd\u5b58\" \u6309\u94ae\u3002 \u4f60\u7684 Class extension \u73b0\u5728\u5e94\u8be5\u662f\u88ab\u6fc0\u6d3b\u7684\uff0c\u4f46\u5f53\u524d\u6ca1\u6709\u505a\u4efb\u4f55\u4e8b\u60c5\u3002 \u8981\u505a\u4e00\u4e9b\u4e8b\u60c5\uff0c\u6211\u4eec\u9700\u8981\u901a\u8fc7\u521b\u5efa\u4e00\u4e2a\u4e0e\u73b0\u6709 method \u540c\u540d\u7684 method \u6765 override \u8fd9\u4e2a class \u4e2d\u7684\u73b0\u6709 method\uff0c\u6216\u8005\u521b\u5efa\u4e00\u4e2a\u5168\u65b0\u7684 method\u3002 \u8ba9\u6211\u4eec\u6765\u505a\u540e\u8005\uff0c\u521b\u5efa\u5168\u65b0\u7684 method\u3002 <?php namespace Demo\\XF\\Pub\\Controller; class Member extends XFCP_Member { public function actionHelloWorld() { return $this->message('Hello world!'); } } \u6211\u4eec\u5728 Controller \u57fa\u7840\u77e5\u8bc6 \u7684\u9875\u9762\u4e2d\u4f1a\u66f4\u591a\u7684\u8bb2\u5230 Controller \u3001 Action \u548c Reply\uff0c\u6240\u4ee5\u73b0\u5728\u4e0d\u7528\u7279\u522b\u62c5\u5fc3\u4e86\u89e3\u8fd9\u4e9b\u3002 \u73b0\u5728\u6211\u4eec\u5df2\u7ecf\u6dfb\u52a0\u4e86\u4e00\u4e9b\u4ee3\u7801\u5230\u6211\u4eec\u7684\u7ee7\u627f Controller \u4e2d\uff0c\u8ba9\u6211\u4eec\u6765\u770b\u770b\u5b83\u7684\u8fd0\u4f5c\u3002 \u7b80\u5358\u5730\u8f93\u5165\u4ee5\u4e0b\u7f51\u5740 (\u76f8\u5bf9\u4e8e\u4f60\u7684\u8bba\u575bURL): index.php?members/hello-world \u3002 \u73b0\u5728\u4f60\u5e94\u8be5\u4f1a\u770b\u5230\u4e00\u4e2a \"Hello world!\" \u7684\u6d88\u606f\uff01 \u5982\u524d\u6240\u8ff0\uff0c\u5728\u4e00\u4e2a class \u4e2d\u4e5f\u53ef\u4ee5\u590d\u76d6\u73b0\u6709\u7684\u65b9\u6cd5\u3002 \u4f8b\u5982\uff0c\u5982\u679c\u6211\u4eec\u5c06 actionHelloWorld() \u6539\u4e3a actionIndex() \uff0c\u90a3\u9ebd\u4f60\u5c06\u4e0d\u518d\u6709 \"Notable members\" \u5217\u8868\uff0c\u800c\u662f\u663e\u793a \"Hello world!\" \u6d88\u606f\uff01 \u4e8b\u5b9e\u4e0a\uff0c\u8fd9\u5e76\u4e0d\u662f\u7ee7\u627f\u73b0\u6709 Controller \u52a8\u4f5c\uff08\u6216\u4efb\u4f55 class \u65b9\u6cd5\uff09\u7684\u6b63\u786e\u65b9\u5f0f\uff0c\u4f46\u6211\u4eec\u4f1a\u5728 \u4fee\u6539 Controller Action Reply\uff08properly\uff09 \u4e00\u8282\u4e2d\u8be6\u7ec6\u4ecb\u7ecd\u3002","title":"\u7ee7\u627f\u7c7b"},{"location":"general-concepts/#_6","text":"XF \u4e2d\u7684\u5f88\u591a\u7269\u4ef6\u90fd\u662f\u901a\u8fc7\u5de5\u5382\u65b9\u6cd5\u5b9e\u4f53\u5316\u7684\u3002 \u4f8b\u5982\uff0c\u5982\u679c\u6211\u4eec\u60f3\u5b9e\u4f53\u5316\u4e00\u4e2a\u7279\u5b9a\u7684\u4fdd\u5b58\u5e93\uff0c\u6211\u4eec\u4f1a\u5199\u4ee5\u4e0b\u5185\u5bb9\uff1a $repo = \\XF::repository('Demo:Thing'); \u8fd9\u662f\u4e00\u79cd\u975e\u5e38\u65b9\u4fbf\u548c\u4e00\u81f4\u7684\u5b9e\u4f53\u5316\u7269\u4ef6\u7684\u65b9\u5f0f\u3002 \u6211\u4eec\u53ea\u8981\u770b\u4e00\u773c\uff0c\u5c31\u77e5\u9053\u4f1a\u5b9e\u4f53\u5316\u4ec0\u9ebd\u7269\u4ef6\u3002 \u8be5\u65b9\u6cd5\u4e2d\u751f\u6210\u7684\u4ee3\u7801\u77e5\u9053\u5982\u4f55\u4e3a\u6211\u4eec\u8bf7\u6c42\u7684\u4e1c\u897f\u8fd4\u56de\u6b63\u786e\u7684\u7269\u4ef6\u3002 \u7136\u800c\uff0c\u4e0d\u5e78\u7684\u662f\uff0c\u4f60\u7684 IDE \u53ef\u80fd\u4e0d\u77e5\u9053\uff08\u81f3\u5c11\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u662f\u8fd9\u6837\uff09\u3002 \u5c31 IDE \u800c\u8a00\uff0c\u8fd9\u4e2a\u65b9\u6cd5\u5c06\u8fd4\u56de\u4e00\u4e2a XF\\Mvc\\Entity\\Repository \u7684\u7269\u4ef6\u5b9e\u4f53\u3002 \u8fd9\u5728\u4e00\u5b9a\u7a0b\u5ea6\u4e0a\u662f\u6709\u7528\u7684\uff0c\u4f46\u662f\u5728\u7279\u5b9a\u7684 Demo\\Repository\\Thing \u7269\u4ef6\u4e2d\u53ef\u80fd\u6709\u5f88\u591a\u65b9\u6cd5\u662f\u4f60\u7684 IDE \u4e0d\u77e5\u9053\u7684\u3002 \u8fd9\u6700\u7ec8\u610f\u5473\u7740\uff0c\u5f53\u4f60\u8bd5\u56fe\u5728\u4ee3\u7801\u4e2d\u4f7f\u7528\u4f60\u7684 $repo \u7269\u4ef6\u65f6\uff0c\u4f60\u7684 IDE \u5c06\u65e0\u6cd5\u63d0\u51fa\u5efa\u8bae\u6216\u81ea\u52a8\u5b8c\u6210\u65b9\u6cd5\u540d\u548c\u5b83\u6240\u9700\u8981\u7684\u53c2\u6570\u3002 \u8fd9\u5c31\u662f\u7c7b\u578b\u63d0\u793a\u7684\u7528\u5904\uff0c\u800c\u4e14\u5927\u591a\u6570 IDE \u548c\u4e00\u4e9b\u80fd\u591f \"\u8bc6\u522b PHP\" \u7684\u6587\u672c\u7f16\u8f91\u5668\u90fd\u5e94\u8be5\u6807\u51c6\u5730\u652f\u63f4\u8fd9\u79cd\u8bed\u6cd5\u3002 \u6211\u4eec\u53ea\u9700\u5c06\u4fdd\u5b58\u5e93\u7684\u8c03\u7528\u4fee\u6539\u5982\u4e0b\uff1a /** @var \\Demo\\Repository\\Thing $repo */ $repo = \\XF::repository('Demo:Thing'); \u4fdd\u5b58\u5e93\u8c03\u7528\u4e0a\u9762\u7684\u7c7b\u578b\u63d0\u793a\u73b0\u5728\u544a\u8bc9 IDE\uff0c $repo \u6d89\u53ca\u5230\u4e00\u4e2a\u7531 Demo\\Repository\\Thing class \u8868\u793a\u7684\u7269\u4ef6\uff0c\u800c\u4e0d\u662f\u539f\u6765\u81ea\u52a8\u63a8\u65ad\u7684\u7269\u4ef6\u3002 \u7c7b\u578b\u63d0\u793a\u5728\u7ee7\u627f class \u7684\u65f6\u5019\u4e5f\u7279\u522b\u6709\u7528\u3002 \u6211\u4eec\u7684 Class extension \u65b9\u6cd5\u6709\u4e00\u4e2a\u6f5c\u5728\u7684\u95ee\u9898\uff0c\u90a3\u5c31\u662f\u57fa\u672c\u4e0a\u4f60\u7684 class \u5e76\u6ca1\u6709\u7ee7\u627f\u4f60\u8981\u7ee7\u627f\u7684\u539f class\uff0c\u800c\u662f\u901a\u8fc7\u4e00\u4e2a\u5b9e\u9645\u4e0a\u5e76\u4e0d\u5b58\u5728\u7684 class \u6765\u4ee3\u7406\u8fd9\u4e2a class\uff0c\u6bd4\u5982 \u4e0a\u9762\u4f8b\u5b50 \u4e2d\u7684 XFCP_Member \u3002 \u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0c\u6211\u4eec\u4f1a\u81ea\u52a8\u751f\u6210\u4e00\u4e2a\u540d\u4e3a extension_hint.php \u7684\u6587\u4ef6\uff0c\u5e76\u5c06\u5176\u4fdd\u5b58\u5728\u4f60\u7684 _output \u76ee\u5f55\u4e0b\u3002 \u8fd9\u5c31\u589e\u52a0\u4e86\u4e00\u4e2a IDE \u53ef\u4ee5\u8bfb\u53d6\u4f46 PHP \u4e0d\u80fd\u8bfb\u53d6\u7684\u53c2\u8003\uff0c\u6240\u4ee5 IDE \u73b0\u5728\u53ef\u4ee5\u7406\u89e3\uff0c\u5f53\u6211\u4eec\u5728\u8fd9\u4e2a\u7ee7\u627f class \u7684\u4efb\u4f55\u65b9\u6cd5\u4e2d\u4f7f\u7528 $this \u65f6\uff0c\u5b83\u53ef\u4ee5\u5efa\u8bae\u5e76\u81ea\u52a8\u5b8c\u6210\u5728 Member Controller \u6216\u5176\u7236\u7c7b\u4e2d\u53ef\u7528\u7684\u65b9\u6cd5\u548c\u5c5e\u6027\u3002","title":"\u7c7b\u578b\u63d0\u793a"},{"location":"lets-build-an-add-on/","text":"\u521b\u5efa\u4e00\u4e2a\u9644\u52a0\u7ec4\u4ef6 \u00b6 \u5bf9\u4e8e\u4e00\u4e9b\u4eba\u6765\u8bf4\uff0c\u76f4\u63a5\u8fdb\u5165\u4e00\u4e2a\u9879\u76ee\u662f\u6700\u597d\u7684\u5b66\u4e60\u65b9\u5f0f\uff0c\u6211\u4eec\u7684\u76ee\u7684\u662f\u5728\u4e0b\u9762\u7684\u7ae0\u8282\u4e2d\uff0c\u60a8\u5c06\u5b66\u4e60\u5982\u4f55\u4ece\u5934\u5f00\u59cb\u6784\u5efa\u4e00\u4e2a\u9644\u52a0\u7ec4\u4ef6\u3002 \u505a\u597d\u51c6\u5907\uff1b\u8fd9\u4e0d\u662f\u4e00\u4e2a\u7b80\u5358\u7684 'Hello world' \u7c7b\u578b\u7684\u6f14\u793a\u3002 \u8fd9\u5b9e\u9645\u4e0a\u662f\u4e00\u4e2a\u529f\u80fd\u76f8\u5f53\u9f50\u5168\u7684\u6f14\u793a\u63d2\u4ef6\uff0c\u51fd\u76d6\u4e86 XF2 \u4e2d\u7684\u8bb8\u591a\u6982\u5ff5\u3002 \u6211\u4eec\u8981\u521b\u5efa\u7684\u9644\u52a0\u7ec4\u4ef6\u5c06\u5141\u8bb8\u62e5\u6709\u9002\u5f53\u6743\u9650\u7684\u7528\u6237 \"\u7cbe\u9009\" \u4e00\u4e2a\u4e3b\u9898\uff0c\u5e76\u5141\u8bb8\u8be5\u4e3b\u9898\u5728\u65b0\u9875\u9762\u4e0a\u663e\u793a\u3002 \u6211\u4eec\u751a\u81f3\u4f1a\u8bbe\u7f6e\u4e00\u4e2a\u6d41\u7a0b\uff0c\u81ea\u52a8\u5728\u7279\u5b9a\u7684\u8bba\u575b\u4e2d\u5bf9\u4e3b\u9898\u8fdb\u884c\u7cbe\u9009\u5904\u7406\u3002 \u6211\u4eec\u5c06\u4e3a\u6b64\u4f7f\u7528\u4e00\u4e2a\u65b0\u7684\u8def\u7531\uff0c\u547d\u540d\u4e3a portal \uff0c\u5e76\u6700\u7ec8\u5c06\u5176\u8bbe\u7f6e\u4e3a\u7d22\u5f15\u9875\u8def\u7531\uff0c\u5e76\u8bbe\u7f6e\u5728\u6d4f\u89c8\u8be5\u9875\u9762\u65f6\u9009\u62e9 \"Home\" \u6807\u7b7e\u3002 \u521b\u5efa\u9644\u52a0\u7ec4\u4ef6 \u00b6 \u5728\u6574\u4e2a\u9644\u52a0\u7ec4\u4ef6\u4e2d\uff0c\u6211\u4eec\u5c06\u4f7f\u7528\u9644\u52a0\u7ec4\u4ef6 ID \u4e3a Demo/Portal \u3002 \u9996\u5148\u6211\u4eec\u9700\u8981\u505a\u7684\u662f\u521b\u5efa\u9644\u52a0\u7ec4\u4ef6\uff0c\u4e3a\u6b64\u6211\u4eec\u9700\u8981\u6253\u5f00 \u547d\u4ee4\u63d0\u793a\u5b57\u7b26 / shell / \u7ec8\u7aef\u7a97\u53e3\uff0c\u5c06\u76ee\u5f55\u6539\u4e3a\u4f60\u7684 XF \u5b89\u88c5\u6839\u76ee\u5f55\uff08\u5373 cmd.php \u6240\u5728\u7684\u4f4d\u7f6e\uff09\uff0c\u7136\u540e\u8fd0\u884c\u4ee5\u4e0b\u547d\u4ee4\uff0c\u5e76\u8f93\u5165\u4e0b\u9762\u663e\u793a\u7684\u5bf9\u7b56\uff1a Terminal $ php cmd.php xf-addon:create Enter an ID for this add-on: Demo/Portal Enter a title: Demo - Portal Enter a version ID: This integer will be used for internal variable comparisons. Each release of your addon should increase this number: 1000010 Version string set to: 1.0.0 Alpha Does this add-on supersede a XenForo 1 add-on? (y/n) n The addon.json file was successfully written out to /var/www/src/addons/Demo/Portal/addon.json Does your add-on need a Setup file? (y/n) y Does your Setup need to support running multiple steps? (y/n) y The Setup.php file was successfully written out to /var/www/src/addons/Demo/Portal/Setup.php \u9644\u52a0\u7ec4\u4ef6\u73b0\u5728\u5df2\u7ecf\u521b\u5efa\uff0c\u4f60\u4f1a\u53d1\u73b0\u4f60\u5728 src/addons \u76ee\u5f55\u4e0b\u6709\u4e00\u4e2a\u65b0\u7684\u76ee\u5f55\uff0c\u4f60\u4f1a\u5728 Admin CP \u7684 \"\u5df2\u5b89\u88c5 add-ons\" \u5217\u8868\u4e2d\u627e\u5230\u8be5\u9644\u52a0\u7ec4\u4ef6\u3002 \u5176\u4e2d\u4e00\u4e2a\u5df2\u7ecf\u521b\u5efa\u7684\u6587\u4ef6\u662f addon.json \u6587\u4ef6\uff0c\u5b83\u5f53\u524d\u7684\u6837\u5b50\u662f\u8fd9\u6837\u7684\uff1a { \"legacy_addon_id\": \"\", \"title\": \"Demo - Portal\", \"description\": \"\", \"version_id\": 1000010, \"version_string\": \"1.0.0 Alpha\", \"dev\": \"\", \"dev_url\": \"\", \"faq_url\": \"\", \"support_url\": \"\", \"extra_urls\": [], \"require\": [], \"icon\": \"\" } \u8ba9\u6211\u4eec\u6765\u586b\u4e00\u4e0b\u8fd9\u4e9b\u8be6\u7ec6\u5185\u5bb9\uff1a { \"legacy_addon_id\": \"\", \"title\": \"Demo - Portal\", \"description\": \"Add-on which will display featured threads on the forum home page.\", \"version_id\": 1000010, \"version_string\": \"1.0.0 Alpha\", \"dev\": \"You!\", \"dev_url\": \"\", \"faq_url\": \"\", \"support_url\": \"\", \"extra_urls\": [], \"require\": [], \"icon\": \"fa-home\" } \u73b0\u5728\uff0c\u6211\u4eec\u5df2\u7ecf\u6dfb\u52a0\u4e86 description \uff0c\u5f00\u53d1\u8005\u7684\u540d\u5b57 ( dev )\uff0c\u5e76\u6307\u5b9a\u6211\u4eec\u8981\u663e\u793a\u4e00\u4e2a\u56fe\u6807 ( icon )\u3002 \u56fe\u6807\u53ef\u4ee5\u662f\u4e00\u4e2a\u8def\u5f84\uff08\u76f8\u5bf9\u4e8e\u4f60\u7684 add-on \u6839\u76ee\u5f55\uff09\uff0c\u4e5f\u53ef\u4ee5\u662f\u4e00\u4e2a Font Awesome \u56fe\u6807 \u7684\u540d\u79f0\uff0c\u5c31\u8c61\u6211\u4eec\u5728\u8fd9\u91cc\u505a\u7684\u90a3\u6837\u3002 \u7531\u4e8e\u6211\u4eec\u4e0d\u662f\u8981\u53d6\u4ee3 XenForo 1 \u9644\u52a0\u7ec4\u4ef6\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u5ffd\u7565 legacy_addon_id \u3002 \u5173\u4e8e addon.json \u6587\u4ef6\u4e2d\u6240\u6709\u5c5e\u6027\u7684\u5b8c\u6574\u89e3\u91ca\uff0c\u8bf7\u53c2\u8003 \u9644\u52a0\u7ec4\u4ef6\u7ed3\u6784\u90e8\u5206 \u3002 \u521b\u5efa Setup \u7c7b \u00b6 \u597d\u5427\uff0c\u4e25\u683c\u6765\u8bf4\uff0c\u8fd9\u4e2a\u7c7b\u5df2\u7ecf\u88ab\u521b\u5efa\u5e76\u5199\u5165\u4e86 Setup.php \uff0c\u4f46\u73b0\u5728\u5b83\u5e76\u6ca1\u6709\u771f\u6b63\u505a\u4ec0\u9ebd\u3002 \u6211\u4eec\u57fa\u672c\u4e0a\u5df2\u7ecf\u6709\u4e86\u4e00\u4e2a class \u9aa8\u67b6\uff0c\u5b83\u770b\u8d77\u6765\u8c61\u8fd9\u6837\uff1a <?php namespace Demo\\Portal; use XF\\AddOn\\AbstractSetup; use XF\\AddOn\\StepRunnerInstallTrait; use XF\\AddOn\\StepRunnerUninstallTrait; use XF\\AddOn\\StepRunnerUpgradeTrait; class Setup extends AbstractSetup { use StepRunnerInstallTrait; use StepRunnerUpgradeTrait; use StepRunnerUninstallTrait; } \u6211\u4eec\u5df2\u7ecf\u8c08\u8fc7\u4e00\u70b9\u5173\u4e8e Setup \u7c7b\u7684\u5185\u5bb9\u3002 \u6211\u4eec\u5c06\u628a\u5b89\u88c5\u3001\u5347\u7ea7\u548c\u5378\u8f7d\u8fc7\u7a0b\u5206\u6210\u4e0d\u540c\u7684\u6b65\u9aa4\u3002 \u8ba9\u6211\u4eec\u4ece\u5bfc\u5165\u4e00\u4e9b\u6709\u7528\u7684 Schema \u7c7b\u5f00\u59cb\u3002 \u5982\u679c\u4f60\u60f3\u4e86\u89e3\u66f4\u591a\u5173\u4e8e\u5b83\u4eec\u7684\u4fe1\u606f\uff0c\u4f60\u53ef\u4ee5\u53c2\u8003 \u7ba1\u7406 Schema \u90e8\u5206 \u3002 \u5728\u6700\u540e\u4e00\u4e2a use \u58f0\u660e\u4e4b\u540e\uff0c\u6dfb\u52a0\u4ee5\u4e0b\u51e0\u884c\uff1a use XF\\Db\\Schema\\Alter; use XF\\Db\\Schema\\Create; \u8fd9\u91cc\u7684 StepRunner \u7279\u6027\u5c06\u5904\u7406\u6240\u6709\u53ef\u7528\u6b65\u9aa4\u7684\u5faa\u73af\u8fc7\u7a0b\uff0c\u6240\u4ee5\u6211\u4eec\u8981\u505a\u7684\u5c31\u662f\u5f00\u59cb\u521b\u5efa\u8fd9\u4e9b\u6b65\u9aa4\u3002 \u6211\u4eec\u9996\u5148\u6dfb\u52a0\u4e00\u4e9b\u4ee3\u7801\uff0c\u5728 xf_forum \u8d44\u6599\u8868\u4e2d\u521b\u5efa\u4e00\u4e2a\u65b0\u7684 column\uff1a <?php namespace Demo\\Portal; use XF\\AddOn\\AbstractSetup; use XF\\AddOn\\StepRunnerInstallTrait; use XF\\AddOn\\StepRunnerUninstallTrait; use XF\\AddOn\\StepRunnerUpgradeTrait; use XF\\Db\\Schema\\Alter; use XF\\Db\\Schema\\Create; class Setup extends \\XF\\AddOn\\AbstractSetup { use StepRunnerInstallTrait; use StepRunnerUpgradeTrait; use StepRunnerUninstallTrait; public function installStep1() { $this->schemaManager()->alterTable('xf_forum', function(Alter $table) { $table->addColumn('demo_portal_auto_feature', 'tinyint')->setDefault(0); }); } } \u8fd9\u4e00 column \u88ab\u6dfb\u52a0\u5230 xf_forum \u8d44\u6599\u8868\u4e2d\uff0c\u8fd9\u6837\u6211\u4eec\u5c31\u53ef\u4ee5\u8bbe\u7f6e\u67d0\u4e9b\u8bba\u575b\u5728\u521b\u5efa\u4e3b\u9898\u65f6\u81ea\u52a8\u663e\u793a\u3002 \u8fd9\u91cc\u7684\u547d\u540d\u5f88\u91cd\u8981\uff0c\u6dfb\u52a0\u5230\u6838\u5fc3 XF \u8d44\u6599\u8868\u4e2d\u7684 columns \u603b\u662f\u5e94\u8be5\u6709\u524d\u7f00\u3002 \u8fd9\u6709\u4e24\u4e2a\u91cd\u8981\u7684\u76ee\u7684\u3002 \u7b2c\u4e00\u4e2a\u662f\u51cf\u5c11\u4e86\u91cd\u590d column \u540d\u53d1\u751f\u51b2\u7a81\u7684\u98ce\u9669\uff0c\u4ee5\u9632 XF \u6216\u5176\u4ed6\u9644\u52a0\u7ec4\u4ef6\u6709\u7406\u7531\u5728\u5c06\u6765\u6dfb\u52a0\u8be5 column\u3002 \u7b2c\u4e8c\u4e2a\u76ee\u7684\u662f\uff0c\u5b83\u6709\u52a9\u4e8e\u66f4\u5bb9\u6613\u5730\u8bc6\u522b\u54ea\u4e9b columns \u5c5e\u65bc\u54ea\u4e9b\u9644\u52a0\u7ec4\u4ef6\uff0c\u4ee5\u9632\u5c06\u6765\u51fa\u73b0\u4e00\u4e9b\u95ee\u9898\u3002 \u65e2\u7136\u5982\u6b64\uff0c\u6211\u4eec\u4e0d\u59a8\u5728\u5b89\u88c5\u7a0b\u5e8f\u4e2d\u518d\u589e\u52a0\u4e00\u4e2a\u6b65\u9aa4\u3002 \u4e3a\u4e86\u7b80\u6d01\u8d77\u89c1\uff0c\u6211\u4eec\u53ea\u663e\u793a\u65b0\u4ee3\u7801\uff0c\u800c\u4e0d\u662f\u6574\u4e2a\u7c7b\u3002 \u5b83\u5e94\u8be5\u76f4\u63a5\u653e\u5728 installStep1() \u65b9\u6cd5\u7684\u4e0b\u9762\uff1a public function installStep2() { $this->schemaManager()->alterTable('xf_thread', function(Alter $table) { $table->addColumn('demo_portal_featured', 'tinyint')->setDefault(0); }); } \u8fd9\u4e00\u6b65\u9aa4\u4e0e\u4e0a\u9762\u7684\u6b65\u9aa4\u7c7b\u4f3c\uff0c\u8fd9\u6b21\u5c06\u5728 xf_thread \u8d44\u6599\u8868\u4e2d\u6dfb\u52a0\u4e00\u4e2a\u65b0 column\u3002 \u6211\u4eec\u5c06\u4f7f\u7528\u8fd9\u4e00 column \u4f5c\u4e3a\u4e00\u4e2a\u7f13\u5b58\u503c\u6765\u5feb\u901f\u8bc6\u522b\u4e00\u4e2a\u4e3b\u9898\u662f\u5426\u6709\u7cbe\u9009\uff0c\u800c\u4e0d\u9700\u8981\u9488\u5bf9 xf_demo_portal_featured_thread \u8d44\u6599\u8868\u67e5\u627e\u6216\u8fdb\u884c\u989d\u5916\u7684\u67e5\u627e\u3002 \u8bf4\u5230\u8fd9\u91cc\uff0c\u6211\u4eec\u73b0\u5728\u5e94\u8be5\u628a\u90a3\u4e2a\u8d44\u6599\u8868\u52a0\u8fdb\u53bb\u4e86\u3002 \u8fd9\u6b21\u76f4\u63a5\u52a0\u5728 installStep2() \u4e0b\u9762\uff1a public function installStep3() { $this->schemaManager()->createTable('xf_demo_portal_featured_thread', function(Create $table) { $table->addColumn('thread_id', 'int'); $table->addColumn('featured_date', 'int'); $table->addPrimaryKey('thread_id'); }); } \u8fd9\u4e00\u6b65\u5c06\u521b\u5efa\u65b0\u7684\u8d44\u6599\u8868\u3002 \u8fd9\u5f20\u8d44\u6599\u8868\u5c06\u7528\u6765\u8bb0\u5f55\u6240\u6709\u88ab\u7cbe\u9009\u7684\u4e3b\u9898\uff0c\u4ee5\u53ca\u5b83\u4eec\u88ab\u7cbe\u9009\u7684\u65f6\u95f4\u3002 \u5728\u547d\u540d\u65b9\u9762\uff0c\u540c\u6837\u7684\u539f\u5219\u4e5f\u9002\u7528\u4e8e\u6b64\u3002 \u4e00\u4e2a\u91cd\u8981\u7684\u533a\u522b\u662f\uff0c\u6240\u6709\u7684\u8d44\u6599\u8868\u90fd\u5e94\u8be5\u53e6\u5916\u52a0\u4e0a xf_ \u7684\u524d\u7f00\u3002 \u8fd9\u6837\u505a\u7684\u539f\u56e0\u662f\uff0c\u5982\u679c\u8fdb\u884c\u4e86\u5e72\u51c0\u7684 XF \u5b89\u88c5\uff0c\u6211\u4eec\u53ef\u4ee5\u5220\u9664\u6240\u6709\u5e2f\u6709 xf_ \u524d\u7f00\u7684\u8d44\u6599\u8868\uff0c\u5305\u62ec\u90a3\u4e9b\u7531\u9644\u52a0\u7ec4\u4ef6\u521b\u5efa\u7684\u8d44\u6599\u8868\u3002 \u5728\u6dfb\u52a0\u4ee3\u7801\u65f6\uff0c\u6700\u5bb9\u6613\u5fd8\u8bb0\u7684\u4e00\u4ef6\u4e8b\u5c31\u662f\uff0c\u6dfb\u52a0\u4e86\u5404\u79cd schema \u66f4\u6539\u540e\u5fd8\u8bb0\u81ea\u5df1\u5957\u7528\u7684 schema \u66f4\u6539\u3002 \u4f60\u53ef\u4ee5\u4f7f\u7528 CLI \u547d\u4ee4\u8fd0\u884c \u5b89\u88c5/\u5347\u7ea7 \u6b65\u9aa4\u3002 \u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u8fd0\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a Terminal $ php cmd.php xf-addon:install-step Demo/Portal 1 $ php cmd.php xf-addon:install-step Demo/Portal 2 $ php cmd.php xf-addon:install-step Demo/Portal 3 \u7ee7\u627f\u8bba\u575b\u5b9e\u4f53 \u00b6 \u5230\u5f53\u524d\u4e3a\u6b62\uff0c\u6211\u4eec\u5df2\u7ecf\u5728 xf_forum \u8d44\u6599\u8868\u4e2d\u6dfb\u52a0\u4e86\u4e00 column\uff0c\u73b0\u5728\u662f\u65f6\u5019\u7ee7\u627f\u8bba\u575b Entity \u7ed3\u6784\u4e86\u3002 \u6211\u4eec\u9700\u8981\u8fd9\u6837\u505a\uff0c\u4ee5\u4fbf Entity \u77e5\u9053\u6211\u4eec\u7684\u65b0 column\uff0c\u5e76\u4e14\u53ef\u4ee5\u901a\u8fc7 Entity \u5411\u5176\u8bfb\u5199\u6570\u636e\u3002 Note \u4ee5\u4e0b\u6b65\u9aa4\u9700\u8981\u6fc0\u6d3b \u5f00\u53d1\u6a21\u5f0f \u3002 \u8bb0\u5f97\u5728 config.php \u4e2d\u8bbe\u7f6e Demo/Portal \u4e3a defaultAddOn \u503c\u3002 \u8fd9\u4e2a\u8fc7\u7a0b\u7684\u7b2c\u4e00\u6b65\u662f\u521b\u5efa\u4e00\u4e2a \"\u4ee3\u7801\u4e8b\u4ef6\u76d1\u542c\u5668\"\u3002 \u8fd9\u53ef\u4ee5\u5728\u5f00\u53d1\u4e0b\u7684 Admin CP \u4e2d\uff0c\u70b9\u51fb \"\u4ee3\u7801\u4e8b\u4ef6\u76d1\u542c\u5668\" \u94fe\u63a5\uff0c\u7136\u540e\u70b9\u51fb \"\u6dfb\u52a0\u4ee3\u7801\u4e8b\u4ef6\u76d1\u542c\u5668\" \u6309\u94ae\u3002 \u6211\u4eec\u9700\u8981\u76d1\u542c entity_structure \u4e8b\u4ef6\u3002 \u6211\u4eec\u5c06\u4f7f\u7528\u5b83\u6765\u4fee\u6539\u9ed8\u8ba4\u7684\u8bba\u575b Entity \u7ed3\u6784\uff0c\u4ee5\u6dfb\u52a0\u6211\u4eec\u65b0\u521b\u5efa\u7684 demo_portal_auto_feature column\u3002 \u5728 \"\u4e8b\u4ef6\u63d0\u793a\" \u5b57\u6bb5\u4e2d\uff0c\u6211\u4eec\u5c06\u8f93\u5165\u8981\u7ee7\u627f\u7684\u7c7b\u540d\uff0c\u4f8b\u5982 XF\\Entity\\Forum \u3002 \u8fd9\u5c06\u786e\u4fdd\u6211\u4eec\u7684\u76d1\u542c\u5668\u53ea\u5728\u8bba\u575b Entity \u4e0a\u8fd0\u884c\u3002 \u5bf9\u4e8e \"\u8fd0\u884c callback\" \u7c7b\u8f93\u5165 Demo\\Portal\\Listener \uff0c\u5bf9\u4e8e\u65b9\u6cd5\u8f93\u5165 forumEntityStructure \u3002 \u503c\u5f97\u6dfb\u52a0\u4e00\u4e2a\u63cf\u8ff0\u6765\u89e3\u91ca\u8fd9\u4e2a\u76d1\u542c\u5668\u7684\u7528\u9014\uff0c\u56e0\u4e3a\u8fd9\u5c06\u6709\u52a9\u4e8e\u66f4\u5bb9\u6613\u5730\u5728\u4ee3\u7801\u4e8b\u4ef6\u76d1\u542c\u5668\u5217\u8868\u4e2d\u8bc6\u522b\u76d1\u542c\u5668\u3002 \"\u7ee7\u627f XF\\Entity\\Forum \u7ed3\u6784\" \u5e94\u8be5\u5c31\u591f\u4e86\u3002 \u6700\u540e\uff0c\u786e\u4fdd \"Demo - Portal\" \u9644\u52a0\u7ec4\u4ef6\u88ab\u9009\u4e2d\u3002 \u5728\u70b9\u51fb \"\u4fdd\u5b58\" \u4e4b\u524d\uff0c\u6211\u4eec\u9700\u8981\u5b9e\u9645\u521b\u5efa Listener \u7c7b\u3002 \u6240\u4ee5\u5728 src/addons/Demo/Portal \u4e2d\u521b\u5efa\u4e00\u4e2a\u540d\u4e3a Listener.php \u7684\u65b0\u6587\u4ef6\u3002 \u8fd9\u4e2a\u6587\u4ef6\u7684\u5185\u5bb9\u6700\u521d\u5e94\u8be5\u662f\u8fd9\u6837\u7684\u3002 \u6211\u4eec\u4ece\u4ee3\u7801\u4e8b\u4ef6\u9009\u62e9\u5668\u4e0b\u9762\u7684\u6587\u4ef6\u4e2d\u77e5\u9053\u8fd9\u4e2a\u51fd\u6570\u9700\u8981\u7684\u53c2\u6570\u3002 <?php namespace Demo\\Portal; use XF\\Mvc\\Entity\\Entity; class Listener { public static function forumEntityStructure(\\XF\\Mvc\\Entity\\Manager $em, \\XF\\Mvc\\Entity\\Structure &$structure) { } } \u6ce8\u610f namespace \u548c class \u540d\u79f0\u4e4b\u95f4\u7684 use \u58f0\u660e\u3002 \u6211\u4eec\u5c06\u4e0d\u6b62\u4e00\u6b21\u5730\u5f15\u7528\u8fd9\u91cc\u58f0\u660e\u7684 class\uff0c\u56e0\u6b64\u5728\u8fd9\u91cc\u58f0\u660e\u5b83\u786e\u5b9e\u5141\u8bb8\u6211\u4eec\u7528\u5b83\u66f4\u77ed\u7684\u522b\u540d\u6765\u5f15\u7528\u5b83\uff0c\u5728\u672c\u4f8b\u4e2d\u662f Entity \u3002 \u8fd9\u6bb5\u4ee3\u7801\u5b9e\u9645\u4e0a\u8fd8\u4e0d\u4f1a\u505a\u4efb\u4f55\u4e8b\u60c5\uff0c\u4f46\u73b0\u5728\u662f\u4fdd\u5b58\u4ee3\u7801\u4e8b\u4ef6\u76d1\u542c\u5668\u7684\u597d\u65f6\u673a\uff0c\u6240\u4ee5\u8bf7\u7ee7\u7eed\u70b9\u51fb \"\u4fdd\u5b58\" \u6309\u94ae\u3002 \u5728\u6211\u4eec\u4e3a\u65b0\u51fd\u6570\u6dfb\u52a0\u4e00\u4e9b\u529f\u80fd\u4ee3\u7801\u4e4b\u524d\uff0c\u73b0\u5728\u4e5f\u8bb8\u662f\u4e2a\u5f88\u597d\u7684\u65f6\u673a\u6765\u770b\u770b\u5f00\u53d1\u8f93\u51fa\u7cfb\u7edf\u662f\u5982\u4f55\u8fd0\u4f5c\u7684\u3002 \u68c0\u67e5\u4e00\u4e0b\u6dfb\u52a0\u5230\u4f60 add-on \u76ee\u5f55\u4e2d\u7684\u65b0\u76ee\u5f55\u548c\u6587\u4ef6\u3002 \u7279\u522b\u662f\u5728 _output/code_event_listeners \u76ee\u5f55\u4e0b\u6709\u4e00\u4e2a\u65b0\u7684 JSON \u6587\u4ef6\uff0c\u5b83\u5e94\u8be5\u662f\u8fd9\u6837\u7684\uff1a { \"event_id\": \"entity_structure\", \"execute_order\": 10, \"callback_class\": \"Demo\\\\Portal\\\\Listener\", \"callback_method\": \"forumEntityStructure\", \"active\": true, \"hint\": \"XF\\\\Entity\\\\Forum\", \"description\": \"Extends the XF\\\\Entity\\\\Forum structure\" } \u6bcf\u5f53\u76d1\u542c\u5668\u53d1\u751f\u53d8\u5316\u65f6\uff0c\u8fd9\u4e2a\u6587\u4ef6\u4f1a\u81ea\u52a8\u66f4\u65b0\u3002 \u597d\u4e86\uff0c\u6211\u4eec\u518d\u6765\u6dfb\u52a0\u4e00\u4e9b\u4ee3\u7801\u3002 \u56de\u5230 Listener \u7c7b\u4e2d\uff0c\u5728 forumEntityStructure \u51fd\u6570\u4e2d\u6dfb\u52a0\u4ee5\u4e0b\u5185\u5bb9\uff1a $structure->columns['demo_portal_auto_feature'] = ['type' => Entity::BOOL, 'default' => false]; \u8bba\u575b Entity \u73b0\u5728\u5df2\u7ecf\u77e5\u9053\u4e86\u6211\u4eec\u7684\u65b0 column\uff0c\u4f46\u5728\u5f00\u59cb\u5b9e\u4f5c\u5bf9\u8be5 column \u8fdb\u884c\u5b9e\u9645\u8bbe\u7f6e\u503c\u7684\u65b9\u6cd5\u4e4b\u524d\uff0c\u6211\u4eec\u8fd8\u9700\u8981\u5148\u5904\u7406\u51e0\u4e2a\u6b65\u9aa4\u3002 \u7ee7\u627f\u4e3b\u9898\u5b9e\u4f53 \u00b6 \u540c\u6837\uff0c\u7531\u4e8e\u6211\u4eec\u5728 xf_thread \u8d44\u6599\u8868\u4e2d\u6dfb\u52a0\u4e86\u4e00\u4e2a\u65b0\u7684 column\uff0c\u6211\u4eec\u5e94\u8be5\u8ba9\u4e3b\u9898\u5b9e\u4f53\u77e5\u9053\u8fd9\u4e00\u70b9\u3002 \u8fd9\u4e0e\u6211\u4eec\u4e0a\u9762\u7684\u4f5c\u6cd5\u975e\u5e38\u76f8\u4f3c\u3002 \u56de\u5230 \"\u6dfb\u52a0\u4ee3\u7801\u4e8b\u4ef6\u76d1\u542c\u5668\"\uff0c\u518d\u6b21\u76d1\u542c entity_structure \u3002 \u8fd9\u6b21\u7684 \"\u4e8b\u4ef6\u63d0\u793a\" \u5c06\u662f XF\\Entity\\Thread \u3002 \u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u4e0e\u4e4b\u524d\u76f8\u540c\u7684 callback \u7c7b\uff08 Demo\\Portal\\Listener \uff09\uff0c\u4f46\u8fd9\u6b21\u7684\u65b9\u6cd5\u5c06\u547d\u540d\u4e3a threadEntityStructure \u3002 \u6dfb\u52a0\u7c7b\u4f3c\u4e4b\u524d\u7684\u63cf\u8ff0\u3002 \u5728\u4fdd\u5b58\u4e4b\u524d\uff0c\u6211\u4eec\u5e94\u8be5\u5728 forumEntityStructure \u51fd\u6570\u4e0b\u9762\u76f4\u63a5\u6dfb\u52a0\u4ee3\u7801\uff1a public static function threadEntityStructure(\\XF\\Mvc\\Entity\\Manager $em, \\XF\\Mvc\\Entity\\Structure &$structure) { $structure->columns['demo_portal_featured'] = ['type' => Entity::BOOL, 'default' => false]; } \u8fd9\u6bb5\u4ee3\u7801\u4e0e\u6211\u4eec\u5728\u8bba\u575b Entity \u7ed3\u6784\u4e2d\u6dfb\u52a0\u7684\u4ee3\u7801\u51e0\u4e4e\u76f8\u540c\uff0c\u552f\u4e00\u4e0d\u540c\u7684\u662f column \u540d\u3002 \u4f46\u662f\uff0c\u6211\u4eec\u786e\u5b9e\u9700\u8981\u6dfb\u52a0\u4e00\u4e9b\u5176\u4ed6\u7684\u4e1c\u897f\u3002 \u6211\u4eec\u5e94\u8be5\u521b\u5efa\u4e00\u4e2a Entity \u5173\u8054\uff0c\u8fd9\u6837\uff0c\u4ee5\u540e\u6211\u4eec\u9700\u8981\u8bbf\u95ee\u7cbe\u9009\u4e3b\u9898 Entity\uff08\u6211\u4eec\u5728\u4e0b\u4e00\u8282\u521b\u5efa\uff09\u65f6\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u5f88\u5bb9\u6613\u5730\u901a\u8fc7 Finder \u67e5\u627e\u6765\u5b9e\u73b0\u3002 \u5728 $structure->columns \u884c\u4e0b\u9762\u6dfb\u52a0\uff1a $structure->relations['FeaturedThread'] = [ 'entity' => 'Demo\\Portal:FeaturedThread', 'type' => Entity::TO_ONE, 'conditions' => 'thread_id', 'primary' => true ]; \u6709\u5173 \u5173\u8054 \u7684\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u89c1\u5173\u8054\u3002 \u70b9\u51fb \"\u4fdd\u5b58\" \u6765\u4fdd\u5b58\u76d1\u542c\u5668\u3002 \u521b\u5efa\u4e00\u4e2a\u65b0\u5b9e\u4f53 \u00b6 \u4e0a\u9762\u5728 installStep3() \u4e2d\uff0c\u6211\u4eec\u521b\u5efa\u4e86\u4e00\u4e2a\u65b0\u8d44\u6599\u8868\u3002 \u6211\u4eec\u9700\u8981\u521b\u5efa\u4e00\u4e2a Entity \u6765\u4e0e\u8fd9\u4e2a\u8d44\u6599\u8868\u4ea4\u4e92\u5e76\u521b\u5efa\u65b0\u7684\u8bb0\u5f55\u3002 \u56e0\u4e3a\u8fd9\u662f\u4e00\u4e2a\u5168\u65b0\u7684 Entity\uff0c\u6211\u4eec\u9664\u4e86\u5728 src/addons/Demo/Portal/Entity/FeaturedThread.php \u4e2d\u521b\u5efa class \u4e4b\u5916\uff0c\u4e0d\u9700\u8981\u505a\u4efb\u4f55\u5176\u4ed6\u7684\u4e8b\u60c5\uff0c\u5b83\u7684\u67b6\u6784\u770b\u8d77\u6765\u8c61\u8fd9\u6837\uff1a <?php namespace Demo\\Portal\\Entity; use XF\\Mvc\\Entity\\Structure; class FeaturedThread extends \\XF\\Mvc\\Entity\\Entity { } \u6211\u4eec\u9700\u8981\u7528\u5b83\u6765\u5b9a\u4e49 Entity \u7ed3\u6784\uff0c\u5b83\u4ee3\u8868\u6211\u4eec\u4e4b\u524d\u521b\u5efa\u7684\u65b0 xf_demo_portal_featured_thread \u8d44\u6599\u8868\u3002 \u8fd9\u4e2a Entity \u7684\u7ed3\u6784\u5e94\u8be5\u662f\u8fd9\u6837\u7684\uff1a public static function getStructure(Structure $structure) { $structure->table = 'xf_demo_portal_featured_thread'; $structure->shortName = 'Demo\\Portal:FeaturedThread'; $structure->primaryKey = 'thread_id'; $structure->columns = [ 'thread_id' => ['type' => self::UINT, 'required' => true], 'featured_date' => ['type' => self::UINT, 'default' => time()] ]; $structure->getters = []; $structure->relations = [ 'Thread' => [ 'entity' => 'XF:Thread', 'type' => self::TO_ONE, 'conditions' => 'thread_id', 'primary' => true ], ]; return $structure; } \u6839\u636e\u6211\u4eec\u524d\u9762\u5199\u7684 MySQL \u521b\u5efa\u8d44\u6599\u8868\uff0ccolumns \u7684\u5217\u8868\u5927\u6982\u4e0d\u9700\u8981\u52a0\u4ee5\u8bf4\u660e\u3002 \u5173\u8054\u4e2d\u5305\u62ec\u4e00\u4e2a Thread \u5173\u8054\uff0c\u5b83\u5c06\u5141\u8bb8\u6211\u4eec\u4ece\u8fd9\u4e2a Entity \u4e2d\u83b7\u5f97\u76f8\u5173\u7684\u4e3b\u9898 Entity \u8bb0\u5f55\uff08\u751a\u81f3\u4e3b\u9898 Entity \u5173\u8054\uff09\u3002 \u4fee\u6539\u8bba\u575b\u7f16\u8f91\u8868\u5355 \u00b6 \u6211\u4eec\u73b0\u5728\u9700\u8981\u4e00\u79cd\u65b9\u6cd5\u6765\u4fee\u6539 forum_edit \u6a21\u677f\uff0c\u5728\u90a3\u91cc\u6dfb\u52a0\u4e00\u4e2a\u65b0\u7684 checkbox\uff0c\u6700\u7ec8\u53ef\u4ee5\u5199\u56de\u6211\u4eec\u73b0\u5728\u521b\u5efa\u7684\u65b0 column\u3002 \u6211\u4eec\u5c06\u901a\u8fc7\u521b\u5efa\u4e00\u4e2a\u6a21\u677f\u4fee\u6539\u6765\u5b9e\u73b0\u3002 \u8fd9\u662f\u5728 Admin CP \u4e0b\u7684\u5916\u89b3\u4e2d\u5b8c\u6210\u7684\uff0c\u7136\u540e\u70b9\u51fb\u6a21\u677f\u4fee\u6539\u3002 \u70b9\u51fb \"Admin\" \u6807\u7b7e\uff0c\u7136\u540e\u518d\u70b9\u51fb \"\u6dfb\u52a0\u6a21\u677f\u4fee\u6539\" \u6309\u94ae\u3002 \u5728 \"\u6a21\u677f\" \u680f\u4e2d\uff0c\u8f93\u5165 \"forum_edit\"\u3002 \u8fd9\u5c31\u662f\u6211\u4eec\u9700\u8981\u4fee\u6539\u7684\u6a21\u677f\u3002 \u5728 \"\u4fee\u6539 key\" \u5b57\u6bb5\u4e2d\uff0c\u8f93\u5165 \"demo_portal_forum_edit\"\u3002 \u8fd9\u662f\u4e00\u4e2a\u552f\u4e00\u7684 key\uff0c\u7528\u4e8e\u6807\u8bc6\u60a8\u7684\u6a21\u677f\u4fee\u6539\u3002 \u8fd9\u90e8\u5206\u6700\u597d\u7684\u4e60\u60ef\u662f\uff0c\u6700\u8d77\u7801\u8981\u5728\u88ab\u4fee\u6539\u7684\u6a21\u677f\u540d\u79f0\u540e\u9762\u6ce8\u660e\u9644\u52a0\u7ec4\u4ef6\u3002 \"\u63cf\u8ff0\" \u5b57\u6bb5\u5e94\u8be5\u5305\u542b\u4e00\u4e9b\u6587\u672c\uff0c\u4ee5\u5e2e\u52a9\u60a8\u5728\u67e5\u770b\u6a21\u677f\u4fee\u6539\u5217\u8868\u65f6\u786e\u5b9a\u6b64\u4fee\u6539\u7684\u76ee\u7684\u3002 \u5c31\u8c61\u662f \"\u6dfb\u52a0\u81ea\u52a8\u7cbe\u9009 checkbox \u5230 forum_edit \u6a21\u677f\" \u8fd9\u6837\u7684\u5185\u5bb9\u5e94\u8be5\u8db3\u591f\u4e86\u3002 \u5f53\u60a8\u5728 \"\u6a21\u677f\" \u5b57\u6bb5\u4e2d\u8f93\u5165\u6a21\u677f\u540d\u79f0\u65f6\uff0c\u60a8\u53ef\u80fd\u4f1a\u6ce8\u610f\u5230\u663e\u793a\u4e86\u6a21\u677f\u5185\u5bb9\u7684\u9884\u89c8\u3002 \u6211\u4eec\u9700\u8981\u5229\u7528\u8fd9\u4e2a\u6765\u786e\u5b9a checkbox \u7684\u504f\u597d\u4f4d\u7f6e\u3002 \u5728\u67e5\u770b\u8bba\u575b\u7f16\u8f91\u9875\u9762\u65f6\uff0c\u4f60\u53ef\u80fd\u4f1a\u6ce8\u610f\u5230\u6709\u4e00\u7cfb\u5217\u7684 checkbox\uff0c\u8fd9\u770b\u8d77\u6765\u662f\u4e00\u4e2a\u5408\u7406\u7684\u4f4d\u7f6e\u3002 \u6700\u7b80\u5358\u7684\u65b9\u6cd5\u662f\u5728\u8fd9\u4e2a\u90e8\u5206\u653e\u7f6e\u4e00\u4e2a checkbox\uff0c\u5bf9\u4e0a\u9762\u7684 checkbox \u8fdb\u884c\u7b80\u5358\u7684\u66ff\u6362\uff0c\u6240\u4ee5\u5728 \"\u67e5\u627e\" \u680f\u4e2d\u6dfb\u52a0\uff1a <xf:option name=\"allow_posting\" \u5e76\u5728\u5b57\u6bb5\u4e2d\u66ff\u6362\uff1a <xf:option name=\"demo_portal_auto_feature\" selected=\"$forum.demo_portal_auto_feature\" label=\"Automatically feature threads in this forum\" hint=\"If selected, any new threads posted in this forum will be automatically featured.\" /> $0 \u6211\u4eec\u8fd8\u4e0d\u9700\u8981\u62c5\u5fc3\u521b\u5efa\u77ed\u8bed\u7684\u95ee\u9898\uff0c\u6211\u4eec\u53ef\u4ee5\u7a0d\u540e\u518d\u6765\u62fe\u53d6\u8fd9\u4e9b\u3002 \u6ce8\u610f\uff0c\u540d\u79f0\u5c5e\u6027\u5fc5\u987b\u4e0e\u6211\u4eec\u4e4b\u524d\u521b\u5efa\u7684 column \u540d\u76f8\u5339\u914d\uff0c\u66f4\u91cd\u8981\u7684\u662f\uff0ccheckbox row \u7684\u52fe\u9009\u72b6\u6001\u4e5f\u662f\u4ece\u8bba\u575b Entity \u4e2d\u8bfb\u53d6\u6dfb\u52a0\u52a0\u7684 column\u3002 \u5f53\u6211\u4eec\u7a0d\u540e\u4fdd\u5b58\u6a21\u677f\u4fee\u6539\u65f6\uff0c\u5982\u679c\u67e5\u627e\u5b57\u6bb5\u7684\u5185\u5bb9\u4e0e\u6a21\u677f\u7684\u4efb\u4f55\u90e8\u5206\u76f8\u5339\u914d\uff0c\u90a3\u9ebd\u5b83\u5c06\u88ab\u66ff\u6362\u5b57\u6bb5\u7684\u5185\u5bb9\u6240\u53d6\u4ee3\u3002 \u5b9e\u9645\u4e0a\u6211\u4eec\u5e76\u6ca1\u6709\u5220\u9664\u5339\u914d\u7684\u5185\u5bb9\uff0c\u56e0\u4e3a\u66ff\u6362\u5b57\u6bb5\u4e2d\u7684 $0 \u662f\u91cd\u65b0\u63d2\u5165\u5339\u914d\u7684\u6587\u672c\u3002 \u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 \"\u6d4b\u8bd5\" \u6309\u94ae\u6765\u68c0\u67e5\u66ff\u6362\u7684\u8fd0\u4f5c\u662f\u5426\u7b26\u5408\u9884\u671f\u3002 \u5f53\u70b9\u51fb\u6d4b\u8bd5\u6309\u94ae\u65f6\uff0c\u4f1a\u51fa\u73b0\u4e00\u4e2a\u590d\u76d6\u5c42\u5e2f\u6709\u4fee\u6539\u540e\u7684\u6a21\u677f\u3002 \u5982\u679c\u4e00\u5207\u987a\u5229\uff0c\u4e00\u4e2a\u7dd1\u8272\u533a\u57df\u5e94\u8be5\u9ad8\u4eae\u663e\u793a\u6211\u4eec\u8981\u6dfb\u52a0\u7684\u65b0\u4ee3\u7801\u3002 Note \u8fd9\u662f\u4e00\u4e2a\u76f8\u5f53\u7b80\u5358\u7684\u66ff\u6362\u3002 \u5bf9\u4e8e\u66f4\u8fdb\u9636\u7684\u5339\u914d\uff0c\u4f60\u4e5f\u53ef\u4ee5\u4f7f\u7528 \"\u6b63\u89c4\u8868\u8fbe\u5f0f\" \u7c7b\u578b\u3002 \u5173\u4e8e\u4f7f\u7528\u6b63\u89c4\u8868\u8fbe\u5f0f\u7684\u8be6\u7ec6\u89e3\u91ca\u8d85\u51fa\u4e86\u672c\u6307\u5357\u7684\u8303\u56f4\uff0c\u4f46\u7f51\u4e0a\u6709\u5f88\u591a\u8d44\u6e90\u53ef\u80fd\u4f1a\u6709\u6240\u5e2e\u52a9\u3002 \u6700\u540e\uff0c\u70b9\u51fb\u4fdd\u5b58\uff0c\u4fdd\u5b58\u4f60\u7684\u6a21\u677f\u4fee\u6539\u3002 \u5982\u679c\u4e00\u5207\u987a\u5229\uff0c\u5f53\u4f60\u8fd4\u56de\u6a21\u677f\u4fee\u6539\u5217\u8868\u65f6\uff0c\u4f60\u4f1a\u770b\u5230\u65e5\u5fd7\u6458\u8981\u663e\u793a 1 / 0 / 0 \u56e0\u6b64\u8868\u660e\u4fee\u6539\u6210\u529f\u5957\u7528\u4e00\u6b21\u3002 \u4e00\u4e2a\u66f4\u597d\u7684\u6307\u793a\u662f\u8fdb\u5165 Admin CP \u4e2d \"\u8bba\u575b\" \u4e0b\u7684 \"\u8282\u70b9\" \u9875\u9762\uff0c\u7f16\u8f91\u4e00\u4e2a\u73b0\u6709\u7684\u8bba\u575b\u3002 \u73b0\u5728\u5e94\u8be5\u4f1a\u51fa\u73b0\u6211\u4eec\u65b0\u6dfb\u52a0\u7684\u6a21\u677f\u4fee\u6539\u3002 \u7ee7\u627f\u8bba\u575b\u7684\u4fdd\u5b58\u8fc7\u7a0b \u00b6 \u6211\u4eec\u6709\u4e86 column\uff0c\u6709\u4e86\u4e00\u4e2a UI \u6765\u4f20\u9012 input \u5230\u8be5 column\uff0c\u73b0\u5728\u6211\u4eec\u5fc5\u987b\u5904\u7406\u4fdd\u5b58\u6570\u636e\u5230\u8be5 column\u3002 \u6211\u4eec\u5c06\u901a\u8fc7\u7ee7\u627f\u8bba\u575b Controller \u548c\u7ee7\u627f\u4e00\u4e2a\u7279\u6b8a\u7684\u65b9\u6cd5\u6765\u5b9e\u73b0\u8fd9\u4e2a\u76ee\u7684\uff0c\u5f53\u4e00\u4e2a\u8282\u70b9\u53ca\u5176\u6570\u636e\u88ab\u4fdd\u5b58\u65f6\uff0c\u8be5\u65b9\u6cd5\u5c06\u88ab\u8c03\u7528\u3002 \u9996\u5148\uff0c\u8ba9\u6211\u4eec\u521b\u5efa\u4e00\u4e2a \"Class extension\"\uff0c\u5b83\u53ef\u4ee5\u5728 Admin CP \u7684 \"\u5f00\u53d1\" \u6761\u76ee\u4e0b\u627e\u5230\u3002 \u70b9\u51fb \"\u6dfb\u52a0 Class extension\"\u3002 \u5728\u8fd9\u91cc\uff0c\u6211\u4eec\u9700\u8981\u6307\u5b9a\u4e00\u4e2a \"\u7236\u7c7b\u540d\u79f0\"\uff0c\u4e5f\u5c31\u662f\u6211\u4eec\u8981\u7ee7\u627f\u7684 class \u540d\u79f0\uff0c\u5728\u672c\u4f8b\u4e2d\u662f XF\\Admin\\Controller\\Forum \u3002 \u5e76\u4e14\u6211\u4eec\u9700\u8981\u6307\u5b9a\u4e00\u4e2a \"\u7ee7\u627f class \u540d\u79f0\"\uff0c\u4e5f\u5c31\u662f\u7ee7\u627f\u7236\u7c7b\u7684 class\u3002 \u8f93\u5165 Demo\\Portal\\XF\\Admin\\Controller\\Forum \u3002 \u6211\u4eec\u5e94\u8be5\u5728\u70b9\u51fb\u4fdd\u5b58\u4e4b\u524d\u521b\u5efa\u8fd9\u4e2a class\u3002 \u5728 src/addons/Demo/Portal/XF/Admin/Controller \u4e2d\u521b\u5efa\u4e00\u4e2a\u65b0\u6587\u4ef6\uff0c\u547d\u540d\u4e3a Forum.php \u3002 \u8fd9\u53ef\u80fd\u770b\u8d77\u6765\u8c61\u4e00\u4e2a\u5f88\u957f\u7684\u8def\u5f84\uff0c\u4f46\u6211\u4eec\u5efa\u8bae\u7ee7\u627f class \u4f7f\u7528\u8fd9\u6837\u7684\u8def\u5f84\u3002 \u5b83\u53ef\u4ee5\u8ba9\u4f60\u66f4\u5bb9\u6613\u5730\u8bc6\u522b\u51fa\u4ee3\u8868\u7ee7\u627f class \u7684\u6587\u4ef6\uff0c\u56e0\u4e3a\u5b83\u4eec\u5728\u4e00\u4e2a\u4e0e\u7ee7\u627f\u7684 \"add-on\" ID (\u672c\u4f8b\u4e2d\u4e3a XF ) \u540c\u540d\u7684\u76ee\u5f55\u4e2d\u3002 \u5b83\u8fd8\u53ef\u4ee5\u6e05\u695a\u5730\u8bf4\u660e\u5230\u5e95\u662f\u54ea\u4e2a class \u88ab\u7ee7\u627f\u4e86\uff0c\u56e0\u4e3a\u76ee\u5f55\u7ed3\u6784\u4e0e\u9ed8\u8ba4 class \u7684\u8def\u5f84\u76f8\u540c\u3002 \u5f53\u524d\uff0c\u6587\u4ef6\u7684\u5185\u5bb9\u5e94\u8be5\u662f\u8fd9\u6837\u7684\uff1a <?php namespace Demo\\Portal\\XF\\Admin\\Controller; class Forum extends XFCP_Forum { } \u66f4\u591a\u4fe1\u606f\u8bf7\u53c2\u89c1 \u7ee7\u627f\u7c7b \u548c \u7c7b\u578b\u63d0\u793a \u3002 \u70b9\u51fb\u4fdd\u5b58\uff0c\u4fdd\u5b58 Class extension\u3002 \u73b0\u5728\u6211\u4eec\u53ef\u4ee5\u6dfb\u52a0\u4e00\u4e9b\u4ee3\u7801\u4e86\u3002 \u6211\u4eec\u9700\u8981\u7ee7\u627f\u7684\u7279\u5b9a\u65b9\u6cd5\u662f\u4e00\u4e2a\u540d\u4e3a saveTypeData \u7684 protected \u51fd\u6570\u3002 \u5f53\u7ee7\u627f\u4efb\u4f55\u7c7b\u4e2d\u73b0\u6709\u7684\u65b9\u6cd5\u65f6\uff0c\u68c0\u67e5\u539f\u59cb\u65b9\u6cd5\u662f\u5f88\u91cd\u8981\u7684\uff0c\u539f\u56e0\u6709\u51e0\u4e2a\u3002 \u7b2c\u4e00\u4e2a\u539f\u56e0\u662f\u6211\u4eec\u8981\u786e\u4fdd\u6211\u4eec\u5728\u7ee7\u627f\u65b9\u6cd5\u4e2d\u4f7f\u7528\u7684\u53c2\u6570\u4e0e\u6211\u4eec\u8981\u7ee7\u627f\u7684\u65b9\u6cd5\u76f8\u5339\u914d\u3002 \u7b2c\u4e8c\u4e2a\u539f\u56e0\u662f\uff0c\u6211\u4eec\u9700\u8981\u77e5\u9053\u8fd9\u4e2a\u65b9\u6cd5\u5b9e\u9645\u4e0a\u662f\u505a\u4ec0\u9ebd\u7684\u3002 \u4f8b\u5982\uff0c\u8fd9\u4e2a\u65b9\u6cd5\u5e94\u8be5\u8fd4\u56de\u67d0\u4e2a\u7279\u5b9a\u7c7b\u578b\u7684\u4e1c\u897f\uff0c\u8fd8\u662f\u67d0\u4e2a\u7269\u4ef6\uff1f \u8fd9\u5728\u5927\u591a\u6570 Controller action \u4e2d\u80af\u5b9a\u662f\u8fd9\u6837\u7684\uff0c\u6211\u4eec\u5728 \u4fee\u6539 Controller action \u56de\u5e94\uff08properly\uff09 \u4e00\u8282\u4e2d\u63d0\u5230\u8fc7\u3002 \u7136\u800c\uff0c\u867d\u7136\u8fd9\u4e2a\u65b9\u6cd5\u662f\u5728\u4e00\u4e2a Controller \u5185\uff0c\u4f46\u5b9e\u9645\u4e0a\u5b83\u672c\u8eab\u5e76\u4e0d\u662f\u4e00\u4e2a Controller action\u3002 \u4e8b\u5b9e\u4e0a\uff0c\u8fd9\u4e2a\u65b9\u6cd5\u662f\u4e00\u4e2a \"void\" \u65b9\u6cd5\uff1b\u5b83\u4e0d\u9700\u8981\u8fd4\u56de\u4efb\u4f55\u4e1c\u897f\u3002 \u7136\u800c\uff0c\u6211\u4eec\u5e94\u8be5\u59cb\u7ec8\u786e\u4fdd\u6211\u4eec\u5728\u7ee7\u627f\u65b9\u6cd5\u4e2d\u8c03\u7528\u7236\u7c7b\u65b9\u6cd5\uff0c\u6240\u4ee5\u6211\u4eec\u53ea\u9700\u6dfb\u52a0\u65b0\u65b9\u6cd5\u672c\u8eab\uff0c\u800c\u4e0d\u9700\u8981\u6dfb\u52a0\u65b0\u7684\u4ee3\u7801\uff1a protected function saveTypeData(FormAction $form, \\XF\\Entity\\Node $node, \\XF\\Entity\\AbstractNode $data) { parent::saveTypeData($form, $node, $data); } Warning \u6b64\u7279\u5b9a\u65b9\u6cd5\u7684\u53c2\u6570\u8868\u8868\u5047\u5b9a\u6211\u4eec\u6709\u4e00\u4e2a use \u58f0\u660e\uff0c\u5b83\u5c06\u5b8c\u6574\u7684 \\XF\\Mvc\\FormAction \u7c7b\u522b\u540d\u4e3a\u7b80\u5358\u7684 FormAction \u3002 \u56e0\u6b64\u4f60\u9700\u8981\u81ea\u5df1\u6dfb\u52a0\u90a3\u4e2a use \u58f0\u660e\u3002 \u5728 namespace \u548c class \u884c\u4e4b\u95f4\u6dfb\u52a0 use XF\\Mvc\\FormAction; \u3002 \u6240\u4ee5\uff0c\u73b0\u5728\uff0c\u6211\u4eec\u5df2\u7ecf\u7ee7\u627f\u4e86\u90a3\u4e2a\u65b9\u6cd5\uff0c\u800c\u6211\u4eec\u7684\u7ee7\u627f\u5e94\u8be5\u88ab\u8c03\u7528\uff0c\u4f46\u73b0\u5728\u5b83\u9664\u4e86\u8c03\u7528\u5b83\u7684\u7236\u7c7b\u65b9\u6cd5\u5916\uff0c\u6ca1\u6709\u505a\u4efb\u4f55\u4e8b\u60c5\u3002 \u73b0\u5728\u6211\u4eec\u9700\u8981\u4ece\u8bba\u575b\u7f16\u8f91\u9875\u9762\u83b7\u53d6\u8f93\u5165\u503c\uff0c\u5e76\u5c06\u5176\u5957\u7528\u5230 $data \u5b9e\u4f53\uff08\u5728\u672c\u4f8b\u4e2d\u662f\u8bba\u575b\u5b9e\u4f53\uff09\u3002 protected function saveTypeData(FormAction $form, \\XF\\Entity\\Node $node, \\XF\\Entity\\AbstractNode $data) { parent::saveTypeData($form, $node, $data); $form->setup(function() use ($data) { $data->demo_portal_auto_feature = $this->filter('demo_portal_auto_feature', 'bool'); }); } \u4f7f\u7528 FormAction \u7269\u4ef6\u5141\u8bb8\u6211\u4eec\u5728\u5178\u578b\u7684\u8868\u5355\u63d0\u4ea4\u8fc7\u7a0b\u4e2d\uff0c\u5177\u6709\u5404\u79cd\u4e0d\u540c\u7684 extension points \u5230\u8fdb\u7a0b\u4e2d\u8fd0\u884c\u3002 \u5e76\u4e0d\u662f\u6240\u6709\u7684 Controller action \u90fd\u53ef\u4ee5\u4f7f\u7528\u3002 \u4f8b\u5982\uff0c\u5b83\u5728 Admin CP \u4e2d\u66f4\u4e3a\u666e\u904d\uff0c\u5b83\u901a\u5e38\u9075\u5faa\u7b80\u5358\u7684 CRUD \u6a21\u578b\uff08\u6dfb\u52a0\u3001\u67e5\u627e\u3001\u4fee\u6539\u3001\u5220\u9664\uff09\u3002 XF \u4e2d\u7684\u8bb8\u591a\u5176\u4ed6\u8fdb\u7a0b\u90fd\u53d1\u751f\u5728 Service \u7269\u4ef6\u5185\uff0cService \u7269\u4ef6\u901a\u5e38\u6709\u4e0e\u6b63\u5728\u8fd0\u884c\u7684\u670d\u52a1\u76f8\u5173\u7279\u5b9a extension points\u3002 FormAction \u7269\u4ef6\u7684\u8fd9\u79cd\u7279\u6b8a\u7528\u6cd5\u4e0e\u4f60\u901a\u5e38\u4f1a\u9047\u5230\u7684\u60c5\u51b5\u6709\u4e9b\u4e0d\u540c\u3002 \u4fdd\u5b58\u4e00\u4e2a\u8282\u70b9\u662f\u4e2a\u6709\u4e9b\u4e0d\u540c\u7684\u8fdb\u7a0b\uff0c\u56e0\u4e3a\u9664\u4e86\u4e0e\u8282\u70b9\u5b9e\u4f53\u4e00\u8d77\u8fd0\u4f5c\u5916\uff0c\u4f60\u8fd8\u4f1a\u4e0e\u76f8\u5173\u7684\u8282\u70b9\u7c7b\u578b\u4e00\u8d77\u8fd0\u4f5c\uff0c\u4f8b\u5982\u4e00\u4e2a\u8bba\u575b Entity\u3002 \u4e0d\u8fc7\u5728\u8fd9\u4e2a\u65b9\u6cd5\u4e2d\uff0c\u6211\u4eec\u786e\u5b9e\u53ef\u4ee5\u8bbf\u95ee\u8868\u5355 action \u7269\u4ef6\uff0c\u6240\u4ee5\u6211\u4eec\u5e94\u8be5\u4f7f\u7528\u5b83\u3002 \u6211\u4eec\u5728\u8fd9\u91cc\u4f7f\u7528\u5b83\u6765\u4e3a\u8fdb\u7a0b\u7684 \"\u8bbe\u7f6e\" \u9636\u6bb5\u6dfb\u52a0\u4e00\u4e2a\u7279\u5b9a\u7684\u884c\u4e3a\u3002 \u4e5f\u5c31\u662f\u8bf4\uff0c\u5f53\u8c03\u7528 FormAction \u7269\u4ef6\u7684 run() \u65b9\u6cd5\u65f6\uff0c\u5b83\u5c06\u6309\u7167\u7279\u5b9a\u7684\u987a\u5e8f\u8fd0\u884c\u5404\u4e2a\u9636\u6bb5\u3002 \u4e0d\u7ba1\u8fd9\u4e9b\u884c\u4e3a\u662f\u4ee5\u54ea\u79cd\u987a\u5e8f\u6dfb\u52a0\u5230\u7269\u4ef6\u4e2d\u7684\uff0c\u5b83\u4eec\u4ecd\u7136\u4f1a\u6309\u7167 setup \u3001 validate \u3001 apply \u3001 complete \u7684\u987a\u5e8f\u8fd0\u884c\u3002 \u901a\u8fc7\u4e0a\u9762\u7684\u4ee3\u7801\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u8bba\u575b Entity \u4e2d\u7684 demo_portal_auto_feature column \u8bbe\u7f6e\u4e3a\u6211\u4eec\u6dfb\u52a0\u5230\u8bba\u575b\u7f16\u8f91\u9875\u9762\u7684 demo_portal_auto_feature \u8f93\u5165\u5b58\u50a8\u7684\u4efb\u4f55\u503c\u3002 \u73b0\u5728\u5e94\u8be5\u53ef\u4ee5\u6d4b\u8bd5\u6240\u6709\u8fd9\u4e9b\u5de5\u4f5c\u4e86\u3002 \u53ea\u9700\u7f16\u8f91\u60a8\u9009\u62e9\u7684\u8bba\u575b\u5e76\u52fe\u9009 checkbox\u3002 \u4f60\u5e94\u8be5\u53ef\u4ee5\u89b3\u5bdf\u5230\u4e24\u4ef6\u4e8b\u3002 \u9996\u5148\uff0c\u5f53\u4f60\u56de\u5230\u7f16\u8f91\u90a3\u4e2a\u8bba\u575b\u65f6\uff0ccheckbox \u73b0\u5728\u5e94\u8be5\u88ab\u52fe\u9009\u4e86\u3002 \u7b2c\u4e8c\uff0c\u5982\u679c\u4f60\u5728 xf_forum \u8d44\u6599\u8868\u4e2d\u67e5\u770b\u4f60\u521a\u521a\u7f16\u8f91\u7684\u8bba\u575b\uff0c demo_portal_auto_feature \u5b57\u6bb5\u73b0\u5728\u5e94\u8be5\u8bbe\u7f6e\u4e3a 1\u3002 \u8bf7\u4fdd\u6301\u8fd9\u4e2a\u503c\uff0c\u56e0\u4e3a\u6211\u4eec\u6700\u7ec8\u4f1a\u81ea\u52a8\u7cbe\u9009\u8be5\u8bba\u575b\u7684\u4e3b\u9898\u3002 \u8bbe\u7f6e\u4e3b\u9898\u81ea\u52a8\u663e\u793a \u00b6 \u6211\u4eec\u5df2\u7ecf\u5728\u8bba\u575b Entity \u4e2d\u6dfb\u52a0\u4e86\u4e00\u4e2a\u65b0\u7684 column\uff0c\u8fd9\u5c06\u5141\u8bb8\u6211\u4eec\u5728\u8bba\u575b\u4e2d\u65b0\u521b\u5efa\u4e00\u4e2a\u4e3b\u9898\u65f6\u81ea\u52a8\u8fdb\u884c\u7cbe\u9009\u4ecb\u7ecd\uff0c\u6240\u4ee5\u73b0\u5728\u662f\u65f6\u5019\u6dfb\u52a0\u4ee3\u7801\u6765\u5b9e\u73b0\u8fd9\u4e2a\u529f\u80fd\u4e86\u3002 \u5728 XF2 \u4e2d\uff0c\u6211\u4eec\u5927\u91cf\u4f7f\u7528 Service \u7269\u4ef6\u3002 \u8fd9\u4e9b\u7269\u4ef6\u901a\u5e38\u91c7\u7528 \"setup and go\" \u7c7b\u578b\u7684\u65b9\u6cd5\uff1b\u4f60\u8bbe\u7f6e\u4f60\u7684\u914d\u7f6e\uff0c\u7136\u540e\u8c03\u7528\u4e00\u4e2a\u65b9\u6cd5\u6765\u5b8c\u6210\u52a8\u4f5c\u3002 \u6211\u4eec\u4f7f\u7528 Service \u7269\u4ef6\u6765\u8bbe\u7f6e\u548c\u5b8c\u6210\u4e3b\u9898\u521b\u5efa\uff0c\u6240\u4ee5\u8fd9\u662f\u4e00\u4e2a\u5b8c\u7f8e\u7684\u4f4d\u7f6e\u6765\u6dfb\u52a0\u6211\u4eec\u9700\u8981\u7684\u4ee3\u7801\u3002 \u8fd9\u4e00\u5207\u90fd\u8981\u4ece\u53e6\u4e00\u4e2a Class extension \u5f00\u59cb\uff0c\u6240\u4ee5\u8fdb\u5165 \"\u6dfb\u52a0 Class extension\" \u9875\u9762\u3002 \u8fd9\u4e00\u6b21\uff0c\u57fa\u7c7b\u4f1a\u662f XF\\Service\\Thread\\Creator \uff0c\u7ee7\u627f\u7c7b\u5219\u662f Demo\\Portal\\XF\\Service\\Thread\\Creator \uff0c\u548c\u5f80\u5e38\u4e00\u6837\uff0c\u8fd9\u4e2a\u65b0 class \u5c06\u770b\u8d77\u6765\u8c61\u4e0b\u9762\u7684\u4ee3\u7801\u3002 \u5728\u8def\u5f84 src/addons/Demo/Portal/XF/Service/Thread/Creator.php \u4e2d\u521b\u5efa\u8be5\u4ee3\u7801\uff0c\u7136\u540e\u70b9\u51fb \"\u4fdd\u5b58\" \u6765\u521b\u5efa\u7ee7\u627f\u7c7b\u3002 <?php namespace Demo\\Portal\\XF\\Service\\Thread; class Creator extends XFCP_Creator { } \u5728\u8fd9\u91cc\uff0c\u6211\u4eec\u8fd8\u5c06\u521b\u5efa\u53e6\u4e00\u4e2a\u7ee7\u627f\u7c7b\u3002 \u57fa\u7840\u7c7b\u662f XF\\Pub\\Controller\\Forum \uff0c\u7ee7\u627f\u7c7b\u662f Demo\\Portal\\XF\\Pub\\Controller\\Forum \u3002 \u5728\u8def\u5f84 src/addons/Demo/Portal/XF/Pub/Controller/Forum.php \u4e2d\u521b\u5efa\u4ee5\u4e0b\u4ee3\u7801\uff0c\u5e76\u70b9\u51fb \"\u4fdd\u5b58\"\uff1a <?php namespace Demo\\Portal\\XF\\Pub\\Controller; class Forum extends XFCP_Forum { } \u6211\u4eec\u6700\u7ec8\u5c06\u5728\u88ab\u7ee7\u627f\u7684\u4e3b\u9898\u4f5c\u8005\u7269\u4ef6\u4e2d\u7ee7\u627f _save() \u65b9\u6cd5\uff0c\u8fd9\u6837\u6211\u4eec\u5c31\u53ef\u4ee5\u5728\u521b\u5efa\u4e3b\u9898\u540e\u5bf9\u5176\u8fdb\u884c\u7cbe\u9009\u3002 \u4e3a\u4e86\u914d\u5408 \"setup and go\" \u7684\u65b9\u9488\uff0c\u6211\u4eec\u5c06\u521b\u5efa\u4e00\u4e2a\u65b9\u6cd5\uff0c\u5b83\u53ef\u4ee5\u7528\u6765\u6307\u793a\u4e3b\u9898\u662f\u5426\u5e94\u8be5\u88ab\u521b\u5efa\u4e3a\u7cbe\u9009\uff0c\u6216\u8005\u4e0d\u5e94\u8be5\u3002 \u4e3a\u6b64\uff0c\u6211\u4eec\u9700\u8981\u4e24\u6837\u4e1c\u897f\uff1a\u4e00\u4e2a\u662f\u7528\u6765\u4fdd\u5b58 value \u7684 class \u5c5e\u6027\uff08\u9ed8\u8ba4\u4e3a null \uff09\u548c\u4e00\u4e2a\u5141\u8bb8\u8bbe\u7f6e\u8be5\u5c5e\u6027\u7684 public \u65b9\u6cd5\u3002 protected $featureThread; public function setFeatureThread($featureThread) { $this->featureThread = $featureThread; } \u56de\u5230\u6211\u4eec\u65b0\u7ee7\u627f\u7684\u8bba\u575b Controller\uff0c\u6211\u4eec\u73b0\u5728\u5c06\u7ee7\u627f\u8bbe\u7f6e creator \u670d\u52a1\u7684\u65b9\u6cd5\uff0c\u5982\u679c\u8bba\u575b Entity \u6709\u5fc5\u8981\u7684\u8bbe\u7f6e\u503c\uff0c\u5219\u9009\u62e9\u52a0\u5165\u7cbe\u9009\u3002 \u8bf7\u8bb0\u4f4f\uff0c\u5728\u7ee7\u627f\u4e00\u4e2a\u65b9\u6cd5\u4e4b\u524d\uff0c\u6211\u4eec\u9700\u8981\u77e5\u9053\u5b83\u9884\u8ba1\u4f1a\u8fd4\u56de\u4ec0\u9ebd\uff08\u5982\u679c\u6709\u7684\u8bdd\uff09\uff0c\u5e76\u786e\u4fdd\u6211\u4eec\u8c03\u7528\u7236\u7c7b\u65b9\u6cd5\u3002 \u5982\u679c\u7236\u7c7b\u65b9\u6cd5\u786e\u5b9e\u8fd4\u56de\u4e86\u4e9b\u4ec0\u9ebd\uff0c\u90a3\u9ebd\u6211\u4eec\u5e94\u8be5\u5728\u4ee3\u7801\u5b8c\u6210\u540e\u8fd4\u56de\u8fd9\u4e2a\u65b9\u6cd5\u3002 \u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c setupThreadCreate() \u65b9\u6cd5\u4f1a\u8fd4\u56de\u8bbe\u7f6e\u597d\u7684 creator \u670d\u52a1\uff0c\u6240\u4ee5\u6211\u4eec\u5c06\u6309\u7167\u4ee5\u4e0b\u65b9\u5f0f\u5f00\u59cb\uff1a protected function setupThreadCreate(\\XF\\Entity\\Forum $forum) { /** @var \\Demo\\Portal\\XF\\Service\\Thread\\Creator $creator */ $creator = parent::setupThreadCreate($forum); return $creator; } \u6b63\u5982\u9884\u671f\u7684\u90a3\u6837\uff0c\u8fd9\u5b9e\u9645\u4e0a\u5e76\u6ca1\u6709\u505a\u4efb\u4f55\u4e8b\u60c5\uff1b\u7ee7\u627f\u7684\u4ee3\u7801\u88ab\u8c03\u7528\u4e86\uff0c\u4f46\u5b83\u6240\u505a\u7684\u53ea\u662f\u8fd4\u56de\u7236\u7c7b\u8c03\u7528\u6240\u8fd4\u56de\u7684\u5185\u5bb9\u3002 \u73b0\u5728\u6211\u4eec\u5e94\u8be5\u4fee\u6539 $creator \u6765\u8bbe\u7f6e\u7cbe\u9009\uff0c\u5982\u679c\u5b83\u9002\u7528\u4e8e\u6211\u4eec\u5f53\u524d\u6b63\u5728\u4f7f\u7528\u7684\u8bba\u575b\u3002 \u5728 $creator \u884c\u548c return \u884c\u4e4b\u95f4\u52a0\u4e0a\uff1a if ($forum->demo_portal_auto_feature) { $creator->setFeatureThread(true); } \u73b0\u5728\u6211\u4eec\u53ef\u4ee5\u5728\u7ee7\u627f\u7684 creator \u7c7b\u4e2d\u6dfb\u52a0 _save() \u65b9\u6cd5\uff1a protected function _save() { $thread = parent::_save(); return $thread; } \u4e3a\u4e86\u786e\u4fdd\u8fd9\u6761\u4e3b\u9898\u88ab\u7cbe\u9009\uff0c\u5728 $thread \u884c\u548c return \u884c\u4e4b\u95f4\uff0c\u6211\u4eec\u53ea\u9700\u8981\u6dfb\u52a0\uff1a if ($this->featureThread && $thread->discussion_state == 'visible') { /** @var \\Demo\\Portal\\Entity\\FeaturedThread $featuredThread */ $featuredThread = $thread->getRelationOrDefault('FeaturedThread'); $featuredThread->save(); $thread->fastUpdate('demo_portal_featured', true); } \u56e0\u4e3a\u6211\u4eec\u4e4b\u524d\u5728\u4e3b\u9898 Entity \u4e0a\u521b\u5efa\u4e86 FeaturedThread \u5173\u8054\uff0c\u6240\u4ee5\u5b9e\u9645\u4e0a\u6211\u4eec\u4e5f\u53ef\u4ee5\u4f7f\u7528\u8fd9\u4e2a\u5173\u8054\u6765\u521b\u5efa\uff01 \u6211\u4eec\u5728\u8fd9\u91cc\u4f7f\u7528\u4e86\u4e00\u4e2a\u540d\u4e3a getRelationOrDefault() \u7684\u65b9\u6cd5\u3002 \u5b83\u5c06\u67e5\u770b\u8be5\u5173\u8054\u662f\u5426\u5b9e\u9645\u8fd4\u56de\u4e00\u4e2a\u73b0\u6709\u7684\u8bb0\u5f55\uff0c\u5982\u679c\u6ca1\u6709\uff0c\u5b83\u5c06\u521b\u5efa\u8be5 Entity \u5e76\u4f7f\u7528\u4efb\u4f55\u9ed8\u8ba4\u503c\uff08\u5305\u62ec\u4e3b\u9898ID\uff09\u5bf9\u5176\u8fdb\u884c\u8bbe\u7f6e\uff01 \u8fd9\u610f\u5473\u7740\u6211\u4eec\u5b9e\u9645\u4e0a\u9700\u8981\u505a\u7684\u53ea\u662f\u83b7\u53d6\u9ed8\u8ba4\u7684\u5173\u8054\uff0c\u5e76\u5c06\u5176\u4fdd\u5b58\u4e0b\u6765\u63d2\u5165\u5230\u6570\u636e\u5e93\u4e2d\u3002 \u6b64\u5916\uff0c\u6211\u4eec\u5e94\u8be5\u5c06 demo_portal_featured \u5b57\u6bb5\u8bbe\u7f6e\u4e3a true\u3002 \u56e0\u4e3a\u4e3b\u9898 Entity \u5df2\u7ecf\u88ab\u4fdd\u5b58\u4e86\uff08\u5f53\u539f class \u4fdd\u5b58 Entity \u65f6\uff09\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 fastUpdate() \u65b9\u6cd5\u6765\u5feb\u901f\u4fee\u6539\u8be5\u5b57\u6bb5\u3002 \u6211\u4eec\u73b0\u5728\u9700\u8981\u5c1d\u8bd5\u8fd9\u4e00\u5207\uff0c\u5e76\u786e\u4fdd\u5b83\u80fd\u6b63\u5e38\u8fd0\u4f5c\u3002 \u524d\u5f80\u60a8\u4e4b\u524d\u6fc0\u6d3b\u4e86 demo_portal_auto_feature \u9009\u9879\u7684\u8bba\u575b\uff0c\u5e76\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u4e3b\u9898\u3002 \u73b0\u5728\u552f\u4e00\u7684\u65b9\u6cd5\u5c31\u662f\u68c0\u67e5 xf_demo_portal_featured_thread \u8d44\u6599\u8868\uff0c\u5728\u90a3\u91cc\u6211\u4eec\u5e94\u8be5\u53ef\u4ee5\u770b\u5230\u4e00\u6761\u65b0\u7684\u8bb0\u5f55\u3002 \u521b\u5efa Portal \u9875\u9762 \u00b6 \u5728\u6211\u4eec\u5b8c\u6210\u4e4b\u524d\uff0c\u8fd8\u6709\u76f8\u5f53\u591a\u7684\u5de5\u4f5c\u8981\u505a\uff0c\u4f46\u73b0\u5728\u6211\u4eec\u5df2\u7ecf\u6709\u4e86\u7cbe\u9009\u4e3b\u9898\u7684\u80fd\u529b\uff0c\u5982\u679c\u6211\u4eec\u80fd\u5728\u67d0\u4e2a\u5730\u65b9\u663e\u793a\u5b83\u4eec\uff0c\u5f53\u7136\u4f1a\u5f88\u597d\uff0c\u6240\u4ee5\u8ba9\u6211\u4eec\u5f00\u59cb\u521b\u5efa\u6211\u4eec\u7684\u5165\u53e3\u9875\u9762\u3002 \u8981\u505a\u5230\u8fd9\u4e00\u70b9\uff0c\u6211\u4eec\u9700\u8981\u65b0\u5efa\u4e00\u6761 Public \u8def\u7531\u3002 \u8fdb\u5165 Admin CP\uff0c\u5728 \"\u5f00\u53d1\" \u4e0b\u70b9\u51fb \"\u8def\u7531\"\uff0c\u7136\u540e\u70b9\u51fb \"\u6dfb\u52a0\u8def\u7531\uff1a Public\"\u3002 \u6211\u4eec\u6682\u65f6\u5148\u628a\u4e8b\u60c5\u7b80\u5358\u5316\u3002 \u8def\u7531\u7684\u524d\u7f00\u662f \"portal\"\uff0cSection context \u662f \"home\"\uff0cController \u662f \"Demo\\Portal:Portal\"\u3002 \u73b0\u5728\u6211\u4eec\u5e94\u8be5\u5728\u8def\u5f84 src/addons/Demo/Portal/Pub/Controller/Portal.php \u4e2d\u521b\u5efa Controller\uff0c\u57fa\u672c\u5185\u5bb9\u5982\u4e0b\uff1a <?php namespace Demo\\Portal\\Pub\\Controller; class Portal extends \\XF\\Pub\\Controller\\AbstractController { } \u6211\u4eec\u5e0c\u671b\u5f53\u4eba\u4eec\u8bbf\u95ee index.php?portal \u9875\u9762\u65f6\uff0c\u6211\u4eec\u7684 portal \u9875\u9762\u4f1a\u663e\u793a\u5728\u4ed6\u4eec\u9762\u524d\u3002 \u8fd9\u4e2a URL \u6ca1\u6709 \"action\" \u90e8\u5206 - \u53ea\u6709\u6211\u4eec\u521a\u521a\u521b\u5efa\u7684\u8def\u7531\u524d\u7f00\u3002 \u8003\u8651\u5230\u8fd9\u4e00\u70b9\uff0c\u6211\u4eec\u9700\u8981\u5728 actionIndex() \u65b9\u6cd5\u4e2d\u6dfb\u52a0\u663e\u793a portal \u9875\u9762\u7684\u4ee3\u7801\u3002 \u6211\u4eec\u5728\u5176\u4e2d\u9700\u8981\u7684\u57fa\u672c\u4ee3\u7801\u662f\uff1a public function actionIndex() { $viewParams = []; return $this->view('Demo\\Portal:View', 'demo_portal_view', $viewParams); } \u73b0\u5728\uff0c\u8fd9\u8fd8\u4e0d\u80fd\u5b8c\u5168\u6b63\u5e38\u8fd0\u4f5c\uff0c\u56e0\u4e3a\u6211\u4eec\u8fd8\u6ca1\u6709\u521b\u5efa\u6a21\u677f\uff0c\u4f46\u8fd9\u5df2\u7ecf\u8db3\u591f\u4e86\uff0c\u81f3\u5c11\u8bc1\u660e\u4e86\u6211\u4eec\u7684 Route \u548c Controller \u662f\u76f8\u4e92\u6c9f\u901a\u7684\u3002 \u6240\u4ee5\u8bbf\u95ee index.php?portal \u81f3\u5c11\u5e94\u8be5\u663e\u793a '\u6a21\u677f\u9519\u8bef'\u3002 \u6b63\u5982\u5728 View \u56de\u5e94 \u4e00\u8282\u4e2d\u63d0\u5230\u7684\uff0c\u7b2c\u4e00\u4e2a\u53c2\u6570\u662f\u4e00\u4e2a View class\uff0c\u4f46\u6211\u4eec\u5e76\u4e0d\u9700\u8981\u5b9e\u9645\u521b\u5efa\u8fd9\u4e2a\u7c7b\u3002 \u5982\u679c\u6709\u5fc5\u8981\uff0c\u8fd9\u4e2a class \u53ef\u4ee5\u7531\u5176\u4ed6\u9644\u52a0\u7ec4\u4ef6\u7ee7\u627f\uff0c\u5373\u4f7f\u5b83\u4e0d\u5b58\u5728\u3002 \u7b2c\u4e8c\u4e2a\u53c2\u6570\u662f\u6a21\u677f\uff0c\u6211\u4eec\u73b0\u5728\u9700\u8981\u5728\u8def\u5f84 src/addons/Demo/Portal/_output/templates/public/demo_portal_view.html \u4e2d\u521b\u5efa\u8fd9\u4e2a\u6a21\u677f\u3002 \u5f53\u524d\uff0c\u8fd9\u4e2a\u6a21\u677f\u5e94\u8be5\u7b80\u5358\u5730\u5305\u542b\u4ee5\u4e0b\u5185\u5bb9\u3002 <xf:title>Portal</xf:title> \u5982\u679c\u6211\u4eec\u73b0\u5728\u8bbf\u95ee portal \u9875\u9762\uff0c\u6a21\u677f\u9519\u8bef\u5c31\u4f1a\u6d88\u5931\uff0c\u867d\u7136\u6211\u4eec\u4ecd\u7136\u4f1a\u6709\u4e00\u4e2a\u770b\u8d77\u6765\u76f8\u5f53\u7a7a\u767d\u7684\u9875\u9762\uff0c\u4f46\u81f3\u5c11\u73b0\u5728\u4f1a\u6709 \"Portal\" \u6807\u9898\u3002 \u73b0\u5728\uff0c\u662f\u65f6\u5019\u5f00\u59cb\u6dfb\u52a0\u4ee3\u7801\u4e86\uff0c\u5b83\u5c06\u663e\u793a\u7cbe\u9009\u4e3b\u9898\u7684\u5217\u8868\u3002 \u7b2c\u4e00\u6b65\u662f\u4e3a\u6211\u4eec\u5e38\u89c1\u7684\u4e00\u4e9b\u57fa\u7840 Finder \u67e5\u627e\u521b\u5efa\u4e00\u4e2a repository\u3002 \u56e0\u6b64\uff0c\u5728\u8def\u5f84 src/addons/Demo/Portal/Repository/FeaturedThread.php \u4e2d\u521b\u5efa\u4e00\u4e2a\u65b0\u6587\u4ef6\uff0c\u5e76\u6dfb\u52a0\u4ee5\u4e0b\u4ee3\u7801\u3002 <?php namespace Demo\\Portal\\Repository; use XF\\Mvc\\Entity\\Finder; use XF\\Mvc\\Entity\\Repository; class FeaturedThread extends Repository { /** * @return Finder */ public function findFeaturedThreadsForPortalView() { $visitor = \\XF::visitor(); $finder = $this->finder('Demo\\Portal:FeaturedThread'); $finder ->setDefaultOrder('featured_date', 'DESC') ->with('Thread', true) ->with('Thread.User') ->with('Thread.Forum', true) ->with('Thread.Forum.Node.Permissions|' . $visitor->permission_combination_id) ->with('Thread.FirstPost', true) ->with('Thread.FirstPost.User') ->where('Thread.discussion_type', '<>', 'redirect') ->where('Thread.discussion_state', 'visible'); return $finder; } } \u6211\u4eec\u5728\u8fd9\u91cc\u505a\u7684\u662f\u4f7f\u7528 finder \u67e5\u627e\u6240\u6709\u7684\u7cbe\u9009\u4e3b\u9898\uff0c\u6309\u7167\u76f8\u53cd\u7684 featured_date \u987a\u5e8f\uff0cjoin \u5230 xf_thread \u8d44\u6599\u8868\uff0c\u5e76\u4ece\u8be5\u8d44\u6599\u8868 join \u5230\u4e3b\u9898\u521b\u5efa\u8005\u7684 xf_user \u8d44\u6599\u8868\u3001 xf_forum \u8d44\u6599\u8868\u3001 xf_post \u8d44\u6599\u8868\uff0c\u7136\u540e\u518d\u4ece\u90a3\u91cc join \u5230 xf_user \u8d44\u6599\u8868\uff0c\u91cd\u65b0\u521b\u5efa\u5e16\u5b50\u8d44\u6599\u8868\u3002 \u6211\u4eec\u901a\u8fc7\u6307\u5b9a\u53c2\u6570 true \u6765\u786e\u5b9a\u4e3b\u9898\u3001\u8bba\u575b\u548c\u7b2c\u4e00\u4e2a\u5e16\u5b50\u5fc5\u987b\u5b58\u5728\uff0c\u6240\u4ee5\u8fd9\u4e9b\u5c06\u4ee5 INNER JOIN \u7684\u65b9\u5f0f\u8fd0\u884c\uff0c\u800c\u7528\u6237\u67e5\u627e\u5c06\u4ee5 LEFT JOIN \u7684\u65b9\u5f0f\u8fd0\u884c\u3002 \u6709\u4e9b\u4e3b\u9898\u548c\u5e16\u5b50\u7684\u4f5c\u8005\u53ef\u80fd\u4e0d\u5b58\u5728\uff08\u4f8b\u5982\uff0c\u5982\u679c\u5b83\u4eec\u662f\u7531 RSS feed \u7cfb\u7edf\u81ea\u52a8\u53d1\u5e03\u7684\uff0c\u6216\u7531\u8bbf\u5ba2\u53d1\u5e03\u7684\uff09\u3002 \u6211\u4eec\u5728\u8fd9\u91cc\u8fd8\u6709\u4e00\u4e2a\u7279\u6b8a\u7684 join\uff0c\u53ef\u4ee5\u5728\u67e5\u627e\u7684\u540c\u65f6\u83b7\u53d6\u5f53\u524d\u8bbf\u95ee\u8005\u7684\u6743\u9650\u3002 \u8fd9\u5c06\u51cf\u5c11\u55a7\u67d3 portal \u9875\u9762\u6240\u9700\u7684\u67e5\u627e\u6b21\u6570\uff0c\u56e0\u4e3a\u6211\u4eec\u5c06\u505a\u4e00\u4e9b\u4e8b\u60c5\uff08\u4e4b\u540e\uff09\uff0c\u53ea\u5411\u6709\u6743\u9650\u67e5\u770b\u7684\u7528\u6237\u663e\u793a\u7cbe\u9009\u4e3b\u9898\u3002 \u8fd9\u5e76\u4e0d\u80fd\u8fd4\u56de\u8fd9\u4e2a\u67e5\u627e\u7684\u7ed3\u679c\u3002 \u8fd9\u5c06\u8fd4\u56de Finder \u7269\u4ef6\u672c\u8eab\u3002 \u8fd9\u6837\u5c31\u53ef\u4ee5\u5728\u5176\u4ed6\u9644\u52a0\u7ec4\u4ef6\u9700\u8981\u7ee7\u627f\u6211\u4eec\u7684\u4ee3\u7801\u65f6\uff0c\u6709\u4e00\u4e2a\u660e\u786e\u7684 extension point\uff0c\u540c\u65f6\u4e5f\u5141\u8bb8\u6211\u4eec\u5728\u83b7\u53d6\u6570\u636e\u4e4b\u524d\u505a\u8fdb\u4e00\u6b65\u7684\u4fee\u6539\uff08\u4f8b\u5982\u4e3a\u5206\u9875\u8bbe\u7f6e\u4e00\u4e2a limit/offset\uff0c\u6216\u8005\u8bbe\u7f6e\u4e0d\u540c\u7684\u6392\u5e8f\uff09\u3002 \u73b0\u5728\u8ba9\u6211\u4eec\u5728 Portal Controller \u7684 actionIndex() \u65b9\u6cd5\u4e2d\u4f7f\u7528\u5b83\u3002 \u5c06\u73b0\u6709\u7684\u8fd9\u4e00\u884c $viewParams = []; \u6539\u4e3a\u5982\u4e0b\uff1a /** @var \\Demo\\Portal\\Repository\\FeaturedThread $repo */ $repo = $this->repository('Demo\\Portal:FeaturedThread'); $finder = $repo->findFeaturedThreadsForPortalView(); $viewParams = [ 'featuredThreads' => $finder->fetch() ]; \u5728\u8fd9\u4e2a\u9636\u6bb5\uff0c\u6211\u4eec\u4e0d\u6253\u7b97\u62c5\u5fc3\u4fee\u6539\u6211\u4eec\u4ece repo \u4e2d\u68c0\u7d22\u5230\u7684\u57fa\u7840 finder\u3002 \u76f8\u53cd\uff0c\u6211\u4eec\u5f00\u59cb\u5b9e\u9645\u770b\u5230\u4e00\u4e9b\u7ed3\u679c\uff0c\u5e76\u66f4\u65b0 demo_portal_view \u6a21\u677f\u5982\u4e0b\uff08\u5728 <xf:title> \u6807\u7b7e\u4e4b\u540e\uff09\uff1a <xf:if is=\"$featuredThreads is not empty\"> <xf:foreach loop=\"$featuredThreads\" value=\"$featuredThread\"> <xf:macro name=\"thread_block\" arg-thread=\"{$featuredThread.Thread}\" arg-post=\"{$featuredThread.Thread.FirstPost}\" arg-featuredThread=\"{$featuredThread}\" /> </xf:foreach> <xf:else /> <div class=\"blockMessage\">\u5f53\u524d\u8fd8\u6ca1\u6709\u4efb\u4f55\u5e16\u5b50\u88ab\u7cbe\u9009\u3002</div> </xf:if> <xf:macro name=\"thread_block\" arg-thread=\"!\" arg-post=\"!\" arg-featuredThread=\"!\"> <xf:css src=\"message.less\" /> <div class=\"block\"> <div class=\"block-container\" data-xf-init=\"lightbox\"> <h4 class=\"block-header\"><a href=\"{{ link('threads', $thread) }}\">{$thread.title}</a></h4> <div class=\"block-body\"> <xf:macro name=\"message\" arg-post=\"{$post}\" arg-thread=\"{$thread}\" arg-featuredThread=\"{$featuredThread}\" /> </div> <div class=\"block-footer\"> <a href=\"{{ link('threads', $thread) }}\">\u7ee7\u7eed\u9605\u8bfb...</a> </div> </div> </div> </xf:macro> <xf:macro name=\"message\" arg-post=\"!\" arg-thread=\"!\" arg-featuredThread=\"!\"> <div class=\"message message--post message--simple\"> <div class=\"message-inner\"> <div class=\"message-cell message-cell--main\"> <div class=\"message-content js-messageContent\"> <div class=\"message-attribution\"> <div class=\"contentRow contentRow--alignMiddle\"> <div class=\"contentRow-figure\"> <xf:avatar user=\"{$post.User}\" size=\"xxs\" defaultname=\"{$post.username}\" href=\"\" /> </div> <div class=\"contentRow-main contentRow-main--close\"> <ul class=\"listInline listInline--bullet u-muted\"> <li><xf:username user=\"{$thread.User}\" /></li> <li><xf:date time=\"{$featuredThread.featured_date}\" /></li> <li><a href=\"{{ link('forums', $thread.Forum) }}\">{$thread.Forum.title}</a></li> <li>{{ phrase('replies:') }} {$thread.reply_count|number}</li> </ul> </div> </div> </div> <div class=\"message-userContent lbContainer js-lbContainer\" data-lb-id=\"post-{$post.post_id}\" data-lb-caption-desc=\"{{ $post.User ? $post.User.username : $post.username }} &middot; {{ date_time($post.post_date) }}\" > <blockquote class=\"message-body\"> {{ bb_code($post.message, 'post', $post.User, { 'attachments': $post.attach_count ? $post.Attachments : [], 'viewAttachments': $thread.canViewAttachments() }) }} </blockquote> </div> </div> </div> </div> </div> </xf:macro> \u73b0\u5728\uff0c\u6211\u627f\u8ba4\uff0c\u8fd9\u91cc\u6709 \u5f88\u591a \u7684\u5185\u5bb9\u3002 \u867d\u7136\u5b83\u53ef\u80fd\u770b\u8d77\u6765\u4ee4\u4eba\u751f\u754f\uff0c\u4f46\u5b83\u4e3b\u8981\u662f\u4ee5\u5408\u7406\u7684\u98ce\u683c\u6765\u663e\u793a\u6211\u4eec\u7684\u7cbe\u9009\u4e3b\u9898\u7684\u6807\u8bb0\u3002 \u4e0d\u8fc7\u6709\u51e0\u4ef6\u4e8b\u503c\u5f97\u6ce8\u610f\u3002 \u6211\u4eec\u7528\u4e00\u4e2a\u6761\u4ef6\u5f00\u59cb\u6a21\u677f\uff0c\u8fd9\u4e2a\u6761\u4ef6\u662f <xf:if is=\"$featuredThreads is not empty\"> \u3002 \u8fd9\u662f\u4e3a\u4e86\u68c0\u67e5 finder \u8fd4\u56de\u7684\u7269\u4ef6\u662f\u5426\u771f\u7684\u5305\u542b\u7cbe\u9009\u4e3b\u9898\u8bb0\u5f55\u3002 \u5982\u679c\u4e0d\u5305\u542b\uff0c\u6211\u4eec\u5c06\u663e\u793a\u4e00\u4e2a\u9002\u5f53\u7684\u6d88\u606f\u3002 \u5982\u679c\u786e\u5b9e\u6709\u4e00\u4e9b\u8bb0\u5f55\uff0c\u6211\u4eec\u9700\u8981\u5faa\u73af\u6d4f\u89c8\u6bcf\u4e00\u6761\u8bb0\u5f55\u6765\u663e\u793a\u5b83\u3002 \u5bf9\u4e8e\u6bcf\u6761\u8bb0\u5f55\uff0c\u6211\u4eec\u8c03\u7528\u4e00\u4e2a macro \u3002 \u5de8\u96c6\u662f\u6a21\u677f\u4ee3\u7801\u4e2d\u53ef\u91cd\u590d\u4f7f\u7528\u7684\u90e8\u5206\uff0c\u5b83\u662f\u81ea\u884c\u8bb0\u5f55\u7684\uff08\u4f60\u53ef\u4ee5\u770b\u5230\u54ea\u4e9b\u53c2\u6570\u662f\u652f\u63f4\u7684\uff09\uff0c\u5e76\u4fdd\u6301\u81ea\u5df1\u7684\u4f5c\u7528\u57df\uff0c\u4e0d\u80fd\u88ab\u8c03\u7528\u5de8\u96c6\u6a21\u677f\u4e2d\u7684\u53c2\u6570\u6240\u6c61\u67d3\uff1b\u8fd9\u610f\u5473\u7740\u5de8\u96c6\u53ea\u77e5\u9053\u660e\u786e\u4f20\u9012\u8fdb\u6765\u7684\u53c2\u6570\u548c\u5168\u57df\u7684 $xf \u53c2\u6570\u3002 \u4e3b\u9898\u533a\u5757\u5de8\u96c6\u663e\u793a\u7cbe\u9009\u4e3b\u9898\u7684\u57fa\u672c\u533a\u5757\uff0c\u7136\u540e\u8c03\u7528\u53e6\u4e00\u4e2a\u5de8\u96c6\u6765\u663e\u793a\u6bcf\u4e2a\u6d88\u606f\u3002 \u5b9e\u4f5c\u5bfc\u89c8\u6807\u7b7e \u00b6 \u4f60\u53ef\u80fd\u5df2\u7ecf\u53d1\u73b0\uff0c\u5728\u8bbe\u7f6e\u8def\u5f84\u65f6\uff0c\u6211\u4eec\u5c06 Section context \u6307\u5b9a\u4e3a \"\u4e3b\u9875\"\uff0c\u5f53\u4f60\u8bbf\u95ee portal \u9875\u9762\u65f6\uff0c\u4e3b\u9875\u6807\u7b7e\u88ab\u9009\u4e2d\uff0c\u6216\u8005\u5982\u679c\u5728\u9009\u9879\u4e2d\u6ca1\u6709\u8bbe\u7f6e homePageUrl \uff0c\u4f60\u53ef\u80fd\u6839\u672c\u4e0d\u4f1a\u770b\u5230\u4e3b\u9875\u6807\u7b7e\u3002 \u6211\u4eec\u5e0c\u671b\u4f7f\u7528\u9ed8\u8ba4\u7684\u4e3b\u9875\u6807\u7b7e\uff0c\u800c\u4e0d\u662f\u81ea\u5df1\u521b\u5efa\u4e00\u4e2a\u6807\u7b7e\uff0c\u8fd9\u6837\u53ef\u80fd\u4f1a\u6709\u4e00\u4e2a\u91cd\u590d\u7684\u6807\u7b7e\u3002 \u8981\u505a\u5230\u8fd9\u4e00\u70b9\uff0c\u6211\u4eec\u5e94\u8be5\u4f7f\u7528\u4ee3\u7801\u4e8b\u4ef6\u76d1\u542c\u5668\u5c06 URL \u6539\u4e3a\u6211\u4eec\u7684 portal URL\u3002 \u5728 Admin CP \u4e0b\u7684\u5f00\u53d1\u4e2d\u70b9\u51fb \"\u4ee3\u7801\u4e8b\u4ef6\u76d1\u542c\u5668\"\uff0c\u7136\u540e\u70b9\u51fb \"\u6dfb\u52a0\u4ee3\u7801\u4e8b\u4ef6\u76d1\u542c\u5668\"\u3002 \u76d1\u542c\u4e8b\u4ef6 home_page_url \uff0ccallback class \u53c8\u4f1a\u662f Demo\\Portal\\Listener \uff0c\u8fd9\u6b21\u7684\u65b9\u6cd5\u547d\u540d\u4e3a homePageUrl \u3002 \u8fd9\u4e2a\u65b0\u65b9\u6cd5\u7684\u4ee3\u7801\u5e94\u8be5\u76f8\u5f53\u7b80\u5358\uff1a public static function homePageUrl(&$homePageUrl, \\XF\\Mvc\\Router $router) { $homePageUrl = $router->buildLink('canonical:portal'); } \u6700\u540e\uff0c\u6211\u4eec\u5e94\u8be5\u8003\u8651\u66f4\u6539\u6211\u4eec portal \u9875\u9762\u7684\u9996\u9875\u8def\u5f84\u3002 \u8fdb\u5165 Admin CP\uff0c\u5728\u8bbe\u7f6e\u4e0b\u70b9\u51fb\u9009\u9879\uff0c\u7136\u540e\u70b9\u51fb \"\u57fa\u672c\u677f\u5757\u4fe1\u606f\"\u3002 \u5c06 \"\u9996\u9875\u8def\u5f84\" \u9009\u9879\u6539\u4e3a portal/ \u3002 \u5f53\u4f60\u5728 Admin CP \u4e2d\u65f6\uff0c\u6765\u770b\u770b\u5f53\u4f60\u70b9\u51fb Header \u7684\u677f\u5757\u6807\u9898\u65f6\uff0c\u4f1a\u53d1\u751f\u4ec0\u9ebd\u3002 \u8fd9\u5e94\u8be5\u4f1a\u5e2f\u4f60\u5230\u4f60\u7684\u9996\u9875\u3002 \u4e00\u5207\u6b63\u5e38\uff0c\u90a3\u4e2a\u9996\u9875\u73b0\u5728\u5e94\u8be5\u662f\u4f60\u7684 portal \u9875\u9762\u4e86\uff01 \u9664\u6b64\u4e4b\u5916\uff0c\u4e3b\u9875\u6807\u7b7e\u5e94\u8be5\u662f\u53ef\u89c1\u7684\uff0c\u5e76\u4e14\u88ab\u9009\u4e2d\u4e86\u3002 \u4f5c\u4e3a\u53ef\u9009\u6b65\u9aa4\uff0c\u4f60\u53ef\u4ee5\u9009\u62e9\u5728\u4e3b\u9875\u6807\u7b7e\u4e0b\u6dfb\u52a0\u4e00\u4e9b\u989d\u5916\u7684\u5bfc\u89c8\u6761\u76ee\u3002 \u4e0d\u8fc7\uff0c\u73b0\u5728\u8ba9\u6211\u4eec\u5148\u7ee7\u7eed\u5f80\u4e0b\u3002 \u624b\u52a8\u663e\u793a\uff08\u6216\u4e0d\u663e\u793a\uff09\u4e3b\u9898 \u00b6 \u6240\u4ee5\uff0c\u6211\u4eec\u53ef\u4ee5\u81ea\u52a8\u7cbe\u9009\u65b0\u4e3b\u9898\u3002 \u90a3\u9ebd\u624b\u52a8\u663e\u793a\u73b0\u6709\u7684\u4e3b\u9898\u5462\uff1f \u6216\u8005\u662f\u5728\u521b\u5efa\u8fc7\u7a0b\u4e2d\uff0c\u5728\u4e0d\u652f\u63f4\u81ea\u52a8\u7cbe\u9009\u7684\u60c5\u51b5\u4e0b\uff0c\u624b\u52a8\u7cbe\u9009\u4e3b\u9898\uff1f \u8fd9\u5c06\u662f\u4e00\u4e2a\u5f88\u597d\u7684\u65b9\u6cd5\uff0c\u8ba9\u6211\u4eec\u5f53\u524d\u7684 portal \u9875\u9762\u770b\u8d77\u6765\u66f4\u5fd9\u788c\u3002 \u4e3a\u4e86\u8fbe\u5230\u8fd9\u4e2a\u76ee\u7684\uff0c\u6211\u4eec\u5c06\u5728\u4e00\u4e2a\u7279\u5b9a\u7684\u5de8\u96c6\u4e2d\u6dfb\u52a0\u4e00\u4e2a\u6a21\u677f\u4fee\u6539\uff0c\u8fd9\u4e2a\u5de8\u96c6\u5b9e\u9645\u4e0a\u662f\u5728\u4e3b\u9898\u56de\u8986\u3001\u4e3b\u9898\u7f16\u8f91\u548c\u521b\u5efa\u4e3b\u9898\u65f6\u4f7f\u7528\u7684\u3002 \u8fd9\u5c06\u7275\u6d89\u5230\u7ee7\u627f\u7f16\u8f91\u5668\u670d\u52a1\uff0c\u5e76\u5bf9\u5904\u7406\u81ea\u52a8\u7cbe\u9009\u7684\u73b0\u6709\u4ee3\u7801\u8fdb\u884c\u4fee\u6539\u3002 \u7b2c\u4e00\u6b65\u5c31\u662f\u65b0\u5efa\u6a21\u677f\u4fee\u6539\u3002 \u8fdb\u5230 \"\u6dfb\u52a0\u6a21\u677f\u4fee\u6539\"\uff08\u786e\u4fdd\u5728 \"\u6a21\u677f\u4fee\u6539\" \u5217\u8868\u4e2d\u9009\u62e9 \"Public\" \u6807\u7b7e\uff09\u3002 \u8fd9\u6b21\u6211\u4eec\u8981\u4fee\u6539\u7684\u6a21\u677f\u662f helper_thread_options \uff0c\u6211\u4eec\u7528 demo_portal_helper_thread_options \u4f5c\u4e3a key\uff0c\u4f60\u53ef\u4ee5\u5199\u4e00\u4e2a\u5408\u7406\u7684\u63cf\u8ff0\u3002 \u5b9e\u9645\u4e0a\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u8fd9\u91cc\u505a\u4e00\u4e2a \"\u7b80\u5358\u66ff\u6362\"\uff0c\u6240\u4ee5\u8bf7\u9009\u4e2d\u8fd9\u4e2a\u5358\u9009\u6309\u94ae\uff0c\u5e76\u5728 \"\u67e5\u627e\" \u5b57\u6bb5\u4e2d\u586b\u4e0a\uff1a <xf:if is=\"$thread.canLockUnlock()\"> \u5728 \"\u66ff\u6362\" \u5b57\u6bb5\u4e2d\u586b\u4e0a\uff1a <xf:if is=\"($thread.isInsert() AND !$thread.Forum.demo_portal_auto_feature AND $thread.canFeatureUnfeature()) OR ($thread.isUpdate() && $thread.canFeatureUnfeature())\" > <xf:option label=\"{{ phrase('demo_portal_featured') }}\" name=\"featured\" value=\"1\" selected=\"{$thread.demo_portal_featured}\"> <xf:hint>{{ phrase('demo_portal_featured_hint') }}</xf:hint> <xf:afterhtml> <xf:hiddenval name=\"_xfSet[featured]\" value=\"1\" /> </xf:afterhtml> </xf:option> </xf:if> $0 \u8fd9\u4e2a\u6761\u4ef6\u5224\u65ad\u6709\u70b9\u504f\u957f\u4e86\uff0c\u4f46\u5b83\u5141\u8bb8\u6211\u4eec\u5728\u4e24\u4e2a\u7279\u5b9a\u7684\u6761\u4ef6\u4e0b\u663e\u793a\u7cbe\u9009 checkbox\uff1a a)\u5982\u679c\u5e16\u5b50\u8fd8\u6ca1\u6709\u521b\u5efa\uff0c\u5e76\u4e14\u8bba\u575b\u7684\u81ea\u52a8\u7cbe\u9009\u9009\u9879\u88ab\u5173\u95ed\uff0c\u5e76\u4e14\u6709\u7cbe\u9009\u7684\u6743\u9650\uff0c\u6216\u8005 b)\u5b83\u662f\u4e00\u4e2a\u5df2\u7ecf\u5b58\u5728\u7684\u5e16\u5b50\uff0c\u5e76\u4e14\u6709 \u7cbe\u9009/\u975e\u7cbe\u9009 \u7684\u6743\u9650\u3002 \u4e00\u4e2a\u5feb\u901f\u7684 \"\u6d4b\u8bd5\" \u5e94\u8be5\u4f1a\u663e\u793a\u8fd9\u4e2a\u9644\u52a0\u7684\u4ee3\u7801\u5c06\u88ab\u63d2\u5165\u5230\u73b0\u6709\u7684 <xf:checkboxrow> \u4e2d \"\u6253\u5f00\" checkbox \u4e0a\u65b9\u3002 \u5982\u679c\u8fd9\u4e00\u5207\u770b\u8d77\u6765\u90fd\u6b63\u5e38\uff0c\u5c31\u70b9\u51fb \"\u4fdd\u5b58\"\u3002 \u6211\u4eec\u4e0d\u5f97\u4e0d\u5728\u8fd9\u91cc\u76f4\u63a5\u5728\u4fee\u6539\u4e2d\u4f7f\u7528\u6a21\u677f\u4ee3\u7801\uff0c\u56e0\u4e3a\u5728\u5df2\u7ecf\u5b58\u5728\u7684 input \u6216 row \u6807\u7b7e\u4e2d\u52a0\u5165\u4e00\u4e2a\u6a21\u677f\uff08\u8c61\u6211\u4eec\u4e4b\u524d\u505a\u7684\u90a3\u6837\uff09\u8fd9\u6837\u662f\u4f1a\u65e0\u6cd5\u8fd0\u4f5c\u7684\u3002 \u6211\u4eec\u73b0\u5728\u8fd8\u9700\u8981\u4e3a\u6807\u7b7e\u548c\u63d0\u793a\u521b\u5efa\u77ed\u8bed\uff0c\u56e0\u4e3a\u4ee5\u540e\u5c06\u65e0\u6cd5\u68c0\u6d4b\u5230\u8fd9\u4e9b\u4e86\u3002 \u5728 \"\u5916\u89b3\" \u4e0b\u8fdb\u5165 \"\u77ed\u8bed\" \u5e76\u70b9\u51fb \"\u6dfb\u52a0\u77ed\u8bed\"\u3002 \u786e\u4fdd\u4f60\u7684\u9644\u52a0\u7ec4\u4ef6\u88ab\u9009\u4e2d\u3002 \u7b2c\u4e00\u4e2a\u77ed\u8bed\u7684 \"Title\" \u5c06\u662f \"demo_portal_featured\"\uff0c\u6587\u672c\u5c06\u662f\u7b80\u5358\u7684 \"\u7cbe\u9009\"\u3002 \u70b9\u51fb \"\u4fdd\u5b58\u5e76\u9000\u51fa\"\u3002 \u518d\u6b21\u70b9\u51fb \"\u6dfb\u52a0\u77ed\u8bed\"\u3002 \u7b2c\u4e8c\u4e2a\u77ed\u8bed\u7684 \"\u6807\u9898\" \u4f1a\u662f \"demo_portal_featured_hint\"\uff0c\u6587\u672c\u4f1a\u662f \"\u7cbe\u9009\u4e3b\u9898\u5c06\u51fa\u73b0\u5728 Portal \u9875\u9762\"\u3002 \u56de\u5230\u6211\u4eec\u521a\u521a\u6dfb\u52a0\u4fee\u6539\u7684\u6a21\u677f\u4ee3\u7801\uff0c\u4f60\u53ef\u80fd\u5df2\u7ecf\u6ce8\u610f\u5230\u4e86\u4e00\u4e9b\u4e8b\u60c5\u3002 \u6211\u4eec\u5728\u4e3b\u9898 Entity \u4e0a\u8c03\u7528\u4e86\u4e00\u4e2a\u65b9\u6cd5\uff0c canFeatureUnfeature() \uff0c\u800c\u8fd9\u4e2a\u65b9\u6cd5\u8fd8\u4e0d\u5b58\u5728\u3002 \u6211\u4eec\u6700\u7ec8\u8981\u7528\u8fd9\u4e2a\u6765\u505a\u4e00\u4e2a\u6743\u9650\u68c0\u67e5\uff0c\u63a7\u5236\u7528\u6237\u662f\u5426\u53ef\u4ee5\u624b\u52a8\u5bf9\u4e00\u4e2a\u4e3b\u9898\u8fdb\u884c\u7cbe\u9009\u64cd\u4f5c\u3002 \u4e3a\u4e86\u6dfb\u52a0\u8fd9\u4e2a\u65b9\u6cd5\uff0c\u6211\u4eec\u9700\u8981\u4e3a XF\\Entity\\Thread Entity \u65b0\u5efa\u4e00\u4e2a Class extension\u3002 \u6240\u4ee5\uff0c\u73b0\u5728\u5c31\u8c61\u6211\u4eec\u4e4b\u524d\u505a\u7684\u90a3\u6837\u505a\u3002 \u7ee7\u627f class \u5c06\u662f Demo\\Portal\\XF\\Entity\\Thread \uff0c\u6240\u4ee5\u5728\u8def\u5f84 src/addons/Demo/Portal/XF/Entity/Thread.php \u4e2d\u521b\u5efa\u8fd9\u4e2a class\uff0c\u5185\u5bb9\u5982\u4e0b\uff1a <?php namespace Demo\\Portal\\XF\\Entity; class Thread extends XFCP_Thread { public function canFeatureUnfeature() { return true; } } \u597d\u5427\uff0c\u6240\u4ee5\uff0c\u6211\u4eec\u5e76\u6ca1\u6709\u5728\u8fd9\u91cc\u505a\u592a\u591a\u6709\u4ef7\u503c\u7684\u4e8b\u60c5\u3002 canFeatureUnfeature() \u65b9\u6cd5\u73b0\u5728\u6240\u505a\u7684\u5c31\u662f\u8fd4\u56de true \u3002 \u4ee5\u540e\uff0c\u6211\u4eec\u4f1a\u5b9e\u4f5c\u4e00\u4e9b\u9002\u5f53\u7684\u6743\u9650\uff0c\u5e76\u5728\u8fd9\u91cc\u6dfb\u52a0\u3002 \u6d4b\u8bd5\u4e00\u4e0b\u5f53\u524d\u7684\u6548\u679c\uff0c\u6253\u5f00\u4f60\u4e4b\u524d\u7cbe\u9009\u7684\u4e00\u4e2a\u4e3b\u9898\uff0c\u5728\u5de5\u5177\u9009\u5358\u4e2d\u9009\u62e9 \"\u7f16\u8f91\u4e3b\u9898\"\u3002 \u6211\u4eec\u5e94\u8be5\u770b\u5230 \"\u8bbe\u7f6e\u4e3b\u9898\u72b6\u6001\" checkbox row \u6709\u6211\u4eec\u6dfb\u52a0\u7684 \"\u7cbe\u9009\" checkbox\uff0c\u800c\u4e14\u5e94\u8be5\u662f\u52fe\u9009\u7684\uff0c\u8bf4\u660e\u8fd9\u4e2a\u4e3b\u9898\u786e\u5b9e\u662f\u5177\u6709\u7cbe\u9009\u7684\u3002 \u6211\u4eec\u73b0\u5728\u53ef\u4ee5\u7ee7\u7eed\u6539\u53d8\u4e3b\u9898\u7f16\u8f91\u5668\u670d\u52a1\u6765\u5bfb\u627e\u8fd9\u4e2a\u503c\uff0c\u5e76\u76f8\u5e94\u5730\u8fdb\u884c\u7cbe\u9009\u6216\u53d6\u6d88\u7cbe\u9009\u3002 \u4e3a\u6b64\u6211\u4eec\u9700\u8981\u4e24\u4e2a\u65b0\u7684 Class extensions\u3002 \u56de\u5230 \"Class extensions\" \u9875\u9762\u3002 \u7b2c\u4e00\u4e2a\u5c06\u6709\u4e00\u4e2a\u57fa\u7c7b XF\\Pub\\Controller\\Thread \u548c\u7ee7\u627f\u7c7b Demo\\Portal\\XF\\Pub\\Controller\\Thread \u3002 \u7b2c\u4e8c\u4e2a\u5c06\u6709\u4e00\u4e2a XF\\Service\\Thread\\Editor \u7684\u57fa\u7c7b\u548c\u4e00\u4e2a Demo\\Portal\\XF\\Service\\Thread\\Editor \u7684\u7ee7\u627f\u7c7b\u3002 \u7f16\u8f91\u5668\u670d\u52a1\u5176\u5b9e\u8981\u548c\u6211\u4eec\u4e4b\u524d\u521b\u5efa\u7684\u7ee7\u627f creator \u670d\u52a1\u975e\u5e38\u76f8\u4f3c\uff0c\u6240\u4ee5\u5728\u76f8\u5173\u4f4d\u7f6e\u521b\u5efa\u3002 \u4e0b\u9762\u662f\u7ee7\u627f\u7c7b\u7684\u6240\u6709\u4ee3\u7801\uff1a <?php namespace Demo\\Portal\\XF\\Service\\Thread; class Editor extends XFCP_Editor { protected $featureThread; public function setFeatureThread($featureThread) { $this->featureThread = $featureThread; } protected function _save() { $thread = parent::_save(); if ($this->featureThread !== null && $thread->discussion_state == 'visible') { /** @var \\Demo\\Portal\\Entity\\FeaturedThread $featuredThread */ $featuredThread = $thread->getRelationOrDefault('FeaturedThread', false); if ($this->featureThread) { if (!$featuredThread->exists()) { $featuredThread->save(); $thread->fastUpdate('demo_portal_featured', true); } } else { if ($featuredThread->exists()) { $featuredThread->delete(); $thread->fastUpdate('demo_portal_featured', false); } } } return $thread; } } \u8fd9\u6bd4 creator \u670d\u52a1\u4e2d\u7684\u4ee3\u7801\u8981\u590d\u6742\u4e00\u4e9b\u3002 \u4f8b\u5982\uff0c\u6709\u53ef\u80fd\u4f1a\u51fa\u73b0\u8fd9\u6837\u7684\u60c5\u51b5\uff0c\u4e00\u4e2a\u4e3b\u9898\u88ab\u7f16\u8f91\u4e86\uff0c\u800c\u7528\u6237\u6ca1\u6709\u7f16\u8f91\u8be5\u4e3b\u9898\u7684\u6743\u9650\uff0c\u56e0\u6b64\u6211\u4eec\u4e0d\u663e\u793a checkbox\u3002 \u5728\u8fd9\u4e9b\u60c5\u51b5\u4e0b\uff0c\u6211\u4eec\u4e0d\u5e0c\u671b\u81ea\u52a8\u8ba4\u4e3a\u8be5\u4e3b\u9898\u5e94\u8be5\u662f\u65e0\u7cbe\u9009\u7684\u3002 \u7531\u4e8e\u7c7b $featureThread \u5c5e\u6027\u7684\u9ed8\u8ba4\u503c\u662f null \uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u8fd9\u4e2a\u5c5e\u6027\uff0c\u8fd9\u6837\u672c\u8d28\u4e0a\u8be5\u5c5e\u6027\u6709\u4e09\u79cd\u72b6\u6001\u3002 \u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c null \u8868\u793a \"\u6ca1\u6709\u53d8\u5316\"\uff0c true \u8868\u793a\u6211\u4eec\u5bf9\u8be5\u4e3b\u9898\u8fdb\u884c\u4e86\u7cbe\u9009\u8bbe\u7f6e\uff0c false \u8868\u793a\u6211\u4eec\u53d6\u6d88\u4e86\u5b83\u7684\u7cbe\u9009\u3002 \u5728\u975e\u7cbe\u9009\u5316\u7684\u60c5\u51b5\u4e0b\uff0c\u6211\u4eec\u5b9e\u9645\u4e0a\u53ea\u662f\u901a\u8fc7\u8c03\u7528 delete() \u65b9\u6cd5\u6765\u5220\u9664\u7cbe\u9009\u4e3b\u9898 Entity\u3002 \u5728\u8fd9\u4e24\u79cd\u60c5\u51b5\u4e0b\uff0c\u6211\u4eec\u518d\u6b21\u4f7f\u7528 fastUpdate() \u65b9\u6cd5\u66f4\u65b0\u4e3b\u9898 Entity \u4e2d\u7684\u7f13\u5b58\u503c\uff0c\u4ee5\u8868\u793a\u5f53\u524d\u7684\u7cbe\u9009\u72b6\u6001\u3002 \u5728\u5b8c\u6210\u7f16\u8f91\u8fc7\u7a0b\u4e4b\u524d\uff0c\u6211\u4eec\u9700\u8981\u4e3a\u6211\u4eec\u7684\u7ee7\u627f\u4e3b\u9898 Controller \u6dfb\u52a0\u4ee3\u7801\uff0c\u7279\u522b\u662f\u7ee7\u627f setupThreadEdit() \u65b9\u6cd5\u3002 \u6574\u4e2a\u7ee7\u627f\u4e3b\u9898 Controller \u7684\u4ee3\u7801\u770b\u8d77\u6765\u5c06\u4f1a\u662f\u8fd9\u6837\uff1a <?php namespace Demo\\Portal\\XF\\Pub\\Controller; class Thread extends XFCP_Thread { public function setupThreadEdit(\\XF\\Entity\\Thread $thread) { /** @var \\Demo\\Portal\\XF\\Service\\Thread\\Editor $editor */ $editor = parent::setupThreadEdit($thread); $canFeatureUnfeature = $thread->canFeatureUnfeature(); if ($canFeatureUnfeature) { $editor->setFeatureThread($this->filter('featured', 'bool')); } return $editor; } } \u8fd9\u5e94\u8be5\u8db3\u4ee5\u8ba9\u60a8\u7f16\u8f91\u4e00\u4e2a\u4e3b\u9898\uff0c\u5e76\u5c06\u5176\u72b6\u6001\u8bbe\u7f6e\u4e3a\u7cbe\u9009\uff08\u6216\u975e\u7cbe\u9009\uff09\u3002 \u5982\u679c\u60a8\u73b0\u5728\u5c1d\u8bd5\u4e00\u4e0b\uff0c\u60a8\u5e94\u8be5\u53ef\u4ee5\u770b\u5230\u4e3b\u9898\u76f8\u5e94\u5730\u4ece\u60a8\u7684 portal \u9875\u9762\u51fa\u73b0\u548c\u6d88\u5931\u3002 \u6211\u4eec\u9700\u8981\u5728\u4e3b\u9898 Controller \u4e2d\u7ee7\u627f\u53e6\u4e00\u4e2a\u65b9\u6cd5\uff0c\u4ee5\u5904\u7406\u4e3b\u9898\u72b6\u6001\u63a7\u5236\u4e5f\u663e\u793a\u5728\u4e00\u4e9b\u4e3b\u9898\u56de\u8986\u8868\u5355\u4e0a\u7684\u60c5\u51b5\u3002 \u6211\u4eec\u53ea\u9700\u8981\u5728\u4e0a\u9762\u6dfb\u52a0\u7684 setupThreadEdit() \u65b9\u6cd5\u4e0b\u9762\u6dfb\u52a0\u4ee5\u4e0b\u4ee3\u7801\u5373\u53ef\uff1a public function finalizeThreadReply(\\XF\\Service\\Thread\\Replier $replier) { parent::finalizeThreadReply($replier); $setOptions = $this->filter('_xfSet', 'array-bool'); if ($setOptions) { $thread = $replier->getThread(); if ($thread->canFeatureUnfeature() && isset($setOptions['featured'])) { $replier->setFeatureThread($this->filter('featured', 'bool')); } } } \u8bf7\u6ce8\u610f\uff0c\u6211\u4eec\u5728\u8fd9\u4e2a\u65b9\u6cd5\u4e2d\u5e76\u6ca1\u6709\u5b9e\u9645\u8fd4\u56de\u4efb\u4f55\u4e1c\u897f\uff0c\u56e0\u4e3a\u5e76\u4e0d\u671f\u671b\u5b83\u8fd4\u56de\u4efb\u4f55\u4e1c\u897f\u3002 \u6700\u540e\u4e00\u6b65\uff0c\u6211\u4eec\u9700\u8981\u56de\u5230\u8bba\u575b Controller\uff0c\u7a0d\u5fae\u4fee\u6539\u4e00\u4e0b\u6211\u4eec\u73b0\u6709\u7684\u4ee3\u7801\uff0c\u8fd9\u6837\uff0c\u5982\u679c\u7cbe\u9009\u4e0d\u662f\u81ea\u52a8\u7684\uff0c\u6211\u4eec\u53ef\u4ee5\u624b\u52a8\u5904\u7406\u3002 \u8fd9\u5e94\u8be5\u662f\u76f8\u5f53\u76f4\u63a5\u7684\u3002 \u8fdb\u5165\u60a8\u7684\u7ee7\u627f\u8bba\u575b Controller\uff0c\u7136\u540e\u5c06\u66ff\u6362\u8fd9\u4e2a\uff1a if ($forum->demo_portal_auto_feature) { $creator->setFeatureThread(true); } \u6539\u6210\u4e0b\u9762\u8fd9\u6837\uff1a if ($forum->demo_portal_auto_feature) { $creator->setFeatureThread(true); } else { $setOptions = $this->filter('_xfSet', 'array-bool'); if ($setOptions) { $thread = $creator->getThread(); if ($thread->canFeatureUnfeature() && isset($setOptions['featured'])) { $creator->setFeatureThread($this->filter('featured', 'bool')); } } } \u8fd9\u548c\u6211\u4eec\u5df2\u7ecf\u62e5\u6709\u7684\u57fa\u672c\u76f8\u540c\uff0c\u4f8b\u5982\uff0c\u5982\u679c\u8bba\u575b\u5f00\u542f\u4e86\u81ea\u52a8\u7cbe\u9009\uff0c\u90a3\u9ebd\u6211\u4eec\u53ea\u9700\u5c06\u8be5\u4e3b\u9898\u8bbe\u7f6e\u4e3a\u7cbe\u9009\uff0c\u5426\u5219\uff0c\u6211\u4eec\u68c0\u67e5\u662f\u5426\u6709 checkbox\uff0c\u5c31\u8c61\u6211\u4eec\u5bf9\u5176\u4ed6\u60c5\u51b5\u6240\u505a\u7684\u90a3\u6837\uff0c\u5c06\u5176\u8bbe\u7f6e\u4e3a checkbox \u72b6\u6001\u3002 \u6211\u4eec\u73b0\u5728\u5e94\u8be5\u6d4b\u8bd5\u521b\u5efa 3 \u4e2a\u4e3b\u9898\uff0c\u4ee5\u786e\u4fdd\u5176\u8fd0\u4f5c\u6b63\u5e38\u3002 \u7b2c\u4e00\u4e2a\u662f\u5728\u5f00\u542f\u4e86\u81ea\u52a8\u7cbe\u9009\u7684\u8bba\u575b\u4e2d\uff0c\u786e\u4fdd\u5b83\u4ecd\u7136\u6709\u6548\uff0c\u7136\u540e\u662f\u5728\u6ca1\u6709\u5f00\u542f\u81ea\u52a8\u7cbe\u9009\u7684\u8bba\u575b\u4e2d\uff0c\u52fe\u9009 \"\u7cbe\u9009\" checkbox\uff0c\u518d\u52fe\u9009\u5b83\u3002 \u5047\u8bbe\u4e00\u5207\u6b63\u5e38\uff0c\u8ba9\u6211\u4eec\u7ee7\u7eed\u524d\u8fdb\u3002 \u6539\u8fdb\u95e8\u6237\u7f51\u7ad9\u9875\u9762 \u00b6 \u867d\u7136\uff0cportal \u9875\u9762\u770b\u8d77\u6765\u5f88\u5408\u7406\uff0c\u4f46\u6211\u4eec\u53ef\u4ee5\u505a\u5f97\u66f4\u597d\u4e00\u4e9b\u3002 \u9996\u5148\uff0c\u6211\u4eec\u5e94\u8be5\u8c03\u6574\u6211\u4eec\u7684\u4ee3\u7801\uff0c\u4f7f\u6211\u4eec\u53ea\u663e\u793a X \u4e2a\u7279\u8272\u4e3b\u9898\uff0c\u6211\u4eec\u8fd8\u5e94\u8be5\u6dfb\u52a0\u4e00\u4e9b\u9875\u9762\u5bfc\u89c8\u3002 \u5728\u8fd9\u4e00\u70b9\u4e0a\uff0c\u5982\u679c\u4f60\u8fd8\u6ca1\u6709\u7684\u8bdd\uff0c\u53ef\u80fd\u503c\u5f97\u518d\u591a\u7cbe\u9009\u4e00\u4e9b\u4e3b\u9898\uff0c\u8fd9\u6837\u6211\u4eec\u5c31\u53ef\u4ee5\u5b9e\u9645\u6d4b\u8bd5\u5206\u9875\u4e86\uff01 \u9996\u5148\uff0c\u6211\u4eec\u9700\u8981\u56de\u5230\u6211\u4eec\u7684 portal Controller\uff0c\u5e76\u5728 actionIndex() \u65b9\u6cd5\u7684\u9876\u90e8\u6dfb\u52a0\u4e00\u4e9b\u4ee3\u7801\uff1a $page = $this->filterPage(); $perPage = 5; \u8fd9\u91cc\u7684\u7b2c\u4e00\u884c\u662f\u4e00\u4e2a\u7279\u5b9a\u7684 helper \u65b9\u6cd5\uff0c\u7528\u6765\u83b7\u53d6\u5f53\u524d\u7684\u9875\u7801\u3002 \u7b2c\u4e8c\u884c\u662f\u6211\u4eec\u6bcf\u9875\u8981\u52a0\u8f7d\u591a\u5c11\u4e2a\u9879\u76ee\uff0c\u8fd9\u901a\u5e38\u6765\u81ea\u4e00\u4e2a\u9009\u9879\uff0c\u4f46\u6211\u4eec\u73b0\u5728\u5c06\u786c\u5199\u6b7b\u4e3a 5\u3002 \u63a5\u4e0b\u6765\u8981\u505a\u7684\u5c31\u662f\u628a\u8fd9\u4e00\u884c\uff1a $finder = $repo->findFeaturedThreadsForPortalView(); \u4fee\u6539\u6210\u8fd9\u6837\uff1a $finder = $repo->findFeaturedThreadsForPortalView() ->limitByPage($page, $perPage); \u8fd9\u5c31\u6539\u53d8\u4e86\u6211\u4eec\u7684\u67e5\u627e\uff0c\u4f7f\u5b83\u80fd\u6839\u636e\u6211\u4eec\u4e0a\u9762\u5b9a\u4e49\u7684 \u9875/\u6bcf\u9875 \u503c\u8fdb\u884c limit\u3002 \u8fd9\u5c06\u81ea\u52a8\u8ba1\u7b97\u51fa\u5f53\u524d\u9875\u9762\u7684\u6b63\u786e limit ( $perPage ) \u548c offset ( ($page - 1) * $perPage )\u3002 \u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u9700\u8981\u518d\u4f20\u9012\u4e00\u4e9b\u53c2\u6570\u5230\u6211\u4eec\u7684 view \u53c2\u6570\u4e2d\uff0c\u6240\u4ee5\u5c06\u4e0b\u9762\uff1a $viewParams = [ 'featuredThreads' => $finder->fetch() ]; \u6539\u53d8\u6210\uff1a $viewParams = [ 'featuredThreads' => $finder->fetch(), 'total' => $finder->total(), 'page' => $page, 'perPage' => $perPage ]; \u8981\u4f7f\u7528\u663e\u793a\u6211\u4eec\u7684\u9875\u9762\u5bfc\u89c8\uff0c\u6211\u4eec\u9700\u8981\u77e5\u9053\u6761\u76ee\u7684\u603b\u6570\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7 total() \u65b9\u6cd5\u4ece finder \u4e2d\u5f97\u5230\uff0c\u5f53\u524d\u7684\u9875\u7801\u548c\u6211\u4eec\u6bcf\u9875\u663e\u793a\u7684\u6570\u91cf\u3002 \u5982\u679c\u4f60\u56de\u5230 portal\uff0c\u73b0\u5728\u4f60\u4f1a\u770b\u5230\u53ea\u6709 5 \u4e2a\u7cbe\u9009\u4e3b\u9898\u663e\u793a\u3002 \u4e0d\u8fc7\uff0c\u6211\u4eec\u73b0\u5728\u9700\u8981\u6dfb\u52a0\u9875\u9762\u5bfc\u89c8\u3002 \u6240\u4ee5\u6253\u5f00 demo_portal_view \u6a21\u677f\uff0c\u5728 </xf:foreach> \u6807\u7b7e\u540e\u76f4\u63a5\u6dfb\u52a0\u4ee5\u4e0b\u5185\u5bb9\uff1a <xf:pagenav page=\"{$page}\" perpage=\"{$perPage}\" total=\"{$total}\" link=\"portal\" wrapperclass=\"block\" /> \u6b64\u65f6\u91cd\u65b0\u52a0\u8f7d portal \u9875\u9762\uff0c\u53ea\u8981\u4f60\u6709 5 \u4e2a\u4ee5\u4e0a\u7684\u7cbe\u9009\u4e3b\u9898\uff0c\u73b0\u5728\u5c31\u4f1a\u5728\u7cbe\u9009\u4e3b\u9898\u5217\u8868\u7684\u5e95\u90e8\u770b\u5230\u9875\u9762\u5bfc\u89c8\u3002 \u5176\u4ed6\u4e00\u4e9b\u53ef\u80fd\u6709\u52a9\u4e8e\u6539\u5584\u8fd9\u4e2a\u9875\u9762\u7684\u5916\u89b3\u7684\u4e1c\u897f\u662f\u6dfb\u52a0\u4e00\u4e2a\u4fa7\u8fb9\u680f\uff0c\u6216\u8005\u66f4\u51c6\u786e\u5730\u8bf4\uff0c\u4e00\u4e2a\u663e\u793a\u5728\u4fa7\u8fb9\u680f\u7684\u5c0f\u7ec4\u4ef6\u4f4d\u7f6e\u3002 \u5c0f\u7ec4\u4ef6\u4f4d\u7f6e\u662f\u5728 Admin CP\u7684 \"\u5f00\u53d1\" \u4e0b\u6dfb\u52a0\u7684\u3002 \u8fdb\u5165 \"\u5c0f\u7ec4\u4ef6\u4f4d\u7f6e\" \u9875\u9762\uff0c\u70b9\u51fb \"\u6dfb\u52a0\u5c0f\u7ec4\u4ef6\u4f4d\u7f6e\"\u3002 \u8f93\u5165 \"\u4f4d\u7f6e ID\" \u4e3a demo_portal_view_sidebar \uff0c\"Title\" \u4e3a Demo portal view: Sidebar \u548c\u4e00\u4e2a\u9002\u5f53\u7684\u63cf\u8ff0\u3002 \u786e\u4fdd\u4f4d\u7f6e\u5df2\u5f00\u542f\uff0c\u5e76\u9009\u62e9\u4e86\u6b63\u786e\u7684\u9644\u52a0\u7ec4\u4ef6 ID \u540e\uff0c\u70b9\u51fb \"\u4fdd\u5b58\"\u3002 \u8981\u5c06\u8fd9\u4e2a\u4f4d\u7f6e\u6dfb\u52a0\u5230\u6a21\u677f\u4e2d\uff0c\u53ea\u9700\u5728 <xf:title> \u6807\u7b7e\u4e0b\u9762\u6dfb\u52a0\u4ee5\u4e0b\u5185\u5bb9\uff1a <xf:widgetpos id=\"demo_portal_view_sidebar\" position=\"sidebar\" /> \u5f53\u7136\uff0c\u5728\u6ca1\u6709\u6dfb\u52a0\u4e00\u4e9b\u5c0f\u7ec4\u4ef6\u4e4b\u524d\uff0c\u6211\u4eec\u8fd8\u662f\u4e0d\u4f1a\u770b\u5230\u4fa7\u8fb9\u680f\u3002 \u5c0f\u7ec4\u4ef6\u672c\u8eab\u662f\u4e0d\u6307\u6d3e\u7ed9\u9644\u52a0\u7ec4\u4ef6\u7684\uff0c\u6240\u4ee5\u4f60\u4e3a\u8fd9\u4e2a\u4f4d\u7f6e\u521b\u5efa\u7684\u5c0f\u7ec4\u4ef6\uff0c\u5982\u679c\u4f60\u60f3\u5728\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u53d1\u9001\u4e00\u4e9b\u914d\u7f6e\u597d\u7684\u5c0f\u7ec4\u4ef6\uff0c\u5c06\u9700\u8981\u6dfb\u52a0\u5230 Setup class \u4e2d\u3002 \u4e3a\u4e86\u7b80\u5358\u8d77\u89c1\uff0c\u6211\u4eec\u53ea\u9700\u8981\u590d\u5236\u5f53\u524d\u6307\u6d3e\u7ed9 forum_list_sidebar \u4f4d\u7f6e\u7684\u5c0f\u7ec4\u4ef6\uff08\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff09\u3002 \u6240\u4ee5\uff0c\u6211\u4eec\u5c06\u628a\u8fd9\u4e9b\u6dfb\u52a0\u5230 Setup class \u4e2d\u7684\u4e00\u4e2a\u65b0\u7684 installStep4() \u65b9\u6cd5\u4e2d\uff1a public function installStep4() { $this->createWidget('demo_portal_view_members_online', 'members_online', [ 'positions' => ['demo_portal_view_sidebar' => 10] ]); $this->createWidget('demo_portal_view_new_posts', 'new_posts', [ 'positions' => ['demo_portal_view_sidebar' => 20] ]); $this->createWidget('demo_portal_view_new_profile_posts', 'new_profile_posts', [ 'positions' => ['demo_portal_view_sidebar' => 30] ]); $this->createWidget('demo_portal_view_forum_statistics', 'forum_statistics', [ 'positions' => ['demo_portal_view_sidebar' => 40] ]); $this->createWidget('demo_portal_view_share_page', 'share_page', [ 'positions' => ['demo_portal_view_sidebar' => 50] ]); } \u5f53\u7136\uff0c\u522b\u5fd8\u4e86\u81ea\u5df1\u8fd0\u884c\u8fd9\u4e2a\u8bbe\u7f6e\u6b65\u9aa4\uff1a Terminal $ php cmd.php xf-addon:install-step Demo/Portal 4 \u5b9e\u73b0\u6743\u9650\u548c\u4f18\u5316 \u00b6 \u73b0\u5728\uff0c\u6211\u4eec\u5728 portal \u9875\u9762\u4e2d\u663e\u793a\u6240\u6709\u7684\u7cbe\u9009\u4e3b\u9898\uff0c\u4e0d\u7ba1\u8bbf\u95ee\u8005\u662f\u5426\u6709\u6743\u9650\u67e5\u770b\u5b83\u4eec\u3002 \u8fd9\u4e0d\u662f\u5f88\u7406\u60f3\uff1b\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\uff0c\u60a8\u53ef\u80fd\u5e0c\u671b\u5728\u67d0\u4e9b\u53d7\u9650\u5236\u7684\u8bba\u575b\u4e0a\u53d1\u5e03\u4e3b\u9898\uff0c\u5e76\u4e14\u53ea\u8ba9\u90a3\u4e9b\u53ef\u4ee5\u6b63\u5e38\u89c6\u56fe\u8be5\u8bba\u575b\u7684\u7528\u6237\u53ef\u89c1\u3002 \u8981\u505a\u5230\u8fd9\u4e00\u70b9\uff0c\u6211\u4eec\u9700\u8981\u6539\u53d8\u6211\u4eec\u7684\u4ee3\u7801\uff0c\u4ee5\u4fbf\u6211\u4eec \"over-fetch\" \u6211\u4eec\u9700\u8981\u663e\u793a\u7684\u8bb0\u5f55\u6570\u91cf\uff0c\u8fc7\u6ee4\u6389\u4efb\u4f55\u770b\u4e0d\u89c1\u7684\u7ed3\u679c\uff0c\u7136\u540e\u5c06\u7ed3\u679c\u96c6\u5207\u6210\u6211\u4eec\u60f3\u8981\u5728\u6bcf\u9875\u663e\u793a\u7684\u5b9e\u9645\u6570\u91cf\u3002 \u8fd9\u6bd4\u542c\u8d77\u6765\u8981\u7b80\u5358\u4e00\u4e9b\u3002 \u9996\u5148\uff0c\u8bf7\u8fdb\u5165 Portal Controller\uff0c\u5e76\u5c06\u8fd9\u4e00\u884c\uff1a ->limitByPage($page, $perPage); \u66f4\u6539\u6210\u8fd9\u6837\uff1a ->limit($perPage * 3); \u7136\u540e\u4e0b\u9762\u518d\u52a0\u4e0a\uff1a $featuredThreads = $finder->fetch() ->filter(function(\\Demo\\Portal\\Entity\\FeaturedThread $featuredThread) { return ($featuredThread->Thread->canView()); }) ->sliceToPage($page, $perPage); \u6700\u540e\u5c06\u8fd9\u884c\uff1a 'featuredThreads' => $finder->fetch(), \u66f4\u6539\u4e3a\uff1a 'featuredThreads' => $featuredThreads, \u4f60\u53ef\u80fd\u5728\u524d\u9762\u7684 demo_portal_view \u6a21\u677f\u4e2d\u5df2\u7ecf\u53d1\u73b0\uff0c\u6211\u4eec\u5448\u73b0\u7684\u6bcf\u4e00\u7bc7\u6587\u7ae0\u4e5f\u6307\u5b9a\u5176\u9644\u4ef6\uff1a 'attachments': $post.attach_count ? $post.Attachments : [], \u73b0\u5728\uff0c\u8fd9\u5c06\u4e3a\u6bcf\u4e2a\u5e16\u5b50\u751f\u6210\u4e00\u4e2a\u989d\u5916\u7684\u67e5\u627e\u3002 \u6240\u4ee5\uff0c\u6211\u4eec\u5e94\u8be5\u5c1d\u8bd5\u5bf9\u6211\u4eec\u8981\u663e\u793a\u7684\u6240\u6709\u5e16\u5b50\u8fdb\u884c\u4e00\u6b21\u67e5\u627e\uff0c\u5e76\u63d0\u524d\u5c06\u5b83\u4eec\u6dfb\u52a0\u5230\u5e16\u5b50\u4e2d\u3002 \u8fd9\u53ef\u80fd\u542c\u8d77\u6765\u6bd4\u5b9e\u9645\u60c5\u51b5\u66f4\u590d\u6742\u3002 \u53ea\u8981\u5728 ->slice(0, $perPage, true); \u884c\u4e0b\u9762\u6dfb\u52a0\u4ee5\u4e0b\u4ee3\u7801\u5373\u53ef\u3002 $threads = $featuredThreads->pluckNamed('Thread'); $posts = $threads->pluckNamed('FirstPost', 'first_post_id'); /** @var \\XF\\Repository\\Attachment $attachRepo */ $attachRepo = $this->repository('XF:Attachment'); $attachRepo->addAttachmentsToContent($posts, 'post'); \u6211\u4eec\u9996\u5148\u4f7f\u7528 pluckNamed() \u65b9\u6cd5\u83b7\u5f97\u4e00\u4e2a\u4e3b\u9898\u7684\u96c6\u5408\uff0c\u7136\u540e\u518d\u4ece\u4e3b\u9898\u4e2d\u83b7\u5f97\u4e00\u4e2a\u5e16\u5b50\u7684\u96c6\u5408\uff08\u4ee5\u5e16\u5b50 ID \u4e3a key \uff09\u3002 \u4e00\u65e6\u6211\u4eec\u5f97\u5230\u4e86\u5e16\u5b50\uff0c\u6211\u4eec\u53ea\u9700\u5c06\u5b83\u4eec\u4f20\u9012\u5230\u9644\u4ef6 repository \u7684\u4e00\u4e2a\u7279\u6b8a\u65b9\u6cd5\u4e2d\u5c31\u53ef\u4ee5\u4e86\uff0c\u8be5\u65b9\u6cd5\u8fd0\u884c\u4e00\u4e2a\u5358\u4e00\u7684\u67e5\u627e\uff0c\u5e76\u4e3a\u6bcf\u4e2a\u5e16\u5b50\u7684\u9644\u4ef6\u5173\u8054 \"hydrates\"\u3002 \u6700\u540e\u8981\u5b8c\u6210\u7684\u6743\u9650\u76f8\u5173\u4e8b\u60c5\u662f\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u6743\u9650\u6765\u63a7\u5236\u8c01\u53ef\u4ee5\u624b\u52a8\u5730\u5bf9\u4e3b\u9898\u8fdb\u884c \u7cbe\u9009/\u53d6\u6d88\u7cbe\u9009\u3002 \u8981\u505a\u5230\u8fd9\u4e00\u70b9\uff0c\u5728 Admin CP \u7684 \"\u5f00\u53d1\" \u4e2d\u70b9\u51fb \"\u6743\u9650\u5b9a\u4e49\"\uff0c\u7136\u540e\u70b9\u51fb \"\u6dfb\u52a0\u6743\u9650\"\u3002 \"\u6743\u9650\u7ec4\" \u4e3a \"\u8bba\u575b\"\uff0c\"\u6743\u9650 ID\" \u4e3a demoPortalFeature \uff0c\"Title\" \u5e94\u8be5\u662f Can feature / unfeature threads \uff0c\u5c06 \"\u4ecb\u9762\u7ec4\" \u8bbe\u7f6e\u4e3a Forum moderator permissions \uff0c\u5728\u9009\u62e9\u4e86\u9002\u5f53\u7684\u663e\u793a\u987a\u5e8f\u5e76\u786e\u4fdd\u9009\u62e9\u4e86\u60a8\u7684\u9644\u52a0\u7ec4\u4ef6\u4e4b\u540e\uff0c\u70b9\u51fb \"\u4fdd\u5b58\"\u3002 \u8981\u771f\u6b63\u4f7f\u7528\u8fd9\u4e2a\u6743\u9650\uff0c\u6211\u4eec\u9700\u8981\u56de\u5230\u6211\u4eec\u7684\u7ee7\u627f\u4e3b\u9898 Entity\uff0c\u4fee\u6539 canFeatureUnfeature() \u65b9\u6cd5\u3002 \u5c06 return true; \u66ff\u6362\u4e3a\uff1a return \\XF::visitor()->hasNodePermission($this->node_id, 'demoPortalFeature'); \u6b64\u65f6\uff0c\u7531\u4e8e\u6743\u9650\u6ca1\u6709\u4efb\u4f55\u9ed8\u8ba4\u503c\uff0c\u5982\u679c\u4f60\u53bb\u7f16\u8f91\u4efb\u4f55\u4e00\u4e2a\u5e16\u5b50\uff0c\u4f60\u5e94\u8be5\u4f1a\u53d1\u73b0 \"\u7cbe\u9009\" checkbox \u4e0d\u89c1\u4e86\u3002 \u4f46\u662f\uff0c\u5982\u679c\u60a8\u6388\u4e88\u81ea\u5df1\u8be5\u6743\u9650\uff0c\u5219\u8be5c heckbox \u5c06\u518d\u6b21\u51fa\u73b0\u3002 \u56e0\u6b64\uff0c\u8fd9\u5e94\u8be5\u8868\u660e\u4e86\u6743\u9650\u7684\u8fd0\u4f5c\u662f\u7b26\u5408\u9884\u671f\u7684! \u521b\u5efa\u4e00\u4e9b\u9009\u9879 \u00b6 \u6211\u4eec\u5f53\u524d\u6bcf\u9875\u53ea\u663e\u793a 5 \u4e2a\u7cbe\u9009\u4e3b\u9898\uff0c\u4f46\u5982\u679c\u80fd\u6709\u66f4\u591a\u7684\u663e\u793a\u9009\u9879\u5c31\u66f4\u597d\u4e86\u3002 \u521b\u5efa\u9009\u9879\u5f88\u7b80\u5358\u3002 \u867d\u7136\u4e0d\u662f\u5fc5\u987b\u7684\uff0c\u4f46\u6211\u4eec\u9996\u5148\u8981\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u9009\u9879\u7ec4\uff0c\u7136\u540e\u5411\u8be5\u7ec4\u6dfb\u52a0\u4e00\u4e2a\u65b0\u7684\u9009\u9879\u3002 \u5728 Admin CP \u7684\u8bbe\u7f6e\u7136\u540e\u9009\u9879\u4e0b\u70b9\u51fb \"\u6dfb\u52a0\u9009\u9879\u7ec4\" \u6309\u94ae\u3002 \u6211\u4eec\u5c06 \"\u7528\u6237\u7ec4 ID\" \u79f0\u4e3a demoPortal \uff0c\u5e76\u7ed9\u5b83\u4e00\u4e2a \"Demo - Portal options\" \u7684\u6807\u9898\u3002 \u7ed9\u5b83\u4e00\u4e2a\u5408\u9002\u7684 \"\u63cf\u8ff0\" \u548c \"\u663e\u793a\u987a\u5e8f\"\uff0c\u7136\u540e\u70b9\u51fb \"\u4fdd\u5b58\"\u3002 \u73b0\u5728\u70b9\u51fb \"\u6dfb\u52a0\u9009\u9879\"\u3002 \u5c06 \"\u9009\u9879 ID\" \u8bbe\u7f6e\u4e3a demoPortalFeaturedPerPage \uff0c\"Title\" \u8bbe\u7f6e\u4e3a Featured threads per page \uff0c\u7f16\u8f91\u683c\u5f0f\u8bbe\u7f6e\u4e3a Spin box \uff0c\"\u6570\u636e\u7c7b\u578b\" \u8bbe\u7f6e\u4e3a Positive integer \uff0c\"\u9ed8\u8ba4\u503c\" \u8bbe\u7f6e\u4e3a \"10\"\u3002 \u70b9\u51fb \"\u4fdd\u5b58\"\u3002 \u8981\u5b9e\u73b0\u8fd9\u4e00\u70b9\uff0c\u8bf7\u56de\u5230 portal Controller\uff0c\u5e76\u5c06\uff1a $perPage = 5; \u66f4\u6539\u4e3a\uff1a $perPage = $this->options()->demoPortalFeaturedPerPage; \u589e\u52a0\u53e6\u4e00\u4e2a\u9009\u9879\u53ef\u80fd\u4e0d\u4f1a\u6709\u4ec0\u9ebd\u5f71\u54cd\u3002 \u4e5f\u8bb8\u53e6\u4e00\u4e2a\u6709\u7528\u7684\u9009\u9879\u662f\u53ef\u4ee5\u5c06\u9ed8\u8ba4\u7684\u6392\u5e8f\u987a\u5e8f\u4ece xf_demo_portal_featured_thread.feartured_date \u6539\u4e3a xf_thread.post_date \u3002 \u56de\u5230 \"Demo - Portal options\" \u7ec4\uff0c\u70b9\u51fb \"\u6dfb\u52a0\u9009\u9879\"\u3002 \u5c06 \"\u9009\u9879 ID\" \u8bbe\u7f6e\u4e3a demoPortalDefaultSort \uff0c\"Title\" \u8bbe\u7f6e\u4e3a Default sort order \uff0c\"\u7f16\u8f91\u683c\u5f0f\" \u8bbe\u7f6e\u4e3a Radio buttons \u3002 \"\u683c\u5f0f\u53c2\u6570\" \u8bbe\u7f6e\u5982\u4e0b\uff1a plain featured_date={{ phrase('demo_portal_featured_date') }} post_date={{ phrase('demo_portal_post_date') }} \u6700\u540e\u5c06 \"\u9ed8\u8ba4\u503c\" \u8bbe\u7f6e\u4e3a featured_date \uff0c\u70b9\u51fb \"\u4fdd\u5b58\"\u3002 \u6211\u4eec\u9700\u8981\u521b\u5efa\u7528\u4e8e\u5358\u9009\u6309\u94ae\u6807\u7b7e\u7684\u77ed\u8bed\uff0c\u7c7b\u4f3c\u4e8e\u6211\u4eec\u4e4b\u524d\u521b\u5efa\u6a21\u677f\u4fee\u6539\u7684\u77ed\u8bed\u3002 \u5c06\u9009\u9879\u503c\u8bbe\u7f6e\u4e3a \"\u53d1\u5e03\u65e5\u671f\"\u3002 \u4e25\u683c\u6765\u8bf4\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u66f4\u65b0\u6211\u4eec\u7684 repository \u65b9\u6cd5\u6765\u4f7f\u7528\u65b0\u7684\u9009\u9879\uff0c\u4f46\u662f\uff0c\u4e5f\u8bb8\u503c\u5f97\u770b\u770b\u81ea\u5b9a\u4e49 finder \u65b9\u6cd5\u662f\u5982\u4f55\u8fd0\u4f5c\u7684\u3002 \u5728\u8def\u5f84 src/addons/Demo/Portal/Finder/FeaturedThread.php \u4e2d\u521b\u5efa\u4e00\u4e2a\u65b0\u6587\u4ef6\uff0c\u5185\u5bb9\u5982\u4e0b\uff1a <?php namespace Demo\\Portal\\Finder; use XF\\Mvc\\Entity\\Finder; class FeaturedThread extends Finder { public function applyFeaturedOrder($direction = 'ASC') { $options = \\XF::options(); if ($options->demoPortalDefaultSort == 'featured_date') { $this->setDefaultOrder('featured_date', $direction); } else { $this->setDefaultOrder('Thread.post_date', $direction); } return $this; } } \u6b63\u5982\u4f60\u6240\u770b\u5230\u7684\uff0c\u6211\u4eec\u5728\u8fd9\u91cc\u6240\u505a\u7684\u53ea\u662f\u521b\u5efa\u4e86\u4e00\u4e2a\u76f8\u5f53\u57fa\u672c\u7684\u7c7b\uff0c\u5b83\u7ee7\u627f\u4e86 XF Finder \u7269\u4ef6\uff0c\u5e76\u521b\u5efa\u4e00\u4e2a\u7b80\u5358\u7684\u65b9\u6cd5\u6765\u67e5\u770b\u6211\u4eec\u9009\u9879\u7684\u503c\u5e76\u5957\u7528\u9002\u5f53\u7684\u9ed8\u8ba4\u987a\u5e8f\u3002 \u73b0\u5728\u6211\u4eec\u53ef\u4ee5\u66f4\u65b0\u6211\u4eec\u7684 repository \u65b9\u6cd5\u6765\u53d6\u4ee3\u8fd9\u4e2a\u65b9\u6cd5\u3002 \u5728\u6211\u4eec\u7684\u7cbe\u9009\u4e3b\u9898 repository \u91cc\u9762\uff0c\u627e\u5230\uff1a ->setDefaultOrder('featured_date', 'DESC') \u5e76\u6539\u6210\uff1a ->applyFeaturedOrder('DESC') \u6700\u540e\uff0c\u66f4\u65b0\u6211\u4eec\u7684 portal view \u4ee5\u663e\u793a\u9002\u5f53\u7684\u65f6\u95f4\u6233\u5927\u62b5\u5982\u6b64 - \u6839\u636e\u6211\u4eec\u7684\u9009\u9879\u503c\uff0c\u53ef\u4ee5\u662f\u7cbe\u9009\u65e5\u671f\u6216\u53d1\u5e03\u65e5\u671f\u3002 \u5728 demo_portal_view \u6a21\u677f\u4e2d\u5c06\uff1a <li><xf:date time=\"{$featuredThread.featured_date}\" /></li> \u66f4\u6539\u4e3a\uff1a <li> <xf:if is=\"$xf.options.demoPortalDefaultSort == 'featured_date'\"> <xf:date time=\"{$featuredThread.featured_date}\" /> <xf:else /> <xf:date time=\"{$thread.post_date}\" /> </xf:if> </li> \u5728\u53ef\u89c1\u6027\u53d8\u66f4\u4e0a\u53d6\u6d88\u7cbe\u9009 \u00b6 \u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0c\u6211\u4eec\u9700\u8981\u518d\u6b21\u4fee\u6539\u4e3b\u9898 Entity\uff0c\u4f46\u8fd9\u6b21\u6211\u4eec\u5c06\u901a\u8fc7 entity_post_save \u4e8b\u4ef6\u6765\u5b9e\u73b0\u3002 \u6b63\u5982\u6211\u4eec\u5728 \u5b9e\u4f53\u751f\u547d\u5468\u671f \u4e2d\u63d0\u5230\u7684\uff0c _postSave() \u65b9\u6cd5\u662f\u5728 Entity \u88ab\u63d2\u5165\u6216\u4fee\u6539\u540e\u53ef\u4ee5\u8fd0\u884c\u52a8\u4f5c\u7684\u5730\u65b9\u3002 \u6700\u521d\u6211\u4eec\u4f1a\u5728\u4e00\u4e2a\u4e3b\u9898\u4e0d\u518d\u53ef\u89c1\u7684\u65f6\u5019\uff0c\u53d6\u6d88\u5bf9\u8be5\u4e3b\u9898\u7684\u7cbe\u9009\u3002 \u6240\u4ee5\uff0c\u56de\u5230 \"\u6dfb\u52a0\u4ee3\u7801\u4e8b\u4ef6\u76d1\u542c\" \u9875\u9762\uff0c\u8fd9\u6b21\u76d1\u542c entity_post_save \u4e8b\u4ef6\u3002 \u8fd9\u6b21\u7684\u4e8b\u4ef6\u63d0\u793a\u5c06\u662f XF\\Entity\\Thread \u3002 \u5bf9\u4e8e\u8fd0\u884c callback\uff0c\u6211\u4eec\u5c06\u4f7f\u7528\u4e0e\u4e4b\u524d\u76f8\u540c\u7684 class ( Dem\\Portal\\Listener )\uff0c\u4f46\u662f\u6211\u4eec\u5c06\u5728\u8fd9\u91cc\u6dfb\u52a0\u4e00\u4e2a\u65b0\u7684\u65b9\u6cd5\uff0c\u547d\u540d\u4e3a threadEntityPostSave \u3002 \u73b0\u5728\u8ba9\u6211\u4eec\u6dfb\u52a0\u8fd9\u4e2a\u65b9\u6cd5\uff0c\u8fd9\u6837\u5f53\u6211\u4eec\u4fdd\u5b58\u76d1\u542c\u5668\u65f6\uff0c\u5b83\u5c31\u4f1a\u51fa\u73b0\uff1a public static function threadEntityPostSave(\\XF\\Mvc\\Entity\\Entity $entity) { } \u70b9\u51fb \"\u4fdd\u5b58\" \u6765\u4fdd\u5b58\u76d1\u542c\u5668\u3002 \u8fd9\u4e2a\u51fd\u6570\u7684\u5185\u5bb9\u76f8\u5f53\u7b80\u5358\uff0c\u6211\u4eec\u6765\u770b\u4e00\u4e0b\uff1a if ($entity->isUpdate()) { $visibilityChange = $entity->isStateChanged('discussion_state', 'visible'); if ($visibilityChange == 'leave') { $featuredThread = $entity->FeaturedThread; if ($featuredThread) { $featuredThread->delete(); $entity->fastUpdate('demo_portal_featured', false); } } } \u6211\u4eec\u4e4b\u524d\u5df2\u7ecf\u53d6\u6d88\u4e86\u4e3b\u9898\u7684\u7cbe\u9009\uff0c\u4f46\u8fd9\u4e00\u6b21\u6211\u4eec\u8981\u4ee5\u4e3b\u9898\u7684\u72b6\u6001\u4e3a\u6761\u4ef6\u3002 \u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 isStateChanged \u65b9\u6cd5\u68c0\u6d4b\u72b6\u6001\u53d8\u5316\u3002 \u8fd9\u5c06\u5bf9\u4f20\u9012\u8fdb\u6765\u7684 column \u540d\u548c value \u8fd4\u56de enter \u6216 leave \u3002 \u4f8b\u5982\uff0c\u5982\u679c discussion_state \u4ece visible \u53d8\u4e3a deleted \uff0c\u90a3\u9ebd\u5728\u4e0a\u9762\u7684\u4f8b\u5b50\u4e2d\uff0c\u8be5\u65b9\u6cd5\u5c06\u8fd4\u56de leave \u3002 \u4e00\u65e6\u6211\u4eec\u68c0\u6d4b\u5230\u81ea\u5df1 \"\u79bb\u5f00\" \u53ef\u89c1\u72b6\u6001\u540e\uff0c\u5c31\u53ef\u4ee5\u76f4\u63a5\u786e\u5b9a\u81ea\u5df1\u6709\u4e00\u4e2a\u7cbe\u9009\u7684\u4e3b\u9898\u5173\u8054\uff0c\u5220\u9664\u5b83\uff0c\u5e76\u66f4\u65b0\u7f13\u5b58\u503c\u3002 \u8fd9\u53ea\u51fd\u76d6\u4e86\u4e3b\u9898\u88ab\u6682\u65f6\u5220\u9664\u6216\u9001\u5165\u6279\u51c6\u961f\u5217\u7684\u60c5\u51b5\uff0c\u6211\u4eec\u8fd8\u9700\u8981\u51fd\u76d6\u4e3b\u9898\u88ab\u6c38\u4e45\u5220\u9664\u7684\u60c5\u51b5\u3002 \u4e3a\u6b64\uff0c\u6211\u4eec\u9700\u8981\u53e6\u4e00\u4e2a\u76d1\u542c\u5668\uff0c\u8fd9\u6b21\u662f\u9488\u5bf9 entity_post_delete \u4e8b\u4ef6\u3002 \u56e0\u6b64\uff0c\u4f7f\u7528\u76f8\u540c\u7684 callback class \u6dfb\u52a0\u8be5\u76d1\u542c\u5668\uff0c\u8fd9\u6b21\u7684\u65b9\u6cd5\u540d\u79f0\u4e3a threadEntityPostDelete \u3002 \u5728\u76d1\u542c\u5668 class \u4e2d\u6dfb\u52a0\u4ee5\u4e0b\u4ee3\u7801\uff1a public static function threadEntityPostDelete(\\XF\\Mvc\\Entity\\Entity $entity) { $featuredThread = $entity->FeaturedThread; if ($featuredThread) { $featuredThread->delete(); } } \u70b9\u51fb \"\u4fdd\u5b58\" \u4ee5\u4fdd\u5b58\u76d1\u542c\u5668\u540e\uff0c\u5c31\u53ef\u4ee5\u5bf9\u6b64\u8fdb\u884c\u6d4b\u8bd5\u4e86\u3002 \u4e3a\u4e86\u6d4b\u8bd5\u8fd9\u4e2a\uff0c\u5176\u5b9e\u4f60\u6700\u597d\u7559\u610f\u4e00\u4e0b xf_demo_portal_featured_thread \u8d44\u6599\u8868\uff0c\u56e0\u4e3a\u5230\u5f53\u524d\u4e3a\u6b62\uff0c\u4ee3\u7801\u5df2\u7ecf\u4e0d\u4f1a\u663e\u793a\u4e0d\u53ef\u89c1\u7684\u4e3b\u9898\u4e86\uff0c\u4f46\u91cd\u8981\u7684\u662f\u4e0d\u8981\u7559\u4e0b\u5b64\u513f\u6570\u636e\u3002 \u4e00\u5207\u90fd\u5f88\u987a\u5229\uff0c\u6211\u4eec\u5df2\u7ecf\u975e\u5e38\u63a5\u8fd1\u5b8c\u6210\u4e86...... \u6700\u540e\u4e00\u4e9b\u672a\u4ea4\u5f85\u6e05\u695a\u7684\u4e8b\u60c5 \u00b6 \u8bf4\u5230\u5b64\u513f\u6570\u636e\uff0c\u6bcf\u5f53\u5378\u8f7d\u9644\u52a0\u7ec4\u4ef6\u65f6\uff0c\u6211\u4eec\u90fd\u5e94\u8be5\u5bf9\u6570\u636e\u5e93\u8fdb\u884c\u6574\u7406\u3002 \u6211\u4eec\u53ef\u4ee5\u5728\u6211\u4eec\u4e4b\u524d\u521b\u5efa\u7684 Setup class \u4e2d\u5b8c\u6210\u8fd9\u9879\u5de5\u4f5c\u3002 \u6211\u4eec\u5c06\u521b\u5efa 3 \u4e2a\u65b0\u65b9\u6cd5\uff0c\u5bf9\u5e94\u6211\u4eec\u7684\u524d 3 \u4e2a\u5b89\u88c5\u6b65\u9aa4\uff1a public function uninstallStep1() { $this->schemaManager()->alterTable('xf_forum', function(Alter $table) { $table->dropColumns('demo_portal_auto_feature'); }); } public function uninstallStep2() { $this->schemaManager()->alterTable('xf_thread', function(Alter $table) { $table->dropColumns('demo_portal_featured'); }); } public function uninstallStep3() { $this->schemaManager()->dropTable('xf_demo_portal_featured_thread'); } \u6211\u4eec\u4e0d\u9700\u8981\u521b\u5efa\u5378\u8f7d\u6b65\u9aa4\u6765\u79fb\u9664\u5c0f\u7ec4\u4ef6\uff0c\u56e0\u4e3a\u5f53\u5c0f\u7ec4\u4ef6\u4f4d\u7f6e\u88ab\u79fb\u9664\u65f6\uff0c\u5b83\u4eec\u4f1a\u88ab\u81ea\u52a8\u79fb\u9664\u3002 \u5bf9\u4e8e\u6211\u4eec\u521b\u5efa\u5e76\u4e0e\u9644\u52a0\u7ec4\u4ef6\u76f8\u5173\u8054\u7684\u4efb\u4f55\u5176\u4ed6\u6570\u636e\u4e5f\u662f\u5982\u6b64 -- \u5b83\u4eec\u5c06\u5728\u5378\u8f7d\u65f6\u81ea\u52a8\u5220\u9664\u3002 \u6784\u5efa\u9644\u52a0\u7ec4\u4ef6 \u00b6 \u4efb\u4f55\u9644\u52a0\u7ec4\u4ef6\u7684\u6700\u540e\u4e00\u6b65\uff0c\u5c31\u662f\u53d1\u5e03\u5b83\uff01 \u8fd9\u6d89\u53ca\u5230\u4ece\u6570\u636e\u5e93\u4e2d\u63d0\u53d6 XML \u6587\u4ef6\uff08\u5728\u8f6f\u4ef6\u5305\u4e2d\u63d0\u4f9b\u5e76\u7528\u4e8e\u5b89\u88c5\uff09\uff0c\u8ba1\u7b97\u6bcf\u4e2a\u6587\u4ef6\u7684\u54c8\u5e0c\u7801\uff0c\u5e76\u5c06\u5176\u6dfb\u52a0\u5230\u6211\u4eec\u7684 hashes.json \u4e2d\uff0c\u5e76\u5c06\u76f8\u5173\u6587\u4ef6\u6253\u5305\u6210\u4e00\u4e2a ZIP \u6587\u4ef6\u3002 \u503c\u5f97\u5e86\u5e78\u7684\u662f\uff0c\u8fd9\u53ef\u4ee5\u901a\u8fc7\u4e00\u4e2a CLI \u547d\u4ee4\u6765\u5b8c\u6210! \u53ea\u8981\u8fd0\u884c\u4e0b\u9762\u7684\u547d\u4ee4\u5c31\u53ef\u4ee5\u4e86\uff1a Terminal $ php cmd.php xf-addon:build-release Demo/Portal Performing add-on export. Exporting data for Demo - Portal to ../src/addons/Demo/Portal/_data. 10/10 [============================] 100% Written successfully. Building release ZIP. Writing release ZIP to ../src/addons/Demo/Portal/_releases. Release written successfully. \u90a3\u9ebd\uff0c\u6211\u4eec\u7684\u6f14\u793a\u63d2\u4ef6\u5c31\u5230\u6b64\u7ed3\u675f\u4e86\uff01 \u5982\u679c\u60a8\u60f3\u4e0b\u8f7d\u8fd9\u4e2a\u9644\u52a0\u7ec4\u4ef6\u7684\u539f\u4ee3\u7801\uff0c\u8bf7\u70b9\u51fb\u8fd9\u91cc\uff1a Demo-Portal-1.0.0 Alpha.zip \u3002","title":"\u521b\u5efa\u4e00\u4e2a\u9644\u52a0\u7ec4\u4ef6"},{"location":"lets-build-an-add-on/#_1","text":"\u5bf9\u4e8e\u4e00\u4e9b\u4eba\u6765\u8bf4\uff0c\u76f4\u63a5\u8fdb\u5165\u4e00\u4e2a\u9879\u76ee\u662f\u6700\u597d\u7684\u5b66\u4e60\u65b9\u5f0f\uff0c\u6211\u4eec\u7684\u76ee\u7684\u662f\u5728\u4e0b\u9762\u7684\u7ae0\u8282\u4e2d\uff0c\u60a8\u5c06\u5b66\u4e60\u5982\u4f55\u4ece\u5934\u5f00\u59cb\u6784\u5efa\u4e00\u4e2a\u9644\u52a0\u7ec4\u4ef6\u3002 \u505a\u597d\u51c6\u5907\uff1b\u8fd9\u4e0d\u662f\u4e00\u4e2a\u7b80\u5358\u7684 'Hello world' \u7c7b\u578b\u7684\u6f14\u793a\u3002 \u8fd9\u5b9e\u9645\u4e0a\u662f\u4e00\u4e2a\u529f\u80fd\u76f8\u5f53\u9f50\u5168\u7684\u6f14\u793a\u63d2\u4ef6\uff0c\u51fd\u76d6\u4e86 XF2 \u4e2d\u7684\u8bb8\u591a\u6982\u5ff5\u3002 \u6211\u4eec\u8981\u521b\u5efa\u7684\u9644\u52a0\u7ec4\u4ef6\u5c06\u5141\u8bb8\u62e5\u6709\u9002\u5f53\u6743\u9650\u7684\u7528\u6237 \"\u7cbe\u9009\" \u4e00\u4e2a\u4e3b\u9898\uff0c\u5e76\u5141\u8bb8\u8be5\u4e3b\u9898\u5728\u65b0\u9875\u9762\u4e0a\u663e\u793a\u3002 \u6211\u4eec\u751a\u81f3\u4f1a\u8bbe\u7f6e\u4e00\u4e2a\u6d41\u7a0b\uff0c\u81ea\u52a8\u5728\u7279\u5b9a\u7684\u8bba\u575b\u4e2d\u5bf9\u4e3b\u9898\u8fdb\u884c\u7cbe\u9009\u5904\u7406\u3002 \u6211\u4eec\u5c06\u4e3a\u6b64\u4f7f\u7528\u4e00\u4e2a\u65b0\u7684\u8def\u7531\uff0c\u547d\u540d\u4e3a portal \uff0c\u5e76\u6700\u7ec8\u5c06\u5176\u8bbe\u7f6e\u4e3a\u7d22\u5f15\u9875\u8def\u7531\uff0c\u5e76\u8bbe\u7f6e\u5728\u6d4f\u89c8\u8be5\u9875\u9762\u65f6\u9009\u62e9 \"Home\" \u6807\u7b7e\u3002","title":"\u521b\u5efa\u4e00\u4e2a\u9644\u52a0\u7ec4\u4ef6"},{"location":"lets-build-an-add-on/#_2","text":"\u5728\u6574\u4e2a\u9644\u52a0\u7ec4\u4ef6\u4e2d\uff0c\u6211\u4eec\u5c06\u4f7f\u7528\u9644\u52a0\u7ec4\u4ef6 ID \u4e3a Demo/Portal \u3002 \u9996\u5148\u6211\u4eec\u9700\u8981\u505a\u7684\u662f\u521b\u5efa\u9644\u52a0\u7ec4\u4ef6\uff0c\u4e3a\u6b64\u6211\u4eec\u9700\u8981\u6253\u5f00 \u547d\u4ee4\u63d0\u793a\u5b57\u7b26 / shell / \u7ec8\u7aef\u7a97\u53e3\uff0c\u5c06\u76ee\u5f55\u6539\u4e3a\u4f60\u7684 XF \u5b89\u88c5\u6839\u76ee\u5f55\uff08\u5373 cmd.php \u6240\u5728\u7684\u4f4d\u7f6e\uff09\uff0c\u7136\u540e\u8fd0\u884c\u4ee5\u4e0b\u547d\u4ee4\uff0c\u5e76\u8f93\u5165\u4e0b\u9762\u663e\u793a\u7684\u5bf9\u7b56\uff1a Terminal $ php cmd.php xf-addon:create Enter an ID for this add-on: Demo/Portal Enter a title: Demo - Portal Enter a version ID: This integer will be used for internal variable comparisons. Each release of your addon should increase this number: 1000010 Version string set to: 1.0.0 Alpha Does this add-on supersede a XenForo 1 add-on? (y/n) n The addon.json file was successfully written out to /var/www/src/addons/Demo/Portal/addon.json Does your add-on need a Setup file? (y/n) y Does your Setup need to support running multiple steps? (y/n) y The Setup.php file was successfully written out to /var/www/src/addons/Demo/Portal/Setup.php \u9644\u52a0\u7ec4\u4ef6\u73b0\u5728\u5df2\u7ecf\u521b\u5efa\uff0c\u4f60\u4f1a\u53d1\u73b0\u4f60\u5728 src/addons \u76ee\u5f55\u4e0b\u6709\u4e00\u4e2a\u65b0\u7684\u76ee\u5f55\uff0c\u4f60\u4f1a\u5728 Admin CP \u7684 \"\u5df2\u5b89\u88c5 add-ons\" \u5217\u8868\u4e2d\u627e\u5230\u8be5\u9644\u52a0\u7ec4\u4ef6\u3002 \u5176\u4e2d\u4e00\u4e2a\u5df2\u7ecf\u521b\u5efa\u7684\u6587\u4ef6\u662f addon.json \u6587\u4ef6\uff0c\u5b83\u5f53\u524d\u7684\u6837\u5b50\u662f\u8fd9\u6837\u7684\uff1a { \"legacy_addon_id\": \"\", \"title\": \"Demo - Portal\", \"description\": \"\", \"version_id\": 1000010, \"version_string\": \"1.0.0 Alpha\", \"dev\": \"\", \"dev_url\": \"\", \"faq_url\": \"\", \"support_url\": \"\", \"extra_urls\": [], \"require\": [], \"icon\": \"\" } \u8ba9\u6211\u4eec\u6765\u586b\u4e00\u4e0b\u8fd9\u4e9b\u8be6\u7ec6\u5185\u5bb9\uff1a { \"legacy_addon_id\": \"\", \"title\": \"Demo - Portal\", \"description\": \"Add-on which will display featured threads on the forum home page.\", \"version_id\": 1000010, \"version_string\": \"1.0.0 Alpha\", \"dev\": \"You!\", \"dev_url\": \"\", \"faq_url\": \"\", \"support_url\": \"\", \"extra_urls\": [], \"require\": [], \"icon\": \"fa-home\" } \u73b0\u5728\uff0c\u6211\u4eec\u5df2\u7ecf\u6dfb\u52a0\u4e86 description \uff0c\u5f00\u53d1\u8005\u7684\u540d\u5b57 ( dev )\uff0c\u5e76\u6307\u5b9a\u6211\u4eec\u8981\u663e\u793a\u4e00\u4e2a\u56fe\u6807 ( icon )\u3002 \u56fe\u6807\u53ef\u4ee5\u662f\u4e00\u4e2a\u8def\u5f84\uff08\u76f8\u5bf9\u4e8e\u4f60\u7684 add-on \u6839\u76ee\u5f55\uff09\uff0c\u4e5f\u53ef\u4ee5\u662f\u4e00\u4e2a Font Awesome \u56fe\u6807 \u7684\u540d\u79f0\uff0c\u5c31\u8c61\u6211\u4eec\u5728\u8fd9\u91cc\u505a\u7684\u90a3\u6837\u3002 \u7531\u4e8e\u6211\u4eec\u4e0d\u662f\u8981\u53d6\u4ee3 XenForo 1 \u9644\u52a0\u7ec4\u4ef6\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u5ffd\u7565 legacy_addon_id \u3002 \u5173\u4e8e addon.json \u6587\u4ef6\u4e2d\u6240\u6709\u5c5e\u6027\u7684\u5b8c\u6574\u89e3\u91ca\uff0c\u8bf7\u53c2\u8003 \u9644\u52a0\u7ec4\u4ef6\u7ed3\u6784\u90e8\u5206 \u3002","title":"\u521b\u5efa\u9644\u52a0\u7ec4\u4ef6"},{"location":"lets-build-an-add-on/#setup","text":"\u597d\u5427\uff0c\u4e25\u683c\u6765\u8bf4\uff0c\u8fd9\u4e2a\u7c7b\u5df2\u7ecf\u88ab\u521b\u5efa\u5e76\u5199\u5165\u4e86 Setup.php \uff0c\u4f46\u73b0\u5728\u5b83\u5e76\u6ca1\u6709\u771f\u6b63\u505a\u4ec0\u9ebd\u3002 \u6211\u4eec\u57fa\u672c\u4e0a\u5df2\u7ecf\u6709\u4e86\u4e00\u4e2a class \u9aa8\u67b6\uff0c\u5b83\u770b\u8d77\u6765\u8c61\u8fd9\u6837\uff1a <?php namespace Demo\\Portal; use XF\\AddOn\\AbstractSetup; use XF\\AddOn\\StepRunnerInstallTrait; use XF\\AddOn\\StepRunnerUninstallTrait; use XF\\AddOn\\StepRunnerUpgradeTrait; class Setup extends AbstractSetup { use StepRunnerInstallTrait; use StepRunnerUpgradeTrait; use StepRunnerUninstallTrait; } \u6211\u4eec\u5df2\u7ecf\u8c08\u8fc7\u4e00\u70b9\u5173\u4e8e Setup \u7c7b\u7684\u5185\u5bb9\u3002 \u6211\u4eec\u5c06\u628a\u5b89\u88c5\u3001\u5347\u7ea7\u548c\u5378\u8f7d\u8fc7\u7a0b\u5206\u6210\u4e0d\u540c\u7684\u6b65\u9aa4\u3002 \u8ba9\u6211\u4eec\u4ece\u5bfc\u5165\u4e00\u4e9b\u6709\u7528\u7684 Schema \u7c7b\u5f00\u59cb\u3002 \u5982\u679c\u4f60\u60f3\u4e86\u89e3\u66f4\u591a\u5173\u4e8e\u5b83\u4eec\u7684\u4fe1\u606f\uff0c\u4f60\u53ef\u4ee5\u53c2\u8003 \u7ba1\u7406 Schema \u90e8\u5206 \u3002 \u5728\u6700\u540e\u4e00\u4e2a use \u58f0\u660e\u4e4b\u540e\uff0c\u6dfb\u52a0\u4ee5\u4e0b\u51e0\u884c\uff1a use XF\\Db\\Schema\\Alter; use XF\\Db\\Schema\\Create; \u8fd9\u91cc\u7684 StepRunner \u7279\u6027\u5c06\u5904\u7406\u6240\u6709\u53ef\u7528\u6b65\u9aa4\u7684\u5faa\u73af\u8fc7\u7a0b\uff0c\u6240\u4ee5\u6211\u4eec\u8981\u505a\u7684\u5c31\u662f\u5f00\u59cb\u521b\u5efa\u8fd9\u4e9b\u6b65\u9aa4\u3002 \u6211\u4eec\u9996\u5148\u6dfb\u52a0\u4e00\u4e9b\u4ee3\u7801\uff0c\u5728 xf_forum \u8d44\u6599\u8868\u4e2d\u521b\u5efa\u4e00\u4e2a\u65b0\u7684 column\uff1a <?php namespace Demo\\Portal; use XF\\AddOn\\AbstractSetup; use XF\\AddOn\\StepRunnerInstallTrait; use XF\\AddOn\\StepRunnerUninstallTrait; use XF\\AddOn\\StepRunnerUpgradeTrait; use XF\\Db\\Schema\\Alter; use XF\\Db\\Schema\\Create; class Setup extends \\XF\\AddOn\\AbstractSetup { use StepRunnerInstallTrait; use StepRunnerUpgradeTrait; use StepRunnerUninstallTrait; public function installStep1() { $this->schemaManager()->alterTable('xf_forum', function(Alter $table) { $table->addColumn('demo_portal_auto_feature', 'tinyint')->setDefault(0); }); } } \u8fd9\u4e00 column \u88ab\u6dfb\u52a0\u5230 xf_forum \u8d44\u6599\u8868\u4e2d\uff0c\u8fd9\u6837\u6211\u4eec\u5c31\u53ef\u4ee5\u8bbe\u7f6e\u67d0\u4e9b\u8bba\u575b\u5728\u521b\u5efa\u4e3b\u9898\u65f6\u81ea\u52a8\u663e\u793a\u3002 \u8fd9\u91cc\u7684\u547d\u540d\u5f88\u91cd\u8981\uff0c\u6dfb\u52a0\u5230\u6838\u5fc3 XF \u8d44\u6599\u8868\u4e2d\u7684 columns \u603b\u662f\u5e94\u8be5\u6709\u524d\u7f00\u3002 \u8fd9\u6709\u4e24\u4e2a\u91cd\u8981\u7684\u76ee\u7684\u3002 \u7b2c\u4e00\u4e2a\u662f\u51cf\u5c11\u4e86\u91cd\u590d column \u540d\u53d1\u751f\u51b2\u7a81\u7684\u98ce\u9669\uff0c\u4ee5\u9632 XF \u6216\u5176\u4ed6\u9644\u52a0\u7ec4\u4ef6\u6709\u7406\u7531\u5728\u5c06\u6765\u6dfb\u52a0\u8be5 column\u3002 \u7b2c\u4e8c\u4e2a\u76ee\u7684\u662f\uff0c\u5b83\u6709\u52a9\u4e8e\u66f4\u5bb9\u6613\u5730\u8bc6\u522b\u54ea\u4e9b columns \u5c5e\u65bc\u54ea\u4e9b\u9644\u52a0\u7ec4\u4ef6\uff0c\u4ee5\u9632\u5c06\u6765\u51fa\u73b0\u4e00\u4e9b\u95ee\u9898\u3002 \u65e2\u7136\u5982\u6b64\uff0c\u6211\u4eec\u4e0d\u59a8\u5728\u5b89\u88c5\u7a0b\u5e8f\u4e2d\u518d\u589e\u52a0\u4e00\u4e2a\u6b65\u9aa4\u3002 \u4e3a\u4e86\u7b80\u6d01\u8d77\u89c1\uff0c\u6211\u4eec\u53ea\u663e\u793a\u65b0\u4ee3\u7801\uff0c\u800c\u4e0d\u662f\u6574\u4e2a\u7c7b\u3002 \u5b83\u5e94\u8be5\u76f4\u63a5\u653e\u5728 installStep1() \u65b9\u6cd5\u7684\u4e0b\u9762\uff1a public function installStep2() { $this->schemaManager()->alterTable('xf_thread', function(Alter $table) { $table->addColumn('demo_portal_featured', 'tinyint')->setDefault(0); }); } \u8fd9\u4e00\u6b65\u9aa4\u4e0e\u4e0a\u9762\u7684\u6b65\u9aa4\u7c7b\u4f3c\uff0c\u8fd9\u6b21\u5c06\u5728 xf_thread \u8d44\u6599\u8868\u4e2d\u6dfb\u52a0\u4e00\u4e2a\u65b0 column\u3002 \u6211\u4eec\u5c06\u4f7f\u7528\u8fd9\u4e00 column \u4f5c\u4e3a\u4e00\u4e2a\u7f13\u5b58\u503c\u6765\u5feb\u901f\u8bc6\u522b\u4e00\u4e2a\u4e3b\u9898\u662f\u5426\u6709\u7cbe\u9009\uff0c\u800c\u4e0d\u9700\u8981\u9488\u5bf9 xf_demo_portal_featured_thread \u8d44\u6599\u8868\u67e5\u627e\u6216\u8fdb\u884c\u989d\u5916\u7684\u67e5\u627e\u3002 \u8bf4\u5230\u8fd9\u91cc\uff0c\u6211\u4eec\u73b0\u5728\u5e94\u8be5\u628a\u90a3\u4e2a\u8d44\u6599\u8868\u52a0\u8fdb\u53bb\u4e86\u3002 \u8fd9\u6b21\u76f4\u63a5\u52a0\u5728 installStep2() \u4e0b\u9762\uff1a public function installStep3() { $this->schemaManager()->createTable('xf_demo_portal_featured_thread', function(Create $table) { $table->addColumn('thread_id', 'int'); $table->addColumn('featured_date', 'int'); $table->addPrimaryKey('thread_id'); }); } \u8fd9\u4e00\u6b65\u5c06\u521b\u5efa\u65b0\u7684\u8d44\u6599\u8868\u3002 \u8fd9\u5f20\u8d44\u6599\u8868\u5c06\u7528\u6765\u8bb0\u5f55\u6240\u6709\u88ab\u7cbe\u9009\u7684\u4e3b\u9898\uff0c\u4ee5\u53ca\u5b83\u4eec\u88ab\u7cbe\u9009\u7684\u65f6\u95f4\u3002 \u5728\u547d\u540d\u65b9\u9762\uff0c\u540c\u6837\u7684\u539f\u5219\u4e5f\u9002\u7528\u4e8e\u6b64\u3002 \u4e00\u4e2a\u91cd\u8981\u7684\u533a\u522b\u662f\uff0c\u6240\u6709\u7684\u8d44\u6599\u8868\u90fd\u5e94\u8be5\u53e6\u5916\u52a0\u4e0a xf_ \u7684\u524d\u7f00\u3002 \u8fd9\u6837\u505a\u7684\u539f\u56e0\u662f\uff0c\u5982\u679c\u8fdb\u884c\u4e86\u5e72\u51c0\u7684 XF \u5b89\u88c5\uff0c\u6211\u4eec\u53ef\u4ee5\u5220\u9664\u6240\u6709\u5e2f\u6709 xf_ \u524d\u7f00\u7684\u8d44\u6599\u8868\uff0c\u5305\u62ec\u90a3\u4e9b\u7531\u9644\u52a0\u7ec4\u4ef6\u521b\u5efa\u7684\u8d44\u6599\u8868\u3002 \u5728\u6dfb\u52a0\u4ee3\u7801\u65f6\uff0c\u6700\u5bb9\u6613\u5fd8\u8bb0\u7684\u4e00\u4ef6\u4e8b\u5c31\u662f\uff0c\u6dfb\u52a0\u4e86\u5404\u79cd schema \u66f4\u6539\u540e\u5fd8\u8bb0\u81ea\u5df1\u5957\u7528\u7684 schema \u66f4\u6539\u3002 \u4f60\u53ef\u4ee5\u4f7f\u7528 CLI \u547d\u4ee4\u8fd0\u884c \u5b89\u88c5/\u5347\u7ea7 \u6b65\u9aa4\u3002 \u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u8fd0\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a Terminal $ php cmd.php xf-addon:install-step Demo/Portal 1 $ php cmd.php xf-addon:install-step Demo/Portal 2 $ php cmd.php xf-addon:install-step Demo/Portal 3","title":"\u521b\u5efa Setup \u7c7b"},{"location":"lets-build-an-add-on/#_3","text":"\u5230\u5f53\u524d\u4e3a\u6b62\uff0c\u6211\u4eec\u5df2\u7ecf\u5728 xf_forum \u8d44\u6599\u8868\u4e2d\u6dfb\u52a0\u4e86\u4e00 column\uff0c\u73b0\u5728\u662f\u65f6\u5019\u7ee7\u627f\u8bba\u575b Entity \u7ed3\u6784\u4e86\u3002 \u6211\u4eec\u9700\u8981\u8fd9\u6837\u505a\uff0c\u4ee5\u4fbf Entity \u77e5\u9053\u6211\u4eec\u7684\u65b0 column\uff0c\u5e76\u4e14\u53ef\u4ee5\u901a\u8fc7 Entity \u5411\u5176\u8bfb\u5199\u6570\u636e\u3002 Note \u4ee5\u4e0b\u6b65\u9aa4\u9700\u8981\u6fc0\u6d3b \u5f00\u53d1\u6a21\u5f0f \u3002 \u8bb0\u5f97\u5728 config.php \u4e2d\u8bbe\u7f6e Demo/Portal \u4e3a defaultAddOn \u503c\u3002 \u8fd9\u4e2a\u8fc7\u7a0b\u7684\u7b2c\u4e00\u6b65\u662f\u521b\u5efa\u4e00\u4e2a \"\u4ee3\u7801\u4e8b\u4ef6\u76d1\u542c\u5668\"\u3002 \u8fd9\u53ef\u4ee5\u5728\u5f00\u53d1\u4e0b\u7684 Admin CP \u4e2d\uff0c\u70b9\u51fb \"\u4ee3\u7801\u4e8b\u4ef6\u76d1\u542c\u5668\" \u94fe\u63a5\uff0c\u7136\u540e\u70b9\u51fb \"\u6dfb\u52a0\u4ee3\u7801\u4e8b\u4ef6\u76d1\u542c\u5668\" \u6309\u94ae\u3002 \u6211\u4eec\u9700\u8981\u76d1\u542c entity_structure \u4e8b\u4ef6\u3002 \u6211\u4eec\u5c06\u4f7f\u7528\u5b83\u6765\u4fee\u6539\u9ed8\u8ba4\u7684\u8bba\u575b Entity \u7ed3\u6784\uff0c\u4ee5\u6dfb\u52a0\u6211\u4eec\u65b0\u521b\u5efa\u7684 demo_portal_auto_feature column\u3002 \u5728 \"\u4e8b\u4ef6\u63d0\u793a\" \u5b57\u6bb5\u4e2d\uff0c\u6211\u4eec\u5c06\u8f93\u5165\u8981\u7ee7\u627f\u7684\u7c7b\u540d\uff0c\u4f8b\u5982 XF\\Entity\\Forum \u3002 \u8fd9\u5c06\u786e\u4fdd\u6211\u4eec\u7684\u76d1\u542c\u5668\u53ea\u5728\u8bba\u575b Entity \u4e0a\u8fd0\u884c\u3002 \u5bf9\u4e8e \"\u8fd0\u884c callback\" \u7c7b\u8f93\u5165 Demo\\Portal\\Listener \uff0c\u5bf9\u4e8e\u65b9\u6cd5\u8f93\u5165 forumEntityStructure \u3002 \u503c\u5f97\u6dfb\u52a0\u4e00\u4e2a\u63cf\u8ff0\u6765\u89e3\u91ca\u8fd9\u4e2a\u76d1\u542c\u5668\u7684\u7528\u9014\uff0c\u56e0\u4e3a\u8fd9\u5c06\u6709\u52a9\u4e8e\u66f4\u5bb9\u6613\u5730\u5728\u4ee3\u7801\u4e8b\u4ef6\u76d1\u542c\u5668\u5217\u8868\u4e2d\u8bc6\u522b\u76d1\u542c\u5668\u3002 \"\u7ee7\u627f XF\\Entity\\Forum \u7ed3\u6784\" \u5e94\u8be5\u5c31\u591f\u4e86\u3002 \u6700\u540e\uff0c\u786e\u4fdd \"Demo - Portal\" \u9644\u52a0\u7ec4\u4ef6\u88ab\u9009\u4e2d\u3002 \u5728\u70b9\u51fb \"\u4fdd\u5b58\" \u4e4b\u524d\uff0c\u6211\u4eec\u9700\u8981\u5b9e\u9645\u521b\u5efa Listener \u7c7b\u3002 \u6240\u4ee5\u5728 src/addons/Demo/Portal \u4e2d\u521b\u5efa\u4e00\u4e2a\u540d\u4e3a Listener.php \u7684\u65b0\u6587\u4ef6\u3002 \u8fd9\u4e2a\u6587\u4ef6\u7684\u5185\u5bb9\u6700\u521d\u5e94\u8be5\u662f\u8fd9\u6837\u7684\u3002 \u6211\u4eec\u4ece\u4ee3\u7801\u4e8b\u4ef6\u9009\u62e9\u5668\u4e0b\u9762\u7684\u6587\u4ef6\u4e2d\u77e5\u9053\u8fd9\u4e2a\u51fd\u6570\u9700\u8981\u7684\u53c2\u6570\u3002 <?php namespace Demo\\Portal; use XF\\Mvc\\Entity\\Entity; class Listener { public static function forumEntityStructure(\\XF\\Mvc\\Entity\\Manager $em, \\XF\\Mvc\\Entity\\Structure &$structure) { } } \u6ce8\u610f namespace \u548c class \u540d\u79f0\u4e4b\u95f4\u7684 use \u58f0\u660e\u3002 \u6211\u4eec\u5c06\u4e0d\u6b62\u4e00\u6b21\u5730\u5f15\u7528\u8fd9\u91cc\u58f0\u660e\u7684 class\uff0c\u56e0\u6b64\u5728\u8fd9\u91cc\u58f0\u660e\u5b83\u786e\u5b9e\u5141\u8bb8\u6211\u4eec\u7528\u5b83\u66f4\u77ed\u7684\u522b\u540d\u6765\u5f15\u7528\u5b83\uff0c\u5728\u672c\u4f8b\u4e2d\u662f Entity \u3002 \u8fd9\u6bb5\u4ee3\u7801\u5b9e\u9645\u4e0a\u8fd8\u4e0d\u4f1a\u505a\u4efb\u4f55\u4e8b\u60c5\uff0c\u4f46\u73b0\u5728\u662f\u4fdd\u5b58\u4ee3\u7801\u4e8b\u4ef6\u76d1\u542c\u5668\u7684\u597d\u65f6\u673a\uff0c\u6240\u4ee5\u8bf7\u7ee7\u7eed\u70b9\u51fb \"\u4fdd\u5b58\" \u6309\u94ae\u3002 \u5728\u6211\u4eec\u4e3a\u65b0\u51fd\u6570\u6dfb\u52a0\u4e00\u4e9b\u529f\u80fd\u4ee3\u7801\u4e4b\u524d\uff0c\u73b0\u5728\u4e5f\u8bb8\u662f\u4e2a\u5f88\u597d\u7684\u65f6\u673a\u6765\u770b\u770b\u5f00\u53d1\u8f93\u51fa\u7cfb\u7edf\u662f\u5982\u4f55\u8fd0\u4f5c\u7684\u3002 \u68c0\u67e5\u4e00\u4e0b\u6dfb\u52a0\u5230\u4f60 add-on \u76ee\u5f55\u4e2d\u7684\u65b0\u76ee\u5f55\u548c\u6587\u4ef6\u3002 \u7279\u522b\u662f\u5728 _output/code_event_listeners \u76ee\u5f55\u4e0b\u6709\u4e00\u4e2a\u65b0\u7684 JSON \u6587\u4ef6\uff0c\u5b83\u5e94\u8be5\u662f\u8fd9\u6837\u7684\uff1a { \"event_id\": \"entity_structure\", \"execute_order\": 10, \"callback_class\": \"Demo\\\\Portal\\\\Listener\", \"callback_method\": \"forumEntityStructure\", \"active\": true, \"hint\": \"XF\\\\Entity\\\\Forum\", \"description\": \"Extends the XF\\\\Entity\\\\Forum structure\" } \u6bcf\u5f53\u76d1\u542c\u5668\u53d1\u751f\u53d8\u5316\u65f6\uff0c\u8fd9\u4e2a\u6587\u4ef6\u4f1a\u81ea\u52a8\u66f4\u65b0\u3002 \u597d\u4e86\uff0c\u6211\u4eec\u518d\u6765\u6dfb\u52a0\u4e00\u4e9b\u4ee3\u7801\u3002 \u56de\u5230 Listener \u7c7b\u4e2d\uff0c\u5728 forumEntityStructure \u51fd\u6570\u4e2d\u6dfb\u52a0\u4ee5\u4e0b\u5185\u5bb9\uff1a $structure->columns['demo_portal_auto_feature'] = ['type' => Entity::BOOL, 'default' => false]; \u8bba\u575b Entity \u73b0\u5728\u5df2\u7ecf\u77e5\u9053\u4e86\u6211\u4eec\u7684\u65b0 column\uff0c\u4f46\u5728\u5f00\u59cb\u5b9e\u4f5c\u5bf9\u8be5 column \u8fdb\u884c\u5b9e\u9645\u8bbe\u7f6e\u503c\u7684\u65b9\u6cd5\u4e4b\u524d\uff0c\u6211\u4eec\u8fd8\u9700\u8981\u5148\u5904\u7406\u51e0\u4e2a\u6b65\u9aa4\u3002","title":"\u7ee7\u627f\u8bba\u575b\u5b9e\u4f53"},{"location":"lets-build-an-add-on/#_4","text":"\u540c\u6837\uff0c\u7531\u4e8e\u6211\u4eec\u5728 xf_thread \u8d44\u6599\u8868\u4e2d\u6dfb\u52a0\u4e86\u4e00\u4e2a\u65b0\u7684 column\uff0c\u6211\u4eec\u5e94\u8be5\u8ba9\u4e3b\u9898\u5b9e\u4f53\u77e5\u9053\u8fd9\u4e00\u70b9\u3002 \u8fd9\u4e0e\u6211\u4eec\u4e0a\u9762\u7684\u4f5c\u6cd5\u975e\u5e38\u76f8\u4f3c\u3002 \u56de\u5230 \"\u6dfb\u52a0\u4ee3\u7801\u4e8b\u4ef6\u76d1\u542c\u5668\"\uff0c\u518d\u6b21\u76d1\u542c entity_structure \u3002 \u8fd9\u6b21\u7684 \"\u4e8b\u4ef6\u63d0\u793a\" \u5c06\u662f XF\\Entity\\Thread \u3002 \u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u4e0e\u4e4b\u524d\u76f8\u540c\u7684 callback \u7c7b\uff08 Demo\\Portal\\Listener \uff09\uff0c\u4f46\u8fd9\u6b21\u7684\u65b9\u6cd5\u5c06\u547d\u540d\u4e3a threadEntityStructure \u3002 \u6dfb\u52a0\u7c7b\u4f3c\u4e4b\u524d\u7684\u63cf\u8ff0\u3002 \u5728\u4fdd\u5b58\u4e4b\u524d\uff0c\u6211\u4eec\u5e94\u8be5\u5728 forumEntityStructure \u51fd\u6570\u4e0b\u9762\u76f4\u63a5\u6dfb\u52a0\u4ee3\u7801\uff1a public static function threadEntityStructure(\\XF\\Mvc\\Entity\\Manager $em, \\XF\\Mvc\\Entity\\Structure &$structure) { $structure->columns['demo_portal_featured'] = ['type' => Entity::BOOL, 'default' => false]; } \u8fd9\u6bb5\u4ee3\u7801\u4e0e\u6211\u4eec\u5728\u8bba\u575b Entity \u7ed3\u6784\u4e2d\u6dfb\u52a0\u7684\u4ee3\u7801\u51e0\u4e4e\u76f8\u540c\uff0c\u552f\u4e00\u4e0d\u540c\u7684\u662f column \u540d\u3002 \u4f46\u662f\uff0c\u6211\u4eec\u786e\u5b9e\u9700\u8981\u6dfb\u52a0\u4e00\u4e9b\u5176\u4ed6\u7684\u4e1c\u897f\u3002 \u6211\u4eec\u5e94\u8be5\u521b\u5efa\u4e00\u4e2a Entity \u5173\u8054\uff0c\u8fd9\u6837\uff0c\u4ee5\u540e\u6211\u4eec\u9700\u8981\u8bbf\u95ee\u7cbe\u9009\u4e3b\u9898 Entity\uff08\u6211\u4eec\u5728\u4e0b\u4e00\u8282\u521b\u5efa\uff09\u65f6\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u5f88\u5bb9\u6613\u5730\u901a\u8fc7 Finder \u67e5\u627e\u6765\u5b9e\u73b0\u3002 \u5728 $structure->columns \u884c\u4e0b\u9762\u6dfb\u52a0\uff1a $structure->relations['FeaturedThread'] = [ 'entity' => 'Demo\\Portal:FeaturedThread', 'type' => Entity::TO_ONE, 'conditions' => 'thread_id', 'primary' => true ]; \u6709\u5173 \u5173\u8054 \u7684\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u89c1\u5173\u8054\u3002 \u70b9\u51fb \"\u4fdd\u5b58\" \u6765\u4fdd\u5b58\u76d1\u542c\u5668\u3002","title":"\u7ee7\u627f\u4e3b\u9898\u5b9e\u4f53"},{"location":"lets-build-an-add-on/#_5","text":"\u4e0a\u9762\u5728 installStep3() \u4e2d\uff0c\u6211\u4eec\u521b\u5efa\u4e86\u4e00\u4e2a\u65b0\u8d44\u6599\u8868\u3002 \u6211\u4eec\u9700\u8981\u521b\u5efa\u4e00\u4e2a Entity \u6765\u4e0e\u8fd9\u4e2a\u8d44\u6599\u8868\u4ea4\u4e92\u5e76\u521b\u5efa\u65b0\u7684\u8bb0\u5f55\u3002 \u56e0\u4e3a\u8fd9\u662f\u4e00\u4e2a\u5168\u65b0\u7684 Entity\uff0c\u6211\u4eec\u9664\u4e86\u5728 src/addons/Demo/Portal/Entity/FeaturedThread.php \u4e2d\u521b\u5efa class \u4e4b\u5916\uff0c\u4e0d\u9700\u8981\u505a\u4efb\u4f55\u5176\u4ed6\u7684\u4e8b\u60c5\uff0c\u5b83\u7684\u67b6\u6784\u770b\u8d77\u6765\u8c61\u8fd9\u6837\uff1a <?php namespace Demo\\Portal\\Entity; use XF\\Mvc\\Entity\\Structure; class FeaturedThread extends \\XF\\Mvc\\Entity\\Entity { } \u6211\u4eec\u9700\u8981\u7528\u5b83\u6765\u5b9a\u4e49 Entity \u7ed3\u6784\uff0c\u5b83\u4ee3\u8868\u6211\u4eec\u4e4b\u524d\u521b\u5efa\u7684\u65b0 xf_demo_portal_featured_thread \u8d44\u6599\u8868\u3002 \u8fd9\u4e2a Entity \u7684\u7ed3\u6784\u5e94\u8be5\u662f\u8fd9\u6837\u7684\uff1a public static function getStructure(Structure $structure) { $structure->table = 'xf_demo_portal_featured_thread'; $structure->shortName = 'Demo\\Portal:FeaturedThread'; $structure->primaryKey = 'thread_id'; $structure->columns = [ 'thread_id' => ['type' => self::UINT, 'required' => true], 'featured_date' => ['type' => self::UINT, 'default' => time()] ]; $structure->getters = []; $structure->relations = [ 'Thread' => [ 'entity' => 'XF:Thread', 'type' => self::TO_ONE, 'conditions' => 'thread_id', 'primary' => true ], ]; return $structure; } \u6839\u636e\u6211\u4eec\u524d\u9762\u5199\u7684 MySQL \u521b\u5efa\u8d44\u6599\u8868\uff0ccolumns \u7684\u5217\u8868\u5927\u6982\u4e0d\u9700\u8981\u52a0\u4ee5\u8bf4\u660e\u3002 \u5173\u8054\u4e2d\u5305\u62ec\u4e00\u4e2a Thread \u5173\u8054\uff0c\u5b83\u5c06\u5141\u8bb8\u6211\u4eec\u4ece\u8fd9\u4e2a Entity \u4e2d\u83b7\u5f97\u76f8\u5173\u7684\u4e3b\u9898 Entity \u8bb0\u5f55\uff08\u751a\u81f3\u4e3b\u9898 Entity \u5173\u8054\uff09\u3002","title":"\u521b\u5efa\u4e00\u4e2a\u65b0\u5b9e\u4f53"},{"location":"lets-build-an-add-on/#_6","text":"\u6211\u4eec\u73b0\u5728\u9700\u8981\u4e00\u79cd\u65b9\u6cd5\u6765\u4fee\u6539 forum_edit \u6a21\u677f\uff0c\u5728\u90a3\u91cc\u6dfb\u52a0\u4e00\u4e2a\u65b0\u7684 checkbox\uff0c\u6700\u7ec8\u53ef\u4ee5\u5199\u56de\u6211\u4eec\u73b0\u5728\u521b\u5efa\u7684\u65b0 column\u3002 \u6211\u4eec\u5c06\u901a\u8fc7\u521b\u5efa\u4e00\u4e2a\u6a21\u677f\u4fee\u6539\u6765\u5b9e\u73b0\u3002 \u8fd9\u662f\u5728 Admin CP \u4e0b\u7684\u5916\u89b3\u4e2d\u5b8c\u6210\u7684\uff0c\u7136\u540e\u70b9\u51fb\u6a21\u677f\u4fee\u6539\u3002 \u70b9\u51fb \"Admin\" \u6807\u7b7e\uff0c\u7136\u540e\u518d\u70b9\u51fb \"\u6dfb\u52a0\u6a21\u677f\u4fee\u6539\" \u6309\u94ae\u3002 \u5728 \"\u6a21\u677f\" \u680f\u4e2d\uff0c\u8f93\u5165 \"forum_edit\"\u3002 \u8fd9\u5c31\u662f\u6211\u4eec\u9700\u8981\u4fee\u6539\u7684\u6a21\u677f\u3002 \u5728 \"\u4fee\u6539 key\" \u5b57\u6bb5\u4e2d\uff0c\u8f93\u5165 \"demo_portal_forum_edit\"\u3002 \u8fd9\u662f\u4e00\u4e2a\u552f\u4e00\u7684 key\uff0c\u7528\u4e8e\u6807\u8bc6\u60a8\u7684\u6a21\u677f\u4fee\u6539\u3002 \u8fd9\u90e8\u5206\u6700\u597d\u7684\u4e60\u60ef\u662f\uff0c\u6700\u8d77\u7801\u8981\u5728\u88ab\u4fee\u6539\u7684\u6a21\u677f\u540d\u79f0\u540e\u9762\u6ce8\u660e\u9644\u52a0\u7ec4\u4ef6\u3002 \"\u63cf\u8ff0\" \u5b57\u6bb5\u5e94\u8be5\u5305\u542b\u4e00\u4e9b\u6587\u672c\uff0c\u4ee5\u5e2e\u52a9\u60a8\u5728\u67e5\u770b\u6a21\u677f\u4fee\u6539\u5217\u8868\u65f6\u786e\u5b9a\u6b64\u4fee\u6539\u7684\u76ee\u7684\u3002 \u5c31\u8c61\u662f \"\u6dfb\u52a0\u81ea\u52a8\u7cbe\u9009 checkbox \u5230 forum_edit \u6a21\u677f\" \u8fd9\u6837\u7684\u5185\u5bb9\u5e94\u8be5\u8db3\u591f\u4e86\u3002 \u5f53\u60a8\u5728 \"\u6a21\u677f\" \u5b57\u6bb5\u4e2d\u8f93\u5165\u6a21\u677f\u540d\u79f0\u65f6\uff0c\u60a8\u53ef\u80fd\u4f1a\u6ce8\u610f\u5230\u663e\u793a\u4e86\u6a21\u677f\u5185\u5bb9\u7684\u9884\u89c8\u3002 \u6211\u4eec\u9700\u8981\u5229\u7528\u8fd9\u4e2a\u6765\u786e\u5b9a checkbox \u7684\u504f\u597d\u4f4d\u7f6e\u3002 \u5728\u67e5\u770b\u8bba\u575b\u7f16\u8f91\u9875\u9762\u65f6\uff0c\u4f60\u53ef\u80fd\u4f1a\u6ce8\u610f\u5230\u6709\u4e00\u7cfb\u5217\u7684 checkbox\uff0c\u8fd9\u770b\u8d77\u6765\u662f\u4e00\u4e2a\u5408\u7406\u7684\u4f4d\u7f6e\u3002 \u6700\u7b80\u5358\u7684\u65b9\u6cd5\u662f\u5728\u8fd9\u4e2a\u90e8\u5206\u653e\u7f6e\u4e00\u4e2a checkbox\uff0c\u5bf9\u4e0a\u9762\u7684 checkbox \u8fdb\u884c\u7b80\u5358\u7684\u66ff\u6362\uff0c\u6240\u4ee5\u5728 \"\u67e5\u627e\" \u680f\u4e2d\u6dfb\u52a0\uff1a <xf:option name=\"allow_posting\" \u5e76\u5728\u5b57\u6bb5\u4e2d\u66ff\u6362\uff1a <xf:option name=\"demo_portal_auto_feature\" selected=\"$forum.demo_portal_auto_feature\" label=\"Automatically feature threads in this forum\" hint=\"If selected, any new threads posted in this forum will be automatically featured.\" /> $0 \u6211\u4eec\u8fd8\u4e0d\u9700\u8981\u62c5\u5fc3\u521b\u5efa\u77ed\u8bed\u7684\u95ee\u9898\uff0c\u6211\u4eec\u53ef\u4ee5\u7a0d\u540e\u518d\u6765\u62fe\u53d6\u8fd9\u4e9b\u3002 \u6ce8\u610f\uff0c\u540d\u79f0\u5c5e\u6027\u5fc5\u987b\u4e0e\u6211\u4eec\u4e4b\u524d\u521b\u5efa\u7684 column \u540d\u76f8\u5339\u914d\uff0c\u66f4\u91cd\u8981\u7684\u662f\uff0ccheckbox row \u7684\u52fe\u9009\u72b6\u6001\u4e5f\u662f\u4ece\u8bba\u575b Entity \u4e2d\u8bfb\u53d6\u6dfb\u52a0\u52a0\u7684 column\u3002 \u5f53\u6211\u4eec\u7a0d\u540e\u4fdd\u5b58\u6a21\u677f\u4fee\u6539\u65f6\uff0c\u5982\u679c\u67e5\u627e\u5b57\u6bb5\u7684\u5185\u5bb9\u4e0e\u6a21\u677f\u7684\u4efb\u4f55\u90e8\u5206\u76f8\u5339\u914d\uff0c\u90a3\u9ebd\u5b83\u5c06\u88ab\u66ff\u6362\u5b57\u6bb5\u7684\u5185\u5bb9\u6240\u53d6\u4ee3\u3002 \u5b9e\u9645\u4e0a\u6211\u4eec\u5e76\u6ca1\u6709\u5220\u9664\u5339\u914d\u7684\u5185\u5bb9\uff0c\u56e0\u4e3a\u66ff\u6362\u5b57\u6bb5\u4e2d\u7684 $0 \u662f\u91cd\u65b0\u63d2\u5165\u5339\u914d\u7684\u6587\u672c\u3002 \u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 \"\u6d4b\u8bd5\" \u6309\u94ae\u6765\u68c0\u67e5\u66ff\u6362\u7684\u8fd0\u4f5c\u662f\u5426\u7b26\u5408\u9884\u671f\u3002 \u5f53\u70b9\u51fb\u6d4b\u8bd5\u6309\u94ae\u65f6\uff0c\u4f1a\u51fa\u73b0\u4e00\u4e2a\u590d\u76d6\u5c42\u5e2f\u6709\u4fee\u6539\u540e\u7684\u6a21\u677f\u3002 \u5982\u679c\u4e00\u5207\u987a\u5229\uff0c\u4e00\u4e2a\u7dd1\u8272\u533a\u57df\u5e94\u8be5\u9ad8\u4eae\u663e\u793a\u6211\u4eec\u8981\u6dfb\u52a0\u7684\u65b0\u4ee3\u7801\u3002 Note \u8fd9\u662f\u4e00\u4e2a\u76f8\u5f53\u7b80\u5358\u7684\u66ff\u6362\u3002 \u5bf9\u4e8e\u66f4\u8fdb\u9636\u7684\u5339\u914d\uff0c\u4f60\u4e5f\u53ef\u4ee5\u4f7f\u7528 \"\u6b63\u89c4\u8868\u8fbe\u5f0f\" \u7c7b\u578b\u3002 \u5173\u4e8e\u4f7f\u7528\u6b63\u89c4\u8868\u8fbe\u5f0f\u7684\u8be6\u7ec6\u89e3\u91ca\u8d85\u51fa\u4e86\u672c\u6307\u5357\u7684\u8303\u56f4\uff0c\u4f46\u7f51\u4e0a\u6709\u5f88\u591a\u8d44\u6e90\u53ef\u80fd\u4f1a\u6709\u6240\u5e2e\u52a9\u3002 \u6700\u540e\uff0c\u70b9\u51fb\u4fdd\u5b58\uff0c\u4fdd\u5b58\u4f60\u7684\u6a21\u677f\u4fee\u6539\u3002 \u5982\u679c\u4e00\u5207\u987a\u5229\uff0c\u5f53\u4f60\u8fd4\u56de\u6a21\u677f\u4fee\u6539\u5217\u8868\u65f6\uff0c\u4f60\u4f1a\u770b\u5230\u65e5\u5fd7\u6458\u8981\u663e\u793a 1 / 0 / 0 \u56e0\u6b64\u8868\u660e\u4fee\u6539\u6210\u529f\u5957\u7528\u4e00\u6b21\u3002 \u4e00\u4e2a\u66f4\u597d\u7684\u6307\u793a\u662f\u8fdb\u5165 Admin CP \u4e2d \"\u8bba\u575b\" \u4e0b\u7684 \"\u8282\u70b9\" \u9875\u9762\uff0c\u7f16\u8f91\u4e00\u4e2a\u73b0\u6709\u7684\u8bba\u575b\u3002 \u73b0\u5728\u5e94\u8be5\u4f1a\u51fa\u73b0\u6211\u4eec\u65b0\u6dfb\u52a0\u7684\u6a21\u677f\u4fee\u6539\u3002","title":"\u4fee\u6539\u8bba\u575b\u7f16\u8f91\u8868\u5355"},{"location":"lets-build-an-add-on/#_7","text":"\u6211\u4eec\u6709\u4e86 column\uff0c\u6709\u4e86\u4e00\u4e2a UI \u6765\u4f20\u9012 input \u5230\u8be5 column\uff0c\u73b0\u5728\u6211\u4eec\u5fc5\u987b\u5904\u7406\u4fdd\u5b58\u6570\u636e\u5230\u8be5 column\u3002 \u6211\u4eec\u5c06\u901a\u8fc7\u7ee7\u627f\u8bba\u575b Controller \u548c\u7ee7\u627f\u4e00\u4e2a\u7279\u6b8a\u7684\u65b9\u6cd5\u6765\u5b9e\u73b0\u8fd9\u4e2a\u76ee\u7684\uff0c\u5f53\u4e00\u4e2a\u8282\u70b9\u53ca\u5176\u6570\u636e\u88ab\u4fdd\u5b58\u65f6\uff0c\u8be5\u65b9\u6cd5\u5c06\u88ab\u8c03\u7528\u3002 \u9996\u5148\uff0c\u8ba9\u6211\u4eec\u521b\u5efa\u4e00\u4e2a \"Class extension\"\uff0c\u5b83\u53ef\u4ee5\u5728 Admin CP \u7684 \"\u5f00\u53d1\" \u6761\u76ee\u4e0b\u627e\u5230\u3002 \u70b9\u51fb \"\u6dfb\u52a0 Class extension\"\u3002 \u5728\u8fd9\u91cc\uff0c\u6211\u4eec\u9700\u8981\u6307\u5b9a\u4e00\u4e2a \"\u7236\u7c7b\u540d\u79f0\"\uff0c\u4e5f\u5c31\u662f\u6211\u4eec\u8981\u7ee7\u627f\u7684 class \u540d\u79f0\uff0c\u5728\u672c\u4f8b\u4e2d\u662f XF\\Admin\\Controller\\Forum \u3002 \u5e76\u4e14\u6211\u4eec\u9700\u8981\u6307\u5b9a\u4e00\u4e2a \"\u7ee7\u627f class \u540d\u79f0\"\uff0c\u4e5f\u5c31\u662f\u7ee7\u627f\u7236\u7c7b\u7684 class\u3002 \u8f93\u5165 Demo\\Portal\\XF\\Admin\\Controller\\Forum \u3002 \u6211\u4eec\u5e94\u8be5\u5728\u70b9\u51fb\u4fdd\u5b58\u4e4b\u524d\u521b\u5efa\u8fd9\u4e2a class\u3002 \u5728 src/addons/Demo/Portal/XF/Admin/Controller \u4e2d\u521b\u5efa\u4e00\u4e2a\u65b0\u6587\u4ef6\uff0c\u547d\u540d\u4e3a Forum.php \u3002 \u8fd9\u53ef\u80fd\u770b\u8d77\u6765\u8c61\u4e00\u4e2a\u5f88\u957f\u7684\u8def\u5f84\uff0c\u4f46\u6211\u4eec\u5efa\u8bae\u7ee7\u627f class \u4f7f\u7528\u8fd9\u6837\u7684\u8def\u5f84\u3002 \u5b83\u53ef\u4ee5\u8ba9\u4f60\u66f4\u5bb9\u6613\u5730\u8bc6\u522b\u51fa\u4ee3\u8868\u7ee7\u627f class \u7684\u6587\u4ef6\uff0c\u56e0\u4e3a\u5b83\u4eec\u5728\u4e00\u4e2a\u4e0e\u7ee7\u627f\u7684 \"add-on\" ID (\u672c\u4f8b\u4e2d\u4e3a XF ) \u540c\u540d\u7684\u76ee\u5f55\u4e2d\u3002 \u5b83\u8fd8\u53ef\u4ee5\u6e05\u695a\u5730\u8bf4\u660e\u5230\u5e95\u662f\u54ea\u4e2a class \u88ab\u7ee7\u627f\u4e86\uff0c\u56e0\u4e3a\u76ee\u5f55\u7ed3\u6784\u4e0e\u9ed8\u8ba4 class \u7684\u8def\u5f84\u76f8\u540c\u3002 \u5f53\u524d\uff0c\u6587\u4ef6\u7684\u5185\u5bb9\u5e94\u8be5\u662f\u8fd9\u6837\u7684\uff1a <?php namespace Demo\\Portal\\XF\\Admin\\Controller; class Forum extends XFCP_Forum { } \u66f4\u591a\u4fe1\u606f\u8bf7\u53c2\u89c1 \u7ee7\u627f\u7c7b \u548c \u7c7b\u578b\u63d0\u793a \u3002 \u70b9\u51fb\u4fdd\u5b58\uff0c\u4fdd\u5b58 Class extension\u3002 \u73b0\u5728\u6211\u4eec\u53ef\u4ee5\u6dfb\u52a0\u4e00\u4e9b\u4ee3\u7801\u4e86\u3002 \u6211\u4eec\u9700\u8981\u7ee7\u627f\u7684\u7279\u5b9a\u65b9\u6cd5\u662f\u4e00\u4e2a\u540d\u4e3a saveTypeData \u7684 protected \u51fd\u6570\u3002 \u5f53\u7ee7\u627f\u4efb\u4f55\u7c7b\u4e2d\u73b0\u6709\u7684\u65b9\u6cd5\u65f6\uff0c\u68c0\u67e5\u539f\u59cb\u65b9\u6cd5\u662f\u5f88\u91cd\u8981\u7684\uff0c\u539f\u56e0\u6709\u51e0\u4e2a\u3002 \u7b2c\u4e00\u4e2a\u539f\u56e0\u662f\u6211\u4eec\u8981\u786e\u4fdd\u6211\u4eec\u5728\u7ee7\u627f\u65b9\u6cd5\u4e2d\u4f7f\u7528\u7684\u53c2\u6570\u4e0e\u6211\u4eec\u8981\u7ee7\u627f\u7684\u65b9\u6cd5\u76f8\u5339\u914d\u3002 \u7b2c\u4e8c\u4e2a\u539f\u56e0\u662f\uff0c\u6211\u4eec\u9700\u8981\u77e5\u9053\u8fd9\u4e2a\u65b9\u6cd5\u5b9e\u9645\u4e0a\u662f\u505a\u4ec0\u9ebd\u7684\u3002 \u4f8b\u5982\uff0c\u8fd9\u4e2a\u65b9\u6cd5\u5e94\u8be5\u8fd4\u56de\u67d0\u4e2a\u7279\u5b9a\u7c7b\u578b\u7684\u4e1c\u897f\uff0c\u8fd8\u662f\u67d0\u4e2a\u7269\u4ef6\uff1f \u8fd9\u5728\u5927\u591a\u6570 Controller action \u4e2d\u80af\u5b9a\u662f\u8fd9\u6837\u7684\uff0c\u6211\u4eec\u5728 \u4fee\u6539 Controller action \u56de\u5e94\uff08properly\uff09 \u4e00\u8282\u4e2d\u63d0\u5230\u8fc7\u3002 \u7136\u800c\uff0c\u867d\u7136\u8fd9\u4e2a\u65b9\u6cd5\u662f\u5728\u4e00\u4e2a Controller \u5185\uff0c\u4f46\u5b9e\u9645\u4e0a\u5b83\u672c\u8eab\u5e76\u4e0d\u662f\u4e00\u4e2a Controller action\u3002 \u4e8b\u5b9e\u4e0a\uff0c\u8fd9\u4e2a\u65b9\u6cd5\u662f\u4e00\u4e2a \"void\" \u65b9\u6cd5\uff1b\u5b83\u4e0d\u9700\u8981\u8fd4\u56de\u4efb\u4f55\u4e1c\u897f\u3002 \u7136\u800c\uff0c\u6211\u4eec\u5e94\u8be5\u59cb\u7ec8\u786e\u4fdd\u6211\u4eec\u5728\u7ee7\u627f\u65b9\u6cd5\u4e2d\u8c03\u7528\u7236\u7c7b\u65b9\u6cd5\uff0c\u6240\u4ee5\u6211\u4eec\u53ea\u9700\u6dfb\u52a0\u65b0\u65b9\u6cd5\u672c\u8eab\uff0c\u800c\u4e0d\u9700\u8981\u6dfb\u52a0\u65b0\u7684\u4ee3\u7801\uff1a protected function saveTypeData(FormAction $form, \\XF\\Entity\\Node $node, \\XF\\Entity\\AbstractNode $data) { parent::saveTypeData($form, $node, $data); } Warning \u6b64\u7279\u5b9a\u65b9\u6cd5\u7684\u53c2\u6570\u8868\u8868\u5047\u5b9a\u6211\u4eec\u6709\u4e00\u4e2a use \u58f0\u660e\uff0c\u5b83\u5c06\u5b8c\u6574\u7684 \\XF\\Mvc\\FormAction \u7c7b\u522b\u540d\u4e3a\u7b80\u5358\u7684 FormAction \u3002 \u56e0\u6b64\u4f60\u9700\u8981\u81ea\u5df1\u6dfb\u52a0\u90a3\u4e2a use \u58f0\u660e\u3002 \u5728 namespace \u548c class \u884c\u4e4b\u95f4\u6dfb\u52a0 use XF\\Mvc\\FormAction; \u3002 \u6240\u4ee5\uff0c\u73b0\u5728\uff0c\u6211\u4eec\u5df2\u7ecf\u7ee7\u627f\u4e86\u90a3\u4e2a\u65b9\u6cd5\uff0c\u800c\u6211\u4eec\u7684\u7ee7\u627f\u5e94\u8be5\u88ab\u8c03\u7528\uff0c\u4f46\u73b0\u5728\u5b83\u9664\u4e86\u8c03\u7528\u5b83\u7684\u7236\u7c7b\u65b9\u6cd5\u5916\uff0c\u6ca1\u6709\u505a\u4efb\u4f55\u4e8b\u60c5\u3002 \u73b0\u5728\u6211\u4eec\u9700\u8981\u4ece\u8bba\u575b\u7f16\u8f91\u9875\u9762\u83b7\u53d6\u8f93\u5165\u503c\uff0c\u5e76\u5c06\u5176\u5957\u7528\u5230 $data \u5b9e\u4f53\uff08\u5728\u672c\u4f8b\u4e2d\u662f\u8bba\u575b\u5b9e\u4f53\uff09\u3002 protected function saveTypeData(FormAction $form, \\XF\\Entity\\Node $node, \\XF\\Entity\\AbstractNode $data) { parent::saveTypeData($form, $node, $data); $form->setup(function() use ($data) { $data->demo_portal_auto_feature = $this->filter('demo_portal_auto_feature', 'bool'); }); } \u4f7f\u7528 FormAction \u7269\u4ef6\u5141\u8bb8\u6211\u4eec\u5728\u5178\u578b\u7684\u8868\u5355\u63d0\u4ea4\u8fc7\u7a0b\u4e2d\uff0c\u5177\u6709\u5404\u79cd\u4e0d\u540c\u7684 extension points \u5230\u8fdb\u7a0b\u4e2d\u8fd0\u884c\u3002 \u5e76\u4e0d\u662f\u6240\u6709\u7684 Controller action \u90fd\u53ef\u4ee5\u4f7f\u7528\u3002 \u4f8b\u5982\uff0c\u5b83\u5728 Admin CP \u4e2d\u66f4\u4e3a\u666e\u904d\uff0c\u5b83\u901a\u5e38\u9075\u5faa\u7b80\u5358\u7684 CRUD \u6a21\u578b\uff08\u6dfb\u52a0\u3001\u67e5\u627e\u3001\u4fee\u6539\u3001\u5220\u9664\uff09\u3002 XF \u4e2d\u7684\u8bb8\u591a\u5176\u4ed6\u8fdb\u7a0b\u90fd\u53d1\u751f\u5728 Service \u7269\u4ef6\u5185\uff0cService \u7269\u4ef6\u901a\u5e38\u6709\u4e0e\u6b63\u5728\u8fd0\u884c\u7684\u670d\u52a1\u76f8\u5173\u7279\u5b9a extension points\u3002 FormAction \u7269\u4ef6\u7684\u8fd9\u79cd\u7279\u6b8a\u7528\u6cd5\u4e0e\u4f60\u901a\u5e38\u4f1a\u9047\u5230\u7684\u60c5\u51b5\u6709\u4e9b\u4e0d\u540c\u3002 \u4fdd\u5b58\u4e00\u4e2a\u8282\u70b9\u662f\u4e2a\u6709\u4e9b\u4e0d\u540c\u7684\u8fdb\u7a0b\uff0c\u56e0\u4e3a\u9664\u4e86\u4e0e\u8282\u70b9\u5b9e\u4f53\u4e00\u8d77\u8fd0\u4f5c\u5916\uff0c\u4f60\u8fd8\u4f1a\u4e0e\u76f8\u5173\u7684\u8282\u70b9\u7c7b\u578b\u4e00\u8d77\u8fd0\u4f5c\uff0c\u4f8b\u5982\u4e00\u4e2a\u8bba\u575b Entity\u3002 \u4e0d\u8fc7\u5728\u8fd9\u4e2a\u65b9\u6cd5\u4e2d\uff0c\u6211\u4eec\u786e\u5b9e\u53ef\u4ee5\u8bbf\u95ee\u8868\u5355 action \u7269\u4ef6\uff0c\u6240\u4ee5\u6211\u4eec\u5e94\u8be5\u4f7f\u7528\u5b83\u3002 \u6211\u4eec\u5728\u8fd9\u91cc\u4f7f\u7528\u5b83\u6765\u4e3a\u8fdb\u7a0b\u7684 \"\u8bbe\u7f6e\" \u9636\u6bb5\u6dfb\u52a0\u4e00\u4e2a\u7279\u5b9a\u7684\u884c\u4e3a\u3002 \u4e5f\u5c31\u662f\u8bf4\uff0c\u5f53\u8c03\u7528 FormAction \u7269\u4ef6\u7684 run() \u65b9\u6cd5\u65f6\uff0c\u5b83\u5c06\u6309\u7167\u7279\u5b9a\u7684\u987a\u5e8f\u8fd0\u884c\u5404\u4e2a\u9636\u6bb5\u3002 \u4e0d\u7ba1\u8fd9\u4e9b\u884c\u4e3a\u662f\u4ee5\u54ea\u79cd\u987a\u5e8f\u6dfb\u52a0\u5230\u7269\u4ef6\u4e2d\u7684\uff0c\u5b83\u4eec\u4ecd\u7136\u4f1a\u6309\u7167 setup \u3001 validate \u3001 apply \u3001 complete \u7684\u987a\u5e8f\u8fd0\u884c\u3002 \u901a\u8fc7\u4e0a\u9762\u7684\u4ee3\u7801\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u8bba\u575b Entity \u4e2d\u7684 demo_portal_auto_feature column \u8bbe\u7f6e\u4e3a\u6211\u4eec\u6dfb\u52a0\u5230\u8bba\u575b\u7f16\u8f91\u9875\u9762\u7684 demo_portal_auto_feature \u8f93\u5165\u5b58\u50a8\u7684\u4efb\u4f55\u503c\u3002 \u73b0\u5728\u5e94\u8be5\u53ef\u4ee5\u6d4b\u8bd5\u6240\u6709\u8fd9\u4e9b\u5de5\u4f5c\u4e86\u3002 \u53ea\u9700\u7f16\u8f91\u60a8\u9009\u62e9\u7684\u8bba\u575b\u5e76\u52fe\u9009 checkbox\u3002 \u4f60\u5e94\u8be5\u53ef\u4ee5\u89b3\u5bdf\u5230\u4e24\u4ef6\u4e8b\u3002 \u9996\u5148\uff0c\u5f53\u4f60\u56de\u5230\u7f16\u8f91\u90a3\u4e2a\u8bba\u575b\u65f6\uff0ccheckbox \u73b0\u5728\u5e94\u8be5\u88ab\u52fe\u9009\u4e86\u3002 \u7b2c\u4e8c\uff0c\u5982\u679c\u4f60\u5728 xf_forum \u8d44\u6599\u8868\u4e2d\u67e5\u770b\u4f60\u521a\u521a\u7f16\u8f91\u7684\u8bba\u575b\uff0c demo_portal_auto_feature \u5b57\u6bb5\u73b0\u5728\u5e94\u8be5\u8bbe\u7f6e\u4e3a 1\u3002 \u8bf7\u4fdd\u6301\u8fd9\u4e2a\u503c\uff0c\u56e0\u4e3a\u6211\u4eec\u6700\u7ec8\u4f1a\u81ea\u52a8\u7cbe\u9009\u8be5\u8bba\u575b\u7684\u4e3b\u9898\u3002","title":"\u7ee7\u627f\u8bba\u575b\u7684\u4fdd\u5b58\u8fc7\u7a0b"},{"location":"lets-build-an-add-on/#_8","text":"\u6211\u4eec\u5df2\u7ecf\u5728\u8bba\u575b Entity \u4e2d\u6dfb\u52a0\u4e86\u4e00\u4e2a\u65b0\u7684 column\uff0c\u8fd9\u5c06\u5141\u8bb8\u6211\u4eec\u5728\u8bba\u575b\u4e2d\u65b0\u521b\u5efa\u4e00\u4e2a\u4e3b\u9898\u65f6\u81ea\u52a8\u8fdb\u884c\u7cbe\u9009\u4ecb\u7ecd\uff0c\u6240\u4ee5\u73b0\u5728\u662f\u65f6\u5019\u6dfb\u52a0\u4ee3\u7801\u6765\u5b9e\u73b0\u8fd9\u4e2a\u529f\u80fd\u4e86\u3002 \u5728 XF2 \u4e2d\uff0c\u6211\u4eec\u5927\u91cf\u4f7f\u7528 Service \u7269\u4ef6\u3002 \u8fd9\u4e9b\u7269\u4ef6\u901a\u5e38\u91c7\u7528 \"setup and go\" \u7c7b\u578b\u7684\u65b9\u6cd5\uff1b\u4f60\u8bbe\u7f6e\u4f60\u7684\u914d\u7f6e\uff0c\u7136\u540e\u8c03\u7528\u4e00\u4e2a\u65b9\u6cd5\u6765\u5b8c\u6210\u52a8\u4f5c\u3002 \u6211\u4eec\u4f7f\u7528 Service \u7269\u4ef6\u6765\u8bbe\u7f6e\u548c\u5b8c\u6210\u4e3b\u9898\u521b\u5efa\uff0c\u6240\u4ee5\u8fd9\u662f\u4e00\u4e2a\u5b8c\u7f8e\u7684\u4f4d\u7f6e\u6765\u6dfb\u52a0\u6211\u4eec\u9700\u8981\u7684\u4ee3\u7801\u3002 \u8fd9\u4e00\u5207\u90fd\u8981\u4ece\u53e6\u4e00\u4e2a Class extension \u5f00\u59cb\uff0c\u6240\u4ee5\u8fdb\u5165 \"\u6dfb\u52a0 Class extension\" \u9875\u9762\u3002 \u8fd9\u4e00\u6b21\uff0c\u57fa\u7c7b\u4f1a\u662f XF\\Service\\Thread\\Creator \uff0c\u7ee7\u627f\u7c7b\u5219\u662f Demo\\Portal\\XF\\Service\\Thread\\Creator \uff0c\u548c\u5f80\u5e38\u4e00\u6837\uff0c\u8fd9\u4e2a\u65b0 class \u5c06\u770b\u8d77\u6765\u8c61\u4e0b\u9762\u7684\u4ee3\u7801\u3002 \u5728\u8def\u5f84 src/addons/Demo/Portal/XF/Service/Thread/Creator.php \u4e2d\u521b\u5efa\u8be5\u4ee3\u7801\uff0c\u7136\u540e\u70b9\u51fb \"\u4fdd\u5b58\" \u6765\u521b\u5efa\u7ee7\u627f\u7c7b\u3002 <?php namespace Demo\\Portal\\XF\\Service\\Thread; class Creator extends XFCP_Creator { } \u5728\u8fd9\u91cc\uff0c\u6211\u4eec\u8fd8\u5c06\u521b\u5efa\u53e6\u4e00\u4e2a\u7ee7\u627f\u7c7b\u3002 \u57fa\u7840\u7c7b\u662f XF\\Pub\\Controller\\Forum \uff0c\u7ee7\u627f\u7c7b\u662f Demo\\Portal\\XF\\Pub\\Controller\\Forum \u3002 \u5728\u8def\u5f84 src/addons/Demo/Portal/XF/Pub/Controller/Forum.php \u4e2d\u521b\u5efa\u4ee5\u4e0b\u4ee3\u7801\uff0c\u5e76\u70b9\u51fb \"\u4fdd\u5b58\"\uff1a <?php namespace Demo\\Portal\\XF\\Pub\\Controller; class Forum extends XFCP_Forum { } \u6211\u4eec\u6700\u7ec8\u5c06\u5728\u88ab\u7ee7\u627f\u7684\u4e3b\u9898\u4f5c\u8005\u7269\u4ef6\u4e2d\u7ee7\u627f _save() \u65b9\u6cd5\uff0c\u8fd9\u6837\u6211\u4eec\u5c31\u53ef\u4ee5\u5728\u521b\u5efa\u4e3b\u9898\u540e\u5bf9\u5176\u8fdb\u884c\u7cbe\u9009\u3002 \u4e3a\u4e86\u914d\u5408 \"setup and go\" \u7684\u65b9\u9488\uff0c\u6211\u4eec\u5c06\u521b\u5efa\u4e00\u4e2a\u65b9\u6cd5\uff0c\u5b83\u53ef\u4ee5\u7528\u6765\u6307\u793a\u4e3b\u9898\u662f\u5426\u5e94\u8be5\u88ab\u521b\u5efa\u4e3a\u7cbe\u9009\uff0c\u6216\u8005\u4e0d\u5e94\u8be5\u3002 \u4e3a\u6b64\uff0c\u6211\u4eec\u9700\u8981\u4e24\u6837\u4e1c\u897f\uff1a\u4e00\u4e2a\u662f\u7528\u6765\u4fdd\u5b58 value \u7684 class \u5c5e\u6027\uff08\u9ed8\u8ba4\u4e3a null \uff09\u548c\u4e00\u4e2a\u5141\u8bb8\u8bbe\u7f6e\u8be5\u5c5e\u6027\u7684 public \u65b9\u6cd5\u3002 protected $featureThread; public function setFeatureThread($featureThread) { $this->featureThread = $featureThread; } \u56de\u5230\u6211\u4eec\u65b0\u7ee7\u627f\u7684\u8bba\u575b Controller\uff0c\u6211\u4eec\u73b0\u5728\u5c06\u7ee7\u627f\u8bbe\u7f6e creator \u670d\u52a1\u7684\u65b9\u6cd5\uff0c\u5982\u679c\u8bba\u575b Entity \u6709\u5fc5\u8981\u7684\u8bbe\u7f6e\u503c\uff0c\u5219\u9009\u62e9\u52a0\u5165\u7cbe\u9009\u3002 \u8bf7\u8bb0\u4f4f\uff0c\u5728\u7ee7\u627f\u4e00\u4e2a\u65b9\u6cd5\u4e4b\u524d\uff0c\u6211\u4eec\u9700\u8981\u77e5\u9053\u5b83\u9884\u8ba1\u4f1a\u8fd4\u56de\u4ec0\u9ebd\uff08\u5982\u679c\u6709\u7684\u8bdd\uff09\uff0c\u5e76\u786e\u4fdd\u6211\u4eec\u8c03\u7528\u7236\u7c7b\u65b9\u6cd5\u3002 \u5982\u679c\u7236\u7c7b\u65b9\u6cd5\u786e\u5b9e\u8fd4\u56de\u4e86\u4e9b\u4ec0\u9ebd\uff0c\u90a3\u9ebd\u6211\u4eec\u5e94\u8be5\u5728\u4ee3\u7801\u5b8c\u6210\u540e\u8fd4\u56de\u8fd9\u4e2a\u65b9\u6cd5\u3002 \u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c setupThreadCreate() \u65b9\u6cd5\u4f1a\u8fd4\u56de\u8bbe\u7f6e\u597d\u7684 creator \u670d\u52a1\uff0c\u6240\u4ee5\u6211\u4eec\u5c06\u6309\u7167\u4ee5\u4e0b\u65b9\u5f0f\u5f00\u59cb\uff1a protected function setupThreadCreate(\\XF\\Entity\\Forum $forum) { /** @var \\Demo\\Portal\\XF\\Service\\Thread\\Creator $creator */ $creator = parent::setupThreadCreate($forum); return $creator; } \u6b63\u5982\u9884\u671f\u7684\u90a3\u6837\uff0c\u8fd9\u5b9e\u9645\u4e0a\u5e76\u6ca1\u6709\u505a\u4efb\u4f55\u4e8b\u60c5\uff1b\u7ee7\u627f\u7684\u4ee3\u7801\u88ab\u8c03\u7528\u4e86\uff0c\u4f46\u5b83\u6240\u505a\u7684\u53ea\u662f\u8fd4\u56de\u7236\u7c7b\u8c03\u7528\u6240\u8fd4\u56de\u7684\u5185\u5bb9\u3002 \u73b0\u5728\u6211\u4eec\u5e94\u8be5\u4fee\u6539 $creator \u6765\u8bbe\u7f6e\u7cbe\u9009\uff0c\u5982\u679c\u5b83\u9002\u7528\u4e8e\u6211\u4eec\u5f53\u524d\u6b63\u5728\u4f7f\u7528\u7684\u8bba\u575b\u3002 \u5728 $creator \u884c\u548c return \u884c\u4e4b\u95f4\u52a0\u4e0a\uff1a if ($forum->demo_portal_auto_feature) { $creator->setFeatureThread(true); } \u73b0\u5728\u6211\u4eec\u53ef\u4ee5\u5728\u7ee7\u627f\u7684 creator \u7c7b\u4e2d\u6dfb\u52a0 _save() \u65b9\u6cd5\uff1a protected function _save() { $thread = parent::_save(); return $thread; } \u4e3a\u4e86\u786e\u4fdd\u8fd9\u6761\u4e3b\u9898\u88ab\u7cbe\u9009\uff0c\u5728 $thread \u884c\u548c return \u884c\u4e4b\u95f4\uff0c\u6211\u4eec\u53ea\u9700\u8981\u6dfb\u52a0\uff1a if ($this->featureThread && $thread->discussion_state == 'visible') { /** @var \\Demo\\Portal\\Entity\\FeaturedThread $featuredThread */ $featuredThread = $thread->getRelationOrDefault('FeaturedThread'); $featuredThread->save(); $thread->fastUpdate('demo_portal_featured', true); } \u56e0\u4e3a\u6211\u4eec\u4e4b\u524d\u5728\u4e3b\u9898 Entity \u4e0a\u521b\u5efa\u4e86 FeaturedThread \u5173\u8054\uff0c\u6240\u4ee5\u5b9e\u9645\u4e0a\u6211\u4eec\u4e5f\u53ef\u4ee5\u4f7f\u7528\u8fd9\u4e2a\u5173\u8054\u6765\u521b\u5efa\uff01 \u6211\u4eec\u5728\u8fd9\u91cc\u4f7f\u7528\u4e86\u4e00\u4e2a\u540d\u4e3a getRelationOrDefault() \u7684\u65b9\u6cd5\u3002 \u5b83\u5c06\u67e5\u770b\u8be5\u5173\u8054\u662f\u5426\u5b9e\u9645\u8fd4\u56de\u4e00\u4e2a\u73b0\u6709\u7684\u8bb0\u5f55\uff0c\u5982\u679c\u6ca1\u6709\uff0c\u5b83\u5c06\u521b\u5efa\u8be5 Entity \u5e76\u4f7f\u7528\u4efb\u4f55\u9ed8\u8ba4\u503c\uff08\u5305\u62ec\u4e3b\u9898ID\uff09\u5bf9\u5176\u8fdb\u884c\u8bbe\u7f6e\uff01 \u8fd9\u610f\u5473\u7740\u6211\u4eec\u5b9e\u9645\u4e0a\u9700\u8981\u505a\u7684\u53ea\u662f\u83b7\u53d6\u9ed8\u8ba4\u7684\u5173\u8054\uff0c\u5e76\u5c06\u5176\u4fdd\u5b58\u4e0b\u6765\u63d2\u5165\u5230\u6570\u636e\u5e93\u4e2d\u3002 \u6b64\u5916\uff0c\u6211\u4eec\u5e94\u8be5\u5c06 demo_portal_featured \u5b57\u6bb5\u8bbe\u7f6e\u4e3a true\u3002 \u56e0\u4e3a\u4e3b\u9898 Entity \u5df2\u7ecf\u88ab\u4fdd\u5b58\u4e86\uff08\u5f53\u539f class \u4fdd\u5b58 Entity \u65f6\uff09\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 fastUpdate() \u65b9\u6cd5\u6765\u5feb\u901f\u4fee\u6539\u8be5\u5b57\u6bb5\u3002 \u6211\u4eec\u73b0\u5728\u9700\u8981\u5c1d\u8bd5\u8fd9\u4e00\u5207\uff0c\u5e76\u786e\u4fdd\u5b83\u80fd\u6b63\u5e38\u8fd0\u4f5c\u3002 \u524d\u5f80\u60a8\u4e4b\u524d\u6fc0\u6d3b\u4e86 demo_portal_auto_feature \u9009\u9879\u7684\u8bba\u575b\uff0c\u5e76\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u4e3b\u9898\u3002 \u73b0\u5728\u552f\u4e00\u7684\u65b9\u6cd5\u5c31\u662f\u68c0\u67e5 xf_demo_portal_featured_thread \u8d44\u6599\u8868\uff0c\u5728\u90a3\u91cc\u6211\u4eec\u5e94\u8be5\u53ef\u4ee5\u770b\u5230\u4e00\u6761\u65b0\u7684\u8bb0\u5f55\u3002","title":"\u8bbe\u7f6e\u4e3b\u9898\u81ea\u52a8\u663e\u793a"},{"location":"lets-build-an-add-on/#portal","text":"\u5728\u6211\u4eec\u5b8c\u6210\u4e4b\u524d\uff0c\u8fd8\u6709\u76f8\u5f53\u591a\u7684\u5de5\u4f5c\u8981\u505a\uff0c\u4f46\u73b0\u5728\u6211\u4eec\u5df2\u7ecf\u6709\u4e86\u7cbe\u9009\u4e3b\u9898\u7684\u80fd\u529b\uff0c\u5982\u679c\u6211\u4eec\u80fd\u5728\u67d0\u4e2a\u5730\u65b9\u663e\u793a\u5b83\u4eec\uff0c\u5f53\u7136\u4f1a\u5f88\u597d\uff0c\u6240\u4ee5\u8ba9\u6211\u4eec\u5f00\u59cb\u521b\u5efa\u6211\u4eec\u7684\u5165\u53e3\u9875\u9762\u3002 \u8981\u505a\u5230\u8fd9\u4e00\u70b9\uff0c\u6211\u4eec\u9700\u8981\u65b0\u5efa\u4e00\u6761 Public \u8def\u7531\u3002 \u8fdb\u5165 Admin CP\uff0c\u5728 \"\u5f00\u53d1\" \u4e0b\u70b9\u51fb \"\u8def\u7531\"\uff0c\u7136\u540e\u70b9\u51fb \"\u6dfb\u52a0\u8def\u7531\uff1a Public\"\u3002 \u6211\u4eec\u6682\u65f6\u5148\u628a\u4e8b\u60c5\u7b80\u5358\u5316\u3002 \u8def\u7531\u7684\u524d\u7f00\u662f \"portal\"\uff0cSection context \u662f \"home\"\uff0cController \u662f \"Demo\\Portal:Portal\"\u3002 \u73b0\u5728\u6211\u4eec\u5e94\u8be5\u5728\u8def\u5f84 src/addons/Demo/Portal/Pub/Controller/Portal.php \u4e2d\u521b\u5efa Controller\uff0c\u57fa\u672c\u5185\u5bb9\u5982\u4e0b\uff1a <?php namespace Demo\\Portal\\Pub\\Controller; class Portal extends \\XF\\Pub\\Controller\\AbstractController { } \u6211\u4eec\u5e0c\u671b\u5f53\u4eba\u4eec\u8bbf\u95ee index.php?portal \u9875\u9762\u65f6\uff0c\u6211\u4eec\u7684 portal \u9875\u9762\u4f1a\u663e\u793a\u5728\u4ed6\u4eec\u9762\u524d\u3002 \u8fd9\u4e2a URL \u6ca1\u6709 \"action\" \u90e8\u5206 - \u53ea\u6709\u6211\u4eec\u521a\u521a\u521b\u5efa\u7684\u8def\u7531\u524d\u7f00\u3002 \u8003\u8651\u5230\u8fd9\u4e00\u70b9\uff0c\u6211\u4eec\u9700\u8981\u5728 actionIndex() \u65b9\u6cd5\u4e2d\u6dfb\u52a0\u663e\u793a portal \u9875\u9762\u7684\u4ee3\u7801\u3002 \u6211\u4eec\u5728\u5176\u4e2d\u9700\u8981\u7684\u57fa\u672c\u4ee3\u7801\u662f\uff1a public function actionIndex() { $viewParams = []; return $this->view('Demo\\Portal:View', 'demo_portal_view', $viewParams); } \u73b0\u5728\uff0c\u8fd9\u8fd8\u4e0d\u80fd\u5b8c\u5168\u6b63\u5e38\u8fd0\u4f5c\uff0c\u56e0\u4e3a\u6211\u4eec\u8fd8\u6ca1\u6709\u521b\u5efa\u6a21\u677f\uff0c\u4f46\u8fd9\u5df2\u7ecf\u8db3\u591f\u4e86\uff0c\u81f3\u5c11\u8bc1\u660e\u4e86\u6211\u4eec\u7684 Route \u548c Controller \u662f\u76f8\u4e92\u6c9f\u901a\u7684\u3002 \u6240\u4ee5\u8bbf\u95ee index.php?portal \u81f3\u5c11\u5e94\u8be5\u663e\u793a '\u6a21\u677f\u9519\u8bef'\u3002 \u6b63\u5982\u5728 View \u56de\u5e94 \u4e00\u8282\u4e2d\u63d0\u5230\u7684\uff0c\u7b2c\u4e00\u4e2a\u53c2\u6570\u662f\u4e00\u4e2a View class\uff0c\u4f46\u6211\u4eec\u5e76\u4e0d\u9700\u8981\u5b9e\u9645\u521b\u5efa\u8fd9\u4e2a\u7c7b\u3002 \u5982\u679c\u6709\u5fc5\u8981\uff0c\u8fd9\u4e2a class \u53ef\u4ee5\u7531\u5176\u4ed6\u9644\u52a0\u7ec4\u4ef6\u7ee7\u627f\uff0c\u5373\u4f7f\u5b83\u4e0d\u5b58\u5728\u3002 \u7b2c\u4e8c\u4e2a\u53c2\u6570\u662f\u6a21\u677f\uff0c\u6211\u4eec\u73b0\u5728\u9700\u8981\u5728\u8def\u5f84 src/addons/Demo/Portal/_output/templates/public/demo_portal_view.html \u4e2d\u521b\u5efa\u8fd9\u4e2a\u6a21\u677f\u3002 \u5f53\u524d\uff0c\u8fd9\u4e2a\u6a21\u677f\u5e94\u8be5\u7b80\u5358\u5730\u5305\u542b\u4ee5\u4e0b\u5185\u5bb9\u3002 <xf:title>Portal</xf:title> \u5982\u679c\u6211\u4eec\u73b0\u5728\u8bbf\u95ee portal \u9875\u9762\uff0c\u6a21\u677f\u9519\u8bef\u5c31\u4f1a\u6d88\u5931\uff0c\u867d\u7136\u6211\u4eec\u4ecd\u7136\u4f1a\u6709\u4e00\u4e2a\u770b\u8d77\u6765\u76f8\u5f53\u7a7a\u767d\u7684\u9875\u9762\uff0c\u4f46\u81f3\u5c11\u73b0\u5728\u4f1a\u6709 \"Portal\" \u6807\u9898\u3002 \u73b0\u5728\uff0c\u662f\u65f6\u5019\u5f00\u59cb\u6dfb\u52a0\u4ee3\u7801\u4e86\uff0c\u5b83\u5c06\u663e\u793a\u7cbe\u9009\u4e3b\u9898\u7684\u5217\u8868\u3002 \u7b2c\u4e00\u6b65\u662f\u4e3a\u6211\u4eec\u5e38\u89c1\u7684\u4e00\u4e9b\u57fa\u7840 Finder \u67e5\u627e\u521b\u5efa\u4e00\u4e2a repository\u3002 \u56e0\u6b64\uff0c\u5728\u8def\u5f84 src/addons/Demo/Portal/Repository/FeaturedThread.php \u4e2d\u521b\u5efa\u4e00\u4e2a\u65b0\u6587\u4ef6\uff0c\u5e76\u6dfb\u52a0\u4ee5\u4e0b\u4ee3\u7801\u3002 <?php namespace Demo\\Portal\\Repository; use XF\\Mvc\\Entity\\Finder; use XF\\Mvc\\Entity\\Repository; class FeaturedThread extends Repository { /** * @return Finder */ public function findFeaturedThreadsForPortalView() { $visitor = \\XF::visitor(); $finder = $this->finder('Demo\\Portal:FeaturedThread'); $finder ->setDefaultOrder('featured_date', 'DESC') ->with('Thread', true) ->with('Thread.User') ->with('Thread.Forum', true) ->with('Thread.Forum.Node.Permissions|' . $visitor->permission_combination_id) ->with('Thread.FirstPost', true) ->with('Thread.FirstPost.User') ->where('Thread.discussion_type', '<>', 'redirect') ->where('Thread.discussion_state', 'visible'); return $finder; } } \u6211\u4eec\u5728\u8fd9\u91cc\u505a\u7684\u662f\u4f7f\u7528 finder \u67e5\u627e\u6240\u6709\u7684\u7cbe\u9009\u4e3b\u9898\uff0c\u6309\u7167\u76f8\u53cd\u7684 featured_date \u987a\u5e8f\uff0cjoin \u5230 xf_thread \u8d44\u6599\u8868\uff0c\u5e76\u4ece\u8be5\u8d44\u6599\u8868 join \u5230\u4e3b\u9898\u521b\u5efa\u8005\u7684 xf_user \u8d44\u6599\u8868\u3001 xf_forum \u8d44\u6599\u8868\u3001 xf_post \u8d44\u6599\u8868\uff0c\u7136\u540e\u518d\u4ece\u90a3\u91cc join \u5230 xf_user \u8d44\u6599\u8868\uff0c\u91cd\u65b0\u521b\u5efa\u5e16\u5b50\u8d44\u6599\u8868\u3002 \u6211\u4eec\u901a\u8fc7\u6307\u5b9a\u53c2\u6570 true \u6765\u786e\u5b9a\u4e3b\u9898\u3001\u8bba\u575b\u548c\u7b2c\u4e00\u4e2a\u5e16\u5b50\u5fc5\u987b\u5b58\u5728\uff0c\u6240\u4ee5\u8fd9\u4e9b\u5c06\u4ee5 INNER JOIN \u7684\u65b9\u5f0f\u8fd0\u884c\uff0c\u800c\u7528\u6237\u67e5\u627e\u5c06\u4ee5 LEFT JOIN \u7684\u65b9\u5f0f\u8fd0\u884c\u3002 \u6709\u4e9b\u4e3b\u9898\u548c\u5e16\u5b50\u7684\u4f5c\u8005\u53ef\u80fd\u4e0d\u5b58\u5728\uff08\u4f8b\u5982\uff0c\u5982\u679c\u5b83\u4eec\u662f\u7531 RSS feed \u7cfb\u7edf\u81ea\u52a8\u53d1\u5e03\u7684\uff0c\u6216\u7531\u8bbf\u5ba2\u53d1\u5e03\u7684\uff09\u3002 \u6211\u4eec\u5728\u8fd9\u91cc\u8fd8\u6709\u4e00\u4e2a\u7279\u6b8a\u7684 join\uff0c\u53ef\u4ee5\u5728\u67e5\u627e\u7684\u540c\u65f6\u83b7\u53d6\u5f53\u524d\u8bbf\u95ee\u8005\u7684\u6743\u9650\u3002 \u8fd9\u5c06\u51cf\u5c11\u55a7\u67d3 portal \u9875\u9762\u6240\u9700\u7684\u67e5\u627e\u6b21\u6570\uff0c\u56e0\u4e3a\u6211\u4eec\u5c06\u505a\u4e00\u4e9b\u4e8b\u60c5\uff08\u4e4b\u540e\uff09\uff0c\u53ea\u5411\u6709\u6743\u9650\u67e5\u770b\u7684\u7528\u6237\u663e\u793a\u7cbe\u9009\u4e3b\u9898\u3002 \u8fd9\u5e76\u4e0d\u80fd\u8fd4\u56de\u8fd9\u4e2a\u67e5\u627e\u7684\u7ed3\u679c\u3002 \u8fd9\u5c06\u8fd4\u56de Finder \u7269\u4ef6\u672c\u8eab\u3002 \u8fd9\u6837\u5c31\u53ef\u4ee5\u5728\u5176\u4ed6\u9644\u52a0\u7ec4\u4ef6\u9700\u8981\u7ee7\u627f\u6211\u4eec\u7684\u4ee3\u7801\u65f6\uff0c\u6709\u4e00\u4e2a\u660e\u786e\u7684 extension point\uff0c\u540c\u65f6\u4e5f\u5141\u8bb8\u6211\u4eec\u5728\u83b7\u53d6\u6570\u636e\u4e4b\u524d\u505a\u8fdb\u4e00\u6b65\u7684\u4fee\u6539\uff08\u4f8b\u5982\u4e3a\u5206\u9875\u8bbe\u7f6e\u4e00\u4e2a limit/offset\uff0c\u6216\u8005\u8bbe\u7f6e\u4e0d\u540c\u7684\u6392\u5e8f\uff09\u3002 \u73b0\u5728\u8ba9\u6211\u4eec\u5728 Portal Controller \u7684 actionIndex() \u65b9\u6cd5\u4e2d\u4f7f\u7528\u5b83\u3002 \u5c06\u73b0\u6709\u7684\u8fd9\u4e00\u884c $viewParams = []; \u6539\u4e3a\u5982\u4e0b\uff1a /** @var \\Demo\\Portal\\Repository\\FeaturedThread $repo */ $repo = $this->repository('Demo\\Portal:FeaturedThread'); $finder = $repo->findFeaturedThreadsForPortalView(); $viewParams = [ 'featuredThreads' => $finder->fetch() ]; \u5728\u8fd9\u4e2a\u9636\u6bb5\uff0c\u6211\u4eec\u4e0d\u6253\u7b97\u62c5\u5fc3\u4fee\u6539\u6211\u4eec\u4ece repo \u4e2d\u68c0\u7d22\u5230\u7684\u57fa\u7840 finder\u3002 \u76f8\u53cd\uff0c\u6211\u4eec\u5f00\u59cb\u5b9e\u9645\u770b\u5230\u4e00\u4e9b\u7ed3\u679c\uff0c\u5e76\u66f4\u65b0 demo_portal_view \u6a21\u677f\u5982\u4e0b\uff08\u5728 <xf:title> \u6807\u7b7e\u4e4b\u540e\uff09\uff1a <xf:if is=\"$featuredThreads is not empty\"> <xf:foreach loop=\"$featuredThreads\" value=\"$featuredThread\"> <xf:macro name=\"thread_block\" arg-thread=\"{$featuredThread.Thread}\" arg-post=\"{$featuredThread.Thread.FirstPost}\" arg-featuredThread=\"{$featuredThread}\" /> </xf:foreach> <xf:else /> <div class=\"blockMessage\">\u5f53\u524d\u8fd8\u6ca1\u6709\u4efb\u4f55\u5e16\u5b50\u88ab\u7cbe\u9009\u3002</div> </xf:if> <xf:macro name=\"thread_block\" arg-thread=\"!\" arg-post=\"!\" arg-featuredThread=\"!\"> <xf:css src=\"message.less\" /> <div class=\"block\"> <div class=\"block-container\" data-xf-init=\"lightbox\"> <h4 class=\"block-header\"><a href=\"{{ link('threads', $thread) }}\">{$thread.title}</a></h4> <div class=\"block-body\"> <xf:macro name=\"message\" arg-post=\"{$post}\" arg-thread=\"{$thread}\" arg-featuredThread=\"{$featuredThread}\" /> </div> <div class=\"block-footer\"> <a href=\"{{ link('threads', $thread) }}\">\u7ee7\u7eed\u9605\u8bfb...</a> </div> </div> </div> </xf:macro> <xf:macro name=\"message\" arg-post=\"!\" arg-thread=\"!\" arg-featuredThread=\"!\"> <div class=\"message message--post message--simple\"> <div class=\"message-inner\"> <div class=\"message-cell message-cell--main\"> <div class=\"message-content js-messageContent\"> <div class=\"message-attribution\"> <div class=\"contentRow contentRow--alignMiddle\"> <div class=\"contentRow-figure\"> <xf:avatar user=\"{$post.User}\" size=\"xxs\" defaultname=\"{$post.username}\" href=\"\" /> </div> <div class=\"contentRow-main contentRow-main--close\"> <ul class=\"listInline listInline--bullet u-muted\"> <li><xf:username user=\"{$thread.User}\" /></li> <li><xf:date time=\"{$featuredThread.featured_date}\" /></li> <li><a href=\"{{ link('forums', $thread.Forum) }}\">{$thread.Forum.title}</a></li> <li>{{ phrase('replies:') }} {$thread.reply_count|number}</li> </ul> </div> </div> </div> <div class=\"message-userContent lbContainer js-lbContainer\" data-lb-id=\"post-{$post.post_id}\" data-lb-caption-desc=\"{{ $post.User ? $post.User.username : $post.username }} &middot; {{ date_time($post.post_date) }}\" > <blockquote class=\"message-body\"> {{ bb_code($post.message, 'post', $post.User, { 'attachments': $post.attach_count ? $post.Attachments : [], 'viewAttachments': $thread.canViewAttachments() }) }} </blockquote> </div> </div> </div> </div> </div> </xf:macro> \u73b0\u5728\uff0c\u6211\u627f\u8ba4\uff0c\u8fd9\u91cc\u6709 \u5f88\u591a \u7684\u5185\u5bb9\u3002 \u867d\u7136\u5b83\u53ef\u80fd\u770b\u8d77\u6765\u4ee4\u4eba\u751f\u754f\uff0c\u4f46\u5b83\u4e3b\u8981\u662f\u4ee5\u5408\u7406\u7684\u98ce\u683c\u6765\u663e\u793a\u6211\u4eec\u7684\u7cbe\u9009\u4e3b\u9898\u7684\u6807\u8bb0\u3002 \u4e0d\u8fc7\u6709\u51e0\u4ef6\u4e8b\u503c\u5f97\u6ce8\u610f\u3002 \u6211\u4eec\u7528\u4e00\u4e2a\u6761\u4ef6\u5f00\u59cb\u6a21\u677f\uff0c\u8fd9\u4e2a\u6761\u4ef6\u662f <xf:if is=\"$featuredThreads is not empty\"> \u3002 \u8fd9\u662f\u4e3a\u4e86\u68c0\u67e5 finder \u8fd4\u56de\u7684\u7269\u4ef6\u662f\u5426\u771f\u7684\u5305\u542b\u7cbe\u9009\u4e3b\u9898\u8bb0\u5f55\u3002 \u5982\u679c\u4e0d\u5305\u542b\uff0c\u6211\u4eec\u5c06\u663e\u793a\u4e00\u4e2a\u9002\u5f53\u7684\u6d88\u606f\u3002 \u5982\u679c\u786e\u5b9e\u6709\u4e00\u4e9b\u8bb0\u5f55\uff0c\u6211\u4eec\u9700\u8981\u5faa\u73af\u6d4f\u89c8\u6bcf\u4e00\u6761\u8bb0\u5f55\u6765\u663e\u793a\u5b83\u3002 \u5bf9\u4e8e\u6bcf\u6761\u8bb0\u5f55\uff0c\u6211\u4eec\u8c03\u7528\u4e00\u4e2a macro \u3002 \u5de8\u96c6\u662f\u6a21\u677f\u4ee3\u7801\u4e2d\u53ef\u91cd\u590d\u4f7f\u7528\u7684\u90e8\u5206\uff0c\u5b83\u662f\u81ea\u884c\u8bb0\u5f55\u7684\uff08\u4f60\u53ef\u4ee5\u770b\u5230\u54ea\u4e9b\u53c2\u6570\u662f\u652f\u63f4\u7684\uff09\uff0c\u5e76\u4fdd\u6301\u81ea\u5df1\u7684\u4f5c\u7528\u57df\uff0c\u4e0d\u80fd\u88ab\u8c03\u7528\u5de8\u96c6\u6a21\u677f\u4e2d\u7684\u53c2\u6570\u6240\u6c61\u67d3\uff1b\u8fd9\u610f\u5473\u7740\u5de8\u96c6\u53ea\u77e5\u9053\u660e\u786e\u4f20\u9012\u8fdb\u6765\u7684\u53c2\u6570\u548c\u5168\u57df\u7684 $xf \u53c2\u6570\u3002 \u4e3b\u9898\u533a\u5757\u5de8\u96c6\u663e\u793a\u7cbe\u9009\u4e3b\u9898\u7684\u57fa\u672c\u533a\u5757\uff0c\u7136\u540e\u8c03\u7528\u53e6\u4e00\u4e2a\u5de8\u96c6\u6765\u663e\u793a\u6bcf\u4e2a\u6d88\u606f\u3002","title":"\u521b\u5efa Portal \u9875\u9762"},{"location":"lets-build-an-add-on/#_9","text":"\u4f60\u53ef\u80fd\u5df2\u7ecf\u53d1\u73b0\uff0c\u5728\u8bbe\u7f6e\u8def\u5f84\u65f6\uff0c\u6211\u4eec\u5c06 Section context \u6307\u5b9a\u4e3a \"\u4e3b\u9875\"\uff0c\u5f53\u4f60\u8bbf\u95ee portal \u9875\u9762\u65f6\uff0c\u4e3b\u9875\u6807\u7b7e\u88ab\u9009\u4e2d\uff0c\u6216\u8005\u5982\u679c\u5728\u9009\u9879\u4e2d\u6ca1\u6709\u8bbe\u7f6e homePageUrl \uff0c\u4f60\u53ef\u80fd\u6839\u672c\u4e0d\u4f1a\u770b\u5230\u4e3b\u9875\u6807\u7b7e\u3002 \u6211\u4eec\u5e0c\u671b\u4f7f\u7528\u9ed8\u8ba4\u7684\u4e3b\u9875\u6807\u7b7e\uff0c\u800c\u4e0d\u662f\u81ea\u5df1\u521b\u5efa\u4e00\u4e2a\u6807\u7b7e\uff0c\u8fd9\u6837\u53ef\u80fd\u4f1a\u6709\u4e00\u4e2a\u91cd\u590d\u7684\u6807\u7b7e\u3002 \u8981\u505a\u5230\u8fd9\u4e00\u70b9\uff0c\u6211\u4eec\u5e94\u8be5\u4f7f\u7528\u4ee3\u7801\u4e8b\u4ef6\u76d1\u542c\u5668\u5c06 URL \u6539\u4e3a\u6211\u4eec\u7684 portal URL\u3002 \u5728 Admin CP \u4e0b\u7684\u5f00\u53d1\u4e2d\u70b9\u51fb \"\u4ee3\u7801\u4e8b\u4ef6\u76d1\u542c\u5668\"\uff0c\u7136\u540e\u70b9\u51fb \"\u6dfb\u52a0\u4ee3\u7801\u4e8b\u4ef6\u76d1\u542c\u5668\"\u3002 \u76d1\u542c\u4e8b\u4ef6 home_page_url \uff0ccallback class \u53c8\u4f1a\u662f Demo\\Portal\\Listener \uff0c\u8fd9\u6b21\u7684\u65b9\u6cd5\u547d\u540d\u4e3a homePageUrl \u3002 \u8fd9\u4e2a\u65b0\u65b9\u6cd5\u7684\u4ee3\u7801\u5e94\u8be5\u76f8\u5f53\u7b80\u5358\uff1a public static function homePageUrl(&$homePageUrl, \\XF\\Mvc\\Router $router) { $homePageUrl = $router->buildLink('canonical:portal'); } \u6700\u540e\uff0c\u6211\u4eec\u5e94\u8be5\u8003\u8651\u66f4\u6539\u6211\u4eec portal \u9875\u9762\u7684\u9996\u9875\u8def\u5f84\u3002 \u8fdb\u5165 Admin CP\uff0c\u5728\u8bbe\u7f6e\u4e0b\u70b9\u51fb\u9009\u9879\uff0c\u7136\u540e\u70b9\u51fb \"\u57fa\u672c\u677f\u5757\u4fe1\u606f\"\u3002 \u5c06 \"\u9996\u9875\u8def\u5f84\" \u9009\u9879\u6539\u4e3a portal/ \u3002 \u5f53\u4f60\u5728 Admin CP \u4e2d\u65f6\uff0c\u6765\u770b\u770b\u5f53\u4f60\u70b9\u51fb Header \u7684\u677f\u5757\u6807\u9898\u65f6\uff0c\u4f1a\u53d1\u751f\u4ec0\u9ebd\u3002 \u8fd9\u5e94\u8be5\u4f1a\u5e2f\u4f60\u5230\u4f60\u7684\u9996\u9875\u3002 \u4e00\u5207\u6b63\u5e38\uff0c\u90a3\u4e2a\u9996\u9875\u73b0\u5728\u5e94\u8be5\u662f\u4f60\u7684 portal \u9875\u9762\u4e86\uff01 \u9664\u6b64\u4e4b\u5916\uff0c\u4e3b\u9875\u6807\u7b7e\u5e94\u8be5\u662f\u53ef\u89c1\u7684\uff0c\u5e76\u4e14\u88ab\u9009\u4e2d\u4e86\u3002 \u4f5c\u4e3a\u53ef\u9009\u6b65\u9aa4\uff0c\u4f60\u53ef\u4ee5\u9009\u62e9\u5728\u4e3b\u9875\u6807\u7b7e\u4e0b\u6dfb\u52a0\u4e00\u4e9b\u989d\u5916\u7684\u5bfc\u89c8\u6761\u76ee\u3002 \u4e0d\u8fc7\uff0c\u73b0\u5728\u8ba9\u6211\u4eec\u5148\u7ee7\u7eed\u5f80\u4e0b\u3002","title":"\u5b9e\u4f5c\u5bfc\u89c8\u6807\u7b7e"},{"location":"lets-build-an-add-on/#_10","text":"\u6240\u4ee5\uff0c\u6211\u4eec\u53ef\u4ee5\u81ea\u52a8\u7cbe\u9009\u65b0\u4e3b\u9898\u3002 \u90a3\u9ebd\u624b\u52a8\u663e\u793a\u73b0\u6709\u7684\u4e3b\u9898\u5462\uff1f \u6216\u8005\u662f\u5728\u521b\u5efa\u8fc7\u7a0b\u4e2d\uff0c\u5728\u4e0d\u652f\u63f4\u81ea\u52a8\u7cbe\u9009\u7684\u60c5\u51b5\u4e0b\uff0c\u624b\u52a8\u7cbe\u9009\u4e3b\u9898\uff1f \u8fd9\u5c06\u662f\u4e00\u4e2a\u5f88\u597d\u7684\u65b9\u6cd5\uff0c\u8ba9\u6211\u4eec\u5f53\u524d\u7684 portal \u9875\u9762\u770b\u8d77\u6765\u66f4\u5fd9\u788c\u3002 \u4e3a\u4e86\u8fbe\u5230\u8fd9\u4e2a\u76ee\u7684\uff0c\u6211\u4eec\u5c06\u5728\u4e00\u4e2a\u7279\u5b9a\u7684\u5de8\u96c6\u4e2d\u6dfb\u52a0\u4e00\u4e2a\u6a21\u677f\u4fee\u6539\uff0c\u8fd9\u4e2a\u5de8\u96c6\u5b9e\u9645\u4e0a\u662f\u5728\u4e3b\u9898\u56de\u8986\u3001\u4e3b\u9898\u7f16\u8f91\u548c\u521b\u5efa\u4e3b\u9898\u65f6\u4f7f\u7528\u7684\u3002 \u8fd9\u5c06\u7275\u6d89\u5230\u7ee7\u627f\u7f16\u8f91\u5668\u670d\u52a1\uff0c\u5e76\u5bf9\u5904\u7406\u81ea\u52a8\u7cbe\u9009\u7684\u73b0\u6709\u4ee3\u7801\u8fdb\u884c\u4fee\u6539\u3002 \u7b2c\u4e00\u6b65\u5c31\u662f\u65b0\u5efa\u6a21\u677f\u4fee\u6539\u3002 \u8fdb\u5230 \"\u6dfb\u52a0\u6a21\u677f\u4fee\u6539\"\uff08\u786e\u4fdd\u5728 \"\u6a21\u677f\u4fee\u6539\" \u5217\u8868\u4e2d\u9009\u62e9 \"Public\" \u6807\u7b7e\uff09\u3002 \u8fd9\u6b21\u6211\u4eec\u8981\u4fee\u6539\u7684\u6a21\u677f\u662f helper_thread_options \uff0c\u6211\u4eec\u7528 demo_portal_helper_thread_options \u4f5c\u4e3a key\uff0c\u4f60\u53ef\u4ee5\u5199\u4e00\u4e2a\u5408\u7406\u7684\u63cf\u8ff0\u3002 \u5b9e\u9645\u4e0a\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u8fd9\u91cc\u505a\u4e00\u4e2a \"\u7b80\u5358\u66ff\u6362\"\uff0c\u6240\u4ee5\u8bf7\u9009\u4e2d\u8fd9\u4e2a\u5358\u9009\u6309\u94ae\uff0c\u5e76\u5728 \"\u67e5\u627e\" \u5b57\u6bb5\u4e2d\u586b\u4e0a\uff1a <xf:if is=\"$thread.canLockUnlock()\"> \u5728 \"\u66ff\u6362\" \u5b57\u6bb5\u4e2d\u586b\u4e0a\uff1a <xf:if is=\"($thread.isInsert() AND !$thread.Forum.demo_portal_auto_feature AND $thread.canFeatureUnfeature()) OR ($thread.isUpdate() && $thread.canFeatureUnfeature())\" > <xf:option label=\"{{ phrase('demo_portal_featured') }}\" name=\"featured\" value=\"1\" selected=\"{$thread.demo_portal_featured}\"> <xf:hint>{{ phrase('demo_portal_featured_hint') }}</xf:hint> <xf:afterhtml> <xf:hiddenval name=\"_xfSet[featured]\" value=\"1\" /> </xf:afterhtml> </xf:option> </xf:if> $0 \u8fd9\u4e2a\u6761\u4ef6\u5224\u65ad\u6709\u70b9\u504f\u957f\u4e86\uff0c\u4f46\u5b83\u5141\u8bb8\u6211\u4eec\u5728\u4e24\u4e2a\u7279\u5b9a\u7684\u6761\u4ef6\u4e0b\u663e\u793a\u7cbe\u9009 checkbox\uff1a a)\u5982\u679c\u5e16\u5b50\u8fd8\u6ca1\u6709\u521b\u5efa\uff0c\u5e76\u4e14\u8bba\u575b\u7684\u81ea\u52a8\u7cbe\u9009\u9009\u9879\u88ab\u5173\u95ed\uff0c\u5e76\u4e14\u6709\u7cbe\u9009\u7684\u6743\u9650\uff0c\u6216\u8005 b)\u5b83\u662f\u4e00\u4e2a\u5df2\u7ecf\u5b58\u5728\u7684\u5e16\u5b50\uff0c\u5e76\u4e14\u6709 \u7cbe\u9009/\u975e\u7cbe\u9009 \u7684\u6743\u9650\u3002 \u4e00\u4e2a\u5feb\u901f\u7684 \"\u6d4b\u8bd5\" \u5e94\u8be5\u4f1a\u663e\u793a\u8fd9\u4e2a\u9644\u52a0\u7684\u4ee3\u7801\u5c06\u88ab\u63d2\u5165\u5230\u73b0\u6709\u7684 <xf:checkboxrow> \u4e2d \"\u6253\u5f00\" checkbox \u4e0a\u65b9\u3002 \u5982\u679c\u8fd9\u4e00\u5207\u770b\u8d77\u6765\u90fd\u6b63\u5e38\uff0c\u5c31\u70b9\u51fb \"\u4fdd\u5b58\"\u3002 \u6211\u4eec\u4e0d\u5f97\u4e0d\u5728\u8fd9\u91cc\u76f4\u63a5\u5728\u4fee\u6539\u4e2d\u4f7f\u7528\u6a21\u677f\u4ee3\u7801\uff0c\u56e0\u4e3a\u5728\u5df2\u7ecf\u5b58\u5728\u7684 input \u6216 row \u6807\u7b7e\u4e2d\u52a0\u5165\u4e00\u4e2a\u6a21\u677f\uff08\u8c61\u6211\u4eec\u4e4b\u524d\u505a\u7684\u90a3\u6837\uff09\u8fd9\u6837\u662f\u4f1a\u65e0\u6cd5\u8fd0\u4f5c\u7684\u3002 \u6211\u4eec\u73b0\u5728\u8fd8\u9700\u8981\u4e3a\u6807\u7b7e\u548c\u63d0\u793a\u521b\u5efa\u77ed\u8bed\uff0c\u56e0\u4e3a\u4ee5\u540e\u5c06\u65e0\u6cd5\u68c0\u6d4b\u5230\u8fd9\u4e9b\u4e86\u3002 \u5728 \"\u5916\u89b3\" \u4e0b\u8fdb\u5165 \"\u77ed\u8bed\" \u5e76\u70b9\u51fb \"\u6dfb\u52a0\u77ed\u8bed\"\u3002 \u786e\u4fdd\u4f60\u7684\u9644\u52a0\u7ec4\u4ef6\u88ab\u9009\u4e2d\u3002 \u7b2c\u4e00\u4e2a\u77ed\u8bed\u7684 \"Title\" \u5c06\u662f \"demo_portal_featured\"\uff0c\u6587\u672c\u5c06\u662f\u7b80\u5358\u7684 \"\u7cbe\u9009\"\u3002 \u70b9\u51fb \"\u4fdd\u5b58\u5e76\u9000\u51fa\"\u3002 \u518d\u6b21\u70b9\u51fb \"\u6dfb\u52a0\u77ed\u8bed\"\u3002 \u7b2c\u4e8c\u4e2a\u77ed\u8bed\u7684 \"\u6807\u9898\" \u4f1a\u662f \"demo_portal_featured_hint\"\uff0c\u6587\u672c\u4f1a\u662f \"\u7cbe\u9009\u4e3b\u9898\u5c06\u51fa\u73b0\u5728 Portal \u9875\u9762\"\u3002 \u56de\u5230\u6211\u4eec\u521a\u521a\u6dfb\u52a0\u4fee\u6539\u7684\u6a21\u677f\u4ee3\u7801\uff0c\u4f60\u53ef\u80fd\u5df2\u7ecf\u6ce8\u610f\u5230\u4e86\u4e00\u4e9b\u4e8b\u60c5\u3002 \u6211\u4eec\u5728\u4e3b\u9898 Entity \u4e0a\u8c03\u7528\u4e86\u4e00\u4e2a\u65b9\u6cd5\uff0c canFeatureUnfeature() \uff0c\u800c\u8fd9\u4e2a\u65b9\u6cd5\u8fd8\u4e0d\u5b58\u5728\u3002 \u6211\u4eec\u6700\u7ec8\u8981\u7528\u8fd9\u4e2a\u6765\u505a\u4e00\u4e2a\u6743\u9650\u68c0\u67e5\uff0c\u63a7\u5236\u7528\u6237\u662f\u5426\u53ef\u4ee5\u624b\u52a8\u5bf9\u4e00\u4e2a\u4e3b\u9898\u8fdb\u884c\u7cbe\u9009\u64cd\u4f5c\u3002 \u4e3a\u4e86\u6dfb\u52a0\u8fd9\u4e2a\u65b9\u6cd5\uff0c\u6211\u4eec\u9700\u8981\u4e3a XF\\Entity\\Thread Entity \u65b0\u5efa\u4e00\u4e2a Class extension\u3002 \u6240\u4ee5\uff0c\u73b0\u5728\u5c31\u8c61\u6211\u4eec\u4e4b\u524d\u505a\u7684\u90a3\u6837\u505a\u3002 \u7ee7\u627f class \u5c06\u662f Demo\\Portal\\XF\\Entity\\Thread \uff0c\u6240\u4ee5\u5728\u8def\u5f84 src/addons/Demo/Portal/XF/Entity/Thread.php \u4e2d\u521b\u5efa\u8fd9\u4e2a class\uff0c\u5185\u5bb9\u5982\u4e0b\uff1a <?php namespace Demo\\Portal\\XF\\Entity; class Thread extends XFCP_Thread { public function canFeatureUnfeature() { return true; } } \u597d\u5427\uff0c\u6240\u4ee5\uff0c\u6211\u4eec\u5e76\u6ca1\u6709\u5728\u8fd9\u91cc\u505a\u592a\u591a\u6709\u4ef7\u503c\u7684\u4e8b\u60c5\u3002 canFeatureUnfeature() \u65b9\u6cd5\u73b0\u5728\u6240\u505a\u7684\u5c31\u662f\u8fd4\u56de true \u3002 \u4ee5\u540e\uff0c\u6211\u4eec\u4f1a\u5b9e\u4f5c\u4e00\u4e9b\u9002\u5f53\u7684\u6743\u9650\uff0c\u5e76\u5728\u8fd9\u91cc\u6dfb\u52a0\u3002 \u6d4b\u8bd5\u4e00\u4e0b\u5f53\u524d\u7684\u6548\u679c\uff0c\u6253\u5f00\u4f60\u4e4b\u524d\u7cbe\u9009\u7684\u4e00\u4e2a\u4e3b\u9898\uff0c\u5728\u5de5\u5177\u9009\u5358\u4e2d\u9009\u62e9 \"\u7f16\u8f91\u4e3b\u9898\"\u3002 \u6211\u4eec\u5e94\u8be5\u770b\u5230 \"\u8bbe\u7f6e\u4e3b\u9898\u72b6\u6001\" checkbox row \u6709\u6211\u4eec\u6dfb\u52a0\u7684 \"\u7cbe\u9009\" checkbox\uff0c\u800c\u4e14\u5e94\u8be5\u662f\u52fe\u9009\u7684\uff0c\u8bf4\u660e\u8fd9\u4e2a\u4e3b\u9898\u786e\u5b9e\u662f\u5177\u6709\u7cbe\u9009\u7684\u3002 \u6211\u4eec\u73b0\u5728\u53ef\u4ee5\u7ee7\u7eed\u6539\u53d8\u4e3b\u9898\u7f16\u8f91\u5668\u670d\u52a1\u6765\u5bfb\u627e\u8fd9\u4e2a\u503c\uff0c\u5e76\u76f8\u5e94\u5730\u8fdb\u884c\u7cbe\u9009\u6216\u53d6\u6d88\u7cbe\u9009\u3002 \u4e3a\u6b64\u6211\u4eec\u9700\u8981\u4e24\u4e2a\u65b0\u7684 Class extensions\u3002 \u56de\u5230 \"Class extensions\" \u9875\u9762\u3002 \u7b2c\u4e00\u4e2a\u5c06\u6709\u4e00\u4e2a\u57fa\u7c7b XF\\Pub\\Controller\\Thread \u548c\u7ee7\u627f\u7c7b Demo\\Portal\\XF\\Pub\\Controller\\Thread \u3002 \u7b2c\u4e8c\u4e2a\u5c06\u6709\u4e00\u4e2a XF\\Service\\Thread\\Editor \u7684\u57fa\u7c7b\u548c\u4e00\u4e2a Demo\\Portal\\XF\\Service\\Thread\\Editor \u7684\u7ee7\u627f\u7c7b\u3002 \u7f16\u8f91\u5668\u670d\u52a1\u5176\u5b9e\u8981\u548c\u6211\u4eec\u4e4b\u524d\u521b\u5efa\u7684\u7ee7\u627f creator \u670d\u52a1\u975e\u5e38\u76f8\u4f3c\uff0c\u6240\u4ee5\u5728\u76f8\u5173\u4f4d\u7f6e\u521b\u5efa\u3002 \u4e0b\u9762\u662f\u7ee7\u627f\u7c7b\u7684\u6240\u6709\u4ee3\u7801\uff1a <?php namespace Demo\\Portal\\XF\\Service\\Thread; class Editor extends XFCP_Editor { protected $featureThread; public function setFeatureThread($featureThread) { $this->featureThread = $featureThread; } protected function _save() { $thread = parent::_save(); if ($this->featureThread !== null && $thread->discussion_state == 'visible') { /** @var \\Demo\\Portal\\Entity\\FeaturedThread $featuredThread */ $featuredThread = $thread->getRelationOrDefault('FeaturedThread', false); if ($this->featureThread) { if (!$featuredThread->exists()) { $featuredThread->save(); $thread->fastUpdate('demo_portal_featured', true); } } else { if ($featuredThread->exists()) { $featuredThread->delete(); $thread->fastUpdate('demo_portal_featured', false); } } } return $thread; } } \u8fd9\u6bd4 creator \u670d\u52a1\u4e2d\u7684\u4ee3\u7801\u8981\u590d\u6742\u4e00\u4e9b\u3002 \u4f8b\u5982\uff0c\u6709\u53ef\u80fd\u4f1a\u51fa\u73b0\u8fd9\u6837\u7684\u60c5\u51b5\uff0c\u4e00\u4e2a\u4e3b\u9898\u88ab\u7f16\u8f91\u4e86\uff0c\u800c\u7528\u6237\u6ca1\u6709\u7f16\u8f91\u8be5\u4e3b\u9898\u7684\u6743\u9650\uff0c\u56e0\u6b64\u6211\u4eec\u4e0d\u663e\u793a checkbox\u3002 \u5728\u8fd9\u4e9b\u60c5\u51b5\u4e0b\uff0c\u6211\u4eec\u4e0d\u5e0c\u671b\u81ea\u52a8\u8ba4\u4e3a\u8be5\u4e3b\u9898\u5e94\u8be5\u662f\u65e0\u7cbe\u9009\u7684\u3002 \u7531\u4e8e\u7c7b $featureThread \u5c5e\u6027\u7684\u9ed8\u8ba4\u503c\u662f null \uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u8fd9\u4e2a\u5c5e\u6027\uff0c\u8fd9\u6837\u672c\u8d28\u4e0a\u8be5\u5c5e\u6027\u6709\u4e09\u79cd\u72b6\u6001\u3002 \u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c null \u8868\u793a \"\u6ca1\u6709\u53d8\u5316\"\uff0c true \u8868\u793a\u6211\u4eec\u5bf9\u8be5\u4e3b\u9898\u8fdb\u884c\u4e86\u7cbe\u9009\u8bbe\u7f6e\uff0c false \u8868\u793a\u6211\u4eec\u53d6\u6d88\u4e86\u5b83\u7684\u7cbe\u9009\u3002 \u5728\u975e\u7cbe\u9009\u5316\u7684\u60c5\u51b5\u4e0b\uff0c\u6211\u4eec\u5b9e\u9645\u4e0a\u53ea\u662f\u901a\u8fc7\u8c03\u7528 delete() \u65b9\u6cd5\u6765\u5220\u9664\u7cbe\u9009\u4e3b\u9898 Entity\u3002 \u5728\u8fd9\u4e24\u79cd\u60c5\u51b5\u4e0b\uff0c\u6211\u4eec\u518d\u6b21\u4f7f\u7528 fastUpdate() \u65b9\u6cd5\u66f4\u65b0\u4e3b\u9898 Entity \u4e2d\u7684\u7f13\u5b58\u503c\uff0c\u4ee5\u8868\u793a\u5f53\u524d\u7684\u7cbe\u9009\u72b6\u6001\u3002 \u5728\u5b8c\u6210\u7f16\u8f91\u8fc7\u7a0b\u4e4b\u524d\uff0c\u6211\u4eec\u9700\u8981\u4e3a\u6211\u4eec\u7684\u7ee7\u627f\u4e3b\u9898 Controller \u6dfb\u52a0\u4ee3\u7801\uff0c\u7279\u522b\u662f\u7ee7\u627f setupThreadEdit() \u65b9\u6cd5\u3002 \u6574\u4e2a\u7ee7\u627f\u4e3b\u9898 Controller \u7684\u4ee3\u7801\u770b\u8d77\u6765\u5c06\u4f1a\u662f\u8fd9\u6837\uff1a <?php namespace Demo\\Portal\\XF\\Pub\\Controller; class Thread extends XFCP_Thread { public function setupThreadEdit(\\XF\\Entity\\Thread $thread) { /** @var \\Demo\\Portal\\XF\\Service\\Thread\\Editor $editor */ $editor = parent::setupThreadEdit($thread); $canFeatureUnfeature = $thread->canFeatureUnfeature(); if ($canFeatureUnfeature) { $editor->setFeatureThread($this->filter('featured', 'bool')); } return $editor; } } \u8fd9\u5e94\u8be5\u8db3\u4ee5\u8ba9\u60a8\u7f16\u8f91\u4e00\u4e2a\u4e3b\u9898\uff0c\u5e76\u5c06\u5176\u72b6\u6001\u8bbe\u7f6e\u4e3a\u7cbe\u9009\uff08\u6216\u975e\u7cbe\u9009\uff09\u3002 \u5982\u679c\u60a8\u73b0\u5728\u5c1d\u8bd5\u4e00\u4e0b\uff0c\u60a8\u5e94\u8be5\u53ef\u4ee5\u770b\u5230\u4e3b\u9898\u76f8\u5e94\u5730\u4ece\u60a8\u7684 portal \u9875\u9762\u51fa\u73b0\u548c\u6d88\u5931\u3002 \u6211\u4eec\u9700\u8981\u5728\u4e3b\u9898 Controller \u4e2d\u7ee7\u627f\u53e6\u4e00\u4e2a\u65b9\u6cd5\uff0c\u4ee5\u5904\u7406\u4e3b\u9898\u72b6\u6001\u63a7\u5236\u4e5f\u663e\u793a\u5728\u4e00\u4e9b\u4e3b\u9898\u56de\u8986\u8868\u5355\u4e0a\u7684\u60c5\u51b5\u3002 \u6211\u4eec\u53ea\u9700\u8981\u5728\u4e0a\u9762\u6dfb\u52a0\u7684 setupThreadEdit() \u65b9\u6cd5\u4e0b\u9762\u6dfb\u52a0\u4ee5\u4e0b\u4ee3\u7801\u5373\u53ef\uff1a public function finalizeThreadReply(\\XF\\Service\\Thread\\Replier $replier) { parent::finalizeThreadReply($replier); $setOptions = $this->filter('_xfSet', 'array-bool'); if ($setOptions) { $thread = $replier->getThread(); if ($thread->canFeatureUnfeature() && isset($setOptions['featured'])) { $replier->setFeatureThread($this->filter('featured', 'bool')); } } } \u8bf7\u6ce8\u610f\uff0c\u6211\u4eec\u5728\u8fd9\u4e2a\u65b9\u6cd5\u4e2d\u5e76\u6ca1\u6709\u5b9e\u9645\u8fd4\u56de\u4efb\u4f55\u4e1c\u897f\uff0c\u56e0\u4e3a\u5e76\u4e0d\u671f\u671b\u5b83\u8fd4\u56de\u4efb\u4f55\u4e1c\u897f\u3002 \u6700\u540e\u4e00\u6b65\uff0c\u6211\u4eec\u9700\u8981\u56de\u5230\u8bba\u575b Controller\uff0c\u7a0d\u5fae\u4fee\u6539\u4e00\u4e0b\u6211\u4eec\u73b0\u6709\u7684\u4ee3\u7801\uff0c\u8fd9\u6837\uff0c\u5982\u679c\u7cbe\u9009\u4e0d\u662f\u81ea\u52a8\u7684\uff0c\u6211\u4eec\u53ef\u4ee5\u624b\u52a8\u5904\u7406\u3002 \u8fd9\u5e94\u8be5\u662f\u76f8\u5f53\u76f4\u63a5\u7684\u3002 \u8fdb\u5165\u60a8\u7684\u7ee7\u627f\u8bba\u575b Controller\uff0c\u7136\u540e\u5c06\u66ff\u6362\u8fd9\u4e2a\uff1a if ($forum->demo_portal_auto_feature) { $creator->setFeatureThread(true); } \u6539\u6210\u4e0b\u9762\u8fd9\u6837\uff1a if ($forum->demo_portal_auto_feature) { $creator->setFeatureThread(true); } else { $setOptions = $this->filter('_xfSet', 'array-bool'); if ($setOptions) { $thread = $creator->getThread(); if ($thread->canFeatureUnfeature() && isset($setOptions['featured'])) { $creator->setFeatureThread($this->filter('featured', 'bool')); } } } \u8fd9\u548c\u6211\u4eec\u5df2\u7ecf\u62e5\u6709\u7684\u57fa\u672c\u76f8\u540c\uff0c\u4f8b\u5982\uff0c\u5982\u679c\u8bba\u575b\u5f00\u542f\u4e86\u81ea\u52a8\u7cbe\u9009\uff0c\u90a3\u9ebd\u6211\u4eec\u53ea\u9700\u5c06\u8be5\u4e3b\u9898\u8bbe\u7f6e\u4e3a\u7cbe\u9009\uff0c\u5426\u5219\uff0c\u6211\u4eec\u68c0\u67e5\u662f\u5426\u6709 checkbox\uff0c\u5c31\u8c61\u6211\u4eec\u5bf9\u5176\u4ed6\u60c5\u51b5\u6240\u505a\u7684\u90a3\u6837\uff0c\u5c06\u5176\u8bbe\u7f6e\u4e3a checkbox \u72b6\u6001\u3002 \u6211\u4eec\u73b0\u5728\u5e94\u8be5\u6d4b\u8bd5\u521b\u5efa 3 \u4e2a\u4e3b\u9898\uff0c\u4ee5\u786e\u4fdd\u5176\u8fd0\u4f5c\u6b63\u5e38\u3002 \u7b2c\u4e00\u4e2a\u662f\u5728\u5f00\u542f\u4e86\u81ea\u52a8\u7cbe\u9009\u7684\u8bba\u575b\u4e2d\uff0c\u786e\u4fdd\u5b83\u4ecd\u7136\u6709\u6548\uff0c\u7136\u540e\u662f\u5728\u6ca1\u6709\u5f00\u542f\u81ea\u52a8\u7cbe\u9009\u7684\u8bba\u575b\u4e2d\uff0c\u52fe\u9009 \"\u7cbe\u9009\" checkbox\uff0c\u518d\u52fe\u9009\u5b83\u3002 \u5047\u8bbe\u4e00\u5207\u6b63\u5e38\uff0c\u8ba9\u6211\u4eec\u7ee7\u7eed\u524d\u8fdb\u3002","title":"\u624b\u52a8\u663e\u793a\uff08\u6216\u4e0d\u663e\u793a\uff09\u4e3b\u9898"},{"location":"lets-build-an-add-on/#_11","text":"\u867d\u7136\uff0cportal \u9875\u9762\u770b\u8d77\u6765\u5f88\u5408\u7406\uff0c\u4f46\u6211\u4eec\u53ef\u4ee5\u505a\u5f97\u66f4\u597d\u4e00\u4e9b\u3002 \u9996\u5148\uff0c\u6211\u4eec\u5e94\u8be5\u8c03\u6574\u6211\u4eec\u7684\u4ee3\u7801\uff0c\u4f7f\u6211\u4eec\u53ea\u663e\u793a X \u4e2a\u7279\u8272\u4e3b\u9898\uff0c\u6211\u4eec\u8fd8\u5e94\u8be5\u6dfb\u52a0\u4e00\u4e9b\u9875\u9762\u5bfc\u89c8\u3002 \u5728\u8fd9\u4e00\u70b9\u4e0a\uff0c\u5982\u679c\u4f60\u8fd8\u6ca1\u6709\u7684\u8bdd\uff0c\u53ef\u80fd\u503c\u5f97\u518d\u591a\u7cbe\u9009\u4e00\u4e9b\u4e3b\u9898\uff0c\u8fd9\u6837\u6211\u4eec\u5c31\u53ef\u4ee5\u5b9e\u9645\u6d4b\u8bd5\u5206\u9875\u4e86\uff01 \u9996\u5148\uff0c\u6211\u4eec\u9700\u8981\u56de\u5230\u6211\u4eec\u7684 portal Controller\uff0c\u5e76\u5728 actionIndex() \u65b9\u6cd5\u7684\u9876\u90e8\u6dfb\u52a0\u4e00\u4e9b\u4ee3\u7801\uff1a $page = $this->filterPage(); $perPage = 5; \u8fd9\u91cc\u7684\u7b2c\u4e00\u884c\u662f\u4e00\u4e2a\u7279\u5b9a\u7684 helper \u65b9\u6cd5\uff0c\u7528\u6765\u83b7\u53d6\u5f53\u524d\u7684\u9875\u7801\u3002 \u7b2c\u4e8c\u884c\u662f\u6211\u4eec\u6bcf\u9875\u8981\u52a0\u8f7d\u591a\u5c11\u4e2a\u9879\u76ee\uff0c\u8fd9\u901a\u5e38\u6765\u81ea\u4e00\u4e2a\u9009\u9879\uff0c\u4f46\u6211\u4eec\u73b0\u5728\u5c06\u786c\u5199\u6b7b\u4e3a 5\u3002 \u63a5\u4e0b\u6765\u8981\u505a\u7684\u5c31\u662f\u628a\u8fd9\u4e00\u884c\uff1a $finder = $repo->findFeaturedThreadsForPortalView(); \u4fee\u6539\u6210\u8fd9\u6837\uff1a $finder = $repo->findFeaturedThreadsForPortalView() ->limitByPage($page, $perPage); \u8fd9\u5c31\u6539\u53d8\u4e86\u6211\u4eec\u7684\u67e5\u627e\uff0c\u4f7f\u5b83\u80fd\u6839\u636e\u6211\u4eec\u4e0a\u9762\u5b9a\u4e49\u7684 \u9875/\u6bcf\u9875 \u503c\u8fdb\u884c limit\u3002 \u8fd9\u5c06\u81ea\u52a8\u8ba1\u7b97\u51fa\u5f53\u524d\u9875\u9762\u7684\u6b63\u786e limit ( $perPage ) \u548c offset ( ($page - 1) * $perPage )\u3002 \u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u9700\u8981\u518d\u4f20\u9012\u4e00\u4e9b\u53c2\u6570\u5230\u6211\u4eec\u7684 view \u53c2\u6570\u4e2d\uff0c\u6240\u4ee5\u5c06\u4e0b\u9762\uff1a $viewParams = [ 'featuredThreads' => $finder->fetch() ]; \u6539\u53d8\u6210\uff1a $viewParams = [ 'featuredThreads' => $finder->fetch(), 'total' => $finder->total(), 'page' => $page, 'perPage' => $perPage ]; \u8981\u4f7f\u7528\u663e\u793a\u6211\u4eec\u7684\u9875\u9762\u5bfc\u89c8\uff0c\u6211\u4eec\u9700\u8981\u77e5\u9053\u6761\u76ee\u7684\u603b\u6570\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7 total() \u65b9\u6cd5\u4ece finder \u4e2d\u5f97\u5230\uff0c\u5f53\u524d\u7684\u9875\u7801\u548c\u6211\u4eec\u6bcf\u9875\u663e\u793a\u7684\u6570\u91cf\u3002 \u5982\u679c\u4f60\u56de\u5230 portal\uff0c\u73b0\u5728\u4f60\u4f1a\u770b\u5230\u53ea\u6709 5 \u4e2a\u7cbe\u9009\u4e3b\u9898\u663e\u793a\u3002 \u4e0d\u8fc7\uff0c\u6211\u4eec\u73b0\u5728\u9700\u8981\u6dfb\u52a0\u9875\u9762\u5bfc\u89c8\u3002 \u6240\u4ee5\u6253\u5f00 demo_portal_view \u6a21\u677f\uff0c\u5728 </xf:foreach> \u6807\u7b7e\u540e\u76f4\u63a5\u6dfb\u52a0\u4ee5\u4e0b\u5185\u5bb9\uff1a <xf:pagenav page=\"{$page}\" perpage=\"{$perPage}\" total=\"{$total}\" link=\"portal\" wrapperclass=\"block\" /> \u6b64\u65f6\u91cd\u65b0\u52a0\u8f7d portal \u9875\u9762\uff0c\u53ea\u8981\u4f60\u6709 5 \u4e2a\u4ee5\u4e0a\u7684\u7cbe\u9009\u4e3b\u9898\uff0c\u73b0\u5728\u5c31\u4f1a\u5728\u7cbe\u9009\u4e3b\u9898\u5217\u8868\u7684\u5e95\u90e8\u770b\u5230\u9875\u9762\u5bfc\u89c8\u3002 \u5176\u4ed6\u4e00\u4e9b\u53ef\u80fd\u6709\u52a9\u4e8e\u6539\u5584\u8fd9\u4e2a\u9875\u9762\u7684\u5916\u89b3\u7684\u4e1c\u897f\u662f\u6dfb\u52a0\u4e00\u4e2a\u4fa7\u8fb9\u680f\uff0c\u6216\u8005\u66f4\u51c6\u786e\u5730\u8bf4\uff0c\u4e00\u4e2a\u663e\u793a\u5728\u4fa7\u8fb9\u680f\u7684\u5c0f\u7ec4\u4ef6\u4f4d\u7f6e\u3002 \u5c0f\u7ec4\u4ef6\u4f4d\u7f6e\u662f\u5728 Admin CP\u7684 \"\u5f00\u53d1\" \u4e0b\u6dfb\u52a0\u7684\u3002 \u8fdb\u5165 \"\u5c0f\u7ec4\u4ef6\u4f4d\u7f6e\" \u9875\u9762\uff0c\u70b9\u51fb \"\u6dfb\u52a0\u5c0f\u7ec4\u4ef6\u4f4d\u7f6e\"\u3002 \u8f93\u5165 \"\u4f4d\u7f6e ID\" \u4e3a demo_portal_view_sidebar \uff0c\"Title\" \u4e3a Demo portal view: Sidebar \u548c\u4e00\u4e2a\u9002\u5f53\u7684\u63cf\u8ff0\u3002 \u786e\u4fdd\u4f4d\u7f6e\u5df2\u5f00\u542f\uff0c\u5e76\u9009\u62e9\u4e86\u6b63\u786e\u7684\u9644\u52a0\u7ec4\u4ef6 ID \u540e\uff0c\u70b9\u51fb \"\u4fdd\u5b58\"\u3002 \u8981\u5c06\u8fd9\u4e2a\u4f4d\u7f6e\u6dfb\u52a0\u5230\u6a21\u677f\u4e2d\uff0c\u53ea\u9700\u5728 <xf:title> \u6807\u7b7e\u4e0b\u9762\u6dfb\u52a0\u4ee5\u4e0b\u5185\u5bb9\uff1a <xf:widgetpos id=\"demo_portal_view_sidebar\" position=\"sidebar\" /> \u5f53\u7136\uff0c\u5728\u6ca1\u6709\u6dfb\u52a0\u4e00\u4e9b\u5c0f\u7ec4\u4ef6\u4e4b\u524d\uff0c\u6211\u4eec\u8fd8\u662f\u4e0d\u4f1a\u770b\u5230\u4fa7\u8fb9\u680f\u3002 \u5c0f\u7ec4\u4ef6\u672c\u8eab\u662f\u4e0d\u6307\u6d3e\u7ed9\u9644\u52a0\u7ec4\u4ef6\u7684\uff0c\u6240\u4ee5\u4f60\u4e3a\u8fd9\u4e2a\u4f4d\u7f6e\u521b\u5efa\u7684\u5c0f\u7ec4\u4ef6\uff0c\u5982\u679c\u4f60\u60f3\u5728\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u53d1\u9001\u4e00\u4e9b\u914d\u7f6e\u597d\u7684\u5c0f\u7ec4\u4ef6\uff0c\u5c06\u9700\u8981\u6dfb\u52a0\u5230 Setup class \u4e2d\u3002 \u4e3a\u4e86\u7b80\u5358\u8d77\u89c1\uff0c\u6211\u4eec\u53ea\u9700\u8981\u590d\u5236\u5f53\u524d\u6307\u6d3e\u7ed9 forum_list_sidebar \u4f4d\u7f6e\u7684\u5c0f\u7ec4\u4ef6\uff08\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff09\u3002 \u6240\u4ee5\uff0c\u6211\u4eec\u5c06\u628a\u8fd9\u4e9b\u6dfb\u52a0\u5230 Setup class \u4e2d\u7684\u4e00\u4e2a\u65b0\u7684 installStep4() \u65b9\u6cd5\u4e2d\uff1a public function installStep4() { $this->createWidget('demo_portal_view_members_online', 'members_online', [ 'positions' => ['demo_portal_view_sidebar' => 10] ]); $this->createWidget('demo_portal_view_new_posts', 'new_posts', [ 'positions' => ['demo_portal_view_sidebar' => 20] ]); $this->createWidget('demo_portal_view_new_profile_posts', 'new_profile_posts', [ 'positions' => ['demo_portal_view_sidebar' => 30] ]); $this->createWidget('demo_portal_view_forum_statistics', 'forum_statistics', [ 'positions' => ['demo_portal_view_sidebar' => 40] ]); $this->createWidget('demo_portal_view_share_page', 'share_page', [ 'positions' => ['demo_portal_view_sidebar' => 50] ]); } \u5f53\u7136\uff0c\u522b\u5fd8\u4e86\u81ea\u5df1\u8fd0\u884c\u8fd9\u4e2a\u8bbe\u7f6e\u6b65\u9aa4\uff1a Terminal $ php cmd.php xf-addon:install-step Demo/Portal 4","title":"\u6539\u8fdb\u95e8\u6237\u7f51\u7ad9\u9875\u9762"},{"location":"lets-build-an-add-on/#_12","text":"\u73b0\u5728\uff0c\u6211\u4eec\u5728 portal \u9875\u9762\u4e2d\u663e\u793a\u6240\u6709\u7684\u7cbe\u9009\u4e3b\u9898\uff0c\u4e0d\u7ba1\u8bbf\u95ee\u8005\u662f\u5426\u6709\u6743\u9650\u67e5\u770b\u5b83\u4eec\u3002 \u8fd9\u4e0d\u662f\u5f88\u7406\u60f3\uff1b\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\uff0c\u60a8\u53ef\u80fd\u5e0c\u671b\u5728\u67d0\u4e9b\u53d7\u9650\u5236\u7684\u8bba\u575b\u4e0a\u53d1\u5e03\u4e3b\u9898\uff0c\u5e76\u4e14\u53ea\u8ba9\u90a3\u4e9b\u53ef\u4ee5\u6b63\u5e38\u89c6\u56fe\u8be5\u8bba\u575b\u7684\u7528\u6237\u53ef\u89c1\u3002 \u8981\u505a\u5230\u8fd9\u4e00\u70b9\uff0c\u6211\u4eec\u9700\u8981\u6539\u53d8\u6211\u4eec\u7684\u4ee3\u7801\uff0c\u4ee5\u4fbf\u6211\u4eec \"over-fetch\" \u6211\u4eec\u9700\u8981\u663e\u793a\u7684\u8bb0\u5f55\u6570\u91cf\uff0c\u8fc7\u6ee4\u6389\u4efb\u4f55\u770b\u4e0d\u89c1\u7684\u7ed3\u679c\uff0c\u7136\u540e\u5c06\u7ed3\u679c\u96c6\u5207\u6210\u6211\u4eec\u60f3\u8981\u5728\u6bcf\u9875\u663e\u793a\u7684\u5b9e\u9645\u6570\u91cf\u3002 \u8fd9\u6bd4\u542c\u8d77\u6765\u8981\u7b80\u5358\u4e00\u4e9b\u3002 \u9996\u5148\uff0c\u8bf7\u8fdb\u5165 Portal Controller\uff0c\u5e76\u5c06\u8fd9\u4e00\u884c\uff1a ->limitByPage($page, $perPage); \u66f4\u6539\u6210\u8fd9\u6837\uff1a ->limit($perPage * 3); \u7136\u540e\u4e0b\u9762\u518d\u52a0\u4e0a\uff1a $featuredThreads = $finder->fetch() ->filter(function(\\Demo\\Portal\\Entity\\FeaturedThread $featuredThread) { return ($featuredThread->Thread->canView()); }) ->sliceToPage($page, $perPage); \u6700\u540e\u5c06\u8fd9\u884c\uff1a 'featuredThreads' => $finder->fetch(), \u66f4\u6539\u4e3a\uff1a 'featuredThreads' => $featuredThreads, \u4f60\u53ef\u80fd\u5728\u524d\u9762\u7684 demo_portal_view \u6a21\u677f\u4e2d\u5df2\u7ecf\u53d1\u73b0\uff0c\u6211\u4eec\u5448\u73b0\u7684\u6bcf\u4e00\u7bc7\u6587\u7ae0\u4e5f\u6307\u5b9a\u5176\u9644\u4ef6\uff1a 'attachments': $post.attach_count ? $post.Attachments : [], \u73b0\u5728\uff0c\u8fd9\u5c06\u4e3a\u6bcf\u4e2a\u5e16\u5b50\u751f\u6210\u4e00\u4e2a\u989d\u5916\u7684\u67e5\u627e\u3002 \u6240\u4ee5\uff0c\u6211\u4eec\u5e94\u8be5\u5c1d\u8bd5\u5bf9\u6211\u4eec\u8981\u663e\u793a\u7684\u6240\u6709\u5e16\u5b50\u8fdb\u884c\u4e00\u6b21\u67e5\u627e\uff0c\u5e76\u63d0\u524d\u5c06\u5b83\u4eec\u6dfb\u52a0\u5230\u5e16\u5b50\u4e2d\u3002 \u8fd9\u53ef\u80fd\u542c\u8d77\u6765\u6bd4\u5b9e\u9645\u60c5\u51b5\u66f4\u590d\u6742\u3002 \u53ea\u8981\u5728 ->slice(0, $perPage, true); \u884c\u4e0b\u9762\u6dfb\u52a0\u4ee5\u4e0b\u4ee3\u7801\u5373\u53ef\u3002 $threads = $featuredThreads->pluckNamed('Thread'); $posts = $threads->pluckNamed('FirstPost', 'first_post_id'); /** @var \\XF\\Repository\\Attachment $attachRepo */ $attachRepo = $this->repository('XF:Attachment'); $attachRepo->addAttachmentsToContent($posts, 'post'); \u6211\u4eec\u9996\u5148\u4f7f\u7528 pluckNamed() \u65b9\u6cd5\u83b7\u5f97\u4e00\u4e2a\u4e3b\u9898\u7684\u96c6\u5408\uff0c\u7136\u540e\u518d\u4ece\u4e3b\u9898\u4e2d\u83b7\u5f97\u4e00\u4e2a\u5e16\u5b50\u7684\u96c6\u5408\uff08\u4ee5\u5e16\u5b50 ID \u4e3a key \uff09\u3002 \u4e00\u65e6\u6211\u4eec\u5f97\u5230\u4e86\u5e16\u5b50\uff0c\u6211\u4eec\u53ea\u9700\u5c06\u5b83\u4eec\u4f20\u9012\u5230\u9644\u4ef6 repository \u7684\u4e00\u4e2a\u7279\u6b8a\u65b9\u6cd5\u4e2d\u5c31\u53ef\u4ee5\u4e86\uff0c\u8be5\u65b9\u6cd5\u8fd0\u884c\u4e00\u4e2a\u5358\u4e00\u7684\u67e5\u627e\uff0c\u5e76\u4e3a\u6bcf\u4e2a\u5e16\u5b50\u7684\u9644\u4ef6\u5173\u8054 \"hydrates\"\u3002 \u6700\u540e\u8981\u5b8c\u6210\u7684\u6743\u9650\u76f8\u5173\u4e8b\u60c5\u662f\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u6743\u9650\u6765\u63a7\u5236\u8c01\u53ef\u4ee5\u624b\u52a8\u5730\u5bf9\u4e3b\u9898\u8fdb\u884c \u7cbe\u9009/\u53d6\u6d88\u7cbe\u9009\u3002 \u8981\u505a\u5230\u8fd9\u4e00\u70b9\uff0c\u5728 Admin CP \u7684 \"\u5f00\u53d1\" \u4e2d\u70b9\u51fb \"\u6743\u9650\u5b9a\u4e49\"\uff0c\u7136\u540e\u70b9\u51fb \"\u6dfb\u52a0\u6743\u9650\"\u3002 \"\u6743\u9650\u7ec4\" \u4e3a \"\u8bba\u575b\"\uff0c\"\u6743\u9650 ID\" \u4e3a demoPortalFeature \uff0c\"Title\" \u5e94\u8be5\u662f Can feature / unfeature threads \uff0c\u5c06 \"\u4ecb\u9762\u7ec4\" \u8bbe\u7f6e\u4e3a Forum moderator permissions \uff0c\u5728\u9009\u62e9\u4e86\u9002\u5f53\u7684\u663e\u793a\u987a\u5e8f\u5e76\u786e\u4fdd\u9009\u62e9\u4e86\u60a8\u7684\u9644\u52a0\u7ec4\u4ef6\u4e4b\u540e\uff0c\u70b9\u51fb \"\u4fdd\u5b58\"\u3002 \u8981\u771f\u6b63\u4f7f\u7528\u8fd9\u4e2a\u6743\u9650\uff0c\u6211\u4eec\u9700\u8981\u56de\u5230\u6211\u4eec\u7684\u7ee7\u627f\u4e3b\u9898 Entity\uff0c\u4fee\u6539 canFeatureUnfeature() \u65b9\u6cd5\u3002 \u5c06 return true; \u66ff\u6362\u4e3a\uff1a return \\XF::visitor()->hasNodePermission($this->node_id, 'demoPortalFeature'); \u6b64\u65f6\uff0c\u7531\u4e8e\u6743\u9650\u6ca1\u6709\u4efb\u4f55\u9ed8\u8ba4\u503c\uff0c\u5982\u679c\u4f60\u53bb\u7f16\u8f91\u4efb\u4f55\u4e00\u4e2a\u5e16\u5b50\uff0c\u4f60\u5e94\u8be5\u4f1a\u53d1\u73b0 \"\u7cbe\u9009\" checkbox \u4e0d\u89c1\u4e86\u3002 \u4f46\u662f\uff0c\u5982\u679c\u60a8\u6388\u4e88\u81ea\u5df1\u8be5\u6743\u9650\uff0c\u5219\u8be5c heckbox \u5c06\u518d\u6b21\u51fa\u73b0\u3002 \u56e0\u6b64\uff0c\u8fd9\u5e94\u8be5\u8868\u660e\u4e86\u6743\u9650\u7684\u8fd0\u4f5c\u662f\u7b26\u5408\u9884\u671f\u7684!","title":"\u5b9e\u73b0\u6743\u9650\u548c\u4f18\u5316"},{"location":"lets-build-an-add-on/#_13","text":"\u6211\u4eec\u5f53\u524d\u6bcf\u9875\u53ea\u663e\u793a 5 \u4e2a\u7cbe\u9009\u4e3b\u9898\uff0c\u4f46\u5982\u679c\u80fd\u6709\u66f4\u591a\u7684\u663e\u793a\u9009\u9879\u5c31\u66f4\u597d\u4e86\u3002 \u521b\u5efa\u9009\u9879\u5f88\u7b80\u5358\u3002 \u867d\u7136\u4e0d\u662f\u5fc5\u987b\u7684\uff0c\u4f46\u6211\u4eec\u9996\u5148\u8981\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u9009\u9879\u7ec4\uff0c\u7136\u540e\u5411\u8be5\u7ec4\u6dfb\u52a0\u4e00\u4e2a\u65b0\u7684\u9009\u9879\u3002 \u5728 Admin CP \u7684\u8bbe\u7f6e\u7136\u540e\u9009\u9879\u4e0b\u70b9\u51fb \"\u6dfb\u52a0\u9009\u9879\u7ec4\" \u6309\u94ae\u3002 \u6211\u4eec\u5c06 \"\u7528\u6237\u7ec4 ID\" \u79f0\u4e3a demoPortal \uff0c\u5e76\u7ed9\u5b83\u4e00\u4e2a \"Demo - Portal options\" \u7684\u6807\u9898\u3002 \u7ed9\u5b83\u4e00\u4e2a\u5408\u9002\u7684 \"\u63cf\u8ff0\" \u548c \"\u663e\u793a\u987a\u5e8f\"\uff0c\u7136\u540e\u70b9\u51fb \"\u4fdd\u5b58\"\u3002 \u73b0\u5728\u70b9\u51fb \"\u6dfb\u52a0\u9009\u9879\"\u3002 \u5c06 \"\u9009\u9879 ID\" \u8bbe\u7f6e\u4e3a demoPortalFeaturedPerPage \uff0c\"Title\" \u8bbe\u7f6e\u4e3a Featured threads per page \uff0c\u7f16\u8f91\u683c\u5f0f\u8bbe\u7f6e\u4e3a Spin box \uff0c\"\u6570\u636e\u7c7b\u578b\" \u8bbe\u7f6e\u4e3a Positive integer \uff0c\"\u9ed8\u8ba4\u503c\" \u8bbe\u7f6e\u4e3a \"10\"\u3002 \u70b9\u51fb \"\u4fdd\u5b58\"\u3002 \u8981\u5b9e\u73b0\u8fd9\u4e00\u70b9\uff0c\u8bf7\u56de\u5230 portal Controller\uff0c\u5e76\u5c06\uff1a $perPage = 5; \u66f4\u6539\u4e3a\uff1a $perPage = $this->options()->demoPortalFeaturedPerPage; \u589e\u52a0\u53e6\u4e00\u4e2a\u9009\u9879\u53ef\u80fd\u4e0d\u4f1a\u6709\u4ec0\u9ebd\u5f71\u54cd\u3002 \u4e5f\u8bb8\u53e6\u4e00\u4e2a\u6709\u7528\u7684\u9009\u9879\u662f\u53ef\u4ee5\u5c06\u9ed8\u8ba4\u7684\u6392\u5e8f\u987a\u5e8f\u4ece xf_demo_portal_featured_thread.feartured_date \u6539\u4e3a xf_thread.post_date \u3002 \u56de\u5230 \"Demo - Portal options\" \u7ec4\uff0c\u70b9\u51fb \"\u6dfb\u52a0\u9009\u9879\"\u3002 \u5c06 \"\u9009\u9879 ID\" \u8bbe\u7f6e\u4e3a demoPortalDefaultSort \uff0c\"Title\" \u8bbe\u7f6e\u4e3a Default sort order \uff0c\"\u7f16\u8f91\u683c\u5f0f\" \u8bbe\u7f6e\u4e3a Radio buttons \u3002 \"\u683c\u5f0f\u53c2\u6570\" \u8bbe\u7f6e\u5982\u4e0b\uff1a plain featured_date={{ phrase('demo_portal_featured_date') }} post_date={{ phrase('demo_portal_post_date') }} \u6700\u540e\u5c06 \"\u9ed8\u8ba4\u503c\" \u8bbe\u7f6e\u4e3a featured_date \uff0c\u70b9\u51fb \"\u4fdd\u5b58\"\u3002 \u6211\u4eec\u9700\u8981\u521b\u5efa\u7528\u4e8e\u5358\u9009\u6309\u94ae\u6807\u7b7e\u7684\u77ed\u8bed\uff0c\u7c7b\u4f3c\u4e8e\u6211\u4eec\u4e4b\u524d\u521b\u5efa\u6a21\u677f\u4fee\u6539\u7684\u77ed\u8bed\u3002 \u5c06\u9009\u9879\u503c\u8bbe\u7f6e\u4e3a \"\u53d1\u5e03\u65e5\u671f\"\u3002 \u4e25\u683c\u6765\u8bf4\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u66f4\u65b0\u6211\u4eec\u7684 repository \u65b9\u6cd5\u6765\u4f7f\u7528\u65b0\u7684\u9009\u9879\uff0c\u4f46\u662f\uff0c\u4e5f\u8bb8\u503c\u5f97\u770b\u770b\u81ea\u5b9a\u4e49 finder \u65b9\u6cd5\u662f\u5982\u4f55\u8fd0\u4f5c\u7684\u3002 \u5728\u8def\u5f84 src/addons/Demo/Portal/Finder/FeaturedThread.php \u4e2d\u521b\u5efa\u4e00\u4e2a\u65b0\u6587\u4ef6\uff0c\u5185\u5bb9\u5982\u4e0b\uff1a <?php namespace Demo\\Portal\\Finder; use XF\\Mvc\\Entity\\Finder; class FeaturedThread extends Finder { public function applyFeaturedOrder($direction = 'ASC') { $options = \\XF::options(); if ($options->demoPortalDefaultSort == 'featured_date') { $this->setDefaultOrder('featured_date', $direction); } else { $this->setDefaultOrder('Thread.post_date', $direction); } return $this; } } \u6b63\u5982\u4f60\u6240\u770b\u5230\u7684\uff0c\u6211\u4eec\u5728\u8fd9\u91cc\u6240\u505a\u7684\u53ea\u662f\u521b\u5efa\u4e86\u4e00\u4e2a\u76f8\u5f53\u57fa\u672c\u7684\u7c7b\uff0c\u5b83\u7ee7\u627f\u4e86 XF Finder \u7269\u4ef6\uff0c\u5e76\u521b\u5efa\u4e00\u4e2a\u7b80\u5358\u7684\u65b9\u6cd5\u6765\u67e5\u770b\u6211\u4eec\u9009\u9879\u7684\u503c\u5e76\u5957\u7528\u9002\u5f53\u7684\u9ed8\u8ba4\u987a\u5e8f\u3002 \u73b0\u5728\u6211\u4eec\u53ef\u4ee5\u66f4\u65b0\u6211\u4eec\u7684 repository \u65b9\u6cd5\u6765\u53d6\u4ee3\u8fd9\u4e2a\u65b9\u6cd5\u3002 \u5728\u6211\u4eec\u7684\u7cbe\u9009\u4e3b\u9898 repository \u91cc\u9762\uff0c\u627e\u5230\uff1a ->setDefaultOrder('featured_date', 'DESC') \u5e76\u6539\u6210\uff1a ->applyFeaturedOrder('DESC') \u6700\u540e\uff0c\u66f4\u65b0\u6211\u4eec\u7684 portal view \u4ee5\u663e\u793a\u9002\u5f53\u7684\u65f6\u95f4\u6233\u5927\u62b5\u5982\u6b64 - \u6839\u636e\u6211\u4eec\u7684\u9009\u9879\u503c\uff0c\u53ef\u4ee5\u662f\u7cbe\u9009\u65e5\u671f\u6216\u53d1\u5e03\u65e5\u671f\u3002 \u5728 demo_portal_view \u6a21\u677f\u4e2d\u5c06\uff1a <li><xf:date time=\"{$featuredThread.featured_date}\" /></li> \u66f4\u6539\u4e3a\uff1a <li> <xf:if is=\"$xf.options.demoPortalDefaultSort == 'featured_date'\"> <xf:date time=\"{$featuredThread.featured_date}\" /> <xf:else /> <xf:date time=\"{$thread.post_date}\" /> </xf:if> </li>","title":"\u521b\u5efa\u4e00\u4e9b\u9009\u9879"},{"location":"lets-build-an-add-on/#_14","text":"\u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0c\u6211\u4eec\u9700\u8981\u518d\u6b21\u4fee\u6539\u4e3b\u9898 Entity\uff0c\u4f46\u8fd9\u6b21\u6211\u4eec\u5c06\u901a\u8fc7 entity_post_save \u4e8b\u4ef6\u6765\u5b9e\u73b0\u3002 \u6b63\u5982\u6211\u4eec\u5728 \u5b9e\u4f53\u751f\u547d\u5468\u671f \u4e2d\u63d0\u5230\u7684\uff0c _postSave() \u65b9\u6cd5\u662f\u5728 Entity \u88ab\u63d2\u5165\u6216\u4fee\u6539\u540e\u53ef\u4ee5\u8fd0\u884c\u52a8\u4f5c\u7684\u5730\u65b9\u3002 \u6700\u521d\u6211\u4eec\u4f1a\u5728\u4e00\u4e2a\u4e3b\u9898\u4e0d\u518d\u53ef\u89c1\u7684\u65f6\u5019\uff0c\u53d6\u6d88\u5bf9\u8be5\u4e3b\u9898\u7684\u7cbe\u9009\u3002 \u6240\u4ee5\uff0c\u56de\u5230 \"\u6dfb\u52a0\u4ee3\u7801\u4e8b\u4ef6\u76d1\u542c\" \u9875\u9762\uff0c\u8fd9\u6b21\u76d1\u542c entity_post_save \u4e8b\u4ef6\u3002 \u8fd9\u6b21\u7684\u4e8b\u4ef6\u63d0\u793a\u5c06\u662f XF\\Entity\\Thread \u3002 \u5bf9\u4e8e\u8fd0\u884c callback\uff0c\u6211\u4eec\u5c06\u4f7f\u7528\u4e0e\u4e4b\u524d\u76f8\u540c\u7684 class ( Dem\\Portal\\Listener )\uff0c\u4f46\u662f\u6211\u4eec\u5c06\u5728\u8fd9\u91cc\u6dfb\u52a0\u4e00\u4e2a\u65b0\u7684\u65b9\u6cd5\uff0c\u547d\u540d\u4e3a threadEntityPostSave \u3002 \u73b0\u5728\u8ba9\u6211\u4eec\u6dfb\u52a0\u8fd9\u4e2a\u65b9\u6cd5\uff0c\u8fd9\u6837\u5f53\u6211\u4eec\u4fdd\u5b58\u76d1\u542c\u5668\u65f6\uff0c\u5b83\u5c31\u4f1a\u51fa\u73b0\uff1a public static function threadEntityPostSave(\\XF\\Mvc\\Entity\\Entity $entity) { } \u70b9\u51fb \"\u4fdd\u5b58\" \u6765\u4fdd\u5b58\u76d1\u542c\u5668\u3002 \u8fd9\u4e2a\u51fd\u6570\u7684\u5185\u5bb9\u76f8\u5f53\u7b80\u5358\uff0c\u6211\u4eec\u6765\u770b\u4e00\u4e0b\uff1a if ($entity->isUpdate()) { $visibilityChange = $entity->isStateChanged('discussion_state', 'visible'); if ($visibilityChange == 'leave') { $featuredThread = $entity->FeaturedThread; if ($featuredThread) { $featuredThread->delete(); $entity->fastUpdate('demo_portal_featured', false); } } } \u6211\u4eec\u4e4b\u524d\u5df2\u7ecf\u53d6\u6d88\u4e86\u4e3b\u9898\u7684\u7cbe\u9009\uff0c\u4f46\u8fd9\u4e00\u6b21\u6211\u4eec\u8981\u4ee5\u4e3b\u9898\u7684\u72b6\u6001\u4e3a\u6761\u4ef6\u3002 \u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 isStateChanged \u65b9\u6cd5\u68c0\u6d4b\u72b6\u6001\u53d8\u5316\u3002 \u8fd9\u5c06\u5bf9\u4f20\u9012\u8fdb\u6765\u7684 column \u540d\u548c value \u8fd4\u56de enter \u6216 leave \u3002 \u4f8b\u5982\uff0c\u5982\u679c discussion_state \u4ece visible \u53d8\u4e3a deleted \uff0c\u90a3\u9ebd\u5728\u4e0a\u9762\u7684\u4f8b\u5b50\u4e2d\uff0c\u8be5\u65b9\u6cd5\u5c06\u8fd4\u56de leave \u3002 \u4e00\u65e6\u6211\u4eec\u68c0\u6d4b\u5230\u81ea\u5df1 \"\u79bb\u5f00\" \u53ef\u89c1\u72b6\u6001\u540e\uff0c\u5c31\u53ef\u4ee5\u76f4\u63a5\u786e\u5b9a\u81ea\u5df1\u6709\u4e00\u4e2a\u7cbe\u9009\u7684\u4e3b\u9898\u5173\u8054\uff0c\u5220\u9664\u5b83\uff0c\u5e76\u66f4\u65b0\u7f13\u5b58\u503c\u3002 \u8fd9\u53ea\u51fd\u76d6\u4e86\u4e3b\u9898\u88ab\u6682\u65f6\u5220\u9664\u6216\u9001\u5165\u6279\u51c6\u961f\u5217\u7684\u60c5\u51b5\uff0c\u6211\u4eec\u8fd8\u9700\u8981\u51fd\u76d6\u4e3b\u9898\u88ab\u6c38\u4e45\u5220\u9664\u7684\u60c5\u51b5\u3002 \u4e3a\u6b64\uff0c\u6211\u4eec\u9700\u8981\u53e6\u4e00\u4e2a\u76d1\u542c\u5668\uff0c\u8fd9\u6b21\u662f\u9488\u5bf9 entity_post_delete \u4e8b\u4ef6\u3002 \u56e0\u6b64\uff0c\u4f7f\u7528\u76f8\u540c\u7684 callback class \u6dfb\u52a0\u8be5\u76d1\u542c\u5668\uff0c\u8fd9\u6b21\u7684\u65b9\u6cd5\u540d\u79f0\u4e3a threadEntityPostDelete \u3002 \u5728\u76d1\u542c\u5668 class \u4e2d\u6dfb\u52a0\u4ee5\u4e0b\u4ee3\u7801\uff1a public static function threadEntityPostDelete(\\XF\\Mvc\\Entity\\Entity $entity) { $featuredThread = $entity->FeaturedThread; if ($featuredThread) { $featuredThread->delete(); } } \u70b9\u51fb \"\u4fdd\u5b58\" \u4ee5\u4fdd\u5b58\u76d1\u542c\u5668\u540e\uff0c\u5c31\u53ef\u4ee5\u5bf9\u6b64\u8fdb\u884c\u6d4b\u8bd5\u4e86\u3002 \u4e3a\u4e86\u6d4b\u8bd5\u8fd9\u4e2a\uff0c\u5176\u5b9e\u4f60\u6700\u597d\u7559\u610f\u4e00\u4e0b xf_demo_portal_featured_thread \u8d44\u6599\u8868\uff0c\u56e0\u4e3a\u5230\u5f53\u524d\u4e3a\u6b62\uff0c\u4ee3\u7801\u5df2\u7ecf\u4e0d\u4f1a\u663e\u793a\u4e0d\u53ef\u89c1\u7684\u4e3b\u9898\u4e86\uff0c\u4f46\u91cd\u8981\u7684\u662f\u4e0d\u8981\u7559\u4e0b\u5b64\u513f\u6570\u636e\u3002 \u4e00\u5207\u90fd\u5f88\u987a\u5229\uff0c\u6211\u4eec\u5df2\u7ecf\u975e\u5e38\u63a5\u8fd1\u5b8c\u6210\u4e86......","title":"\u5728\u53ef\u89c1\u6027\u53d8\u66f4\u4e0a\u53d6\u6d88\u7cbe\u9009"},{"location":"lets-build-an-add-on/#_15","text":"\u8bf4\u5230\u5b64\u513f\u6570\u636e\uff0c\u6bcf\u5f53\u5378\u8f7d\u9644\u52a0\u7ec4\u4ef6\u65f6\uff0c\u6211\u4eec\u90fd\u5e94\u8be5\u5bf9\u6570\u636e\u5e93\u8fdb\u884c\u6574\u7406\u3002 \u6211\u4eec\u53ef\u4ee5\u5728\u6211\u4eec\u4e4b\u524d\u521b\u5efa\u7684 Setup class \u4e2d\u5b8c\u6210\u8fd9\u9879\u5de5\u4f5c\u3002 \u6211\u4eec\u5c06\u521b\u5efa 3 \u4e2a\u65b0\u65b9\u6cd5\uff0c\u5bf9\u5e94\u6211\u4eec\u7684\u524d 3 \u4e2a\u5b89\u88c5\u6b65\u9aa4\uff1a public function uninstallStep1() { $this->schemaManager()->alterTable('xf_forum', function(Alter $table) { $table->dropColumns('demo_portal_auto_feature'); }); } public function uninstallStep2() { $this->schemaManager()->alterTable('xf_thread', function(Alter $table) { $table->dropColumns('demo_portal_featured'); }); } public function uninstallStep3() { $this->schemaManager()->dropTable('xf_demo_portal_featured_thread'); } \u6211\u4eec\u4e0d\u9700\u8981\u521b\u5efa\u5378\u8f7d\u6b65\u9aa4\u6765\u79fb\u9664\u5c0f\u7ec4\u4ef6\uff0c\u56e0\u4e3a\u5f53\u5c0f\u7ec4\u4ef6\u4f4d\u7f6e\u88ab\u79fb\u9664\u65f6\uff0c\u5b83\u4eec\u4f1a\u88ab\u81ea\u52a8\u79fb\u9664\u3002 \u5bf9\u4e8e\u6211\u4eec\u521b\u5efa\u5e76\u4e0e\u9644\u52a0\u7ec4\u4ef6\u76f8\u5173\u8054\u7684\u4efb\u4f55\u5176\u4ed6\u6570\u636e\u4e5f\u662f\u5982\u6b64 -- \u5b83\u4eec\u5c06\u5728\u5378\u8f7d\u65f6\u81ea\u52a8\u5220\u9664\u3002","title":"\u6700\u540e\u4e00\u4e9b\u672a\u4ea4\u5f85\u6e05\u695a\u7684\u4e8b\u60c5"},{"location":"lets-build-an-add-on/#_16","text":"\u4efb\u4f55\u9644\u52a0\u7ec4\u4ef6\u7684\u6700\u540e\u4e00\u6b65\uff0c\u5c31\u662f\u53d1\u5e03\u5b83\uff01 \u8fd9\u6d89\u53ca\u5230\u4ece\u6570\u636e\u5e93\u4e2d\u63d0\u53d6 XML \u6587\u4ef6\uff08\u5728\u8f6f\u4ef6\u5305\u4e2d\u63d0\u4f9b\u5e76\u7528\u4e8e\u5b89\u88c5\uff09\uff0c\u8ba1\u7b97\u6bcf\u4e2a\u6587\u4ef6\u7684\u54c8\u5e0c\u7801\uff0c\u5e76\u5c06\u5176\u6dfb\u52a0\u5230\u6211\u4eec\u7684 hashes.json \u4e2d\uff0c\u5e76\u5c06\u76f8\u5173\u6587\u4ef6\u6253\u5305\u6210\u4e00\u4e2a ZIP \u6587\u4ef6\u3002 \u503c\u5f97\u5e86\u5e78\u7684\u662f\uff0c\u8fd9\u53ef\u4ee5\u901a\u8fc7\u4e00\u4e2a CLI \u547d\u4ee4\u6765\u5b8c\u6210! \u53ea\u8981\u8fd0\u884c\u4e0b\u9762\u7684\u547d\u4ee4\u5c31\u53ef\u4ee5\u4e86\uff1a Terminal $ php cmd.php xf-addon:build-release Demo/Portal Performing add-on export. Exporting data for Demo - Portal to ../src/addons/Demo/Portal/_data. 10/10 [============================] 100% Written successfully. Building release ZIP. Writing release ZIP to ../src/addons/Demo/Portal/_releases. Release written successfully. \u90a3\u9ebd\uff0c\u6211\u4eec\u7684\u6f14\u793a\u63d2\u4ef6\u5c31\u5230\u6b64\u7ed3\u675f\u4e86\uff01 \u5982\u679c\u60a8\u60f3\u4e0b\u8f7d\u8fd9\u4e2a\u9644\u52a0\u7ec4\u4ef6\u7684\u539f\u4ee3\u7801\uff0c\u8bf7\u70b9\u51fb\u8fd9\u91cc\uff1a Demo-Portal-1.0.0 Alpha.zip \u3002","title":"\u6784\u5efa\u9644\u52a0\u7ec4\u4ef6"},{"location":"managing-the-schema/","text":"\u7ba1\u7406 Schema \u00b6 \u6211\u4eec\u5df2\u7ecf\u770b\u4e86\u4e00\u4e9b\u53ef\u7528\u4e8e\u4e0e\u6570\u636e\u4ea4\u4e92\u7684\u65b0\u65b9\u6cd5\u3002 \u5f53\u7136\uff0c\u5728\u4e00\u4e9b\u7279\u5b9a\u60c5\u51b5\u4e0b\uff0c\u53ef\u80fd\u9700\u8981\u76f4\u63a5\u4e0e\u6570\u636e\u5e93\u8fdb\u884c\u4ea4\u4e92\u3002 \u6570\u636e\u5e93\u9002\u914d\u5668 \u00b6 XF2 \u4e2d\u9ed8\u8ba4\u7684\u6570\u636e\u5e93\u9002\u914d\u5668\u662f\u57fa\u4e8e MySQL \u548c PHP \u7684 mysqli \u6269\u5c55\u3002 \u5728\u4efb\u4f55 XF \u7c7b\u4e2d\u90fd\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u65b9\u6cd5\u8bbf\u95ee\u8bbe\u7f6e\u7684\u6570\u636e\u5e93\u9002\u914d\u5668\uff1a $db = \\XF::db(); \u9002\u914d\u5668\u6709\u8bb8\u591a\u53ef\u7528\u7684\u65b9\u6cd5\uff0c\u8fd9\u4e9b\u65b9\u6cd5\u5c06\u8fd0\u884c\u4e00\u4e2a SQL \u67e5\u627e\uff0c\u7136\u540e\u5c06\u7ed3\u679c\u683c\u5f0f\u5316\u4e3a\u4e00\u4e2a\u6570\u7ec4\u3002 \u4f8b\u5982\uff0c\u8981\u8bbf\u95ee\u4e00\u4e2a\u7528\u6237\u8bb0\u5f55\uff1a $db = \\XF::db(); $user = $db->fetchRow('SELECT * FROM xf_user WHERE user_id = ?', 1); $user \u53d8\u91cf\u73b0\u5728\u5c06\u5305\u542b\u4e00\u4e2a\u6570\u7ec4\uff0c\u5176\u4e2d\u5305\u542b\u67e5\u627e\u7ed3\u679c\u96c6\u4e2d\u7b2c\u4e00\u884c\u7684\u6240\u6709\u503c\u3002 \u8981\u60f3\u4ece\u8be5\u67e5\u627e\u4e2d\u83b7\u5f97\u5358\u4e00\u7684\u503c\uff0c\u4f8b\u5982\u7528\u6237\u540d\uff0c\u53ef\u4ee5\u8fd0\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a $username = $user['username']; Warning \u76f4\u63a5\u7f16\u5199\u5e76\u4f20\u9012\u7ed9\u6570\u636e\u5e93\u9002\u914d\u5668\u7684\u6570\u636e\u5e93\u67e5\u627e\u5e76\u975e\u81ea\u52a8 \"\u5b89\u5168\"\u3002 \u5982\u679c\u7528\u6237\u7684\u8f93\u5165\u6ca1\u6709\u7ecf\u8fc7\u6e05\u9664\uff0c\u5e76\u4e14\u6ca1\u6709\u7ecf\u8fc7\u51c6\u5907\u5c31\u4f20\u5165\u67e5\u627e\uff0c\u5b83\u4eec\u5c31\u4f1a\u5e2f\u6765 SQL \u9690\u7801\u653b\u51fb\u6f0f\u6d1e\u7684\u98ce\u9669\u3002 \u6b63\u786e\u7684\u65b9\u6cd5\u662f\u4f7f\u7528\u51c6\u5907\u597d\u7684\u8bed\u53e5\uff0c\u5c31\u8c61\u4e0a\u9762\u7684\u4f8b\u5b50\u4e00\u6837\u3002 \u5728\u67e5\u627e\u672c\u8eab\u4e2d\u4f7f\u7528 ? \u5360\u4f4d\u7b26\u6765\u8868\u793a\u53c2\u6570\u3002 \u8fd9\u4e9b\u5360\u4f4d\u7b26\u7ecf\u8fc7\u9002\u5f53\u7684\u8ee2\u4e49\u540e\uff0c\u4f1a\u88ab\u4e0b\u4e00\u4e2a\u53c2\u6570\u4e2d\u7684\u503c\u66ff\u6362\u3002 \u5982\u679c\u4f60\u9700\u8981\u4f7f\u7528\u7684\u53c2\u6570\u4e0d\u6b62\u4e00\u4e2a\uff0c\u90a3\u5e94\u8be5\u4ee5\u6570\u7ec4\u7684\u5f62\u5f0f\u4f20\u9012\u5230 fetch \u7c7b\u578b\u65b9\u6cd5\u4e2d\u3002 \u5982\u6709\u5fc5\u8981\uff0c\u4f60\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528 $db->quote($value) \u5bf9\u503c\u8fdb\u884c\u8ee2\u4e49\u6216\u5f15\u7528\u3002 \u60a8\u53ef\u4ee5 \u5728\u8fd9\u91cc \u627e\u5230\u66f4\u591a\u5173\u4e8e\u51c6\u5907\u597d\u7684\u8bed\u53e5\u4fe1\u606f\u3002 \u4e5f\u53ef\u4ee5\u4ece\u4e00\u6761\u8bb0\u5f55\u4e2d\u67e5\u627e\u4e00\u4e2a\u503c\u3002 \u4f8b\u5982\uff1a $db = \\XF::db(); $username = $db->fetchOne('SELECT username FROM xf_user WHERE user_id = ?', 1); \u5982\u679c\u4f60\u6709\u4e00\u4e2a\u9700\u8981\u8fd4\u56de\u591a\u6761\u8bb0\u5f55\u7684\u67e5\u627e\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528 fetchAll \uff1a $db = \\XF::db(); $users = $db->fetchAll('SELECT * FROM xf_user LIMIT 10'); \u6216\u8005 fetchAllKeyed \uff1a $db = \\XF::db(); $users = $db->fetchAllKeyed('SELECT * FROM xf_user LIMIT 10', 'user_id'); \u8fd9\u4e24\u79cd\u65b9\u6cd5\u90fd\u5c06\u8fd4\u56de\u4e00\u4e2a\u4ee3\u8868\u6bcf\u4e2a\u7528\u6237\u8bb0\u5f55\u7684\u6570\u7ec4\u3002 fetchAll \u548c fetchAllKeyed \u65b9\u6cd5\u4e4b\u95f4\u7684\u533a\u522b\u662f\uff0c\u8fd4\u56de\u7684\u6570\u7ec4\u7684 key \u503c\u4e0d\u540c\u3002 \u4f7f\u7528 fetchAll \u65b9\u6cd5\u65f6\uff0c\u6570\u7ec4\u5c06\u7528\u8fde\u7eed\u7684\u6570\u5b57\u6574\u6570\u8fdb\u884c key \u9501\u5b9a\u3002 \u7528 fetchAllKeyed \u65b9\u6cd5\uff0c\u6570\u7ec4\u5c06\u7528\u7b2c\u4e8c\u4e2a\u53c2\u6570\u4e2d\u547d\u540d\u7684\u5b57\u6bb5\u540d\u8fdb\u884c key \u9501\u5b9a\u3002 Note \u5982\u679c\u4f60\u4f7f\u7528 fetchAllKeyed \uff0c\u8bf7\u6ce8\u610f\u7b2c\u4e8c\u4e2a\u53c2\u6570\u662f\u8981\u5bf9\u6570\u7ec4\u8fdb\u884c key \u9501\u5b9a\u7684\u5b57\u6bb5\uff0c\u4f46 \u7b2c\u4e09\u4e2a \u53c2\u6570\u662f\u4f60\u4f20\u9012 param \u503c\u4ee5\u5339\u914d ? \u5360\u4f4d\u7b26\u7684\u5730\u65b9\u3002 \u8fd8\u6709\u4e00\u4e9b\u5176\u4ed6\u83b7\u53d6\u7c7b\u578b\u7684\u65b9\u6cd5\uff0c\u5305\u62ec fetchAllColumn \uff0c\u7528\u4e8e\u4ece\u6240\u6709\u8fd4\u56de\u7684 rows \u4e2d\u6293\u53d6\u4e00\u4e2a\u7279\u5b9a column \u7684\u503c\u7684\u6570\u7ec4\uff1a $db = \\XF::db(); $usernames = $db->fetchAllColumn('SELECT username FROM xf_user LIMIT 10'); \u4e0a\u9762\u7684\u4f8b\u5b50\u5c06\u8fd4\u56de\u4e00\u4e2a\u4ece\u7ed3\u679c\u67e5\u627e\u4e2d\u627e\u5230\u7684 10 \u4e2a\u7528\u6237\u540d\u7684\u6570\u7ec4\u3002 \u6700\u540e\uff0c\u4f60\u53ef\u80fd\u5e76\u4e0d\u60f3\u8981\u6216\u4e0d\u9700\u8981\u8fd4\u56de\u4efb\u4f55\u6570\u636e\uff0c\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u4f60\u53ef\u4ee5\u53ea\u505a\u4e00\u4e2a\u666e\u901a\u67e5\u627e\uff1a $db = \\XF::db(); $db->query('DELETE FROM xf_user WHERE user_id = ?', 1); \u7eb2\u8981\u7ba1\u7406 \u00b6 XF2 \u5305\u542b\u4e86\u4e00\u79cd\u5168\u65b0\u7684\u7ba1\u7406\u6570\u636e\u5e93\u6a21\u5f0f\u7684\u65b9\u5f0f\uff0c\u5b83\u91c7\u7528\u7269\u4ef6\u5bfc\u5411\u7684\u65b9\u5f0f\u6765\u8fd0\u884c\u67d0\u4e9b\u8868\u7684\u64cd\u4f5c\u3002 \u8ba9\u6211\u4eec\u5148\u770b\u770b\u4f20\u7edf\u7684\u6539\u53d8\uff0c\u4f7f\u7528\u6570\u636e\u5e93\u9002\u914d\u5668\uff0c\u5c31\u8c61\u6211\u4eec\u4e0a\u9762\u7684\u90a3\u6837\u3002 $db = \\XF::db(); $db->query(\" ALTER TABLE xf_some_existing_table ADD COLUMN new_column INT(10) UNSIGNED NOT NULL DEFAULT 0, MODIFY COLUMN some_existing_column varchar(250) NOT NULL DEFAULT '' \"); \u6211\u4eec\u4e5f\u6765\u770b\u770b\u4e00\u4e2a\u5178\u578b\u7684\u521b\u5efa\u8d44\u6599\u8868\u67e5\u627e\uff1a $db = \\XF::db(); $sm = $db->getSchemaManager(); $defaultTableConfig = $sm->getTableConfigSql(); $db->query(\" CREATE TABLE xf_some_table ( some_id INT(10) UNSIGNED NOT NULL AUTO_INCREMENT, some_name VARCHAR(50) NOT NULL, PRIMARY KEY (user_id) ) {$defaultTableConfig} \"); \u5728 XF2 \u4e2d\uff0c\u53e6\u4e00\u79cd\u548c\u9996\u9009\u7684\u65b9\u6cd5\u662f\u4f7f\u7528\u65b0\u7684 SchemaManager \u7269\u4ef6\u3002 \u8ba9\u6211\u4eec\u6765\u770b\u770b\u8fd9\u4e24\u4e2a\u7531\u6a21\u5f0f\u7ba1\u7406\u5668\u8fd0\u884c\u7684\u67e5\u627e\uff0c\u9996\u5148\u662f alter\uff1a $sm = \\XF::db()->getSchemaManager(); $sm->alterTable('xf_some_existing_table', function(\\XF\\Db\\Schema\\Alter $table) { $table->addColumn('new_column', 'int')->setDefault(0); $table->changeColumn('some_existing_column')->length(250); }); \u8fd8\u6709\u8d44\u6599\u8868\u7684\u521b\u5efa\uff1a $sm = \\XF::db()->getSchemaManager(); $sm->createTable('xf_some_table', function(\\XF\\Db\\Schema\\Create $table) { $table->addColumn('some_id', 'int')->autoIncrement(); $table->addColumn('some_name', 'varchar', 50); }); Warning \u5f53\u60a8\u66f4\u6539\u73b0\u6709\u7684 XenForo \u8d44\u6599\u8868\u6216\u521b\u5efa\u81ea\u5df1\u7684\u8d44\u6599\u8868\u65f6\uff0c \u5fc5\u987b \u6307\u5b9a\u4e00\u4e2a\u9ed8\u8ba4\u503c\uff0c\u5426\u5219\u5728\u67e5\u627e\u8d44\u6599\u8868\u65f6\u5c06\u4f1a\u9047\u5230\u95ee\u9898\u3002 \u8fd9\u4e24\u4e2a\u4f8b\u5b50\u751f\u6210\u7684\u67e5\u627e\u7ed3\u679c\u548c\u4e0a\u9762\u66f4\u76f4\u63a5\u7684\u4f8b\u5b50\u5b8c\u5168\u4e00\u6837\u3002 \u4e0d\u8fc7\u4f60\u53ef\u80fd\u4f1a\u6ce8\u610f\u5230\uff0c\u6709\u4e9b\u4e1c\u897f\u662f\uff08\u6545\u610f\uff09\u9057\u6f0f\u7684\u3002 \u4f8b\u5982\uff0c\u6ca1\u6709\u4e00\u4e2a\u4f8b\u5b50\u4e3a int \u5b57\u6bb5\u6307\u5b9a\u4e00\u4e2a\u957f\u5ea6\u3002 \u8fd9\u53ea\u662f\u56e0\u4e3a\u7701\u7565\u4e86\u8fd9\u4e00\u70b9\uff0cMySQL \u4f1a\u7ed9\u5b83\u63d0\u4f9b\u4e00\u4e2a\u9ed8\u8ba4\u503c\uff0c\u5bf9\u4e8e\u65e0\u7b26\u53f7\u6574\u6570\u6765\u8bf4\u662f 10\u3002\u8bf4\u5230\u8fd9\u91cc\uff0c\u6211\u4eec\u4e5f\u6ca1\u6709\u6307\u5b9a some_id column \u662f\u65e0\u7b26\u53f7\u7684\u3002 \u5728 XF \u5185\u4f7f\u7528\u65e0\u7b26\u53f7\u6574\u6570\u662f\u5f53\u524d\u6700\u5e38\u89c1\u7684\u4f7f\u7528\u6848\u4f8b\uff0c\u6240\u4ee5\u4f1a\u81ea\u52a8\u6dfb\u52a0\u3002 \u5982\u679c\u4f60\u771f\u6b63\u9700\u8981\u652f\u6301\u8d1f\u6574\u6570\u7684\u80fd\u529b\uff0c\u4f60\u53ef\u4ee5\u7528 ->unsigned(false) \u65b9\u6cd5\u53cd\u8fc7\u6765\u3002 \u53e6\u4e00\u4e2a\u9057\u6f0f\u662f\u6ca1\u6709\u4e3a\u6240\u6709\u7684\u4e1c\u897f\u5b9a\u4e49 NOT NULL \u3002 \u540c\u6837\uff0c\u8fd9\u662f\u81ea\u52a8\u5e94\u7528\u7684\uff0c\u4f46\u4f60\u53ef\u4ee5\u7528 ->nullable(true) \u6765\u626d\u8ee2\u8fd9\u79cd\u60c5\u51b5\u3002 \u4ece alter \u7684\u4f8b\u5b50\u4e2d\u53ef\u80fd\u770b\u4e0d\u6e05\u695a\uff0c\u4f46\u662f\u5f53\u6539\u53d8\u73b0\u6709\u7684\u5b57\u6bb5\u65f6\uff0c\u73b0\u6709\u7684\u5b57\u6bb5\u5b9a\u4e49\u4f1a\u81ea\u52a8\u4fdd\u7559\u3002 \u8fd9\u610f\u5473\u7740\uff0c\u4f60\u4e0d\u5fc5\u6307\u5b9a\u6574\u4e2a column \u7684\u5b9a\u4e49\uff0c\u5305\u62ec\u6240\u6709\u6ca1\u6709\u5b9e\u9645\u6539\u53d8\u7684\u90e8\u5206\uff0c\u4f60\u53ef\u4ee5\u53ea\u6307\u5b9a\u4f60\u8981\u6539\u53d8\u7684\u90e8\u5206\u3002 \u5173\u4e8e Primary Key\uff0c\u8fd8\u6709\u4e00\u4e9b\u5176\u4ed6\u7684\u81ea\u52a8\u63a8\u65ad\u3002 \u5982\u679c\u4f60\u613f\u610f\u7684\u8bdd\uff0c\u4f60\u53ef\u4ee5\u660e\u786e\u5730\u5b9a\u4e49 Primary Key\uff08\u6216\u4efb\u4f55\u5176\u4ed6\u7c7b\u578b\u7684 Key \uff09\uff0c\u4f46\u901a\u5e38\u81ea\u52a8\u9012\u589e\u7684\u5b57\u6bb5\u901a\u5e38\u4f1a\u6210\u4e3a\u4f60\u7684\u8d44\u6599\u8868\u7684 Primary Key\u3002 \u6240\u4ee5\u5728\u521b\u5efa\u8d44\u6599\u8868\u7684\u4f8b\u5b50\u4e2d\uff0c some_id \u5b57\u6bb5\u88ab\u81ea\u52a8\u5206\u914d\u4e3a\u8be5\u8d44\u6599\u8868\u7684 Primary Key\u3002 \u6700\u540e\uff0c\u5bf9\u4e8e\u521b\u5efa\u8d44\u6599\u8868\u7684\u65b9\u6cd5\uff0c\u6211\u4eec\u53ef\u4ee5\u4e3a\u6307\u5b9a\u7684\u4fdd\u5b58\u5f15\u64ce\u81ea\u52a8\u6dfb\u52a0\u6b63\u786e\u7684\u8d44\u6599\u8868\u8bbe\u7f6e\uff08\u9ed8\u8ba4\u4e3a InnoDB \uff0c\u4f46\u53ef\u4ee5\u5f88\u5bb9\u6613\u5730\u6539\u53d8\u4e3a\u5176\u4ed6\u5f15\u64ce\u7c7b\u578b\uff09\u3002","title":"\u7ba1\u7406 Schema"},{"location":"managing-the-schema/#schema","text":"\u6211\u4eec\u5df2\u7ecf\u770b\u4e86\u4e00\u4e9b\u53ef\u7528\u4e8e\u4e0e\u6570\u636e\u4ea4\u4e92\u7684\u65b0\u65b9\u6cd5\u3002 \u5f53\u7136\uff0c\u5728\u4e00\u4e9b\u7279\u5b9a\u60c5\u51b5\u4e0b\uff0c\u53ef\u80fd\u9700\u8981\u76f4\u63a5\u4e0e\u6570\u636e\u5e93\u8fdb\u884c\u4ea4\u4e92\u3002","title":"\u7ba1\u7406 Schema"},{"location":"managing-the-schema/#_1","text":"XF2 \u4e2d\u9ed8\u8ba4\u7684\u6570\u636e\u5e93\u9002\u914d\u5668\u662f\u57fa\u4e8e MySQL \u548c PHP \u7684 mysqli \u6269\u5c55\u3002 \u5728\u4efb\u4f55 XF \u7c7b\u4e2d\u90fd\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u65b9\u6cd5\u8bbf\u95ee\u8bbe\u7f6e\u7684\u6570\u636e\u5e93\u9002\u914d\u5668\uff1a $db = \\XF::db(); \u9002\u914d\u5668\u6709\u8bb8\u591a\u53ef\u7528\u7684\u65b9\u6cd5\uff0c\u8fd9\u4e9b\u65b9\u6cd5\u5c06\u8fd0\u884c\u4e00\u4e2a SQL \u67e5\u627e\uff0c\u7136\u540e\u5c06\u7ed3\u679c\u683c\u5f0f\u5316\u4e3a\u4e00\u4e2a\u6570\u7ec4\u3002 \u4f8b\u5982\uff0c\u8981\u8bbf\u95ee\u4e00\u4e2a\u7528\u6237\u8bb0\u5f55\uff1a $db = \\XF::db(); $user = $db->fetchRow('SELECT * FROM xf_user WHERE user_id = ?', 1); $user \u53d8\u91cf\u73b0\u5728\u5c06\u5305\u542b\u4e00\u4e2a\u6570\u7ec4\uff0c\u5176\u4e2d\u5305\u542b\u67e5\u627e\u7ed3\u679c\u96c6\u4e2d\u7b2c\u4e00\u884c\u7684\u6240\u6709\u503c\u3002 \u8981\u60f3\u4ece\u8be5\u67e5\u627e\u4e2d\u83b7\u5f97\u5358\u4e00\u7684\u503c\uff0c\u4f8b\u5982\u7528\u6237\u540d\uff0c\u53ef\u4ee5\u8fd0\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a $username = $user['username']; Warning \u76f4\u63a5\u7f16\u5199\u5e76\u4f20\u9012\u7ed9\u6570\u636e\u5e93\u9002\u914d\u5668\u7684\u6570\u636e\u5e93\u67e5\u627e\u5e76\u975e\u81ea\u52a8 \"\u5b89\u5168\"\u3002 \u5982\u679c\u7528\u6237\u7684\u8f93\u5165\u6ca1\u6709\u7ecf\u8fc7\u6e05\u9664\uff0c\u5e76\u4e14\u6ca1\u6709\u7ecf\u8fc7\u51c6\u5907\u5c31\u4f20\u5165\u67e5\u627e\uff0c\u5b83\u4eec\u5c31\u4f1a\u5e2f\u6765 SQL \u9690\u7801\u653b\u51fb\u6f0f\u6d1e\u7684\u98ce\u9669\u3002 \u6b63\u786e\u7684\u65b9\u6cd5\u662f\u4f7f\u7528\u51c6\u5907\u597d\u7684\u8bed\u53e5\uff0c\u5c31\u8c61\u4e0a\u9762\u7684\u4f8b\u5b50\u4e00\u6837\u3002 \u5728\u67e5\u627e\u672c\u8eab\u4e2d\u4f7f\u7528 ? \u5360\u4f4d\u7b26\u6765\u8868\u793a\u53c2\u6570\u3002 \u8fd9\u4e9b\u5360\u4f4d\u7b26\u7ecf\u8fc7\u9002\u5f53\u7684\u8ee2\u4e49\u540e\uff0c\u4f1a\u88ab\u4e0b\u4e00\u4e2a\u53c2\u6570\u4e2d\u7684\u503c\u66ff\u6362\u3002 \u5982\u679c\u4f60\u9700\u8981\u4f7f\u7528\u7684\u53c2\u6570\u4e0d\u6b62\u4e00\u4e2a\uff0c\u90a3\u5e94\u8be5\u4ee5\u6570\u7ec4\u7684\u5f62\u5f0f\u4f20\u9012\u5230 fetch \u7c7b\u578b\u65b9\u6cd5\u4e2d\u3002 \u5982\u6709\u5fc5\u8981\uff0c\u4f60\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528 $db->quote($value) \u5bf9\u503c\u8fdb\u884c\u8ee2\u4e49\u6216\u5f15\u7528\u3002 \u60a8\u53ef\u4ee5 \u5728\u8fd9\u91cc \u627e\u5230\u66f4\u591a\u5173\u4e8e\u51c6\u5907\u597d\u7684\u8bed\u53e5\u4fe1\u606f\u3002 \u4e5f\u53ef\u4ee5\u4ece\u4e00\u6761\u8bb0\u5f55\u4e2d\u67e5\u627e\u4e00\u4e2a\u503c\u3002 \u4f8b\u5982\uff1a $db = \\XF::db(); $username = $db->fetchOne('SELECT username FROM xf_user WHERE user_id = ?', 1); \u5982\u679c\u4f60\u6709\u4e00\u4e2a\u9700\u8981\u8fd4\u56de\u591a\u6761\u8bb0\u5f55\u7684\u67e5\u627e\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528 fetchAll \uff1a $db = \\XF::db(); $users = $db->fetchAll('SELECT * FROM xf_user LIMIT 10'); \u6216\u8005 fetchAllKeyed \uff1a $db = \\XF::db(); $users = $db->fetchAllKeyed('SELECT * FROM xf_user LIMIT 10', 'user_id'); \u8fd9\u4e24\u79cd\u65b9\u6cd5\u90fd\u5c06\u8fd4\u56de\u4e00\u4e2a\u4ee3\u8868\u6bcf\u4e2a\u7528\u6237\u8bb0\u5f55\u7684\u6570\u7ec4\u3002 fetchAll \u548c fetchAllKeyed \u65b9\u6cd5\u4e4b\u95f4\u7684\u533a\u522b\u662f\uff0c\u8fd4\u56de\u7684\u6570\u7ec4\u7684 key \u503c\u4e0d\u540c\u3002 \u4f7f\u7528 fetchAll \u65b9\u6cd5\u65f6\uff0c\u6570\u7ec4\u5c06\u7528\u8fde\u7eed\u7684\u6570\u5b57\u6574\u6570\u8fdb\u884c key \u9501\u5b9a\u3002 \u7528 fetchAllKeyed \u65b9\u6cd5\uff0c\u6570\u7ec4\u5c06\u7528\u7b2c\u4e8c\u4e2a\u53c2\u6570\u4e2d\u547d\u540d\u7684\u5b57\u6bb5\u540d\u8fdb\u884c key \u9501\u5b9a\u3002 Note \u5982\u679c\u4f60\u4f7f\u7528 fetchAllKeyed \uff0c\u8bf7\u6ce8\u610f\u7b2c\u4e8c\u4e2a\u53c2\u6570\u662f\u8981\u5bf9\u6570\u7ec4\u8fdb\u884c key \u9501\u5b9a\u7684\u5b57\u6bb5\uff0c\u4f46 \u7b2c\u4e09\u4e2a \u53c2\u6570\u662f\u4f60\u4f20\u9012 param \u503c\u4ee5\u5339\u914d ? \u5360\u4f4d\u7b26\u7684\u5730\u65b9\u3002 \u8fd8\u6709\u4e00\u4e9b\u5176\u4ed6\u83b7\u53d6\u7c7b\u578b\u7684\u65b9\u6cd5\uff0c\u5305\u62ec fetchAllColumn \uff0c\u7528\u4e8e\u4ece\u6240\u6709\u8fd4\u56de\u7684 rows \u4e2d\u6293\u53d6\u4e00\u4e2a\u7279\u5b9a column \u7684\u503c\u7684\u6570\u7ec4\uff1a $db = \\XF::db(); $usernames = $db->fetchAllColumn('SELECT username FROM xf_user LIMIT 10'); \u4e0a\u9762\u7684\u4f8b\u5b50\u5c06\u8fd4\u56de\u4e00\u4e2a\u4ece\u7ed3\u679c\u67e5\u627e\u4e2d\u627e\u5230\u7684 10 \u4e2a\u7528\u6237\u540d\u7684\u6570\u7ec4\u3002 \u6700\u540e\uff0c\u4f60\u53ef\u80fd\u5e76\u4e0d\u60f3\u8981\u6216\u4e0d\u9700\u8981\u8fd4\u56de\u4efb\u4f55\u6570\u636e\uff0c\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u4f60\u53ef\u4ee5\u53ea\u505a\u4e00\u4e2a\u666e\u901a\u67e5\u627e\uff1a $db = \\XF::db(); $db->query('DELETE FROM xf_user WHERE user_id = ?', 1);","title":"\u6570\u636e\u5e93\u9002\u914d\u5668"},{"location":"managing-the-schema/#_2","text":"XF2 \u5305\u542b\u4e86\u4e00\u79cd\u5168\u65b0\u7684\u7ba1\u7406\u6570\u636e\u5e93\u6a21\u5f0f\u7684\u65b9\u5f0f\uff0c\u5b83\u91c7\u7528\u7269\u4ef6\u5bfc\u5411\u7684\u65b9\u5f0f\u6765\u8fd0\u884c\u67d0\u4e9b\u8868\u7684\u64cd\u4f5c\u3002 \u8ba9\u6211\u4eec\u5148\u770b\u770b\u4f20\u7edf\u7684\u6539\u53d8\uff0c\u4f7f\u7528\u6570\u636e\u5e93\u9002\u914d\u5668\uff0c\u5c31\u8c61\u6211\u4eec\u4e0a\u9762\u7684\u90a3\u6837\u3002 $db = \\XF::db(); $db->query(\" ALTER TABLE xf_some_existing_table ADD COLUMN new_column INT(10) UNSIGNED NOT NULL DEFAULT 0, MODIFY COLUMN some_existing_column varchar(250) NOT NULL DEFAULT '' \"); \u6211\u4eec\u4e5f\u6765\u770b\u770b\u4e00\u4e2a\u5178\u578b\u7684\u521b\u5efa\u8d44\u6599\u8868\u67e5\u627e\uff1a $db = \\XF::db(); $sm = $db->getSchemaManager(); $defaultTableConfig = $sm->getTableConfigSql(); $db->query(\" CREATE TABLE xf_some_table ( some_id INT(10) UNSIGNED NOT NULL AUTO_INCREMENT, some_name VARCHAR(50) NOT NULL, PRIMARY KEY (user_id) ) {$defaultTableConfig} \"); \u5728 XF2 \u4e2d\uff0c\u53e6\u4e00\u79cd\u548c\u9996\u9009\u7684\u65b9\u6cd5\u662f\u4f7f\u7528\u65b0\u7684 SchemaManager \u7269\u4ef6\u3002 \u8ba9\u6211\u4eec\u6765\u770b\u770b\u8fd9\u4e24\u4e2a\u7531\u6a21\u5f0f\u7ba1\u7406\u5668\u8fd0\u884c\u7684\u67e5\u627e\uff0c\u9996\u5148\u662f alter\uff1a $sm = \\XF::db()->getSchemaManager(); $sm->alterTable('xf_some_existing_table', function(\\XF\\Db\\Schema\\Alter $table) { $table->addColumn('new_column', 'int')->setDefault(0); $table->changeColumn('some_existing_column')->length(250); }); \u8fd8\u6709\u8d44\u6599\u8868\u7684\u521b\u5efa\uff1a $sm = \\XF::db()->getSchemaManager(); $sm->createTable('xf_some_table', function(\\XF\\Db\\Schema\\Create $table) { $table->addColumn('some_id', 'int')->autoIncrement(); $table->addColumn('some_name', 'varchar', 50); }); Warning \u5f53\u60a8\u66f4\u6539\u73b0\u6709\u7684 XenForo \u8d44\u6599\u8868\u6216\u521b\u5efa\u81ea\u5df1\u7684\u8d44\u6599\u8868\u65f6\uff0c \u5fc5\u987b \u6307\u5b9a\u4e00\u4e2a\u9ed8\u8ba4\u503c\uff0c\u5426\u5219\u5728\u67e5\u627e\u8d44\u6599\u8868\u65f6\u5c06\u4f1a\u9047\u5230\u95ee\u9898\u3002 \u8fd9\u4e24\u4e2a\u4f8b\u5b50\u751f\u6210\u7684\u67e5\u627e\u7ed3\u679c\u548c\u4e0a\u9762\u66f4\u76f4\u63a5\u7684\u4f8b\u5b50\u5b8c\u5168\u4e00\u6837\u3002 \u4e0d\u8fc7\u4f60\u53ef\u80fd\u4f1a\u6ce8\u610f\u5230\uff0c\u6709\u4e9b\u4e1c\u897f\u662f\uff08\u6545\u610f\uff09\u9057\u6f0f\u7684\u3002 \u4f8b\u5982\uff0c\u6ca1\u6709\u4e00\u4e2a\u4f8b\u5b50\u4e3a int \u5b57\u6bb5\u6307\u5b9a\u4e00\u4e2a\u957f\u5ea6\u3002 \u8fd9\u53ea\u662f\u56e0\u4e3a\u7701\u7565\u4e86\u8fd9\u4e00\u70b9\uff0cMySQL \u4f1a\u7ed9\u5b83\u63d0\u4f9b\u4e00\u4e2a\u9ed8\u8ba4\u503c\uff0c\u5bf9\u4e8e\u65e0\u7b26\u53f7\u6574\u6570\u6765\u8bf4\u662f 10\u3002\u8bf4\u5230\u8fd9\u91cc\uff0c\u6211\u4eec\u4e5f\u6ca1\u6709\u6307\u5b9a some_id column \u662f\u65e0\u7b26\u53f7\u7684\u3002 \u5728 XF \u5185\u4f7f\u7528\u65e0\u7b26\u53f7\u6574\u6570\u662f\u5f53\u524d\u6700\u5e38\u89c1\u7684\u4f7f\u7528\u6848\u4f8b\uff0c\u6240\u4ee5\u4f1a\u81ea\u52a8\u6dfb\u52a0\u3002 \u5982\u679c\u4f60\u771f\u6b63\u9700\u8981\u652f\u6301\u8d1f\u6574\u6570\u7684\u80fd\u529b\uff0c\u4f60\u53ef\u4ee5\u7528 ->unsigned(false) \u65b9\u6cd5\u53cd\u8fc7\u6765\u3002 \u53e6\u4e00\u4e2a\u9057\u6f0f\u662f\u6ca1\u6709\u4e3a\u6240\u6709\u7684\u4e1c\u897f\u5b9a\u4e49 NOT NULL \u3002 \u540c\u6837\uff0c\u8fd9\u662f\u81ea\u52a8\u5e94\u7528\u7684\uff0c\u4f46\u4f60\u53ef\u4ee5\u7528 ->nullable(true) \u6765\u626d\u8ee2\u8fd9\u79cd\u60c5\u51b5\u3002 \u4ece alter \u7684\u4f8b\u5b50\u4e2d\u53ef\u80fd\u770b\u4e0d\u6e05\u695a\uff0c\u4f46\u662f\u5f53\u6539\u53d8\u73b0\u6709\u7684\u5b57\u6bb5\u65f6\uff0c\u73b0\u6709\u7684\u5b57\u6bb5\u5b9a\u4e49\u4f1a\u81ea\u52a8\u4fdd\u7559\u3002 \u8fd9\u610f\u5473\u7740\uff0c\u4f60\u4e0d\u5fc5\u6307\u5b9a\u6574\u4e2a column \u7684\u5b9a\u4e49\uff0c\u5305\u62ec\u6240\u6709\u6ca1\u6709\u5b9e\u9645\u6539\u53d8\u7684\u90e8\u5206\uff0c\u4f60\u53ef\u4ee5\u53ea\u6307\u5b9a\u4f60\u8981\u6539\u53d8\u7684\u90e8\u5206\u3002 \u5173\u4e8e Primary Key\uff0c\u8fd8\u6709\u4e00\u4e9b\u5176\u4ed6\u7684\u81ea\u52a8\u63a8\u65ad\u3002 \u5982\u679c\u4f60\u613f\u610f\u7684\u8bdd\uff0c\u4f60\u53ef\u4ee5\u660e\u786e\u5730\u5b9a\u4e49 Primary Key\uff08\u6216\u4efb\u4f55\u5176\u4ed6\u7c7b\u578b\u7684 Key \uff09\uff0c\u4f46\u901a\u5e38\u81ea\u52a8\u9012\u589e\u7684\u5b57\u6bb5\u901a\u5e38\u4f1a\u6210\u4e3a\u4f60\u7684\u8d44\u6599\u8868\u7684 Primary Key\u3002 \u6240\u4ee5\u5728\u521b\u5efa\u8d44\u6599\u8868\u7684\u4f8b\u5b50\u4e2d\uff0c some_id \u5b57\u6bb5\u88ab\u81ea\u52a8\u5206\u914d\u4e3a\u8be5\u8d44\u6599\u8868\u7684 Primary Key\u3002 \u6700\u540e\uff0c\u5bf9\u4e8e\u521b\u5efa\u8d44\u6599\u8868\u7684\u65b9\u6cd5\uff0c\u6211\u4eec\u53ef\u4ee5\u4e3a\u6307\u5b9a\u7684\u4fdd\u5b58\u5f15\u64ce\u81ea\u52a8\u6dfb\u52a0\u6b63\u786e\u7684\u8d44\u6599\u8868\u8bbe\u7f6e\uff08\u9ed8\u8ba4\u4e3a InnoDB \uff0c\u4f46\u53ef\u4ee5\u5f88\u5bb9\u6613\u5730\u6539\u53d8\u4e3a\u5176\u4ed6\u5f15\u64ce\u7c7b\u578b\uff09\u3002","title":"\u7eb2\u8981\u7ba1\u7406"},{"location":"rest-api/","text":"REST API \u00b6 \u5728 XenForo 2.1 \u4e2d\uff0c\u6dfb\u52a0\u4e86 REST API\u3002\u8fd9\u4f7f\u60a8\u53ef\u4ee5\u901a\u8fc7\u7f16\u7a0b\u7684\u65b9\u5f0f\u4e0e XenForo \u5b89\u88c5\u7684\u8bb8\u591a\u533a\u57df\u8fdb\u884c\u4ea4\u4e92\u3002 \u8981\u8bbf\u95ee API\uff0c\u9700\u8981\u901a\u8fc7\u7ba1\u7406\u5458\u63a7\u5236\u9762\u677f\u751f\u6210\u5bc6\u94a5\u3002\u672a\u7ecf\u8ba4\u8bc1\u7684 API \u6ca1\u6709\u529e\u6cd5\u8bbf\u95ee\uff0c\u6b64\u65f6\u7528\u6237\u4e5f\u4e0d\u80fd\u81ea\u5df1\u751f\u6210\u5bc6\u94a5\u6765\u8bbf\u95ee API\u3002 \u7279\u5b9a XenForo \u5b89\u88c5\u7684 API \u53ef\u901a\u8fc7 <XenForo \u57fa\u672c URL>/api/ \u8bbf\u95ee\u3002\u6240\u6709\u7aef\u70b9\u90fd\u4ee5\u8be5 URL \u4e3a\u524d\u7f00\u3002\u4f8b\u5982\uff0c\u5982\u679c XenForo \u5b89\u88c5\u5728 https://example.com/community/ \uff0c\u90a3\u9ebdAPI URL\u5c06\u4ee5 https://example.com/community/api/ \u5f00\u5934\u3002\u5728\u672c\u4f8b\u4e2d\uff0c\u8bbf\u95ee\u7ebf\u7a0b\u5217\u8868\u53ef\u901a\u8fc7 https://example.com/community/api/threads/ \u8fdb\u884c\u3002 \u9ed8\u8ba4\u60c5\u51b5\u4e0b API \u662f\u6fc0\u6d3b\u7684\u3002\u5982\u679c\u9700\u8981\uff0c\u53ef\u4ee5\u901a\u8fc7\u5728 src/config.php \u4e2d\u6dfb\u52a0\u4ee5\u4e0b\u5185\u5bb9\u6765\u5feb\u901f\u5173\u95ed\u6240\u6709 API \u8bbf\u95ee\uff1a $config['enableApi'] = false; API \u5bc6\u94a5 \u00b6 \u901a\u8fc7\u7ba1\u7406\u5458\u63a7\u5236\u9762\u677f\u5230 \u8bbe\u7f6e > API \u5bc6\u94a5 \u521b\u5efa API \u5bc6\u94a5\u3002 \u7531\u4e8e\u751f\u6210 API \u5bc6\u94a5\u53ef\u4ee5\u5141\u8bb8\u8bbf\u95ee\u9ad8\u5ea6\u7279\u6743\u7684\u6570\u636e\uff0c\u56e0\u6b64\u53ea\u6709\u8d85\u7ea7\u7ba1\u7406\u5458\u53ef\u4ee5\u8bbf\u95ee\u672c\u7cfb\u7edf\u3002 \u5f53\u751f\u6210 API \u5bc6\u94a5\u65f6\uff0c\u6240\u6709\u8d85\u7ea7\u7ba1\u7406\u5458\u90fd\u4f1a\u53ce\u5230\u4e00\u5c01\u90ae\u4ef6\uff0c\u4ee5\u786e\u4fdd\u8bf7\u6c42\u6709\u6548\u3002 \u521b\u5efa\u5bc6\u94a5\u540e\uff0c\u5c06\u751f\u6210\u4e00\u4e2a\u968f\u673a\u5b57\u7b26\u4e32\uff0c\u8be5\u5b57\u7b26\u4e32\u5c06\u7528\u4e8e\u901a\u8fc7 API \u8fdb\u884c\u8eab\u5206\u9a8c\u8bc1\u3002 \u5c06\u6b64\u5bc6\u94a5\u4fdd\u5bc6\u662f\u5f88\u91cd\u8981\u7684\u3002 \u5982\u679c\u60a8\u8ba4\u4e3a API \u5bc6\u94a5\u5df2\u88ab\u76d7\u7528\uff0c\u4f60\u5e94\u8be5\u7acb\u5373\u91cd\u65b0\u751f\u6210\u65b0\u7684\u5bc6\u94a5\u5e76\u66f4\u65b0\u4efb\u4f55\u4f7f\u7528\u65e7\u5bc6\u94a5\u7684\u4ee3\u7801\u3002 \u5bc6\u94a5\u7c7b\u578b \u00b6 \u6240\u6709\u7684 API \u8bbf\u95ee\u90fd\u662f\u5728\u7279\u5b9a\u7528\u6237\u7684 Context \u4e2d\u8fdb\u884c\u7684\u3002 \u4f8b\u5982\uff0c\u5982\u679c\u6211\u4ee5 \"John\" \u7684\u8eab\u5206\u8bbf\u95ee API\uff0c\u5e76\u4e14\u6211\u63d0\u51fa\u4e86\u4e00\u4e2a\u53d1\u5e03\u4e3b\u9898\u7684\u8bf7\u6c42\uff0c\u90a3\u9ebd\u8fd9\u4e2a\u4e3b\u9898\u5c06\u7531 \"John\" \u521b\u5efa\u3002 \u5728\u5927\u591a\u6570\u60c5\u51b5\u4e0b\uff0cAPI \u4e5f\u4f1a\u9075\u5b88\u4e3a\u8fd9\u4e2a\u7528\u6237\u6307\u5b9a\u5bf9\u5e94\u7684\u6743\u9650\uff0c\u6240\u4ee5\u4ed6\u4eec\u4e0d\u80fd\u8bbf\u95ee\u4ed6\u4eec\u5728\u6b63\u5e38\u6d4f\u89c8\u8bba\u575b\u65f6\u770b\u4e0d\u5230\u7684\u6570\u636e\u3002 \u4e3a\u4e86\u5bf9\u6b64\u8fdb\u884c\u63a7\u5236\uff0c\u5171\u6709\u4e09\u79cd\u7c7b\u578b\u7684 API \u5bc6\u94a5\uff1a \u8bbf\u5ba2\u5bc6\u94a5 - \u6b64\u5bc6\u94a5\u603b\u662f\u4ee5\u8bbf\u5ba2\u7528\u6237\u8eab\u5206\u5b58\u53d6 API\u3002\u8fd9\u4e9b\u8bf7\u6c42\u5c06\u59cb\u7ec8\u9075\u5b88\u8bbf\u5ba2\u7684\u6743\u9650\u3002\u4f8b\u5982\uff0c\u5982\u679c\u5ba2\u4eba\u4e0d\u80fd\u56de\u8986\u4e3b\u9898\uff0c\u90a3\u9ebd\u56de\u8986\u4e3b\u9898\u7684 API \u8bf7\u6c42\u5c06\u751f\u6210\u4e00\u4e2a\u6ca1\u6709\u6743\u9650\u7684\u9519\u8bef\u3002 \u7528\u6237\u5bc6\u94a5 - \u8fd9\u4e2a\u5bc6\u94a5\u603b\u662f\u4ee5\u6307\u5b9a\u7528\u6237\u7684\u8eab\u5206\u8bbf\u95ee API\uff0c\u5e76\u59cb\u7ec8\u9075\u5b88\u8be5\u7528\u6237\u7684\u6743\u9650\uff0c\u7c7b\u4f3c\u4e8e\u8bbf\u5ba2\u5bc6\u94a5\u3002 \u8d85\u7ea7\u7528\u6237\u5bc6\u94a5 - \u8fd9\u4e2a\u5bc6\u94a5\u53ef\u4ee5\u901a\u8fc7\u4f20\u9012\u4e00\u4e2a\u989d\u5916\u7684\u503c\uff0c\u4ee5\u4efb\u4f55\u7528\u6237\u7684\u8eab\u5206\u8bbf\u95ee API\u3002\uff08\u53ef\u9009\uff09\u6b64\u5bc6\u94a5\u53ef\u4ee5\u7ed5\u8fc7\u7528\u6237\u53d1\u51fa\u8bf7\u6c42\u7684\u6743\u9650\uff0c\u4ece\u800c\u5141\u8bb8\u4ed6\u4eec\u8fd0\u884c\u64cd\u4f5c\u6216\u67e5\u770b\u901a\u5e38\u4e0d\u5177\u6709\u8bbf\u95ee\u6743\u9650\u7684\u5185\u5bb9\u3002 \u8d85\u7ea7\u7528\u6237\u5bc6\u94a5\u5bf9\u4e8e\u4e0e\u5176\u4ed6\u7cfb\u7edf\u6216\u5e94\u7528\u7a0b\u5e8f\u7684\u6574\u5408\u975e\u5e38\u6709\u7528\u3002 \u4f8b\u5982\uff0c\u60a8\u53ef\u80fd\u4f1a\u4e0e\u7b2c\u4e09\u65b9 CMS \u6574\u5408\uff0c\u6bcf\u5f53\u60a8\u53d1\u5e03\u4e00\u7bc7\u65b0\u6587\u7ae0\u65f6\uff0c\u8be5 CMS \u5c31\u4f1a\u521b\u5efa\u4e00\u4e2a\u4e3b\u9898\u3002 \u8fd9\u79cd\u7c7b\u578b\u7684\u5bc6\u94a5\u5c06\u5141\u8bb8\u60a8\u6839\u636e\u6587\u7ae0\u4f5c\u8005\u6216\u5728\u7528\u6237\u901a\u5e38\u4e0d\u80fd\u53d1\u5e03\u7684\u8bba\u575b\u4e2d\u521b\u5efa\u4e00\u4e2a\u4e0d\u540c\u7528\u6237\u7684\u4e3b\u9898\u3002 \u5bc6\u94a5\u4f5c\u7528\u57df \u00b6 \u4e3a\u4e86\u5e2e\u52a9\u9650\u5236\u88ab\u6cc4\u9732\u7684\u5bc6\u94a5\u6240\u9020\u6210\u7684\u635f\u5bb3\uff0c\u6bcf\u4e2a\u5bc6\u94a5\u90fd\u53ef\u4ee5\u63a7\u5236\u5176\u53ef\u4ee5\u8bbf\u95ee\u7684 API \u4f5c\u7528\u57df\u3002 \u4f5c\u7528\u57df\u9650\u5236\u4e86\u5bf9 API \u533a\u57df\u7684\u8bbf\u95ee\uff0c\u4e0e\u7528\u6237\u7684\u8bf7\u6c42\u6743\u9650\u65e0\u5173\u3002 API \u4e2d\u7684\u6bcf\u4e2a\u7aef\u70b9\u90fd\u4f1a\u88ab\u4e00\u4e2a\u6216\u591a\u4e2a\u4f5c\u7528\u57df\u6240\u590d\u76d6\u3002\u5982\u679c API \u6ca1\u6709\u88ab\u6388\u4e88\u4efb\u4f55\u8fd9\u4e9b\u4f5c\u7528\u57df\uff0c\u5219\u8bf7\u6c42\u5c06\u5931\u8d25\u3002 \u4e3a\u4e86\u5b89\u5168\u8d77\u89c1\uff0c\u6211\u4eec\u5efa\u8bae\u60a8\u4ec5\u4e3a\u5bc6\u94a5\u6388\u4e88\u6240\u9700\u7684\u4f5c\u7528\u57df\u3002\u5982\u679c\u60a8\u5728\u4ee5\u540e\u9700\u8981\u5176\u4ed6\u7684\u4f5c\u7528\u57df\uff0c\u5219\u53ef\u4ee5\u5728\u9700\u8981\u65f6\u6dfb\u52a0\u5b83\u4eec\u3002 \u8bbf\u95ee API \u00b6 \u4e00\u65e6\u77e5\u9053\u8bbf\u95ee API \u7684 URL \u5e76\u83b7\u5f97\u5bc6\u94a5\u540e\uff0c\u5c31\u53ef\u4ee5\u5f00\u59cb\u5bf9\u5176\u53d1\u51fa\u8bf7\u6c42\u3002 \u6240\u6709\u7684 API Response \u90fd\u5c06\u4ee5 JSON \u683c\u5f0f\u8fd4\u56de\uff0c\u9664\u975e\u662f\u7279\u522b\u8981\u6c42\u4e8c\u8fdb\u5236\u6587\u4ef6\uff08\u4f8b\u5982\uff0c\u4e0b\u8f7d\u9644\u4ef6\u65f6\uff09\u3002\u9519\u8bef\u5c06\u8fd4\u56de\u4e00\u4e2a 400 \u8303\u56f4\u5185\u7684 Response \u72b6\u6001\u7801\u3002\u6210\u529f\u7684\u8bf7\u6c42\u5c06\u8fd4\u56de\u4e00\u4e2a 200 \u72b6\u6001\u7801\u3002\u867d\u7136\u4e0d\u5e38\u7528\uff0c\u4f46\u91cd\u5b9a\u5411\u5c06\u8fd4\u56de\u4e00\u4e2a 300 \u8303\u56f4\u7684\u72b6\u6001\u7801\u3002 Request body \u5fc5\u987b\u4f7f\u7528 application/x-www-form-urlencoded \u7f16\u7801\u53d1\u9001\uff0c\u6216\u8005\uff0c\u5982\u679c\u662f\u4e0a\u4f20\u6587\u4ef6\uff0c\u5219\u4f7f\u7528 multipart/form-data \u7f16\u7801\u53d1\u9001\u3002\u53c2\u6570\u4e5f\u53ef\u4ee5\u901a\u8fc7\u67e5\u627e\u5b57\u7b26\u4e32\u6765\u4f20\u9012\u3002 \u6240\u6709 Request \u6570\u636e\u5fc5\u987b\u4f7f\u7528 UTF-8 \u5b57\u7b26\u96c6\u3002 Request \u5fc5\u987b\u901a\u8fc7 XF-API-Key Header \u4f20\u9012\u8981\u4f7f\u7528\u7684 API \u5bc6\u94a5\u3002\u6240\u6709 Request \u4e2d\u90fd\u5fc5\u987b\u6709\u8fd9\u4e2a\u5bc6\u94a5\u3002 \u5982\u679c\u9009\u62e9\u7684 API \u5bc6\u94a5\u662f\u8d85\u7ea7\u7528\u6237\u5bc6\u94a5\uff0c\u4f60\u53ef\u4ee5\u901a\u8fc7 XF-API-User Header \u4f20\u9012 Context User \u7684\u7528\u6237ID\u3002 \u5982\u679c\u6ca1\u6709\u4f20\u9012\u7528\u6237 ID\uff0cContext \u5c06\u9ed8\u8ba4\u4e3a\u8bbf\u5ba2\u3002 \u5982\u679c Request \u662f\u7528\u8d85\u7ea7\u7528\u6237\u5bc6\u94a5\u53d1\u51fa\u7684\uff0c\u5e76\u4e14\u4f60\u5e0c\u671b\u7ed5\u8fc7 Context User \u7684\u6743\u9650\uff0c\u5219\u53ef\u4ee5\u901a\u8fc7\u5c06 api_bypass_permissions \u53c2\u6570\u8bbe\u7f6e\u4e3a 1 \u6765\u5b9e\u73b0\u3002(\u8fd9\u4e2a\u53c2\u6570\u53ef\u4ee5\u901a\u8fc7 query string \u6216\u4f5c\u4e3a Request body \u7684\u4e00\u90e8\u5206\u6765\u8fdb\u884c\u4f20\u9012\u3002) \u9519\u8bef\u5904\u7406 \u00b6 \u5f53\u9047\u5230 Error \u65f6\uff0cresponse \u72b6\u6001\u7801\u5c06\u5728 400 \u8303\u56f4\u5185\u3002\u6709\u65f6\uff0c\u53ef\u80fd\u4f1a\u51fa\u73b0 500 \u8303\u56f4\u7684\u9519\u8bef\uff0c\u4e0d\u8fc7\u8fd9\u8868\u660e\u670d\u52a1\u5668\u65e0\u6cd5\u5904\u7406\u8be5 request\u3002 API \u53ef\u80fd\u88ab\u6682\u65f6\u5173\u95ed\uff0c\u6216\u8005\u53d1\u751f\u4e86\u5176\u4ed6\u670d\u52a1\u5668\u9519\u8bef\u3002 \u9519\u8bef\u6d88\u606f\u5177\u6709\u6807\u51c6\u683c\u5f0f\u3002 \u8fd9\u662f\u4e00\u4e2a\u4f8b\u5b50\uff1a { \"errors\": [ { \"code\": \"api_key_not_found\", \"message\": \"\u672a\u627e\u5230 Request \u4e2d\u63d0\u4f9b\u7684 API \u5bc6\u94a5\u3002\", \"params\": [] } ] } \u6700\u4e0a\u5c42\u5c06\u662f\u4e00\u4e2a\u5e2f\u6709 errors key \u7684\u7269\u4ef6\u3002\u8fd9\u5c06\u662f\u5305\u542b 1 \u4e2a\u6216\u591a\u4e2a entry \u7684\u6570\u7ec4\u3002\u6bcf\u4e2a entry \u90fd\u662f\u4e00\u4e2a\u7269\u4ef6\uff0c\u53c2\u6570\u5982\u4e0b\uff1a code - \u8fd9\u662f\u673a\u5668\u53ef\u4ee5\u8bfb\u61c2\u7684\u9519\u8bef\u7801\u3002 \u6709\u8bb8\u591a\u53ef\u80fd\u7684\u9519\u8bef\u7801\uff0c\u56e0\u4e3a\u5b83\u4eec\u53d6\u51b3\u4e8e\u60c5\u51b5\u3002 message - \u4eba\u7c7b\u53ef\u4ee5\u8bfb\u61c2\u7684\u9519\u8bef\u6d88\u606f\u3002 \u8fd9\u53ef\u80fd\u4f1a\u6539\u53d8\uff0c\u4e5f\u53ef\u80fd\u4f1a\u88ab\u7ffb\u8bd1\uff0c\u4e0d\u5e94\u8be5\u7528\u4e8e\u8bc6\u522b\u9519\u8bef\u7c7b\u578b\u3002 params - \u8fd9\u662f\u89e6\u53d1\u9519\u8bef\u76f8\u5173\u7684 key-value \u53c2\u6570\u8868\u8868\u3002\u5b83\u4eec\u53ef\u4ee5\u8865\u5145\u9519\u8bef\u7801\u548c\u6d88\u606f\uff0c\u4ee5\u63d0\u4f9b\u6709\u5173\u9519\u8bef\u7684\u66f4\u591a\u660e\u786e\u7684\u8be6\u7ec6\u6d88\u606f\u3002 API \u7aef\u70b9 \u00b6 \u8be5 API \u5177\u6709\u8bb8\u591a Endpoints \u548c\u53ef\u4ee5\u91c7\u53d6\u7684\u63aa\u65bd\u3002\u5c06\u6765\u53ef\u80fd\u4f1a\u6dfb\u52a0\u5176\u4ed6 Endpoint \u548c\u6570\u636e\u3002 \u67e5\u770b API \u7aef\u70b9\u6587\u6863 \u8be5 Endpoint \u6587\u6863\u662f\u6839\u636e API \u6570\u636e\u548c\u4ee3\u7801\u4e2d\u7684\u6ce8\u91ca\u751f\u6210\u7684\u3002\u5b83\u5c06\u968f\u7740\u65f6\u95f4\u7684\u63a8\u79fb\u8fdb\u884c\u6269\u5c55\u548c\u66f4\u65b0\u3002","title":"REST API"},{"location":"rest-api/#rest-api","text":"\u5728 XenForo 2.1 \u4e2d\uff0c\u6dfb\u52a0\u4e86 REST API\u3002\u8fd9\u4f7f\u60a8\u53ef\u4ee5\u901a\u8fc7\u7f16\u7a0b\u7684\u65b9\u5f0f\u4e0e XenForo \u5b89\u88c5\u7684\u8bb8\u591a\u533a\u57df\u8fdb\u884c\u4ea4\u4e92\u3002 \u8981\u8bbf\u95ee API\uff0c\u9700\u8981\u901a\u8fc7\u7ba1\u7406\u5458\u63a7\u5236\u9762\u677f\u751f\u6210\u5bc6\u94a5\u3002\u672a\u7ecf\u8ba4\u8bc1\u7684 API \u6ca1\u6709\u529e\u6cd5\u8bbf\u95ee\uff0c\u6b64\u65f6\u7528\u6237\u4e5f\u4e0d\u80fd\u81ea\u5df1\u751f\u6210\u5bc6\u94a5\u6765\u8bbf\u95ee API\u3002 \u7279\u5b9a XenForo \u5b89\u88c5\u7684 API \u53ef\u901a\u8fc7 <XenForo \u57fa\u672c URL>/api/ \u8bbf\u95ee\u3002\u6240\u6709\u7aef\u70b9\u90fd\u4ee5\u8be5 URL \u4e3a\u524d\u7f00\u3002\u4f8b\u5982\uff0c\u5982\u679c XenForo \u5b89\u88c5\u5728 https://example.com/community/ \uff0c\u90a3\u9ebdAPI URL\u5c06\u4ee5 https://example.com/community/api/ \u5f00\u5934\u3002\u5728\u672c\u4f8b\u4e2d\uff0c\u8bbf\u95ee\u7ebf\u7a0b\u5217\u8868\u53ef\u901a\u8fc7 https://example.com/community/api/threads/ \u8fdb\u884c\u3002 \u9ed8\u8ba4\u60c5\u51b5\u4e0b API \u662f\u6fc0\u6d3b\u7684\u3002\u5982\u679c\u9700\u8981\uff0c\u53ef\u4ee5\u901a\u8fc7\u5728 src/config.php \u4e2d\u6dfb\u52a0\u4ee5\u4e0b\u5185\u5bb9\u6765\u5feb\u901f\u5173\u95ed\u6240\u6709 API \u8bbf\u95ee\uff1a $config['enableApi'] = false;","title":"REST API"},{"location":"rest-api/#api","text":"\u901a\u8fc7\u7ba1\u7406\u5458\u63a7\u5236\u9762\u677f\u5230 \u8bbe\u7f6e > API \u5bc6\u94a5 \u521b\u5efa API \u5bc6\u94a5\u3002 \u7531\u4e8e\u751f\u6210 API \u5bc6\u94a5\u53ef\u4ee5\u5141\u8bb8\u8bbf\u95ee\u9ad8\u5ea6\u7279\u6743\u7684\u6570\u636e\uff0c\u56e0\u6b64\u53ea\u6709\u8d85\u7ea7\u7ba1\u7406\u5458\u53ef\u4ee5\u8bbf\u95ee\u672c\u7cfb\u7edf\u3002 \u5f53\u751f\u6210 API \u5bc6\u94a5\u65f6\uff0c\u6240\u6709\u8d85\u7ea7\u7ba1\u7406\u5458\u90fd\u4f1a\u53ce\u5230\u4e00\u5c01\u90ae\u4ef6\uff0c\u4ee5\u786e\u4fdd\u8bf7\u6c42\u6709\u6548\u3002 \u521b\u5efa\u5bc6\u94a5\u540e\uff0c\u5c06\u751f\u6210\u4e00\u4e2a\u968f\u673a\u5b57\u7b26\u4e32\uff0c\u8be5\u5b57\u7b26\u4e32\u5c06\u7528\u4e8e\u901a\u8fc7 API \u8fdb\u884c\u8eab\u5206\u9a8c\u8bc1\u3002 \u5c06\u6b64\u5bc6\u94a5\u4fdd\u5bc6\u662f\u5f88\u91cd\u8981\u7684\u3002 \u5982\u679c\u60a8\u8ba4\u4e3a API \u5bc6\u94a5\u5df2\u88ab\u76d7\u7528\uff0c\u4f60\u5e94\u8be5\u7acb\u5373\u91cd\u65b0\u751f\u6210\u65b0\u7684\u5bc6\u94a5\u5e76\u66f4\u65b0\u4efb\u4f55\u4f7f\u7528\u65e7\u5bc6\u94a5\u7684\u4ee3\u7801\u3002","title":"API \u5bc6\u94a5"},{"location":"rest-api/#_1","text":"\u6240\u6709\u7684 API \u8bbf\u95ee\u90fd\u662f\u5728\u7279\u5b9a\u7528\u6237\u7684 Context \u4e2d\u8fdb\u884c\u7684\u3002 \u4f8b\u5982\uff0c\u5982\u679c\u6211\u4ee5 \"John\" \u7684\u8eab\u5206\u8bbf\u95ee API\uff0c\u5e76\u4e14\u6211\u63d0\u51fa\u4e86\u4e00\u4e2a\u53d1\u5e03\u4e3b\u9898\u7684\u8bf7\u6c42\uff0c\u90a3\u9ebd\u8fd9\u4e2a\u4e3b\u9898\u5c06\u7531 \"John\" \u521b\u5efa\u3002 \u5728\u5927\u591a\u6570\u60c5\u51b5\u4e0b\uff0cAPI \u4e5f\u4f1a\u9075\u5b88\u4e3a\u8fd9\u4e2a\u7528\u6237\u6307\u5b9a\u5bf9\u5e94\u7684\u6743\u9650\uff0c\u6240\u4ee5\u4ed6\u4eec\u4e0d\u80fd\u8bbf\u95ee\u4ed6\u4eec\u5728\u6b63\u5e38\u6d4f\u89c8\u8bba\u575b\u65f6\u770b\u4e0d\u5230\u7684\u6570\u636e\u3002 \u4e3a\u4e86\u5bf9\u6b64\u8fdb\u884c\u63a7\u5236\uff0c\u5171\u6709\u4e09\u79cd\u7c7b\u578b\u7684 API \u5bc6\u94a5\uff1a \u8bbf\u5ba2\u5bc6\u94a5 - \u6b64\u5bc6\u94a5\u603b\u662f\u4ee5\u8bbf\u5ba2\u7528\u6237\u8eab\u5206\u5b58\u53d6 API\u3002\u8fd9\u4e9b\u8bf7\u6c42\u5c06\u59cb\u7ec8\u9075\u5b88\u8bbf\u5ba2\u7684\u6743\u9650\u3002\u4f8b\u5982\uff0c\u5982\u679c\u5ba2\u4eba\u4e0d\u80fd\u56de\u8986\u4e3b\u9898\uff0c\u90a3\u9ebd\u56de\u8986\u4e3b\u9898\u7684 API \u8bf7\u6c42\u5c06\u751f\u6210\u4e00\u4e2a\u6ca1\u6709\u6743\u9650\u7684\u9519\u8bef\u3002 \u7528\u6237\u5bc6\u94a5 - \u8fd9\u4e2a\u5bc6\u94a5\u603b\u662f\u4ee5\u6307\u5b9a\u7528\u6237\u7684\u8eab\u5206\u8bbf\u95ee API\uff0c\u5e76\u59cb\u7ec8\u9075\u5b88\u8be5\u7528\u6237\u7684\u6743\u9650\uff0c\u7c7b\u4f3c\u4e8e\u8bbf\u5ba2\u5bc6\u94a5\u3002 \u8d85\u7ea7\u7528\u6237\u5bc6\u94a5 - \u8fd9\u4e2a\u5bc6\u94a5\u53ef\u4ee5\u901a\u8fc7\u4f20\u9012\u4e00\u4e2a\u989d\u5916\u7684\u503c\uff0c\u4ee5\u4efb\u4f55\u7528\u6237\u7684\u8eab\u5206\u8bbf\u95ee API\u3002\uff08\u53ef\u9009\uff09\u6b64\u5bc6\u94a5\u53ef\u4ee5\u7ed5\u8fc7\u7528\u6237\u53d1\u51fa\u8bf7\u6c42\u7684\u6743\u9650\uff0c\u4ece\u800c\u5141\u8bb8\u4ed6\u4eec\u8fd0\u884c\u64cd\u4f5c\u6216\u67e5\u770b\u901a\u5e38\u4e0d\u5177\u6709\u8bbf\u95ee\u6743\u9650\u7684\u5185\u5bb9\u3002 \u8d85\u7ea7\u7528\u6237\u5bc6\u94a5\u5bf9\u4e8e\u4e0e\u5176\u4ed6\u7cfb\u7edf\u6216\u5e94\u7528\u7a0b\u5e8f\u7684\u6574\u5408\u975e\u5e38\u6709\u7528\u3002 \u4f8b\u5982\uff0c\u60a8\u53ef\u80fd\u4f1a\u4e0e\u7b2c\u4e09\u65b9 CMS \u6574\u5408\uff0c\u6bcf\u5f53\u60a8\u53d1\u5e03\u4e00\u7bc7\u65b0\u6587\u7ae0\u65f6\uff0c\u8be5 CMS \u5c31\u4f1a\u521b\u5efa\u4e00\u4e2a\u4e3b\u9898\u3002 \u8fd9\u79cd\u7c7b\u578b\u7684\u5bc6\u94a5\u5c06\u5141\u8bb8\u60a8\u6839\u636e\u6587\u7ae0\u4f5c\u8005\u6216\u5728\u7528\u6237\u901a\u5e38\u4e0d\u80fd\u53d1\u5e03\u7684\u8bba\u575b\u4e2d\u521b\u5efa\u4e00\u4e2a\u4e0d\u540c\u7528\u6237\u7684\u4e3b\u9898\u3002","title":"\u5bc6\u94a5\u7c7b\u578b"},{"location":"rest-api/#_2","text":"\u4e3a\u4e86\u5e2e\u52a9\u9650\u5236\u88ab\u6cc4\u9732\u7684\u5bc6\u94a5\u6240\u9020\u6210\u7684\u635f\u5bb3\uff0c\u6bcf\u4e2a\u5bc6\u94a5\u90fd\u53ef\u4ee5\u63a7\u5236\u5176\u53ef\u4ee5\u8bbf\u95ee\u7684 API \u4f5c\u7528\u57df\u3002 \u4f5c\u7528\u57df\u9650\u5236\u4e86\u5bf9 API \u533a\u57df\u7684\u8bbf\u95ee\uff0c\u4e0e\u7528\u6237\u7684\u8bf7\u6c42\u6743\u9650\u65e0\u5173\u3002 API \u4e2d\u7684\u6bcf\u4e2a\u7aef\u70b9\u90fd\u4f1a\u88ab\u4e00\u4e2a\u6216\u591a\u4e2a\u4f5c\u7528\u57df\u6240\u590d\u76d6\u3002\u5982\u679c API \u6ca1\u6709\u88ab\u6388\u4e88\u4efb\u4f55\u8fd9\u4e9b\u4f5c\u7528\u57df\uff0c\u5219\u8bf7\u6c42\u5c06\u5931\u8d25\u3002 \u4e3a\u4e86\u5b89\u5168\u8d77\u89c1\uff0c\u6211\u4eec\u5efa\u8bae\u60a8\u4ec5\u4e3a\u5bc6\u94a5\u6388\u4e88\u6240\u9700\u7684\u4f5c\u7528\u57df\u3002\u5982\u679c\u60a8\u5728\u4ee5\u540e\u9700\u8981\u5176\u4ed6\u7684\u4f5c\u7528\u57df\uff0c\u5219\u53ef\u4ee5\u5728\u9700\u8981\u65f6\u6dfb\u52a0\u5b83\u4eec\u3002","title":"\u5bc6\u94a5\u4f5c\u7528\u57df"},{"location":"rest-api/#api_1","text":"\u4e00\u65e6\u77e5\u9053\u8bbf\u95ee API \u7684 URL \u5e76\u83b7\u5f97\u5bc6\u94a5\u540e\uff0c\u5c31\u53ef\u4ee5\u5f00\u59cb\u5bf9\u5176\u53d1\u51fa\u8bf7\u6c42\u3002 \u6240\u6709\u7684 API Response \u90fd\u5c06\u4ee5 JSON \u683c\u5f0f\u8fd4\u56de\uff0c\u9664\u975e\u662f\u7279\u522b\u8981\u6c42\u4e8c\u8fdb\u5236\u6587\u4ef6\uff08\u4f8b\u5982\uff0c\u4e0b\u8f7d\u9644\u4ef6\u65f6\uff09\u3002\u9519\u8bef\u5c06\u8fd4\u56de\u4e00\u4e2a 400 \u8303\u56f4\u5185\u7684 Response \u72b6\u6001\u7801\u3002\u6210\u529f\u7684\u8bf7\u6c42\u5c06\u8fd4\u56de\u4e00\u4e2a 200 \u72b6\u6001\u7801\u3002\u867d\u7136\u4e0d\u5e38\u7528\uff0c\u4f46\u91cd\u5b9a\u5411\u5c06\u8fd4\u56de\u4e00\u4e2a 300 \u8303\u56f4\u7684\u72b6\u6001\u7801\u3002 Request body \u5fc5\u987b\u4f7f\u7528 application/x-www-form-urlencoded \u7f16\u7801\u53d1\u9001\uff0c\u6216\u8005\uff0c\u5982\u679c\u662f\u4e0a\u4f20\u6587\u4ef6\uff0c\u5219\u4f7f\u7528 multipart/form-data \u7f16\u7801\u53d1\u9001\u3002\u53c2\u6570\u4e5f\u53ef\u4ee5\u901a\u8fc7\u67e5\u627e\u5b57\u7b26\u4e32\u6765\u4f20\u9012\u3002 \u6240\u6709 Request \u6570\u636e\u5fc5\u987b\u4f7f\u7528 UTF-8 \u5b57\u7b26\u96c6\u3002 Request \u5fc5\u987b\u901a\u8fc7 XF-API-Key Header \u4f20\u9012\u8981\u4f7f\u7528\u7684 API \u5bc6\u94a5\u3002\u6240\u6709 Request \u4e2d\u90fd\u5fc5\u987b\u6709\u8fd9\u4e2a\u5bc6\u94a5\u3002 \u5982\u679c\u9009\u62e9\u7684 API \u5bc6\u94a5\u662f\u8d85\u7ea7\u7528\u6237\u5bc6\u94a5\uff0c\u4f60\u53ef\u4ee5\u901a\u8fc7 XF-API-User Header \u4f20\u9012 Context User \u7684\u7528\u6237ID\u3002 \u5982\u679c\u6ca1\u6709\u4f20\u9012\u7528\u6237 ID\uff0cContext \u5c06\u9ed8\u8ba4\u4e3a\u8bbf\u5ba2\u3002 \u5982\u679c Request \u662f\u7528\u8d85\u7ea7\u7528\u6237\u5bc6\u94a5\u53d1\u51fa\u7684\uff0c\u5e76\u4e14\u4f60\u5e0c\u671b\u7ed5\u8fc7 Context User \u7684\u6743\u9650\uff0c\u5219\u53ef\u4ee5\u901a\u8fc7\u5c06 api_bypass_permissions \u53c2\u6570\u8bbe\u7f6e\u4e3a 1 \u6765\u5b9e\u73b0\u3002(\u8fd9\u4e2a\u53c2\u6570\u53ef\u4ee5\u901a\u8fc7 query string \u6216\u4f5c\u4e3a Request body \u7684\u4e00\u90e8\u5206\u6765\u8fdb\u884c\u4f20\u9012\u3002)","title":"\u8bbf\u95ee API"},{"location":"rest-api/#_3","text":"\u5f53\u9047\u5230 Error \u65f6\uff0cresponse \u72b6\u6001\u7801\u5c06\u5728 400 \u8303\u56f4\u5185\u3002\u6709\u65f6\uff0c\u53ef\u80fd\u4f1a\u51fa\u73b0 500 \u8303\u56f4\u7684\u9519\u8bef\uff0c\u4e0d\u8fc7\u8fd9\u8868\u660e\u670d\u52a1\u5668\u65e0\u6cd5\u5904\u7406\u8be5 request\u3002 API \u53ef\u80fd\u88ab\u6682\u65f6\u5173\u95ed\uff0c\u6216\u8005\u53d1\u751f\u4e86\u5176\u4ed6\u670d\u52a1\u5668\u9519\u8bef\u3002 \u9519\u8bef\u6d88\u606f\u5177\u6709\u6807\u51c6\u683c\u5f0f\u3002 \u8fd9\u662f\u4e00\u4e2a\u4f8b\u5b50\uff1a { \"errors\": [ { \"code\": \"api_key_not_found\", \"message\": \"\u672a\u627e\u5230 Request \u4e2d\u63d0\u4f9b\u7684 API \u5bc6\u94a5\u3002\", \"params\": [] } ] } \u6700\u4e0a\u5c42\u5c06\u662f\u4e00\u4e2a\u5e2f\u6709 errors key \u7684\u7269\u4ef6\u3002\u8fd9\u5c06\u662f\u5305\u542b 1 \u4e2a\u6216\u591a\u4e2a entry \u7684\u6570\u7ec4\u3002\u6bcf\u4e2a entry \u90fd\u662f\u4e00\u4e2a\u7269\u4ef6\uff0c\u53c2\u6570\u5982\u4e0b\uff1a code - \u8fd9\u662f\u673a\u5668\u53ef\u4ee5\u8bfb\u61c2\u7684\u9519\u8bef\u7801\u3002 \u6709\u8bb8\u591a\u53ef\u80fd\u7684\u9519\u8bef\u7801\uff0c\u56e0\u4e3a\u5b83\u4eec\u53d6\u51b3\u4e8e\u60c5\u51b5\u3002 message - \u4eba\u7c7b\u53ef\u4ee5\u8bfb\u61c2\u7684\u9519\u8bef\u6d88\u606f\u3002 \u8fd9\u53ef\u80fd\u4f1a\u6539\u53d8\uff0c\u4e5f\u53ef\u80fd\u4f1a\u88ab\u7ffb\u8bd1\uff0c\u4e0d\u5e94\u8be5\u7528\u4e8e\u8bc6\u522b\u9519\u8bef\u7c7b\u578b\u3002 params - \u8fd9\u662f\u89e6\u53d1\u9519\u8bef\u76f8\u5173\u7684 key-value \u53c2\u6570\u8868\u8868\u3002\u5b83\u4eec\u53ef\u4ee5\u8865\u5145\u9519\u8bef\u7801\u548c\u6d88\u606f\uff0c\u4ee5\u63d0\u4f9b\u6709\u5173\u9519\u8bef\u7684\u66f4\u591a\u660e\u786e\u7684\u8be6\u7ec6\u6d88\u606f\u3002","title":"\u9519\u8bef\u5904\u7406"},{"location":"rest-api/#api_2","text":"\u8be5 API \u5177\u6709\u8bb8\u591a Endpoints \u548c\u53ef\u4ee5\u91c7\u53d6\u7684\u63aa\u65bd\u3002\u5c06\u6765\u53ef\u80fd\u4f1a\u6dfb\u52a0\u5176\u4ed6 Endpoint \u548c\u6570\u636e\u3002 \u67e5\u770b API \u7aef\u70b9\u6587\u6863 \u8be5 Endpoint \u6587\u6863\u662f\u6839\u636e API \u6570\u636e\u548c\u4ee3\u7801\u4e2d\u7684\u6ce8\u91ca\u751f\u6210\u7684\u3002\u5b83\u5c06\u968f\u7740\u65f6\u95f4\u7684\u63a8\u79fb\u8fdb\u884c\u6269\u5c55\u548c\u66f4\u65b0\u3002","title":"API \u7aef\u70b9"},{"location":"routing-basics/","text":"\u8def\u7531\u57fa\u7840\u77e5\u8bc6 \u00b6 \u5728 PHP \u5e94\u7528\u7a0b\u5e8f\u4e2d\uff0c\u8c61\u662f XF2\uff0c\u6211\u4eec\u9700\u8981\u4e00\u79cd\u80fd\u591f\u63a5\u53d7\u7528\u6237\u5bf9\u7279\u5b9a URL \u7684\u8bf7\u6c42\u7684\u65b9\u6cd5\uff0c\u4e86\u89e3\u8be5 URL \u4ee3\u8868\u7684 controller\u3001 action \u548c\u6570\u636e\uff0c\u4ee5\u4fbf\u5411\u7528\u6237\u63d0\u4f9b\u9002\u5f53\u7684\u54cd\u5e94\u3002 \u5c06\u4e00\u4e2a URL \u8ee2\u6362\u4e3a\u4ee3\u7801\u4e2d\u7684\u4e00\u4e2a\u4f4d\u7f6e\u7684\u6982\u5ff5\u88ab\u79f0\u4e3a \"\u8def\u7531\"\u3002 \u5728 XF2 \u4e2d\uff0c\u8def\u7531\u9009\u62e9\u51e0\u4e4e\u5b8c\u5168\u7531 Admin CP \u4e2d\u7684\u4e00\u4e2a\u4f4d\u7f6e\u7ba1\u7406\u3002 \u8be5\u4f4d\u7f6e\u662f Admin CP > Development > Routes \u3002 \u8def\u7531\u6309\u4e24\u79cd\u7c7b\u578b\u4e4b\u4e00\u5206\u7ec4\uff0c\u5373 Public \u548c Admin \u7c7b\u578b\uff0c\u5b83\u4eec\u5206\u522b\u5728 Public \u548c Admin \u5e94\u7528\u7a0b\u5e8f\u4e2d\u63d0\u4f9b\u8bf7\u6c42\u7684\u8def\u7531\u3002 \u7b80\u5358\u7684\u4f8b\u5b50 \u00b6 \u5728\u8def\u7531\u9875\u9762 (\u89c1\u4e0a\u6587)\uff0c\u4f60\u5e94\u8be5\u770b\u5230\u4e00\u4e2a account/ \u7684\u6761\u76ee\u3002 \u8fd9\u662f\u4e00\u4e2a Public \u8def\u7531\uff0c\u63d0\u4f9b\u4e86\u5bf9 URL index.php?account/ \u7684\u8bf7\u6c42\u7684\u8def\u7531\u3002 \u8fd9\u4e2a\u8def\u7531\u975e\u5e38\u7b80\u5358\uff0c\u5b83\u53ea\u5305\u542b\u4e86\u5c11\u91cf\u7684\u914d\u7f6e\u3002 \u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0c\u5b83\u7531\u4e00\u4e2a \"\u8def\u7531\u524d\u7f00\"\uff0c\u4e00\u4e2a Section context \u548c\u4e00\u4e2a Controller class \u7ec4\u6210\u3002 \u8ba9\u6211\u4eec\u66f4\u8be6\u7ec6\u5730\u4e86\u89e3\u8fd9\u4e9b\u90e8\u5206\uff1a \u8def\u7531\u524d\u7f00 \u00b6 \u8def\u7531\u524d\u7f00\u4e3b\u8981\u662f\u6307\u5728 index.php? \u4e4b\u540e\u548c\u7b2c\u4e00\u4e2a / \u4e4b\u524d\u7684\u4f4d\u7f6e\u3002 \u5b83\u662f\u786e\u5b9a\u8def\u7531\u8bf7\u6c42\u7ed9\u54ea\u4e2a Controller \u7684\u7b2c\u4e00\u6b65\u3002 Section context \u00b6 \u6b64 Section context \u544a\u8bc9 XF \u4e2d\u7684\u5bfc\u89c8\u7cfb\u7edf\uff0c\u5f53\u8bbf\u95ee\u8005\u6d4f\u89c8\u7531\u8be5\u8def\u7531\u8ee2\u5230\u7684\u9875\u9762\u65f6\uff0c\u5e94\u8be5\u9009\u62e9\u54ea\u4e2a\u5bfc\u89c8\u9879\u3002 \u5bf9\u4e8e Public \u8def\u7531\uff0cSection context \u5e94\u8be5\u662f\u6700\u9ad8\u7ea7\u522b\u5bfc\u89c8\u9879\u7684 ID\u3002 \u5bf9\u4e8e Admin \u8def\u7531\uff0c\u5e94\u8be5\u662f\u6700\u7279\u5b9a\u7684\u7ba1\u7406\u5bfc\u89c8\u6761\u76ee\u7684 ID\uff08\u65e0\u8bba\u6df1\u5ea6\uff09\u3002 \u5982\u679c\u662f\u8d26\u6237\u8def\u7531\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cSection context \u4e0d\u4e00\u5b9a\u9002\u7528\uff0c\u56e0\u4e3a\u6211\u4eec\u6ca1\u6709 \"account\" \u5bfc\u89c8\u6807\u7b7e\u3002 \u4f46\u662f\uff0c\u8981\u60f3\u770b\u5230\u8fd9\u4e2a action\uff0c\u53ea\u9700\u5c06\u8fd9\u91cc\u7684 \"Section context\" \u503c\u6539\u4e3a \"forums\"\uff0c\u4fdd\u5b58\u66f4\u6539\u5e76\u5728\u524d\u7aef\u8fdb\u5165\u4f60\u7684\u8d26\u6237\u3002 \u73b0\u5728\uff0c\u4f60\u5e94\u8be5\u770b\u5230 \"Forums\" \u5bfc\u89c8\u6807\u7b7e\u88ab\u9009\u4e2d\u4e86\uff01 Controller \u00b6 \u8fd9\u662f\u5f53\u8bf7\u6c42\u4e0e\u8fd9\u4e2a\u8def\u7531\u5339\u914d\u65f6\uff0c\u5e94\u8be5\u88ab\u8c03\u7528\u7684 Controller \u7684 class \u540d\u3002 \u5728 \"account/\" \u8def\u7531\u4e2d\uff0c\u6211\u4eec\u6307\u5b9a\u4e86 XF:Account \u3002 \u8fd9\u5c06\u52a0\u8f7d Account \u63a7\u5236\u5668\u3002 \uff08\u66f4\u591a\u4fe1\u606f\u8bf7\u53c2\u89c1 \u77ed\u7c7b\u540d \uff09\u3002 \u4ee3\u7801\u4f4d\u4e8e\u4ee5\u4e0b\u4f4d\u7f6e src/XF/Pub/Controller/Account.php \u3002 \u6ce8\u610f\u77ed\u7c7b\u540d\u662f\u5982\u4f55\u89e3\u6790\u4e3a \"infix\" \u4ee5\u53ca\u524d\u7f00 (XF) \u548c\u540e\u7f00 (Account) \u7684\u3002 \u5728\u672c\u4f8b\u4e2d\uff0c\u8fd9\u4e2a\u63a7\u5236\u5668\u7684\u4e0b\u6807 (Pub) \u662f\u7531 Account \u8def\u7531\u7c7b\u578b (public) \u63a8\u65ad\u51fa\u6765\u7684\u3002 Controller action \u00b6 \u4e0a\u9762\u6211\u4eec\u89e3\u91ca\u4e86\u5982\u4f55\u5c06\u8def\u7531\u5339\u914d\u5230\u4e00\u4e2a\u7279\u5b9a\u7684 Controller\uff0c\u4f46\u6211\u4eec\u8fd8\u4e0d\u77e5\u9053\u5982\u4f55\u8c03\u7528\u8be5 Controller \u5185\u7684\u7279\u5b9a action\u3002 Controller \u672c\u8d28\u4e0a\u662f\u4e00\u4e2a\u5305\u542b\u4e86\u8bb8\u591a action \u65b9\u6cd5\u7684 class\uff0cURL \u4e2d \u8def\u7531\u524d\u7f00 \u540e\u9762\u7684\u90e8\u5206\u8868\u793a Controller \u7684 action\u3002 \u7ed9\u5b9a\u4e00\u4e2a URL \u4e3a index.php?account/account-details \uff0c\u4f60\u5e94\u8be5\u88ab\u8def\u7531\u5230 XF/Pub/Controller/Account class \u548c actionAccountDetails() \u65b9\u6cd5\u3002 \u5982\u679c\u8def\u7531\u6ca1\u6709\u6307\u5b9a action\uff0c\u90a3\u9ebd\u8c03\u7528\u7684\u65b9\u6cd5\u53ea\u662f actionIndex() \u3002 \u4f60\u53ef\u4ee5\u5728 \u63a7\u5236\u5668\u57fa\u7840\u77e5\u8bc6 \u90e8\u5206\u9605\u8bfb\u66f4\u591a\u5173\u4e8e\u63a7\u5236\u5668\u7684\u5185\u5bb9\u3002 \u66f4\u8fdb\u9636\u7684\u4f8b\u5b50\uff08\u8def\u7531\u683c\u5f0f\uff09 \u00b6 \u8ba9\u6211\u4eec\u770b\u770b members/ \u8def\u7531\u3002 \u8fd9\u4e2a\u8def\u7531\u548c account/ \u8def\u7531\u4e00\u6837\uff0c\u8fd8\u662f\u5f88\u7b80\u5358\u7684\uff0c\u4f46\u662f\u5b83\u591a\u4e86\u4e00\u4e2a\u5b57\u6bb5\uff1a\"\u8def\u7531\u683c\u5f0f\"\u3002 \u8981\u4e86\u89e3\u5b83\u662f\u5982\u4f55\u5de5\u4f5c\u7684\uff0c\u770b\u770b\u4f60\u81ea\u5df1\u5728\u524d\u7aef\u7684\u7528\u6237\u4e2a\u4eba\u8d44\u6599\u3002 \u8be5\u914d\u7f6e\u6587\u4ef6\u7684 URL \u770b\u8d77\u6765\u4f1a\u662f\u8fd9\u6837\u7684 index.php?members/your-name.1 \u3002\u5177\u4f53\u800c\u8a00\uff0c\u8bf7\u6ce8\u610f your-name.1 \u7684\u90e8\u5206\u3002 \u8fd9\u662f\u6211\u4eec\u8bd5\u56fe\u4f7f\u7528 \"\u8def\u7531\u683c\u5f0f\" \u6765\u5339\u914d\u7684\u90e8\u5206\u3002 \"\u8def\u7531\u683c\u5f0f\" \u5141\u8bb8\u6211\u4eec\u4ece\u8bf7\u6c42 URL \u4e2d\u63d0\u53d6\u6570\u636e\uff0c\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u5c06\u8be5\u4fe1\u606f\u4f20\u9012\u5230 Controller action \u4e2d\uff0c\u4ee5\u4fbf\u8be5 action \u53ef\u4ee5\u52a0\u8f7d\u7279\u5b9a\u7684\u4fe1\u606f\uff1b\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u5b83\u52a0\u8f7d\u8bf7\u6c42\u7684\u7528\u6237\u4e2a\u4eba\u8d44\u6599\u7684\u8be6\u7ec6\u4fe1\u606f\u3002 \u5b83\u8fd8\u53ef\u4ee5\u5e2e\u52a9\u6211\u4eec\u4ece\u4f20\u9012\u8fdb\u6765\u7684\u6570\u636e\u4e2d\u521b\u5efa\u94fe\u63a5\u3002 \u4e0b\u9762\u662f\u8bed\u6cd5\uff1a :int<user_id,username>/:page \u6709\u8da3\u7684\u662f\uff0c\u6b64\u65f6\u8981\u6ce8\u610f\u7684\u662f\uff0c\u4e2a\u4eba\u8d44\u6599 URL \u4e2d\u7528\u4e8e\u67e5\u627e\u4e2a\u4eba\u8d44\u6599\u7684\u91cd\u8981\u90e8\u5206\u5176\u5b9e\u5e76\u4e0d\u662f your-name \u8fd9\u4e00\u70b9\uff0c\u800c\u5b9e\u9645\u4e0a\u662f\u7528\u6237ID\uff08 1 \uff09\u3002 \u4e3a\u4e86\u8bc1\u660e\u8fd9\u4e00\u70b9\uff0c\u6539\u53d8 URL\uff0c\u7528 not-your-name \u4ee3\u66ff your-name \u3002 \u4f60\u4f1a\u770b\u5230\u627e\u5230\u4e86\u6b63\u786e\u7684\u4e2a\u4eba\u8d44\u6599\uff0c\u5e76\u4e14\u91cd\u65b0\u5b9a\u5411\u5230\u4e86\u6b63\u786e\u7684 URL\u3002 \u4e0a\u9762\u7684\u683c\u5f0f\u8868\u660e\u5b83\u662f\u4e00\u4e2a\u57fa\u4e8e\u6574\u6570\u7684\u53c2\u6570\u3002 \u5728\u521b\u5efa\u5916\u90e8\u94fe\u7ed3\u65f6\uff0c\u6211\u4eec\u4ece\u4f20\u5165\u6570\u636e\u7684 user_id key \u4e2d\u63d0\u53d6\u6574\u6570\u3002 \u5982\u679c\u6570\u636e\u4e2d\u4f20\u9012\u4e86\u4e00\u4e2a\u7528\u6237\u540d\uff0c\u5b83\u5c06\u88ab \"slugified\"\uff0c\u5c31\u8c61\u4f60\u5728\u4f60\u7684\u4e2a\u4eba\u8d44\u6599\u7684 URL \u4e2d\u770b\u5230\u7684\u6574\u6570 ID \u4e00\u6837\u3002 \u5bf9\u4e8e\u5339\u914d\u4f20\u5165\u7684 URL\uff0c\u8fd9\u5c06\u53d8\u6210\u4e00\u4e2a\u5339\u914d\u6574\u6570\u53c2\u6570\u683c\u5f0f\u7684\u8303\u5f0f\u8868\u8fbe\u5f0f\u3002 :page \u662f\u7528\u4e8e\u751f\u6210\u94fe\u63a5\u7684 page-123 \u90e8\u5206\u7684\u5feb\u6377\u65b9\u5f0f\u3002 \u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u5b83\u5728\u94fe\u63a5\u53c2\u6570\u4e2d\u5bfb\u627e\u9875\u9762\u3002 \u5982\u679c\u627e\u5230\u4e86\uff0c\u5b83\u5c31\u4f1a\u88ab\u653e\u5728 URL \u4e2d\uff0c\u7136\u540e\u4ece\u53c2\u6570\u4e2d\u5220\u9664\u3002 \u5bf9\u4e8e\u4f20\u5165\u7684\u89e3\u6790\uff0c\u5982\u679c\u5339\u914d\uff08\u5b83\u53ef\u4ee5\u662f\u7a7a\u7684\uff09\uff0c\u5b83\u5c06\u628a\u9875\u7801\u6dfb\u52a0\u5230\u4f20\u9012\u7ed9 Controller \u7684\u53c2\u6570\u4e2d\u3002 \u8def\u7531\u53c2\u6570 \u00b6 \u5f53\u8def\u7531\u4e0e\u7279\u5b9a\u7684 Controller \u548c action \u5339\u914d\u65f6\uff0cURL \u4e2d\u7684\u4efb\u4f55\u53c2\u6570\u90fd\u4f1a\u88ab\u5c01\u88c5\u5230\u4e00\u4e2a\u7279\u6b8a\u7684\u7269\u4ef6\u4e2d\uff0c\u6211\u4eec\u79f0\u4e4b\u4e3a ParameterBag \u3002 \u8fd9\u4e2a\u7269\u4ef6\u4e13\u95e8\u7528\u4e8e\u5c06\u666e\u901a URL \u53c2\u6570\u4e0e\u6765\u81ea\u8def\u7531\u5339\u914d\u7684 URL \u53c2\u6570\u5206\u5f00\u7684\u3002 ParameterBag \u7269\u4ef6\u88ab\u4f20\u9012\u5230\u6bcf\u4e2a Controller action \u4e2d\uff0c\u4f7f\u7528\u65b9\u6cd5\u5982\u4e0b\uff1a $userId = $params->user_id; Sub-names \u00b6 \u4e5f\u53ef\u4ee5\u5c06\u8def\u7531\u5206\u5272\u6210\u66f4\u591a\u7684 Sub-names\u3002 \u4f60\u53ef\u4ee5\u901a\u8fc7 members/following \u8def\u7531\u6765\u770b\u5230\u8fd9\u4e2a action\u3002 \u5728\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\uff0c following \u662f\u8def\u7531 members \u7684 Sub-names\u3002 \u901a\u5e38\u60c5\u51b5\u4e0b\uff0c\u770b\u8d77\u6765\u8c61 index.php?members/following \u7684 URL\uff0c following \u7684\u90e8\u5206\u5c06\u8868\u793a action\uff0c\u5e76\u7b80\u5358\u5730\u4e0e\u666e\u901a\u7684 members/ \u8def\u7531\u8fdb\u884c\u5339\u914d\u3002 \u4f46\u662f\uff0c\u5982\u679c\u6709\u4e00\u4e2a\u8def\u7531\u5339\u914d\u4e86\u524d\u7f00 \"members\" \u548c\u540e\u9762\u7684 \"Sub-names\"\uff0c\u5c31\u4f1a\u88ab\u4f7f\u7528\u3002 \u8fd9\u91cc\u4e5f\u662f\u5982\u6b64\uff0c\u6240\u4ee5\u5b83\u521b\u5efa\u4e86\u4e00\u4e2a\u50cf\u662f\u4e0b\u9762\u7684\u94fe\u63a5\uff1a members/:int<user_id,username>/following/:page \u5bf9\u4e8e\u4f20\u5165\u8def\u7531\u7684\u5339\u914d\uff0c\u8be5\u8def\u7531\u5c06\u5728\u57fa\u672c\u6210\u5458\u8def\u7531\u4e4b\u524d\u8fdb\u884c\u6d4b\u8bd5\uff1b\u5982\u679c\u5339\u914d\uff0c\u5219\u4f7f\u7528\u8be5\u8def\u7531\u3002 \u8fd9\u79cd sub-name \u7cfb\u7edf\u5141\u8bb8\u884c\u4e3a\u6539\u53d8\uff0c\u4f8b\u5982\u6539\u53d8\u53c2\u6570\u7684\u4f4d\u7f6e\u6216\u8005\u5c06\u8def\u7531\u5206\u7ec4\u5230\u4e0d\u540c\u7684 Controller \u4e2d\u6216\u4f7f\u7528\u4e0d\u540c\u7684\u53c2\u6570\u3002 \u60a8\u53ef\u4ee5\u5728\u8d44\u6e90\u7ba1\u7406\u5668\u548c\u5a92\u4f53\u5e93\u9644\u52a0\u7ec4\u4ef6\u4e2d\u770b\u5230\u540e\u8005\u7684\u4f8b\u5b50\u3002","title":"\u8def\u7531\u57fa\u7840\u77e5\u8bc6"},{"location":"routing-basics/#_1","text":"\u5728 PHP \u5e94\u7528\u7a0b\u5e8f\u4e2d\uff0c\u8c61\u662f XF2\uff0c\u6211\u4eec\u9700\u8981\u4e00\u79cd\u80fd\u591f\u63a5\u53d7\u7528\u6237\u5bf9\u7279\u5b9a URL \u7684\u8bf7\u6c42\u7684\u65b9\u6cd5\uff0c\u4e86\u89e3\u8be5 URL \u4ee3\u8868\u7684 controller\u3001 action \u548c\u6570\u636e\uff0c\u4ee5\u4fbf\u5411\u7528\u6237\u63d0\u4f9b\u9002\u5f53\u7684\u54cd\u5e94\u3002 \u5c06\u4e00\u4e2a URL \u8ee2\u6362\u4e3a\u4ee3\u7801\u4e2d\u7684\u4e00\u4e2a\u4f4d\u7f6e\u7684\u6982\u5ff5\u88ab\u79f0\u4e3a \"\u8def\u7531\"\u3002 \u5728 XF2 \u4e2d\uff0c\u8def\u7531\u9009\u62e9\u51e0\u4e4e\u5b8c\u5168\u7531 Admin CP \u4e2d\u7684\u4e00\u4e2a\u4f4d\u7f6e\u7ba1\u7406\u3002 \u8be5\u4f4d\u7f6e\u662f Admin CP > Development > Routes \u3002 \u8def\u7531\u6309\u4e24\u79cd\u7c7b\u578b\u4e4b\u4e00\u5206\u7ec4\uff0c\u5373 Public \u548c Admin \u7c7b\u578b\uff0c\u5b83\u4eec\u5206\u522b\u5728 Public \u548c Admin \u5e94\u7528\u7a0b\u5e8f\u4e2d\u63d0\u4f9b\u8bf7\u6c42\u7684\u8def\u7531\u3002","title":"\u8def\u7531\u57fa\u7840\u77e5\u8bc6"},{"location":"routing-basics/#_2","text":"\u5728\u8def\u7531\u9875\u9762 (\u89c1\u4e0a\u6587)\uff0c\u4f60\u5e94\u8be5\u770b\u5230\u4e00\u4e2a account/ \u7684\u6761\u76ee\u3002 \u8fd9\u662f\u4e00\u4e2a Public \u8def\u7531\uff0c\u63d0\u4f9b\u4e86\u5bf9 URL index.php?account/ \u7684\u8bf7\u6c42\u7684\u8def\u7531\u3002 \u8fd9\u4e2a\u8def\u7531\u975e\u5e38\u7b80\u5358\uff0c\u5b83\u53ea\u5305\u542b\u4e86\u5c11\u91cf\u7684\u914d\u7f6e\u3002 \u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0c\u5b83\u7531\u4e00\u4e2a \"\u8def\u7531\u524d\u7f00\"\uff0c\u4e00\u4e2a Section context \u548c\u4e00\u4e2a Controller class \u7ec4\u6210\u3002 \u8ba9\u6211\u4eec\u66f4\u8be6\u7ec6\u5730\u4e86\u89e3\u8fd9\u4e9b\u90e8\u5206\uff1a","title":"\u7b80\u5358\u7684\u4f8b\u5b50"},{"location":"routing-basics/#_3","text":"\u8def\u7531\u524d\u7f00\u4e3b\u8981\u662f\u6307\u5728 index.php? \u4e4b\u540e\u548c\u7b2c\u4e00\u4e2a / \u4e4b\u524d\u7684\u4f4d\u7f6e\u3002 \u5b83\u662f\u786e\u5b9a\u8def\u7531\u8bf7\u6c42\u7ed9\u54ea\u4e2a Controller \u7684\u7b2c\u4e00\u6b65\u3002","title":"\u8def\u7531\u524d\u7f00"},{"location":"routing-basics/#section-context","text":"\u6b64 Section context \u544a\u8bc9 XF \u4e2d\u7684\u5bfc\u89c8\u7cfb\u7edf\uff0c\u5f53\u8bbf\u95ee\u8005\u6d4f\u89c8\u7531\u8be5\u8def\u7531\u8ee2\u5230\u7684\u9875\u9762\u65f6\uff0c\u5e94\u8be5\u9009\u62e9\u54ea\u4e2a\u5bfc\u89c8\u9879\u3002 \u5bf9\u4e8e Public \u8def\u7531\uff0cSection context \u5e94\u8be5\u662f\u6700\u9ad8\u7ea7\u522b\u5bfc\u89c8\u9879\u7684 ID\u3002 \u5bf9\u4e8e Admin \u8def\u7531\uff0c\u5e94\u8be5\u662f\u6700\u7279\u5b9a\u7684\u7ba1\u7406\u5bfc\u89c8\u6761\u76ee\u7684 ID\uff08\u65e0\u8bba\u6df1\u5ea6\uff09\u3002 \u5982\u679c\u662f\u8d26\u6237\u8def\u7531\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cSection context \u4e0d\u4e00\u5b9a\u9002\u7528\uff0c\u56e0\u4e3a\u6211\u4eec\u6ca1\u6709 \"account\" \u5bfc\u89c8\u6807\u7b7e\u3002 \u4f46\u662f\uff0c\u8981\u60f3\u770b\u5230\u8fd9\u4e2a action\uff0c\u53ea\u9700\u5c06\u8fd9\u91cc\u7684 \"Section context\" \u503c\u6539\u4e3a \"forums\"\uff0c\u4fdd\u5b58\u66f4\u6539\u5e76\u5728\u524d\u7aef\u8fdb\u5165\u4f60\u7684\u8d26\u6237\u3002 \u73b0\u5728\uff0c\u4f60\u5e94\u8be5\u770b\u5230 \"Forums\" \u5bfc\u89c8\u6807\u7b7e\u88ab\u9009\u4e2d\u4e86\uff01","title":"Section context"},{"location":"routing-basics/#controller","text":"\u8fd9\u662f\u5f53\u8bf7\u6c42\u4e0e\u8fd9\u4e2a\u8def\u7531\u5339\u914d\u65f6\uff0c\u5e94\u8be5\u88ab\u8c03\u7528\u7684 Controller \u7684 class \u540d\u3002 \u5728 \"account/\" \u8def\u7531\u4e2d\uff0c\u6211\u4eec\u6307\u5b9a\u4e86 XF:Account \u3002 \u8fd9\u5c06\u52a0\u8f7d Account \u63a7\u5236\u5668\u3002 \uff08\u66f4\u591a\u4fe1\u606f\u8bf7\u53c2\u89c1 \u77ed\u7c7b\u540d \uff09\u3002 \u4ee3\u7801\u4f4d\u4e8e\u4ee5\u4e0b\u4f4d\u7f6e src/XF/Pub/Controller/Account.php \u3002 \u6ce8\u610f\u77ed\u7c7b\u540d\u662f\u5982\u4f55\u89e3\u6790\u4e3a \"infix\" \u4ee5\u53ca\u524d\u7f00 (XF) \u548c\u540e\u7f00 (Account) \u7684\u3002 \u5728\u672c\u4f8b\u4e2d\uff0c\u8fd9\u4e2a\u63a7\u5236\u5668\u7684\u4e0b\u6807 (Pub) \u662f\u7531 Account \u8def\u7531\u7c7b\u578b (public) \u63a8\u65ad\u51fa\u6765\u7684\u3002","title":"Controller"},{"location":"routing-basics/#controller-action","text":"\u4e0a\u9762\u6211\u4eec\u89e3\u91ca\u4e86\u5982\u4f55\u5c06\u8def\u7531\u5339\u914d\u5230\u4e00\u4e2a\u7279\u5b9a\u7684 Controller\uff0c\u4f46\u6211\u4eec\u8fd8\u4e0d\u77e5\u9053\u5982\u4f55\u8c03\u7528\u8be5 Controller \u5185\u7684\u7279\u5b9a action\u3002 Controller \u672c\u8d28\u4e0a\u662f\u4e00\u4e2a\u5305\u542b\u4e86\u8bb8\u591a action \u65b9\u6cd5\u7684 class\uff0cURL \u4e2d \u8def\u7531\u524d\u7f00 \u540e\u9762\u7684\u90e8\u5206\u8868\u793a Controller \u7684 action\u3002 \u7ed9\u5b9a\u4e00\u4e2a URL \u4e3a index.php?account/account-details \uff0c\u4f60\u5e94\u8be5\u88ab\u8def\u7531\u5230 XF/Pub/Controller/Account class \u548c actionAccountDetails() \u65b9\u6cd5\u3002 \u5982\u679c\u8def\u7531\u6ca1\u6709\u6307\u5b9a action\uff0c\u90a3\u9ebd\u8c03\u7528\u7684\u65b9\u6cd5\u53ea\u662f actionIndex() \u3002 \u4f60\u53ef\u4ee5\u5728 \u63a7\u5236\u5668\u57fa\u7840\u77e5\u8bc6 \u90e8\u5206\u9605\u8bfb\u66f4\u591a\u5173\u4e8e\u63a7\u5236\u5668\u7684\u5185\u5bb9\u3002","title":"Controller action"},{"location":"routing-basics/#_4","text":"\u8ba9\u6211\u4eec\u770b\u770b members/ \u8def\u7531\u3002 \u8fd9\u4e2a\u8def\u7531\u548c account/ \u8def\u7531\u4e00\u6837\uff0c\u8fd8\u662f\u5f88\u7b80\u5358\u7684\uff0c\u4f46\u662f\u5b83\u591a\u4e86\u4e00\u4e2a\u5b57\u6bb5\uff1a\"\u8def\u7531\u683c\u5f0f\"\u3002 \u8981\u4e86\u89e3\u5b83\u662f\u5982\u4f55\u5de5\u4f5c\u7684\uff0c\u770b\u770b\u4f60\u81ea\u5df1\u5728\u524d\u7aef\u7684\u7528\u6237\u4e2a\u4eba\u8d44\u6599\u3002 \u8be5\u914d\u7f6e\u6587\u4ef6\u7684 URL \u770b\u8d77\u6765\u4f1a\u662f\u8fd9\u6837\u7684 index.php?members/your-name.1 \u3002\u5177\u4f53\u800c\u8a00\uff0c\u8bf7\u6ce8\u610f your-name.1 \u7684\u90e8\u5206\u3002 \u8fd9\u662f\u6211\u4eec\u8bd5\u56fe\u4f7f\u7528 \"\u8def\u7531\u683c\u5f0f\" \u6765\u5339\u914d\u7684\u90e8\u5206\u3002 \"\u8def\u7531\u683c\u5f0f\" \u5141\u8bb8\u6211\u4eec\u4ece\u8bf7\u6c42 URL \u4e2d\u63d0\u53d6\u6570\u636e\uff0c\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u5c06\u8be5\u4fe1\u606f\u4f20\u9012\u5230 Controller action \u4e2d\uff0c\u4ee5\u4fbf\u8be5 action \u53ef\u4ee5\u52a0\u8f7d\u7279\u5b9a\u7684\u4fe1\u606f\uff1b\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u5b83\u52a0\u8f7d\u8bf7\u6c42\u7684\u7528\u6237\u4e2a\u4eba\u8d44\u6599\u7684\u8be6\u7ec6\u4fe1\u606f\u3002 \u5b83\u8fd8\u53ef\u4ee5\u5e2e\u52a9\u6211\u4eec\u4ece\u4f20\u9012\u8fdb\u6765\u7684\u6570\u636e\u4e2d\u521b\u5efa\u94fe\u63a5\u3002 \u4e0b\u9762\u662f\u8bed\u6cd5\uff1a :int<user_id,username>/:page \u6709\u8da3\u7684\u662f\uff0c\u6b64\u65f6\u8981\u6ce8\u610f\u7684\u662f\uff0c\u4e2a\u4eba\u8d44\u6599 URL \u4e2d\u7528\u4e8e\u67e5\u627e\u4e2a\u4eba\u8d44\u6599\u7684\u91cd\u8981\u90e8\u5206\u5176\u5b9e\u5e76\u4e0d\u662f your-name \u8fd9\u4e00\u70b9\uff0c\u800c\u5b9e\u9645\u4e0a\u662f\u7528\u6237ID\uff08 1 \uff09\u3002 \u4e3a\u4e86\u8bc1\u660e\u8fd9\u4e00\u70b9\uff0c\u6539\u53d8 URL\uff0c\u7528 not-your-name \u4ee3\u66ff your-name \u3002 \u4f60\u4f1a\u770b\u5230\u627e\u5230\u4e86\u6b63\u786e\u7684\u4e2a\u4eba\u8d44\u6599\uff0c\u5e76\u4e14\u91cd\u65b0\u5b9a\u5411\u5230\u4e86\u6b63\u786e\u7684 URL\u3002 \u4e0a\u9762\u7684\u683c\u5f0f\u8868\u660e\u5b83\u662f\u4e00\u4e2a\u57fa\u4e8e\u6574\u6570\u7684\u53c2\u6570\u3002 \u5728\u521b\u5efa\u5916\u90e8\u94fe\u7ed3\u65f6\uff0c\u6211\u4eec\u4ece\u4f20\u5165\u6570\u636e\u7684 user_id key \u4e2d\u63d0\u53d6\u6574\u6570\u3002 \u5982\u679c\u6570\u636e\u4e2d\u4f20\u9012\u4e86\u4e00\u4e2a\u7528\u6237\u540d\uff0c\u5b83\u5c06\u88ab \"slugified\"\uff0c\u5c31\u8c61\u4f60\u5728\u4f60\u7684\u4e2a\u4eba\u8d44\u6599\u7684 URL \u4e2d\u770b\u5230\u7684\u6574\u6570 ID \u4e00\u6837\u3002 \u5bf9\u4e8e\u5339\u914d\u4f20\u5165\u7684 URL\uff0c\u8fd9\u5c06\u53d8\u6210\u4e00\u4e2a\u5339\u914d\u6574\u6570\u53c2\u6570\u683c\u5f0f\u7684\u8303\u5f0f\u8868\u8fbe\u5f0f\u3002 :page \u662f\u7528\u4e8e\u751f\u6210\u94fe\u63a5\u7684 page-123 \u90e8\u5206\u7684\u5feb\u6377\u65b9\u5f0f\u3002 \u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u5b83\u5728\u94fe\u63a5\u53c2\u6570\u4e2d\u5bfb\u627e\u9875\u9762\u3002 \u5982\u679c\u627e\u5230\u4e86\uff0c\u5b83\u5c31\u4f1a\u88ab\u653e\u5728 URL \u4e2d\uff0c\u7136\u540e\u4ece\u53c2\u6570\u4e2d\u5220\u9664\u3002 \u5bf9\u4e8e\u4f20\u5165\u7684\u89e3\u6790\uff0c\u5982\u679c\u5339\u914d\uff08\u5b83\u53ef\u4ee5\u662f\u7a7a\u7684\uff09\uff0c\u5b83\u5c06\u628a\u9875\u7801\u6dfb\u52a0\u5230\u4f20\u9012\u7ed9 Controller \u7684\u53c2\u6570\u4e2d\u3002","title":"\u66f4\u8fdb\u9636\u7684\u4f8b\u5b50\uff08\u8def\u7531\u683c\u5f0f\uff09"},{"location":"routing-basics/#_5","text":"\u5f53\u8def\u7531\u4e0e\u7279\u5b9a\u7684 Controller \u548c action \u5339\u914d\u65f6\uff0cURL \u4e2d\u7684\u4efb\u4f55\u53c2\u6570\u90fd\u4f1a\u88ab\u5c01\u88c5\u5230\u4e00\u4e2a\u7279\u6b8a\u7684\u7269\u4ef6\u4e2d\uff0c\u6211\u4eec\u79f0\u4e4b\u4e3a ParameterBag \u3002 \u8fd9\u4e2a\u7269\u4ef6\u4e13\u95e8\u7528\u4e8e\u5c06\u666e\u901a URL \u53c2\u6570\u4e0e\u6765\u81ea\u8def\u7531\u5339\u914d\u7684 URL \u53c2\u6570\u5206\u5f00\u7684\u3002 ParameterBag \u7269\u4ef6\u88ab\u4f20\u9012\u5230\u6bcf\u4e2a Controller action \u4e2d\uff0c\u4f7f\u7528\u65b9\u6cd5\u5982\u4e0b\uff1a $userId = $params->user_id;","title":"\u8def\u7531\u53c2\u6570"},{"location":"routing-basics/#sub-names","text":"\u4e5f\u53ef\u4ee5\u5c06\u8def\u7531\u5206\u5272\u6210\u66f4\u591a\u7684 Sub-names\u3002 \u4f60\u53ef\u4ee5\u901a\u8fc7 members/following \u8def\u7531\u6765\u770b\u5230\u8fd9\u4e2a action\u3002 \u5728\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\uff0c following \u662f\u8def\u7531 members \u7684 Sub-names\u3002 \u901a\u5e38\u60c5\u51b5\u4e0b\uff0c\u770b\u8d77\u6765\u8c61 index.php?members/following \u7684 URL\uff0c following \u7684\u90e8\u5206\u5c06\u8868\u793a action\uff0c\u5e76\u7b80\u5358\u5730\u4e0e\u666e\u901a\u7684 members/ \u8def\u7531\u8fdb\u884c\u5339\u914d\u3002 \u4f46\u662f\uff0c\u5982\u679c\u6709\u4e00\u4e2a\u8def\u7531\u5339\u914d\u4e86\u524d\u7f00 \"members\" \u548c\u540e\u9762\u7684 \"Sub-names\"\uff0c\u5c31\u4f1a\u88ab\u4f7f\u7528\u3002 \u8fd9\u91cc\u4e5f\u662f\u5982\u6b64\uff0c\u6240\u4ee5\u5b83\u521b\u5efa\u4e86\u4e00\u4e2a\u50cf\u662f\u4e0b\u9762\u7684\u94fe\u63a5\uff1a members/:int<user_id,username>/following/:page \u5bf9\u4e8e\u4f20\u5165\u8def\u7531\u7684\u5339\u914d\uff0c\u8be5\u8def\u7531\u5c06\u5728\u57fa\u672c\u6210\u5458\u8def\u7531\u4e4b\u524d\u8fdb\u884c\u6d4b\u8bd5\uff1b\u5982\u679c\u5339\u914d\uff0c\u5219\u4f7f\u7528\u8be5\u8def\u7531\u3002 \u8fd9\u79cd sub-name \u7cfb\u7edf\u5141\u8bb8\u884c\u4e3a\u6539\u53d8\uff0c\u4f8b\u5982\u6539\u53d8\u53c2\u6570\u7684\u4f4d\u7f6e\u6216\u8005\u5c06\u8def\u7531\u5206\u7ec4\u5230\u4e0d\u540c\u7684 Controller \u4e2d\u6216\u4f7f\u7528\u4e0d\u540c\u7684\u53c2\u6570\u3002 \u60a8\u53ef\u4ee5\u5728\u8d44\u6e90\u7ba1\u7406\u5668\u548c\u5a92\u4f53\u5e93\u9644\u52a0\u7ec4\u4ef6\u4e2d\u770b\u5230\u540e\u8005\u7684\u4f8b\u5b50\u3002","title":"Sub-names"},{"location":"scotchbox/","text":"\u9644\u5f55: Scotch Box \u00b6 \u4e0b\u9762\u4ecb\u7ecd\u5982\u4f55\u5c06\u4f18\u79c0\u7684 Scotch Box \u5b89\u88c5\u5230\u81ea\u5df1\u7684\u7535\u8111\u4e0a\uff0c\u4ee5\u4fbf\u5728\u51e0\u5206\u949f\u5185\u901a\u8fc7\u7b80\u5358\u7684\u547d\u4ee4\u5c31\u80fd\u62e5\u6709\u4e00\u4e2a\u5b8c\u5168\u53ef\u64cd\u4f5c\u7684 XenForo \u5f00\u53d1\u73af\u5883\u3002 XenForo \u6709\u81ea\u5b9a\u4e49\u7684 Scotch Box \u914d\u7f6e\uff0c\u5b83\u63d0\u4f9b\u4e86\u8fd0\u884c XenForo \u6240\u9700\u7684\u4e00\u5207\uff0c\u5305\u62ec\u8c03\u8bd5\u5668\u548c\u6027\u80fd\u589e\u5f3a\u7684\u6570\u636e\u7f13\u5b58\u3002 Scotch Box \u7684\u8fd0\u884c\u73af\u5883\u5728 VirtualBox / Vagrant \u4e2d\u3002 \u5b89\u88c5 Scotch Box \u865a\u62df\u673a \u00b6 \u9996\u5148\u786e\u5b9a\u60a8\u5e0c\u671b\u865a\u62df Web \u670d\u52a1\u5668\u5728\u7535\u8111\u4e0a\u4fdd\u5b58\u5176\u6587\u4ef6\u7684\u4f4d\u7f6e\u3002\u5efa\u8bae\u60a8\u5728\u81ea\u5df1\u7684\u7528\u6237\u4e3b\u76ee\u5f55\u4e2d\u9009\u62e9\u4e00\u4e2a\u4f4d\u7f6e\u3002 \u5728\u4ee5\u4e0b\u793a\u4f8b\u4f4d\u7f6e\uff0c\u6211\u4eec\u5c06\u4f7f\u7528\u540d\u4e3a MyServer \u7684\u76ee\u5f55\uff0c\u6b64\u76ee\u5f55\u4f4d\u4e8e\u60a8\u81ea\u5df1\u7528\u6237\u76ee\u5f55\u7684\u6839\u76ee\u5f55\u4e2d\uff0c\u5e76\u7531\u60a8\u7684\u540d\u79f0 {username} \u6807\u8bc6\uff1a /Users/{username}/MyServer \uff08Mac\uff09 C:\\Users\\{username}\\MyServer \uff08Windows\uff09 /home/{username}/MyServer \uff08\u67d0\u4e9b Linux \u53d1\u884c\u7248\u672c\uff09 /users/{username}/MyServer \uff08\u5176\u4ed6 Linux \u53d1\u884c\u7248\u672c\uff09 \u9009\u62e9\u4f4d\u7f6e\u540e\uff0c\u8bf7\u6309\u7167\u4ee5\u4e0b\u6b65\u9aa4\u64cd\u4f5c\uff1a \u5728\u7535\u8111\u4e0a\u5b89\u88c5 VirtualBox \u5728\u7535\u8111\u4e0a\u5b89\u88c5 Vagrant \u4f7f\u7528 git \u5ba2\u6237\u7aef\uff0cclone https://github.com/scotch-io/scotch-box \u5230 MyServer \u76ee\u5f55\u4e2d\u3002\u5728\u4e0a\u9762\u7684 Mac \u793a\u4f8b\u4f4d\u7f6e\u4e2d\u4f7f\u7528\u547d\u4ee4\u884c Client \u7aef\uff0c\u547d\u4ee4\u662f\uff1a git clone https://github.com/scotch-io/scotch-box /Users/{username}/MyServer clone \u8fc7\u7a0b\u5b8c\u6210\u540e\uff0c\u4e0b\u8f7d\u6b64\u81ea\u5b9a\u4e49 Vagrantfile \u5e76\u590d\u76d6\u5728 */Users/{username}/MyServer/Vagrantfile \u4e2d\u521b\u5efa\u7684 Vagrantfile : \u4e0b\u8f7d\u81ea\u5b9a\u4e49 Vagrantfile \u3002 \u81ea\u5b9a\u4e49 Vagrantfile \u653e\u7f6e\u5230\u4f4d\u540e\uff0c\u8fd0\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a cd /Users/{username}/MyServer vagrant up \u60a8\u7684 Scotch Box \u865a\u62df\u673a\u73b0\u5728\u5df2\u7ecf\u521b\u5efa\u5e76\u53ef\u4ee5\u4f7f\u7528\u3002 Note Scotch Box \u8fd8\u63d0\u4f9b\u4e86\u4e00\u4e2a ' Scotch Box Pro ' \u7248\u672c\u7684\u865a\u62df\u673a\uff0c\u8d2d\u4e70\u4ef7\u683c\u5408\u7406\u3002\u5982\u679c\u4f60\u6bd4\u8f83\u504f\u5411\u559c\u6b22\u4f7f\u7528 Scotch Box Pro\uff0c\u8bf7\u53c2\u9605\u4e0b\u9762\u7684\u90e8\u5206 \u4ecb\u7ecd Scotch Box \u548c Scotch Box Pro \u5728\u914d\u7f6e\u548c\u8fd0\u884c\u4e4b\u95f4\u7684\u5dee\u5f02 \u3002 \u6587\u4ef6\u90fd\u5728\u54ea\u513f\uff1f \u00b6 \u4e00\u65e6\u60a8\u7684 Scotch Box \u542f\u52a8\u5e76\u8fd0\u884c\u540e\uff0c\u60a8\u53ef\u4ee5\u5c06 XenForo \u7684 PHP \u548c JS \u6587\u4ef6\u4fdd\u7559\u5728\u60a8\u7684\u4e3b\u673a\u4e0a\uff0c\u4ece\u800c\u5141\u8bb8\u60a8\u4f7f\u7528\u60a8\u6240\u9009\u62e9\u7684\u6587\u672c\u7f16\u8f91\u5668\u6216 IDE\uff0c\u800c\u865a\u62df\u673a\u5219\u8d1f\u8d23\u901a\u8fc7\u5176 Web \u670d\u52a1\u5668\u7f16\u8bd1\u548c\u63d0\u4f9b\u8fd9\u4e9b\u6587\u4ef6\u3002 \u60a8\u5c06\u80fd\u591f\u901a\u8fc7\u4ee5\u4e0b\u5730\u5740\u5728 Web \u6d4f\u89c8\u5668\u4e2d\u8bbf\u95ee\u65b0\u7684 Web \u670d\u52a1\u5668\uff1a http://192.168.33.10 Web \u670d\u52a1\u5668\u5c06\u4ece\u4ee5\u4e0b\u4f4d\u7f6e\u63d0\u53d6\u8981\u63d0\u4f9b\u7684\u6587\u4ef6 /Users/{username}/MyServer/public \u5982\u679c\u4f60\u5e0c\u671b XenForo \u5b89\u88c5\u5728 http://192.168.33.10/xenforo \uff0c\u4f60\u5e94\u8be5\u628a XenForo \u5305\u4e2d upload \u6587\u4ef6\u5939\u7684\u5185\u5bb9\u653e\u5230 /Users/{username}/MyServer/public/xenforo \u4e2d\u3002 \u505c\u6b62\u548c\u91cd\u65b0\u542f\u52a8\u670d\u52a1\u5668 \u00b6 \u60a8\u53ef\u4ee5\u5728\u4efb\u4f55\u65f6\u5019\u901a\u8fc7\u8fd0\u884c\u4ee5\u4e0b\u547d\u4ee4\u505c\u6b62 Scotch Box \u670d\u52a1\u5668 cd /Users/{username}/MyServer vagrant halt ... \uff0c\u5e76\u4e14\u60a8\u53ef\u4ee5\u901a\u8fc7\u8fd0\u884c\u91cd\u65b0\u542f\u52a8\u5b83 cd /Users/{username}/MyServer vagrant up Note \u867d\u7136 Vagrant / Scotch Box \u4f1a\u5728\u60a8\u91cd\u65b0\u542f\u52a8\u7535\u8111\u65f6\u81ea\u52a8\u5173\u95ed\uff0c\u4f46\u5b83\u4e0d\u4f1a\u81ea\u52a8\u518d\u6b21\u542f\u52a8\u3002 \u6bcf\u5f53\u60a8\u91cd\u65b0\u542f\u52a8\u65f6\uff0c\u60a8\u9700\u8981\u518d\u6b21\u8fd0\u884c vagrant up \u547d\u4ee4\u624d\u80fd\u4f7f\u7528\u670d\u52a1\u5668\u3002 \u5b98\u65b9\u6587\u6863 \u00b6 \u672c\u6307\u5357\u6458\u81ea Scotch Box \u5b98\u65b9\u6587\u6863\uff0c\u8be5\u6587\u6863\u4f4d\u4e8e https://box.scotch.io Scotch Box Pro \u00b6 \u57fa\u672c\u7684 Scotch Box \u9700\u8981\u4e00\u4e9b\u989d\u5916\u7684\u914d\u7f6e\uff08\u901a\u8fc7\u81ea\u5b9a\u4e49\u7684 Vagrantfile \u6765\u4f20\u9012\uff09\u624d\u80fd\u8fd0\u884c XenForo 2\uff0c\u800c Scotch Box Pro \u4e0d\u9700\u8981\u989d\u5916\u7684\u914d\u7f6e\uff0c\u65e0\u9700\u4e0b\u8f7d\u989d\u5916\u7684\u5305\u5c31\u53ef\u4ee5\u8fd0\u884c XenForo 2\u3002 \u8981\u8fd0\u884c Scotch Box Pro\uff0c\u8bf7\u4ece Scotch Box Pro \u7f51\u7ad9\u8d2d\u4e70\u5b83\uff0c\u5728\u60a8\u8d2d\u4e70\u540e\u5c06\u4f1a\u53ce\u5230\u4e00\u90e8\u5206\u8fd0\u884c git clone \u547d\u4ee4\u7684\u6307\u793a\u8bf4\u660e\u3002 \u73b0\u5728\u60a8\u53ef\u4ee5\u4f7f\u7528\u4e0e\u4e0a\u8ff0\u76f8\u540c\u7684\u8bf4\u660e\u8fdb\u884c\u5b89\u88c5\uff0c\u552f\u4e00\u7684\u4f8b\u5916\u662f\u60a8\u5e94\u8be5\u4e0b\u8f7d \u6b64\u81ea\u5b9a\u4e49\u7684 Vagrantfile \uff0c\u800c\u4e0d\u662f Scotch Box \u8bf4\u660e\u4e2d\u5217\u51fa\u7684\u90a3\u4e2a\u5185\u5bb9\u3002","title":"\u9644\u5f55\uff1aScotch Box"},{"location":"scotchbox/#scotch-box","text":"\u4e0b\u9762\u4ecb\u7ecd\u5982\u4f55\u5c06\u4f18\u79c0\u7684 Scotch Box \u5b89\u88c5\u5230\u81ea\u5df1\u7684\u7535\u8111\u4e0a\uff0c\u4ee5\u4fbf\u5728\u51e0\u5206\u949f\u5185\u901a\u8fc7\u7b80\u5358\u7684\u547d\u4ee4\u5c31\u80fd\u62e5\u6709\u4e00\u4e2a\u5b8c\u5168\u53ef\u64cd\u4f5c\u7684 XenForo \u5f00\u53d1\u73af\u5883\u3002 XenForo \u6709\u81ea\u5b9a\u4e49\u7684 Scotch Box \u914d\u7f6e\uff0c\u5b83\u63d0\u4f9b\u4e86\u8fd0\u884c XenForo \u6240\u9700\u7684\u4e00\u5207\uff0c\u5305\u62ec\u8c03\u8bd5\u5668\u548c\u6027\u80fd\u589e\u5f3a\u7684\u6570\u636e\u7f13\u5b58\u3002 Scotch Box \u7684\u8fd0\u884c\u73af\u5883\u5728 VirtualBox / Vagrant \u4e2d\u3002","title":"\u9644\u5f55: Scotch Box"},{"location":"scotchbox/#scotch-box_1","text":"\u9996\u5148\u786e\u5b9a\u60a8\u5e0c\u671b\u865a\u62df Web \u670d\u52a1\u5668\u5728\u7535\u8111\u4e0a\u4fdd\u5b58\u5176\u6587\u4ef6\u7684\u4f4d\u7f6e\u3002\u5efa\u8bae\u60a8\u5728\u81ea\u5df1\u7684\u7528\u6237\u4e3b\u76ee\u5f55\u4e2d\u9009\u62e9\u4e00\u4e2a\u4f4d\u7f6e\u3002 \u5728\u4ee5\u4e0b\u793a\u4f8b\u4f4d\u7f6e\uff0c\u6211\u4eec\u5c06\u4f7f\u7528\u540d\u4e3a MyServer \u7684\u76ee\u5f55\uff0c\u6b64\u76ee\u5f55\u4f4d\u4e8e\u60a8\u81ea\u5df1\u7528\u6237\u76ee\u5f55\u7684\u6839\u76ee\u5f55\u4e2d\uff0c\u5e76\u7531\u60a8\u7684\u540d\u79f0 {username} \u6807\u8bc6\uff1a /Users/{username}/MyServer \uff08Mac\uff09 C:\\Users\\{username}\\MyServer \uff08Windows\uff09 /home/{username}/MyServer \uff08\u67d0\u4e9b Linux \u53d1\u884c\u7248\u672c\uff09 /users/{username}/MyServer \uff08\u5176\u4ed6 Linux \u53d1\u884c\u7248\u672c\uff09 \u9009\u62e9\u4f4d\u7f6e\u540e\uff0c\u8bf7\u6309\u7167\u4ee5\u4e0b\u6b65\u9aa4\u64cd\u4f5c\uff1a \u5728\u7535\u8111\u4e0a\u5b89\u88c5 VirtualBox \u5728\u7535\u8111\u4e0a\u5b89\u88c5 Vagrant \u4f7f\u7528 git \u5ba2\u6237\u7aef\uff0cclone https://github.com/scotch-io/scotch-box \u5230 MyServer \u76ee\u5f55\u4e2d\u3002\u5728\u4e0a\u9762\u7684 Mac \u793a\u4f8b\u4f4d\u7f6e\u4e2d\u4f7f\u7528\u547d\u4ee4\u884c Client \u7aef\uff0c\u547d\u4ee4\u662f\uff1a git clone https://github.com/scotch-io/scotch-box /Users/{username}/MyServer clone \u8fc7\u7a0b\u5b8c\u6210\u540e\uff0c\u4e0b\u8f7d\u6b64\u81ea\u5b9a\u4e49 Vagrantfile \u5e76\u590d\u76d6\u5728 */Users/{username}/MyServer/Vagrantfile \u4e2d\u521b\u5efa\u7684 Vagrantfile : \u4e0b\u8f7d\u81ea\u5b9a\u4e49 Vagrantfile \u3002 \u81ea\u5b9a\u4e49 Vagrantfile \u653e\u7f6e\u5230\u4f4d\u540e\uff0c\u8fd0\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a cd /Users/{username}/MyServer vagrant up \u60a8\u7684 Scotch Box \u865a\u62df\u673a\u73b0\u5728\u5df2\u7ecf\u521b\u5efa\u5e76\u53ef\u4ee5\u4f7f\u7528\u3002 Note Scotch Box \u8fd8\u63d0\u4f9b\u4e86\u4e00\u4e2a ' Scotch Box Pro ' \u7248\u672c\u7684\u865a\u62df\u673a\uff0c\u8d2d\u4e70\u4ef7\u683c\u5408\u7406\u3002\u5982\u679c\u4f60\u6bd4\u8f83\u504f\u5411\u559c\u6b22\u4f7f\u7528 Scotch Box Pro\uff0c\u8bf7\u53c2\u9605\u4e0b\u9762\u7684\u90e8\u5206 \u4ecb\u7ecd Scotch Box \u548c Scotch Box Pro \u5728\u914d\u7f6e\u548c\u8fd0\u884c\u4e4b\u95f4\u7684\u5dee\u5f02 \u3002","title":"\u5b89\u88c5 Scotch Box \u865a\u62df\u673a"},{"location":"scotchbox/#_1","text":"\u4e00\u65e6\u60a8\u7684 Scotch Box \u542f\u52a8\u5e76\u8fd0\u884c\u540e\uff0c\u60a8\u53ef\u4ee5\u5c06 XenForo \u7684 PHP \u548c JS \u6587\u4ef6\u4fdd\u7559\u5728\u60a8\u7684\u4e3b\u673a\u4e0a\uff0c\u4ece\u800c\u5141\u8bb8\u60a8\u4f7f\u7528\u60a8\u6240\u9009\u62e9\u7684\u6587\u672c\u7f16\u8f91\u5668\u6216 IDE\uff0c\u800c\u865a\u62df\u673a\u5219\u8d1f\u8d23\u901a\u8fc7\u5176 Web \u670d\u52a1\u5668\u7f16\u8bd1\u548c\u63d0\u4f9b\u8fd9\u4e9b\u6587\u4ef6\u3002 \u60a8\u5c06\u80fd\u591f\u901a\u8fc7\u4ee5\u4e0b\u5730\u5740\u5728 Web \u6d4f\u89c8\u5668\u4e2d\u8bbf\u95ee\u65b0\u7684 Web \u670d\u52a1\u5668\uff1a http://192.168.33.10 Web \u670d\u52a1\u5668\u5c06\u4ece\u4ee5\u4e0b\u4f4d\u7f6e\u63d0\u53d6\u8981\u63d0\u4f9b\u7684\u6587\u4ef6 /Users/{username}/MyServer/public \u5982\u679c\u4f60\u5e0c\u671b XenForo \u5b89\u88c5\u5728 http://192.168.33.10/xenforo \uff0c\u4f60\u5e94\u8be5\u628a XenForo \u5305\u4e2d upload \u6587\u4ef6\u5939\u7684\u5185\u5bb9\u653e\u5230 /Users/{username}/MyServer/public/xenforo \u4e2d\u3002","title":"\u6587\u4ef6\u90fd\u5728\u54ea\u513f\uff1f"},{"location":"scotchbox/#_2","text":"\u60a8\u53ef\u4ee5\u5728\u4efb\u4f55\u65f6\u5019\u901a\u8fc7\u8fd0\u884c\u4ee5\u4e0b\u547d\u4ee4\u505c\u6b62 Scotch Box \u670d\u52a1\u5668 cd /Users/{username}/MyServer vagrant halt ... \uff0c\u5e76\u4e14\u60a8\u53ef\u4ee5\u901a\u8fc7\u8fd0\u884c\u91cd\u65b0\u542f\u52a8\u5b83 cd /Users/{username}/MyServer vagrant up Note \u867d\u7136 Vagrant / Scotch Box \u4f1a\u5728\u60a8\u91cd\u65b0\u542f\u52a8\u7535\u8111\u65f6\u81ea\u52a8\u5173\u95ed\uff0c\u4f46\u5b83\u4e0d\u4f1a\u81ea\u52a8\u518d\u6b21\u542f\u52a8\u3002 \u6bcf\u5f53\u60a8\u91cd\u65b0\u542f\u52a8\u65f6\uff0c\u60a8\u9700\u8981\u518d\u6b21\u8fd0\u884c vagrant up \u547d\u4ee4\u624d\u80fd\u4f7f\u7528\u670d\u52a1\u5668\u3002","title":"\u505c\u6b62\u548c\u91cd\u65b0\u542f\u52a8\u670d\u52a1\u5668"},{"location":"scotchbox/#_3","text":"\u672c\u6307\u5357\u6458\u81ea Scotch Box \u5b98\u65b9\u6587\u6863\uff0c\u8be5\u6587\u6863\u4f4d\u4e8e https://box.scotch.io","title":"\u5b98\u65b9\u6587\u6863"},{"location":"scotchbox/#scotch-box-pro","text":"\u57fa\u672c\u7684 Scotch Box \u9700\u8981\u4e00\u4e9b\u989d\u5916\u7684\u914d\u7f6e\uff08\u901a\u8fc7\u81ea\u5b9a\u4e49\u7684 Vagrantfile \u6765\u4f20\u9012\uff09\u624d\u80fd\u8fd0\u884c XenForo 2\uff0c\u800c Scotch Box Pro \u4e0d\u9700\u8981\u989d\u5916\u7684\u914d\u7f6e\uff0c\u65e0\u9700\u4e0b\u8f7d\u989d\u5916\u7684\u5305\u5c31\u53ef\u4ee5\u8fd0\u884c XenForo 2\u3002 \u8981\u8fd0\u884c Scotch Box Pro\uff0c\u8bf7\u4ece Scotch Box Pro \u7f51\u7ad9\u8d2d\u4e70\u5b83\uff0c\u5728\u60a8\u8d2d\u4e70\u540e\u5c06\u4f1a\u53ce\u5230\u4e00\u90e8\u5206\u8fd0\u884c git clone \u547d\u4ee4\u7684\u6307\u793a\u8bf4\u660e\u3002 \u73b0\u5728\u60a8\u53ef\u4ee5\u4f7f\u7528\u4e0e\u4e0a\u8ff0\u76f8\u540c\u7684\u8bf4\u660e\u8fdb\u884c\u5b89\u88c5\uff0c\u552f\u4e00\u7684\u4f8b\u5916\u662f\u60a8\u5e94\u8be5\u4e0b\u8f7d \u6b64\u81ea\u5b9a\u4e49\u7684 Vagrantfile \uff0c\u800c\u4e0d\u662f Scotch Box \u8bf4\u660e\u4e2d\u5217\u51fa\u7684\u90a3\u4e2a\u5185\u5bb9\u3002","title":"Scotch Box Pro"},{"location":"template-syntax/","text":"\u6a21\u677f\u8bed\u6cd5 \u00b6 XenForo 2 \u6a21\u677f\u8bed\u6cd5\u5bf9\u4e8e\u5f00\u53d1\u4eba\u5458\u548c\u8bba\u575b\u7ba1\u7406\u5458\u90fd\u662f\u5f3a\u5927\u7684\u5de5\u5177\uff0c\u4f7f\u60a8\u53ef\u4ee5\u5b8c\u5168\u63a7\u5236 XenForo \u9875\u9762\u7684\u6392\u7248\u3002 \u6700\u4f73\u793a\u4f8b \u00b6 \u6309\u7167\u60ef\u4f8b\uff0cXenForo \u7684\u6807\u7b7e\u662f lowercase \u3002 \u6240\u6709 XenForo \u6807\u7b7e\u90fd\u4ee5 xf: \u547d\u540d\u7a7a\u95f4\u4e3a\u524d\u7f00\u3002 \u6709\u5e2e\u52a9\u7684\u6d88\u606f \u00b6 \u5bf9\u6a21\u677f\u8fdb\u884c\u6ce8\u91ca \u00b6 \u5982\u679c\u60a8\u60f3\u6ce8\u91ca\u6389\u4e00\u4e9b\u60a8\u4e0d\u60f3\u5728\u6700\u7ec8\u9875\u9762\u539f\u4ee3\u7801\u4e2d\u770b\u5230\u7684\u6a21\u677f\u4ee3\u7801\uff08\u6216\u8005\u52b1\u5fd7\u7684\u6d88\u606f\uff09\uff0c\u5219\u53ef\u4ee5\u4f7f\u7528 xf:comment \u6807\u7b7e\u3002 <xf:comment> \u5982\u679c\u4f60\u4e0d\u518d\u4ee5\u4f60\u559c\u6b22\u4ec0\u9ebd\u548c\u4e0d\u559c\u6b22\u4ec0\u9ebd\u6765\u770b\u5f85\u8fd9\u4e2a\u4e16\u754c\uff0c \u800c\u662f\u770b\u5230\u4e86\u4e8b\u7269\u672c\u8eab\u7684\u771f\u5b9e\u9762\u76ee\uff0c \u4f60\u5c31\u4f1a\u53d1\u73b0\u4f60\u7684\u751f\u6d3b\u5c06\u4f1a\u66f4\u52a0\u5730\u7965\u548c\u3002 </xf:comment> \u5728\u6a21\u677f\u4e2d\u52a0\u5165\u53e6\u4e00\u4e2a\u6a21\u677f \u00b6 xf:include \u6807\u7b7e\u5141\u8bb8\u4f60\u5728\u5f53\u524d\u6a21\u677f\u4e2d\u52a0\u5165\u4e00\u4e2a\u4e0d\u540c\u7684\u6a21\u677f\u3002 <xf:include template=\"my_template\" /> \u53ea\u9700\u5c06 template \u5c5e\u6027\u8bbe\u7f6e\u4e3a\u4f60\u60f3\u52a0\u5165\u7684\u6a21\u677f\u540d\u79f0\u5373\u53ef\u3002 \u6a21\u677f\u5de8\u96c6 \u00b6 \u6a21\u677f\u5de8\u96c6\u662f XenForo \u6a21\u677f\u8bed\u6cd5\u7684\u4e00\u4e2a\u975e\u5e38\u5f3a\u5927\u7684\u90e8\u5206\u3002 \u901a\u5e38\uff0c\u4f60\u5e94\u8be5\u5728\u7f16\u7a0b\u8bed\u8a00\u4e2d\u4f7f\u7528\u51fd\u6570\u6216\u5b50\u7a0b\u5e8f\u7684\u4efb\u4f55\u5730\u65b9\u4f7f\u7528\u5de8\u96c6\u3002 \u5bf9\u4e8e\u975e\u7a0b\u5e8f\u5458\u6765\u8bf4\uff0c\u6211\u628a\u8fd9\u4e00\u70b9\u603b\u7ed3\u4e3a\uff1a \u8981\u4e48\u5728 \u4efb\u4f55\u60a8\u60f3\u5728\u591a\u4e2a\u4e0d\u540c\u6587\u4ef6\u4e2d\u591a\u6b21\u751f\u6210\u76f8\u540c\u4e8b\u7269\u7684\u5730\u65b9\u4f7f\u7528\u5de8\u96c6\uff0c \u6216\u8005 \u5728\u4e0d\u540c\u60c5\u51b5\u4e0b\u751f\u6210\u4e0d\u540c\u7684\u4e1c\u897f\uff08\u5982\u679c\u4f60\u67e5\u770b\u5b9a\u4e49\u5de8\u96c6\u7684\u6307\u5357\uff0c\u8fd9\u53ef\u80fd\u4f1a\u66f4\u6709\u5e2e\u52a9\uff09\u3002 Warning \u51fa\u4e8e\u53ef\u8bfb\u6027\u539f\u56e0\uff0c\u60a8\u4e0d\u5e94\u8be5\u4f7f\u7528\u5de8\u96c6\u6807\u7b7e\u4f5c\u4e3a\u53d8\u91cf\u3002 \u60a8\u5e94\u8be5\u4f7f\u7528 Set \u6807\u7b7e\uff0c\u5e76\u50cf\u5bf9\u5f85\u4efb\u4f55\u6a21\u677f\u53d8\u91cf\u4e00\u6837\u5bf9\u5f85\u53d8\u91cf\u3002 \u5b9a\u4e49\u5de8\u96c6 \u00b6 <xf:macro name=\"my_macro_name\"> <!-- \u4f60\u7684\u5de8\u96c6\u5185\u5bb9 --> </xf:macro> \u6700\u7b80\u5358\u7684\uff0c\u53ef\u4ee5\u7528 name \u5c5e\u6027\u5b9a\u4e49\u4e00\u4e2a\u5de8\u96c6\uff0c\u5e76\u5728\u5de8\u96c6\u6807\u7b7e\u4e2d\u91cd\u590d\u4f60\u60f3\u8981\u7684\u5185\u5bb9\u3002 Note \u5f53\u60a8\u5728\u591a\u4e2a\u6587\u4ef6\u4e2d\u4f7f\u7528\u5de8\u96c6\u65f6\uff0c\u6700\u4f73\u505a\u6cd5\u662f\u5c06\u5de8\u96c6\u653e\u5165\u81ea\u5df1\u7684\u6a21\u677f\u4e2d\u3002 \u5de8\u96c6\u53c2\u6570 \u00b6 <xf:macro name=\"my_macro_name\" arg-message=\"\u6211\u8d85\u5389\u5bb3\u7684\u5de8\u96c6\u6d88\u606f\uff01\"> <h1>\u6d88\u606f</h1> <p>{$message}</p> </xf:macro> \u5728\u6b64\u793a\u4f8b\u4e2d\uff0c\u4e3a\u5de8\u96c6\u5b9a\u4e49\u4e86 arg-message ( \u6211\u60ca\u4eba\u7684\u5de8\u96c6\u6d88\u606f\uff01 ) \u7684\u9ed8\u8ba4\u503c\u3002 \u5982\u679c\u4f7f\u7528 message \u53c2\u6570\u8c03\u7528\u5de8\u96c6\uff0c\u5219\u8be5\u503c\u5c06\u88ab\u590d\u76d6\u3002 \u6709\u65f6\u9700\u8981\u5c06\u4e00\u4e2a\u53c2\u6570\u6807\u8bb0\u4e3a\u5fc5\u586b\u9879\u3002 \u8fd9\u53ef\u4ee5\u901a\u8fc7\u5728\u5de8\u96c6\u5b9a\u4e49\u4e2d\u628a\u53c2\u6570\u503c\u8bbe\u7f6e\u4e3a ! \u6765\u5b9e\u73b0\u3002 \u52a0\u5165\u548c\u4f7f\u7528\u5de8\u96c6 \u00b6 <xf:macro template=\"my_macro_template\" name=\"my_macro_name\" /> \u6700\u7b80\u5358\u7684\u65b9\u6cd5\u662f\uff0c\u901a\u8fc7\u8bbe\u7f6e name \u5c5e\u6027\u5e76\u5c06\u6807\u7b7e\u4fdd\u7559\u4e3a\u7a7a\u6765\u52a0\u5165\u5de8\u96c6\u3002 Note \u4f7f\u7528\u5de8\u96c6\u6807\u7b7e\u65f6\uff0c\u4f60\u5e94\u8be5\u4f7f\u7528\u6807\u7b7e\u7684\u81ea\u52a8\u5173\u95ed\u5f62\u5f0f\uff0c\u4ee5\u4fbf\u8ba9\u522b\u4eba\u66f4\u5bb9\u6613\u533a\u5206\u5de8\u96c6\u7684\u5b9a\u4e49\u548c\u7528\u6cd5\u7684\u533a\u522b\u3002 \u5de8\u96c6\u53c2\u6570 \u00b6 \u60a8\u8fd8\u53ef\u4ee5\u4e3a\u5de8\u96c6\u63d0\u4f9b\u53c2\u6570\uff1a <xf:macro template=\"my_macro_template\" name=\"my_macro_name\" arg-argName=\"argValue\" /> \u5176\u4e2d argName \u662f\u5de8\u96c6\u53c2\u6570\u7684\u540d\u79f0\u3002 Note \u60a8\u5e94\u8be5\u4f7f\u7528 lowerCamelCase \u6765\u547d\u540d\u4f60\u7684\u5de8\u96c6\u53c2\u6570\u3002 \u6a21\u677f\u63a7\u5236\u7ed3\u6784 \u00b6 XenForo 2 \u6a21\u677f\u8bed\u6cd5\u652f\u63f4\u67d0\u4e9b\u63a7\u4ef6\u7ed3\u6784\uff0c\u4ee5\u4f7f\u67d0\u4e9b\u4efb\u52a1\u66f4\u6613\u4e8e\u5b9e\u73b0\u3002 If \u6807\u7b7e \u00b6 if \u6a21\u677f\u6807\u7b7e\u53ef\u7528\u4e8e\u6709\u6761\u4ef6\u5730\u663e\u793a\u4e00\u4e9b HTML \u6216\u6a21\u677f\u7684\u4e00\u90e8\u5206\u3002 <!-- Shows content only if a user is signed in... --> <xf:if is=\"$xf.visitor.user_id\"> <!-- \u505a\u70b9\u4ec0\u9ebd... --> </xf:if> if \u6807\u7b7e\u5177\u6709\u4ee5\u4e0b\u5c5e\u6027\uff1a is - \u6ee1\u8db3\u6761\u4ef6\u65f6\u5e94\u663e\u793a\u6807\u7b7e\u5185\u5bb9\u7684\u6761\u4ef6\u3002 \u6761\u4ef6 \u00b6 \u8be5 is \u5c5e\u6027\u652f\u63f4\u4e00\u4e9b\u903b\u8f91\u8fd0\u7b97\u7b26\uff1a OR - \u7528\u4e8e\u8fde\u63a5\u66ff\u4ee3\u6761\u4ef6\u3002\uff08\u4e8c\u62e9\u4e00\uff1a || \uff09 AND - \u7528\u4e8e\u8fde\u63a5\u5176\u4ed6\u6761\u4ef6\u3002 (\u4e8c\u62e9\u4e00: && \uff09 ! - \u653e\u5728\u6761\u4ef6\u524d\uff0c\u4f7f\u5176\u53cd\u8ee2\u3002\uff08\u79f0\u4e3a\uff1a\"\u5426\"\uff09 XOR - \u5982\u679c\u4e24\u4e2a\u6761\u4ef6\u4e2d\u53ea\u6709\u4e00\u4e2a\u4e3a true\uff0c\u5219\u8fd4\u56de true\u3002\uff08\u79f0\u4e3a\uff1a\"\u5f02\u6216\"\uff09 Else/Else-If \u6807\u7b7e \u00b6 else \u548c else-if \u6807\u7b7e\u4e0e if \u6807\u7b7e\u7ed3\u5408\u4f7f\u7528\uff0c\u4ee5\u6309\u540d\u79f0\u5efa\u8bae\u7684\u65b9\u5f0f\u6709\u6761\u4ef6\u5730\u663e\u793a HTML\u3002 else \u7528\u6cd5\u793a\u4f8b\uff1a <xf:if is=\"$xf.visitor.is_admin\"> <!-- \u8fd9\u91cc\u7684\u5185\u5bb9\u53ea\u6709\u7ba1\u7406\u5458\u624d\u4f1a\u770b\u5230... --> <xf:else /> <!-- \u8fd9\u91cc\u7684\u5185\u5bb9\u5c06\u88ab\u663e\u793a\u7ed9\u4efb\u4f55\u975e\u7ba1\u7406\u5458\u7684\u4eba\u770b\u5230\uff01 --> </xf:if> else-if \u7684\u7528\u6cd5\u793a\u4f8b\uff1a <xf:if is=\"$xf.visitor.is_admin\"> <!-- \u8fd9\u91cc\u7684\u5185\u5bb9\u53ea\u6709\u7ba1\u7406\u5458\u624d\u4f1a\u770b\u5230... --> <xf:elseif is=\"$xf.visitor.is_moderator\" /> <!-- \u8fd9\u91cc\u7684\u5185\u5bb9\u53ea\u4f1a\u663e\u793a\u7ed9\u7248\u4e3b(\u4e0d\u5305\u62ec\u517c\u4efb\u7ba1\u7406\u5458\u7684\u7528\u6237)\u3002 --> <xf:else /> <!-- \u8fd9\u91cc\u7684\u5185\u5bb9\u5c06\u663e\u793a\u7ed9\u975e\u7ba1\u7406\u5458\u6216\u7248\u4e3b\u7684\u4efb\u4f55\u4eba\u3002 --> </xf:if> \u6b63\u5982\u4f60\u6240\u770b\u5230\u7684\uff0c\u4e00\u65e6\u4e00\u4e2a\u6761\u4ef6\u88ab\u6ee1\u8db3\uff0c\u5176\u4f59\u7684 if \u8bed\u53e5\u5c06\u88ab\u5ffd\u7565\u3002\uff08\u6240\u4ee5\uff0c\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u5982\u679c\u7528\u6237\u662f\u7ba1\u7406\u5458\uff0c\u4e0a\u9762\u7684 xf:if \u90e8\u5206\u88ab\u8fd0\u884c\uff0c\u5176\u4f59\u7684 if \u8bed\u53e5\u5219\u88ab\u5ffd\u7565\u3002) For-each \u6807\u7b7e \u00b6 for-each \u6807\u7b7e\u4f7f\u60a8\u53ef\u4ee5\u904d\u5386\u9879\u76ee\u6570\u7ec4\uff0c\u4e3a\u6bcf\u4e2a\u9879\u76ee\u5370\u51fa HTML \u533a\u5757\u3002 <xf:set var=\"$names\" value=\"{{ ['\u6d3e\u7fe0\u514b', '\u7279\u4e3d\u838e', '\u91d1\u535a\u5c14', '\u97e6\u6069', '\u683c\u96f7\u65af'] }}\" /> <xf:foreach loop=\"$names\" key=\"$key\" value=\"$name\" i=\"$i\"> <p>\u4f60\u597d\uff0c {$name}\u3002 \u8fd9\u662f\u540d\u5b57 {$i} \u3002 \u8be5\u5143\u7d20\u7684\u6570\u7ec4 key \u503c\u4e3a\uff1a {$key}</p> </xf:foreach> for-each \u6807\u7b7e\u5177\u6709\u4ee5\u4e0b\u5c5e\u6027\uff1a loop - \u8981\u5faa\u73af\u7684\u6570\u7ec4\u3002 key - \u5728\u5faa\u73af\u4e2d\u4f7f\u7528\u7684\u53d8\u91cf\u540d\u79f0\uff0c\u4ee5\u83b7\u53d6\u5f53\u524d\u5143\u7d20\u7684\u6570\u7ec4 key\u3002 \u53ef\u4ee5\u662f\u6574\u6570\uff08\u666e\u901a\u6570\u7ec4\uff09\u6216\u5b57\u7b26\u4e32\uff08\u5173\u8054\u6570\u7ec4\uff09\u3002 value - \u5728\u5faa\u73af\u4e2d\u4f7f\u7528\u7684\u53d8\u91cf\u540d\u79f0\uff0c\u5305\u542b\u5f53\u524d\u6570\u7ec4\u9879\u3002 i - \u5728\u5faa\u73af\u4e2d\u7528\u4e8e\u5f53\u524d\u7d22\u5f15\u7684\u53d8\u91cf\u540d\u79f0\u3002 \u8f93\u51fa\u793a\u4f8b \u00b6 \u4f60\u597d\uff0c\u6d3e\u7fe0\u514b\u3002 \u8fd9\u662f\u540d\u5b57 1\u3002 \u4f60\u597d\uff0c\u7279\u4e3d\u838e\u3002 \u8fd9\u662f\u540d\u5b57 2\u3002 \u4f60\u597d\uff0c\u91d1\u535a\u5c14\u3002 \u8fd9\u662f\u540d\u5b57 3\u3002 \u4f60\u597d\uff0c\u97e6\u6069\u3002 \u8fd9\u662f\u540d\u5b57 4\u3002 \u4f60\u597d\uff0c\u683c\u96f7\u65af\u3002 \u8fd9\u662f\u540d\u5b57 5\u3002 \u6a21\u677f\u6807\u7b7e \u00b6 \u5934\u50cf\u6807\u7b7e \u00b6 \u5728\u9875\u9762\u4e2d\u63d2\u5165\u7528\u6237\u7684\u5934\u50cf\u3002 <xf:avatar user=\"{$xf.visitor}\" size=\"o\" canonical=\"true\" /> \u5934\u50cf\u6807\u7b7e\u5177\u6709\u4ee5\u4e0b\u5c5e\u6027\uff1a user - \u8981\u751f\u6210\u5934\u50cf\u7684 XenForo \u7528\u6237\u7269\u4ef6\u3002 size - \u8981\u751f\u6210\u7684\u56fe\u50cf\u5927\u5c0f\u3002(\u53c2\u89c1\u56fe\u50cf\u5c3a\u5bf8) canonical - \u662f\u5426\u4f7f\u7528\u6709\u5229\u4e8e SEO \u7684\u5b8c\u6574 URL\u3002\u8be5\u503c\u53ea\u5bf9 custom \u5934\u8c61\u6709\u6548\u3002 notooltip - \u5f53\u9f20\u6807\u60ac\u505c\u5728\u5934\u50cf\u4e0a\u65f6\u663e\u793a\u7684\u5de5\u5177\u63d0\u793a\u662f\u5426\u5e94\u8be5\u88ab\u5173\u95ed\u3002 forcetype - \u53ef\u4ee5\u7528\u6765\u5f3a\u5236\u53d6\u5f97 gravatar \u6216 custom \u5934\u50cf\uff0c\u8bbe\u7f6e\u503c\u4e3a\u5176\u4e2d\u4e4b\u4e00\u3002 defaultname - \u5982\u679c user \u5c5e\u6027\u5305\u542b\u4e00\u4e2a\u65e0\u6548\u7684\u7528\u6237\u65f6\uff0c\u9ed8\u8ba4\u8981\u4f7f\u7528\u7684\u7528\u6237\u540d\u79f0\u3002 \u56fe\u50cf\u5927\u5c0f \u00b6 \u5982\u679c\u63d0\u4f9b\u7684\u5934\u50cf\u5927\u5c0f\u65e0\u6548\uff0c\u5219\u4ee3\u7801\u5c06\u56de\u9000\u5230\u5927\u5c0f ' s '\u3002 o - 384px h - 384px l - 192px m - 96px s - 48px \u9875\u9762\u8def\u5f84\u5bfc\u89c8\u5217\u6807\u7b7e \u00b6 \u4fee\u6539\u9875\u9762\u8def\u5f84\u5bfc\u89c8\u5217\u3002 <xf:breadcrumb href=\"{{ link('my_page') }}\">{{ phrase('my_page_name') }}</xf:breadcrumb> \u9875\u9762\u8def\u5f84\u5bfc\u89c8\u5217\u6807\u7b7e\u5177\u6709\u4ee5\u4e0b\u5c5e\u6027\uff1a href - \u4e3a\u9875\u9762\u8def\u5f84\u5bfc\u89c8\u5217\u4e2d\u7684\u6700\u540e\u4e00\u4e2a\u5143\u7d20\u8bbe\u7f6e\u7684\u94fe\u63a5\u3002 \u6807\u7b7e\u7684\u503c\u53ef\u7528\u4e8e\u8bbe\u7f6e\u9875\u9762\u8def\u5f84\u5bfc\u89c8\u5217\u4e2d\u6700\u540e\u4e00\u4e2a\u5143\u7d20\u7684\u540d\u79f0\u3002 \u5176\u4ed6\u7528\u6cd5 \u00b6 <xf:breadcrumb source=\"$category.getBreadcrumbs(false)\" /> \u60a8\u8fd8\u53ef\u4ee5\u901a\u8fc7 source \u5728\u9875\u9762\u8def\u5f84\u5bfc\u89c8\u5217\u6807\u7b7e\u7684\u5c5e\u6027\u4e2d\u8c03\u7528\u51fd\u6570\u6765\u4ee5\u7f16\u7a0b\u65b9\u5f0f\u5b9a\u4e49\u81ea\u5df1\u7684\u9875\u9762\u8def\u5f84\u5bfc\u89c8\u5217\u3002 \u8be5 source \u53c2\u6570\u57fa\u672c\u4e0a\u91c7\u7528\u4e00\u4e2a\u5177\u6709 href \u548c value \u5c5e\u6027\u7684\u7269\u4ef6\u6570\u7ec4\uff08\u591a\u7ef4\u6570\u7ec4\uff09\uff0c\u5176\u4e2d\u6bcf\u4e2a\u7269\u4ef6\u90fd\u662f\u4e00\u4e2a\u9875\u9762\u8def\u5f84\u5bfc\u89c8\u5217\u5143\u7d20\u3002 Note \u5982\u679c\u8981\u66f4\u6539\u6839\u76ee\u5f55\u9875\u9762\u8def\u5f84\u5bfc\u89c8\u5217\uff0c\u53ef\u4ee5\u5728 \"\u57fa\u672c\u4fe1\u606f\u9762\u677f\" \u9009\u9879\u90e8\u5206\u4e2d\u66f4\u6539 \"Root breadcrumb\" \u9009\u9879\u3002 \u6309\u94ae\u6807\u7b7e \u00b6 \u6dfb\u52a0\u5177\u6709\u9002\u5f53\u7c7b\u7684\u6309\u94ae\u5143\u7d20\u4ee5\u53ca\uff08\u53ef\u9009\uff09\u56fe\u6807\u3002 <xf:button icon=\"save\"></xf:button> button \u6807\u7b7e\u5177\u6709\u4ee5\u4e0b\u5c5e\u6027\uff1a icon - \u5e94\u7528\u4e8e\u6309\u94ae\u7684\u56fe\u6807\u7c7b\u3002(\u53c2\u89c1\u6309\u94ae\u56fe\u6807) \u6309\u94ae\u56fe\u6807 \u00b6 \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cXenForo \u6309\u94ae\u652f\u63f4\u4ee5\u4e0b\u56fe\u6807\uff08\u4f7f\u7528CSS\u521b\u5efa\uff09\uff1a add confirm write import export download disable edit save reply quote purchase payment convert search sort upload attach login rate config refresh translate vote result history cancel preview conversation bolt list prev next markRead notificationsOn notificationsOff merge move copy approve unapprove delete undelete stick unstick lock unlock Callback \u6807\u7b7e \u00b6 \u8fd0\u884c\u4e00\u4e2a PHP Callback \u65b9\u6cd5\u3002 <xf:callback class=\"Vendor\\Addon\\Class\" method=\"getX\" params=\"['abc']\"></xf:callback> \u6b64 callback \u6807\u7b7e\u5177\u6709\u4ee5\u4e0b\u5c5e\u6027\uff1a class - \u8be5 class\uff08\u4ece root \u547d\u540d\u7a7a\u95f4\uff09\u5305\u542b\u8981\u8fd0\u884c\u7684\u65b9\u6cd5\u3002 method - \u8981\u8fd0\u884c\u7684\u65b9\u6cd5\u3002 (\u53c2\u89c1 callback \u65b9\u6cd5) params - \u63d0\u4f9b\u7ed9\u6b64\u65b9\u6cd5\u7684\u53c2\u6570\u6570\u7ec4\u3002 Callback \u65b9\u6cd5 \u00b6 \u4e3a\u4e86\u4f7f\u4e00\u4e2a\u65b9\u6cd5\u88ab\u8ba4\u4e3a\u662f callback \u65b9\u6cd5\uff0c\u5fc5\u987b\u5bf9\u5176\u8fdb\u884c\u9002\u5f53\u7684\u547d\u540d\uff0c\u5426\u5219\u5b83\u5c06\u629b\u51fa\u9519\u8bef ' callback_method_x_does_not_appear_to_indicate_read_only '\u3002\u4e3a\u4e86\u4f7f\u5b83\u88ab\u8ba4\u4e3a\u662f\u552f\u8bfb\u7684\uff0c\u65b9\u6cd5\u540d\u79f0\u5fc5\u987b\u4ee5\u4e0b\u5217\u524d\u7f00\u4e4b\u4e00\u5f00\u5934\uff1a are can count data display does exists fetch filter find get has is pluck print render return show total validate verify view CSS \u6807\u7b7e \u00b6 \u52a0\u5165\u4e00\u4e2a\u5916\u90e8 CSS \u6216 LESS \u6a21\u677f\u6587\u4ef6\u3002 <xf:css src=\"mycss_file.css\" /> CSS \u6807\u7b7e\u5177\u6709\u4ee5\u4e0b\u5c5e\u6027\uff1a src - \u8981\u52a0\u5165\u7684 CSS \u6216 LESS \u6a21\u677f\u6587\u4ef6\u3002 \u5176\u4ed6\u7528\u6cd5 \u00b6 <xf:css> html, body { font-family: \"Roboto\", sans-serif; } </xf:css> \u5982\u679c CSS \u6807\u7b7e\u4e0d\u4e3a\u7a7a\uff0c\u5219\u6807\u7b7e\u4e2d\u7684\u6240\u6709\u5185\u5bb9\u90fd\u5c06\u8ee2\u6362\u4e3a\u5d4c\u5165\u5f0f CSS\u3002 \u8fdb\u4e00\u6b65\u8bf4\u660e \u00b6 \u5bf9\u4e8e[CSS]\uff0c\u4e0d\u7528\u518d\u5c06\u5b83\u4eec\u79f0\u4e3a\u6587\u4ef6\u4e86\u3002\u5c06\u5b83\u4eec\u590d\u5236\u5e76\u7c98\u8d34\u5230\u65b0\u6a21\u677f\u4e2d\uff0c\u5e76\u6309\u5982\u4e0b\u6240\u793a\u8fdb\u884c\u8c03\u7528\uff1a \u6765\u6e90\u81ea\uff1a \u514b\u91cc\u65af\u00b7D\uff0cXenForo \u5f00\u53d1\u4eba\u5458 <xf:css src=\"questionthreads_fonticonpicker.css\" /> <xf:css src=\"questionthreads_fonticonpicker_grey.css\" /> JS \u6807\u7b7e \u00b6 \u52a0\u5165\u4e00\u4e2aJavaScript\u6587\u4ef6\u3002 <xf:js src=\"myaddon/vendor/scripts/myjs_file.js\" /> JS \u6807\u7b7e\u5177\u6709\u4ee5\u4e0b\u5c5e\u6027\uff1a src - \u8981\u52a0\u5165\u5230\u6a21\u677f\u4e2d\u7684 JS \u6587\u4ef6\u3002 prod - \u8981\u52a0\u5165\u5230\u6a21\u677f\u4e2d\u7684 JS \u6587\u4ef6\uff0c\u53ea\u9002\u7528\u4e8e\u751f\u4ea7\u6a21\u5f0f\u3002 dev - \u8981\u52a0\u5165\u5230\u6a21\u677f\u4e2d\u7684 JS \u6587\u4ef6\uff0c\u53ea\u9002\u7528\u4e8e\u5f00\u53d1\u6a21\u5f0f\u3002 min - \u662f\u5426\u8981\u52a0\u5165\u6700\u5c0f\u5316\u7248\u672c\u7684\u6587\u4ef6\u3002(\u7528 .min.js \u53d6\u4ee3 .js ) - \u53ea\u9700\u8981\u5728\u751f\u4ea7\u6a21\u5f0f\u4e0b\u5173\u5fc3\u3002 addon - \u662f\u5426\u8981\u4f7f\u7528\u5f00\u53d1\u4e2d JS \u7684 URL\u3002 - \u53ea\u9700\u8981\u5728\u5f00\u53d1\u6a21\u5f0f\u4e0b\u5173\u5fc3\u3002 Warning The src tag cannot be used in conjunction with either the prod or dev tags. \u5176\u4ed6\u7528\u6cd5 \u00b6 <xf:js> alert(\"\u771f\u76f8\u5f88\u4f24\u4eba\uff0c\u6211\u77e5\u9053\u3002\u5176\u5b9e\u8fd9\u662f\u57fa\u4e8e\u751f\u7269\u5b66\u4e0a\u7684\u3002\"); </xf:js> \u5982\u679c JS \u6807\u7b7e\u4e0d\u4e3a\u7a7a\uff0c\u5219\u6807\u7b7e\u4e2d\u7684\u6240\u6709\u5185\u5bb9\u90fd\u4f1a\u8ee2\u6362\u4e3a\u5d4c\u5165\u5f0f JS\u3002 \u8fdb\u4e00\u6b65\u8bf4\u660e \u00b6 JavaScript \u6587\u4ef6\u662f\u76f8\u5bf9\u4e8e /js \u76ee\u5f55\u63d0\u4f9b\u7684\u3002\u5c3d\u7ba1\u4e0d\u5efa\u8bae\u8fd9\u6837\u505a\uff0c\u4f46\u60a8\u4e5f\u53ef\u4ee5\u5728\u6b64\u6807\u7b7e\u4e2d\u52a0\u5165\u5916\u90e8\u8d44\u6e90\u3002 \u8fd9\u4e2a\u6807\u7b7e\u5728 editor \u6a21\u677f\u4e2d\u5c31\u662f\u4e00\u4e2a\u5f88\u597d\u7684\u4f8b\u5b50\u3002 Set \u6807\u7b7e \u00b6 set \u6807\u7b7e\u5141\u8bb8\u60a8\u521b\u5efa\u4e00\u4e2a\u5bf9\u53e6\u4e00\u4e2a\u53d8\u91cf\u7684\u53c2\u8003\u6216\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u53d8\u91cf\u3002\u4f60\u5e94\u8be5\u5728\u7f16\u7a0b\u8bed\u8a00\u4e2d\u4f7f\u7528\u53d8\u91cf\u7684\u4efb\u4f55\u5730\u65b9\u4f7f\u7528 set \u6807\u7b7e\u3002 <xf:set var=\"$visitor\" value=\"{$xf.visitor}\" /> Warning \u4e0d\u8981\u5bf9\u8981\u5728\u591a\u4e2a\u6a21\u677f\u4e2d\u4f7f\u7528\u7684\u4e00\u7ec4\u5143\u7d20\u4f7f\u7528 Set \u6807\u7b7e\uff0c\u800c\u5e94\u4f7f\u7528 Macro \u6807\u7b7e\u3002 Warning \u53d8\u91cf\u540d\u79f0\uff08 var \u5c5e\u6027\uff09\u5fc5\u987b\u4ee5 $ \u5f00\u5934\u3002 set \u6807\u7b7e\u5177\u6709\u4ee5\u4e0b\u5c5e\u6027\uff1a: var - \u60a8\u60f3\u5b9a\u4e49\u53d8\u91cf\u7684\u540d\u79f0\uff08\u672c\u8d28\u4e0a\u662f\u522b\u540d\uff09\u3002 value - \u8981\u53c2\u8003\u7684\u53d8\u91cf\u6216\u53d8\u91cf\u503c\u3002 \u5176\u4ed6\u7528\u6cd5 \u00b6 <xf:set var=\"$myVariableName\"> \u6211\u7684\u53d8\u91cf\u503c! \u8fd9\u53ef\u4ee5\u662f\u4e00\u4e2a callback\uff0c\u6216\u8005\u53ea\u662f\u4e00\u7ec4\u77ed\u8bed\u3002 </xf:set> \u5982\u679c value \u672a\u63d0\u4f9b\u5c5e\u6027\u4e14\u6807\u7b7e\u4e0d\u4e3a\u7a7a\uff0c\u5219\u53d8\u91cf\u503c\u5c06\u8bbe\u7f6e\u4e3a\u6807\u7b7e\u7684\u5185\u5bb9\u3002 Warning \u5f53\u60a8\u4ee5\u8fd9\u79cd\u5f62\u5f0f\u4f7f\u7528 Set \u6807\u7b7e\u65f6\uff0c\u8be5\u503c\u5c06\u88ab\u8ee2\u4e49\uff0c\u5e76\u4e14\u7ed3\u679c\u503c\u5c06\u662f\u4e00\u4e2a\u5b57\u7b26\u4e32\u3002\u8be5 value \u5c5e\u6027\u867d\u7136\u4e0d\u652f\u63f4 HTML \u6216\u7c7b\u4f3c HTML \u7684\u6807\u7b7e\uff0c\u4f46\u6ca1\u6709\u6b64\u9650\u5236\u3002 Likes \u6807\u7b7e \u00b6 \u663e\u793a\u5e16\u5b50\u7684\u559c\u6b22\u6b21\u6570\u4ee5\u53ca\u4e00\u4e9b\u559c\u6b22\u8be5\u5e16\u5b50\u7684\u7528\u6237\u3002 <xf:likes content=\"{$post}\" url=\"\" /> likes \u6807\u7b7e\u5177\u6709\u4ee5\u4e0b\u5c5e\u6027\uff1a content - \u8981\u663e\u793a '\u559c\u6b22' \u6587\u672c\u7684 XF\\Entity\\Post \u6216 XF\\Entity\\ProfilePost \u6570\u636e\u5b9e\u4f53\u3002 url - \u70b9\u51fb '\u559c\u6b22' \u6587\u672c\u65f6\u663e\u793a\u7684 URL\u3002 \u683c\u5f0f \u00b6 \u4f60, \u91cc\u65af\u672c, kcho \u548c 2 \u5176\u4ed6\u4eba \u683c\u5f0f\u4e3a [\ud83d\udc4d abc \u548c 2 \u5176\u4ed6\u4eba]\uff08\u5176\u4e2d \ud83d\udc4d \"\u5927\u62c7\u6307\" \u8868\u60c5\u7b26\u4ee3\u8868 \"\u70b9\u8cdb\" \u56fe\u6807\uff0c abc \u4ee3\u8868\u6700\u540e\u4e09\u4e2a\u70b9\u8cdb\u8be5\u5e16\u5b50\u7684\u7528\u6237\u540d\u5b57\u3002\uff09 Sidebar \u6807\u7b7e \u00b6 \u53c2\u89c1 Sectioned \u6807\u7b7e . SideNav \u6807\u7b7e \u00b6 \u53c2\u89c1 Sectioned \u6807\u7b7e . Title \u6807\u7b7e \u00b6 \u8bbe\u7f6e\u9875\u9762\u7684\u6807\u9898\uff0c\u5305\u62ec\u9875\u9762\u4e0a\u7684 h1 \u6807\u7b7e\u548c\u6d4f\u89c8\u5668\u6807\u7b7e\u3002 <xf:title>{{ phrase('my_page_title') }}</xf:title> \u8fdb\u4e00\u6b65\u8bf4\u660e \u00b6 \u867d\u7136\u53ef\u4ee5\u5bf9 Title \u8fdb\u884c\u6c38\u4e45\u6027\u7f16\u8f91\uff0c\u4f46\u662f \u5f3a\u70c8\u5efa\u8bae \u60a8\u4f7f\u7528\u4e00\u4e2a\u77ed\u8bed\uff0c\u4ee5\u5b9e\u73b0\u56fd\u9645\u5316\uff0c\u5e76\u589e\u52a0\u7f51\u7ad9\u7ba1\u7406\u5458\u7aef\u7684\u53ef\u5b9a\u5236\u6027\u3002 Widget \u6807\u7b7e \u00b6 \u5728\u9875\u9762\u4e2d\u5305\u542b\u5c0f\u7ec4\u4ef6\uff0c\u6216\u5c06\u5c0f\u7ec4\u4ef6\u6dfb\u52a0\u5230\u5c0f\u7ec4\u4ef6\u7684\u4f4d\u7f6e\u4e0a\u3002 <xf:widget key=\"widget_name\" /> widget \u6807\u7b7e\u5177\u6709\u4ee5\u4e0b\u5c5e\u6027\uff1a key - \u5c0f\u7ec4\u4ef6\u7684 key\uff0c\u5982\u5c0f\u7ec4\u4ef6\u8bbe\u7f6e\u4e2d\u5b9a\u4e49\u7684\u3002 position - \u5982\u679c\u8bbe\u7f6e\uff0c\u5219\u6539\u53d8\u5c0f\u7ec4\u4ef6\u5c06\u88ab\u55a7\u67d3\u7684\u4f4d\u7f6e\u3002 class - \u4e0d\u8981\u4e0e HTML \u7684 class \u6df7\u80b4\uff0c\u8fd9\u662f\u5305\u542b\u5c0f\u7ec4\u4ef6\u5b9a\u4e49\u7684 PHP \u7c7b\u3002 title - \u5f53\u4f7f\u7528 class \u5c5e\u6027\u65f6\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528 title \u5c5e\u6027\u6765\u8bbe\u7f6e\u5c0f\u7ec4\u4ef6\u7684\u6807\u9898\u3002 \u5f53\u4f7f\u7528 class \u5c5e\u6027\u65f6\uff0c\u4f60\u4e5f\u53ef\u4ee5\u63d0\u4f9b\u5c0f\u7ec4\u4ef6\u7279\u5b9a\u7684\u9009\u9879\u4f5c\u4e3a\u5c5e\u6027\u3002 Warning class \u6807\u7b7e\u4e0d\u80fd\u4e0e key \u6807\u7b7e\u4e00\u8d77\u4f7f\u7528\u3002 UserActivity \u6807\u7b7e \u00b6 \u6839\u636e\u7528\u6237\u4e0a\u4e00\u6b21\u64cd\u4f5c\u4ee5\u53ca\u8be5\u64cd\u4f5c\u53d1\u751f\u7684\u65f6\u95f4\u6765\u663e\u793a\u7528\u6237\u7684\u72b6\u6001\u3002 <xf:useractivity user=\"{$xf.visitor}\" /> UserActivity \u6807\u7b7e\u5177\u6709\u4ee5\u4e0b\u5c5e\u6027\uff1a user - \u7528\u6237\u663e\u793a\u7684\u72b6\u6001\u3002 \u683c\u5f0f \u00b6 \u67e5\u770b\u9875\u9762 \u6700\u65b0\u6848\u4f8b\u6587\u4ef6 \u00b7 4\u5206\u953a\u524d \u683c\u5f0f\u4e3a [\u6d3b\u52a8\u540d\u79f0] \u00b7 [\u65f6\u95f4] UserBanners \u6807\u7b7e \u00b6 \u5728\u6c34\u5e73\u5217\u8868\u4e2d\u663e\u793a\u7528\u6237\u7684\u6a2a\u5e45\u3002 <xf:userbanners user=\"{$xf.visitor}\" /> UserBanners \u6807\u7b7e\u5177\u6709\u4ee5\u4e0b\u5c5e\u6027\uff1a user - \u663e\u793a\u8be5\u7528\u6237\u7684\u7528\u6237\u6a2a\u5e45\u3002 \u793a\u4f8b \u00b6 UserBanners \u6807\u7b7e\u7684\u793a\u4f8b\u7ed3\u679c\u3002 UserBlurb tag \u00b6 \u663e\u793a\u7528\u6237\u4e2a\u4eba\u8d44\u6599\u7684\u5358\u884c\u6458\u8981\u3002 <xf:userblurb user=\"${xf.visitor}\" /> UserBlurb \u6807\u7b7e\u5177\u6709\u4ee5\u4e0b\u5c5e\u6027\uff1a user - \u663e\u793a XenForo \u7528\u6237\u5bf9\u8c61\u7684\u7b80\u4ecb\u3002 \u683c\u5f0f \u00b6 FBI \u987e\u95ee \u00b7 43 \u00b7 \u6765\u81ea\u7f8e\u56fd \u683c\u5f0f\u4e3a [\u89d2\u8272 / \u81ea\u5b9a\u4e49\u6807\u9898] \u00b7 \u5e74\u9f84 \u00b7 \u4f4d\u7f6e Username \u6807\u7b7e \u00b6 Displays the user's username, optionally with a tool-tip. \u663e\u793a\u7528\u6237\u7684\u7528\u6237\u540d\uff0c\u53ef\u9009\u62e9\u4f7f\u7528\u5de5\u5177\u63d0\u793a\u3002 \u663e\u793a\u7528\u6237\u7684\u7528\u6237\u540d\uff08\u53ef\u9009\uff09\u548c\u5de5\u5177\u63d0\u793a\u3002 <xf:username user=\"{$xf.visitor.username}\" notooltip=\"true\" /> Username \u6807\u7b7e\u5177\u6709\u4ee5\u4e0b\u5c5e\u6027\uff1a user - \u8981\u663e\u793a\u5176\u540d\u79f0\u7684 XenForo \u7528\u6237\u5bf9\u8c61\u3002 notooltip - \u662f\u5426\u5173\u95ed\u5de5\u5177\u63d0\u793a\u3002 href - \u70b9\u51fb\u7528\u6237\u540d\u65f6\u6240\u5bfc\u5411\u5230\u7684\u94fe\u63a5\u3002 Warning \u5982\u679c\u8bbe\u7f6e\u4e86 href \uff0c\u5219\u4e0d\u4f1a\u663e\u793a\u5de5\u5177\u63d0\u793a\uff0c\u56e0\u4e3a\u5b83\u4e0d\u8d77\u4f5c\u7528\uff0c\u800c\u4e14\u53ef\u80fd\u4f1a\u8bef\u5bfc\u7528\u6237\u3002 UserTitle \u6807\u7b7e \u00b6 Displays the user's title.\u663e\u793a\u7528\u6237\u7684\u5934\u8854\u3002 <xf:usertitle user=\"{$xf.visitor}\" /> UserTitle \u6807\u7b7e\u5177\u6709\u4ee5\u4e0b\u5c5e\u6027\uff1a user - \u6b64 XenForo \u7528\u6237\u7269\u4ef6\uff0c\u7528\u4e8e\u663e\u793a\u7528\u6237\u5934\u8854\u3002 Sectioned \u6807\u7b7e \u00b6 Sectioned \u6807\u7b7e\u5168\u90fd\u4f1a\u8c03\u7528\u51fd\u6570 modifySectionedHtml \u3002 \u5b83\u4eec\u4fee\u6539\u7684 HTML \u5143\u7d20\u5c31\u662f\u6807\u7b7e\u540d\u79f0\u3002\u56e0\u6b64 sidebar \u6807\u7b7e\u4f1a\u4fee\u6539\u4fa7\u8fb9\u680f\u7684 HTML \u7b49\u7b49\u3002 \u793a\u4f8b \u00b6 <xf:sidebar> <h1>\u6211\u7684\u795e\u5947\u4fa7\u8fb9\u680f\uff01</h1> </xf:sidebar> \u5171\u540c\u5c5e\u6027 \u00b6 mode - \u4fee\u6539\u6a21\u5f0f\u3002\uff08\u8bf7\u53c2\u9605\u4fee\u6539\u6a21\u5f0f\uff09 \u4fee\u6539\u65b9\u5f0f \u00b6 \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u4fee\u6539\u65b9\u5f0f\u4e3a replace \u3002\uff08\u5373\uff0c\u5982\u679c\u6ca1\u6709\u6307\u5b9a\u5c5e\u6027\u3002\uff09 prepend - \u5c06\u6807\u7b7e\u7684\u5185\u5bb9\u653e\u5728 HTML \u5143\u7d20\u7684\u5f00\u5934\u3002 append - \u5c06\u6807\u7b7e\u7684\u5185\u5bb9\u653e\u5728 HTML \u5143\u7d20\u7684\u672b\u5c3e\u3002 replace - \u7528\u6807\u7b7e\u7684\u5185\u5bb9\u66ff\u6362 HTML \u7684\u5143\u7d20\u3002","title":"\u6a21\u677f\u8bed\u6cd5"},{"location":"template-syntax/#_1","text":"XenForo 2 \u6a21\u677f\u8bed\u6cd5\u5bf9\u4e8e\u5f00\u53d1\u4eba\u5458\u548c\u8bba\u575b\u7ba1\u7406\u5458\u90fd\u662f\u5f3a\u5927\u7684\u5de5\u5177\uff0c\u4f7f\u60a8\u53ef\u4ee5\u5b8c\u5168\u63a7\u5236 XenForo \u9875\u9762\u7684\u6392\u7248\u3002","title":"\u6a21\u677f\u8bed\u6cd5"},{"location":"template-syntax/#_2","text":"\u6309\u7167\u60ef\u4f8b\uff0cXenForo \u7684\u6807\u7b7e\u662f lowercase \u3002 \u6240\u6709 XenForo \u6807\u7b7e\u90fd\u4ee5 xf: \u547d\u540d\u7a7a\u95f4\u4e3a\u524d\u7f00\u3002","title":"\u6700\u4f73\u793a\u4f8b"},{"location":"template-syntax/#_3","text":"","title":"\u6709\u5e2e\u52a9\u7684\u6d88\u606f"},{"location":"template-syntax/#_4","text":"\u5982\u679c\u60a8\u60f3\u6ce8\u91ca\u6389\u4e00\u4e9b\u60a8\u4e0d\u60f3\u5728\u6700\u7ec8\u9875\u9762\u539f\u4ee3\u7801\u4e2d\u770b\u5230\u7684\u6a21\u677f\u4ee3\u7801\uff08\u6216\u8005\u52b1\u5fd7\u7684\u6d88\u606f\uff09\uff0c\u5219\u53ef\u4ee5\u4f7f\u7528 xf:comment \u6807\u7b7e\u3002 <xf:comment> \u5982\u679c\u4f60\u4e0d\u518d\u4ee5\u4f60\u559c\u6b22\u4ec0\u9ebd\u548c\u4e0d\u559c\u6b22\u4ec0\u9ebd\u6765\u770b\u5f85\u8fd9\u4e2a\u4e16\u754c\uff0c \u800c\u662f\u770b\u5230\u4e86\u4e8b\u7269\u672c\u8eab\u7684\u771f\u5b9e\u9762\u76ee\uff0c \u4f60\u5c31\u4f1a\u53d1\u73b0\u4f60\u7684\u751f\u6d3b\u5c06\u4f1a\u66f4\u52a0\u5730\u7965\u548c\u3002 </xf:comment>","title":"\u5bf9\u6a21\u677f\u8fdb\u884c\u6ce8\u91ca"},{"location":"template-syntax/#_5","text":"xf:include \u6807\u7b7e\u5141\u8bb8\u4f60\u5728\u5f53\u524d\u6a21\u677f\u4e2d\u52a0\u5165\u4e00\u4e2a\u4e0d\u540c\u7684\u6a21\u677f\u3002 <xf:include template=\"my_template\" /> \u53ea\u9700\u5c06 template \u5c5e\u6027\u8bbe\u7f6e\u4e3a\u4f60\u60f3\u52a0\u5165\u7684\u6a21\u677f\u540d\u79f0\u5373\u53ef\u3002","title":"\u5728\u6a21\u677f\u4e2d\u52a0\u5165\u53e6\u4e00\u4e2a\u6a21\u677f"},{"location":"template-syntax/#_6","text":"\u6a21\u677f\u5de8\u96c6\u662f XenForo \u6a21\u677f\u8bed\u6cd5\u7684\u4e00\u4e2a\u975e\u5e38\u5f3a\u5927\u7684\u90e8\u5206\u3002 \u901a\u5e38\uff0c\u4f60\u5e94\u8be5\u5728\u7f16\u7a0b\u8bed\u8a00\u4e2d\u4f7f\u7528\u51fd\u6570\u6216\u5b50\u7a0b\u5e8f\u7684\u4efb\u4f55\u5730\u65b9\u4f7f\u7528\u5de8\u96c6\u3002 \u5bf9\u4e8e\u975e\u7a0b\u5e8f\u5458\u6765\u8bf4\uff0c\u6211\u628a\u8fd9\u4e00\u70b9\u603b\u7ed3\u4e3a\uff1a \u8981\u4e48\u5728 \u4efb\u4f55\u60a8\u60f3\u5728\u591a\u4e2a\u4e0d\u540c\u6587\u4ef6\u4e2d\u591a\u6b21\u751f\u6210\u76f8\u540c\u4e8b\u7269\u7684\u5730\u65b9\u4f7f\u7528\u5de8\u96c6\uff0c \u6216\u8005 \u5728\u4e0d\u540c\u60c5\u51b5\u4e0b\u751f\u6210\u4e0d\u540c\u7684\u4e1c\u897f\uff08\u5982\u679c\u4f60\u67e5\u770b\u5b9a\u4e49\u5de8\u96c6\u7684\u6307\u5357\uff0c\u8fd9\u53ef\u80fd\u4f1a\u66f4\u6709\u5e2e\u52a9\uff09\u3002 Warning \u51fa\u4e8e\u53ef\u8bfb\u6027\u539f\u56e0\uff0c\u60a8\u4e0d\u5e94\u8be5\u4f7f\u7528\u5de8\u96c6\u6807\u7b7e\u4f5c\u4e3a\u53d8\u91cf\u3002 \u60a8\u5e94\u8be5\u4f7f\u7528 Set \u6807\u7b7e\uff0c\u5e76\u50cf\u5bf9\u5f85\u4efb\u4f55\u6a21\u677f\u53d8\u91cf\u4e00\u6837\u5bf9\u5f85\u53d8\u91cf\u3002","title":"\u6a21\u677f\u5de8\u96c6"},{"location":"template-syntax/#_7","text":"<xf:macro name=\"my_macro_name\"> <!-- \u4f60\u7684\u5de8\u96c6\u5185\u5bb9 --> </xf:macro> \u6700\u7b80\u5358\u7684\uff0c\u53ef\u4ee5\u7528 name \u5c5e\u6027\u5b9a\u4e49\u4e00\u4e2a\u5de8\u96c6\uff0c\u5e76\u5728\u5de8\u96c6\u6807\u7b7e\u4e2d\u91cd\u590d\u4f60\u60f3\u8981\u7684\u5185\u5bb9\u3002 Note \u5f53\u60a8\u5728\u591a\u4e2a\u6587\u4ef6\u4e2d\u4f7f\u7528\u5de8\u96c6\u65f6\uff0c\u6700\u4f73\u505a\u6cd5\u662f\u5c06\u5de8\u96c6\u653e\u5165\u81ea\u5df1\u7684\u6a21\u677f\u4e2d\u3002","title":"\u5b9a\u4e49\u5de8\u96c6"},{"location":"template-syntax/#_8","text":"<xf:macro name=\"my_macro_name\" arg-message=\"\u6211\u8d85\u5389\u5bb3\u7684\u5de8\u96c6\u6d88\u606f\uff01\"> <h1>\u6d88\u606f</h1> <p>{$message}</p> </xf:macro> \u5728\u6b64\u793a\u4f8b\u4e2d\uff0c\u4e3a\u5de8\u96c6\u5b9a\u4e49\u4e86 arg-message ( \u6211\u60ca\u4eba\u7684\u5de8\u96c6\u6d88\u606f\uff01 ) \u7684\u9ed8\u8ba4\u503c\u3002 \u5982\u679c\u4f7f\u7528 message \u53c2\u6570\u8c03\u7528\u5de8\u96c6\uff0c\u5219\u8be5\u503c\u5c06\u88ab\u590d\u76d6\u3002 \u6709\u65f6\u9700\u8981\u5c06\u4e00\u4e2a\u53c2\u6570\u6807\u8bb0\u4e3a\u5fc5\u586b\u9879\u3002 \u8fd9\u53ef\u4ee5\u901a\u8fc7\u5728\u5de8\u96c6\u5b9a\u4e49\u4e2d\u628a\u53c2\u6570\u503c\u8bbe\u7f6e\u4e3a ! \u6765\u5b9e\u73b0\u3002","title":"\u5de8\u96c6\u53c2\u6570"},{"location":"template-syntax/#_9","text":"<xf:macro template=\"my_macro_template\" name=\"my_macro_name\" /> \u6700\u7b80\u5358\u7684\u65b9\u6cd5\u662f\uff0c\u901a\u8fc7\u8bbe\u7f6e name \u5c5e\u6027\u5e76\u5c06\u6807\u7b7e\u4fdd\u7559\u4e3a\u7a7a\u6765\u52a0\u5165\u5de8\u96c6\u3002 Note \u4f7f\u7528\u5de8\u96c6\u6807\u7b7e\u65f6\uff0c\u4f60\u5e94\u8be5\u4f7f\u7528\u6807\u7b7e\u7684\u81ea\u52a8\u5173\u95ed\u5f62\u5f0f\uff0c\u4ee5\u4fbf\u8ba9\u522b\u4eba\u66f4\u5bb9\u6613\u533a\u5206\u5de8\u96c6\u7684\u5b9a\u4e49\u548c\u7528\u6cd5\u7684\u533a\u522b\u3002","title":"\u52a0\u5165\u548c\u4f7f\u7528\u5de8\u96c6"},{"location":"template-syntax/#_10","text":"\u60a8\u8fd8\u53ef\u4ee5\u4e3a\u5de8\u96c6\u63d0\u4f9b\u53c2\u6570\uff1a <xf:macro template=\"my_macro_template\" name=\"my_macro_name\" arg-argName=\"argValue\" /> \u5176\u4e2d argName \u662f\u5de8\u96c6\u53c2\u6570\u7684\u540d\u79f0\u3002 Note \u60a8\u5e94\u8be5\u4f7f\u7528 lowerCamelCase \u6765\u547d\u540d\u4f60\u7684\u5de8\u96c6\u53c2\u6570\u3002","title":"\u5de8\u96c6\u53c2\u6570"},{"location":"template-syntax/#_11","text":"XenForo 2 \u6a21\u677f\u8bed\u6cd5\u652f\u63f4\u67d0\u4e9b\u63a7\u4ef6\u7ed3\u6784\uff0c\u4ee5\u4f7f\u67d0\u4e9b\u4efb\u52a1\u66f4\u6613\u4e8e\u5b9e\u73b0\u3002","title":"\u6a21\u677f\u63a7\u5236\u7ed3\u6784"},{"location":"template-syntax/#if","text":"if \u6a21\u677f\u6807\u7b7e\u53ef\u7528\u4e8e\u6709\u6761\u4ef6\u5730\u663e\u793a\u4e00\u4e9b HTML \u6216\u6a21\u677f\u7684\u4e00\u90e8\u5206\u3002 <!-- Shows content only if a user is signed in... --> <xf:if is=\"$xf.visitor.user_id\"> <!-- \u505a\u70b9\u4ec0\u9ebd... --> </xf:if> if \u6807\u7b7e\u5177\u6709\u4ee5\u4e0b\u5c5e\u6027\uff1a is - \u6ee1\u8db3\u6761\u4ef6\u65f6\u5e94\u663e\u793a\u6807\u7b7e\u5185\u5bb9\u7684\u6761\u4ef6\u3002","title":"If \u6807\u7b7e"},{"location":"template-syntax/#_12","text":"\u8be5 is \u5c5e\u6027\u652f\u63f4\u4e00\u4e9b\u903b\u8f91\u8fd0\u7b97\u7b26\uff1a OR - \u7528\u4e8e\u8fde\u63a5\u66ff\u4ee3\u6761\u4ef6\u3002\uff08\u4e8c\u62e9\u4e00\uff1a || \uff09 AND - \u7528\u4e8e\u8fde\u63a5\u5176\u4ed6\u6761\u4ef6\u3002 (\u4e8c\u62e9\u4e00: && \uff09 ! - \u653e\u5728\u6761\u4ef6\u524d\uff0c\u4f7f\u5176\u53cd\u8ee2\u3002\uff08\u79f0\u4e3a\uff1a\"\u5426\"\uff09 XOR - \u5982\u679c\u4e24\u4e2a\u6761\u4ef6\u4e2d\u53ea\u6709\u4e00\u4e2a\u4e3a true\uff0c\u5219\u8fd4\u56de true\u3002\uff08\u79f0\u4e3a\uff1a\"\u5f02\u6216\"\uff09","title":"\u6761\u4ef6"},{"location":"template-syntax/#elseelse-if","text":"else \u548c else-if \u6807\u7b7e\u4e0e if \u6807\u7b7e\u7ed3\u5408\u4f7f\u7528\uff0c\u4ee5\u6309\u540d\u79f0\u5efa\u8bae\u7684\u65b9\u5f0f\u6709\u6761\u4ef6\u5730\u663e\u793a HTML\u3002 else \u7528\u6cd5\u793a\u4f8b\uff1a <xf:if is=\"$xf.visitor.is_admin\"> <!-- \u8fd9\u91cc\u7684\u5185\u5bb9\u53ea\u6709\u7ba1\u7406\u5458\u624d\u4f1a\u770b\u5230... --> <xf:else /> <!-- \u8fd9\u91cc\u7684\u5185\u5bb9\u5c06\u88ab\u663e\u793a\u7ed9\u4efb\u4f55\u975e\u7ba1\u7406\u5458\u7684\u4eba\u770b\u5230\uff01 --> </xf:if> else-if \u7684\u7528\u6cd5\u793a\u4f8b\uff1a <xf:if is=\"$xf.visitor.is_admin\"> <!-- \u8fd9\u91cc\u7684\u5185\u5bb9\u53ea\u6709\u7ba1\u7406\u5458\u624d\u4f1a\u770b\u5230... --> <xf:elseif is=\"$xf.visitor.is_moderator\" /> <!-- \u8fd9\u91cc\u7684\u5185\u5bb9\u53ea\u4f1a\u663e\u793a\u7ed9\u7248\u4e3b(\u4e0d\u5305\u62ec\u517c\u4efb\u7ba1\u7406\u5458\u7684\u7528\u6237)\u3002 --> <xf:else /> <!-- \u8fd9\u91cc\u7684\u5185\u5bb9\u5c06\u663e\u793a\u7ed9\u975e\u7ba1\u7406\u5458\u6216\u7248\u4e3b\u7684\u4efb\u4f55\u4eba\u3002 --> </xf:if> \u6b63\u5982\u4f60\u6240\u770b\u5230\u7684\uff0c\u4e00\u65e6\u4e00\u4e2a\u6761\u4ef6\u88ab\u6ee1\u8db3\uff0c\u5176\u4f59\u7684 if \u8bed\u53e5\u5c06\u88ab\u5ffd\u7565\u3002\uff08\u6240\u4ee5\uff0c\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u5982\u679c\u7528\u6237\u662f\u7ba1\u7406\u5458\uff0c\u4e0a\u9762\u7684 xf:if \u90e8\u5206\u88ab\u8fd0\u884c\uff0c\u5176\u4f59\u7684 if \u8bed\u53e5\u5219\u88ab\u5ffd\u7565\u3002)","title":"Else/Else-If \u6807\u7b7e"},{"location":"template-syntax/#for-each","text":"for-each \u6807\u7b7e\u4f7f\u60a8\u53ef\u4ee5\u904d\u5386\u9879\u76ee\u6570\u7ec4\uff0c\u4e3a\u6bcf\u4e2a\u9879\u76ee\u5370\u51fa HTML \u533a\u5757\u3002 <xf:set var=\"$names\" value=\"{{ ['\u6d3e\u7fe0\u514b', '\u7279\u4e3d\u838e', '\u91d1\u535a\u5c14', '\u97e6\u6069', '\u683c\u96f7\u65af'] }}\" /> <xf:foreach loop=\"$names\" key=\"$key\" value=\"$name\" i=\"$i\"> <p>\u4f60\u597d\uff0c {$name}\u3002 \u8fd9\u662f\u540d\u5b57 {$i} \u3002 \u8be5\u5143\u7d20\u7684\u6570\u7ec4 key \u503c\u4e3a\uff1a {$key}</p> </xf:foreach> for-each \u6807\u7b7e\u5177\u6709\u4ee5\u4e0b\u5c5e\u6027\uff1a loop - \u8981\u5faa\u73af\u7684\u6570\u7ec4\u3002 key - \u5728\u5faa\u73af\u4e2d\u4f7f\u7528\u7684\u53d8\u91cf\u540d\u79f0\uff0c\u4ee5\u83b7\u53d6\u5f53\u524d\u5143\u7d20\u7684\u6570\u7ec4 key\u3002 \u53ef\u4ee5\u662f\u6574\u6570\uff08\u666e\u901a\u6570\u7ec4\uff09\u6216\u5b57\u7b26\u4e32\uff08\u5173\u8054\u6570\u7ec4\uff09\u3002 value - \u5728\u5faa\u73af\u4e2d\u4f7f\u7528\u7684\u53d8\u91cf\u540d\u79f0\uff0c\u5305\u542b\u5f53\u524d\u6570\u7ec4\u9879\u3002 i - \u5728\u5faa\u73af\u4e2d\u7528\u4e8e\u5f53\u524d\u7d22\u5f15\u7684\u53d8\u91cf\u540d\u79f0\u3002","title":"For-each \u6807\u7b7e"},{"location":"template-syntax/#_13","text":"\u4f60\u597d\uff0c\u6d3e\u7fe0\u514b\u3002 \u8fd9\u662f\u540d\u5b57 1\u3002 \u4f60\u597d\uff0c\u7279\u4e3d\u838e\u3002 \u8fd9\u662f\u540d\u5b57 2\u3002 \u4f60\u597d\uff0c\u91d1\u535a\u5c14\u3002 \u8fd9\u662f\u540d\u5b57 3\u3002 \u4f60\u597d\uff0c\u97e6\u6069\u3002 \u8fd9\u662f\u540d\u5b57 4\u3002 \u4f60\u597d\uff0c\u683c\u96f7\u65af\u3002 \u8fd9\u662f\u540d\u5b57 5\u3002","title":"\u8f93\u51fa\u793a\u4f8b"},{"location":"template-syntax/#_14","text":"","title":"\u6a21\u677f\u6807\u7b7e"},{"location":"template-syntax/#_15","text":"\u5728\u9875\u9762\u4e2d\u63d2\u5165\u7528\u6237\u7684\u5934\u50cf\u3002 <xf:avatar user=\"{$xf.visitor}\" size=\"o\" canonical=\"true\" /> \u5934\u50cf\u6807\u7b7e\u5177\u6709\u4ee5\u4e0b\u5c5e\u6027\uff1a user - \u8981\u751f\u6210\u5934\u50cf\u7684 XenForo \u7528\u6237\u7269\u4ef6\u3002 size - \u8981\u751f\u6210\u7684\u56fe\u50cf\u5927\u5c0f\u3002(\u53c2\u89c1\u56fe\u50cf\u5c3a\u5bf8) canonical - \u662f\u5426\u4f7f\u7528\u6709\u5229\u4e8e SEO \u7684\u5b8c\u6574 URL\u3002\u8be5\u503c\u53ea\u5bf9 custom \u5934\u8c61\u6709\u6548\u3002 notooltip - \u5f53\u9f20\u6807\u60ac\u505c\u5728\u5934\u50cf\u4e0a\u65f6\u663e\u793a\u7684\u5de5\u5177\u63d0\u793a\u662f\u5426\u5e94\u8be5\u88ab\u5173\u95ed\u3002 forcetype - \u53ef\u4ee5\u7528\u6765\u5f3a\u5236\u53d6\u5f97 gravatar \u6216 custom \u5934\u50cf\uff0c\u8bbe\u7f6e\u503c\u4e3a\u5176\u4e2d\u4e4b\u4e00\u3002 defaultname - \u5982\u679c user \u5c5e\u6027\u5305\u542b\u4e00\u4e2a\u65e0\u6548\u7684\u7528\u6237\u65f6\uff0c\u9ed8\u8ba4\u8981\u4f7f\u7528\u7684\u7528\u6237\u540d\u79f0\u3002","title":"\u5934\u50cf\u6807\u7b7e"},{"location":"template-syntax/#_16","text":"\u5982\u679c\u63d0\u4f9b\u7684\u5934\u50cf\u5927\u5c0f\u65e0\u6548\uff0c\u5219\u4ee3\u7801\u5c06\u56de\u9000\u5230\u5927\u5c0f ' s '\u3002 o - 384px h - 384px l - 192px m - 96px s - 48px","title":"\u56fe\u50cf\u5927\u5c0f"},{"location":"template-syntax/#_17","text":"\u4fee\u6539\u9875\u9762\u8def\u5f84\u5bfc\u89c8\u5217\u3002 <xf:breadcrumb href=\"{{ link('my_page') }}\">{{ phrase('my_page_name') }}</xf:breadcrumb> \u9875\u9762\u8def\u5f84\u5bfc\u89c8\u5217\u6807\u7b7e\u5177\u6709\u4ee5\u4e0b\u5c5e\u6027\uff1a href - \u4e3a\u9875\u9762\u8def\u5f84\u5bfc\u89c8\u5217\u4e2d\u7684\u6700\u540e\u4e00\u4e2a\u5143\u7d20\u8bbe\u7f6e\u7684\u94fe\u63a5\u3002 \u6807\u7b7e\u7684\u503c\u53ef\u7528\u4e8e\u8bbe\u7f6e\u9875\u9762\u8def\u5f84\u5bfc\u89c8\u5217\u4e2d\u6700\u540e\u4e00\u4e2a\u5143\u7d20\u7684\u540d\u79f0\u3002","title":"\u9875\u9762\u8def\u5f84\u5bfc\u89c8\u5217\u6807\u7b7e"},{"location":"template-syntax/#_18","text":"<xf:breadcrumb source=\"$category.getBreadcrumbs(false)\" /> \u60a8\u8fd8\u53ef\u4ee5\u901a\u8fc7 source \u5728\u9875\u9762\u8def\u5f84\u5bfc\u89c8\u5217\u6807\u7b7e\u7684\u5c5e\u6027\u4e2d\u8c03\u7528\u51fd\u6570\u6765\u4ee5\u7f16\u7a0b\u65b9\u5f0f\u5b9a\u4e49\u81ea\u5df1\u7684\u9875\u9762\u8def\u5f84\u5bfc\u89c8\u5217\u3002 \u8be5 source \u53c2\u6570\u57fa\u672c\u4e0a\u91c7\u7528\u4e00\u4e2a\u5177\u6709 href \u548c value \u5c5e\u6027\u7684\u7269\u4ef6\u6570\u7ec4\uff08\u591a\u7ef4\u6570\u7ec4\uff09\uff0c\u5176\u4e2d\u6bcf\u4e2a\u7269\u4ef6\u90fd\u662f\u4e00\u4e2a\u9875\u9762\u8def\u5f84\u5bfc\u89c8\u5217\u5143\u7d20\u3002 Note \u5982\u679c\u8981\u66f4\u6539\u6839\u76ee\u5f55\u9875\u9762\u8def\u5f84\u5bfc\u89c8\u5217\uff0c\u53ef\u4ee5\u5728 \"\u57fa\u672c\u4fe1\u606f\u9762\u677f\" \u9009\u9879\u90e8\u5206\u4e2d\u66f4\u6539 \"Root breadcrumb\" \u9009\u9879\u3002","title":"\u5176\u4ed6\u7528\u6cd5"},{"location":"template-syntax/#_19","text":"\u6dfb\u52a0\u5177\u6709\u9002\u5f53\u7c7b\u7684\u6309\u94ae\u5143\u7d20\u4ee5\u53ca\uff08\u53ef\u9009\uff09\u56fe\u6807\u3002 <xf:button icon=\"save\"></xf:button> button \u6807\u7b7e\u5177\u6709\u4ee5\u4e0b\u5c5e\u6027\uff1a icon - \u5e94\u7528\u4e8e\u6309\u94ae\u7684\u56fe\u6807\u7c7b\u3002(\u53c2\u89c1\u6309\u94ae\u56fe\u6807)","title":"\u6309\u94ae\u6807\u7b7e"},{"location":"template-syntax/#_20","text":"\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cXenForo \u6309\u94ae\u652f\u63f4\u4ee5\u4e0b\u56fe\u6807\uff08\u4f7f\u7528CSS\u521b\u5efa\uff09\uff1a add confirm write import export download disable edit save reply quote purchase payment convert search sort upload attach login rate config refresh translate vote result history cancel preview conversation bolt list prev next markRead notificationsOn notificationsOff merge move copy approve unapprove delete undelete stick unstick lock unlock","title":"\u6309\u94ae\u56fe\u6807"},{"location":"template-syntax/#callback","text":"\u8fd0\u884c\u4e00\u4e2a PHP Callback \u65b9\u6cd5\u3002 <xf:callback class=\"Vendor\\Addon\\Class\" method=\"getX\" params=\"['abc']\"></xf:callback> \u6b64 callback \u6807\u7b7e\u5177\u6709\u4ee5\u4e0b\u5c5e\u6027\uff1a class - \u8be5 class\uff08\u4ece root \u547d\u540d\u7a7a\u95f4\uff09\u5305\u542b\u8981\u8fd0\u884c\u7684\u65b9\u6cd5\u3002 method - \u8981\u8fd0\u884c\u7684\u65b9\u6cd5\u3002 (\u53c2\u89c1 callback \u65b9\u6cd5) params - \u63d0\u4f9b\u7ed9\u6b64\u65b9\u6cd5\u7684\u53c2\u6570\u6570\u7ec4\u3002","title":"Callback \u6807\u7b7e"},{"location":"template-syntax/#callback_1","text":"\u4e3a\u4e86\u4f7f\u4e00\u4e2a\u65b9\u6cd5\u88ab\u8ba4\u4e3a\u662f callback \u65b9\u6cd5\uff0c\u5fc5\u987b\u5bf9\u5176\u8fdb\u884c\u9002\u5f53\u7684\u547d\u540d\uff0c\u5426\u5219\u5b83\u5c06\u629b\u51fa\u9519\u8bef ' callback_method_x_does_not_appear_to_indicate_read_only '\u3002\u4e3a\u4e86\u4f7f\u5b83\u88ab\u8ba4\u4e3a\u662f\u552f\u8bfb\u7684\uff0c\u65b9\u6cd5\u540d\u79f0\u5fc5\u987b\u4ee5\u4e0b\u5217\u524d\u7f00\u4e4b\u4e00\u5f00\u5934\uff1a are can count data display does exists fetch filter find get has is pluck print render return show total validate verify view","title":"Callback \u65b9\u6cd5"},{"location":"template-syntax/#css","text":"\u52a0\u5165\u4e00\u4e2a\u5916\u90e8 CSS \u6216 LESS \u6a21\u677f\u6587\u4ef6\u3002 <xf:css src=\"mycss_file.css\" /> CSS \u6807\u7b7e\u5177\u6709\u4ee5\u4e0b\u5c5e\u6027\uff1a src - \u8981\u52a0\u5165\u7684 CSS \u6216 LESS \u6a21\u677f\u6587\u4ef6\u3002","title":"CSS \u6807\u7b7e"},{"location":"template-syntax/#_21","text":"<xf:css> html, body { font-family: \"Roboto\", sans-serif; } </xf:css> \u5982\u679c CSS \u6807\u7b7e\u4e0d\u4e3a\u7a7a\uff0c\u5219\u6807\u7b7e\u4e2d\u7684\u6240\u6709\u5185\u5bb9\u90fd\u5c06\u8ee2\u6362\u4e3a\u5d4c\u5165\u5f0f CSS\u3002","title":"\u5176\u4ed6\u7528\u6cd5"},{"location":"template-syntax/#_22","text":"\u5bf9\u4e8e[CSS]\uff0c\u4e0d\u7528\u518d\u5c06\u5b83\u4eec\u79f0\u4e3a\u6587\u4ef6\u4e86\u3002\u5c06\u5b83\u4eec\u590d\u5236\u5e76\u7c98\u8d34\u5230\u65b0\u6a21\u677f\u4e2d\uff0c\u5e76\u6309\u5982\u4e0b\u6240\u793a\u8fdb\u884c\u8c03\u7528\uff1a \u6765\u6e90\u81ea\uff1a \u514b\u91cc\u65af\u00b7D\uff0cXenForo \u5f00\u53d1\u4eba\u5458 <xf:css src=\"questionthreads_fonticonpicker.css\" /> <xf:css src=\"questionthreads_fonticonpicker_grey.css\" />","title":"\u8fdb\u4e00\u6b65\u8bf4\u660e"},{"location":"template-syntax/#js","text":"\u52a0\u5165\u4e00\u4e2aJavaScript\u6587\u4ef6\u3002 <xf:js src=\"myaddon/vendor/scripts/myjs_file.js\" /> JS \u6807\u7b7e\u5177\u6709\u4ee5\u4e0b\u5c5e\u6027\uff1a src - \u8981\u52a0\u5165\u5230\u6a21\u677f\u4e2d\u7684 JS \u6587\u4ef6\u3002 prod - \u8981\u52a0\u5165\u5230\u6a21\u677f\u4e2d\u7684 JS \u6587\u4ef6\uff0c\u53ea\u9002\u7528\u4e8e\u751f\u4ea7\u6a21\u5f0f\u3002 dev - \u8981\u52a0\u5165\u5230\u6a21\u677f\u4e2d\u7684 JS \u6587\u4ef6\uff0c\u53ea\u9002\u7528\u4e8e\u5f00\u53d1\u6a21\u5f0f\u3002 min - \u662f\u5426\u8981\u52a0\u5165\u6700\u5c0f\u5316\u7248\u672c\u7684\u6587\u4ef6\u3002(\u7528 .min.js \u53d6\u4ee3 .js ) - \u53ea\u9700\u8981\u5728\u751f\u4ea7\u6a21\u5f0f\u4e0b\u5173\u5fc3\u3002 addon - \u662f\u5426\u8981\u4f7f\u7528\u5f00\u53d1\u4e2d JS \u7684 URL\u3002 - \u53ea\u9700\u8981\u5728\u5f00\u53d1\u6a21\u5f0f\u4e0b\u5173\u5fc3\u3002 Warning The src tag cannot be used in conjunction with either the prod or dev tags.","title":"JS \u6807\u7b7e"},{"location":"template-syntax/#_23","text":"<xf:js> alert(\"\u771f\u76f8\u5f88\u4f24\u4eba\uff0c\u6211\u77e5\u9053\u3002\u5176\u5b9e\u8fd9\u662f\u57fa\u4e8e\u751f\u7269\u5b66\u4e0a\u7684\u3002\"); </xf:js> \u5982\u679c JS \u6807\u7b7e\u4e0d\u4e3a\u7a7a\uff0c\u5219\u6807\u7b7e\u4e2d\u7684\u6240\u6709\u5185\u5bb9\u90fd\u4f1a\u8ee2\u6362\u4e3a\u5d4c\u5165\u5f0f JS\u3002","title":"\u5176\u4ed6\u7528\u6cd5"},{"location":"template-syntax/#_24","text":"JavaScript \u6587\u4ef6\u662f\u76f8\u5bf9\u4e8e /js \u76ee\u5f55\u63d0\u4f9b\u7684\u3002\u5c3d\u7ba1\u4e0d\u5efa\u8bae\u8fd9\u6837\u505a\uff0c\u4f46\u60a8\u4e5f\u53ef\u4ee5\u5728\u6b64\u6807\u7b7e\u4e2d\u52a0\u5165\u5916\u90e8\u8d44\u6e90\u3002 \u8fd9\u4e2a\u6807\u7b7e\u5728 editor \u6a21\u677f\u4e2d\u5c31\u662f\u4e00\u4e2a\u5f88\u597d\u7684\u4f8b\u5b50\u3002","title":"\u8fdb\u4e00\u6b65\u8bf4\u660e"},{"location":"template-syntax/#set","text":"set \u6807\u7b7e\u5141\u8bb8\u60a8\u521b\u5efa\u4e00\u4e2a\u5bf9\u53e6\u4e00\u4e2a\u53d8\u91cf\u7684\u53c2\u8003\u6216\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u53d8\u91cf\u3002\u4f60\u5e94\u8be5\u5728\u7f16\u7a0b\u8bed\u8a00\u4e2d\u4f7f\u7528\u53d8\u91cf\u7684\u4efb\u4f55\u5730\u65b9\u4f7f\u7528 set \u6807\u7b7e\u3002 <xf:set var=\"$visitor\" value=\"{$xf.visitor}\" /> Warning \u4e0d\u8981\u5bf9\u8981\u5728\u591a\u4e2a\u6a21\u677f\u4e2d\u4f7f\u7528\u7684\u4e00\u7ec4\u5143\u7d20\u4f7f\u7528 Set \u6807\u7b7e\uff0c\u800c\u5e94\u4f7f\u7528 Macro \u6807\u7b7e\u3002 Warning \u53d8\u91cf\u540d\u79f0\uff08 var \u5c5e\u6027\uff09\u5fc5\u987b\u4ee5 $ \u5f00\u5934\u3002 set \u6807\u7b7e\u5177\u6709\u4ee5\u4e0b\u5c5e\u6027\uff1a: var - \u60a8\u60f3\u5b9a\u4e49\u53d8\u91cf\u7684\u540d\u79f0\uff08\u672c\u8d28\u4e0a\u662f\u522b\u540d\uff09\u3002 value - \u8981\u53c2\u8003\u7684\u53d8\u91cf\u6216\u53d8\u91cf\u503c\u3002","title":"Set \u6807\u7b7e"},{"location":"template-syntax/#_25","text":"<xf:set var=\"$myVariableName\"> \u6211\u7684\u53d8\u91cf\u503c! \u8fd9\u53ef\u4ee5\u662f\u4e00\u4e2a callback\uff0c\u6216\u8005\u53ea\u662f\u4e00\u7ec4\u77ed\u8bed\u3002 </xf:set> \u5982\u679c value \u672a\u63d0\u4f9b\u5c5e\u6027\u4e14\u6807\u7b7e\u4e0d\u4e3a\u7a7a\uff0c\u5219\u53d8\u91cf\u503c\u5c06\u8bbe\u7f6e\u4e3a\u6807\u7b7e\u7684\u5185\u5bb9\u3002 Warning \u5f53\u60a8\u4ee5\u8fd9\u79cd\u5f62\u5f0f\u4f7f\u7528 Set \u6807\u7b7e\u65f6\uff0c\u8be5\u503c\u5c06\u88ab\u8ee2\u4e49\uff0c\u5e76\u4e14\u7ed3\u679c\u503c\u5c06\u662f\u4e00\u4e2a\u5b57\u7b26\u4e32\u3002\u8be5 value \u5c5e\u6027\u867d\u7136\u4e0d\u652f\u63f4 HTML \u6216\u7c7b\u4f3c HTML \u7684\u6807\u7b7e\uff0c\u4f46\u6ca1\u6709\u6b64\u9650\u5236\u3002","title":"\u5176\u4ed6\u7528\u6cd5"},{"location":"template-syntax/#likes","text":"\u663e\u793a\u5e16\u5b50\u7684\u559c\u6b22\u6b21\u6570\u4ee5\u53ca\u4e00\u4e9b\u559c\u6b22\u8be5\u5e16\u5b50\u7684\u7528\u6237\u3002 <xf:likes content=\"{$post}\" url=\"\" /> likes \u6807\u7b7e\u5177\u6709\u4ee5\u4e0b\u5c5e\u6027\uff1a content - \u8981\u663e\u793a '\u559c\u6b22' \u6587\u672c\u7684 XF\\Entity\\Post \u6216 XF\\Entity\\ProfilePost \u6570\u636e\u5b9e\u4f53\u3002 url - \u70b9\u51fb '\u559c\u6b22' \u6587\u672c\u65f6\u663e\u793a\u7684 URL\u3002","title":"Likes \u6807\u7b7e"},{"location":"template-syntax/#_26","text":"\u4f60, \u91cc\u65af\u672c, kcho \u548c 2 \u5176\u4ed6\u4eba \u683c\u5f0f\u4e3a [\ud83d\udc4d abc \u548c 2 \u5176\u4ed6\u4eba]\uff08\u5176\u4e2d \ud83d\udc4d \"\u5927\u62c7\u6307\" \u8868\u60c5\u7b26\u4ee3\u8868 \"\u70b9\u8cdb\" \u56fe\u6807\uff0c abc \u4ee3\u8868\u6700\u540e\u4e09\u4e2a\u70b9\u8cdb\u8be5\u5e16\u5b50\u7684\u7528\u6237\u540d\u5b57\u3002\uff09","title":"\u683c\u5f0f"},{"location":"template-syntax/#sidebar","text":"\u53c2\u89c1 Sectioned \u6807\u7b7e .","title":"Sidebar \u6807\u7b7e"},{"location":"template-syntax/#sidenav","text":"\u53c2\u89c1 Sectioned \u6807\u7b7e .","title":"SideNav \u6807\u7b7e"},{"location":"template-syntax/#title","text":"\u8bbe\u7f6e\u9875\u9762\u7684\u6807\u9898\uff0c\u5305\u62ec\u9875\u9762\u4e0a\u7684 h1 \u6807\u7b7e\u548c\u6d4f\u89c8\u5668\u6807\u7b7e\u3002 <xf:title>{{ phrase('my_page_title') }}</xf:title>","title":"Title \u6807\u7b7e"},{"location":"template-syntax/#_27","text":"\u867d\u7136\u53ef\u4ee5\u5bf9 Title \u8fdb\u884c\u6c38\u4e45\u6027\u7f16\u8f91\uff0c\u4f46\u662f \u5f3a\u70c8\u5efa\u8bae \u60a8\u4f7f\u7528\u4e00\u4e2a\u77ed\u8bed\uff0c\u4ee5\u5b9e\u73b0\u56fd\u9645\u5316\uff0c\u5e76\u589e\u52a0\u7f51\u7ad9\u7ba1\u7406\u5458\u7aef\u7684\u53ef\u5b9a\u5236\u6027\u3002","title":"\u8fdb\u4e00\u6b65\u8bf4\u660e"},{"location":"template-syntax/#widget","text":"\u5728\u9875\u9762\u4e2d\u5305\u542b\u5c0f\u7ec4\u4ef6\uff0c\u6216\u5c06\u5c0f\u7ec4\u4ef6\u6dfb\u52a0\u5230\u5c0f\u7ec4\u4ef6\u7684\u4f4d\u7f6e\u4e0a\u3002 <xf:widget key=\"widget_name\" /> widget \u6807\u7b7e\u5177\u6709\u4ee5\u4e0b\u5c5e\u6027\uff1a key - \u5c0f\u7ec4\u4ef6\u7684 key\uff0c\u5982\u5c0f\u7ec4\u4ef6\u8bbe\u7f6e\u4e2d\u5b9a\u4e49\u7684\u3002 position - \u5982\u679c\u8bbe\u7f6e\uff0c\u5219\u6539\u53d8\u5c0f\u7ec4\u4ef6\u5c06\u88ab\u55a7\u67d3\u7684\u4f4d\u7f6e\u3002 class - \u4e0d\u8981\u4e0e HTML \u7684 class \u6df7\u80b4\uff0c\u8fd9\u662f\u5305\u542b\u5c0f\u7ec4\u4ef6\u5b9a\u4e49\u7684 PHP \u7c7b\u3002 title - \u5f53\u4f7f\u7528 class \u5c5e\u6027\u65f6\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528 title \u5c5e\u6027\u6765\u8bbe\u7f6e\u5c0f\u7ec4\u4ef6\u7684\u6807\u9898\u3002 \u5f53\u4f7f\u7528 class \u5c5e\u6027\u65f6\uff0c\u4f60\u4e5f\u53ef\u4ee5\u63d0\u4f9b\u5c0f\u7ec4\u4ef6\u7279\u5b9a\u7684\u9009\u9879\u4f5c\u4e3a\u5c5e\u6027\u3002 Warning class \u6807\u7b7e\u4e0d\u80fd\u4e0e key \u6807\u7b7e\u4e00\u8d77\u4f7f\u7528\u3002","title":"Widget \u6807\u7b7e"},{"location":"template-syntax/#useractivity","text":"\u6839\u636e\u7528\u6237\u4e0a\u4e00\u6b21\u64cd\u4f5c\u4ee5\u53ca\u8be5\u64cd\u4f5c\u53d1\u751f\u7684\u65f6\u95f4\u6765\u663e\u793a\u7528\u6237\u7684\u72b6\u6001\u3002 <xf:useractivity user=\"{$xf.visitor}\" /> UserActivity \u6807\u7b7e\u5177\u6709\u4ee5\u4e0b\u5c5e\u6027\uff1a user - \u7528\u6237\u663e\u793a\u7684\u72b6\u6001\u3002","title":"UserActivity \u6807\u7b7e"},{"location":"template-syntax/#_28","text":"\u67e5\u770b\u9875\u9762 \u6700\u65b0\u6848\u4f8b\u6587\u4ef6 \u00b7 4\u5206\u953a\u524d \u683c\u5f0f\u4e3a [\u6d3b\u52a8\u540d\u79f0] \u00b7 [\u65f6\u95f4]","title":"\u683c\u5f0f"},{"location":"template-syntax/#userbanners","text":"\u5728\u6c34\u5e73\u5217\u8868\u4e2d\u663e\u793a\u7528\u6237\u7684\u6a2a\u5e45\u3002 <xf:userbanners user=\"{$xf.visitor}\" /> UserBanners \u6807\u7b7e\u5177\u6709\u4ee5\u4e0b\u5c5e\u6027\uff1a user - \u663e\u793a\u8be5\u7528\u6237\u7684\u7528\u6237\u6a2a\u5e45\u3002","title":"UserBanners \u6807\u7b7e"},{"location":"template-syntax/#_29","text":"UserBanners \u6807\u7b7e\u7684\u793a\u4f8b\u7ed3\u679c\u3002","title":"\u793a\u4f8b"},{"location":"template-syntax/#userblurb-tag","text":"\u663e\u793a\u7528\u6237\u4e2a\u4eba\u8d44\u6599\u7684\u5358\u884c\u6458\u8981\u3002 <xf:userblurb user=\"${xf.visitor}\" /> UserBlurb \u6807\u7b7e\u5177\u6709\u4ee5\u4e0b\u5c5e\u6027\uff1a user - \u663e\u793a XenForo \u7528\u6237\u5bf9\u8c61\u7684\u7b80\u4ecb\u3002","title":"UserBlurb tag"},{"location":"template-syntax/#_30","text":"FBI \u987e\u95ee \u00b7 43 \u00b7 \u6765\u81ea\u7f8e\u56fd \u683c\u5f0f\u4e3a [\u89d2\u8272 / \u81ea\u5b9a\u4e49\u6807\u9898] \u00b7 \u5e74\u9f84 \u00b7 \u4f4d\u7f6e","title":"\u683c\u5f0f"},{"location":"template-syntax/#username","text":"Displays the user's username, optionally with a tool-tip. \u663e\u793a\u7528\u6237\u7684\u7528\u6237\u540d\uff0c\u53ef\u9009\u62e9\u4f7f\u7528\u5de5\u5177\u63d0\u793a\u3002 \u663e\u793a\u7528\u6237\u7684\u7528\u6237\u540d\uff08\u53ef\u9009\uff09\u548c\u5de5\u5177\u63d0\u793a\u3002 <xf:username user=\"{$xf.visitor.username}\" notooltip=\"true\" /> Username \u6807\u7b7e\u5177\u6709\u4ee5\u4e0b\u5c5e\u6027\uff1a user - \u8981\u663e\u793a\u5176\u540d\u79f0\u7684 XenForo \u7528\u6237\u5bf9\u8c61\u3002 notooltip - \u662f\u5426\u5173\u95ed\u5de5\u5177\u63d0\u793a\u3002 href - \u70b9\u51fb\u7528\u6237\u540d\u65f6\u6240\u5bfc\u5411\u5230\u7684\u94fe\u63a5\u3002 Warning \u5982\u679c\u8bbe\u7f6e\u4e86 href \uff0c\u5219\u4e0d\u4f1a\u663e\u793a\u5de5\u5177\u63d0\u793a\uff0c\u56e0\u4e3a\u5b83\u4e0d\u8d77\u4f5c\u7528\uff0c\u800c\u4e14\u53ef\u80fd\u4f1a\u8bef\u5bfc\u7528\u6237\u3002","title":"Username \u6807\u7b7e"},{"location":"template-syntax/#usertitle","text":"Displays the user's title.\u663e\u793a\u7528\u6237\u7684\u5934\u8854\u3002 <xf:usertitle user=\"{$xf.visitor}\" /> UserTitle \u6807\u7b7e\u5177\u6709\u4ee5\u4e0b\u5c5e\u6027\uff1a user - \u6b64 XenForo \u7528\u6237\u7269\u4ef6\uff0c\u7528\u4e8e\u663e\u793a\u7528\u6237\u5934\u8854\u3002","title":"UserTitle \u6807\u7b7e"},{"location":"template-syntax/#sectioned","text":"Sectioned \u6807\u7b7e\u5168\u90fd\u4f1a\u8c03\u7528\u51fd\u6570 modifySectionedHtml \u3002 \u5b83\u4eec\u4fee\u6539\u7684 HTML \u5143\u7d20\u5c31\u662f\u6807\u7b7e\u540d\u79f0\u3002\u56e0\u6b64 sidebar \u6807\u7b7e\u4f1a\u4fee\u6539\u4fa7\u8fb9\u680f\u7684 HTML \u7b49\u7b49\u3002","title":"Sectioned \u6807\u7b7e"},{"location":"template-syntax/#_31","text":"<xf:sidebar> <h1>\u6211\u7684\u795e\u5947\u4fa7\u8fb9\u680f\uff01</h1> </xf:sidebar>","title":"\u793a\u4f8b"},{"location":"template-syntax/#_32","text":"mode - \u4fee\u6539\u6a21\u5f0f\u3002\uff08\u8bf7\u53c2\u9605\u4fee\u6539\u6a21\u5f0f\uff09","title":"\u5171\u540c\u5c5e\u6027"},{"location":"template-syntax/#_33","text":"\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u4fee\u6539\u65b9\u5f0f\u4e3a replace \u3002\uff08\u5373\uff0c\u5982\u679c\u6ca1\u6709\u6307\u5b9a\u5c5e\u6027\u3002\uff09 prepend - \u5c06\u6807\u7b7e\u7684\u5185\u5bb9\u653e\u5728 HTML \u5143\u7d20\u7684\u5f00\u5934\u3002 append - \u5c06\u6807\u7b7e\u7684\u5185\u5bb9\u653e\u5728 HTML \u5143\u7d20\u7684\u672b\u5c3e\u3002 replace - \u7528\u6807\u7b7e\u7684\u5185\u5bb9\u66ff\u6362 HTML \u7684\u5143\u7d20\u3002","title":"\u4fee\u6539\u65b9\u5f0f"}]}