{"config":{"lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"\u5165\u9580\u9808\u77e5 \u00b6 \u6b61\u8fce\u4f7f\u7528 XenForo 2\uff01 \u672c\u6587\u6a94\u65e8\u5728\u5e6b\u52a9\u60a8\u958b\u59cb XenForo 2.0 \u958b\u767c\u3002 \u672c\u6587\u6a94\u7684\u524d\u63d0\u689d\u4ef6\u5047\u8a2d\u60a8\u5df2\u719f\u6089 PHP \u548c MySQL\u3002 \u4e26\u975e\u4e00\u5b9a\u8981\u64c1\u6709 XenForo \u4ee5\u524d\u7248\u672c\u7684\u7d93\u9a57\uff0c\u4f46\u9019\u5c07\u662f\u4e00\u500b\u512a\u52e2\u3002 \u5728\u63a5\u4e0b\u4f86\u7684\u9801\u9762\u4e2d\uff0c\u6211\u5011\u5c07\u5411\u60a8\u7c21\u8981\u4ecb\u7d39\u5982\u4f55\u8a2d\u7f6e\u672c\u5730\u4f3a\u670d\u5668\uff0c\u6e96\u5099\u5b89\u88dd\uff0c\u5168\u65b0\u5b89\u88dd XenForo 2.0 \u4ee5\u53ca\u904b\u884c XF2 \u958b\u767c\u7684\u4e00\u4e9b\u6982\u5ff5\u3002 \u958b\u767c\u4eba\u54e1\u6709\u4ec0\u9ebc\u65b0\u529f\u80fd\uff1f \u00b6 \u5118\u7ba1 XenForo 2.0 \u70ba\u60a8\u7684\u8ad6\u58c7\u53ca\u5176\u6210\u54e1\u589e\u52a0\u4e86\u8a31\u591a\u6539\u9032\uff0c\u4f46\u6211\u5011\u4ecd\u6295\u5165\u4e86\u5927\u91cf\u7cbe\u529b\u4f86\u6539\u9032 XenForo \u7684\u5e95\u5c64\u6846\u67b6\u3002 \u60a8\u53ef\u4ee5\u5728\u4ee5\u4e0b\u5e16\u5b50\u4e2d\u95b1\u8b80\u66f4\u591a\u95dc\u65bc\u9019\u4e9b\u66f4\u6539\u7684\u66f4\u591a\u4fe1\u606f\uff1a XenForo 2 \u4e2d\u7684\u958b\u767c\u4eba\u54e1\u65b0\u529f\u80fd\uff08\u7b2c1\u90e8\u5206\uff09 XenForo 2 \u958b\u767c\u4eba\u54e1\u7684\u65b0\u589e\u529f\u80fd\uff08\u7b2c2\u90e8\u5206\uff09 \u5165\u9580\u9808\u77e5 \u00b6 XF \u958b\u767c\u5165\u9580\u5f88\u5bb9\u6613\u3002 \u60a8\u53ea\u9700\u8981\u4e0b\u8f09\u6a94\u6848\uff0c\u5c07\u5b83\u5011\u4e0a\u50b3\u5230 Web \u4f3a\u670d\u5668\u4e26\u89f8\u767c\u5b89\u88dd\u5373\u53ef\u3002 \u5982\u679c\u4f60\u9084\u6c92\u6709 Web \u4f3a\u670d\u5668\uff0c\u4e0d\u7528\u64d4\u5fc3\uff0c\u4f60\u53ef\u4ee5\u5728\u672c\u5730\u7aef\u96fb\u8166\u4e0a\u8a2d\u7f6e\u4e00\u500b\u3002 \u4e0b\u8f09 XF 2.0 \u00b6 \u8981\u4e0b\u8f09 XF 2.0\uff0c\u53ea\u9700\u8a2a\u554f \u5ba2\u6236\u5340 \u4e26\u6b63\u5e38\u767b\u9304\u5373\u53ef\u3002 \u627e\u5230\u6b63\u78ba\u7684\u8a31\u53ef\u8b49\uff0c\u7136\u5f8c\u55ae\u64ca \"\u4e0b\u8f09 XenForo\" \u9023\u7d50\u3002 \u9078\u64c7\u60a8\u8981\u4e0b\u8f09\u7684\u7248\u672c\uff0c\u5957\u4ef6\u985e\u578b\u4e26\u63a5\u53d7\u8a31\u53ef\u5354\u8b70\u3002 \u6700\u5f8c\uff0c\u55ae\u64ca\u4e0b\u8f09\u6309\u9215\u4ee5\u4e0b\u8f09\u6a94\u6848\u3002 XF 2.0 \u74b0\u5883\u8981\u6c42 \u00b6 \u5f9e XF 1.5 \u958b\u59cb\uff0c\u904b\u884c XF 2.0 \u7684\u74b0\u5883\u8981\u6c42\u5df2\u66f4\u6539\u3002\u5efa\u8b70\u7684\u74b0\u5883\u8981\u6c42\u5982\u4e0b\uff1a PHP: 5.4.0+ \u4ee5\u4e0a MySQL: 5.5+ \u4ee5\u4e0a PHP \u64f4\u5145\u5957\u4ef6: MySQLi\uff0cGD (\u652f\u6301 JPEG)\uff0cPCRE\uff0cSPL\uff0cSimpleXML\uff0cDOM\uff0cJSON\uff0ciconv\uff0cctype\uff0ccURL \u4e0b\u8f09\u74b0\u5883\u8981\u6c42\u6e2c\u8a66\u8173\u672c\u3002 \u8a2d\u7f6e\u672c\u5730\u4f3a\u670d\u5668 \u00b6 \u8a2d\u7f6e\u7528\u65bc\u958b\u767c\u7684\u672c\u5730 Web \u4f3a\u670d\u5668\u901a\u5e38\u66f4\u65b9\u4fbf\u3002 \u901a\u5e38\u6709\u5169\u7a2e\u65b9\u6cd5\u53ef\u4ee5\u89e3\u6c7a\u6b64\u554f\u984c\uff1a \u81ea\u5df1\u5b89\u88dd Apache\uff08\u6216 nginx \uff09\uff0cMySQL\uff08\u6216 MariaDB \uff09\u548c PHP\u3002 \u5b89\u88dd\u9810\u69cb\u5efa\u7684\u865b\u64ec\u6a5f \u5b89\u88dd\u9810\u69cb\u5efa\u7684 Stack\u3002 \u81ea\u5df1\u9032\u884c\u8a2d\u7f6e\u6bd4\u8f03\u8907\u96dc\uff0c\u4f46\u5f80\u5f80\u53ef\u4ee5\u8b93\u60a8\u66f4\u597d\u5730\u63a7\u5236\u6240\u6709\u8a2d\u7f6e\u3002 \u9810\u5148\u69cb\u5efa\u7684\u865b\u64ec\u6a5f \u00b6 \u7db2\u8def\u4e0a\u6709\u591a\u7a2e\u9810\u69cb\u5efa\u7684\u865b\u64ec\u6a5f\uff0c\u9019\u4e9b\u865b\u64ec\u6a5f\u7684\u512a\u52e2\u5728\u65bc\uff0c\u5c07\u6240\u9700\u7684\u6240\u6709\u670d\u52d9\u4ee5\u6574\u9f4a\u7684\u65b9\u5f0f\u6253\u5305\u5230\u4e00\u500b\u5730\u65b9\u5373\u53ef\u904b\u884c XenForo\uff0c\u800c\u4e0d\u5fc5\u76f4\u63a5\u5728\u81ea\u5df1\u7684\u8a08\u7b97\u6a5f\u4e0a\u5b89\u88dd\u548c\u7dad\u8b77\u5b83\u5011\u3002 \u4e00\u4e9b XenForo \u958b\u767c\u4eba\u54e1\u4f7f\u7528\u540d\u70ba Scotch Box \u7684\u865b\u64ec\u6a5f\uff0c\u5b83\u5305\u542b\u4e86\u904b\u884c XenForo \u6240\u9700\u7684\u4e00\u5207\uff0c\u7121\u9700\u4efb\u4f55\u914d\u7f6e\u3002 \u6211\u5011\u6709\u9010\u6b65\u5b89\u88dd\u548c\u904b\u884c XenForo \u958b\u767c\u4f3a\u670d\u5668\u7684 \u9010\u6b65\u6307\u5357 - \u60a8\u53ef\u4ee5\u901a\u904e\u904b\u884c\u4e00\u4e9b\u6307\u4ee4\uff0c\u5728\u77ed\u77ed\u5e7e\u5206\u9418\u5167\u5c31\u4f7f\u865b\u64ec\u7db2\u8def\u548c\u8cc7\u6599\u5eab\u4f3a\u670d\u5668\u6b63\u5e38\u904b\u884c\u3002 \u5b89\u88dd\u7528\u65bc XenForo \u7684 Scotch Box \u865b\u64ec\u6a5f \u9810\u69cb\u5efa Stack \u00b6 \u90a3\u88e1\u6709\u8a31\u591a\u9810\u69cb\u5efa Stack\uff0c\u5b83\u5011\u5728\u529f\u80fd\u96c6\uff0c\u6548\u80fd\u548c\u53ef\u9760\u6027\u65b9\u9762\u53ef\u80fd\u6703\u6709\u6240\u4e0d\u540c\u3002Bitnami \u7dad\u8b77\u8a31\u591a Stack\uff0c\u5305\u62ec\u5206\u5225\u7528\u65bc Linux\uff0cMac \u548c Windows \u7684 LAMP , MAMP \u548c WAMP Stacks\u3002 \u5b83\u5011\u90fd\u5305\u62ec\u5c0d Apache\uff0cMySQL \u548c PHP \u7684\u5b8c\u5168\u914d\u7f6e\u5b89\u88dd\uff0c\u4e26\u5305\u62ec\u7528\u65bc\u7ba1\u7406 MySQL \u7684 PhPMyAdmin\u3002 \u4e0a\u50b3 \u00b6 \u8981\u5b89\u88dd XF 2.0\uff0c\u60a8\u53ea\u9700\u8981\u63d0\u53d6\u5f9e\u5ba2\u6236\u5340\u4e0b\u8f09\u7684 ZIP \u6a94\u6848\u4e26\u4e0a\u50b3\u5176\u4e2d\u7684\u4e00\u4e9b\u6a94\u6848\u548c\u76ee\u9304\u3002 \u89e3\u58d3\u7e2e\u5f8c\uff0c\u60a8\u6703\u770b\u5230\u4e00\u500b\u540d\u70ba upload \u7684\u76ee\u9304\u3002 \u60a8\u9700\u8981\u9032\u5165\u8a72\u76ee\u9304\uff0c\u7136\u5f8c\u5c07\u6a94\u6848\u548c\u76ee\u9304\u4e0a\u8f09\u5230\u4f60\u4f3a\u670d\u5668\u7684 Web \u6839\u76ee\u9304\u3002 \u9019\u901a\u5e38\u6703\u5728\u4e00\u500b\u540d\u70ba public_html , htdocs \u6216 www \u7684\u76ee\u9304\u3002 \u5275\u5efa src/config.php \u00b6 \u5982\u679c\u4f7f\u7528 CLI \u5b89\u88dd XF 2.0\uff0c\u5247\u9700\u8981\u624b\u52d5\u5275\u5efa config.php \u6a94\u6848\u3002 \u8981\u505a\u5230\u9019\u4e00\u9ede\uff0c\u8acb\u5728\u60a8\u4e0a\u8f09\u5230\u4f3a\u670d\u5668\u7684 XF 2.0 \u6a94\u6848\u4e2d\u8f38\u5165 src \u76ee\u9304\u3002 \u5275\u5efa\u4e00\u500b\u540d\u70ba config.php \u7684\u65b0\u6a94\u6848\uff0c\u4e26\u586b\u5165\u4f60\u7684 MySQL \u4f3a\u670d\u5668\u7684\u4e3b\u6a5f\uff0c\u57e0\u865f\uff0c\u7528\u6236\u540d\uff0c\u5bc6\u78bc\u548c\u8cc7\u6599\u5eab\u540d\u7a31\u3002 Note \u78ba\u4fdd\u5728 src \u76ee\u9304\u4e2d\u5275\u5efa\u914d\u7f6e\u6a94\u6848\u3002 \u8a72 library \u76ee\u9304\u50c5\u7528\u65bc\u820a\u7248\u76ee\u7684\u3002 \u5b8c\u6210\u5f8c\uff0c\u5b83\u61c9\u5982\u4e0b\u6240\u793a\uff1a <?php $config['db']['host'] = 'localhost'; $config['db']['port'] = '3306'; $config['db']['username'] = 'root'; $config['db']['password'] = 'mypassword'; $config['db']['dbname'] = 'xf2'; \u60a8\u73fe\u5728\u53ef\u4ee5\u5b89\u88dd\u4e86\uff01 \u5982\u679c\u60a8\u4f7f\u7528\u7684\u662f MySQL 5.5 \u53ca\u4ee5\u4e0a\u7248\u672c\uff0c\u4e26\u4e14\u5e0c\u671b\u7372\u5f97\u5b8c\u6574\u7684 unicode \u652f\u6301\uff08\u4f8b\u5982 emoji \u8868\u60c5\uff09\uff0c\u5247\u9084\u61c9\u8a72\u5728\u5b89\u88dd\u524d\u6dfb\u52a0\u4ee5\u4e0b\u5167\u5bb9\uff1a $config['fullUnicode'] = true; \u95dc\u65bc\u6a94\u6848\u6b0a\u9650\u8aaa\u660e \u00b6 XenForo \u5728\u904b\u884c\u6642\u9700\u8981\u5c07\u6a94\u6848\u5beb\u5165\u7279\u5b9a\u4f4d\u7f6e\u3002 \u5728\u6b63\u5e38\u64cd\u4f5c\u4e2d\uff0c\u9019\u50c5\u9650\u65bc data \u548c internal_data \u76ee\u9304\uff08\u53ca\u5176\u5b50\u76ee\u9304\uff09\u3002 \u9019\u4e9b\u6a94\u6848\u5beb\u5165\u5c07\u7531\u9644\u4ef6\u4e0a\u50b3\u4e4b\u985e\u7684\u6771\u897f\u89f8\u767c\uff0c\u56e0\u6b64\u5b83\u5011\u901a\u5e38\u5c07\u7531\u7528\u6236 PHP \u50cf\u5728 Web \u4f3a\u670d\u5668\u4e2d\u4e00\u6a23\u904b\u884c\u4f86\u89f8\u767c\u3002 \u56e0\u6b64\uff0c\u5fc5\u9808\u78ba\u4fdd\u5728\u9019\u4e9b\u76ee\u9304\u4e2d\u8a2d\u7f6e\u4e86\u6b0a\u9650\uff0c\u4ee5\u4fbf Web \u4f3a\u52d9\u5668\u53ef\u4ee5\u5c0d\u5176\u9032\u884c\u5beb\u5165\u3002 \u60a8\u5fc5\u9808\u5148\u57f7\u884c\u6b64\u64cd\u4f5c\uff0c\u7136\u5f8c\u624d\u80fd\u958b\u59cb\u5b89\u88dd\u3002 \u7576\u6d89\u53ca\u5230 CLI \u6642\uff0c\u9019\u7a2e\u60c5\u6cc1\u8b8a\u5f97\u66f4\u52a0\u68d8\u624b\uff0c\u56e0\u70ba\u73fe\u5728\u53ef\u80fd\u6709\u5169\u500b\u7528\u6236\u9700\u8981\u80fd\u5920\u5beb\u5165\u6a94\u6848\u3002 \u56e0\u6b64\uff0c\u63a1\u53d6\u63aa\u65bd\u907f\u514d\u5beb\u5165\u9019\u4e9b\u6a94\u6848\u7684\u554f\u984c\u5f88\u91cd\u8981\u3002 \u9019\u88e1\u6709\u5e7e\u500b\u9078\u64c7\u3002 \u5728 CLI \u548c Web \u4f3a\u670d\u5668\u4f7f\u7528\u76f8\u540c\u7684\u7528\u6236\u3002 \u9019\u53ef\u4ee5\u63a1\u53d6\u4ee5\u4e0b\u5f62\u5f0f\uff1a\u5728\u904b\u884c\u4efb\u4f55\u5b89\u88dd\u6216\u5347\u7d1a\u6307\u4ee4\uff08\u6216\u4efb\u4f55\u5176\u4ed6\u5c07\u5beb\u5165\u6a94\u6848\u7684\u6307\u4ee4\uff09\u4e4b\u524d\u5207\u63db\u5230 Web \u4f3a\u670d\u5668\u7528\u6236\u3002 \u5982\u679c\u53ef\u7528\uff0c\u8acb\u8003\u616e\u5c07 ACL \u61c9\u7528\u65bc data \u548c internal_data \u76ee\u9304\u4e2d\u3002 \u8a72\u6982\u5ff5\u56e0\u64cd\u4f5c\u7cfb\u7d71\u548c\u914d\u7f6e\u800c\u7570\uff0c\u4f46 \u6b64\u8655 \u63cf\u8ff0\u7684\u662f\u7e3d\u9ad4\u601d\u8def\u3002 \u5c0d PHP \u5beb\u5165\u7684\u5167\u5bb9\u5f37\u5236\u6388\u4e88\u7279\u5b9a\u7684\u6b0a\u9650\u3002 \u9019\u53ef\u4ee5\u901a\u904e src / config.php \u6a94\u6848\u4e2d\u5e36\u6709\u5982\u4e0b\u4e00\u884c\u7684\u7a0b\u5f0f\u78bc\u4f86\u5b8c\u6210\uff1a $config['chmodWritableValue'] = 0666; \u9019\u7a2e\u65b9\u6cd5\u5c0d\u65bc\u958b\u767c\u76ee\u7684\u4f86\u8aaa\u53ef\u80fd\u662f\u6700\u7c21\u55ae\u7684\u3002 \u8acb\u6ce8\u610f\uff0c\u5982\u679c\u60a8\u6b63\u5728\u958b\u767c\u9644\u52a0\u5143\u4ef6\uff0c\u5247\u53ef\u80fd\u6703\u6709\u5176\u4ed6\u9700\u8981\u7531 CLI \u548c Web \u4f3a\u670d\u5668\u7528\u6236\u5beb\u5165\u7684\u4f4d\u7f6e\u3002 \u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0c\u9019\u5305\u62ec\u9644\u52a0\u5143\u4ef6\u4e2d\u7684 _output \u76ee\u9304\u3002 \u5728\u9019\u7a2e\u60c5\u6cc1\u4e0b\uff0c\u4ee5\u60a8\u7684 CLI \u7528\u6236\u8eab\u4efd\u904b\u884c Web \u4f3a\u670d\u5668\u53ef\u80fd\u6703\u6e1b\u5c11\u6469\u64e6\u3002 \u5982\u679c\u60a8\u63a1\u7528\u5176\u4ed6\u4efb\u4f55\u65b9\u6cd5\uff0c\u5247\u53ef\u80fd\u9700\u8981\u78ba\u4fdd\u60a8\u7684 Web \u4f3a\u670d\u5668\u53ef\u4ee5\u5beb\u5165\u6574\u500b XenForo \u5b89\u88dd\uff1b\u5728\u751f\u7522\u4e2d\u4e0d\u5efa\u8b70\u9019\u6a23\u505a\u3002 \u5b89\u88dd \u00b6 \u7576\u524d\u5b89\u88dd XF 2.0 \u7684\u65b9\u5f0f\u662f\u901a\u904e\u65b0\u7684 CLI \u7cfb\u7d71\u3002 \u8a31\u591a\u958b\u767c\u904e\u7a0b\u53ea\u80fd\u4f7f\u7528 CLI \u4f86\u9032\u884c\uff0c\u6240\u4ee5\u6211\u5011\u5c31\u4f86\u4f7f\u7528\u5b83\u4f86\u5b89\u88dd XF 2.0\u3002 \u8981\u904b\u884c\u9019\u4e9b\u6307\u4ee4\uff0c\u60a8\u5c07\u9700\u8981\u8a2a\u554f \u7d42\u7aef/shell\uff0c\u4f7f\u7528 php CLI \u6307\u4ee4\u548c\u7576\u524d\u5de5\u4f5c\u76ee\u9304\u61c9\u8a72\u662f\u60a8\u4e0a\u50b3 XF 2.0 \u6a94\u6848\u7684\u6839\u76ee\u9304\u3002 Warning \u70ba\u6d88\u9664\u6a94\u6848\u6b0a\u9650\u554f\u984c\uff0c\u6211\u5011\u5efa\u8b70\u4ee5\u8207 PHP \u5728 web \u4f3a\u670d\u5668\u4e0a\u57f7\u884c\u7684\u76f8\u540c\u4f7f\u7528\u8005\u4f86\u57f7\u884c\u5b89\u88dd\u7a0b\u5f0f\u3002 \u5982\u679c\u4e0d\u9019\u6a23\u505a\uff0c\u5247\u61c9\u8a72\u63a1\u53d6\u63aa\u65bd\u78ba\u4fdd\u6b0a\u9650\u8a2d\u5b9a\u6b63\u78ba\u3002 \u6709\u95dc\u66f4\u591a\u8a73\u7d30\u4fe1\u606f\uff0c\u8acb\u53c3\u898b\u4e0a\u9762\u7684\u7ae0\u7bc0\u3002 \u8981\u958b\u59cb\u5b89\u88dd\uff0c\u53ea\u9700\u8f38\u5165\u4ee5\u4e0b\u6307\u4ee4\uff1a Terminal $ php cmd.php xf:install \u60a8\u6703\u88ab\u554f\u5230\u8a31\u591a\u554f\u984c\uff0c\u4f8b\u5982\u521d\u59cb\u7ba1\u7406\u54e1\u7528\u6236\u540d\u548c\u5bc6\u78bc\uff0c\u677f\u584a\u6a19\u984c\u3002 \u6b64\u5f8c\uff0c\u5c07\u532f\u5165 XF 2.0 \u8cc7\u6599\u5eab\u8868\u548c\u4e3b\u8981\u7684\u8cc7\u6599\u3002 XF 2.0 \u73fe\u5728\u5df2\u5b89\u88dd\u5b8c\u6210\uff01 \u91cd\u65b0\u5b89\u88dd \u00b6 \u6709\u6642\u53ef\u80fd\u9700\u8981\u91cd\u65b0\u5b89\u88dd XF2\u3002 \u5728\u4e0d\u652f\u6301\u5347\u7d1a\u7684 \"\u958b\u767c\u9810\u89bd\" \u968e\u6bb5\u5c24\u5176\u5982\u6b64\u3002 \u5982\u679c\u6e96\u5099\u597d\u91cd\u65b0\u5b89\u88dd\uff0c\u8acb\u6309\u7167\u4e0a\u9762\u7684 \u4e0b\u8f09 XF 2.0 \u90e8\u5206\u4e0b\u8f09\u65b0\u6a94\u6848\uff08\u5982\u679c\u9069\u7528\uff09\u3002 \u4e00\u822c\u4f86\u8aaa\uff0c\u61c9\u8a72\u53ef\u4ee5\u5408\u4f75\u548c\u8986\u84cb\u73fe\u6709\u6a94\u6848\u3002 \u5982\u679c\u8981\u9032\u884c\u5b8c\u5168\u4e7e\u6de8\u7684\u91cd\u65b0\u5b89\u88dd\uff0c\u5247\u53ef\u80fd\u9700\u8981\u4fdd\u5b58 config.php \u6a94\u6848\u7684\u526f\u672c\uff0c\u6216\u8005\u6309\u7167 \u5275\u5efa src/config.php \u4e2d\u7684\u8aaa\u660e\u91cd\u65b0\u5275\u5efa\u5b83\u3002 \u5728\u4e0a\u50b3\u65b0\u6a94\u6848\u4e4b\u524d\uff0c\u60a8\u61c9\u8a72\u522a\u9664 data \u548c internal_data \u76ee\u9304\u7684\u5167\u5bb9\u3002 \u6700\u5f8c\uff0c\u60a8\u53ea\u9700\u8981\u958b\u59cb\u5b89\u88dd\u5373\u53ef\uff0c\u8207\u4e0a\u9762\u985e\u4f3c\u3002 \u60a8\u5c07\u9700\u8981\u4f7f\u7528\u6b64 --clear \u9078\u9805\u4f86\u522a\u9664\u6240\u6709\u73fe\u6709\u7684 xf_ \u8cc7\u6599\u8868\u3002 Terminal $ php cmd.php xf:install --clear \u91cd\u65b0\u5b89\u88dd\u5b8c\u6210\u5f8c\uff0c\u60a8\u73fe\u5728\u61c9\u8a72\u53ef\u4ee5\u91cd\u65b0\u767b\u9304\u4e86\u3002 \u5982\u679c\u60a8\u6b63\u5728\u958b\u767c\u9644\u52a0\u5143\u4ef6\uff0c\u4e26\u4e14\u9078\u64c7\u4fdd\u7559\u6216\u5099\u4efd\u73fe\u6709 src/addons \u76ee\u9304\uff0c\u5247\u53ef\u4ee5\u4f7f\u7528 \u532f\u5165\u958b\u767c\u8f38\u51fa \u6307\u4ee4\u4f86\u9084\u539f\u9644\u52a0\u5143\u4ef6\u8cc7\u6599\u3002 Warning \u5982\u679c\u9078\u64c7\u5099\u4efd\u548c\u9084\u539f src/addons \u76ee\u9304\uff0c\u8acb\u5c0f\u5fc3\u3002 \u5176\u4e2d\u7684 XF \u76ee\u9304\u5305\u542b XF \u4e3b\u8981\u7684\u8cc7\u6599\uff0c\u56e0\u6b64\u4e0d\u61c9\u5f9e\u5099\u4efd\u4e2d\u9084\u539f\uff0c\u4ee5\u78ba\u4fdd\u60a8\u59cb\u7d42\u64c1\u6709\u6700\u65b0\u7248\u672c\u7684\u6a94\u6848\u3002 \u4ee5\u9019\u7a2e\u65b9\u5f0f\u57f7\u884c\u91cd\u65b0\u5b89\u88dd\u662f\u7834\u58de\u6027\u7684\u64cd\u4f5c\uff0c\u5b83\u5c07\u522a\u9664\u60a8\u5275\u5efa\u7684\u6240\u6709\u8cc7\u6599\u3002 \u6b64\u5916\uff0c\u8acb\u8a18\u4f4f\uff0c\u50c5\u5e36\u6709 xf_ \u524d\u7db4\u7684\u8cc7\u6599\u8868\u624d\u6703\u88ab\u6e05\u9664\u3002 \u9019\u4e5f\u662f\u5efa\u8b70\u6240\u6709\u8cc7\u6599\u8868\uff08\u751a\u81f3\u662f\u9644\u52a0\u5143\u4ef6\uff09\u90fd\u61c9\u8a72\u4ee5 xf_ \u70ba\u524d\u7db4\u7684\u4e00\u500b\u91cd\u8981\u539f\u56e0\u3002 \u9a57\u8b49\u6a94\u6848\u5b8c\u6574\u6027 \u00b6 \u7576\u60a8\u5b89\u88dd XF2 \u6642\uff0c\u6211\u5011\u6703\u5728\u5b89\u88dd\u904e\u7a0b\u4e2d\u57f7\u884c\u6a94\u6848\u5b8c\u6574\u6027\u6aa2\u67e5\u3002 \u5982\u6709\u5fc5\u8981\uff0c\u4e26\u4e14\u60a8\u7121\u6cd5\u901a\u904e Admin CP \u4e2d\u7684\u9801\u9762\u57f7\u884c\u6aa2\u67e5\uff0c\u5247\u53ef\u4ee5\u904b\u884c CLI \u6307\u4ee4\u4f86\u57f7\u884c\u8a72\u6aa2\u67e5\u3002 Terminal $ php cmd.php xf:file-check [addon_id] \u5982\u679c\u60a8\u5e0c\u671b\u5c0d\u6240\u6709\u6a94\u6848\uff08\u5305\u62ec XF \u672c\u8eab\uff09\u9032\u884c\u6a94\u6848\u904b\u884c\u5065\u5eb7\u6aa2\u67e5\uff0c\u53ea\u9700\u7701\u7565 [addon_id] \u53c3\u6578\u5373\u53ef\u3002 \u50c5\u5c0d\u65bc XF\uff0c\u50c5\u4f7f\u7528 XF \u4ee3\u66ff\u8a72\u53c3\u6578\uff0c\u6216\u8005\u5c0d\u65bc\u7279\u5b9a\u7684\u9644\u52a0\u5143\u4ef6\uff0c\u53ea\u9700\u6307\u5b9a\u60a8\u8981\u6aa2\u67e5\u7684\u9644\u52a0\u5143\u4ef6 ID\u3002 Add-on \u7ba1\u7406\u6307\u4ee4 \u00b6 \u9664\u4e86\u4e0a\u8ff0\u7528\u65bc\u5b89\u88dd XF2 \u7684\u6307\u4ee4\u4e4b\u5916\uff0c\u9084\u6709\u4e00\u4e9b\u7528\u65bc\u7ba1\u7406\u9644\u52a0\u5143\u4ef6\u7684\u6307\u4ee4\u3002 \u5b89\u88dd \u00b6 Terminal $ php cmd.php xf:addon-install [addon_id] \u5b89\u88dd\u6307\u5b9a\u7684\u9644\u52a0\u5143\u4ef6\uff0c\u53ea\u8981\u5b83\u662f\u53ef\u7528\u7684\uff0c\u4e26\u901a\u904e\u6a94\u6848\u904b\u884c\u5065\u5eb7\u6aa2\u67e5\u3002 \u5982\u679c\u6709\u53ef\u7528\u7684\u958b\u767c\u8f38\u51fa\uff0c\u60a8\u5c07\u88ab\u8981\u6c42\u78ba\u8a8d\u662f\u5426\u8981\u5c07\u5176\u7528\u65bc\u5b89\u88dd\uff0c\u800c\u4e0d\u662f\u532f\u51fa\u7684\u8cc7\u6599 XML \u6a94\u6848\u3002 \u5347\u7d1a \u00b6 Terminal $ php cmd.php xf:addon-upgrade [addon_id] \u53ea\u8981\u6307\u5b9a\u7684\u9644\u52a0\u5143\u4ef6\u662f\u53ef\u5347\u7d1a\u7684\uff0c\u5c31\u5c0d\u5176\u9032\u884c\u5347\u7d1a\uff0c\u4e26\u901a\u904e\u6a94\u6848\u904b\u884c\u5065\u5eb7\u6aa2\u67e5\u3002 \u53ef\u4ee5\u9078\u64c7\u5f9e\u958b\u767c\u8f38\u51fa\u4e2d\u9032\u884c\u532f\u5165\u3002 \u91cd\u5efa \u00b6 Terminal $ php cmd.php xf:addon-rebuild [addon_id] \u53ea\u8981\u6307\u5b9a\u7684\u9644\u52a0\u5143\u4ef6\u662f\u53ef\u91cd\u5efa\u7684\uff0c\u5c31\u70ba\u5176\u91cd\u5efa\u4e3b\u8981\u7684\u8cc7\u6599\uff0c\u4e26\u901a\u904e\u6a94\u6848\u904b\u884c\u5065\u5eb7\u6aa2\u67e5\u3002 \u9019\u5c07\u91cd\u65b0\u532f\u5165\u9644\u52a0\u5143\u4ef6\u7684\u8cc7\u6599\u3002 \u53ef\u4ee5\u9078\u64c7\u6027\u5730\u57f7\u884c\u5f9e\u958b\u767c\u8f38\u51fa\u4e2d\u532f\u5165\u3002 \u89e3\u9664\u5b89\u88dd \u00b6 Terminal $ php cmd.php xf:addon-uninstall [addon_id] \u89e3\u9664\u5b89\u88dd\u6307\u5b9a\u7684\u9644\u52a0\u5143\u4ef6\uff0c\u53ea\u8981\u5b83\u662f\u4e0d\u53ef\u89e3\u9664\u5b89\u88dd\u7684\u3002","title":"\u5165\u9580\u9808\u77e5"},{"location":"#_1","text":"\u6b61\u8fce\u4f7f\u7528 XenForo 2\uff01 \u672c\u6587\u6a94\u65e8\u5728\u5e6b\u52a9\u60a8\u958b\u59cb XenForo 2.0 \u958b\u767c\u3002 \u672c\u6587\u6a94\u7684\u524d\u63d0\u689d\u4ef6\u5047\u8a2d\u60a8\u5df2\u719f\u6089 PHP \u548c MySQL\u3002 \u4e26\u975e\u4e00\u5b9a\u8981\u64c1\u6709 XenForo \u4ee5\u524d\u7248\u672c\u7684\u7d93\u9a57\uff0c\u4f46\u9019\u5c07\u662f\u4e00\u500b\u512a\u52e2\u3002 \u5728\u63a5\u4e0b\u4f86\u7684\u9801\u9762\u4e2d\uff0c\u6211\u5011\u5c07\u5411\u60a8\u7c21\u8981\u4ecb\u7d39\u5982\u4f55\u8a2d\u7f6e\u672c\u5730\u4f3a\u670d\u5668\uff0c\u6e96\u5099\u5b89\u88dd\uff0c\u5168\u65b0\u5b89\u88dd XenForo 2.0 \u4ee5\u53ca\u904b\u884c XF2 \u958b\u767c\u7684\u4e00\u4e9b\u6982\u5ff5\u3002","title":"\u5165\u9580\u9808\u77e5"},{"location":"#_2","text":"\u5118\u7ba1 XenForo 2.0 \u70ba\u60a8\u7684\u8ad6\u58c7\u53ca\u5176\u6210\u54e1\u589e\u52a0\u4e86\u8a31\u591a\u6539\u9032\uff0c\u4f46\u6211\u5011\u4ecd\u6295\u5165\u4e86\u5927\u91cf\u7cbe\u529b\u4f86\u6539\u9032 XenForo \u7684\u5e95\u5c64\u6846\u67b6\u3002 \u60a8\u53ef\u4ee5\u5728\u4ee5\u4e0b\u5e16\u5b50\u4e2d\u95b1\u8b80\u66f4\u591a\u95dc\u65bc\u9019\u4e9b\u66f4\u6539\u7684\u66f4\u591a\u4fe1\u606f\uff1a XenForo 2 \u4e2d\u7684\u958b\u767c\u4eba\u54e1\u65b0\u529f\u80fd\uff08\u7b2c1\u90e8\u5206\uff09 XenForo 2 \u958b\u767c\u4eba\u54e1\u7684\u65b0\u589e\u529f\u80fd\uff08\u7b2c2\u90e8\u5206\uff09","title":"\u958b\u767c\u4eba\u54e1\u6709\u4ec0\u9ebc\u65b0\u529f\u80fd\uff1f"},{"location":"#_3","text":"XF \u958b\u767c\u5165\u9580\u5f88\u5bb9\u6613\u3002 \u60a8\u53ea\u9700\u8981\u4e0b\u8f09\u6a94\u6848\uff0c\u5c07\u5b83\u5011\u4e0a\u50b3\u5230 Web \u4f3a\u670d\u5668\u4e26\u89f8\u767c\u5b89\u88dd\u5373\u53ef\u3002 \u5982\u679c\u4f60\u9084\u6c92\u6709 Web \u4f3a\u670d\u5668\uff0c\u4e0d\u7528\u64d4\u5fc3\uff0c\u4f60\u53ef\u4ee5\u5728\u672c\u5730\u7aef\u96fb\u8166\u4e0a\u8a2d\u7f6e\u4e00\u500b\u3002","title":"\u5165\u9580\u9808\u77e5"},{"location":"#xf-20","text":"\u8981\u4e0b\u8f09 XF 2.0\uff0c\u53ea\u9700\u8a2a\u554f \u5ba2\u6236\u5340 \u4e26\u6b63\u5e38\u767b\u9304\u5373\u53ef\u3002 \u627e\u5230\u6b63\u78ba\u7684\u8a31\u53ef\u8b49\uff0c\u7136\u5f8c\u55ae\u64ca \"\u4e0b\u8f09 XenForo\" \u9023\u7d50\u3002 \u9078\u64c7\u60a8\u8981\u4e0b\u8f09\u7684\u7248\u672c\uff0c\u5957\u4ef6\u985e\u578b\u4e26\u63a5\u53d7\u8a31\u53ef\u5354\u8b70\u3002 \u6700\u5f8c\uff0c\u55ae\u64ca\u4e0b\u8f09\u6309\u9215\u4ee5\u4e0b\u8f09\u6a94\u6848\u3002","title":"\u4e0b\u8f09 XF 2.0"},{"location":"#xf-20_1","text":"\u5f9e XF 1.5 \u958b\u59cb\uff0c\u904b\u884c XF 2.0 \u7684\u74b0\u5883\u8981\u6c42\u5df2\u66f4\u6539\u3002\u5efa\u8b70\u7684\u74b0\u5883\u8981\u6c42\u5982\u4e0b\uff1a PHP: 5.4.0+ \u4ee5\u4e0a MySQL: 5.5+ \u4ee5\u4e0a PHP \u64f4\u5145\u5957\u4ef6: MySQLi\uff0cGD (\u652f\u6301 JPEG)\uff0cPCRE\uff0cSPL\uff0cSimpleXML\uff0cDOM\uff0cJSON\uff0ciconv\uff0cctype\uff0ccURL \u4e0b\u8f09\u74b0\u5883\u8981\u6c42\u6e2c\u8a66\u8173\u672c\u3002","title":"XF 2.0 \u74b0\u5883\u8981\u6c42"},{"location":"#_4","text":"\u8a2d\u7f6e\u7528\u65bc\u958b\u767c\u7684\u672c\u5730 Web \u4f3a\u670d\u5668\u901a\u5e38\u66f4\u65b9\u4fbf\u3002 \u901a\u5e38\u6709\u5169\u7a2e\u65b9\u6cd5\u53ef\u4ee5\u89e3\u6c7a\u6b64\u554f\u984c\uff1a \u81ea\u5df1\u5b89\u88dd Apache\uff08\u6216 nginx \uff09\uff0cMySQL\uff08\u6216 MariaDB \uff09\u548c PHP\u3002 \u5b89\u88dd\u9810\u69cb\u5efa\u7684\u865b\u64ec\u6a5f \u5b89\u88dd\u9810\u69cb\u5efa\u7684 Stack\u3002 \u81ea\u5df1\u9032\u884c\u8a2d\u7f6e\u6bd4\u8f03\u8907\u96dc\uff0c\u4f46\u5f80\u5f80\u53ef\u4ee5\u8b93\u60a8\u66f4\u597d\u5730\u63a7\u5236\u6240\u6709\u8a2d\u7f6e\u3002","title":"\u8a2d\u7f6e\u672c\u5730\u4f3a\u670d\u5668"},{"location":"#_5","text":"\u7db2\u8def\u4e0a\u6709\u591a\u7a2e\u9810\u69cb\u5efa\u7684\u865b\u64ec\u6a5f\uff0c\u9019\u4e9b\u865b\u64ec\u6a5f\u7684\u512a\u52e2\u5728\u65bc\uff0c\u5c07\u6240\u9700\u7684\u6240\u6709\u670d\u52d9\u4ee5\u6574\u9f4a\u7684\u65b9\u5f0f\u6253\u5305\u5230\u4e00\u500b\u5730\u65b9\u5373\u53ef\u904b\u884c XenForo\uff0c\u800c\u4e0d\u5fc5\u76f4\u63a5\u5728\u81ea\u5df1\u7684\u8a08\u7b97\u6a5f\u4e0a\u5b89\u88dd\u548c\u7dad\u8b77\u5b83\u5011\u3002 \u4e00\u4e9b XenForo \u958b\u767c\u4eba\u54e1\u4f7f\u7528\u540d\u70ba Scotch Box \u7684\u865b\u64ec\u6a5f\uff0c\u5b83\u5305\u542b\u4e86\u904b\u884c XenForo \u6240\u9700\u7684\u4e00\u5207\uff0c\u7121\u9700\u4efb\u4f55\u914d\u7f6e\u3002 \u6211\u5011\u6709\u9010\u6b65\u5b89\u88dd\u548c\u904b\u884c XenForo \u958b\u767c\u4f3a\u670d\u5668\u7684 \u9010\u6b65\u6307\u5357 - \u60a8\u53ef\u4ee5\u901a\u904e\u904b\u884c\u4e00\u4e9b\u6307\u4ee4\uff0c\u5728\u77ed\u77ed\u5e7e\u5206\u9418\u5167\u5c31\u4f7f\u865b\u64ec\u7db2\u8def\u548c\u8cc7\u6599\u5eab\u4f3a\u670d\u5668\u6b63\u5e38\u904b\u884c\u3002 \u5b89\u88dd\u7528\u65bc XenForo \u7684 Scotch Box \u865b\u64ec\u6a5f","title":"\u9810\u5148\u69cb\u5efa\u7684\u865b\u64ec\u6a5f"},{"location":"#stack","text":"\u90a3\u88e1\u6709\u8a31\u591a\u9810\u69cb\u5efa Stack\uff0c\u5b83\u5011\u5728\u529f\u80fd\u96c6\uff0c\u6548\u80fd\u548c\u53ef\u9760\u6027\u65b9\u9762\u53ef\u80fd\u6703\u6709\u6240\u4e0d\u540c\u3002Bitnami \u7dad\u8b77\u8a31\u591a Stack\uff0c\u5305\u62ec\u5206\u5225\u7528\u65bc Linux\uff0cMac \u548c Windows \u7684 LAMP , MAMP \u548c WAMP Stacks\u3002 \u5b83\u5011\u90fd\u5305\u62ec\u5c0d Apache\uff0cMySQL \u548c PHP \u7684\u5b8c\u5168\u914d\u7f6e\u5b89\u88dd\uff0c\u4e26\u5305\u62ec\u7528\u65bc\u7ba1\u7406 MySQL \u7684 PhPMyAdmin\u3002","title":"\u9810\u69cb\u5efa Stack"},{"location":"#_6","text":"\u8981\u5b89\u88dd XF 2.0\uff0c\u60a8\u53ea\u9700\u8981\u63d0\u53d6\u5f9e\u5ba2\u6236\u5340\u4e0b\u8f09\u7684 ZIP \u6a94\u6848\u4e26\u4e0a\u50b3\u5176\u4e2d\u7684\u4e00\u4e9b\u6a94\u6848\u548c\u76ee\u9304\u3002 \u89e3\u58d3\u7e2e\u5f8c\uff0c\u60a8\u6703\u770b\u5230\u4e00\u500b\u540d\u70ba upload \u7684\u76ee\u9304\u3002 \u60a8\u9700\u8981\u9032\u5165\u8a72\u76ee\u9304\uff0c\u7136\u5f8c\u5c07\u6a94\u6848\u548c\u76ee\u9304\u4e0a\u8f09\u5230\u4f60\u4f3a\u670d\u5668\u7684 Web \u6839\u76ee\u9304\u3002 \u9019\u901a\u5e38\u6703\u5728\u4e00\u500b\u540d\u70ba public_html , htdocs \u6216 www \u7684\u76ee\u9304\u3002","title":"\u4e0a\u50b3"},{"location":"#srcconfigphp","text":"\u5982\u679c\u4f7f\u7528 CLI \u5b89\u88dd XF 2.0\uff0c\u5247\u9700\u8981\u624b\u52d5\u5275\u5efa config.php \u6a94\u6848\u3002 \u8981\u505a\u5230\u9019\u4e00\u9ede\uff0c\u8acb\u5728\u60a8\u4e0a\u8f09\u5230\u4f3a\u670d\u5668\u7684 XF 2.0 \u6a94\u6848\u4e2d\u8f38\u5165 src \u76ee\u9304\u3002 \u5275\u5efa\u4e00\u500b\u540d\u70ba config.php \u7684\u65b0\u6a94\u6848\uff0c\u4e26\u586b\u5165\u4f60\u7684 MySQL \u4f3a\u670d\u5668\u7684\u4e3b\u6a5f\uff0c\u57e0\u865f\uff0c\u7528\u6236\u540d\uff0c\u5bc6\u78bc\u548c\u8cc7\u6599\u5eab\u540d\u7a31\u3002 Note \u78ba\u4fdd\u5728 src \u76ee\u9304\u4e2d\u5275\u5efa\u914d\u7f6e\u6a94\u6848\u3002 \u8a72 library \u76ee\u9304\u50c5\u7528\u65bc\u820a\u7248\u76ee\u7684\u3002 \u5b8c\u6210\u5f8c\uff0c\u5b83\u61c9\u5982\u4e0b\u6240\u793a\uff1a <?php $config['db']['host'] = 'localhost'; $config['db']['port'] = '3306'; $config['db']['username'] = 'root'; $config['db']['password'] = 'mypassword'; $config['db']['dbname'] = 'xf2'; \u60a8\u73fe\u5728\u53ef\u4ee5\u5b89\u88dd\u4e86\uff01 \u5982\u679c\u60a8\u4f7f\u7528\u7684\u662f MySQL 5.5 \u53ca\u4ee5\u4e0a\u7248\u672c\uff0c\u4e26\u4e14\u5e0c\u671b\u7372\u5f97\u5b8c\u6574\u7684 unicode \u652f\u6301\uff08\u4f8b\u5982 emoji \u8868\u60c5\uff09\uff0c\u5247\u9084\u61c9\u8a72\u5728\u5b89\u88dd\u524d\u6dfb\u52a0\u4ee5\u4e0b\u5167\u5bb9\uff1a $config['fullUnicode'] = true;","title":"\u5275\u5efa src/config.php"},{"location":"#_7","text":"XenForo \u5728\u904b\u884c\u6642\u9700\u8981\u5c07\u6a94\u6848\u5beb\u5165\u7279\u5b9a\u4f4d\u7f6e\u3002 \u5728\u6b63\u5e38\u64cd\u4f5c\u4e2d\uff0c\u9019\u50c5\u9650\u65bc data \u548c internal_data \u76ee\u9304\uff08\u53ca\u5176\u5b50\u76ee\u9304\uff09\u3002 \u9019\u4e9b\u6a94\u6848\u5beb\u5165\u5c07\u7531\u9644\u4ef6\u4e0a\u50b3\u4e4b\u985e\u7684\u6771\u897f\u89f8\u767c\uff0c\u56e0\u6b64\u5b83\u5011\u901a\u5e38\u5c07\u7531\u7528\u6236 PHP \u50cf\u5728 Web \u4f3a\u670d\u5668\u4e2d\u4e00\u6a23\u904b\u884c\u4f86\u89f8\u767c\u3002 \u56e0\u6b64\uff0c\u5fc5\u9808\u78ba\u4fdd\u5728\u9019\u4e9b\u76ee\u9304\u4e2d\u8a2d\u7f6e\u4e86\u6b0a\u9650\uff0c\u4ee5\u4fbf Web \u4f3a\u52d9\u5668\u53ef\u4ee5\u5c0d\u5176\u9032\u884c\u5beb\u5165\u3002 \u60a8\u5fc5\u9808\u5148\u57f7\u884c\u6b64\u64cd\u4f5c\uff0c\u7136\u5f8c\u624d\u80fd\u958b\u59cb\u5b89\u88dd\u3002 \u7576\u6d89\u53ca\u5230 CLI \u6642\uff0c\u9019\u7a2e\u60c5\u6cc1\u8b8a\u5f97\u66f4\u52a0\u68d8\u624b\uff0c\u56e0\u70ba\u73fe\u5728\u53ef\u80fd\u6709\u5169\u500b\u7528\u6236\u9700\u8981\u80fd\u5920\u5beb\u5165\u6a94\u6848\u3002 \u56e0\u6b64\uff0c\u63a1\u53d6\u63aa\u65bd\u907f\u514d\u5beb\u5165\u9019\u4e9b\u6a94\u6848\u7684\u554f\u984c\u5f88\u91cd\u8981\u3002 \u9019\u88e1\u6709\u5e7e\u500b\u9078\u64c7\u3002 \u5728 CLI \u548c Web \u4f3a\u670d\u5668\u4f7f\u7528\u76f8\u540c\u7684\u7528\u6236\u3002 \u9019\u53ef\u4ee5\u63a1\u53d6\u4ee5\u4e0b\u5f62\u5f0f\uff1a\u5728\u904b\u884c\u4efb\u4f55\u5b89\u88dd\u6216\u5347\u7d1a\u6307\u4ee4\uff08\u6216\u4efb\u4f55\u5176\u4ed6\u5c07\u5beb\u5165\u6a94\u6848\u7684\u6307\u4ee4\uff09\u4e4b\u524d\u5207\u63db\u5230 Web \u4f3a\u670d\u5668\u7528\u6236\u3002 \u5982\u679c\u53ef\u7528\uff0c\u8acb\u8003\u616e\u5c07 ACL \u61c9\u7528\u65bc data \u548c internal_data \u76ee\u9304\u4e2d\u3002 \u8a72\u6982\u5ff5\u56e0\u64cd\u4f5c\u7cfb\u7d71\u548c\u914d\u7f6e\u800c\u7570\uff0c\u4f46 \u6b64\u8655 \u63cf\u8ff0\u7684\u662f\u7e3d\u9ad4\u601d\u8def\u3002 \u5c0d PHP \u5beb\u5165\u7684\u5167\u5bb9\u5f37\u5236\u6388\u4e88\u7279\u5b9a\u7684\u6b0a\u9650\u3002 \u9019\u53ef\u4ee5\u901a\u904e src / config.php \u6a94\u6848\u4e2d\u5e36\u6709\u5982\u4e0b\u4e00\u884c\u7684\u7a0b\u5f0f\u78bc\u4f86\u5b8c\u6210\uff1a $config['chmodWritableValue'] = 0666; \u9019\u7a2e\u65b9\u6cd5\u5c0d\u65bc\u958b\u767c\u76ee\u7684\u4f86\u8aaa\u53ef\u80fd\u662f\u6700\u7c21\u55ae\u7684\u3002 \u8acb\u6ce8\u610f\uff0c\u5982\u679c\u60a8\u6b63\u5728\u958b\u767c\u9644\u52a0\u5143\u4ef6\uff0c\u5247\u53ef\u80fd\u6703\u6709\u5176\u4ed6\u9700\u8981\u7531 CLI \u548c Web \u4f3a\u670d\u5668\u7528\u6236\u5beb\u5165\u7684\u4f4d\u7f6e\u3002 \u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0c\u9019\u5305\u62ec\u9644\u52a0\u5143\u4ef6\u4e2d\u7684 _output \u76ee\u9304\u3002 \u5728\u9019\u7a2e\u60c5\u6cc1\u4e0b\uff0c\u4ee5\u60a8\u7684 CLI \u7528\u6236\u8eab\u4efd\u904b\u884c Web \u4f3a\u670d\u5668\u53ef\u80fd\u6703\u6e1b\u5c11\u6469\u64e6\u3002 \u5982\u679c\u60a8\u63a1\u7528\u5176\u4ed6\u4efb\u4f55\u65b9\u6cd5\uff0c\u5247\u53ef\u80fd\u9700\u8981\u78ba\u4fdd\u60a8\u7684 Web \u4f3a\u670d\u5668\u53ef\u4ee5\u5beb\u5165\u6574\u500b XenForo \u5b89\u88dd\uff1b\u5728\u751f\u7522\u4e2d\u4e0d\u5efa\u8b70\u9019\u6a23\u505a\u3002","title":"\u95dc\u65bc\u6a94\u6848\u6b0a\u9650\u8aaa\u660e"},{"location":"#_8","text":"\u7576\u524d\u5b89\u88dd XF 2.0 \u7684\u65b9\u5f0f\u662f\u901a\u904e\u65b0\u7684 CLI \u7cfb\u7d71\u3002 \u8a31\u591a\u958b\u767c\u904e\u7a0b\u53ea\u80fd\u4f7f\u7528 CLI \u4f86\u9032\u884c\uff0c\u6240\u4ee5\u6211\u5011\u5c31\u4f86\u4f7f\u7528\u5b83\u4f86\u5b89\u88dd XF 2.0\u3002 \u8981\u904b\u884c\u9019\u4e9b\u6307\u4ee4\uff0c\u60a8\u5c07\u9700\u8981\u8a2a\u554f \u7d42\u7aef/shell\uff0c\u4f7f\u7528 php CLI \u6307\u4ee4\u548c\u7576\u524d\u5de5\u4f5c\u76ee\u9304\u61c9\u8a72\u662f\u60a8\u4e0a\u50b3 XF 2.0 \u6a94\u6848\u7684\u6839\u76ee\u9304\u3002 Warning \u70ba\u6d88\u9664\u6a94\u6848\u6b0a\u9650\u554f\u984c\uff0c\u6211\u5011\u5efa\u8b70\u4ee5\u8207 PHP \u5728 web \u4f3a\u670d\u5668\u4e0a\u57f7\u884c\u7684\u76f8\u540c\u4f7f\u7528\u8005\u4f86\u57f7\u884c\u5b89\u88dd\u7a0b\u5f0f\u3002 \u5982\u679c\u4e0d\u9019\u6a23\u505a\uff0c\u5247\u61c9\u8a72\u63a1\u53d6\u63aa\u65bd\u78ba\u4fdd\u6b0a\u9650\u8a2d\u5b9a\u6b63\u78ba\u3002 \u6709\u95dc\u66f4\u591a\u8a73\u7d30\u4fe1\u606f\uff0c\u8acb\u53c3\u898b\u4e0a\u9762\u7684\u7ae0\u7bc0\u3002 \u8981\u958b\u59cb\u5b89\u88dd\uff0c\u53ea\u9700\u8f38\u5165\u4ee5\u4e0b\u6307\u4ee4\uff1a Terminal $ php cmd.php xf:install \u60a8\u6703\u88ab\u554f\u5230\u8a31\u591a\u554f\u984c\uff0c\u4f8b\u5982\u521d\u59cb\u7ba1\u7406\u54e1\u7528\u6236\u540d\u548c\u5bc6\u78bc\uff0c\u677f\u584a\u6a19\u984c\u3002 \u6b64\u5f8c\uff0c\u5c07\u532f\u5165 XF 2.0 \u8cc7\u6599\u5eab\u8868\u548c\u4e3b\u8981\u7684\u8cc7\u6599\u3002 XF 2.0 \u73fe\u5728\u5df2\u5b89\u88dd\u5b8c\u6210\uff01","title":"\u5b89\u88dd"},{"location":"#_9","text":"\u6709\u6642\u53ef\u80fd\u9700\u8981\u91cd\u65b0\u5b89\u88dd XF2\u3002 \u5728\u4e0d\u652f\u6301\u5347\u7d1a\u7684 \"\u958b\u767c\u9810\u89bd\" \u968e\u6bb5\u5c24\u5176\u5982\u6b64\u3002 \u5982\u679c\u6e96\u5099\u597d\u91cd\u65b0\u5b89\u88dd\uff0c\u8acb\u6309\u7167\u4e0a\u9762\u7684 \u4e0b\u8f09 XF 2.0 \u90e8\u5206\u4e0b\u8f09\u65b0\u6a94\u6848\uff08\u5982\u679c\u9069\u7528\uff09\u3002 \u4e00\u822c\u4f86\u8aaa\uff0c\u61c9\u8a72\u53ef\u4ee5\u5408\u4f75\u548c\u8986\u84cb\u73fe\u6709\u6a94\u6848\u3002 \u5982\u679c\u8981\u9032\u884c\u5b8c\u5168\u4e7e\u6de8\u7684\u91cd\u65b0\u5b89\u88dd\uff0c\u5247\u53ef\u80fd\u9700\u8981\u4fdd\u5b58 config.php \u6a94\u6848\u7684\u526f\u672c\uff0c\u6216\u8005\u6309\u7167 \u5275\u5efa src/config.php \u4e2d\u7684\u8aaa\u660e\u91cd\u65b0\u5275\u5efa\u5b83\u3002 \u5728\u4e0a\u50b3\u65b0\u6a94\u6848\u4e4b\u524d\uff0c\u60a8\u61c9\u8a72\u522a\u9664 data \u548c internal_data \u76ee\u9304\u7684\u5167\u5bb9\u3002 \u6700\u5f8c\uff0c\u60a8\u53ea\u9700\u8981\u958b\u59cb\u5b89\u88dd\u5373\u53ef\uff0c\u8207\u4e0a\u9762\u985e\u4f3c\u3002 \u60a8\u5c07\u9700\u8981\u4f7f\u7528\u6b64 --clear \u9078\u9805\u4f86\u522a\u9664\u6240\u6709\u73fe\u6709\u7684 xf_ \u8cc7\u6599\u8868\u3002 Terminal $ php cmd.php xf:install --clear \u91cd\u65b0\u5b89\u88dd\u5b8c\u6210\u5f8c\uff0c\u60a8\u73fe\u5728\u61c9\u8a72\u53ef\u4ee5\u91cd\u65b0\u767b\u9304\u4e86\u3002 \u5982\u679c\u60a8\u6b63\u5728\u958b\u767c\u9644\u52a0\u5143\u4ef6\uff0c\u4e26\u4e14\u9078\u64c7\u4fdd\u7559\u6216\u5099\u4efd\u73fe\u6709 src/addons \u76ee\u9304\uff0c\u5247\u53ef\u4ee5\u4f7f\u7528 \u532f\u5165\u958b\u767c\u8f38\u51fa \u6307\u4ee4\u4f86\u9084\u539f\u9644\u52a0\u5143\u4ef6\u8cc7\u6599\u3002 Warning \u5982\u679c\u9078\u64c7\u5099\u4efd\u548c\u9084\u539f src/addons \u76ee\u9304\uff0c\u8acb\u5c0f\u5fc3\u3002 \u5176\u4e2d\u7684 XF \u76ee\u9304\u5305\u542b XF \u4e3b\u8981\u7684\u8cc7\u6599\uff0c\u56e0\u6b64\u4e0d\u61c9\u5f9e\u5099\u4efd\u4e2d\u9084\u539f\uff0c\u4ee5\u78ba\u4fdd\u60a8\u59cb\u7d42\u64c1\u6709\u6700\u65b0\u7248\u672c\u7684\u6a94\u6848\u3002 \u4ee5\u9019\u7a2e\u65b9\u5f0f\u57f7\u884c\u91cd\u65b0\u5b89\u88dd\u662f\u7834\u58de\u6027\u7684\u64cd\u4f5c\uff0c\u5b83\u5c07\u522a\u9664\u60a8\u5275\u5efa\u7684\u6240\u6709\u8cc7\u6599\u3002 \u6b64\u5916\uff0c\u8acb\u8a18\u4f4f\uff0c\u50c5\u5e36\u6709 xf_ \u524d\u7db4\u7684\u8cc7\u6599\u8868\u624d\u6703\u88ab\u6e05\u9664\u3002 \u9019\u4e5f\u662f\u5efa\u8b70\u6240\u6709\u8cc7\u6599\u8868\uff08\u751a\u81f3\u662f\u9644\u52a0\u5143\u4ef6\uff09\u90fd\u61c9\u8a72\u4ee5 xf_ \u70ba\u524d\u7db4\u7684\u4e00\u500b\u91cd\u8981\u539f\u56e0\u3002","title":"\u91cd\u65b0\u5b89\u88dd"},{"location":"#_10","text":"\u7576\u60a8\u5b89\u88dd XF2 \u6642\uff0c\u6211\u5011\u6703\u5728\u5b89\u88dd\u904e\u7a0b\u4e2d\u57f7\u884c\u6a94\u6848\u5b8c\u6574\u6027\u6aa2\u67e5\u3002 \u5982\u6709\u5fc5\u8981\uff0c\u4e26\u4e14\u60a8\u7121\u6cd5\u901a\u904e Admin CP \u4e2d\u7684\u9801\u9762\u57f7\u884c\u6aa2\u67e5\uff0c\u5247\u53ef\u4ee5\u904b\u884c CLI \u6307\u4ee4\u4f86\u57f7\u884c\u8a72\u6aa2\u67e5\u3002 Terminal $ php cmd.php xf:file-check [addon_id] \u5982\u679c\u60a8\u5e0c\u671b\u5c0d\u6240\u6709\u6a94\u6848\uff08\u5305\u62ec XF \u672c\u8eab\uff09\u9032\u884c\u6a94\u6848\u904b\u884c\u5065\u5eb7\u6aa2\u67e5\uff0c\u53ea\u9700\u7701\u7565 [addon_id] \u53c3\u6578\u5373\u53ef\u3002 \u50c5\u5c0d\u65bc XF\uff0c\u50c5\u4f7f\u7528 XF \u4ee3\u66ff\u8a72\u53c3\u6578\uff0c\u6216\u8005\u5c0d\u65bc\u7279\u5b9a\u7684\u9644\u52a0\u5143\u4ef6\uff0c\u53ea\u9700\u6307\u5b9a\u60a8\u8981\u6aa2\u67e5\u7684\u9644\u52a0\u5143\u4ef6 ID\u3002","title":"\u9a57\u8b49\u6a94\u6848\u5b8c\u6574\u6027"},{"location":"#add-on","text":"\u9664\u4e86\u4e0a\u8ff0\u7528\u65bc\u5b89\u88dd XF2 \u7684\u6307\u4ee4\u4e4b\u5916\uff0c\u9084\u6709\u4e00\u4e9b\u7528\u65bc\u7ba1\u7406\u9644\u52a0\u5143\u4ef6\u7684\u6307\u4ee4\u3002","title":"Add-on \u7ba1\u7406\u6307\u4ee4"},{"location":"#_11","text":"Terminal $ php cmd.php xf:addon-install [addon_id] \u5b89\u88dd\u6307\u5b9a\u7684\u9644\u52a0\u5143\u4ef6\uff0c\u53ea\u8981\u5b83\u662f\u53ef\u7528\u7684\uff0c\u4e26\u901a\u904e\u6a94\u6848\u904b\u884c\u5065\u5eb7\u6aa2\u67e5\u3002 \u5982\u679c\u6709\u53ef\u7528\u7684\u958b\u767c\u8f38\u51fa\uff0c\u60a8\u5c07\u88ab\u8981\u6c42\u78ba\u8a8d\u662f\u5426\u8981\u5c07\u5176\u7528\u65bc\u5b89\u88dd\uff0c\u800c\u4e0d\u662f\u532f\u51fa\u7684\u8cc7\u6599 XML \u6a94\u6848\u3002","title":"\u5b89\u88dd"},{"location":"#_12","text":"Terminal $ php cmd.php xf:addon-upgrade [addon_id] \u53ea\u8981\u6307\u5b9a\u7684\u9644\u52a0\u5143\u4ef6\u662f\u53ef\u5347\u7d1a\u7684\uff0c\u5c31\u5c0d\u5176\u9032\u884c\u5347\u7d1a\uff0c\u4e26\u901a\u904e\u6a94\u6848\u904b\u884c\u5065\u5eb7\u6aa2\u67e5\u3002 \u53ef\u4ee5\u9078\u64c7\u5f9e\u958b\u767c\u8f38\u51fa\u4e2d\u9032\u884c\u532f\u5165\u3002","title":"\u5347\u7d1a"},{"location":"#_13","text":"Terminal $ php cmd.php xf:addon-rebuild [addon_id] \u53ea\u8981\u6307\u5b9a\u7684\u9644\u52a0\u5143\u4ef6\u662f\u53ef\u91cd\u5efa\u7684\uff0c\u5c31\u70ba\u5176\u91cd\u5efa\u4e3b\u8981\u7684\u8cc7\u6599\uff0c\u4e26\u901a\u904e\u6a94\u6848\u904b\u884c\u5065\u5eb7\u6aa2\u67e5\u3002 \u9019\u5c07\u91cd\u65b0\u532f\u5165\u9644\u52a0\u5143\u4ef6\u7684\u8cc7\u6599\u3002 \u53ef\u4ee5\u9078\u64c7\u6027\u5730\u57f7\u884c\u5f9e\u958b\u767c\u8f38\u51fa\u4e2d\u532f\u5165\u3002","title":"\u91cd\u5efa"},{"location":"#_14","text":"Terminal $ php cmd.php xf:addon-uninstall [addon_id] \u89e3\u9664\u5b89\u88dd\u6307\u5b9a\u7684\u9644\u52a0\u5143\u4ef6\uff0c\u53ea\u8981\u5b83\u662f\u4e0d\u53ef\u89e3\u9664\u5b89\u88dd\u7684\u3002","title":"\u89e3\u9664\u5b89\u88dd"},{"location":"add-on-structure/","text":"\u9644\u52a0\u5143\u4ef6\u7d50\u69cb \u00b6 \u5728\u4ee5\u524d\u7684 XF \u7248\u672c\u4e2d\uff0c\u5f88\u5c11\u6709\u95dc\u65bc\u9644\u52a0\u5143\u4ef6\u958b\u767c\u7684\u6a19\u6e96\u548c\u7d04\u5b9a\u3002 \u5728 XF 2.0 \u7684\u529f\u80fd\u4e2d\uff0c\u6211\u5011\u5df2\u7d93\u505a\u4e86\u5f88\u591a\u4fee\u6539\u3002 \u8b93\u6211\u5011\u4f86\u770b\u770b\u5176\u4e2d\u7684\u4e00\u4e9b\u8b8a\u5316\uff1a \u9644\u52a0\u5143\u4ef6 ID \u548c\u9644\u52a0\u5143\u4ef6\u8def\u5f91 \u00b6 \u6bcf\u500b\u5b89\u88dd\u7684\u9644\u52a0\u5143\u4ef6\u90fd\u5fc5\u9808\u6709\u4e00\u500b\u552f\u4e00\u7684 ID\uff0c\u9019\u500b ID \u6c7a\u5b9a\u4e86\u9644\u52a0\u5143\u4ef6\u61c9\u8a72\u5728\u6a94\u6848\u7cfb\u7d71\u4e2d\u7684\u54ea\u500b\u4f4d\u7f6e\u5132\u5b58\u5176\u6a94\u6848\u3002\u9644\u52a0\u5143\u4ef6\u7684 ID \u6709\u5169\u7a2e\u53ef\u80fd\u7684\u683c\u5f0f\u3002 \u7b2c\u4e00\u500b \"\u7c21\u55ae\" \u985e\u578b\u61c9\u8a72\u662f\u4e00\u500b\u55ae\u5b57\uff0c\u4e0d\u5305\u542b\u4efb\u4f55\u7279\u6b8a\u5b57\u5143\u3002\u4f8b\u5982\uff0c Demo \u3002 \u7c21\u55ae\u7684\u9644\u52a0\u5143\u4ef6 ID \u5fc5\u9808\u9075\u5b88\u4ee5\u4e0b\u898f\u5247\uff1a \u5fc5\u9808\u53ea\u5305\u542b a-z \u6216 A-Z\u3002 \u53ef\u4ee5\u5305\u542b 0-9\uff0c\u4f46\u4e0d\u80fd\u653e\u5728 ID \u958b\u982d\u3002 \u4e0d\u80fd\u5305\u542b\u4efb\u4f55\u7279\u6b8a\u5b57\u5143\uff0c\u4f8b\u5982\u659c\u7dda\u3001\u7834\u6298\u865f\u6216\u4e0b\u5283\u7dda\u3002 \u7b2c\u4e8c\u500b\u5305\u542b\u4e00\u500b\u4f9b\u61c9\u5546\u524d\u7db4\uff0c\u6240\u4ee5\u5982\u679c\u4f60\u5728\u4e00\u500b\u7279\u5b9a\u7684\u54c1\u724c\u6216\u516c\u53f8\u4e0b\u767c\u5e03\u9644\u52a0\u5143\u4ef6\uff0c\u9644\u52a0\u5143\u4ef6 ID \u53ef\u4ee5\u8868\u660e\u9019\u4e00\u9ede\u3002\u4f8b\u5982\uff0c SomeVendor/Demo \u3002 \u4f9b\u61c9\u5546\u985e\u578b\u7684\u9644\u52a0 ID \u61c9\u9075\u5b88\u4ee5\u4e0b\u898f\u5247\uff1a \u5fc5\u9808\u53ea\u5305\u542b a-z \u6216 A-Z \u53ef\u5305\u542b\u4e00\u500b / \u5b57\u5143\uff0c\u4f46\u4e0d\u80fd\u5728\u958b\u982d\u6216\u7d50\u5c3e\u8655 \u53ef\u4ee5\u5305\u542b 0-9\uff0c\u4f46\u4e0d\u5728\u9644\u52a0\u5143\u4ef6 ID \u7684\u4efb\u4f55\u4e00\u500b\u90e8\u5206\u7684\u958b\u982d \u4e00\u65e6\u60a8\u6c7a\u5b9a\u4e86\u9644\u52a0\u5143\u4ef6\u7684 ID\uff0c\u6211\u5011\u5c31\u77e5\u9053\u9019\u500b\u9644\u52a0\u5143\u4ef6\u7684\u6a94\u6848\u5c07\u5132\u5b58\u5728\u54ea\u88e1\u3002 \u6240\u6709 XF 2.0 \u9644\u52a0\u5143\u4ef6\u90fd\u5132\u5b58\u5728 src/addons \u76ee\u9304\u7684\u5b50\u76ee\u9304\u4e2d\u3002 \u5982\u679c\u4f60\u6709\u4e00\u500b\u7c21\u55ae\u7684\u9644\u52a0\u5143\u4ef6 ID\uff0c\u4f8b\u5982 Demo \uff0c\u4f60\u7684\u9644\u52a0\u5143\u4ef6\u6a94\u6848\u5c07\u5132\u5b58\u5728\u4ee5\u4e0b\u4f4d\u7f6e\uff1a src/addons/Demo \u3002 \u5982\u679c\u4f60\u6709\u4e00\u500b\u57fa\u65bc\u5ee0\u5546\u7684\u9644\u52a0\u5143\u4ef6 ID\uff0c\u4f8b\u5982 SomeVendor/Demo \uff0c\u6a94\u6848\u5c07\u5132\u5b58\u5728\u4ee5\u4e0b\u4f4d\u7f6e\uff1a src/addons/SomeVendor/Demo \u3002 \u60a8\u9078\u64c7\u7684\u9644\u52a0\u5143\u4ef6 ID \u4e5f\u5c07\u6210\u70ba\u60a8\u7684\u985e\u5225\u547d\u540d\u7a7a\u9593\u524d\u7db4\uff08\u66f4\u591a\u8cc7\u8a0a\u8acb\u53c3\u898b \u547d\u540d\u7a7a\u9593 \uff09\u3002 \u5efa\u8b70\u7248\u672c\u5b57\u4e32\u683c\u5f0f \u00b6 XF \u672c\u8eab\u4f7f\u7528 MAJOR.MINOR.PATCH \u539f\u5247\uff08\u4f8b\u5982 2.0.0 \u4ee3\u8868\u7b2c\u4e00\u500b\u7a69\u5b9a\u7684 XF2 \u7248\u672c\uff09\u4f86\u9032\u884c\u7248\u672c\u7de8\u865f\uff0c\u6211\u5011\u5efa\u8b70\u5c0d\u60a8\u81ea\u5df1\u7684\u9644\u52a0\u5143\u4ef6\u7684\u7248\u672c\u7de8\u865f\u63a1\u53d6\u985e\u4f3c\u7684\u65b9\u6cd5\u3002 \u57fa\u672c\u4e0a\uff0c\u5728\u7248\u672c\u865f\u4e2d\u589e\u52a0 MAJOR \u7248\u672c\uff0c\u7576\u4f60\u505a\u4e86\u91cd\u5927\u7684\u529f\u80fd\u6539\u8b8a\uff0c\u7279\u5225\u662f\u7834\u58de\u4e86\u5411\u5f8c\u76f8\u5bb9\u6027\u7684\u6539\u8b8a MINOR \u7248\u672c\uff0c\u7576\u4f60\u65b0\u589e\u529f\u80fd\u6642\uff0c\u6700\u597d\u662f\u4ee5\u5411\u5f8c\u76f8\u5bb9\u7684\u65b9\u5f0f\u65b0\u589e PATCH \u7248\u672c\uff0c\u7576\u4f60\u9032\u884c\u5411\u5f8c\u76f8\u5bb9\u7684 Bug \u4fee\u5fa9\u6642\u4f7f\u7528 \u5efa\u8b70\u7248\u672c ID \u683c\u5f0f \u00b6 \u9644\u52a0\u5143\u4ef6\u7684\u7248\u672c ID \u662f\u57fa\u672c\u7684\u6574\u6578\uff0c\u7528\u65bc\u5167\u90e8\u7248\u672c\u6bd4\u8f03\u3002 \u5b83\u8b93\u6211\u5011\u53ef\u4ee5\u66f4\u5bb9\u6613\u5730\u6aa2\u6e2c\u5230\u4e00\u500b\u7248\u672c\u6bd4\u53e6\u4e00\u500b\u7248\u672c\u820a\u3002 \u60a8\u7684\u9644\u52a0\u5143\u4ef6\u6bcf\u500b\u7248\u672c\u90fd\u61c9\u8a72\u5c07\u7248\u672c\u865f ID \u81f3\u5c11\u589e\u52a0 1\uff0c\u4f46\u6211\u5011\u5167\u90e8\u5c0d XF \u672c\u8eab\u4f7f\u7528\u7684\u6163\u4f8b\uff0c\u5c0d\u9644\u52a0\u5143\u4ef6\u4e5f\u6709\u6f5b\u5728\u7684\u4f5c\u7528\u3002 \u6211\u5011\u7684\u7248\u672c ID \u7684\u683c\u5f0f\u70ba aabbccde \u3002 aa \u4ee3\u8868 MAJOR \u7248\u672c bb \u4ee3\u8868 MINOR \u7248\u672c cc \u4ee3\u8868 PATCH \u7248\u672c d \u4ee3\u8868\u72c0\u614b\uff0c\u4f8b\u5982 1 \u4ee3\u8868 alpha \u7248\u672c\uff0c 3 \u4ee3\u8868 beta \u7248\u672c\uff0c 5 \u4ee3\u8868\u5019\u9078\u7248\u672c\uff0c 7 \u4ee3\u8868\u7a69\u5b9a\u7248\u672c e \u4ee3\u8868\u7248\u672c Level \u72c0\u614b \u4f8b\u5982\uff0c\u4e00\u500b\u7248\u672c\u865f\u662f 1.7.3 \u5019\u9078\u7248\u672c 4 \u5b83\u7684\u9644\u52a0\u5143\u4ef6 ID \u70ba \"1070354\"\u3002 \u6700\u7d42\u7a69\u5b9a\u7248 XF2 \u7684ID\u70ba 2000070 \u3002 XF \u7684 1.5.0 Beta 3 \u7248\u672c\u7684 ID \u70ba 1050033 \u3002 \u7a69\u5b9a\u7248 99.99.99 \u6703\u6709\u4e00\u500bID\u70ba 99999970 ... \u4e5f\u8a31\u4f60\u61c9\u8a72\u6162\u4e00\u9ede \ud83d\ude09\u3002 \u5e38\u898b\u7684\u9644\u52a0\u5143\u4ef6\u6a94\u6848\u548c\u76ee\u9304 \u00b6 \u5728\u9644\u52a0\u5143\u4ef6\u7684\u76ee\u9304\u4e2d\uff0c\u6709\u4e00\u4e9b\u6a94\u6848\u548c\u76ee\u9304\u6709\u7279\u6b8a\u7684\u7528\u9014\u548c\u610f\u7fa9\u3002 addon.json \u6a94\u6848 \u00b6 addon.json \u662f\u4e00\u500b\u5305\u542b\u4e00\u4e9b\u8cc7\u8a0a\u7684\u6a94\u6848\uff0c\u9019\u4e9b\u8cc7\u8a0a\u662f\u5e6b\u52a9 XF 2.0 \u8b58\u5225\u9644\u52a0\u5143\u4ef6\u4e26\u5728 Admin CP \u4e2d\u986f\u793a\u5176\u8cc7\u8a0a\u6240\u5fc5\u9700\u7684\u3002 \u6700\u8d77\u78bc\uff0c\u4f60\u7684 addon.json \u6a94\u6848\u61c9\u8a72\u770b\u8d77\u4f86\u50cf\u9019\u6a23\uff1a { \"title\": \"My Add-on by Some Company\", \"version_string\": \"2.0.0\", \"version_id\": 2000070, \"dev\": \"Some Company\" } \u5efa\u7acb\u9644\u52a0\u5143\u4ef6\u6642\uff0c\u6703\u81ea\u52d5\u70ba\u60a8\u5efa\u7acb\u4e00\u500b\u57fa\u672c\u6a94\u6848\u3002 \u5305\u542b\u4e00\u500b\u6709\u6548\u7684 addon.json \u6a94\u6848\u662f\u4f60\u7684\u9644\u52a0\u5143\u4ef6\u88ab\u8b58\u5225\u7684\u5fc5\u8981\u689d\u4ef6\uff0c\u4f60\u53ef\u4ee5\u96a8\u6642 \u9a57\u8b49\u4f60\u7684 addon.json \u6a94\u6848 \u3002 \u5c6c\u6027 \u00b6 Property Description legacy_addon_id \u7576\u5f9e XenForo 1 \u5347\u7d1a\u81f3 XenForo 2 \u6642\uff0c\u7528\u4f86\u958b\u555f\u81ea\u52d5\u8655\u7406\u9644\u52a0\u5143\u4ef6 ID \u66f4\u6539\u3002 title \u9644\u52a0\u5143\u4ef6\u7684\u6a19\u984c\u3002 \u9019\u5c07\u986f\u793a\u5728\u7ba1\u7406\u9762\u677f\u4e2d\u3002 description \u9644\u52a0\u5143\u4ef6\u7684\u63cf\u8ff0\u3002\u9019\u5c07\u986f\u793a\u5728\u7ba1\u7406\u9762\u677f\u4e2d\u3002 version_id XenForo \u7528\u4f86\u8ffd\u8e64\u9644\u52a0\u5143\u4ef6\u66f4\u65b0\u7684\u5167\u90e8 ID\u3002 \u6bcf\u6b21\u767c\u4f48\u6642\u5fc5\u9808\u905e\u589e\u3002 version_string \u4eba\u985e\u53ef\u4ee5\u8b80\u61c2\u7684\u9644\u52a0\u5143\u4ef6\u7248\u672c\u3002 \u9019\u5c07\u5728\u7ba1\u7406\u9762\u677f\u4e2d\u986f\u793a\uff0c\u800c\u4e0d\u662f version_id \u5c6c\u6027\u3002 dev \u9644\u52a0\u5143\u4ef6\u958b\u767c\u8005\u7684\u540d\u5b57\u3002\u9019\u5c07\u986f\u793a\u5728\u7ba1\u7406\u9762\u677f\u4e2d\u3002 dev_url \u5982\u679c\u8a2d\u5b9a\u4e86\uff0c\u958b\u767c\u8005\u7684\u540d\u5b57\u5c07\u4ee5\u8d85\u9023\u7d50\u7684\u5f62\u5f0f\u986f\u793a\u5728\u7ba1\u7406\u9762\u677f\u4e2d\uff0c\u4e26\u4ee5 (href) \u6b64\u70ba\u76ee\u6a19\u3002 faq_url \u5982\u679c\u8a2d\u5b9a\u4e86\uff0c\u4e00\u500b FAQ \u7684\u8d85\u9023\u7d50\u5c07\u986f\u793a\u5728\u7ba1\u7406\u9762\u677f\u4e2d\uff0c\u4e26\u4ee5 (href) \u6b64\u70ba\u76ee\u6a19\u3002 support_url \u5982\u679c\u8a2d\u5b9a\u4e86\uff0c\u652f\u63f4\u5e6b\u52a9\u7684\u8d85\u9023\u7d50\u5c07\u986f\u793a\u5728\u7ba1\u7406\u9762\u677f\u4e2d\uff0c\u4e26\u4ee5 (href) \u6b64\u70ba\u76ee\u6a19\u3002 extra_urls \u9019\u5141\u8a31\u60a8\u986f\u793a\u8207\u9644\u52a0\u5143\u4ef6\u76f8\u95dc\u7684\u5176\u4ed6\u5167\u5bb9\u9023\u7d50\uff08\u53ef\u80fd\u662f\u932f\u8aa4\u5831\u544a\u9023\u7d50\uff0c\u624b\u518a - \u96a8\u60a8\u559c\u6b61\uff09\u3002 \u4e00\u500b JSON \u7269\u4ef6\u7684\u9663\u5217\uff0c\u5176\u4e2d key \u662f\u9023\u7d50\u6587\u5b57\uff0cvalue \u662f\u9023\u7d50\u76ee\u6a19 (href)\u3002 require XenForo \u5141\u8a31\u5b89\u88dd\u9644\u52a0\u5143\u4ef6\u6642\u9700\u8981\u6eff\u8db3\u7684\u4e00\u7cfb\u5217\u8981\u6c42\u3002 \u66f4\u591a\u8cc7\u8a0a\u8acb\u53c3\u898b 'require \u5c6c\u6027' \u3002 icon \u8cc7\u6e90\u7684\u5716\u793a\u3002 \u9019\u53ef\u4ee5\u662f\u4e00\u500b Font Awesome \u5716\u793a\u540d\u7a31\uff08\u4f8b\u5982 fa-shopping-bag \uff0c\u6216\u4e00\u500b\u5716\u7247\u6a94\u6848\u7684\u8def\u5f91\uff09\u3002 require \u5c6c\u6027 \u00b6 \u5982\u679c\u74b0\u5883\u4e0d\u652f\u63f4\u6216\u4e0d\u6eff\u8db3\u8981\u6c42\uff0crequire \u5c6c\u6027\u662f\u963b\u6b62\u9644\u52a0\u5143\u4ef6\u5b89\u88dd\u6216\u5347\u7d1a\u7684\u6a19\u6e96\u65b9\u6cd5\u3002 \u4f60\u53ef\u4ee5\u7528\u5b83\u4f86\u8981\u6c42\u5148\u5b89\u88dd\u5176\u4ed6\u9644\u52a0\u5143\u4ef6\uff0c\u8981\u6c42\u67d0\u4e9b PHP \u64f4\u5c55\u5fc5\u9808\u5b58\u5728\u6216\u555f\u7528\uff0c\u548c/\u6216 \u5f37\u5236\u57f7\u884c\u4e00\u500b\u6700\u4f4e\u7684 PHP \u7248\u672c\u3002 \u9019\u662f\u4e00\u500b\u793a\u4f8b\u7247\u6bb5\uff1a ... \"require\": { \"XF\": [2000010, \"XenForo 2.0.0+\"], \"php\": [\"5.4.0\", \"PHP 5.4.0+\"], \"php-ext/json\": [\"*\", \"JSON extension\"] } ... \u6bcf\u500b require\uff0c\u90fd\u662f\u4e00\u500b\u547d\u540d\u9663\u5217\u3002 \u9663\u5217\u7684\u540d\u7a31\u662f\u7522\u54c1 ID (\u5982 XF \u6216 php )\u3002 \u7b2c\u4e00\u500b\u9663\u5217\u5143\u7d20\u662f\u7522\u54c1\u7684\u7248\u672c (\u5982 2000010 \u6216 5.4.0 )\u3002 \u4f60\u53ef\u4ee5\u4f7f\u7528 * \u4f86\u8868\u793a\u7522\u54c1\u7684\u4efb\u4f55\u7248\u672c\u3002 \u7b2c\u4e8c\u500b\u9663\u5217\u5143\u7d20\u662f\u8a72 require \u4eba\u985e\u53ef\u4ee5\u95b1\u8b80\u7684\u6587\u5b57\uff0c\u9019\u662f\u5728\u8a0a\u606f\u4e2d\u4f7f\u7528\u7684\u5167\u5bb9\uff08\u4f8b\u5982 XenForo 2.0.0+ \u6216 PHP 5.4.0+ \uff09\u3002 \u4e0b\u9762\u662f\u53d7\u652f\u63f4\u7684\u7522\u54c1 ID \u7684\u6982\u8ff0\uff1a \u7522\u54c1 / Require \u540d\u7a31 \u53c3\u8003... \u503c XF XenForo \u7684\u5b89\u88dd\u7248\u672c\u3002 XenForo \u7248\u672c ID\uff0c\u4f8b\u5982 200010 \u3002 \u4f60\u53ef\u4ee5\u901a\u904e\u6aa2\u67e5 /src/XF.php \u6a94\u6848\u9802\u90e8\u7684 $versionId \u5b9a\u7fa9\u6216\u8005\u5217\u5370 /XF::$versionId \u7684\u503c\u4f86\u7372\u53d6\u76ee\u524d XenForo \u7684\u7248\u672c\u3002 php PHP \u7248\u672c\u3002 PHP \u7248\u672c\uff0c\u4f8b\u5982 5.4.0 \u3002 \u5efa\u8b70\u4f60\u76e1\u53ef\u80fd\u964d\u4f4e\u9019\u500b\u503c\uff1b\u66f4\u65b0\u4e00\u500b PHP \u7248\u672c\u53ef\u80fd\u662f\u4e00\u500b\u76f8\u7576\u8907\u96dc\u7684\u5de5\u4f5c - \u7279\u5225\u662f\u7576\u5176\u4ed6\u9644\u52a0\u5143\u4ef6\u8207\u65b0\u7684 PHP \u7248\u672c\u885d\u7a81\u6642\u3002 php-ext / (extension name) \u4e00\u500b PHP \u64f4\u5c55 - \u5176\u4e2d (extension name) \u662f\u64f4\u5c55\u7684\u540d\u7a31\u3002 PHP \u64f4\u5c55\u7248\u672c\u3002 \u9019\u662f\u7528 PHP \u7684 version_compare \u51fd\u6578\u4f86\u6aa2\u67e5\u7684\uff0c\u6240\u4ee5\u5b83\u751a\u81f3\u9069\u7528\u65bc\u5b98\u65b9\u5b8c\u6574 PHP \u683c\u5f0f\u7684\u7248\u672c\u5b57\u4e32\uff0c\u6bd4\u5982 7.1.19-1+ubuntu16.04.1+deb.sury.org+1 \u3002 (any addon ID) \u4efb\u4f55 XenForo \u9644\u52a0\u5143\u4ef6\uff0c\u5982 Demo/Addon \u3002\u5982\u679c\u60a8\u4e0d\u78ba\u5b9a\u67d0\u500b\u9644\u52a0\u5143\u4ef6\u7684 ID\uff0c\u8acb\u67e5\u770b\u5b83\u7684 addon.json \u6a94\u6848\u3002 \u9644\u52a0\u5143\u4ef6\u7684\u7248\u672c ID\u3002 \u60a8\u53ef\u4ee5\u53c3\u8003 \u5efa\u8b70\u7248\u672c ID \u683c\u5f0f \u4e86\u89e3\u66f4\u591a\u8cc7\u8a0a\u3002 hashes.json \u6a94\u6848 \u00b6 hashes.json \u662f\u70ba\u6a94\u6848\u5065\u6aa2\u7cfb\u7d71\u65b0\u589e\u652f\u63f4\u7684\u65b0\u65b9\u6cd5\uff0c\u800c\u4e14\u6700\u597d\u7684\u90e8\u5206\u662f - \u5b83\u662f\u81ea\u52d5\u751f\u6210\u7684\uff01 \u4f5c\u70ba\u69cb\u5efa\u904e\u7a0b\u7684\u4e00\u90e8\u5206\uff08\u7a0d\u5f8c\u6703\u6709\u66f4\u591a\u8aaa\u660e\uff09\uff0c\u6211\u5011\u5c07\u5c0d\u60a8\u6240\u6709\u9644\u52a0\u5143\u4ef6\u7684\u6a94\u6848\u9032\u884c\u5feb\u901f\u6e05\u9ede\uff0c\u4e26\u5c07\u8a08\u7b97\u51fa\u7684\u6a94\u6848\u5167\u5bb9\u96dc\u6e4a\u78bc\u5beb\u5165\u5176\u4e2d\u3002 Setup.php \u6a94\u6848 \u00b6 Setup.php \u662f\u60a8\u5b89\u88dd\u3001\u5347\u7d1a\u6216\u89e3\u9664\u5b89\u88dd\u9644\u52a0\u5143\u4ef6\u6642\u9700\u8981\u57f7\u884c\u7684\u4efb\u4f55\u7a0b\u5f0f\u78bc\u7684\u65b0\u4e3b\u9801\u3002 \u4e0b\u9762 \u6211\u5011\u5c07\u8a73\u7d30\u4ecb\u7d39\u5982\u4f55\u5efa\u7acb\u4e00\u500b Setup \u985e\u3002 _data \u76ee\u9304 \u00b6 _data \u76ee\u9304\u662f\u5132\u5b58\u60a8\u7684\u9644\u52a0\u5143\u4ef6\u4e3b\u8981\u8cc7\u6599\u7684\u5730\u65b9\u3002 \u6bcf\u500b\u9644\u52a0\u5143\u4ef6\u7684\u8cc7\u6599\u985e\u578b\u90fd\u6703\u6709\u81ea\u5df1\u7684 XML \u6a94\u6848\uff08\u800c\u4e0d\u662f\u6240\u6709\u985e\u578b\u7684\u55ae\u500b\u6a94\u6848\uff09\u3002\u9019\u4e9b\u6a94\u6848\u7684\u96dc\u6e4a\u503c\u88ab\u5305\u542b\u5728 hashes.json \u4e2d\uff0c\u56e0\u6b64\u6211\u5011\u53ef\u4ee5\u5728\u5141\u8a31\u5b89\u88dd\u9644\u52a0\u5143\u4ef6\u4e4b\u524d\u78ba\u4fdd\u9644\u52a0\u5143\u4ef6\u64c1\u6709\u5b8c\u6574\u548c\u4e00\u81f4\u7684\u8cc7\u6599\u3002 _output \u76ee\u9304 \u00b6 _output \u76ee\u9304\u4e0d\u662f\u6210\u529f\u5b89\u88dd\u9644\u52a0\u5143\u4ef6\u6240\u5fc5\u9700\u7684\uff0c\u800c\u4e14\u5728\u767c\u4f48\u9644\u52a0\u5143\u4ef6\u6642\u4e5f\u4e0d\u61c9\u8a72\u5305\u62ec\u5728\u5167\u3002 \u9019\u500b\u76ee\u9304\u7d14\u7cb9\u662f\u70ba\u4e86\u958b\u767c\u76ee\u7684\uff0c\u53ea\u6709\u5728\u555f\u7528\u958b\u767c\u6a21\u5f0f\u6642\u624d\u6703\u4f7f\u7528\uff08\u53c3\u898b \u555f\u7528\u958b\u767c\u6a21\u5f0f \uff09\u3002 \u6bcf\u9805\u9644\u52a0\u5143\u4ef6\u8cc7\u6599\u90fd\u5132\u5b58\u5728\u4e00\u500b\u55ae\u7368\u7684\u6a94\u6848\u4e2d\u3002 \u5927\u591a\u6578\u60c5\u6cc1\u4e0b\uff0c\u5b83\u5011\u88ab\u5132\u5b58\u6210 JSON \u6a94\u6848\uff0c\u4f46\u5c0d\u65bc\u77ed\u8a9e\uff0c\u5b83\u5011\u88ab\u5132\u5b58\u70ba TXT \u6a94\u6848\uff0c\u5c0d\u65bc\u6a21\u677f\uff0c\u5b83\u5011\u88ab\u5132\u5b58\u70ba HTML/CSS/LESS \u6a94\u6848\u3002 \u6240\u6709\u7684\u6a21\u677f\u985e\u578b\u90fd\u53ef\u4ee5\u5728\u6a94\u6848\u7cfb\u7d71\u4e2d\u76f4\u63a5\u7de8\u8f2f\uff0c\u5c0d\u9019\u4e9b\u6a94\u6848\u7684\u4fee\u6539\u6703\u5728\u8f09\u5165\u6642\u81ea\u52d5\u5beb\u56de\u8cc7\u6599\u5eab\u3002 Setup \u985e \u00b6 \u8981\u70ba\u60a8\u7684\u9644\u52a0\u5143\u4ef6\u5efa\u7acb\u4e00\u500b Setup \u985e\uff0c\u60a8\u9700\u8981\u505a\u7684\u5c31\u662f\u5728\u60a8\u9644\u52a0\u5143\u4ef6\u76ee\u9304\u7684\u6839\u76ee\u9304\u4e0b\u5efa\u7acb\u4e00\u500b\u540d\u70ba Setup.php \u7684\u6a94\u6848\u3002 Setup \u985e\u61c9\u8a72\u7e7c\u627f /XF/AddOn/AbstractSetup \uff0c\u5b83\u81f3\u5c11\u9700\u8981\u5be6\u4f5c install() \u3001 upgrade() \u548c uninstall() \u65b9\u6cd5\u3002 \u4e0b\u9762\u662f\u4e00\u500b\u7c21\u55ae\u7684\u9644\u52a0\u5143\u4ef6 Setup \u985e\u7684\u6a23\u5b50\u3002 <?php namespace Demo; class Setup extends \\XF\\AddOn\\AbstractSetup { public function install(array $stepParams = []) { $this->schemaManager()->createTable('xf_demo', function(\\XF\\Db\\Schema\\Create $table) { $table->addColumn('demo_id', 'int'); }); } public function upgrade(array $stepParams = []) { if ($this->addOn->version_id < 1000170) { $this->schemaManager()->alterTable('xf_demo', function(\\XF\\Db\\Schema\\Alter $table) { $table->addColumn('foo', 'varchar', 10)->setDefault(''); }); } } public function uninstall(array $stepParams = []) { $this->schemaManager()->dropTable('xf_demo'); } } Setup \u985e\u4e5f\u652f\u63f4\u5728\u4e0d\u540c\u7684\u6b65\u9a5f\u4e2d\u57f7\u884c\u6bcf\u500b\u64cd\u4f5c\u3002 \u70ba\u4e86\u5be6\u73fe\u9019\u7a2e\u884c\u70ba\uff0c\u60a8\u7684 Setup \u985e\u53ef\u4ee5\u4f7f\u7528 StepRunnerInstallTrait \u3001 StepRunnerUpgradeTrait \u548c/\u6216 StepRunnerUninstallTrait \u7279\u6027 \u3002 \u9019\u4e9b\u90fd\u6703\u81ea\u52d5\u5be6\u4f5c\u6240\u9700\u7684\u65b9\u6cd5\uff0c\u4f60\u53ea\u9700\u8981\u65b0\u589e\u76f8\u95dc\u7684\u6b65\u9a5f\uff0c\u4f8b\u5982 installStep1() \u3001 upgrade1000170Step1() \u3001 upgrade1000170Step2() \u548c uninstallStep1() \uff0c\u5176\u4e2d\u5347\u7d1a\u65b9\u6cd5\u4e2d\u7684 1000170 \u7b49... \u662f\u9644\u52a0\u5143\u4ef6\u7684\u7248\u672c ID (\u53c3\u898b \u5efa\u8b70\u7248\u672c ID \u683c\u5f0f )\u3002","title":"\u9644\u52a0\u5143\u4ef6\u67b6\u69cb"},{"location":"add-on-structure/#_1","text":"\u5728\u4ee5\u524d\u7684 XF \u7248\u672c\u4e2d\uff0c\u5f88\u5c11\u6709\u95dc\u65bc\u9644\u52a0\u5143\u4ef6\u958b\u767c\u7684\u6a19\u6e96\u548c\u7d04\u5b9a\u3002 \u5728 XF 2.0 \u7684\u529f\u80fd\u4e2d\uff0c\u6211\u5011\u5df2\u7d93\u505a\u4e86\u5f88\u591a\u4fee\u6539\u3002 \u8b93\u6211\u5011\u4f86\u770b\u770b\u5176\u4e2d\u7684\u4e00\u4e9b\u8b8a\u5316\uff1a","title":"\u9644\u52a0\u5143\u4ef6\u7d50\u69cb"},{"location":"add-on-structure/#id","text":"\u6bcf\u500b\u5b89\u88dd\u7684\u9644\u52a0\u5143\u4ef6\u90fd\u5fc5\u9808\u6709\u4e00\u500b\u552f\u4e00\u7684 ID\uff0c\u9019\u500b ID \u6c7a\u5b9a\u4e86\u9644\u52a0\u5143\u4ef6\u61c9\u8a72\u5728\u6a94\u6848\u7cfb\u7d71\u4e2d\u7684\u54ea\u500b\u4f4d\u7f6e\u5132\u5b58\u5176\u6a94\u6848\u3002\u9644\u52a0\u5143\u4ef6\u7684 ID \u6709\u5169\u7a2e\u53ef\u80fd\u7684\u683c\u5f0f\u3002 \u7b2c\u4e00\u500b \"\u7c21\u55ae\" \u985e\u578b\u61c9\u8a72\u662f\u4e00\u500b\u55ae\u5b57\uff0c\u4e0d\u5305\u542b\u4efb\u4f55\u7279\u6b8a\u5b57\u5143\u3002\u4f8b\u5982\uff0c Demo \u3002 \u7c21\u55ae\u7684\u9644\u52a0\u5143\u4ef6 ID \u5fc5\u9808\u9075\u5b88\u4ee5\u4e0b\u898f\u5247\uff1a \u5fc5\u9808\u53ea\u5305\u542b a-z \u6216 A-Z\u3002 \u53ef\u4ee5\u5305\u542b 0-9\uff0c\u4f46\u4e0d\u80fd\u653e\u5728 ID \u958b\u982d\u3002 \u4e0d\u80fd\u5305\u542b\u4efb\u4f55\u7279\u6b8a\u5b57\u5143\uff0c\u4f8b\u5982\u659c\u7dda\u3001\u7834\u6298\u865f\u6216\u4e0b\u5283\u7dda\u3002 \u7b2c\u4e8c\u500b\u5305\u542b\u4e00\u500b\u4f9b\u61c9\u5546\u524d\u7db4\uff0c\u6240\u4ee5\u5982\u679c\u4f60\u5728\u4e00\u500b\u7279\u5b9a\u7684\u54c1\u724c\u6216\u516c\u53f8\u4e0b\u767c\u5e03\u9644\u52a0\u5143\u4ef6\uff0c\u9644\u52a0\u5143\u4ef6 ID \u53ef\u4ee5\u8868\u660e\u9019\u4e00\u9ede\u3002\u4f8b\u5982\uff0c SomeVendor/Demo \u3002 \u4f9b\u61c9\u5546\u985e\u578b\u7684\u9644\u52a0 ID \u61c9\u9075\u5b88\u4ee5\u4e0b\u898f\u5247\uff1a \u5fc5\u9808\u53ea\u5305\u542b a-z \u6216 A-Z \u53ef\u5305\u542b\u4e00\u500b / \u5b57\u5143\uff0c\u4f46\u4e0d\u80fd\u5728\u958b\u982d\u6216\u7d50\u5c3e\u8655 \u53ef\u4ee5\u5305\u542b 0-9\uff0c\u4f46\u4e0d\u5728\u9644\u52a0\u5143\u4ef6 ID \u7684\u4efb\u4f55\u4e00\u500b\u90e8\u5206\u7684\u958b\u982d \u4e00\u65e6\u60a8\u6c7a\u5b9a\u4e86\u9644\u52a0\u5143\u4ef6\u7684 ID\uff0c\u6211\u5011\u5c31\u77e5\u9053\u9019\u500b\u9644\u52a0\u5143\u4ef6\u7684\u6a94\u6848\u5c07\u5132\u5b58\u5728\u54ea\u88e1\u3002 \u6240\u6709 XF 2.0 \u9644\u52a0\u5143\u4ef6\u90fd\u5132\u5b58\u5728 src/addons \u76ee\u9304\u7684\u5b50\u76ee\u9304\u4e2d\u3002 \u5982\u679c\u4f60\u6709\u4e00\u500b\u7c21\u55ae\u7684\u9644\u52a0\u5143\u4ef6 ID\uff0c\u4f8b\u5982 Demo \uff0c\u4f60\u7684\u9644\u52a0\u5143\u4ef6\u6a94\u6848\u5c07\u5132\u5b58\u5728\u4ee5\u4e0b\u4f4d\u7f6e\uff1a src/addons/Demo \u3002 \u5982\u679c\u4f60\u6709\u4e00\u500b\u57fa\u65bc\u5ee0\u5546\u7684\u9644\u52a0\u5143\u4ef6 ID\uff0c\u4f8b\u5982 SomeVendor/Demo \uff0c\u6a94\u6848\u5c07\u5132\u5b58\u5728\u4ee5\u4e0b\u4f4d\u7f6e\uff1a src/addons/SomeVendor/Demo \u3002 \u60a8\u9078\u64c7\u7684\u9644\u52a0\u5143\u4ef6 ID \u4e5f\u5c07\u6210\u70ba\u60a8\u7684\u985e\u5225\u547d\u540d\u7a7a\u9593\u524d\u7db4\uff08\u66f4\u591a\u8cc7\u8a0a\u8acb\u53c3\u898b \u547d\u540d\u7a7a\u9593 \uff09\u3002","title":"\u9644\u52a0\u5143\u4ef6 ID \u548c\u9644\u52a0\u5143\u4ef6\u8def\u5f91"},{"location":"add-on-structure/#_2","text":"XF \u672c\u8eab\u4f7f\u7528 MAJOR.MINOR.PATCH \u539f\u5247\uff08\u4f8b\u5982 2.0.0 \u4ee3\u8868\u7b2c\u4e00\u500b\u7a69\u5b9a\u7684 XF2 \u7248\u672c\uff09\u4f86\u9032\u884c\u7248\u672c\u7de8\u865f\uff0c\u6211\u5011\u5efa\u8b70\u5c0d\u60a8\u81ea\u5df1\u7684\u9644\u52a0\u5143\u4ef6\u7684\u7248\u672c\u7de8\u865f\u63a1\u53d6\u985e\u4f3c\u7684\u65b9\u6cd5\u3002 \u57fa\u672c\u4e0a\uff0c\u5728\u7248\u672c\u865f\u4e2d\u589e\u52a0 MAJOR \u7248\u672c\uff0c\u7576\u4f60\u505a\u4e86\u91cd\u5927\u7684\u529f\u80fd\u6539\u8b8a\uff0c\u7279\u5225\u662f\u7834\u58de\u4e86\u5411\u5f8c\u76f8\u5bb9\u6027\u7684\u6539\u8b8a MINOR \u7248\u672c\uff0c\u7576\u4f60\u65b0\u589e\u529f\u80fd\u6642\uff0c\u6700\u597d\u662f\u4ee5\u5411\u5f8c\u76f8\u5bb9\u7684\u65b9\u5f0f\u65b0\u589e PATCH \u7248\u672c\uff0c\u7576\u4f60\u9032\u884c\u5411\u5f8c\u76f8\u5bb9\u7684 Bug \u4fee\u5fa9\u6642\u4f7f\u7528","title":"\u5efa\u8b70\u7248\u672c\u5b57\u4e32\u683c\u5f0f"},{"location":"add-on-structure/#id_1","text":"\u9644\u52a0\u5143\u4ef6\u7684\u7248\u672c ID \u662f\u57fa\u672c\u7684\u6574\u6578\uff0c\u7528\u65bc\u5167\u90e8\u7248\u672c\u6bd4\u8f03\u3002 \u5b83\u8b93\u6211\u5011\u53ef\u4ee5\u66f4\u5bb9\u6613\u5730\u6aa2\u6e2c\u5230\u4e00\u500b\u7248\u672c\u6bd4\u53e6\u4e00\u500b\u7248\u672c\u820a\u3002 \u60a8\u7684\u9644\u52a0\u5143\u4ef6\u6bcf\u500b\u7248\u672c\u90fd\u61c9\u8a72\u5c07\u7248\u672c\u865f ID \u81f3\u5c11\u589e\u52a0 1\uff0c\u4f46\u6211\u5011\u5167\u90e8\u5c0d XF \u672c\u8eab\u4f7f\u7528\u7684\u6163\u4f8b\uff0c\u5c0d\u9644\u52a0\u5143\u4ef6\u4e5f\u6709\u6f5b\u5728\u7684\u4f5c\u7528\u3002 \u6211\u5011\u7684\u7248\u672c ID \u7684\u683c\u5f0f\u70ba aabbccde \u3002 aa \u4ee3\u8868 MAJOR \u7248\u672c bb \u4ee3\u8868 MINOR \u7248\u672c cc \u4ee3\u8868 PATCH \u7248\u672c d \u4ee3\u8868\u72c0\u614b\uff0c\u4f8b\u5982 1 \u4ee3\u8868 alpha \u7248\u672c\uff0c 3 \u4ee3\u8868 beta \u7248\u672c\uff0c 5 \u4ee3\u8868\u5019\u9078\u7248\u672c\uff0c 7 \u4ee3\u8868\u7a69\u5b9a\u7248\u672c e \u4ee3\u8868\u7248\u672c Level \u72c0\u614b \u4f8b\u5982\uff0c\u4e00\u500b\u7248\u672c\u865f\u662f 1.7.3 \u5019\u9078\u7248\u672c 4 \u5b83\u7684\u9644\u52a0\u5143\u4ef6 ID \u70ba \"1070354\"\u3002 \u6700\u7d42\u7a69\u5b9a\u7248 XF2 \u7684ID\u70ba 2000070 \u3002 XF \u7684 1.5.0 Beta 3 \u7248\u672c\u7684 ID \u70ba 1050033 \u3002 \u7a69\u5b9a\u7248 99.99.99 \u6703\u6709\u4e00\u500bID\u70ba 99999970 ... \u4e5f\u8a31\u4f60\u61c9\u8a72\u6162\u4e00\u9ede \ud83d\ude09\u3002","title":"\u5efa\u8b70\u7248\u672c ID \u683c\u5f0f"},{"location":"add-on-structure/#_3","text":"\u5728\u9644\u52a0\u5143\u4ef6\u7684\u76ee\u9304\u4e2d\uff0c\u6709\u4e00\u4e9b\u6a94\u6848\u548c\u76ee\u9304\u6709\u7279\u6b8a\u7684\u7528\u9014\u548c\u610f\u7fa9\u3002","title":"\u5e38\u898b\u7684\u9644\u52a0\u5143\u4ef6\u6a94\u6848\u548c\u76ee\u9304"},{"location":"add-on-structure/#addonjson","text":"addon.json \u662f\u4e00\u500b\u5305\u542b\u4e00\u4e9b\u8cc7\u8a0a\u7684\u6a94\u6848\uff0c\u9019\u4e9b\u8cc7\u8a0a\u662f\u5e6b\u52a9 XF 2.0 \u8b58\u5225\u9644\u52a0\u5143\u4ef6\u4e26\u5728 Admin CP \u4e2d\u986f\u793a\u5176\u8cc7\u8a0a\u6240\u5fc5\u9700\u7684\u3002 \u6700\u8d77\u78bc\uff0c\u4f60\u7684 addon.json \u6a94\u6848\u61c9\u8a72\u770b\u8d77\u4f86\u50cf\u9019\u6a23\uff1a { \"title\": \"My Add-on by Some Company\", \"version_string\": \"2.0.0\", \"version_id\": 2000070, \"dev\": \"Some Company\" } \u5efa\u7acb\u9644\u52a0\u5143\u4ef6\u6642\uff0c\u6703\u81ea\u52d5\u70ba\u60a8\u5efa\u7acb\u4e00\u500b\u57fa\u672c\u6a94\u6848\u3002 \u5305\u542b\u4e00\u500b\u6709\u6548\u7684 addon.json \u6a94\u6848\u662f\u4f60\u7684\u9644\u52a0\u5143\u4ef6\u88ab\u8b58\u5225\u7684\u5fc5\u8981\u689d\u4ef6\uff0c\u4f60\u53ef\u4ee5\u96a8\u6642 \u9a57\u8b49\u4f60\u7684 addon.json \u6a94\u6848 \u3002","title":"addon.json \u6a94\u6848"},{"location":"add-on-structure/#_4","text":"Property Description legacy_addon_id \u7576\u5f9e XenForo 1 \u5347\u7d1a\u81f3 XenForo 2 \u6642\uff0c\u7528\u4f86\u958b\u555f\u81ea\u52d5\u8655\u7406\u9644\u52a0\u5143\u4ef6 ID \u66f4\u6539\u3002 title \u9644\u52a0\u5143\u4ef6\u7684\u6a19\u984c\u3002 \u9019\u5c07\u986f\u793a\u5728\u7ba1\u7406\u9762\u677f\u4e2d\u3002 description \u9644\u52a0\u5143\u4ef6\u7684\u63cf\u8ff0\u3002\u9019\u5c07\u986f\u793a\u5728\u7ba1\u7406\u9762\u677f\u4e2d\u3002 version_id XenForo \u7528\u4f86\u8ffd\u8e64\u9644\u52a0\u5143\u4ef6\u66f4\u65b0\u7684\u5167\u90e8 ID\u3002 \u6bcf\u6b21\u767c\u4f48\u6642\u5fc5\u9808\u905e\u589e\u3002 version_string \u4eba\u985e\u53ef\u4ee5\u8b80\u61c2\u7684\u9644\u52a0\u5143\u4ef6\u7248\u672c\u3002 \u9019\u5c07\u5728\u7ba1\u7406\u9762\u677f\u4e2d\u986f\u793a\uff0c\u800c\u4e0d\u662f version_id \u5c6c\u6027\u3002 dev \u9644\u52a0\u5143\u4ef6\u958b\u767c\u8005\u7684\u540d\u5b57\u3002\u9019\u5c07\u986f\u793a\u5728\u7ba1\u7406\u9762\u677f\u4e2d\u3002 dev_url \u5982\u679c\u8a2d\u5b9a\u4e86\uff0c\u958b\u767c\u8005\u7684\u540d\u5b57\u5c07\u4ee5\u8d85\u9023\u7d50\u7684\u5f62\u5f0f\u986f\u793a\u5728\u7ba1\u7406\u9762\u677f\u4e2d\uff0c\u4e26\u4ee5 (href) \u6b64\u70ba\u76ee\u6a19\u3002 faq_url \u5982\u679c\u8a2d\u5b9a\u4e86\uff0c\u4e00\u500b FAQ \u7684\u8d85\u9023\u7d50\u5c07\u986f\u793a\u5728\u7ba1\u7406\u9762\u677f\u4e2d\uff0c\u4e26\u4ee5 (href) \u6b64\u70ba\u76ee\u6a19\u3002 support_url \u5982\u679c\u8a2d\u5b9a\u4e86\uff0c\u652f\u63f4\u5e6b\u52a9\u7684\u8d85\u9023\u7d50\u5c07\u986f\u793a\u5728\u7ba1\u7406\u9762\u677f\u4e2d\uff0c\u4e26\u4ee5 (href) \u6b64\u70ba\u76ee\u6a19\u3002 extra_urls \u9019\u5141\u8a31\u60a8\u986f\u793a\u8207\u9644\u52a0\u5143\u4ef6\u76f8\u95dc\u7684\u5176\u4ed6\u5167\u5bb9\u9023\u7d50\uff08\u53ef\u80fd\u662f\u932f\u8aa4\u5831\u544a\u9023\u7d50\uff0c\u624b\u518a - \u96a8\u60a8\u559c\u6b61\uff09\u3002 \u4e00\u500b JSON \u7269\u4ef6\u7684\u9663\u5217\uff0c\u5176\u4e2d key \u662f\u9023\u7d50\u6587\u5b57\uff0cvalue \u662f\u9023\u7d50\u76ee\u6a19 (href)\u3002 require XenForo \u5141\u8a31\u5b89\u88dd\u9644\u52a0\u5143\u4ef6\u6642\u9700\u8981\u6eff\u8db3\u7684\u4e00\u7cfb\u5217\u8981\u6c42\u3002 \u66f4\u591a\u8cc7\u8a0a\u8acb\u53c3\u898b 'require \u5c6c\u6027' \u3002 icon \u8cc7\u6e90\u7684\u5716\u793a\u3002 \u9019\u53ef\u4ee5\u662f\u4e00\u500b Font Awesome \u5716\u793a\u540d\u7a31\uff08\u4f8b\u5982 fa-shopping-bag \uff0c\u6216\u4e00\u500b\u5716\u7247\u6a94\u6848\u7684\u8def\u5f91\uff09\u3002","title":"\u5c6c\u6027"},{"location":"add-on-structure/#require","text":"\u5982\u679c\u74b0\u5883\u4e0d\u652f\u63f4\u6216\u4e0d\u6eff\u8db3\u8981\u6c42\uff0crequire \u5c6c\u6027\u662f\u963b\u6b62\u9644\u52a0\u5143\u4ef6\u5b89\u88dd\u6216\u5347\u7d1a\u7684\u6a19\u6e96\u65b9\u6cd5\u3002 \u4f60\u53ef\u4ee5\u7528\u5b83\u4f86\u8981\u6c42\u5148\u5b89\u88dd\u5176\u4ed6\u9644\u52a0\u5143\u4ef6\uff0c\u8981\u6c42\u67d0\u4e9b PHP \u64f4\u5c55\u5fc5\u9808\u5b58\u5728\u6216\u555f\u7528\uff0c\u548c/\u6216 \u5f37\u5236\u57f7\u884c\u4e00\u500b\u6700\u4f4e\u7684 PHP \u7248\u672c\u3002 \u9019\u662f\u4e00\u500b\u793a\u4f8b\u7247\u6bb5\uff1a ... \"require\": { \"XF\": [2000010, \"XenForo 2.0.0+\"], \"php\": [\"5.4.0\", \"PHP 5.4.0+\"], \"php-ext/json\": [\"*\", \"JSON extension\"] } ... \u6bcf\u500b require\uff0c\u90fd\u662f\u4e00\u500b\u547d\u540d\u9663\u5217\u3002 \u9663\u5217\u7684\u540d\u7a31\u662f\u7522\u54c1 ID (\u5982 XF \u6216 php )\u3002 \u7b2c\u4e00\u500b\u9663\u5217\u5143\u7d20\u662f\u7522\u54c1\u7684\u7248\u672c (\u5982 2000010 \u6216 5.4.0 )\u3002 \u4f60\u53ef\u4ee5\u4f7f\u7528 * \u4f86\u8868\u793a\u7522\u54c1\u7684\u4efb\u4f55\u7248\u672c\u3002 \u7b2c\u4e8c\u500b\u9663\u5217\u5143\u7d20\u662f\u8a72 require \u4eba\u985e\u53ef\u4ee5\u95b1\u8b80\u7684\u6587\u5b57\uff0c\u9019\u662f\u5728\u8a0a\u606f\u4e2d\u4f7f\u7528\u7684\u5167\u5bb9\uff08\u4f8b\u5982 XenForo 2.0.0+ \u6216 PHP 5.4.0+ \uff09\u3002 \u4e0b\u9762\u662f\u53d7\u652f\u63f4\u7684\u7522\u54c1 ID \u7684\u6982\u8ff0\uff1a \u7522\u54c1 / Require \u540d\u7a31 \u53c3\u8003... \u503c XF XenForo \u7684\u5b89\u88dd\u7248\u672c\u3002 XenForo \u7248\u672c ID\uff0c\u4f8b\u5982 200010 \u3002 \u4f60\u53ef\u4ee5\u901a\u904e\u6aa2\u67e5 /src/XF.php \u6a94\u6848\u9802\u90e8\u7684 $versionId \u5b9a\u7fa9\u6216\u8005\u5217\u5370 /XF::$versionId \u7684\u503c\u4f86\u7372\u53d6\u76ee\u524d XenForo \u7684\u7248\u672c\u3002 php PHP \u7248\u672c\u3002 PHP \u7248\u672c\uff0c\u4f8b\u5982 5.4.0 \u3002 \u5efa\u8b70\u4f60\u76e1\u53ef\u80fd\u964d\u4f4e\u9019\u500b\u503c\uff1b\u66f4\u65b0\u4e00\u500b PHP \u7248\u672c\u53ef\u80fd\u662f\u4e00\u500b\u76f8\u7576\u8907\u96dc\u7684\u5de5\u4f5c - \u7279\u5225\u662f\u7576\u5176\u4ed6\u9644\u52a0\u5143\u4ef6\u8207\u65b0\u7684 PHP \u7248\u672c\u885d\u7a81\u6642\u3002 php-ext / (extension name) \u4e00\u500b PHP \u64f4\u5c55 - \u5176\u4e2d (extension name) \u662f\u64f4\u5c55\u7684\u540d\u7a31\u3002 PHP \u64f4\u5c55\u7248\u672c\u3002 \u9019\u662f\u7528 PHP \u7684 version_compare \u51fd\u6578\u4f86\u6aa2\u67e5\u7684\uff0c\u6240\u4ee5\u5b83\u751a\u81f3\u9069\u7528\u65bc\u5b98\u65b9\u5b8c\u6574 PHP \u683c\u5f0f\u7684\u7248\u672c\u5b57\u4e32\uff0c\u6bd4\u5982 7.1.19-1+ubuntu16.04.1+deb.sury.org+1 \u3002 (any addon ID) \u4efb\u4f55 XenForo \u9644\u52a0\u5143\u4ef6\uff0c\u5982 Demo/Addon \u3002\u5982\u679c\u60a8\u4e0d\u78ba\u5b9a\u67d0\u500b\u9644\u52a0\u5143\u4ef6\u7684 ID\uff0c\u8acb\u67e5\u770b\u5b83\u7684 addon.json \u6a94\u6848\u3002 \u9644\u52a0\u5143\u4ef6\u7684\u7248\u672c ID\u3002 \u60a8\u53ef\u4ee5\u53c3\u8003 \u5efa\u8b70\u7248\u672c ID \u683c\u5f0f \u4e86\u89e3\u66f4\u591a\u8cc7\u8a0a\u3002","title":"require \u5c6c\u6027"},{"location":"add-on-structure/#hashesjson","text":"hashes.json \u662f\u70ba\u6a94\u6848\u5065\u6aa2\u7cfb\u7d71\u65b0\u589e\u652f\u63f4\u7684\u65b0\u65b9\u6cd5\uff0c\u800c\u4e14\u6700\u597d\u7684\u90e8\u5206\u662f - \u5b83\u662f\u81ea\u52d5\u751f\u6210\u7684\uff01 \u4f5c\u70ba\u69cb\u5efa\u904e\u7a0b\u7684\u4e00\u90e8\u5206\uff08\u7a0d\u5f8c\u6703\u6709\u66f4\u591a\u8aaa\u660e\uff09\uff0c\u6211\u5011\u5c07\u5c0d\u60a8\u6240\u6709\u9644\u52a0\u5143\u4ef6\u7684\u6a94\u6848\u9032\u884c\u5feb\u901f\u6e05\u9ede\uff0c\u4e26\u5c07\u8a08\u7b97\u51fa\u7684\u6a94\u6848\u5167\u5bb9\u96dc\u6e4a\u78bc\u5beb\u5165\u5176\u4e2d\u3002","title":"hashes.json \u6a94\u6848"},{"location":"add-on-structure/#setupphp","text":"Setup.php \u662f\u60a8\u5b89\u88dd\u3001\u5347\u7d1a\u6216\u89e3\u9664\u5b89\u88dd\u9644\u52a0\u5143\u4ef6\u6642\u9700\u8981\u57f7\u884c\u7684\u4efb\u4f55\u7a0b\u5f0f\u78bc\u7684\u65b0\u4e3b\u9801\u3002 \u4e0b\u9762 \u6211\u5011\u5c07\u8a73\u7d30\u4ecb\u7d39\u5982\u4f55\u5efa\u7acb\u4e00\u500b Setup \u985e\u3002","title":"Setup.php \u6a94\u6848"},{"location":"add-on-structure/#_data","text":"_data \u76ee\u9304\u662f\u5132\u5b58\u60a8\u7684\u9644\u52a0\u5143\u4ef6\u4e3b\u8981\u8cc7\u6599\u7684\u5730\u65b9\u3002 \u6bcf\u500b\u9644\u52a0\u5143\u4ef6\u7684\u8cc7\u6599\u985e\u578b\u90fd\u6703\u6709\u81ea\u5df1\u7684 XML \u6a94\u6848\uff08\u800c\u4e0d\u662f\u6240\u6709\u985e\u578b\u7684\u55ae\u500b\u6a94\u6848\uff09\u3002\u9019\u4e9b\u6a94\u6848\u7684\u96dc\u6e4a\u503c\u88ab\u5305\u542b\u5728 hashes.json \u4e2d\uff0c\u56e0\u6b64\u6211\u5011\u53ef\u4ee5\u5728\u5141\u8a31\u5b89\u88dd\u9644\u52a0\u5143\u4ef6\u4e4b\u524d\u78ba\u4fdd\u9644\u52a0\u5143\u4ef6\u64c1\u6709\u5b8c\u6574\u548c\u4e00\u81f4\u7684\u8cc7\u6599\u3002","title":"_data \u76ee\u9304"},{"location":"add-on-structure/#_output","text":"_output \u76ee\u9304\u4e0d\u662f\u6210\u529f\u5b89\u88dd\u9644\u52a0\u5143\u4ef6\u6240\u5fc5\u9700\u7684\uff0c\u800c\u4e14\u5728\u767c\u4f48\u9644\u52a0\u5143\u4ef6\u6642\u4e5f\u4e0d\u61c9\u8a72\u5305\u62ec\u5728\u5167\u3002 \u9019\u500b\u76ee\u9304\u7d14\u7cb9\u662f\u70ba\u4e86\u958b\u767c\u76ee\u7684\uff0c\u53ea\u6709\u5728\u555f\u7528\u958b\u767c\u6a21\u5f0f\u6642\u624d\u6703\u4f7f\u7528\uff08\u53c3\u898b \u555f\u7528\u958b\u767c\u6a21\u5f0f \uff09\u3002 \u6bcf\u9805\u9644\u52a0\u5143\u4ef6\u8cc7\u6599\u90fd\u5132\u5b58\u5728\u4e00\u500b\u55ae\u7368\u7684\u6a94\u6848\u4e2d\u3002 \u5927\u591a\u6578\u60c5\u6cc1\u4e0b\uff0c\u5b83\u5011\u88ab\u5132\u5b58\u6210 JSON \u6a94\u6848\uff0c\u4f46\u5c0d\u65bc\u77ed\u8a9e\uff0c\u5b83\u5011\u88ab\u5132\u5b58\u70ba TXT \u6a94\u6848\uff0c\u5c0d\u65bc\u6a21\u677f\uff0c\u5b83\u5011\u88ab\u5132\u5b58\u70ba HTML/CSS/LESS \u6a94\u6848\u3002 \u6240\u6709\u7684\u6a21\u677f\u985e\u578b\u90fd\u53ef\u4ee5\u5728\u6a94\u6848\u7cfb\u7d71\u4e2d\u76f4\u63a5\u7de8\u8f2f\uff0c\u5c0d\u9019\u4e9b\u6a94\u6848\u7684\u4fee\u6539\u6703\u5728\u8f09\u5165\u6642\u81ea\u52d5\u5beb\u56de\u8cc7\u6599\u5eab\u3002","title":"_output \u76ee\u9304"},{"location":"add-on-structure/#setup","text":"\u8981\u70ba\u60a8\u7684\u9644\u52a0\u5143\u4ef6\u5efa\u7acb\u4e00\u500b Setup \u985e\uff0c\u60a8\u9700\u8981\u505a\u7684\u5c31\u662f\u5728\u60a8\u9644\u52a0\u5143\u4ef6\u76ee\u9304\u7684\u6839\u76ee\u9304\u4e0b\u5efa\u7acb\u4e00\u500b\u540d\u70ba Setup.php \u7684\u6a94\u6848\u3002 Setup \u985e\u61c9\u8a72\u7e7c\u627f /XF/AddOn/AbstractSetup \uff0c\u5b83\u81f3\u5c11\u9700\u8981\u5be6\u4f5c install() \u3001 upgrade() \u548c uninstall() \u65b9\u6cd5\u3002 \u4e0b\u9762\u662f\u4e00\u500b\u7c21\u55ae\u7684\u9644\u52a0\u5143\u4ef6 Setup \u985e\u7684\u6a23\u5b50\u3002 <?php namespace Demo; class Setup extends \\XF\\AddOn\\AbstractSetup { public function install(array $stepParams = []) { $this->schemaManager()->createTable('xf_demo', function(\\XF\\Db\\Schema\\Create $table) { $table->addColumn('demo_id', 'int'); }); } public function upgrade(array $stepParams = []) { if ($this->addOn->version_id < 1000170) { $this->schemaManager()->alterTable('xf_demo', function(\\XF\\Db\\Schema\\Alter $table) { $table->addColumn('foo', 'varchar', 10)->setDefault(''); }); } } public function uninstall(array $stepParams = []) { $this->schemaManager()->dropTable('xf_demo'); } } Setup \u985e\u4e5f\u652f\u63f4\u5728\u4e0d\u540c\u7684\u6b65\u9a5f\u4e2d\u57f7\u884c\u6bcf\u500b\u64cd\u4f5c\u3002 \u70ba\u4e86\u5be6\u73fe\u9019\u7a2e\u884c\u70ba\uff0c\u60a8\u7684 Setup \u985e\u53ef\u4ee5\u4f7f\u7528 StepRunnerInstallTrait \u3001 StepRunnerUpgradeTrait \u548c/\u6216 StepRunnerUninstallTrait \u7279\u6027 \u3002 \u9019\u4e9b\u90fd\u6703\u81ea\u52d5\u5be6\u4f5c\u6240\u9700\u7684\u65b9\u6cd5\uff0c\u4f60\u53ea\u9700\u8981\u65b0\u589e\u76f8\u95dc\u7684\u6b65\u9a5f\uff0c\u4f8b\u5982 installStep1() \u3001 upgrade1000170Step1() \u3001 upgrade1000170Step2() \u548c uninstallStep1() \uff0c\u5176\u4e2d\u5347\u7d1a\u65b9\u6cd5\u4e2d\u7684 1000170 \u7b49... \u662f\u9644\u52a0\u5143\u4ef6\u7684\u7248\u672c ID (\u53c3\u898b \u5efa\u8b70\u7248\u672c ID \u683c\u5f0f )\u3002","title":"Setup \u985e"},{"location":"controller-basics/","text":"\u63a7\u5236\u5668\u57fa\u790e\u77e5\u8b58 \u00b6 \u5728\u57fa\u672c\u5c64\u9762\u4e0a\uff0cController \u662f\u7576\u4f60\u5728 XF \u4e2d\u8a2a\u554f\u4e00\u500b\u9801\u9762\u6642\u57f7\u884c\u7684\u7a0b\u5f0f\u78bc\u3002 \u5728\u57fa\u672c\u5c64\u9762\u4e0a\uff0cController \u4e00\u822c\u8ca0\u8cac\u8655\u7406\u7528\u6236\u7684\u8f38\u5165\uff0c\u4e26\u5c07\u7528\u6236\u7684\u8f38\u5165\u50b3\u905e\u5230\u9069\u7576\u7684\u5730\u65b9\uff0c\u901a\u5e38\u662f\u57f7\u884c\u67d0\u7a2e\u8cc7\u6599\u5eab\u64cd\u4f5c\uff08Model\uff09\u6216\u8f09\u5165\u8996\u89ba\u5316\u5167\u5bb9\uff08View\uff09\u3002 \u7576\u7528\u6236\u9ede\u9078\u9023\u7d50\u6642\uff0c\u8acb\u6c42\u7684 URL \u6703\u88ab\u8def\u7531\u5c0e\u5230\u7279\u5b9a\u7684 Controller \u548c Controller action\u3002 \u53c3\u898b \u8def\u7531\u57fa\u790e\u77e5\u8b58 \u3002 \u4f8b\u5982\uff0c\u5728 XF \u4e2d\uff0c\u5982\u679c\u4f60\u9ede\u9078\u4e00\u500b\u985e\u4f3c\u65bc index.php?conversations/add \u7684 URL\uff0c\u4f60\u5c07\u88ab\u8def\u7531\u5c0e\u5230 XF\\Pub\\Controller\\Conversation Controller \u548c add action\u3002 \u5982\u679c\u4f60\u5728\u6a94\u6848\u7cfb\u7d71\u4e2d\u67e5\u770b\u9019\u500b class\uff08\u53c3\u898b \u81ea\u52d5\u8f09\u5165\u5668 \uff0c\u4ee5\u4e86\u89e3 class \u548c\u6a94\u6848\u8def\u5f91\u5982\u4f55\u76f8\u4e92\u6620\u5c04\u7684\u63cf\u8ff0\uff09\uff0c\u4f60\u6703\u6ce8\u610f\u5230\u6709\u8a31\u591a\u65b9\u6cd5\u4ee5 action \u70ba\u524d\u7db4\u547d\u540d\u3002 \u6240\u6709\u9019\u4e9b\u65b9\u6cd5\u90fd\u8868\u793a\u4e00\u500b\u7279\u5b9a\u7684 Controller action\u3002 \u6240\u4ee5\uff0c\u8981\u60f3\u5728\u67e5\u770b\u4e0a\u9762\u63d0\u5230\u7684 conversations/add \u9801\u9762\u6642\u770b\u5230\u76f8\u95dc\u7a0b\u5f0f\u78bc\uff0c\u8acb\u5728\u9019\u500b\u6a94\u6848\u4e2d\u67e5\u8a62 public function actionAdd() \u3002 XF Controller \u8ca0\u8cac\u8fd4\u56de\u4e00\u500b reply \u7269\u4ef6\uff0c\u8a72\u7269\u4ef6\u4e00\u822c\u5305\u62ec\u4ee5\u4e0b\u985e\u578b\u4e4b\u4e00\uff1a View \u56de\u61c9 \u00b6 \u9019\u662f XF \u958b\u767c\u904e\u7a0b\u4e2d\u6700\u5e38\u898b\u7684\u56de\u61c9\u4e4b\u4e00\u3002 \u4e00\u500b\u8fd4\u56de View \u56de\u61c9\u7684 Controller \u901a\u5e38\u9700\u8981\u50b3\u905e\u591a\u9054\u4e09\u500b\u53c3\u6578\u3002 \u4e00\u500b View class (\u4e0b\u9762\u6703\u6709\u66f4\u591a\u7684\u4ecb\u7d39)\uff0c\u4e00\u500b\u6a21\u677f\u540d\u7a31\uff0c\u4ee5\u53ca\u4e00\u500b\u7531 $viewParams \u7d44\u6210\u7684\u9663\u5217\uff0c\u9019\u500b\u9663\u5217\u662f\u6a21\u677f\u61c9\u8a72\u6709\u7684\u8cc7\u6599\u3002 \u9019\u88e1\u662f\u4e00\u500b\u5178\u578b\u7684 Controller action \u7684\u4f8b\u5b50\uff0c\u5b83\u8fd4\u56de\u4e00\u500b View \u56de\u61c9\uff1a public function actionExample() { $hello = 'Hello'; $world = 'world!'; $viewParams = [ 'hello' => $hello, 'world' => $world ]; return $this->view('Demo:Example', 'demo_example', $viewParams); } \u7b2c\u4e00\u500b\u53c3\u6578\u662f\u4e00\u500b\u7279\u5b9a View class \u7684\u7c21\u77ed class \u540d\u3002 \u9019\u500b class \u53ef\u80fd\u5b58\u5728\uff0c\u4e5f\u53ef\u80fd\u4e0d\u5b58\u5728\uff08\u901a\u5e38\u60c5\u6cc1\u4e0b\uff0c\u5b83\u4e0d\u9700\u8981\u5b58\u5728\uff0c\u6211\u5011\u5728\u5f8c\u9762\u6703\u4ecb\u7d39\u66f4\u591a\u5730 View class \uff09\uff0c\u4f46\u5b83\u61c9\u8a72\u6709\u4e00\u500b Controller \u548c action \u7684\u5927\u81f4\u552f\u4e00\u540d\u7a31\u3002 \u8207\u5176\u4ed6 \u77ed\u985e\u540d \u4e00\u6a23\uff0c\u4e0a\u9762\u7684\u7279\u5b9a\u77ed\u985e\u540d\u5c07\u89e3\u6790\u70ba Demo/Pub/View/Example \u3002 \u540c\u6a23\uff0c Pub \u662f\u7531 Controller \u985e\u578b\u81ea\u52d5\u63a8\u65b7\u51fa\u4f86\u7684\u3002 \u7b2c\u4e8c\u500b\u53c3\u6578\u662f\u6a21\u677f\u540d\u7a31\u3002 \u5728\u672c\u4f8b\u4e2d\uff0c\u6211\u5011\u6b63\u5728\u5c0b\u627e\u4e00\u500b\u540d\u70ba demo_example \u7684\u6a21\u677f\u3002 \u7b2c\u4e09\u500b\u53c3\u6578\u662f \u61c9\u8a72\u63d0\u4f9b\u7d66 view \u6a21\u677f \u53c3\u6578/\u503c \u7684\u9663\u5217\u3002 \u9019\u500b\u9663\u5217\u4e00\u822c\u61c9\u8a72\u662f\u4e00\u5c0d key => value \u3002 \u4e0a\u9762\u7684\u4f8b\u5b50\u662f\u5c07\u5169\u500b\u6a21\u677f\u53c3\u6578\u50b3\u905e\u7d66\u6a21\u677f\u3002 \u9663\u5217\u4e2d\u7684 key \u90e8\u5206\u8868\u793a\u6a21\u677f\u4e2d\u53ef\u7528\u7684\u8b8a\u6578\u540d\u7a31\u3002 \u9663\u5217\u4e2d\u7684 value \u90e8\u5206\u8868\u793a\u503c\u3002 \u56e0\u6b64\uff0c\u5982\u679c\u6211\u5011\u5728 demo_example \u6a21\u677f\u4e2d\u6709\u4ee5\u4e0b\u5167\u5bb9\uff1a {$hello} {$world} \u8a72\u6a21\u677f\u5c07\u8f38\u51fa\u4ee5\u4e0b\u5167\u5bb9\uff1a Hello world! \u91cd\u65b0\u5c0e\u5411\u56de\u61c9 \u00b6 \u7576\u4f60\u5e0c\u671b\u5728\u7528\u6236\u5b8c\u6210\u67d0\u7a2e\u64cd\u4f5c\u5f8c\u5c07\u5176\u91cd\u65b0\u5c0e\u5411\u5230\u4e0d\u540c\u7684 URL \u6642\uff0c\u6703\u8fd4\u56de\u9019\u500b\u56de\u61c9\u3002 \u4e00\u500b\u5e38\u898b\u7684\u4f7f\u7528\u6848\u4f8b\u662f\u5728\u7528\u6236\u901a\u904e\u8868\u55ae\u63d0\u4ea4\u8cc7\u6599\u5f8c\uff0c\u4f60\u53ef\u80fd\u5e0c\u671b\u5c07\u4ed6\u5011\u91cd\u65b0\u5c0e\u5411\u5230\u4e0d\u540c\u7684\u9801\u9762\uff0c\u4f8b\u5982\u5c07\u7528\u6236\u8fd4\u56de\u5230\u4e00\u500b\u9805\u76ee\u6e05\u55ae\u3002 \u4e0b\u9762\u662f\u4e00\u500b\u5178\u578b\u7684 Controller action \u7684\u4f8b\u5b50\uff0c\u5b83\u57f7\u884c\u4e86\u4e00\u500b\u91cd\u65b0\u5c0e\u5411\uff1a public function actionRedirect() { return $this->redirect($this->buildLink('demo/example'), '\u9019\u662f\u4e00\u500b\u91cd\u5b9a\u5411\u8cc7\u8a0a\u3002', 'permanent'); } \u7b2c\u4e00\u500b\u53c3\u6578\u662f\u8981\u91cd\u65b0\u5c0e\u5411\u7684 URL\u3002 \u9019\u500b\u4f8b\u5b50\u5c07\u628a\u7528\u6236\u91cd\u65b0\u5c0e\u5411\u5230 index.php?demo/example \u7684 URL\u3002 \u7b2c\u4e8c\u500b\u53c3\u6578\u53ea\u6709\u5728\u8868\u55ae\u901a\u904e AJAX \u8acb\u6c42\u63d0\u4ea4\u6642\u624d\u6703\u986f\u793a\uff0cAJAX \u8acb\u6c42\u9078\u64c7\u9632\u6b62\u91cd\u65b0\u5c0e\u5411\u3002 \u7d50\u679c\u5c07\u662f\u4e00\u500b \"\u5373\u6642\u8a0a\u606f\"\uff0c\u5f9e\u87a2\u5e55\u9802\u90e8\u51fa\u73fe\u60a8\u9078\u64c7\u7684\u8a0a\u606f\u3002 \u60a8\u4e0d\u5fc5\u63d0\u4f9b\u60a8\u81ea\u5df1\u7684\u8cc7\u8a0a\u3002 \u5982\u679c\u6c92\u6709\u63d0\u4f9b\uff0c\u5b83\u5c07\u9810\u8a2d\u70ba \"\u60a8\u7684\u66f4\u6539\u5df2\u88ab\u5132\u5b58\"\u3002 \u7b2c\u4e09\u500b\u53c3\u6578\u9810\u8a2d\u70ba temporary \uff0c\u4f46\u4f60\u4e5f\u53ef\u4ee5\u9078\u64c7\u5c07\u5176\u8a2d\u5b9a\u70ba permanent\uff0c\u5c31\u50cf\u672c\u4f8b\u4e00\u6a23\u3002 \u9019\u88e1\u552f\u4e00\u7684\u5340\u5225\u662f\u4f3a\u670d\u5668\u63d0\u4f9b\u7684 HTTP \u56de\u61c9\u78bc\u7684\u985e\u578b\u3002 \u5728\u5927\u591a\u6578\u60c5\u6cc1\u4e0b\uff0c\u81e8\u6642\u662f\u7406\u60f3\u7684\uff0c\u9019\u5c07\u4ee5 303 \u78bc\u56de\u61c9\u3002 permanent \u5c07\u767c\u51fa 301 \u56de\u61c9\u78bc\u3002 \u96d6\u7136\u4f60\u53ef\u4ee5\u901a\u904e\u9019\u7a2e\u65b9\u5f0f\u89f8\u767c\u4e00\u500b permanent \u91cd\u65b0\u5c0e\u5411\uff0c\u4f46\u5be6\u969b\u4e0a\u6709\u4e00\u500b\u7279\u5b9a\u7684\u65b9\u6cd5\uff0c\u53ef\u4ee5\u4f7f\u7528\u5982\u4e0b\u3002 \u5b83\u4e5f\u9700\u8981\u4e00\u500b 'message' \u53c3\u6578\uff0c\u4f46\u548c\u4e0a\u9762\u4e00\u6a23\uff0c\u5b83\u662f\u53ef\u9078\u7684\u3002 public function actionRedirect() { return $this->redirectPermanently($this->buildLink('demo/example')); } \u932f\u8aa4\u56de\u61c9 \u00b6 \u9867\u540d\u601d\u7fa9\uff0c\u9019\u500b\u56de\u61c9\u5c31\u662f\u4f60\u9700\u8981\u5411\u7528\u6236\u986f\u793a\u932f\u8aa4\u6642\u8fd4\u56de\u7684\u5167\u5bb9\u3002 \u9019\u7a0d\u7a0d\u7c21\u55ae\uff0c\u4e0b\u9762\u662f\u4e00\u500b\u4f8b\u5b50\uff1a public function actionError() { return $this->error('\u5f88\u4e0d\u5e78\uff0c\u4f60\u8981\u627e\u7684\u6771\u897f\u7121\u6cd5\u627e\u5230\u3002', 404); } \u9019\u88e1\u53ea\u652f\u63f4\u5169\u500b\u53c3\u6578\u3002 \u7b2c\u4e00\u500b\u662f\u4f60\u60f3\u986f\u793a\u7684\u932f\u8aa4\u8cc7\u8a0a\uff0c\u7b2c\u4e8c\u500b\u662f\u4f60\u60f3\u8b93\u4f3a\u670d\u5668\u767c\u9001\u7684 HTTP \u56de\u61c9\u78bc\u3002 404 \u5c07\u4ee3\u8868\u5728\u6c92\u6709\u627e\u5230\u6771\u897f\u6642\u7684\u9069\u7576\u56de\u61c9\u3002 \u8a0a\u606f\u56de\u61c9 \u00b6 \u9019\u500b\u56de\u61c9\u8207\u932f\u8aa4\u56de\u61c9\u975e\u5e38\u76f8\u4f3c\uff0c\u652f\u63f4\u76f8\u540c\u7684\u53c3\u6578\u3002 \u4e3b\u8981\u7684\u5340\u5225\u662f\uff0c\u5728\u5916\u89c0\u4e0a\uff0c\u986f\u793a\u7684\u8cc7\u8a0a\u4e0d\u662f\u4ee5\u932f\u8aa4\u7684\u5f62\u5f0f\u51fa\u73fe\u3002 \u7570\u5e38\u56de\u61c9 \u00b6 \u6709\u6642\u6709\u5fc5\u8981\u4e2d\u65b7 Controller \u7a0b\u5f0f\u78bc\u7684\u6b63\u5e38\u6d41\u7a0b\uff0c\u4e26\u7528\u7570\u5e38\u56de\u61c9\u4f86\u4ee3\u66ff\u3002 \u7570\u5e38\u56de\u61c9\u4e0d\u4e00\u5b9a\u4ee3\u8868\u4e00\u500b\u932f\u8aa4\uff1b\u4f8b\u5982\uff0c\u5b83\u5011\u53ef\u4ee5\u7528\u4f86\u5f37\u5236 Controller \u57f7\u884c\u4e00\u500b\u91cd\u65b0\u5c0e\u5411\u3002 \u7136\u800c\uff0c\u901a\u5e38\u60c5\u6cc1\u4e0b\uff0c\u5b83\u5011\u901a\u5e38\u6703\u88ab\u7528\u4f86\u4e2d\u65b7 Controller \u7684\u6d41\u7a0b\u4ee5\u986f\u793a\u4e00\u500b\u932f\u8aa4\uff0c\u5c31\u50cf\u4e0b\u9762\u7684\u4f8b\u5b50\u4e00\u6a23\uff1a public function actionException() { throw $this->exception($this->error('\u767c\u751f\u610f\u5916\u932f\u8aa4')); } \u7570\u5e38\u56de\u61c9\u53ea\u63a5\u53d7\u4e00\u500b\u53c3\u6578\uff0c\u5be6\u969b\u4e0a\u9019\u500b\u53c3\u6578\u5fc5\u9808\u662f\u5176\u4ed6\u5f62\u5f0f\u7684 Reply \u7269\u4ef6\uff0c\u6bd4\u5982 \u932f\u8aa4\u56de\u61c9 \u3002 \u9019\u500b\u7279\u6b8a\u7684\u4f8b\u5b50\u6703\u62cb\u51fa\u4e00\u500b\u7570\u5e38\uff0c\u6b64\u6642\u6574\u500b\u63a7\u5236\u5668\u7684\u7a0b\u5f0f\u78bc\u6703\u505c\u6b62\uff0c\u4e26\u986f\u793a\u4e00\u500b\u6a19\u6e96\u7684\u932f\u8aa4\u3002 \u8acb\u6ce8\u610f\uff0c\u7570\u5e38\u56de\u61c9\u5fc5\u9808\u7528 throw \u4f86 \"\u62cb\u51fa\"\uff0c\u800c\u4e0d\u662f\u7528 return \u4f86 \"\u8fd4\u56de\"\u3002 \u91cd\u5b9a\u8def\u7531\u56de\u61c9 \u00b6 \u5728\u67d0\u4e9b\u60c5\u6cc1\u4e0b\uff0c\u9700\u8981\u5c07\u7528\u6236\u91cd\u65b0\u5c0e\u5411\u5230\u4e00\u500b\u5b8c\u5168\u4e0d\u540c\u7684 Controller \u6216\u540c\u4e00 Controller \u5167\u7684 action\uff0c\u800c\u4e0d\u9700\u8981\u57f7\u884c\u5b8c\u5168\u7684\u91cd\u65b0\u5c0e\u5411\uff0c\u4e0d\u9700\u8981\u6539\u8b8a\u7528\u6236\u767b\u9678\u7684 URL\uff0c\u4e5f\u4e0d\u9700\u8981\u91cd\u8907\u76ee\u6a19 action \u7684\u7a0b\u5f0f\u78bc\u3002 \u9019\u770b\u8d77\u4f86\u6709\u9ede\u50cf\u9019\u6a23\uff1a public function actionReroute() { return $this->rerouteController(__CLASS__, 'error'); } public function actionError() { return $this->error('\u7cdf\u4e86\uff01\u51fa\u4e86\u9ede\u554f\u984c\uff01'); } \u5728\u9019\u500b\u7279\u6b8a\u7684\u4f8b\u5b50\u4e2d\uff0c\u5982\u679c\u7528\u6236\u5c0e\u89bd\u5230 index.php?demo/reroute URL\uff0c\u4ed6\u5011\u6703\u770b\u5230 actionError() \u65b9\u6cd5\u7684\u932f\u8aa4\u56de\u61c9\u3002 \u4ed6\u5011\u4e0d\u6703\u88ab\u91cd\u65b0\u5c0e\u5411\uff0c\u700f\u89bd\u5668\u4e2d\u7684 URL \u4e5f\u4e0d\u6703\u6539\u8b8a\uff0c\u4ed6\u5011\u53ea\u662f\u6536\u5230\u932f\u8aa4 action \u7684\u56de\u61c9\u3002 \u91cd\u5b9a\u8def\u7531\u56de\u61c9\u9084\u652f\u6301\u7b2c\u4e09\u500b\u53c3\u6578\uff0c\u5b83\u5141\u8a31\u5c07\u5404\u7a2e\u53c3\u6578\u5f9e\u4e00\u500b Controller action \u50b3\u905e\u5230\u53e6\u4e00\u500b Controller\u3002 \u9019\u53ef\u4ee5\u662f\u4e00\u500b\u9663\u5217\u6216\u4e00\u500b ParameterBag \u7269\u4ef6\uff08\u7a0d\u5f8c\u5c07\u8a73\u7d30\u4ecb\u7d39\uff09\u3002 \u4fee\u6539 Controller Action \u56de\u61c9 \uff08properly\uff09 \u00b6 \u5728 \u7e7c\u627f class \u7ae0\u7bc0\u4e2d\uff0c\u6211\u5011\u5df2\u7d93\u770b\u5230\u4e86\u7e7c\u627f\u4e00\u500b class \u662f\u591a\u9ebc\u7684\u7c21\u55ae\uff0c\u4f46\u662f\u7576\u7e7c\u627f\u4e00\u500b\u5df2\u7d93\u5b58\u5728\u7684 Controller action \u6642\uff0c\u9700\u8981\u683c\u5916\u5c0f\u5fc3\u3002 \u9664\u975e\u4f60\u6709\u7279\u6b8a\u7684\u9700\u6c42\uff0c\u9700\u8981\u5b8c\u5168\u8986\u84cb\u4e00\u500b\u73fe\u6709\u7684 action\uff0c\u4e26\u7528\u65b0\u7684\u6771\u897f\u4f86\u4ee3\u66ff\u5b83\uff08\u4e00\u822c\u4e0d\u5efa\u8b70\u9019\u6a23\u505a\uff09\uff0c\u5426\u5247\u4f60\u61c9\u8a72\u4fee\u6539\u7236\u985e\u7684\u73fe\u6709\u56de\u61c9\u3002 \u9019\u975e\u5e38\u7c21\u55ae\uff0c\u8209\u500b\u4f8b\u5b50\uff0c\u8b93\u6211\u5011\u4fee\u6539\u4e0a\u9762 view \u56de\u61c9 \u4f8b\u5b50\u4e2d\u7684 view \u56de\u61c9\u3002 public function actionExample() { $reply = parent::actionExample(); return $reply; } \u5047\u8a2d\u4e0a\u9762\u7684\u5167\u5bb9\u88ab\u6dfb\u52a0\u5230\u4e00\u500b\u5df2\u7d93\u5b58\u5728 actionExample() \u65b9\u6cd5\u7684\u7e7c\u627f Controller \u4e2d\uff0c\u4e0a\u9762\u7684\u5167\u5bb9\u9664\u4e86\u8fd4\u56de\u539f\u4f86\u7684 view \u56de\u61c9\u5916\uff0c\u5be6\u969b\u4e0a\u4e26\u6c92\u6709\u505a\u4efb\u4f55\u4e8b\u60c5\u3002 \u73fe\u5728\u8b93\u6211\u5011\u628a\u73fe\u6709\u7684 hello \u53c3\u6578\u6539\u70ba \"Bonjour\" \u800c\u4e0d\u662f \"Hello\"\u3002 public function actionExample() { $reply = parent::actionExample(); if ($reply instanceof \\XF\\Mvc\\Reply\\View) { $reply->setParam('hello', 'Bonjour'); } return $reply; } \u56e0\u70ba\u4e00\u500b Controller \u56de\u61c9\u5be6\u969b\u4e0a\u53ef\u4ee5\u4ee3\u8868\u8a31\u591a\u4e0d\u540c\u7684\u7269\u4ef6\uff0c\u9019\u4e9b\u7269\u4ef6\u5177\u6709\u4e0d\u540c\u7684\u884c\u70ba\u548c\u65b9\u6cd5\uff0c\u6240\u4ee5\u6211\u5011\u5fc5\u9808\u53ea\u5617\u8a66\u7e7c\u627f\u6b63\u78ba\u7684\u56de\u61c9\u985e\u578b\u3002 \u5728\u4e0a\u9762\u7684\u4f8b\u5b50\u4e2d\uff0c\u6211\u5011\u901a\u904e\u6aa2\u67e5\u7236 $reply \u7269\u4ef6\u662f\u5426\u771f\u7684\u662f View \u985e\u578b\u4f86\u505a\u5230\u9019\u4e00\u9ede\u3002 \u5982\u679c\u6211\u5011\u6c92\u6709\u9019\u6a23\u505a\uff0c\u6211\u5011\u7e7c\u627f\u4e86\u9019\u500b action\uff0c\u800c Controller action \u537b\u7528\u91cd\u65b0\u5c0e\u5411\u4f86\u56de\u61c9\uff0c\u90a3\u9ebc\u5f88\u53ef\u80fd\u6703\u51fa\u73fe\u932f\u8aa4\u3002 \u5728\u7e7c\u627f\u9019\u500b\u52d5\u4f5c\u4e4b\u524d\uff0c\u8a2a\u554f\u9019\u500b\u9801\u9762\u6703\u986f\u793a \"Hello world\uff01\"\u3002 \u7e7c\u627f\u5f8c\uff0c\u73fe\u5728 view \u5c07\u986f\u793a \"Bonjour world\uff01\"\u3002","title":"\u63a7\u5236\u5668\u57fa\u790e\u77e5\u8b58"},{"location":"controller-basics/#_1","text":"\u5728\u57fa\u672c\u5c64\u9762\u4e0a\uff0cController \u662f\u7576\u4f60\u5728 XF \u4e2d\u8a2a\u554f\u4e00\u500b\u9801\u9762\u6642\u57f7\u884c\u7684\u7a0b\u5f0f\u78bc\u3002 \u5728\u57fa\u672c\u5c64\u9762\u4e0a\uff0cController \u4e00\u822c\u8ca0\u8cac\u8655\u7406\u7528\u6236\u7684\u8f38\u5165\uff0c\u4e26\u5c07\u7528\u6236\u7684\u8f38\u5165\u50b3\u905e\u5230\u9069\u7576\u7684\u5730\u65b9\uff0c\u901a\u5e38\u662f\u57f7\u884c\u67d0\u7a2e\u8cc7\u6599\u5eab\u64cd\u4f5c\uff08Model\uff09\u6216\u8f09\u5165\u8996\u89ba\u5316\u5167\u5bb9\uff08View\uff09\u3002 \u7576\u7528\u6236\u9ede\u9078\u9023\u7d50\u6642\uff0c\u8acb\u6c42\u7684 URL \u6703\u88ab\u8def\u7531\u5c0e\u5230\u7279\u5b9a\u7684 Controller \u548c Controller action\u3002 \u53c3\u898b \u8def\u7531\u57fa\u790e\u77e5\u8b58 \u3002 \u4f8b\u5982\uff0c\u5728 XF \u4e2d\uff0c\u5982\u679c\u4f60\u9ede\u9078\u4e00\u500b\u985e\u4f3c\u65bc index.php?conversations/add \u7684 URL\uff0c\u4f60\u5c07\u88ab\u8def\u7531\u5c0e\u5230 XF\\Pub\\Controller\\Conversation Controller \u548c add action\u3002 \u5982\u679c\u4f60\u5728\u6a94\u6848\u7cfb\u7d71\u4e2d\u67e5\u770b\u9019\u500b class\uff08\u53c3\u898b \u81ea\u52d5\u8f09\u5165\u5668 \uff0c\u4ee5\u4e86\u89e3 class \u548c\u6a94\u6848\u8def\u5f91\u5982\u4f55\u76f8\u4e92\u6620\u5c04\u7684\u63cf\u8ff0\uff09\uff0c\u4f60\u6703\u6ce8\u610f\u5230\u6709\u8a31\u591a\u65b9\u6cd5\u4ee5 action \u70ba\u524d\u7db4\u547d\u540d\u3002 \u6240\u6709\u9019\u4e9b\u65b9\u6cd5\u90fd\u8868\u793a\u4e00\u500b\u7279\u5b9a\u7684 Controller action\u3002 \u6240\u4ee5\uff0c\u8981\u60f3\u5728\u67e5\u770b\u4e0a\u9762\u63d0\u5230\u7684 conversations/add \u9801\u9762\u6642\u770b\u5230\u76f8\u95dc\u7a0b\u5f0f\u78bc\uff0c\u8acb\u5728\u9019\u500b\u6a94\u6848\u4e2d\u67e5\u8a62 public function actionAdd() \u3002 XF Controller \u8ca0\u8cac\u8fd4\u56de\u4e00\u500b reply \u7269\u4ef6\uff0c\u8a72\u7269\u4ef6\u4e00\u822c\u5305\u62ec\u4ee5\u4e0b\u985e\u578b\u4e4b\u4e00\uff1a","title":"\u63a7\u5236\u5668\u57fa\u790e\u77e5\u8b58"},{"location":"controller-basics/#view","text":"\u9019\u662f XF \u958b\u767c\u904e\u7a0b\u4e2d\u6700\u5e38\u898b\u7684\u56de\u61c9\u4e4b\u4e00\u3002 \u4e00\u500b\u8fd4\u56de View \u56de\u61c9\u7684 Controller \u901a\u5e38\u9700\u8981\u50b3\u905e\u591a\u9054\u4e09\u500b\u53c3\u6578\u3002 \u4e00\u500b View class (\u4e0b\u9762\u6703\u6709\u66f4\u591a\u7684\u4ecb\u7d39)\uff0c\u4e00\u500b\u6a21\u677f\u540d\u7a31\uff0c\u4ee5\u53ca\u4e00\u500b\u7531 $viewParams \u7d44\u6210\u7684\u9663\u5217\uff0c\u9019\u500b\u9663\u5217\u662f\u6a21\u677f\u61c9\u8a72\u6709\u7684\u8cc7\u6599\u3002 \u9019\u88e1\u662f\u4e00\u500b\u5178\u578b\u7684 Controller action \u7684\u4f8b\u5b50\uff0c\u5b83\u8fd4\u56de\u4e00\u500b View \u56de\u61c9\uff1a public function actionExample() { $hello = 'Hello'; $world = 'world!'; $viewParams = [ 'hello' => $hello, 'world' => $world ]; return $this->view('Demo:Example', 'demo_example', $viewParams); } \u7b2c\u4e00\u500b\u53c3\u6578\u662f\u4e00\u500b\u7279\u5b9a View class \u7684\u7c21\u77ed class \u540d\u3002 \u9019\u500b class \u53ef\u80fd\u5b58\u5728\uff0c\u4e5f\u53ef\u80fd\u4e0d\u5b58\u5728\uff08\u901a\u5e38\u60c5\u6cc1\u4e0b\uff0c\u5b83\u4e0d\u9700\u8981\u5b58\u5728\uff0c\u6211\u5011\u5728\u5f8c\u9762\u6703\u4ecb\u7d39\u66f4\u591a\u5730 View class \uff09\uff0c\u4f46\u5b83\u61c9\u8a72\u6709\u4e00\u500b Controller \u548c action \u7684\u5927\u81f4\u552f\u4e00\u540d\u7a31\u3002 \u8207\u5176\u4ed6 \u77ed\u985e\u540d \u4e00\u6a23\uff0c\u4e0a\u9762\u7684\u7279\u5b9a\u77ed\u985e\u540d\u5c07\u89e3\u6790\u70ba Demo/Pub/View/Example \u3002 \u540c\u6a23\uff0c Pub \u662f\u7531 Controller \u985e\u578b\u81ea\u52d5\u63a8\u65b7\u51fa\u4f86\u7684\u3002 \u7b2c\u4e8c\u500b\u53c3\u6578\u662f\u6a21\u677f\u540d\u7a31\u3002 \u5728\u672c\u4f8b\u4e2d\uff0c\u6211\u5011\u6b63\u5728\u5c0b\u627e\u4e00\u500b\u540d\u70ba demo_example \u7684\u6a21\u677f\u3002 \u7b2c\u4e09\u500b\u53c3\u6578\u662f \u61c9\u8a72\u63d0\u4f9b\u7d66 view \u6a21\u677f \u53c3\u6578/\u503c \u7684\u9663\u5217\u3002 \u9019\u500b\u9663\u5217\u4e00\u822c\u61c9\u8a72\u662f\u4e00\u5c0d key => value \u3002 \u4e0a\u9762\u7684\u4f8b\u5b50\u662f\u5c07\u5169\u500b\u6a21\u677f\u53c3\u6578\u50b3\u905e\u7d66\u6a21\u677f\u3002 \u9663\u5217\u4e2d\u7684 key \u90e8\u5206\u8868\u793a\u6a21\u677f\u4e2d\u53ef\u7528\u7684\u8b8a\u6578\u540d\u7a31\u3002 \u9663\u5217\u4e2d\u7684 value \u90e8\u5206\u8868\u793a\u503c\u3002 \u56e0\u6b64\uff0c\u5982\u679c\u6211\u5011\u5728 demo_example \u6a21\u677f\u4e2d\u6709\u4ee5\u4e0b\u5167\u5bb9\uff1a {$hello} {$world} \u8a72\u6a21\u677f\u5c07\u8f38\u51fa\u4ee5\u4e0b\u5167\u5bb9\uff1a Hello world!","title":"View \u56de\u61c9"},{"location":"controller-basics/#_2","text":"\u7576\u4f60\u5e0c\u671b\u5728\u7528\u6236\u5b8c\u6210\u67d0\u7a2e\u64cd\u4f5c\u5f8c\u5c07\u5176\u91cd\u65b0\u5c0e\u5411\u5230\u4e0d\u540c\u7684 URL \u6642\uff0c\u6703\u8fd4\u56de\u9019\u500b\u56de\u61c9\u3002 \u4e00\u500b\u5e38\u898b\u7684\u4f7f\u7528\u6848\u4f8b\u662f\u5728\u7528\u6236\u901a\u904e\u8868\u55ae\u63d0\u4ea4\u8cc7\u6599\u5f8c\uff0c\u4f60\u53ef\u80fd\u5e0c\u671b\u5c07\u4ed6\u5011\u91cd\u65b0\u5c0e\u5411\u5230\u4e0d\u540c\u7684\u9801\u9762\uff0c\u4f8b\u5982\u5c07\u7528\u6236\u8fd4\u56de\u5230\u4e00\u500b\u9805\u76ee\u6e05\u55ae\u3002 \u4e0b\u9762\u662f\u4e00\u500b\u5178\u578b\u7684 Controller action \u7684\u4f8b\u5b50\uff0c\u5b83\u57f7\u884c\u4e86\u4e00\u500b\u91cd\u65b0\u5c0e\u5411\uff1a public function actionRedirect() { return $this->redirect($this->buildLink('demo/example'), '\u9019\u662f\u4e00\u500b\u91cd\u5b9a\u5411\u8cc7\u8a0a\u3002', 'permanent'); } \u7b2c\u4e00\u500b\u53c3\u6578\u662f\u8981\u91cd\u65b0\u5c0e\u5411\u7684 URL\u3002 \u9019\u500b\u4f8b\u5b50\u5c07\u628a\u7528\u6236\u91cd\u65b0\u5c0e\u5411\u5230 index.php?demo/example \u7684 URL\u3002 \u7b2c\u4e8c\u500b\u53c3\u6578\u53ea\u6709\u5728\u8868\u55ae\u901a\u904e AJAX \u8acb\u6c42\u63d0\u4ea4\u6642\u624d\u6703\u986f\u793a\uff0cAJAX \u8acb\u6c42\u9078\u64c7\u9632\u6b62\u91cd\u65b0\u5c0e\u5411\u3002 \u7d50\u679c\u5c07\u662f\u4e00\u500b \"\u5373\u6642\u8a0a\u606f\"\uff0c\u5f9e\u87a2\u5e55\u9802\u90e8\u51fa\u73fe\u60a8\u9078\u64c7\u7684\u8a0a\u606f\u3002 \u60a8\u4e0d\u5fc5\u63d0\u4f9b\u60a8\u81ea\u5df1\u7684\u8cc7\u8a0a\u3002 \u5982\u679c\u6c92\u6709\u63d0\u4f9b\uff0c\u5b83\u5c07\u9810\u8a2d\u70ba \"\u60a8\u7684\u66f4\u6539\u5df2\u88ab\u5132\u5b58\"\u3002 \u7b2c\u4e09\u500b\u53c3\u6578\u9810\u8a2d\u70ba temporary \uff0c\u4f46\u4f60\u4e5f\u53ef\u4ee5\u9078\u64c7\u5c07\u5176\u8a2d\u5b9a\u70ba permanent\uff0c\u5c31\u50cf\u672c\u4f8b\u4e00\u6a23\u3002 \u9019\u88e1\u552f\u4e00\u7684\u5340\u5225\u662f\u4f3a\u670d\u5668\u63d0\u4f9b\u7684 HTTP \u56de\u61c9\u78bc\u7684\u985e\u578b\u3002 \u5728\u5927\u591a\u6578\u60c5\u6cc1\u4e0b\uff0c\u81e8\u6642\u662f\u7406\u60f3\u7684\uff0c\u9019\u5c07\u4ee5 303 \u78bc\u56de\u61c9\u3002 permanent \u5c07\u767c\u51fa 301 \u56de\u61c9\u78bc\u3002 \u96d6\u7136\u4f60\u53ef\u4ee5\u901a\u904e\u9019\u7a2e\u65b9\u5f0f\u89f8\u767c\u4e00\u500b permanent \u91cd\u65b0\u5c0e\u5411\uff0c\u4f46\u5be6\u969b\u4e0a\u6709\u4e00\u500b\u7279\u5b9a\u7684\u65b9\u6cd5\uff0c\u53ef\u4ee5\u4f7f\u7528\u5982\u4e0b\u3002 \u5b83\u4e5f\u9700\u8981\u4e00\u500b 'message' \u53c3\u6578\uff0c\u4f46\u548c\u4e0a\u9762\u4e00\u6a23\uff0c\u5b83\u662f\u53ef\u9078\u7684\u3002 public function actionRedirect() { return $this->redirectPermanently($this->buildLink('demo/example')); }","title":"\u91cd\u65b0\u5c0e\u5411\u56de\u61c9"},{"location":"controller-basics/#_3","text":"\u9867\u540d\u601d\u7fa9\uff0c\u9019\u500b\u56de\u61c9\u5c31\u662f\u4f60\u9700\u8981\u5411\u7528\u6236\u986f\u793a\u932f\u8aa4\u6642\u8fd4\u56de\u7684\u5167\u5bb9\u3002 \u9019\u7a0d\u7a0d\u7c21\u55ae\uff0c\u4e0b\u9762\u662f\u4e00\u500b\u4f8b\u5b50\uff1a public function actionError() { return $this->error('\u5f88\u4e0d\u5e78\uff0c\u4f60\u8981\u627e\u7684\u6771\u897f\u7121\u6cd5\u627e\u5230\u3002', 404); } \u9019\u88e1\u53ea\u652f\u63f4\u5169\u500b\u53c3\u6578\u3002 \u7b2c\u4e00\u500b\u662f\u4f60\u60f3\u986f\u793a\u7684\u932f\u8aa4\u8cc7\u8a0a\uff0c\u7b2c\u4e8c\u500b\u662f\u4f60\u60f3\u8b93\u4f3a\u670d\u5668\u767c\u9001\u7684 HTTP \u56de\u61c9\u78bc\u3002 404 \u5c07\u4ee3\u8868\u5728\u6c92\u6709\u627e\u5230\u6771\u897f\u6642\u7684\u9069\u7576\u56de\u61c9\u3002","title":"\u932f\u8aa4\u56de\u61c9"},{"location":"controller-basics/#_4","text":"\u9019\u500b\u56de\u61c9\u8207\u932f\u8aa4\u56de\u61c9\u975e\u5e38\u76f8\u4f3c\uff0c\u652f\u63f4\u76f8\u540c\u7684\u53c3\u6578\u3002 \u4e3b\u8981\u7684\u5340\u5225\u662f\uff0c\u5728\u5916\u89c0\u4e0a\uff0c\u986f\u793a\u7684\u8cc7\u8a0a\u4e0d\u662f\u4ee5\u932f\u8aa4\u7684\u5f62\u5f0f\u51fa\u73fe\u3002","title":"\u8a0a\u606f\u56de\u61c9"},{"location":"controller-basics/#_5","text":"\u6709\u6642\u6709\u5fc5\u8981\u4e2d\u65b7 Controller \u7a0b\u5f0f\u78bc\u7684\u6b63\u5e38\u6d41\u7a0b\uff0c\u4e26\u7528\u7570\u5e38\u56de\u61c9\u4f86\u4ee3\u66ff\u3002 \u7570\u5e38\u56de\u61c9\u4e0d\u4e00\u5b9a\u4ee3\u8868\u4e00\u500b\u932f\u8aa4\uff1b\u4f8b\u5982\uff0c\u5b83\u5011\u53ef\u4ee5\u7528\u4f86\u5f37\u5236 Controller \u57f7\u884c\u4e00\u500b\u91cd\u65b0\u5c0e\u5411\u3002 \u7136\u800c\uff0c\u901a\u5e38\u60c5\u6cc1\u4e0b\uff0c\u5b83\u5011\u901a\u5e38\u6703\u88ab\u7528\u4f86\u4e2d\u65b7 Controller \u7684\u6d41\u7a0b\u4ee5\u986f\u793a\u4e00\u500b\u932f\u8aa4\uff0c\u5c31\u50cf\u4e0b\u9762\u7684\u4f8b\u5b50\u4e00\u6a23\uff1a public function actionException() { throw $this->exception($this->error('\u767c\u751f\u610f\u5916\u932f\u8aa4')); } \u7570\u5e38\u56de\u61c9\u53ea\u63a5\u53d7\u4e00\u500b\u53c3\u6578\uff0c\u5be6\u969b\u4e0a\u9019\u500b\u53c3\u6578\u5fc5\u9808\u662f\u5176\u4ed6\u5f62\u5f0f\u7684 Reply \u7269\u4ef6\uff0c\u6bd4\u5982 \u932f\u8aa4\u56de\u61c9 \u3002 \u9019\u500b\u7279\u6b8a\u7684\u4f8b\u5b50\u6703\u62cb\u51fa\u4e00\u500b\u7570\u5e38\uff0c\u6b64\u6642\u6574\u500b\u63a7\u5236\u5668\u7684\u7a0b\u5f0f\u78bc\u6703\u505c\u6b62\uff0c\u4e26\u986f\u793a\u4e00\u500b\u6a19\u6e96\u7684\u932f\u8aa4\u3002 \u8acb\u6ce8\u610f\uff0c\u7570\u5e38\u56de\u61c9\u5fc5\u9808\u7528 throw \u4f86 \"\u62cb\u51fa\"\uff0c\u800c\u4e0d\u662f\u7528 return \u4f86 \"\u8fd4\u56de\"\u3002","title":"\u7570\u5e38\u56de\u61c9"},{"location":"controller-basics/#_6","text":"\u5728\u67d0\u4e9b\u60c5\u6cc1\u4e0b\uff0c\u9700\u8981\u5c07\u7528\u6236\u91cd\u65b0\u5c0e\u5411\u5230\u4e00\u500b\u5b8c\u5168\u4e0d\u540c\u7684 Controller \u6216\u540c\u4e00 Controller \u5167\u7684 action\uff0c\u800c\u4e0d\u9700\u8981\u57f7\u884c\u5b8c\u5168\u7684\u91cd\u65b0\u5c0e\u5411\uff0c\u4e0d\u9700\u8981\u6539\u8b8a\u7528\u6236\u767b\u9678\u7684 URL\uff0c\u4e5f\u4e0d\u9700\u8981\u91cd\u8907\u76ee\u6a19 action \u7684\u7a0b\u5f0f\u78bc\u3002 \u9019\u770b\u8d77\u4f86\u6709\u9ede\u50cf\u9019\u6a23\uff1a public function actionReroute() { return $this->rerouteController(__CLASS__, 'error'); } public function actionError() { return $this->error('\u7cdf\u4e86\uff01\u51fa\u4e86\u9ede\u554f\u984c\uff01'); } \u5728\u9019\u500b\u7279\u6b8a\u7684\u4f8b\u5b50\u4e2d\uff0c\u5982\u679c\u7528\u6236\u5c0e\u89bd\u5230 index.php?demo/reroute URL\uff0c\u4ed6\u5011\u6703\u770b\u5230 actionError() \u65b9\u6cd5\u7684\u932f\u8aa4\u56de\u61c9\u3002 \u4ed6\u5011\u4e0d\u6703\u88ab\u91cd\u65b0\u5c0e\u5411\uff0c\u700f\u89bd\u5668\u4e2d\u7684 URL \u4e5f\u4e0d\u6703\u6539\u8b8a\uff0c\u4ed6\u5011\u53ea\u662f\u6536\u5230\u932f\u8aa4 action \u7684\u56de\u61c9\u3002 \u91cd\u5b9a\u8def\u7531\u56de\u61c9\u9084\u652f\u6301\u7b2c\u4e09\u500b\u53c3\u6578\uff0c\u5b83\u5141\u8a31\u5c07\u5404\u7a2e\u53c3\u6578\u5f9e\u4e00\u500b Controller action \u50b3\u905e\u5230\u53e6\u4e00\u500b Controller\u3002 \u9019\u53ef\u4ee5\u662f\u4e00\u500b\u9663\u5217\u6216\u4e00\u500b ParameterBag \u7269\u4ef6\uff08\u7a0d\u5f8c\u5c07\u8a73\u7d30\u4ecb\u7d39\uff09\u3002","title":"\u91cd\u5b9a\u8def\u7531\u56de\u61c9"},{"location":"controller-basics/#controller-action-properly","text":"\u5728 \u7e7c\u627f class \u7ae0\u7bc0\u4e2d\uff0c\u6211\u5011\u5df2\u7d93\u770b\u5230\u4e86\u7e7c\u627f\u4e00\u500b class \u662f\u591a\u9ebc\u7684\u7c21\u55ae\uff0c\u4f46\u662f\u7576\u7e7c\u627f\u4e00\u500b\u5df2\u7d93\u5b58\u5728\u7684 Controller action \u6642\uff0c\u9700\u8981\u683c\u5916\u5c0f\u5fc3\u3002 \u9664\u975e\u4f60\u6709\u7279\u6b8a\u7684\u9700\u6c42\uff0c\u9700\u8981\u5b8c\u5168\u8986\u84cb\u4e00\u500b\u73fe\u6709\u7684 action\uff0c\u4e26\u7528\u65b0\u7684\u6771\u897f\u4f86\u4ee3\u66ff\u5b83\uff08\u4e00\u822c\u4e0d\u5efa\u8b70\u9019\u6a23\u505a\uff09\uff0c\u5426\u5247\u4f60\u61c9\u8a72\u4fee\u6539\u7236\u985e\u7684\u73fe\u6709\u56de\u61c9\u3002 \u9019\u975e\u5e38\u7c21\u55ae\uff0c\u8209\u500b\u4f8b\u5b50\uff0c\u8b93\u6211\u5011\u4fee\u6539\u4e0a\u9762 view \u56de\u61c9 \u4f8b\u5b50\u4e2d\u7684 view \u56de\u61c9\u3002 public function actionExample() { $reply = parent::actionExample(); return $reply; } \u5047\u8a2d\u4e0a\u9762\u7684\u5167\u5bb9\u88ab\u6dfb\u52a0\u5230\u4e00\u500b\u5df2\u7d93\u5b58\u5728 actionExample() \u65b9\u6cd5\u7684\u7e7c\u627f Controller \u4e2d\uff0c\u4e0a\u9762\u7684\u5167\u5bb9\u9664\u4e86\u8fd4\u56de\u539f\u4f86\u7684 view \u56de\u61c9\u5916\uff0c\u5be6\u969b\u4e0a\u4e26\u6c92\u6709\u505a\u4efb\u4f55\u4e8b\u60c5\u3002 \u73fe\u5728\u8b93\u6211\u5011\u628a\u73fe\u6709\u7684 hello \u53c3\u6578\u6539\u70ba \"Bonjour\" \u800c\u4e0d\u662f \"Hello\"\u3002 public function actionExample() { $reply = parent::actionExample(); if ($reply instanceof \\XF\\Mvc\\Reply\\View) { $reply->setParam('hello', 'Bonjour'); } return $reply; } \u56e0\u70ba\u4e00\u500b Controller \u56de\u61c9\u5be6\u969b\u4e0a\u53ef\u4ee5\u4ee3\u8868\u8a31\u591a\u4e0d\u540c\u7684\u7269\u4ef6\uff0c\u9019\u4e9b\u7269\u4ef6\u5177\u6709\u4e0d\u540c\u7684\u884c\u70ba\u548c\u65b9\u6cd5\uff0c\u6240\u4ee5\u6211\u5011\u5fc5\u9808\u53ea\u5617\u8a66\u7e7c\u627f\u6b63\u78ba\u7684\u56de\u61c9\u985e\u578b\u3002 \u5728\u4e0a\u9762\u7684\u4f8b\u5b50\u4e2d\uff0c\u6211\u5011\u901a\u904e\u6aa2\u67e5\u7236 $reply \u7269\u4ef6\u662f\u5426\u771f\u7684\u662f View \u985e\u578b\u4f86\u505a\u5230\u9019\u4e00\u9ede\u3002 \u5982\u679c\u6211\u5011\u6c92\u6709\u9019\u6a23\u505a\uff0c\u6211\u5011\u7e7c\u627f\u4e86\u9019\u500b action\uff0c\u800c Controller action \u537b\u7528\u91cd\u65b0\u5c0e\u5411\u4f86\u56de\u61c9\uff0c\u90a3\u9ebc\u5f88\u53ef\u80fd\u6703\u51fa\u73fe\u932f\u8aa4\u3002 \u5728\u7e7c\u627f\u9019\u500b\u52d5\u4f5c\u4e4b\u524d\uff0c\u8a2a\u554f\u9019\u500b\u9801\u9762\u6703\u986f\u793a \"Hello world\uff01\"\u3002 \u7e7c\u627f\u5f8c\uff0c\u73fe\u5728 view \u5c07\u986f\u793a \"Bonjour world\uff01\"\u3002","title":"\u4fee\u6539 Controller Action \u56de\u61c9 \uff08properly\uff09"},{"location":"criteria/","text":"\u6e96\u5247 \u00b6 \u7576 XenForo \u9700\u8981\u6839\u64da\u4e00\u4e9b \u7528\u6236\u9078\u64c7\u7684 \u689d\u4ef6\uff08\u6e96\u5247\uff09\u4f86\u6e2c\u8a66\u67d0\u4e9b\u6771\u897f\uff08\u7528\u6236/\u9801\u9762/\u5e16\u5b50......\uff09\u6642\uff0c\u5b83\u4f7f\u7528\u6e96\u5247\u7cfb\u7d71\u3002 \u4f7f\u7528\u5230\u6e96\u5247\u7cfb\u7d71\u7684\u4e00\u4e9b\u5730\u65b9\uff1a \u6210\u5c31 \u7528\u6236\u7d44\u63d0\u5347 \u8ad6\u58c7\u516c\u544a \u9644\u52a0\u5143\u4ef6\u4e5f\u53ef\u4ee5\u4f7f\u7528\u9019\u500b\u7cfb\u7d71\u3002 \u6e96\u5247\u985e\u578b \u00b6 \u8003\u616e\u4ee5\u4e0b\u6e96\u5247\uff1a - \u7528\u6236 \u6709/\u6c92\u6709 \u982d\u50cf - \u7528\u6236\u6709 300 \u591a\u689d\u7559\u8a00 - \u7528\u6236\u6b63\u5728\u5efa\u7acb\u4e00\u500b\u4e3b\u984c - \u76ee\u524d\u7528\u6236\u9078\u64c7\u7684\u5c0e\u89bd\u6a19\u7c64\u70ba \"\u6703\u54e1\" \u524d\u5169\u500b\u6e96\u5247\u662f\u6307\u7528\u6236\u672c\u4eba\u3002 \u5176\u9918\u7684\u6e96\u5247\u662f\u6307\u4ed6\u76ee\u524d\u5728\u8ad6\u58c7\u4e0a\u7684\u4f4d\u7f6e\u3002 \u9019\u6a23\u770b\u8d77\u4f86\u6211\u5011\u61c9\u8a72\u6709\u4e0d\u540c\u985e\u5225\u6216 \u985e\u578b \u7684\u6e96\u5247\u3002 \u5728 XenForo \u4e2d\uff0c\u6709\u5169\u7a2e\u958b\u7bb1\u5373\u7528\u7684\u6e96\u5247\u985e\u578b\uff1a \u7528\u6236\u6e96\u5247 \u2014 \u8655\u7406\u95dc\u65bc\u7528\u6236\u672c\u8eab\u7684\u6e96\u5247 \u9801\u9762\u6e96\u5247 \u2014 \u8655\u7406\u7528\u6236\u76ee\u524d\u4f4d\u7f6e\u7684\u6e96\u5247 + \u6642\u9593\u6e96\u5247 \u4e00\u4e9b\u9644\u52a0\u5143\u4ef6\u4e5f\u53ef\u4ee5\u65b0\u589e\u81ea\u5df1\u7684\u6e96\u5247\u985e\u578b\u3002 \u5f9e\u7a0b\u5f0f\u78bc\u7684\u89d2\u5ea6\u4f86\u770b\uff0c\u6e96\u5247\u985e\u578b\u53ea\u662f\u4e00\u500b\u62bd\u50cf\u985e AbstractCriteria \u7684\u5b50\u985e\u3002 \u5b83\u5011\u5305\u542b\u7528\u65bc\u8655\u7406\u67d0\u4e9b\u985e\u578b\u7684\u9078\u5b9a\u6e96\u5247\u7a0b\u5f0f\u78bc\u3002 \u53cd\u4e4b\uff0c AbstractCriteria \u5247\u63d0\u4f9b\u4e86\u8655\u7406\u6e96\u5247\u7684\u901a\u7528\u65b9\u6cd5\uff0c\u800c\u4e0d\u8ad6\u5176\u542b\u7fa9\u5982\u4f55\u3002 \u6e96\u5247 \u00b6 \u6e96\u5247\u662f\u4e00\u500b\u7528\u6236\u53ef\u9078\u64c7\u7684\u9810\u5b9a\u7fa9\u689d\u4ef6\u3002 \u70ba\u4ec0\u9ebc\u662f\u53ef\u9078\u7684\uff1f \u56e0\u70ba\u7ba1\u7406\u54e1/\u7528\u6236\u53ef\u4ee5\u9078\u64c7\u5b83\u5011\uff08\u8a18\u5f97\u6210\u5c31\u5efa\u7acb\u904e\u7a0b\uff09\u3002 \u70ba\u4ec0\u9ebc\u662f\u9810\u5b9a\u7fa9\uff1f \u56e0\u70ba XenForo \u5df2\u7d93\u77e5\u9053\u5982\u4f55\u8655\u7406\u5b83\u5011\uff08\u4f7f\u7528\u6e96\u5247\u985e\u65b9\u6cd5\uff09\u3002 \u6bcf\u500b\u6e96\u5247\u7531\u5169\u90e8\u5206\u7d44\u6210\uff1a \u898f\u5247 \u548c\uff08\u53ef\u9078\uff09 \u8cc7\u6599 \u3002 \u898f\u5247 \u00b6 \u6e96\u5247\u898f\u5247\u7c21\u76f4\u5c31\u662f \u86c7\u5f62\u547d\u540d \u7684\u75db\u8655 (words_are_separated_with_underscore_character)\u3002 \u5b83\u6709\u5169\u500b\u57fa\u672c\u5b97\u65e8\uff1a \u5b83\u7528\u65bc\u5340\u5206\u6e96\u5247 \u5728\u9032\u884c\u5339\u914d\u6642\uff0c\u8a72\u898f\u5247\u88ab\u8f49\u63db\u70ba\u8655\u7406\u8a72\u6e96\u5247\u65b9\u6cd5\u7684 \u99dd\u5cf0\u5f0f \u547d\u540d (\u8acb\u53c3\u95b1 \"\u6e96\u5247\u5982\u4f55\u904b\u4f5c\" )\u3002 \u8cc7\u6599 \u00b6 \u5b83\u53ea\u662f\u4e00\u500b\u53ef\u9078\u7684\u9644\u52a0\u6e96\u5247\u8cc7\u6599\u9663\u5217\u3002 \u4f8b\u5982\uff0c\"\u7528\u6236\u81f3\u5c11\u767c\u4f48\u4e86 X \u689d\u7559\u8a00\" \u6e96\u5247\u6709\u4e00\u500b\u5305\u542b\u4e00\u500b\u8981\u7d20\u7684\u8cc7\u6599\u9663\u5217\uff1a\u6578\u5247\u6d88\u606f\u3002 \u6e96\u5247\u7cfb\u7d71\u5982\u4f55\u904b\u4f5c \u00b6 \u5728\u672c\u7bc0\u4e2d\uff0c\u6211\u5011\u5c07\u4ecb\u7d39\u6e96\u5247\u7cfb\u7d71\u662f\u5982\u4f55\u5f9e A \u5230 Z \u904b\u4f5c\u7684\u3002 \u6a21\u677f \u00b6 \u9019\u4e00\u5207\u90fd\u8981\u5f9e\u6a21\u677f\u7a0b\u5f0f\u78bc\u8aaa\u8d77\u3002 \u4ee5\u4e0b\u662f\u6e96\u5247\u5728\u6a21\u677f\u4e2d\u770b\u8d77\u4f86\u7684\u6a23\u5b50\uff1a <xf:checkbox label=\"Criteria container\"> <!-- \u6e96\u5247 --> <xf:option name=\"foo_criteria[criterion_1_rule][rule]\" value=\"criterion_1_rule\" ... /> <!-- \u542b\u8cc7\u6599\u7684\u6e96\u5247 --> <xf:option name=\"bar_criteria[criterion_2_rule][rule]\" value=\"criterion_2_rule\" ... > <xf:... name=\"bar_criteria[criterion_2_rule][data][param_1]\" ... /> <xf:... name=\"bar_criteria[criterion_2_rule][data][param_2]\" ... /> </xf:option> </xf:checkbox> \u5982\u4f60\u6240\u898b\uff0c\u6e96\u5247\u53ea\u662f\u4e00\u500b\u6838\u53d6\u65b9\u584a\uff0c\u88e1\u9762\u6709\u53ef\u9078\u7684\u8f38\u5165\u6b04\u4f4d\uff08\u6e96\u5247\u8cc7\u6599\uff09\u3002 \u6211\u5011\u4f86\u5206\u6790\u4e00\u4e0b\u7a0b\u5f0f\u78bc\uff1a foo_criteria \u548c bar_criteria \u662f input \u5bb9\u5668\uff0c\u901a\u5e38 foo \u548c bar \u90e8\u5206\u662f\u6307\u6e96\u5247\u985e\u578b\u3002 \u4f8b\u5982\uff0c user_criteria[...] \u8b93\u6211\u5011\u77e5\u9053\u9019\u500b\u6e96\u5247\u5c6c\u65bc\u7528\u6236\u6e96\u5247\u3002 value=\"criterion_1_rule\" \u548c value=\"criterion_2_rule\" \u986f\u7136\u662f\u6e96\u5247\u7684\u898f\u5247\u3002 Note \u8acb\u8a18\u4f4f\uff0c name \u5c6c\u6027\u4e2d\u7684 criterion_1/2_rule \u4e0d\u4e00\u5b9a\u662f\u6e96\u5247\u898f\u5247\uff01 \u9019\u4e9b\u53ea\u662f input \u5bb9\u5668\u7684\u540d\u7a31\u3002 \u4f60\u53ef\u4ee5\u8f15\u800c\u6613\u8209\u5730\u5beb\u4e0b <xf:option name=\"foo[bar][rule]\" value=\"criterion_rule\" /> \uff0c\u5b83\u5c31\u6703\u6b63\u78ba\u5730\u904b\u4f5c\u3002 \u6e96\u5247\u898f\u5247\u6703\u662f criterion_rule \uff0c\u800c\u4e0d\u662f bar \u3002 (\u53ef\u9078) \u5132\u5b58\u9078\u5b9a\u7684\u6e96\u5247 \u00b6 \u5728 Controller \u5167\u90e8\uff0c\u53ef\u4ee5\u5c07\u4e0a\u4e00\u7bc0\u7684\u6e96\u5247\u8868\u55ae\u8cc7\u6599\u9032\u884c\u7be9\u9078\u3001\u7de8\u78bc\uff0c\u4e26\u5132\u5b58\u5728 mediumblob \u985e\u578b\u7684\u8cc7\u6599\u5eab Column \u4e2d\uff0c\u4ee5\u4fbf\u66f4\u597d\u5730\u4f7f\u7528\uff1a $fooCriteriaInput = $this->filter('foo_criteria', 'array'); $barCriteriaInput = $this->filter('bar_criteria', 'array'); $form->basicEntitySave($bazEntity, [ 'foo_criteria' => $fooCriteriaInput, 'bar_criteria' => $barCriteriaInput ]); $bazEntity Structure \u793a\u4f8b\uff1a public static function getStructure(Structure $structure) { $structure->table = 'xf_baz'; $structure->shortName = 'XF:Baz'; $structure->primaryKey = 'baz_id'; $structure->columns = [ 'baz_id' => ['type' => self::UINT, 'autoIncrement' => true], 'foo_criteria' => ['type' => self::JSON_ARRAY, 'default' => [], 'required' => 'please_select_criteria_that_must_be_met'], 'bar_criteria' => ['type' => self::JSON_ARRAY, 'default' => []] ]; return $structure; } \u6e96\u5247\u7269\u4ef6 \u00b6 \u70ba\u4e86\u4f7f\u7528\u6e96\u5247\u7cfb\u7d71\uff0c\u6211\u5011\u9700\u8981\u5f9e\u9078\u5b9a\u7684\u6e96\u5247\u8868\u55ae\u8cc7\u6599\u4e2d\u5efa\u7acb\u4e00\u500b\u6e96\u5247\u7269\u4ef6\uff0c\u9019\u53ef\u4ee5\u901a\u904e app \u7684 criteria() \u65b9\u6cd5\u4f86\u5b8c\u6210\uff1a /** @var \\Qux\\Criteria\\Foo $fooCriteria */ $fooCriteria = \\XF::app()->criteria('Qux:Foo', $bazEntity->foo_criteria); /** @var \\Qux\\Criteria\\Bar $barCriteria */ $barCriteria = \\XF::app()->criteria('Qux:Bar', $bazEntity->bar_criteria); \u5f9e\u73fe\u5728\u958b\u59cb\uff0c\u6211\u5011\u53ef\u4ee5\u4f7f\u7528\u6240\u6709\u7684 AbstractCriteria \u529f\u80fd\uff0c\u52a0\u4e0a\u6211\u5011\u5728\u5b50\u985e Foo / Bar \u4e2d\u984d\u5916\u7de8\u5beb\u7684\u6240\u6709\u5167\u5bb9\u3002 \u5339\u914d \u00b6 \u7576\u6211\u5011\u60f3\u6aa2\u67e5\u67d0\u500b\u6771\u897f\uff08User\uff09\u662f\u5426\u7b26\u5408\u9078\u5b9a\u7684\u6e96\u5247\u6642\uff0c\u6211\u5011\u53ef\u4ee5\u4f7f\u7528 isMatched \u65b9\u6cd5\uff1a $visitor= \\XF::visitor(); if ($fooCriteria->isMatched($visitor)) { // \u8a2a\u5ba2\u7b26\u5408\u6240\u6709\u9078\u5b9a\u7684\u6e96\u5247 } else { // \u8a2a\u5ba2\u4e0d\u7b26\u5408\u4e00\u500b\u6216\u591a\u500b\u6e96\u5247 } isMacthed() \u5c07\u6e96\u5247\u898f\u5247\u8f49\u63db\u70ba\u5e36\u6709 _match \u524d\u7db4\u7684\u99dd\u5cf0\u5f0f\u547d\u540d\u65b9\u6cd5\uff1a criterion_1_rule > _matchCriterion1Rule \uff0c\u4e26\u5617\u8a66\u5728\u6e96\u5247\uff1a\u578b class \u4e2d\u627e\u5230\u9019\u6a23\u4e00\u500b\u65b9\u6cd5\uff08\u5728\u6211\u5011\u7684\u4f8b\u5b50\u4e2d\u662f Foo \u985e\uff09\uff1a // Qux/Criteria/Foo.php protected function _matchCriterion1Rule(array $data, \\XF\\Entity\\User $user) { /* ... \u8655\u7406\u6e96\u5247 ... */ return true; // \u7528\u6236\u7b26\u5408\u76ee\u524d\u6e96\u5247 /* \u6216\u8005 */ return false; // \u7528\u6236\u4e0d\u7b26\u5408\u76ee\u524d\u6e96\u5247 } \u5982\u679c\u5728 class \u4e2d\u627e\u4e0d\u5230\u67d0\u500b\u65b9\u6cd5\uff0c isMatched() \u6703\u547c\u53eb isUnknownMatched() \uff0c\u5176\u884c\u70ba\u53ef\u4ee5\u5728 AbstractCriteria \u7956\u5148\u4e2d\u8a2d\u5b9a\uff08\u9810\u8a2d\u8fd4\u56de false \uff09\u3002 \u5982\u679c\u6c92\u6709\u9078\u5b9a\u4efb\u4f55\u6e96\u5247\uff0c isMatched() \u5c07\u8fd4\u56de $matchOnEmpty \u8b8a\u6578\uff0c\u9810\u8a2d\u70ba true \u3002 \u4f60\u53ef\u4ee5\u5728\u4f7f\u7528 isMatched() \u65b9\u6cd5 \u4e4b\u524d \u547c\u53eb $crteriaObj->setMatchOnEmpty(false) \u4f86\u6539\u8b8a\u9019\u7a2e\u884c\u70ba\uff1a $visitor= \\XF::visitor(); $fooCriteria->setMatchOnEmpty(false); if ($fooCriteria->isMatched($visitor)) { // \u8a2a\u5ba2\u7b26\u5408\u6240\u6709\u9078\u5b9a\u7684\u6e96\u5247 } else { // \u8a2a\u5ba2\u4e0d\u7b26\u5408\u4e00\u500b\u6216\u591a\u500b\u6e96\u5247 } \u6e96\u5247\u662f\u5982\u4f55\u904b\u4f5c\u7684 (\u7bc4\u4f8b) \u00b6 \u60f3\u50cf\u4e00\u4e0b\uff0c\u4f60\u60f3\u7d66\u6240\u6709\u64c1\u6709\u982d\u50cf\u4e26\u7372\u5f97\u81f3\u5c11 5 \u500b\u8b9a\u7684\u7528\u6236\u9812\u767c\u4e00\u500b\u6210\u5c31\u3002 \u5728\u5efa\u7acb\u6210\u5c31\u6642\uff0c\u4f60\u9078\u64c7 \"\u7528\u6236\u6709\u982d\u50cf\"\uff08\u898f\u5247 has_avatar \uff09\u548c \"\u7528\u6236\u81f3\u5c11\u6536\u5230 X \u500b\u8b9a\"\uff08\u898f\u5247 like_count \uff09\u6e96\u5247\u3002 \u6700\u5f8c\u4e00\u500b\u9084\u5177\u6709\u4e00\u500b\u5305\u542b\u4e00\u500b\u5143\u7d20\u7684\u8cc7\u6599\u9663\u5217\uff1a\u559c\u6b61\u7684\u6578\u91cf\u3002 \u60a8\u6240\u9078\u64c7\u7684\u6e96\u5247\u5132\u5b58\u5728 xf_trophy \u8cc7\u6599\u8868\u4e2d\u7684 user_criteria column\u3002 \u7576 XenForo \u6c7a\u5b9a\u6aa2\u67e5\uff0c\u662f\u5426\u7d66\u7528\u6236\u9812\u767c\u6210\u5c31\u6642\uff0c\u5b83\u6703\u5c07\u898f\u5247\u8f49\u63db\u70ba\u99dd\u5cf0\u5f0f\u547d\u540d\u65b9\u6cd5\uff1a like_count > _matchLikeCount() has_avatar > _matchHasAvatar() \u7531\u65bc\u6240\u9078\u7684\u5169\u500b\u6e96\u5247\u90fd\u662f\u7528\u6236\u6e96\u5247\uff0c\u56e0\u6b64 XenForo \u6eff\u8db3\u7528\u6236\u6e96\u5247 class\uff0c\u4e26\u8a66\u5716\u5728\u5176\u4e2d\u627e\u5230\u9019\u4e9b\u65b9\u6cd5\uff1a // XF/Criteria/User.php //... protected function _matchLikeCount(array $data, \\XF\\Entity\\User $user) { return ($user->like_count && $user->like_count >= $data['likes']); } //... protected function _matchHasAvatar(array $data, \\XF\\Entity\\User $user) { return $user->user_id && ($user->avatar_date || $user->gravatar); } //... \u5982\u679c \u6240\u6709 \u4f4d\u7f6e\u7684\u65b9\u6cd5\u90fd\u8fd4\u56de true \uff0c\u6211\u5011\u7684\u7528\u6236\u5c31\u7b26\u5408\u9078\u5b9a\u7684\u6e96\u5247\uff0c\u56e0\u6b64\u5c07\u7372\u5f97\u4e00\u500b\u6210\u5c31\u3002 \u5982\u679c\u5728 User \u6e96\u5247\u985e\u4e2d\u627e\u4e0d\u5230\u67d0\u4e9b\u65b9\u6cd5\uff0cXenForo \u6703\u547c\u53eb isUnknownMatched() \u65b9\u6cd5\uff0c\u9032\u800c\u89f8\u767c criteria_user \u4e8b\u4ef6\uff0c\u5141\u8a31\u9644\u52a0\u5143\u4ef6\u88fd\u4f5c\u8005\u65b0\u589e\u4ed6\u5011\u7684\u81ea\u5b9a\u7fa9\u6e96\u5247\u8655\u7406\u7a0b\u5f0f\u3002 \uff08\u53c3\u898b \"\u81ea\u5b9a\u7fa9\u7528\u6236/\u9801\u9762\u6e96\u5247\u7bc4\u4f8b\" \uff09\u3002 \u984d\u5916\u6e96\u5247\u8cc7\u6599 \u00b6 \u6709\u6642\uff0c\u5728\u7de8\u5beb\u6e96\u5247\u6a21\u677f\u7a0b\u5f0f\u78bc\u6642\uff0c\u4f60\u9700\u8981\u8a2a\u554f\u984d\u5916\u7684\u8cc7\u6599\uff0c\u800c\u9019\u4e9b\u8cc7\u6599\u4e0d\u662f\u901a\u904e view \u53c3\u6578\u50b3\u905e\u7684\u3002 \u9019\u5c31\u662f getExtraTemplateData() \u65b9\u6cd5\u5b58\u5728\u7684\u610f\u7fa9\u3002 \u9810\u8a2d\u60c5\u6cc1\u4e0b\uff0c\u5b83\u5305\u542b\u73fe\u6709\u7684\u7528\u6236\u7d44\u3001\u8a9e\u8a00\u3001\u98a8\u683c\u6a23\u5f0f\u3001\u6642\u5340\u3002 \u4f60\u53ef\u4ee5\u5728\u4f60\u7684\u81ea\u5b9a\u7fa9\u6e96\u5247\u985e\u578b class \u4e2d\u8986\u84cb\u9019\u500b\u65b9\u6cd5\u3002 \u5728\u81ea\u5b9a\u7fa9\u6e96\u5247\u985e\u578b\u4e2d\u65b0\u589e\u8cc7\u6599 \u00b6 \u5728\u60a8\u7684\u81ea\u5b9a\u7fa9\u6e96\u5247 class \u4e2d\u8986\u84cb getExtraTemplateData() \u65b9\u6cd5\uff1a public function getExtraTemplateData() { $templateData = parent::getExtraTemplateData(); $additionalData = []; /** @var \\XF\\Repository\\Smilie $smilieRepo */ $smilieRepo = \\XF::repository('XF:Smilie'); $additionalData['smilies'] = $smilieRepo->findSmiliesForList()->fetch(); return array_merge($templateData, $additionalData); } \u5728\u73fe\u6709\u6e96\u5247\u985e\u578b\u4e2d\u65b0\u589e\u8cc7\u6599 \u00b6 \u4f60\u53ef\u4ee5\u4f7f\u7528 criteria_template_data \u4e8b\u4ef6\u76e3\u807d\u5668\u4f86\u65b0\u589e\u4f60\u81ea\u5df1\u7684\u984d\u5916\u6e96\u5247\u8cc7\u6599\uff1a public static function criteriaTemplateData(array &$templateData) { /** @var \\XF\\Repository\\Smilie $smilieRepo */ $smilieRepo = \\XF::repository('XF:Smilie'); $templateData['smilies'] = $smilieRepo->findSmiliesForList()->fetch(); } \"helper_criteria\" \u6a21\u677f \u00b6 \u6bcf\u7576\u4f60\u4f5c\u70ba\u9644\u52a0\u5143\u4ef6\u88fd\u4f5c\u8005\u60f3\u8b93\u76ee\u6a19 \u7528\u6236/\u7ba1\u7406\u54e1 \u6709\u8fa6\u6cd5\u9078\u64c7 \u7528\u6236/\u9801\u9762/\u5176\u4ed6\u9644\u52a0\u5143\u4ef6 \u7684\u6e96\u5247\u6642\uff08\u751a\u81f3\u5168\u90e8\u4e00\u8d77\uff09\uff0c\u4f60\u53ef\u4ee5\u7c21\u55ae\u5730\u4f7f\u7528 helper_criteria \u3002 \u7c21\u800c\u8a00\u4e4b\uff0c helper_criteria \u662f\u4e00\u500b\u5141\u8a31\u5728\u591a\u8655\u4f7f\u7528\u57fa\u65bc\u6e96\u5247\u985e\u578b\u7684\u6838\u53d6\u65b9\u584a\u4ecb\u9762\u7684\u7ba1\u7406\u6a21\u677f\uff0c\u7121\u9700\u8907\u88fd\u8cbc\u4e0a\u76f8\u540c\u7a0b\u5f0f\u78bc\u3002 helper_criteria \u5305\u542b \u5169\u500b \u985e\u578b\u7684\u5de8\u96c6\uff1a *criteria_name*_tabs \u548c *criteria_name*_panes \uff0c\u9069\u7528\u65bc\u6bcf\u500b\u6e96\u5247\u985e\u578b\u3002 \u4f8b\u5982\uff1a\u7528\u6236\u6e96\u5247\u985e\u578b\u7684 user_tabs \u548c user_panes \u5de8\u96c6\u3002 \u6a19\u7c64 \u00b6 \u6a19\u7c64\u7528\u65bc\u5340\u5206\u4ed6\u5011\u6240\u4f7f\u7528\u6a21\u677f\u5167\u7684\u4e0d\u540c\u6e96\u5247\u985e\u578b\uff1a \u4f7f\u7528\u6a19\u7c64\u6642\uff0c\u7b2c\u4e00\u500b\u6a19\u7c64\u5f80\u5f80\u5305\u542b\u8207\u6e96\u5247\u7121\u95dc\u7684\u6b04\u4f4d/\u9078\u9805\u3002 \u7136\u5f8c\u5230\u6e96\u5247\u6a19\u7c64\u3002 \u5728\u4e0a\u5716\u4e2d\uff0c\u7b2c\u4e00\u500b\u6a19\u7c64\u5305\u542b\u901a\u77e5\u7684\u9078\u9805\u3002 \u7d05\u6846\u4e2d\u7684\u524d\u5169\u500b\u6a19\u7c64\u8207\u7528\u6236\u6e96\u5247\u985e\u578b\u6709\u95dc\u3002 \u6700\u5f8c\u4e00\u500b\u8207\u9801\u9762\u6e96\u5247\u985e\u578b\u6709\u95dc\u3002 helper_criteria \u4e2d\u7684\u6a19\u7c64\u88ab\u6b78\u985e\u5728\u6e96\u5247\u985e\u578b\u5de8\u96c6\u4e0b\uff1a <xf:macro name=\"foo_tabs\" arg-container=\"\" arg-active=\"\"> <xf:set var=\"$tabs\"> <a class=\"tabs-tab{{ $active == 'foo' ? ' is-active' : '' }}\" role=\"tab\" tabindex=\"0\" aria-controls=\"{{ unique_id('criteriaFoo') }}\">Foo criteria</a> <a class=\"tabs-tab{{ $active == 'foo_extra' ? ' is-active' : '' }}\" role=\"tab\" tabindex=\"0\" aria-controls=\"{{ unique_id('criteriaFooExtra') }}\">Foo criteria extra</a> </xf:set> <xf:if is=\"$container\"> <div class=\"tabs\" role=\"tablist\"> {$tabs|raw} </div> <xf:else /> {$tabs|raw} </xf:if> </xf:macro> In the code above, foo is a criteria type. It has two tabs, one for general foo criteria and another for extra foo criteria. \u5728\u4e0a\u9762\u7684\u7a0b\u5f0f\u78bc\u4e2d\uff0c foo \u662f\u4e00\u500b\u6e96\u5247\u985e\u578b\u3002 \u5b83\u6709\u5169\u500b\u6a19\u7c64\uff0c\u4e00\u500b\u7528\u65bc\u4e00\u822c\u7684 foo \u6e96\u5247\uff0c\u53e6\u4e00\u500b\u7528\u65bc\u984d\u5916\u7684 foo \u6e96\u5247\u3002 Panes (\u7a97\u683c) \u00b6 Panes \u50c5\u50c5\u5305\u542b\u6e96\u5247\u3002 \u548c\u6a19\u7c64\u4e00\u6a23\uff0c helper_criteria \u4e2d\u7684 Panes \u4e5f\u662f\u6309\u7167\u6e96\u5247\u985e\u578b\u5de8\u96c6\u4f86\u6b78\u985e\u7684\uff1a <xf:macro name=\"foo_panes\" arg-container=\"\" arg-active=\"\" arg-criteria=\"!\" arg-data=\"!\"> <xf:set var=\"$panes\"> <li class=\"{{ $active == 'foo' ? ' is-active' : '' }}\" role=\"tabpanel\" id=\"{{ unique_id('criteriaFoo') }}\"> <xf:checkboxrow label=\"Criteria group 1\"> <xf:option name=\"foo_criteria[criterion_1_rule][rule]\" value=\"criterion_1_rule\" ... /> <xf:option name=\"foo_criteria[criterion_2_rule][rule]\" value=\"criterion_2_rule\" ... /> </xf:checkboxrow> <xf:checkboxrow label=\"Criteria group 2\"> <xf:option name=\"foo_criteria[criterion_3_rule][rule]\" value=\"criterion_3_rule\" ... /> <xf:option name=\"foo_criteria[criterion_4_rule][rule]\" value=\"criterion_4_rule\" ... /> </xf:checkboxrow> </li> </xf:set> <xf:if is=\"$container\"> <ul class=\"tabPanes\"> {$panes|raw} </ul> <xf:else /> {$panes|raw} </xf:if> </xf:macro> \u4f7f\u7528 \"helper_criteria\" \u00b6 \u8981\u4f7f\u7528 \"helper_criteria\" \u7684\u529f\u80fd\uff0c\u4f60\u9700\u8981\u52a0\u5165\u5b83\u7684\u5de8\u96c6\u3002 \u6e96\u5099\u8cc7\u6599 \u00b6 \u5982\u679c\u60a8 \u6c92\u6709 \u60a8\u6240\u9078\u5b9a\u7684\u6e96\u5247\u5132\u5b58\u5728\u8cc7\u6599\u5eab\u4e2d\u7684\u67d0\u500b\u5730\u65b9\uff0c\u6216\u8005\u60a8\u8981\u4f7f\u7528\u7684\u6e96\u5247\u985e\u578b \u4e0d\u9700\u8981 \u4efb\u4f55\u984d\u5916\u7684\u8cc7\u6599\uff0c\u53ef\u4ee5\u8df3\u904e\u672c\u7bc0\u3002 \u9996\u5148\uff0c\u60a8\u9700\u8981\u6aa2\u7d22\u5df2\u5132\u5b58\u7684\u9078\u5b9a\u6e96\u5247\uff0c\u4e26\u5f9e\u4e2d\u5efa\u7acb\u4e00\u500b\u6e96\u5247\u7269\u4ef6\u3002 \u5728\u672c\u7bc0\u4e2d\uff0c\u6211\u5011\u5c07\u4ee5 Page \u6e96\u5247\u70ba\u4f8b\u5b50\uff1a $savedCriteria = /* Retrieve it somehow... */ // \u6e96\u5247\u7269\u4ef6 $criteria = $this->app()->criteria('XF:Page', $savedCriteria)->getCriteriaForTemplate(); // \u6e96\u5247\u984d\u5916\u8cc7\u6599 $criteriaData = $criteria->getExtraTemplateData(); $viewParams = [ /* ... */ 'criteria' => $criteria, 'criteriaData' => $criteriaData ]; return $this->view(/* ... */, $viewParams); \u5305\u542b\u6c92\u6709\u5167\u5bb9\u7684\u6a19\u7c64 \u00b6 \u8981\u5305\u542b\u6c92\u6709\u5167\u5bb9\u7684\u6a19\u7c64\u6e96\u5247\uff0c\u4f60\u9700\u8981\u4f7f\u7528 <xf:macro... \u6a19\u7c64\uff0c\u4e26\u5c07 arg-container \u5c6c\u6027\u8a2d\u5b9a\u70ba 0 \u3002 <xf:macro template=\"helper_criteria\" name=\"page_panes\" arg-container=\"0\" arg-criteria=\"{$criteria}\" arg-data=\"{$criteriaData}\" /> \u5982\u679c\u4f60\u6c92\u6709\u4fdd\u5b58\u6e96\u5247\uff0c\u4f60\u53ef\u4ee5\u76f4\u63a5\u5c07\u7a7a\u9663\u5217 {{ [] }} \u50b3\u905e\u7d66 arg-criteria \u5c6c\u6027\u3002 \u4e0d\u8981\u5fd8\u8a18\u628a page_panes \u4e2d\u7684 page \u66ff\u63db\u6210\u4f60\u60f3\u4f7f\u7528\u7684\u6e96\u5247\u985e\u578b\u540d\u7a31\u3002 \u8acb\u8a18\u4f4f\uff0c\u6240\u6709\u7684\u6e96\u5247\u90fd\u662f\u7528 <li> \u6a19\u7c64\u5305\u4f4f\u7684\uff0c\u6240\u4ee5\u4f60\u9700\u8981\u61c9\u7528\u4e00\u4e9b CSS \u6a23\u5f0f\uff08\u4f8b\u5982 list-style-type: none; \uff09\u3002 \u6709\u5167\u5bb9\u7684\u6a19\u7c64 \u00b6 \u70ba\u4e86\u4f7f\u7528\u6e96\u5247\u6a19\u7c64\uff0c\u4f60\u9700\u8981\u7d44\u7e54\u9801\u9762\u3002 \u5805\u6301\u4ee5\u4e0b\u7bc4\u4f8b\u7d50\u69cb\uff1a <xf:form ... class=\"block\"> <div class=\"block-container\"> <!-- \u6a19\u7c64 --> <h2 class=\"block-tabHeader tabs hScroller\" data-xf-init=\"h-scroller tabs\" role=\"tablist\"> <span class=\"hScroller-scroll\"> <!-- Main tab where fields/options are located --> <a class=\"tabs-tab is-active\" role=\"tab\" tabindex=\"0\" aria-controls=\"MAIN_TAB_ID\">Main tab title</a> <!-- \u6e96\u5247\u6a19\u7c64 --> <xf:macro template=\"helper_criteria\" name=\"page_tabs\" arg-userTabTitle=\"Custom tab name (optionally)\" /> </span> </h2> <!-- \u7a97\u683c --> <ul class=\"block-body tabPanes\"> <!-- Main pane --> <li class=\"is-active\" role=\"tabpanel\" id=\"MAIN_TAB_ID\"> <!-- Fields and options --> </li> <!-- \u6e96\u5247\u7a97\u683c --> <xf:macro template=\"helper_criteria\" name=\"page_panes\" arg-criteria=\"{$criteria}\" arg-data=\"{$criteriaData}\" /> </ul> <xf:submitrow sticky=\"true\" icon=\"save\" /> </div> </xf:form> \u540c\u6a23\uff0c\u5982\u679c\u4f60\u6c92\u6709\u4efb\u4f55\u6e96\u5247\u6578\u64da\uff0c\u6216\u8005\u751a\u81f3\u5047\u8a2d\u6c92\u6709\uff0c\u8acb\u5c07 {{ [] }} \u50b3\u905e\u7d66 arg-criteria \u5c6c\u6027\u3002 \u5728 \"helper_criteria\" \u4e2d\u6dfb\u52a0\u81ea\u5b9a\u7fa9\u6e96\u5247\u985e\u578b \u00b6 \u5982\u679c\u4f60\u60f3\u5728 helper_criteira \u6a21\u677f\u4e2d\u65b0\u589e\u81ea\u5b9a\u7fa9\u6e96\u5247\u985e\u578b\uff0c\u4f60\u9700\u8981\u5efa\u7acb\u4e00\u500b helper_criteria \u6a21\u677f\u7684\u6a21\u677f\u4fee\u6539\u3002 \u9032\u5165 Admin CP \u4e2d\u7684 \"\u5916\u89c0 > \u6a21\u677f\u4fee\u6539\"\uff0c\u5207\u63db\u5230 \"\u7ba1\u7406\" \u6a19\u7c64\uff0c\u9ede\u9078 \"\u65b0\u589e\u6a21\u677f\u4fee\u6539\" \u6309\u9215\u3002 \u6211\u5011\u8981\u5728\u6a21\u677f\u7684\u6700\u5e95\u90e8\u65b0\u589e\u6211\u5011\u7684\u6a19\u7c64\u548c\u7a97\u683c\uff0c\u6240\u4ee5\u5c07 \"\u641c\u5c0b\u985e\u578b\" \u5207\u63db\u70ba \"\u6b63\u898f\u8868\u9054\u5f0f\"\u3002 \u5728 \"\u67e5\u8a62\" \u6b04\u4e2d\u8f38\u5165 /$/ \u3002 \u6700\u5f8c\uff0c\u5728 \"\u66ff\u63db\" \u6b04\u4f4d\u4e2d\u65b0\u589e\u6a19\u7c64\u548c\u7a97\u683c\u7684\u5de8\u96c6\u7a0b\u5f0f\u78bc\u3002 \u8209\u4f8b\uff1a <xf:macro name=\"foo_tabs\" arg-container=\"\" arg-active=\"\"> <xf:set var=\"$tabs\"> <a class=\"tabs-tab{{ $active == 'foo' ? ' is-active' : '' }}\" role=\"tab\" tabindex=\"0\" aria-controls=\"{{ unique_id('criteriaFoo') }}\">Foo criteria</a> <a class=\"tabs-tab{{ $active == 'foo_extra' ? ' is-active' : '' }}\" role=\"tab\" tabindex=\"0\" aria-controls=\"{{ unique_id('criteriaFooExtra') }}\">Foo criteria extra</a> </xf:set> <xf:if is=\"$container\"> <div class=\"tabs\" role=\"tablist\"> {$tabs|raw} </div> <xf:else /> {$tabs|raw} </xf:if> </xf:macro> <xf:macro name=\"foo_panes\" arg-container=\"\" arg-active=\"\" arg-criteria=\"!\" arg-data=\"!\"> <xf:set var=\"$panes\"> <li class=\"{{ $active == 'foo' ? ' is-active' : '' }}\" role=\"tabpanel\" id=\"{{ unique_id('criteriaFoo') }}\"> <xf:checkboxrow label=\"Criteria group 1\"> <xf:option name=\"foo_criteria[criterion_1_rule][rule]\" value=\"criterion_1_rule\" ... /> <xf:option name=\"foo_criteria[criterion_2_rule][rule]\" value=\"criterion_2_rule\" ... /> </xf:checkboxrow> <xf:checkboxrow label=\"Criteria group 2\"> <xf:option name=\"foo_criteria[criterion_3_rule][rule]\" value=\"criterion_3_rule\" ... /> <xf:option name=\"foo_criteria[criterion_4_rule][rule]\" value=\"criterion_4_rule\" ... /> </xf:checkboxrow> </li> </xf:set> <xf:if is=\"$container\"> <ul class=\"tabPanes\"> {$panes|raw} </ul> <xf:else /> {$panes|raw} </xf:if> </xf:macro> \u73fe\u5728\uff0c\u60a8\u53ef\u4ee5\u5728\u4efb\u4f55\u5730\u65b9\u4f7f\u7528\u60a8\u7684\u6e96\u5247\uff08\u8acb\u53c3\u898b \"\u4f7f\u7528helper_criteria\" )\u3002 \u81ea\u5b9a\u7fa9\u7528\u6236/\u9801\u9762\u6e96\u5247\u7bc4\u4f8b \u00b6 \u6bd4\u65b9\u8aaa\uff0c\u6211\u5011\u60f3\u5efa\u7acb\u4e00\u500b\u6e96\u5247\u4f86\u6aa2\u67e5\u6211\u5011\u7684\u7528\u6236\u662f\u5426\u5728\u55ae\u5247\u7559\u8a00\u4e0a\u6709 X \u500b\u6216\u66f4\u591a\u7684\u8b9a\u3002 \u7531\u65bc\u6211\u5011\u7684\u6e96\u5247\u662f\u6307\u7528\u6236\uff0c\u6240\u4ee5\u6211\u5011\u5c07\u5efa\u7acb\u4e00\u500b\u5c6c\u65bc\u7528\u6236\u6e96\u5247\u7684\u6e96\u5247\u3002 \u589e\u52a0\u6a21\u677f\u4fee\u6539 \u00b6 \u9996\u5148\uff0c\u6211\u5011\u9700\u8981\u5c07\u6211\u5011\u7684\u6e96\u5247\u65b0\u589e\u5230\u7528\u6236\u6e96\u5247\u5217\u8868\u4e2d\u3002 \u9032\u5165 Admin CP \u4e2d\u7684 \"\u6a21\u677f\u4fee\u6539\" \u9801\u9762\uff0c\u9078\u64c7 \"Admin\" \u6a19\u7c64\uff0c\u9ede\u9078\u53f3\u4e0a\u89d2\u7684 \"\u65b0\u589e\u6a21\u677f\u4fee\u6539\" \u6309\u9215\u3002 Warning \u5982\u679c\u6c92\u6709 \"Admin\" \u6a19\u7c64\uff0c\u8acb\u78ba\u4fdd\u4f60\u5df2\u7d93\u555f\u7528\u4e86 \u958b\u767c\u6a21\u5f0f \u3002 \u6211\u5011\u5c07\u4fee\u6539 helper_criteria \u6a21\u677f\uff0c\u56e0\u6b64\u5c07\u5176\u5beb\u5165\u5230 \"\u6a21\u677f\" \u6b04\u4f4d\u3002 \u5728\u9019\u500b\u4f8b\u5b50\u4e2d\uff0c\u6211\u5c07\u4f7f\u7528 likes_on_single_message \"\u4fee\u6539 key \u503c\" \u4f86\u4fee\u6539\u9019\u500b\u6a21\u677f\u3002 \u6211\u5011\u7684\u6e96\u5247\u662f\u95dc\u65bc\u7559\u8a00\u7684\u9ede\u8b9a\u6578\u3002 \u9019\u610f\u5473\u8457\u5b83\u61c9\u8a72\u5728 \"\u5167\u5bb9\u548c\u6210\u5c31\" \u90e8\u5206\u4e0b\u3002 \u9019\u8868\u793a\u6211\u5011\u53ea\u9700\u8981\u627e\u5230 <\uff01--[XF:user:content_bottom]--> \uff0c\u7136\u5f8c\u7528\u4e0b\u9762\u7684\u7a0b\u5f0f\u78bc\u66ff\u63db\u3002 <xf:option name=\"user_criteria[likes_on_single][rule]\" value=\"likes_on_single\" selected=\"{$criteria.likes_on_single}\" label=\"Likes on single message:\"> <xf:numberbox name=\"user_criteria[likes_on_single][data][likes]\" value=\"{$criteria.likes_on_single.likes}\" size=\"5\" min=\"0\" step=\"1\" /> </xf:option> $0 \u5f9e\u9019\u4e00\u523b\u8d77\uff0c\u6211\u5011\u5df2\u7d93\u53ef\u4ee5\u770b\u5230\uff0c\u751a\u81f3\u53ef\u4ee5\u5728\u5efa\u7acb\u6210\u5c31\u3001\u901a\u77e5\u548c\u63d0\u5347\u7528\u6236\u7d44\u6642\u70ba\u6211\u5011\u7684\u6e96\u5247\u8a2d\u5b9a\u4e00\u500b\u503c\u3002 \u589e\u52a0\u7a0b\u5f0f\u78bc\u4e8b\u4ef6\u76e3\u807d\u5668 \u00b6 \u6211\u5011\u5df2\u7d93\u5efa\u7acb\u4e86\u6211\u5011\u7684\u6e96\u5247\u3002 \u4f46\u5c0d\u65bc XenForo \u4f86\u8aaa\uff0c\u5b83\u662f\u672a\u77e5\u7684\uff0c\u7576\u7b26\u5408\u9019\u7a2e\u6e96\u5247\u6642\uff0c\u5b83\u7e3d\u662f\u8fd4\u56de \"false\"\u3002 \u6211\u5011\u9700\u8981\u544a\u8a34 XenForo\uff0c\u7576\u5b83\u7b26\u5408\u672a\u77e5\u6e96\u5247\u6642\u8a72\u600e\u9ebc\u505a\u3002 \u9032\u5165 \"\u958b\u767c > \u7a0b\u5f0f\u78bc\u4e8b\u4ef6\u76e3\u807d\u5668\" \u9801\u9762\uff0c\u9ede\u9078 \"\u65b0\u589e\u7a0b\u5f0f\u78bc\u4e8b\u4ef6\u76e3\u807d\u5668\" \u6309\u9215\u3002 \u5728 \"\u76e3\u807d\u4e8b\u4ef6\" \u6b04\u4f4d\u4e2d\u9078\u64c7 criteria_user \uff08 user \u56e0\u70ba\u6211\u5011\u7684\u6e96\u5247\u5c6c\u65bc\u7528\u6236\u6e96\u5247\uff09\u3002 \u5728 \"\u57f7\u884c callback\" \u6b04\u4f4d\u4e2d\uff0c\u6211\u5011\u61c9\u8a72\u6307\u5b9a\u5339\u914d\u6e96\u5247\u6642\u8981\u547c\u53eb\u7684\u985e\u548c\u65b9\u6cd5\u3002 \u5728 addon \u6839\u76ee\u9304\u4e0b\u5efa\u7acb\u4e00\u500b\u6a94\u6848 Listener.php \uff0c\u5982\u679c\u4f60\u9084\u6c92\u6709\u7684\u8a71\uff0c\u5728\u90a3\u88e1\u65b0\u589e\u4e00\u500b\u65b0\u7684\u65b9\u6cd5 criteriaUser \uff1a <?php namespace YOUR_ADDON_ID; class Listener { public static function criteriaUser($rule, array $data, \\XF\\Entity\\User $user, &$returnValue) { } } \u4f60\u53ef\u4ee5\u7528 YOUR_ADDON_ID\\Listener \u548c criteriaUser \u5206\u5225\u586b\u5beb \"Class\" \u548c \"Method\" \u6b04\u4f4d\u3002 \u8655\u7406\u6e96\u5247 \u00b6 \u7531\u65bc\u6211\u5011\u7684 criteriaUser \u65b9\u6cd5\u5c0d\u6bcf\u500b\u672a\u77e5\u7684\u6e96\u5247\u90fd\u6703\u88ab\u89f8\u767c\uff0c\u6211\u5011\u9700\u8981\u78ba\u4fdd $rule \u7b49\u65bc likes_on_single \uff08\u6211\u5011\u5728 HTML \u6a19\u7c64\u4e2d\u6307\u5b9a\u7684\u898f\u5247\uff09\u3002 public static function criteriaUser($rule, array $data, \\XF\\Entity\\User $user, &$returnValue) { switch ($rule) { case 'likes_on_single': /** \u8655\u7406\u7a0b\u5f0f\u78bc\u5728\u9019\u88e1! */ break; } } \u73fe\u5728\uff0c\u6211\u5011\u9700\u8981\u5beb\u7a0b\u5f0f\u78bc\u4f86\u5be6\u969b\u6aa2\u67e5\u4e00\u500b\u7528\u6236\u662f\u5426\u6709 X \u500b\u6216\u66f4\u591a\u8b9a\u7684\u7559\u8a00\u3002 \u9019\u53ef\u4ee5\u901a\u904e\u7c21\u55ae\u7684 SQL \u67e5\u8a62\u8f15\u9b06\u5be6\u73fe\uff0c\u5f9e xf_post \u4e2d\u9078\u64c7\u4e00\u689d\u8d85\u904e X \u500b\u8b9a\u7684\u8a18\u9304\uff08 likes column \uff09\uff0c\u4e26\u4e14 user_id \u7b49\u65bc\u76ee\u524d\u5339\u914d\u7684\u7528\u6236 ID\u3002 \u6240\u4ee5\uff0c\u4e0b\u9762\u662f\u67e5\u8a62\u8a9e\u53e5\uff1a SELECT `likes` FROM `xf_post` WHERE `user_id` = ? ORDER BY `likes` DESC LIMIT 1 \u4ee5\u53ca\u65b9\u6cd5\u7a0b\u5f0f\u78bc\uff1a public static function criteriaUser($rule, array $data, \\XF\\Entity\\User $user, &$returnValue) { switch ($rule) { case 'likes_on_single': // \u7372\u53d6\u8cc7\u6599\u5eab $db = \\XF::db(); // \u7528\u65bc\u9078\u64c7\u55ae\u500b\u7528\u6236\u5e16\u5b50\u7684\u6700\u5927\u9ede\u8b9a\u6578\u7684\u8cc7\u6599\u5eab\u67e5\u8a62 $query = \"SELECT `likes` FROM `xf_post` WHERE `user_id` = ? ORDER BY `likes` DESC LIMIT 1\"; // \u6aa2\u7d22\u6700\u5927\u9ede\u8b9a\u6578 $likes = $db->fetchOne($query, [$user->user_id]); // \u6aa2\u67e5\u6211\u5011\u662f\u5426\u6709\u4f86\u81ea\u8cc7\u6599\u5eab\u7684\u7d50\u679c(\u6211\u5011\u671f\u671b\u6709\u4e00\u500b\u6578\u5b57) if (is_int($likes)) { // \u5982\u679c\u7528\u6236\u7684\u8cc7\u8a0a\u6709 X \u500b\u6216\u66f4\u591a\u7684\u8b9a\uff0c\u5247\u8fd4\u56de true\uff1b\u5982\u679c\u6c92\u6709\uff0c\u5247\u8fd4\u56de false $returnValue = ($likes >= $data['likes']); } else { $returnValue = false; } break; } } \u8981\u6ce8\u610f\u4ee5\u4e0b\u5e7e\u9ede\uff1a \u6211\u5011\u4f7f\u7528 $user \u8b8a\u6578\u4f86\u6aa2\u7d22\u76ee\u524d\u5339\u914d\u7684\u7528\u6236\u3002 \u6211\u5011\u53ef\u4ee5\u4f7f\u7528\u9019\u500b\u8b8a\u6578\uff0c\u56e0\u70ba\u6211\u5011\u7684\u6e96\u5247\u5c6c\u65bc \u7528\u6236 \u6e96\u5247\u3002 \u6211\u5011\u53ef\u4ee5\u901a\u904e $data \u9663\u5217\u8a2a\u554f\u8cc7\u6599\u3002 \u5b83\u5305\u542b\u4e86\u6211\u5011\u5728 \u6a21\u677f\u4fee\u6539\u4e2d\u5df2\u65b0\u589e \u7684\u6b04\u4f4d\u7684\u8cc7\u6599\u3002 \u6211\u5011\u53ea\u65b0\u589e\u4e86\u4e00\u500b <xf:numberbox... \uff0c\u5176\u4e2d name \u5c6c\u6027\u7b49\u65bc user_criteria[likes_on_single][data][likes] \u3002 \u9019\u5c31\u662f\u70ba\u4ec0\u9ebc\u6211\u5011\u53ef\u4ee5\u5728\u4e0a\u9762\u7684\u7a0b\u5f0f\u78bc\u4e2d\u4f7f\u7528 $data['likes'] \u3002 \u73fe\u5728\u4e00\u5207\u90fd\u641e\u5b9a\u4e86\u3002 \u8b93\u6211\u5011\u6e2c\u8a66\u4e00\u4e0b\u5427\uff01 \u6e2c\u8a66\uff08\u6210\u5c31\uff09 \u00b6 \u5efa\u7acb\u4e00\u500b \"\u4eba\u4eba\u70ba\u6211\" \u7684\u6210\u5c31\u3002 \u5728 \"\u7528\u6236\u6e96\u5247\" \u6a19\u7c64\u4e0a\uff0c\"\u55ae\u5247\u7559\u8a00\u7684\u9ede\u8b9a\u6578\" \u6b04\u4f4d\uff0c\u4f8b\u5982\uff0c5\u3002 \u63a5\u4e0b\u4f86\uff0c\u5728\u4f60\u8ad6\u58c7\u7684\u67d0\u8655\u5efa\u7acb\u4e00\u500b\u6e2c\u8a66\u7559\u8a00\uff0c\u7136\u5f8c\u7528\u4e94\u500b\u4e0d\u540c\u7684\u7528\u6236\u9ede\u8b9a\u4e94\u6b21\uff08\u6216\u8005\u76f4\u63a5\u624b\u52d5\u8a2d\u5b9a likes \u6b04\u7684\u503c\uff09\u3002 \u7136\u5f8c\uff0c\u9032\u5165 \"\u5de5\u5177 > \u8a08\u756b\u4efb\u52d9\"\uff0c\u901a\u904e\u9ede\u64ca\u57f7\u884c\u6309\u9215 (\u5faa\u74b0-\u7bad\u982d) \"\u66f4\u65b0\u7528\u6236\u6210\u5c31\u503c\" \u8a08\u756b\u3002 \u5f88\u597d\uff01 Warning \u5982\u679c\u60a8\u6c92\u6709\u7372\u5f97 \"\u4eba\u4eba\u70ba\u6211\" \u6210\u5c31\uff0c\u8acb\u5617\u8a66\u767b\u51fa\u3001\u767b\u5165\u4e26\u91cd\u65b0\u57f7\u884c \"\u66f4\u65b0\u7528\u6236\u6210\u5c31\u503c\" \u8a08\u756b\u3002 \u6e2c\u8a66\uff08\u901a\u77e5\uff09 \u00b6 \u9032\u5165 \"\u806f\u7d61 > \u901a\u77e5\"\uff0c\u9ede\u9078 \"\u65b0\u589e\u901a\u77e5\" \u6309\u9215\u3002 \u5728 \"\u7528\u6236\u6e96\u5247\" \u6a19\u7c64\u4e0a\uff0c\u5c07 \"\u55ae\u5247\u7559\u8a00\u7684\u9ede\u8b9a\u6578\" \u6b04\u4f4d\u540c\u6a23\u8a2d\u5b9a\u70ba 5\u3002 \u5132\u5b58\u901a\u77e5\u3002 \u63a5\u4e0b\u4f86\uff0c\u5728\u4f60\u8ad6\u58c7\u7684\u67d0\u8655\u5efa\u7acb\u4e00\u500b\u6e2c\u8a66\u7559\u8a00\uff0c\u7136\u5f8c\u7528\u4e94\u500b\u4e0d\u540c\u7684\u7528\u6236\u9ede\u8b9a\u4e94\u6b21\uff08\u6216\u8005\u76f4\u63a5\u624b\u52d5\u8a2d\u5b9a likes \u6b04\u7684\u503c\uff09\u3002 \u73fe\u5728\uff0c\u4f60\u61c9\u8a72\u6703\u770b\u5230\u4e00\u5247\u901a\u77e5\uff1a \u4f60\u53ef\u4ee5 \u4e0b\u8f09 \u57fa\u65bc\u9019\u500b\u7bc4\u4f8b\u69cb\u5efa\u7684\u9644\u52a0\u5143\u4ef6\u8cc7\u6e90 (2.0.10)\u3002 \u81ea\u5b9a\u7fa9\u6e96\u5247\u985e\u578b\u7bc4\u4f8b \u00b6 \u60f3\u50cf\u4e00\u4e0b\uff0c\u6211\u5011\u6b63\u5728\u5efa\u7acb\u4e00\u500b\u9644\u52a0\u5143\u4ef6\uff08\u9644\u52a0\u5143\u4ef6 ID\uff1a PostsRemover \uff09\uff0c\u7528\u65bc\u522a\u9664\u6240\u6709\u7b26\u5408\u9078\u5b9a\u6e96\u5247\u7684\u5e16\u5b50\u3002 \u4e00\u500b\u53ef\u7528\u6e96\u5247\u7684\u5217\u8868\uff1a \u5e16\u5b50\u81f3\u5c11\u6709 X \u500b\u9ede\u8b9a\u6578 \u5e16\u5b50\u4f5c\u8005\u6709\u4e00\u500b X \u7528\u6236\u540d \u5e16\u5b50\u81f3\u5c11\u88ab\u7de8\u8f2f\u4e86 X \u6b21 \u5e16\u5b50\u88ab\u7de8\u8f2f\u7684\u6b21\u6578\u4e0d\u8d85\u904e X \u6b21 \u5e16\u5b50\u5728 X \u4e4b\u524d\u767c\u8868 \u5e16\u5b50\u767c\u8868\u65bc X \u4e4b\u5f8c \u986f\u7136\uff0c\u5c0d\u65bc\u9019\u6a23\u7684\u6e96\u5247\uff0c\u6211\u5011\u9700\u8981\u4e00\u7a2e\u65b0\u7684\u6e96\u5247\u985e\u578b\uff1a\u5e16\u5b50\u6e96\u5247\u3002 Criteria type class \u6e96\u5247\u985e\u578b class \u00b6 \u6211\u5011\u61c9\u8a72\u5148\u5728 addon \u7684 Criteria \u76ee\u9304\u4e0b\u5efa\u7acb\u4e00\u500b\u7e7c\u627f AbstractCriteria \u7684\u65b0 class Post \uff1a <?php namespace PostsRemover\\Criteria; use XF\\Criteria\\AbstractCriteria; class Post extends AbstractCriteria { } \u73fe\u5728\u6211\u5011\u9700\u8981\u70ba addon \u652f\u63f4\u7684\u6240\u6709\u6e96\u5247\u5beb\u7a0b\u5f0f\u78bc\u3002 \u5728\u9019\u500b\u4f8b\u5b50\u4e2d\uff0c\u6211\u5c07\u70ba\u4e0a\u9762\u5217\u8868\u4e2d\u7684\u524d\u4e09\u500b\u6e96\u5247\u5beb\u7a0b\u5f0f\u78bc\uff1a <?php namespace PostsRemover\\Criteria; use XF\\Criteria\\AbstractCriteria; class Post extends AbstractCriteria { // \u5e16\u5b50\u81f3\u5c11\u6709 X \u500b\u9ede\u8b9a\u6578 protected function _matchLikeCount(array $data, \\XF\\Entity\\Post $post) { return ($post->likes && $post->likes >= $data['likes']); } // \u5e16\u5b50\u4f5c\u8005\u6709\u4e00\u500b X \u7528\u6236\u540d protected function _matchUsername(array $data, \\XF\\Entity\\Post $post) { return $post->username === $data['name']; } // \u5e16\u5b50\u81f3\u5c11\u88ab\u7de8\u8f2f\u4e86 X \u6b21 protected function _matchEditedCount(array $data, \\XF\\Entity\\Post $post) { return $post->edit_count && $post->edit_count >= $data['count']; } /* ================ \u8655\u7406\u5176\u4ed6\u6e96\u5247 ================ */ } isMatched(...) \u65b9\u6cd5\u7528\u65bc\u547c\u53eb\u6211\u5011\u525b\u624d\u5efa\u7acb\u7684 _match \u65b9\u6cd5\uff0c\u53ea\u63a5\u53d7 User \u5be6\u9ad4\uff0c\u6211\u5011\u8981\u5beb\u4e00\u500b\u81ea\u5b9a\u7fa9\u7684 isMatched() \u3001 isUnknownMatched() \u548c isSpecialMatched() \u65b9\u6cd5\u7684\u8b8a\u9ad4\u3002 \u7531\u65bc\u6211\u5011\u6b63\u5728\u5efa\u7acb\u5e16\u5b50\u6e96\u5247\uff0c\u6211\u5011\u9700\u8981\u5efa\u7acb\u81ea\u5df1\u7684 isMatchedPost() \u65b9\u6cd5\uff1a public function isMatchedPost(\\XF\\Entity\\Post $post) { if (!$this->criteria) { return $this->matchOnEmpty; } foreach ($this->criteria AS $criterion) { $rule = $criterion['rule']; $data = $criterion['data']; $specialResult = $this->isSpecialMatchedPost($rule, $data, $post); if ($specialResult === false) { return false; } else if ($specialResult === true) { continue; } $method = '_match' . \\XF\\Util\\Php::camelCase($rule); if (method_exists($this, $method)) { $result = $this->$method($data, $post); if (!$result) { return false; } } else { if (!$this->isUnknownMatched($rule, $data, $post)) { return false; } } } return true; } protected function isSpecialMatchedPost($rule, array $data, \\XF\\Entity\\Post $post) { return null; } protected function isUnknownMatchedPost($rule, array $data, \\XF\\Entity\\Post $post) { return false; } \u6211\u5011\u53ea\u9700\u7528 isMatched(...) \u65b9\u6cd5\u7a0b\u5f0f\u78bc\u5c07 User \u5be6\u9ad4\u985e\u578b\u7684 $user \u8b8a\u6578\u66ff\u63db\u70ba Post \u5be6\u9ad4\u985e\u578b\u7684 $post \u8b8a\u6578\u3002 \u7531\u65bc\u6211\u5011\u4e0d\u6253\u7b97\u8655\u7406\u7279\u6b8a\u548c\u672a\u77e5\u7684\u6e96\u5247\uff0c\u6211\u5011\u5728 isSpecialMatchedPost \u4e2d\u8fd4\u56de null\uff0c\u5728 isUnknownMathcedPost \u65b9\u6cd5\u4e2d\u8fd4\u56de false \u3002 \u6a21\u677f \u00b6 \u62cb\u958b\u65b0\u589e admin \u8def\u7531\u3001\u7de8\u5beb Controller \u548c\u5728\u5f8c\u53f0\u505a\u5176\u4ed6\u64cd\u4f5c\u7684\u904e\u7a0b\uff0c\u76f4\u63a5\u8df3\u5230\u6211\u5011\u9801\u9762\u7684\u6a21\u677f\u7a0b\u5f0f\u78bc\uff1a <xf:title>Posts Remover</xf:title> <xf:form action=\"{{ link('posts-remover/remove') }}\" ajax=\"true\" class=\"block\"> <div class=\"block-container\"> <xf:checkboxrow label=\"Post criteria\"> <xf:option label=\"Post has at least X likes\" name=\"post_criteria[like_count][rule]\" value=\"like_count\"> <xf:numberbox name=\"post_criteria[like_count][data][likes]\" size=\"5\" min=\"0\" step=\"1\" /> </xf:option> <xf:option label=\"Post author has an X username\" name=\"post_criteria[username][rule]\" value=\"username\"> <xf:textbox name=\"post_criteria[username][data][name]\" ac=\"true\" /> </xf:option> <xf:option label=\"Post was edited at least X times\" name=\"post_criteria[edited_count][rule]\" value=\"edited_count\"> <xf:numberbox name=\"post_criteria[edited_count][data][count]\" size=\"5\" min=\"0\" step=\"1\" /> </xf:option> </xf:checkboxrow> <!-- \u5176\u4ed6\u6e96\u5247\u7684\u6a21\u677f\u7a0b\u5f0f\u78bc --> <xf:submitrow sticky=\"true\" icon=\"delete\"/> </div> </xf:form> \u5339\u914d\u6e96\u5247 \u00b6 \u5728\u6211\u5011\u9801\u9762\u7684 Controller \u4e2d\uff0c\u6211\u5011\u9700\u8981\u5efa\u7acb\u4e00\u500b\u540d\u70ba actionRemove \u7684\u65b9\u6cd5\u4f86\u8655\u7406 \"\u79fb\u9664\" \u6309\u9215\u7684\u9ede\u9078\uff1a public function actionRemove() { } \u9996\u5148\uff0c\u8b93\u6211\u5011\u5f9e\u9801\u9762\u8868\u55ae\u4e2d\u6aa2\u7d22 post_criteria \u9663\u5217\uff1a public function actionRemove() { $postCriteriaInput = $this->filter('post_criteria', 'array'); } \u5176\u6b21\uff0c\u6211\u5011\u9700\u8981\u5f9e\u6aa2\u7d22\u5230\u7684\u9801\u9762\u8868\u55ae\u8cc7\u6599\u4e2d\u5efa\u7acb\u4e00\u500b\u6e96\u5247\u7269\u4ef6\uff1a public function actionRemove() { $postCriteriaInput = $this->filter('post_criteria', 'array'); /** @var \\PostsRemover\\Criteria\\Post $postCriteria */ $postCriteria = $this->app()->criteria('PostsRemover:Post', $postCriteriaInput); } \u9810\u8a2d\u60c5\u6cc1\u4e0b\uff0c\u767c\u4f48\u5e16\u5b50 \u5c07\u5339\u914d empty \u6e96\u5247\uff08\u7576\u6c92\u6709\u9078\u64c7\u4efb\u4f55\u5167\u5bb9\u6642\uff09\uff0c\u9019\u5c07\u5c0e\u81f4\u6240\u6709\u8ad6\u58c7\u5e16\u5b50\u90fd\u88ab\u522a\u9664\u3002 \u70ba\u4e86\u907f\u514d\u9019\u7a2e\u60c5\u6cc1\uff0c\u6211\u5011\u9700\u8981\u901a\u904e setMatchOnEmpty() \u65b9\u6cd5\u624b\u52d5\u8a2d\u5b9a\u5339\u914d empty \u6e96\u5247\u7684\u7d50\u679c\uff1a public function actionRemove() { $postCriteriaInput = $this->filter('post_criteria', 'array'); /** @var \\PostsRemover\\Criteria\\Post $postCriteria */ $postCriteria = $this->app()->criteria('PostsRemover:Post', $postCriteriaInput); $postCriteria->setMatchOnEmpty(false); // \u5982\u679c\u6c92\u6709\u9078\u5b9a\u6e96\u5247\uff0c\u5247\u4e0d\u6703\u522a\u9664\u4efb\u4f55\u5167\u5bb9 } \u6700\u5f8c\uff0c\u6211\u5011\u9700\u8981\u6839\u64da\u9078\u5b9a\u7684\u6e96\u5247\u4f86\u5339\u914d\u6240\u6709\u8ad6\u58c7\u5e16\u5b50\u3002 \u5982\u679c\u5e16\u5b50\u7b26\u5408\u6e96\u5247\uff0c\u6211\u5011\u5c07\u522a\u9664\u5b83\u3002 public function actionRemove() { $postCriteriaInput = $this->filter('post_criteria', 'array'); /** @var \\PostsRemover\\Criteria\\Post $postCriteria */ $postCriteria = $this->app()->criteria('PostsRemover:Post', $postCriteriaInput); $postCriteria->setMatchOnEmpty(false); // \u5982\u679c\u6c92\u6709\u9078\u64c7\u6e96\u5247\uff0c\u5247\u4e0d\u6703\u522a\u9664\u4efb\u4f55\u5167\u5bb9 // \u53d6\u5f97\u6240\u6709\u8ad6\u58c7\u5e16\u5b50 $posts = $this->finder('XF:Post')->fetch(); $deletedCounter = 0; /** @var \\XF\\Entity\\Post $post */ foreach ($posts as $post) { if ($postCriteria->isMatchedPost($post)) // \u91dd\u5c0d\u6240\u9078\u5b9a\u7684\u6e96\u5247\u6aa2\u67e5\u5e16\u5b50 { $post->delete(); // \u5982\u679c\u5e16\u5b50\u7b26\u5408\u9078\u5b9a\u7684\u6e96\u5247\uff0c\u5247\u5c07\u5176\u522a\u9664\u3002 $deletedCounter++; } } return $this->message('Done! ' . $deletedCounter . ' posts were removed!'); } Note \u8acb\u6ce8\u610f\uff0c\u5c0d\u65bc XenForo 2.1 \u4ee5\u4e0b\u7684\u7248\u672c\uff0c\u6211\u5011\u4f7f\u7528 isMatchedPost($post) \u65b9\u6cd5\uff01 Warning \u4e00\u822c\u4f86\u8aaa\uff0c\u4e00\u6b21\u5f9e\u8cc7\u6599\u5eab\u4e2d\u6aa2\u7d22\u6240\u6709\u7684\u5be6\u9ad4\u662f\u4e00\u7a2e\u4e0d\u597d\u7684\u505a\u6cd5\uff08\u4e0a\u9762\u7a0b\u5f0f\u78bc\u4e2d\u7684 $this->finder('XF:Post')->fetch(); \uff09\u3002 \u8ad6\u58c7\u7684\u5e16\u5b50\u53ef\u80fd\u6709\u5e7e\u767e\u842c\u500b\uff0c\u5982\u679c\u4e00\u6b21\u5168\u90e8\u9078\u53d6\u6703\u662f\u4e00\u500b\u975e\u5e38\u6f2b\u9577\u7684\u904e\u7a0b\uff0c\u6700\u5f8c\u53ef\u80fd\u9084\u6703\u51fa\u73fe\u932f\u8aa4\u3002 \u8003\u616e\u4f7f\u7528 Job \u7cfb\u7d71\u4f86\u8655\u7406\u6578\u5341\u500b\uff08100+\uff09\u8cc7\u6599\u5eab\u9805\u76ee\u3002 \u6e2c\u8a66 \u00b6 \u662f\u6642\u5019\u6e2c\u8a66\u6211\u5011\u7684\u81ea\u5b9a\u7fa9\u6e96\u5247\u985e\u578b\u4e86\uff01 \u6211\u5728\u6211\u7684\u6e2c\u8a66\u8ad6\u58c7\u4e0a\u5efa\u7acb\u4e86\u4e09\u500b\u5e16\u5b50\u3002 \u7b2c\u4e00\u500b\u5e16\u5b50\u88ab\u9ede\u8b9a 500 \u6b21\uff0c\u7b2c\u4e8c\u500b\u5e16\u5b50\u88ab\u7de8\u8f2f 5 \u6b21\u3002 \u7b2c\u4e09\u500b\u53ea\u662f\u4e00\u500b\u539f\u5c01\u4e0d\u52d5\u7684\u6c92\u6709\u88ab\u9ede\u8b9a\u7684\u5e16\u5b50\u3002 \u73fe\u5728\uff0c\u5728\u6211\u5011\u7684 \"\u5e16\u5b50\u522a\u9664\u5668\" Admin CP \u9801\u9762\u4e0a\uff0c\u8b93\u6211\u5011\u9078\u64c7 \"\u5e16\u5b50\u81f3\u5c11\u6709 X \u500b\u9ede\u8b9a\u6578\"\uff08\u503c\u70ba 250\uff09\u548c \"\u5e16\u5b50\u81f3\u5c11\u88ab\u7de8\u8f2f\u904e X \u6b21\"\uff08\u503c\u70ba 5\uff09\u3002 \u7576\u6211\u6309\u4e0b \"\u522a\u9664\" \u9375\u6642\uff0c\u6211\u770b\u5230\u4e00\u689d\u5373\u6642\u6d88\u606f\uff0c\u544a\u8a34\u6211\u4ec0\u9ebc\u90fd\u6c92\u6709\u522a\u9664\u3002 \u70ba\u4ec0\u9ebc\u5462\uff1f \u5f88\u986f\u7136\uff0c\u56e0\u70ba\u5728 \u540c\u4e00\u6642\u9593\u5167 \u6c92\u6709\u81f3\u5c11 250 \u500b\u9ede\u8b9a\u6578\u548c\u81f3\u5c11\u7de8\u8f2f\u904e 5 \u6b21\u7684\u5e16\u5b50\u3002 \u6240\u4ee5\u6211\u5011\u53ea\u9700\u8981\u9078\u64c7\u7b2c\u4e00\u500b\u6e96\u5247\uff0c\u7136\u5f8c\u9ede\u9078 \"\u522a\u9664\"\u3002 \u9019\u6a23\u5c31\u6703\u522a\u9664\u4e00\u500b\u6709 500 \u500b\u9ede\u8b9a\u6578\u7684\u5e16\u5b50\u3002 \u63a5\u4e0b\u4f86\uff0c\u6211\u5011\u53ea\u9700\u8981\u9078\u64c7\u6700\u5f8c\u4e00\u500b\u6e96\u5247\uff0c\u7136\u5f8c\u9810\u5148\u9032\u884c\u522a\u9664\u3002 \u6709\u7de8\u8f2f\u904e 5 \u6b21\u7684\u5e16\u5b50\u5c07\u88ab\u522a\u9664\u3002 \u7d50\u679c\uff0c\u53ea\u6709\u4e00\u500b\u6e2c\u8a66\u5e16\u5b50\u5728\u6e2c\u8a66\u4e2d\u5016\u5b58\u4e0b\u4f86\uff1a \u4f60\u53ef\u4ee5 \u4e0b\u8f09 \u57fa\u65bc\u9019\u500b\u7bc4\u4f8b (2.0.10) \u6240\u69cb\u5efa\u7684\u63d2\u4ef6\u539f\u59cb\u78bc\u3002 \u5728 Admin CP \u88e1\u4f60\u53ef\u4ee5\u5728 \"\u5de5\u5177\" \u7684\u90e8\u5206\u627e\u5230 \"\u5e16\u5b50\u522a\u9664\u5668\"\u3002","title":"\u6e96\u5247"},{"location":"criteria/#_1","text":"\u7576 XenForo \u9700\u8981\u6839\u64da\u4e00\u4e9b \u7528\u6236\u9078\u64c7\u7684 \u689d\u4ef6\uff08\u6e96\u5247\uff09\u4f86\u6e2c\u8a66\u67d0\u4e9b\u6771\u897f\uff08\u7528\u6236/\u9801\u9762/\u5e16\u5b50......\uff09\u6642\uff0c\u5b83\u4f7f\u7528\u6e96\u5247\u7cfb\u7d71\u3002 \u4f7f\u7528\u5230\u6e96\u5247\u7cfb\u7d71\u7684\u4e00\u4e9b\u5730\u65b9\uff1a \u6210\u5c31 \u7528\u6236\u7d44\u63d0\u5347 \u8ad6\u58c7\u516c\u544a \u9644\u52a0\u5143\u4ef6\u4e5f\u53ef\u4ee5\u4f7f\u7528\u9019\u500b\u7cfb\u7d71\u3002","title":"\u6e96\u5247"},{"location":"criteria/#_2","text":"\u8003\u616e\u4ee5\u4e0b\u6e96\u5247\uff1a - \u7528\u6236 \u6709/\u6c92\u6709 \u982d\u50cf - \u7528\u6236\u6709 300 \u591a\u689d\u7559\u8a00 - \u7528\u6236\u6b63\u5728\u5efa\u7acb\u4e00\u500b\u4e3b\u984c - \u76ee\u524d\u7528\u6236\u9078\u64c7\u7684\u5c0e\u89bd\u6a19\u7c64\u70ba \"\u6703\u54e1\" \u524d\u5169\u500b\u6e96\u5247\u662f\u6307\u7528\u6236\u672c\u4eba\u3002 \u5176\u9918\u7684\u6e96\u5247\u662f\u6307\u4ed6\u76ee\u524d\u5728\u8ad6\u58c7\u4e0a\u7684\u4f4d\u7f6e\u3002 \u9019\u6a23\u770b\u8d77\u4f86\u6211\u5011\u61c9\u8a72\u6709\u4e0d\u540c\u985e\u5225\u6216 \u985e\u578b \u7684\u6e96\u5247\u3002 \u5728 XenForo \u4e2d\uff0c\u6709\u5169\u7a2e\u958b\u7bb1\u5373\u7528\u7684\u6e96\u5247\u985e\u578b\uff1a \u7528\u6236\u6e96\u5247 \u2014 \u8655\u7406\u95dc\u65bc\u7528\u6236\u672c\u8eab\u7684\u6e96\u5247 \u9801\u9762\u6e96\u5247 \u2014 \u8655\u7406\u7528\u6236\u76ee\u524d\u4f4d\u7f6e\u7684\u6e96\u5247 + \u6642\u9593\u6e96\u5247 \u4e00\u4e9b\u9644\u52a0\u5143\u4ef6\u4e5f\u53ef\u4ee5\u65b0\u589e\u81ea\u5df1\u7684\u6e96\u5247\u985e\u578b\u3002 \u5f9e\u7a0b\u5f0f\u78bc\u7684\u89d2\u5ea6\u4f86\u770b\uff0c\u6e96\u5247\u985e\u578b\u53ea\u662f\u4e00\u500b\u62bd\u50cf\u985e AbstractCriteria \u7684\u5b50\u985e\u3002 \u5b83\u5011\u5305\u542b\u7528\u65bc\u8655\u7406\u67d0\u4e9b\u985e\u578b\u7684\u9078\u5b9a\u6e96\u5247\u7a0b\u5f0f\u78bc\u3002 \u53cd\u4e4b\uff0c AbstractCriteria \u5247\u63d0\u4f9b\u4e86\u8655\u7406\u6e96\u5247\u7684\u901a\u7528\u65b9\u6cd5\uff0c\u800c\u4e0d\u8ad6\u5176\u542b\u7fa9\u5982\u4f55\u3002","title":"\u6e96\u5247\u985e\u578b"},{"location":"criteria/#_3","text":"\u6e96\u5247\u662f\u4e00\u500b\u7528\u6236\u53ef\u9078\u64c7\u7684\u9810\u5b9a\u7fa9\u689d\u4ef6\u3002 \u70ba\u4ec0\u9ebc\u662f\u53ef\u9078\u7684\uff1f \u56e0\u70ba\u7ba1\u7406\u54e1/\u7528\u6236\u53ef\u4ee5\u9078\u64c7\u5b83\u5011\uff08\u8a18\u5f97\u6210\u5c31\u5efa\u7acb\u904e\u7a0b\uff09\u3002 \u70ba\u4ec0\u9ebc\u662f\u9810\u5b9a\u7fa9\uff1f \u56e0\u70ba XenForo \u5df2\u7d93\u77e5\u9053\u5982\u4f55\u8655\u7406\u5b83\u5011\uff08\u4f7f\u7528\u6e96\u5247\u985e\u65b9\u6cd5\uff09\u3002 \u6bcf\u500b\u6e96\u5247\u7531\u5169\u90e8\u5206\u7d44\u6210\uff1a \u898f\u5247 \u548c\uff08\u53ef\u9078\uff09 \u8cc7\u6599 \u3002","title":"\u6e96\u5247"},{"location":"criteria/#_4","text":"\u6e96\u5247\u898f\u5247\u7c21\u76f4\u5c31\u662f \u86c7\u5f62\u547d\u540d \u7684\u75db\u8655 (words_are_separated_with_underscore_character)\u3002 \u5b83\u6709\u5169\u500b\u57fa\u672c\u5b97\u65e8\uff1a \u5b83\u7528\u65bc\u5340\u5206\u6e96\u5247 \u5728\u9032\u884c\u5339\u914d\u6642\uff0c\u8a72\u898f\u5247\u88ab\u8f49\u63db\u70ba\u8655\u7406\u8a72\u6e96\u5247\u65b9\u6cd5\u7684 \u99dd\u5cf0\u5f0f \u547d\u540d (\u8acb\u53c3\u95b1 \"\u6e96\u5247\u5982\u4f55\u904b\u4f5c\" )\u3002","title":"\u898f\u5247"},{"location":"criteria/#_5","text":"\u5b83\u53ea\u662f\u4e00\u500b\u53ef\u9078\u7684\u9644\u52a0\u6e96\u5247\u8cc7\u6599\u9663\u5217\u3002 \u4f8b\u5982\uff0c\"\u7528\u6236\u81f3\u5c11\u767c\u4f48\u4e86 X \u689d\u7559\u8a00\" \u6e96\u5247\u6709\u4e00\u500b\u5305\u542b\u4e00\u500b\u8981\u7d20\u7684\u8cc7\u6599\u9663\u5217\uff1a\u6578\u5247\u6d88\u606f\u3002","title":"\u8cc7\u6599"},{"location":"criteria/#_6","text":"\u5728\u672c\u7bc0\u4e2d\uff0c\u6211\u5011\u5c07\u4ecb\u7d39\u6e96\u5247\u7cfb\u7d71\u662f\u5982\u4f55\u5f9e A \u5230 Z \u904b\u4f5c\u7684\u3002","title":"\u6e96\u5247\u7cfb\u7d71\u5982\u4f55\u904b\u4f5c"},{"location":"criteria/#_7","text":"\u9019\u4e00\u5207\u90fd\u8981\u5f9e\u6a21\u677f\u7a0b\u5f0f\u78bc\u8aaa\u8d77\u3002 \u4ee5\u4e0b\u662f\u6e96\u5247\u5728\u6a21\u677f\u4e2d\u770b\u8d77\u4f86\u7684\u6a23\u5b50\uff1a <xf:checkbox label=\"Criteria container\"> <!-- \u6e96\u5247 --> <xf:option name=\"foo_criteria[criterion_1_rule][rule]\" value=\"criterion_1_rule\" ... /> <!-- \u542b\u8cc7\u6599\u7684\u6e96\u5247 --> <xf:option name=\"bar_criteria[criterion_2_rule][rule]\" value=\"criterion_2_rule\" ... > <xf:... name=\"bar_criteria[criterion_2_rule][data][param_1]\" ... /> <xf:... name=\"bar_criteria[criterion_2_rule][data][param_2]\" ... /> </xf:option> </xf:checkbox> \u5982\u4f60\u6240\u898b\uff0c\u6e96\u5247\u53ea\u662f\u4e00\u500b\u6838\u53d6\u65b9\u584a\uff0c\u88e1\u9762\u6709\u53ef\u9078\u7684\u8f38\u5165\u6b04\u4f4d\uff08\u6e96\u5247\u8cc7\u6599\uff09\u3002 \u6211\u5011\u4f86\u5206\u6790\u4e00\u4e0b\u7a0b\u5f0f\u78bc\uff1a foo_criteria \u548c bar_criteria \u662f input \u5bb9\u5668\uff0c\u901a\u5e38 foo \u548c bar \u90e8\u5206\u662f\u6307\u6e96\u5247\u985e\u578b\u3002 \u4f8b\u5982\uff0c user_criteria[...] \u8b93\u6211\u5011\u77e5\u9053\u9019\u500b\u6e96\u5247\u5c6c\u65bc\u7528\u6236\u6e96\u5247\u3002 value=\"criterion_1_rule\" \u548c value=\"criterion_2_rule\" \u986f\u7136\u662f\u6e96\u5247\u7684\u898f\u5247\u3002 Note \u8acb\u8a18\u4f4f\uff0c name \u5c6c\u6027\u4e2d\u7684 criterion_1/2_rule \u4e0d\u4e00\u5b9a\u662f\u6e96\u5247\u898f\u5247\uff01 \u9019\u4e9b\u53ea\u662f input \u5bb9\u5668\u7684\u540d\u7a31\u3002 \u4f60\u53ef\u4ee5\u8f15\u800c\u6613\u8209\u5730\u5beb\u4e0b <xf:option name=\"foo[bar][rule]\" value=\"criterion_rule\" /> \uff0c\u5b83\u5c31\u6703\u6b63\u78ba\u5730\u904b\u4f5c\u3002 \u6e96\u5247\u898f\u5247\u6703\u662f criterion_rule \uff0c\u800c\u4e0d\u662f bar \u3002","title":"\u6a21\u677f"},{"location":"criteria/#_8","text":"\u5728 Controller \u5167\u90e8\uff0c\u53ef\u4ee5\u5c07\u4e0a\u4e00\u7bc0\u7684\u6e96\u5247\u8868\u55ae\u8cc7\u6599\u9032\u884c\u7be9\u9078\u3001\u7de8\u78bc\uff0c\u4e26\u5132\u5b58\u5728 mediumblob \u985e\u578b\u7684\u8cc7\u6599\u5eab Column \u4e2d\uff0c\u4ee5\u4fbf\u66f4\u597d\u5730\u4f7f\u7528\uff1a $fooCriteriaInput = $this->filter('foo_criteria', 'array'); $barCriteriaInput = $this->filter('bar_criteria', 'array'); $form->basicEntitySave($bazEntity, [ 'foo_criteria' => $fooCriteriaInput, 'bar_criteria' => $barCriteriaInput ]); $bazEntity Structure \u793a\u4f8b\uff1a public static function getStructure(Structure $structure) { $structure->table = 'xf_baz'; $structure->shortName = 'XF:Baz'; $structure->primaryKey = 'baz_id'; $structure->columns = [ 'baz_id' => ['type' => self::UINT, 'autoIncrement' => true], 'foo_criteria' => ['type' => self::JSON_ARRAY, 'default' => [], 'required' => 'please_select_criteria_that_must_be_met'], 'bar_criteria' => ['type' => self::JSON_ARRAY, 'default' => []] ]; return $structure; }","title":"(\u53ef\u9078) \u5132\u5b58\u9078\u5b9a\u7684\u6e96\u5247"},{"location":"criteria/#_9","text":"\u70ba\u4e86\u4f7f\u7528\u6e96\u5247\u7cfb\u7d71\uff0c\u6211\u5011\u9700\u8981\u5f9e\u9078\u5b9a\u7684\u6e96\u5247\u8868\u55ae\u8cc7\u6599\u4e2d\u5efa\u7acb\u4e00\u500b\u6e96\u5247\u7269\u4ef6\uff0c\u9019\u53ef\u4ee5\u901a\u904e app \u7684 criteria() \u65b9\u6cd5\u4f86\u5b8c\u6210\uff1a /** @var \\Qux\\Criteria\\Foo $fooCriteria */ $fooCriteria = \\XF::app()->criteria('Qux:Foo', $bazEntity->foo_criteria); /** @var \\Qux\\Criteria\\Bar $barCriteria */ $barCriteria = \\XF::app()->criteria('Qux:Bar', $bazEntity->bar_criteria); \u5f9e\u73fe\u5728\u958b\u59cb\uff0c\u6211\u5011\u53ef\u4ee5\u4f7f\u7528\u6240\u6709\u7684 AbstractCriteria \u529f\u80fd\uff0c\u52a0\u4e0a\u6211\u5011\u5728\u5b50\u985e Foo / Bar \u4e2d\u984d\u5916\u7de8\u5beb\u7684\u6240\u6709\u5167\u5bb9\u3002","title":"\u6e96\u5247\u7269\u4ef6"},{"location":"criteria/#_10","text":"\u7576\u6211\u5011\u60f3\u6aa2\u67e5\u67d0\u500b\u6771\u897f\uff08User\uff09\u662f\u5426\u7b26\u5408\u9078\u5b9a\u7684\u6e96\u5247\u6642\uff0c\u6211\u5011\u53ef\u4ee5\u4f7f\u7528 isMatched \u65b9\u6cd5\uff1a $visitor= \\XF::visitor(); if ($fooCriteria->isMatched($visitor)) { // \u8a2a\u5ba2\u7b26\u5408\u6240\u6709\u9078\u5b9a\u7684\u6e96\u5247 } else { // \u8a2a\u5ba2\u4e0d\u7b26\u5408\u4e00\u500b\u6216\u591a\u500b\u6e96\u5247 } isMacthed() \u5c07\u6e96\u5247\u898f\u5247\u8f49\u63db\u70ba\u5e36\u6709 _match \u524d\u7db4\u7684\u99dd\u5cf0\u5f0f\u547d\u540d\u65b9\u6cd5\uff1a criterion_1_rule > _matchCriterion1Rule \uff0c\u4e26\u5617\u8a66\u5728\u6e96\u5247\uff1a\u578b class \u4e2d\u627e\u5230\u9019\u6a23\u4e00\u500b\u65b9\u6cd5\uff08\u5728\u6211\u5011\u7684\u4f8b\u5b50\u4e2d\u662f Foo \u985e\uff09\uff1a // Qux/Criteria/Foo.php protected function _matchCriterion1Rule(array $data, \\XF\\Entity\\User $user) { /* ... \u8655\u7406\u6e96\u5247 ... */ return true; // \u7528\u6236\u7b26\u5408\u76ee\u524d\u6e96\u5247 /* \u6216\u8005 */ return false; // \u7528\u6236\u4e0d\u7b26\u5408\u76ee\u524d\u6e96\u5247 } \u5982\u679c\u5728 class \u4e2d\u627e\u4e0d\u5230\u67d0\u500b\u65b9\u6cd5\uff0c isMatched() \u6703\u547c\u53eb isUnknownMatched() \uff0c\u5176\u884c\u70ba\u53ef\u4ee5\u5728 AbstractCriteria \u7956\u5148\u4e2d\u8a2d\u5b9a\uff08\u9810\u8a2d\u8fd4\u56de false \uff09\u3002 \u5982\u679c\u6c92\u6709\u9078\u5b9a\u4efb\u4f55\u6e96\u5247\uff0c isMatched() \u5c07\u8fd4\u56de $matchOnEmpty \u8b8a\u6578\uff0c\u9810\u8a2d\u70ba true \u3002 \u4f60\u53ef\u4ee5\u5728\u4f7f\u7528 isMatched() \u65b9\u6cd5 \u4e4b\u524d \u547c\u53eb $crteriaObj->setMatchOnEmpty(false) \u4f86\u6539\u8b8a\u9019\u7a2e\u884c\u70ba\uff1a $visitor= \\XF::visitor(); $fooCriteria->setMatchOnEmpty(false); if ($fooCriteria->isMatched($visitor)) { // \u8a2a\u5ba2\u7b26\u5408\u6240\u6709\u9078\u5b9a\u7684\u6e96\u5247 } else { // \u8a2a\u5ba2\u4e0d\u7b26\u5408\u4e00\u500b\u6216\u591a\u500b\u6e96\u5247 }","title":"\u5339\u914d"},{"location":"criteria/#_11","text":"\u60f3\u50cf\u4e00\u4e0b\uff0c\u4f60\u60f3\u7d66\u6240\u6709\u64c1\u6709\u982d\u50cf\u4e26\u7372\u5f97\u81f3\u5c11 5 \u500b\u8b9a\u7684\u7528\u6236\u9812\u767c\u4e00\u500b\u6210\u5c31\u3002 \u5728\u5efa\u7acb\u6210\u5c31\u6642\uff0c\u4f60\u9078\u64c7 \"\u7528\u6236\u6709\u982d\u50cf\"\uff08\u898f\u5247 has_avatar \uff09\u548c \"\u7528\u6236\u81f3\u5c11\u6536\u5230 X \u500b\u8b9a\"\uff08\u898f\u5247 like_count \uff09\u6e96\u5247\u3002 \u6700\u5f8c\u4e00\u500b\u9084\u5177\u6709\u4e00\u500b\u5305\u542b\u4e00\u500b\u5143\u7d20\u7684\u8cc7\u6599\u9663\u5217\uff1a\u559c\u6b61\u7684\u6578\u91cf\u3002 \u60a8\u6240\u9078\u64c7\u7684\u6e96\u5247\u5132\u5b58\u5728 xf_trophy \u8cc7\u6599\u8868\u4e2d\u7684 user_criteria column\u3002 \u7576 XenForo \u6c7a\u5b9a\u6aa2\u67e5\uff0c\u662f\u5426\u7d66\u7528\u6236\u9812\u767c\u6210\u5c31\u6642\uff0c\u5b83\u6703\u5c07\u898f\u5247\u8f49\u63db\u70ba\u99dd\u5cf0\u5f0f\u547d\u540d\u65b9\u6cd5\uff1a like_count > _matchLikeCount() has_avatar > _matchHasAvatar() \u7531\u65bc\u6240\u9078\u7684\u5169\u500b\u6e96\u5247\u90fd\u662f\u7528\u6236\u6e96\u5247\uff0c\u56e0\u6b64 XenForo \u6eff\u8db3\u7528\u6236\u6e96\u5247 class\uff0c\u4e26\u8a66\u5716\u5728\u5176\u4e2d\u627e\u5230\u9019\u4e9b\u65b9\u6cd5\uff1a // XF/Criteria/User.php //... protected function _matchLikeCount(array $data, \\XF\\Entity\\User $user) { return ($user->like_count && $user->like_count >= $data['likes']); } //... protected function _matchHasAvatar(array $data, \\XF\\Entity\\User $user) { return $user->user_id && ($user->avatar_date || $user->gravatar); } //... \u5982\u679c \u6240\u6709 \u4f4d\u7f6e\u7684\u65b9\u6cd5\u90fd\u8fd4\u56de true \uff0c\u6211\u5011\u7684\u7528\u6236\u5c31\u7b26\u5408\u9078\u5b9a\u7684\u6e96\u5247\uff0c\u56e0\u6b64\u5c07\u7372\u5f97\u4e00\u500b\u6210\u5c31\u3002 \u5982\u679c\u5728 User \u6e96\u5247\u985e\u4e2d\u627e\u4e0d\u5230\u67d0\u4e9b\u65b9\u6cd5\uff0cXenForo \u6703\u547c\u53eb isUnknownMatched() \u65b9\u6cd5\uff0c\u9032\u800c\u89f8\u767c criteria_user \u4e8b\u4ef6\uff0c\u5141\u8a31\u9644\u52a0\u5143\u4ef6\u88fd\u4f5c\u8005\u65b0\u589e\u4ed6\u5011\u7684\u81ea\u5b9a\u7fa9\u6e96\u5247\u8655\u7406\u7a0b\u5f0f\u3002 \uff08\u53c3\u898b \"\u81ea\u5b9a\u7fa9\u7528\u6236/\u9801\u9762\u6e96\u5247\u7bc4\u4f8b\" \uff09\u3002","title":"\u6e96\u5247\u662f\u5982\u4f55\u904b\u4f5c\u7684 (\u7bc4\u4f8b)"},{"location":"criteria/#_12","text":"\u6709\u6642\uff0c\u5728\u7de8\u5beb\u6e96\u5247\u6a21\u677f\u7a0b\u5f0f\u78bc\u6642\uff0c\u4f60\u9700\u8981\u8a2a\u554f\u984d\u5916\u7684\u8cc7\u6599\uff0c\u800c\u9019\u4e9b\u8cc7\u6599\u4e0d\u662f\u901a\u904e view \u53c3\u6578\u50b3\u905e\u7684\u3002 \u9019\u5c31\u662f getExtraTemplateData() \u65b9\u6cd5\u5b58\u5728\u7684\u610f\u7fa9\u3002 \u9810\u8a2d\u60c5\u6cc1\u4e0b\uff0c\u5b83\u5305\u542b\u73fe\u6709\u7684\u7528\u6236\u7d44\u3001\u8a9e\u8a00\u3001\u98a8\u683c\u6a23\u5f0f\u3001\u6642\u5340\u3002 \u4f60\u53ef\u4ee5\u5728\u4f60\u7684\u81ea\u5b9a\u7fa9\u6e96\u5247\u985e\u578b class \u4e2d\u8986\u84cb\u9019\u500b\u65b9\u6cd5\u3002","title":"\u984d\u5916\u6e96\u5247\u8cc7\u6599"},{"location":"criteria/#_13","text":"\u5728\u60a8\u7684\u81ea\u5b9a\u7fa9\u6e96\u5247 class \u4e2d\u8986\u84cb getExtraTemplateData() \u65b9\u6cd5\uff1a public function getExtraTemplateData() { $templateData = parent::getExtraTemplateData(); $additionalData = []; /** @var \\XF\\Repository\\Smilie $smilieRepo */ $smilieRepo = \\XF::repository('XF:Smilie'); $additionalData['smilies'] = $smilieRepo->findSmiliesForList()->fetch(); return array_merge($templateData, $additionalData); }","title":"\u5728\u81ea\u5b9a\u7fa9\u6e96\u5247\u985e\u578b\u4e2d\u65b0\u589e\u8cc7\u6599"},{"location":"criteria/#_14","text":"\u4f60\u53ef\u4ee5\u4f7f\u7528 criteria_template_data \u4e8b\u4ef6\u76e3\u807d\u5668\u4f86\u65b0\u589e\u4f60\u81ea\u5df1\u7684\u984d\u5916\u6e96\u5247\u8cc7\u6599\uff1a public static function criteriaTemplateData(array &$templateData) { /** @var \\XF\\Repository\\Smilie $smilieRepo */ $smilieRepo = \\XF::repository('XF:Smilie'); $templateData['smilies'] = $smilieRepo->findSmiliesForList()->fetch(); }","title":"\u5728\u73fe\u6709\u6e96\u5247\u985e\u578b\u4e2d\u65b0\u589e\u8cc7\u6599"},{"location":"criteria/#helper_criteria","text":"\u6bcf\u7576\u4f60\u4f5c\u70ba\u9644\u52a0\u5143\u4ef6\u88fd\u4f5c\u8005\u60f3\u8b93\u76ee\u6a19 \u7528\u6236/\u7ba1\u7406\u54e1 \u6709\u8fa6\u6cd5\u9078\u64c7 \u7528\u6236/\u9801\u9762/\u5176\u4ed6\u9644\u52a0\u5143\u4ef6 \u7684\u6e96\u5247\u6642\uff08\u751a\u81f3\u5168\u90e8\u4e00\u8d77\uff09\uff0c\u4f60\u53ef\u4ee5\u7c21\u55ae\u5730\u4f7f\u7528 helper_criteria \u3002 \u7c21\u800c\u8a00\u4e4b\uff0c helper_criteria \u662f\u4e00\u500b\u5141\u8a31\u5728\u591a\u8655\u4f7f\u7528\u57fa\u65bc\u6e96\u5247\u985e\u578b\u7684\u6838\u53d6\u65b9\u584a\u4ecb\u9762\u7684\u7ba1\u7406\u6a21\u677f\uff0c\u7121\u9700\u8907\u88fd\u8cbc\u4e0a\u76f8\u540c\u7a0b\u5f0f\u78bc\u3002 helper_criteria \u5305\u542b \u5169\u500b \u985e\u578b\u7684\u5de8\u96c6\uff1a *criteria_name*_tabs \u548c *criteria_name*_panes \uff0c\u9069\u7528\u65bc\u6bcf\u500b\u6e96\u5247\u985e\u578b\u3002 \u4f8b\u5982\uff1a\u7528\u6236\u6e96\u5247\u985e\u578b\u7684 user_tabs \u548c user_panes \u5de8\u96c6\u3002","title":"\"helper_criteria\" \u6a21\u677f"},{"location":"criteria/#_15","text":"\u6a19\u7c64\u7528\u65bc\u5340\u5206\u4ed6\u5011\u6240\u4f7f\u7528\u6a21\u677f\u5167\u7684\u4e0d\u540c\u6e96\u5247\u985e\u578b\uff1a \u4f7f\u7528\u6a19\u7c64\u6642\uff0c\u7b2c\u4e00\u500b\u6a19\u7c64\u5f80\u5f80\u5305\u542b\u8207\u6e96\u5247\u7121\u95dc\u7684\u6b04\u4f4d/\u9078\u9805\u3002 \u7136\u5f8c\u5230\u6e96\u5247\u6a19\u7c64\u3002 \u5728\u4e0a\u5716\u4e2d\uff0c\u7b2c\u4e00\u500b\u6a19\u7c64\u5305\u542b\u901a\u77e5\u7684\u9078\u9805\u3002 \u7d05\u6846\u4e2d\u7684\u524d\u5169\u500b\u6a19\u7c64\u8207\u7528\u6236\u6e96\u5247\u985e\u578b\u6709\u95dc\u3002 \u6700\u5f8c\u4e00\u500b\u8207\u9801\u9762\u6e96\u5247\u985e\u578b\u6709\u95dc\u3002 helper_criteria \u4e2d\u7684\u6a19\u7c64\u88ab\u6b78\u985e\u5728\u6e96\u5247\u985e\u578b\u5de8\u96c6\u4e0b\uff1a <xf:macro name=\"foo_tabs\" arg-container=\"\" arg-active=\"\"> <xf:set var=\"$tabs\"> <a class=\"tabs-tab{{ $active == 'foo' ? ' is-active' : '' }}\" role=\"tab\" tabindex=\"0\" aria-controls=\"{{ unique_id('criteriaFoo') }}\">Foo criteria</a> <a class=\"tabs-tab{{ $active == 'foo_extra' ? ' is-active' : '' }}\" role=\"tab\" tabindex=\"0\" aria-controls=\"{{ unique_id('criteriaFooExtra') }}\">Foo criteria extra</a> </xf:set> <xf:if is=\"$container\"> <div class=\"tabs\" role=\"tablist\"> {$tabs|raw} </div> <xf:else /> {$tabs|raw} </xf:if> </xf:macro> In the code above, foo is a criteria type. It has two tabs, one for general foo criteria and another for extra foo criteria. \u5728\u4e0a\u9762\u7684\u7a0b\u5f0f\u78bc\u4e2d\uff0c foo \u662f\u4e00\u500b\u6e96\u5247\u985e\u578b\u3002 \u5b83\u6709\u5169\u500b\u6a19\u7c64\uff0c\u4e00\u500b\u7528\u65bc\u4e00\u822c\u7684 foo \u6e96\u5247\uff0c\u53e6\u4e00\u500b\u7528\u65bc\u984d\u5916\u7684 foo \u6e96\u5247\u3002","title":"\u6a19\u7c64"},{"location":"criteria/#panes","text":"Panes \u50c5\u50c5\u5305\u542b\u6e96\u5247\u3002 \u548c\u6a19\u7c64\u4e00\u6a23\uff0c helper_criteria \u4e2d\u7684 Panes \u4e5f\u662f\u6309\u7167\u6e96\u5247\u985e\u578b\u5de8\u96c6\u4f86\u6b78\u985e\u7684\uff1a <xf:macro name=\"foo_panes\" arg-container=\"\" arg-active=\"\" arg-criteria=\"!\" arg-data=\"!\"> <xf:set var=\"$panes\"> <li class=\"{{ $active == 'foo' ? ' is-active' : '' }}\" role=\"tabpanel\" id=\"{{ unique_id('criteriaFoo') }}\"> <xf:checkboxrow label=\"Criteria group 1\"> <xf:option name=\"foo_criteria[criterion_1_rule][rule]\" value=\"criterion_1_rule\" ... /> <xf:option name=\"foo_criteria[criterion_2_rule][rule]\" value=\"criterion_2_rule\" ... /> </xf:checkboxrow> <xf:checkboxrow label=\"Criteria group 2\"> <xf:option name=\"foo_criteria[criterion_3_rule][rule]\" value=\"criterion_3_rule\" ... /> <xf:option name=\"foo_criteria[criterion_4_rule][rule]\" value=\"criterion_4_rule\" ... /> </xf:checkboxrow> </li> </xf:set> <xf:if is=\"$container\"> <ul class=\"tabPanes\"> {$panes|raw} </ul> <xf:else /> {$panes|raw} </xf:if> </xf:macro>","title":"Panes (\u7a97\u683c)"},{"location":"criteria/#helper_criteria_1","text":"\u8981\u4f7f\u7528 \"helper_criteria\" \u7684\u529f\u80fd\uff0c\u4f60\u9700\u8981\u52a0\u5165\u5b83\u7684\u5de8\u96c6\u3002","title":"\u4f7f\u7528 \"helper_criteria\""},{"location":"criteria/#_16","text":"\u5982\u679c\u60a8 \u6c92\u6709 \u60a8\u6240\u9078\u5b9a\u7684\u6e96\u5247\u5132\u5b58\u5728\u8cc7\u6599\u5eab\u4e2d\u7684\u67d0\u500b\u5730\u65b9\uff0c\u6216\u8005\u60a8\u8981\u4f7f\u7528\u7684\u6e96\u5247\u985e\u578b \u4e0d\u9700\u8981 \u4efb\u4f55\u984d\u5916\u7684\u8cc7\u6599\uff0c\u53ef\u4ee5\u8df3\u904e\u672c\u7bc0\u3002 \u9996\u5148\uff0c\u60a8\u9700\u8981\u6aa2\u7d22\u5df2\u5132\u5b58\u7684\u9078\u5b9a\u6e96\u5247\uff0c\u4e26\u5f9e\u4e2d\u5efa\u7acb\u4e00\u500b\u6e96\u5247\u7269\u4ef6\u3002 \u5728\u672c\u7bc0\u4e2d\uff0c\u6211\u5011\u5c07\u4ee5 Page \u6e96\u5247\u70ba\u4f8b\u5b50\uff1a $savedCriteria = /* Retrieve it somehow... */ // \u6e96\u5247\u7269\u4ef6 $criteria = $this->app()->criteria('XF:Page', $savedCriteria)->getCriteriaForTemplate(); // \u6e96\u5247\u984d\u5916\u8cc7\u6599 $criteriaData = $criteria->getExtraTemplateData(); $viewParams = [ /* ... */ 'criteria' => $criteria, 'criteriaData' => $criteriaData ]; return $this->view(/* ... */, $viewParams);","title":"\u6e96\u5099\u8cc7\u6599"},{"location":"criteria/#_17","text":"\u8981\u5305\u542b\u6c92\u6709\u5167\u5bb9\u7684\u6a19\u7c64\u6e96\u5247\uff0c\u4f60\u9700\u8981\u4f7f\u7528 <xf:macro... \u6a19\u7c64\uff0c\u4e26\u5c07 arg-container \u5c6c\u6027\u8a2d\u5b9a\u70ba 0 \u3002 <xf:macro template=\"helper_criteria\" name=\"page_panes\" arg-container=\"0\" arg-criteria=\"{$criteria}\" arg-data=\"{$criteriaData}\" /> \u5982\u679c\u4f60\u6c92\u6709\u4fdd\u5b58\u6e96\u5247\uff0c\u4f60\u53ef\u4ee5\u76f4\u63a5\u5c07\u7a7a\u9663\u5217 {{ [] }} \u50b3\u905e\u7d66 arg-criteria \u5c6c\u6027\u3002 \u4e0d\u8981\u5fd8\u8a18\u628a page_panes \u4e2d\u7684 page \u66ff\u63db\u6210\u4f60\u60f3\u4f7f\u7528\u7684\u6e96\u5247\u985e\u578b\u540d\u7a31\u3002 \u8acb\u8a18\u4f4f\uff0c\u6240\u6709\u7684\u6e96\u5247\u90fd\u662f\u7528 <li> \u6a19\u7c64\u5305\u4f4f\u7684\uff0c\u6240\u4ee5\u4f60\u9700\u8981\u61c9\u7528\u4e00\u4e9b CSS \u6a23\u5f0f\uff08\u4f8b\u5982 list-style-type: none; \uff09\u3002","title":"\u5305\u542b\u6c92\u6709\u5167\u5bb9\u7684\u6a19\u7c64"},{"location":"criteria/#_18","text":"\u70ba\u4e86\u4f7f\u7528\u6e96\u5247\u6a19\u7c64\uff0c\u4f60\u9700\u8981\u7d44\u7e54\u9801\u9762\u3002 \u5805\u6301\u4ee5\u4e0b\u7bc4\u4f8b\u7d50\u69cb\uff1a <xf:form ... class=\"block\"> <div class=\"block-container\"> <!-- \u6a19\u7c64 --> <h2 class=\"block-tabHeader tabs hScroller\" data-xf-init=\"h-scroller tabs\" role=\"tablist\"> <span class=\"hScroller-scroll\"> <!-- Main tab where fields/options are located --> <a class=\"tabs-tab is-active\" role=\"tab\" tabindex=\"0\" aria-controls=\"MAIN_TAB_ID\">Main tab title</a> <!-- \u6e96\u5247\u6a19\u7c64 --> <xf:macro template=\"helper_criteria\" name=\"page_tabs\" arg-userTabTitle=\"Custom tab name (optionally)\" /> </span> </h2> <!-- \u7a97\u683c --> <ul class=\"block-body tabPanes\"> <!-- Main pane --> <li class=\"is-active\" role=\"tabpanel\" id=\"MAIN_TAB_ID\"> <!-- Fields and options --> </li> <!-- \u6e96\u5247\u7a97\u683c --> <xf:macro template=\"helper_criteria\" name=\"page_panes\" arg-criteria=\"{$criteria}\" arg-data=\"{$criteriaData}\" /> </ul> <xf:submitrow sticky=\"true\" icon=\"save\" /> </div> </xf:form> \u540c\u6a23\uff0c\u5982\u679c\u4f60\u6c92\u6709\u4efb\u4f55\u6e96\u5247\u6578\u64da\uff0c\u6216\u8005\u751a\u81f3\u5047\u8a2d\u6c92\u6709\uff0c\u8acb\u5c07 {{ [] }} \u50b3\u905e\u7d66 arg-criteria \u5c6c\u6027\u3002","title":"\u6709\u5167\u5bb9\u7684\u6a19\u7c64"},{"location":"criteria/#helper_criteria_2","text":"\u5982\u679c\u4f60\u60f3\u5728 helper_criteira \u6a21\u677f\u4e2d\u65b0\u589e\u81ea\u5b9a\u7fa9\u6e96\u5247\u985e\u578b\uff0c\u4f60\u9700\u8981\u5efa\u7acb\u4e00\u500b helper_criteria \u6a21\u677f\u7684\u6a21\u677f\u4fee\u6539\u3002 \u9032\u5165 Admin CP \u4e2d\u7684 \"\u5916\u89c0 > \u6a21\u677f\u4fee\u6539\"\uff0c\u5207\u63db\u5230 \"\u7ba1\u7406\" \u6a19\u7c64\uff0c\u9ede\u9078 \"\u65b0\u589e\u6a21\u677f\u4fee\u6539\" \u6309\u9215\u3002 \u6211\u5011\u8981\u5728\u6a21\u677f\u7684\u6700\u5e95\u90e8\u65b0\u589e\u6211\u5011\u7684\u6a19\u7c64\u548c\u7a97\u683c\uff0c\u6240\u4ee5\u5c07 \"\u641c\u5c0b\u985e\u578b\" \u5207\u63db\u70ba \"\u6b63\u898f\u8868\u9054\u5f0f\"\u3002 \u5728 \"\u67e5\u8a62\" \u6b04\u4e2d\u8f38\u5165 /$/ \u3002 \u6700\u5f8c\uff0c\u5728 \"\u66ff\u63db\" \u6b04\u4f4d\u4e2d\u65b0\u589e\u6a19\u7c64\u548c\u7a97\u683c\u7684\u5de8\u96c6\u7a0b\u5f0f\u78bc\u3002 \u8209\u4f8b\uff1a <xf:macro name=\"foo_tabs\" arg-container=\"\" arg-active=\"\"> <xf:set var=\"$tabs\"> <a class=\"tabs-tab{{ $active == 'foo' ? ' is-active' : '' }}\" role=\"tab\" tabindex=\"0\" aria-controls=\"{{ unique_id('criteriaFoo') }}\">Foo criteria</a> <a class=\"tabs-tab{{ $active == 'foo_extra' ? ' is-active' : '' }}\" role=\"tab\" tabindex=\"0\" aria-controls=\"{{ unique_id('criteriaFooExtra') }}\">Foo criteria extra</a> </xf:set> <xf:if is=\"$container\"> <div class=\"tabs\" role=\"tablist\"> {$tabs|raw} </div> <xf:else /> {$tabs|raw} </xf:if> </xf:macro> <xf:macro name=\"foo_panes\" arg-container=\"\" arg-active=\"\" arg-criteria=\"!\" arg-data=\"!\"> <xf:set var=\"$panes\"> <li class=\"{{ $active == 'foo' ? ' is-active' : '' }}\" role=\"tabpanel\" id=\"{{ unique_id('criteriaFoo') }}\"> <xf:checkboxrow label=\"Criteria group 1\"> <xf:option name=\"foo_criteria[criterion_1_rule][rule]\" value=\"criterion_1_rule\" ... /> <xf:option name=\"foo_criteria[criterion_2_rule][rule]\" value=\"criterion_2_rule\" ... /> </xf:checkboxrow> <xf:checkboxrow label=\"Criteria group 2\"> <xf:option name=\"foo_criteria[criterion_3_rule][rule]\" value=\"criterion_3_rule\" ... /> <xf:option name=\"foo_criteria[criterion_4_rule][rule]\" value=\"criterion_4_rule\" ... /> </xf:checkboxrow> </li> </xf:set> <xf:if is=\"$container\"> <ul class=\"tabPanes\"> {$panes|raw} </ul> <xf:else /> {$panes|raw} </xf:if> </xf:macro> \u73fe\u5728\uff0c\u60a8\u53ef\u4ee5\u5728\u4efb\u4f55\u5730\u65b9\u4f7f\u7528\u60a8\u7684\u6e96\u5247\uff08\u8acb\u53c3\u898b \"\u4f7f\u7528helper_criteria\" )\u3002","title":"\u5728 \"helper_criteria\" \u4e2d\u6dfb\u52a0\u81ea\u5b9a\u7fa9\u6e96\u5247\u985e\u578b"},{"location":"criteria/#_19","text":"\u6bd4\u65b9\u8aaa\uff0c\u6211\u5011\u60f3\u5efa\u7acb\u4e00\u500b\u6e96\u5247\u4f86\u6aa2\u67e5\u6211\u5011\u7684\u7528\u6236\u662f\u5426\u5728\u55ae\u5247\u7559\u8a00\u4e0a\u6709 X \u500b\u6216\u66f4\u591a\u7684\u8b9a\u3002 \u7531\u65bc\u6211\u5011\u7684\u6e96\u5247\u662f\u6307\u7528\u6236\uff0c\u6240\u4ee5\u6211\u5011\u5c07\u5efa\u7acb\u4e00\u500b\u5c6c\u65bc\u7528\u6236\u6e96\u5247\u7684\u6e96\u5247\u3002","title":"\u81ea\u5b9a\u7fa9\u7528\u6236/\u9801\u9762\u6e96\u5247\u7bc4\u4f8b"},{"location":"criteria/#_20","text":"\u9996\u5148\uff0c\u6211\u5011\u9700\u8981\u5c07\u6211\u5011\u7684\u6e96\u5247\u65b0\u589e\u5230\u7528\u6236\u6e96\u5247\u5217\u8868\u4e2d\u3002 \u9032\u5165 Admin CP \u4e2d\u7684 \"\u6a21\u677f\u4fee\u6539\" \u9801\u9762\uff0c\u9078\u64c7 \"Admin\" \u6a19\u7c64\uff0c\u9ede\u9078\u53f3\u4e0a\u89d2\u7684 \"\u65b0\u589e\u6a21\u677f\u4fee\u6539\" \u6309\u9215\u3002 Warning \u5982\u679c\u6c92\u6709 \"Admin\" \u6a19\u7c64\uff0c\u8acb\u78ba\u4fdd\u4f60\u5df2\u7d93\u555f\u7528\u4e86 \u958b\u767c\u6a21\u5f0f \u3002 \u6211\u5011\u5c07\u4fee\u6539 helper_criteria \u6a21\u677f\uff0c\u56e0\u6b64\u5c07\u5176\u5beb\u5165\u5230 \"\u6a21\u677f\" \u6b04\u4f4d\u3002 \u5728\u9019\u500b\u4f8b\u5b50\u4e2d\uff0c\u6211\u5c07\u4f7f\u7528 likes_on_single_message \"\u4fee\u6539 key \u503c\" \u4f86\u4fee\u6539\u9019\u500b\u6a21\u677f\u3002 \u6211\u5011\u7684\u6e96\u5247\u662f\u95dc\u65bc\u7559\u8a00\u7684\u9ede\u8b9a\u6578\u3002 \u9019\u610f\u5473\u8457\u5b83\u61c9\u8a72\u5728 \"\u5167\u5bb9\u548c\u6210\u5c31\" \u90e8\u5206\u4e0b\u3002 \u9019\u8868\u793a\u6211\u5011\u53ea\u9700\u8981\u627e\u5230 <\uff01--[XF:user:content_bottom]--> \uff0c\u7136\u5f8c\u7528\u4e0b\u9762\u7684\u7a0b\u5f0f\u78bc\u66ff\u63db\u3002 <xf:option name=\"user_criteria[likes_on_single][rule]\" value=\"likes_on_single\" selected=\"{$criteria.likes_on_single}\" label=\"Likes on single message:\"> <xf:numberbox name=\"user_criteria[likes_on_single][data][likes]\" value=\"{$criteria.likes_on_single.likes}\" size=\"5\" min=\"0\" step=\"1\" /> </xf:option> $0 \u5f9e\u9019\u4e00\u523b\u8d77\uff0c\u6211\u5011\u5df2\u7d93\u53ef\u4ee5\u770b\u5230\uff0c\u751a\u81f3\u53ef\u4ee5\u5728\u5efa\u7acb\u6210\u5c31\u3001\u901a\u77e5\u548c\u63d0\u5347\u7528\u6236\u7d44\u6642\u70ba\u6211\u5011\u7684\u6e96\u5247\u8a2d\u5b9a\u4e00\u500b\u503c\u3002","title":"\u589e\u52a0\u6a21\u677f\u4fee\u6539"},{"location":"criteria/#_21","text":"\u6211\u5011\u5df2\u7d93\u5efa\u7acb\u4e86\u6211\u5011\u7684\u6e96\u5247\u3002 \u4f46\u5c0d\u65bc XenForo \u4f86\u8aaa\uff0c\u5b83\u662f\u672a\u77e5\u7684\uff0c\u7576\u7b26\u5408\u9019\u7a2e\u6e96\u5247\u6642\uff0c\u5b83\u7e3d\u662f\u8fd4\u56de \"false\"\u3002 \u6211\u5011\u9700\u8981\u544a\u8a34 XenForo\uff0c\u7576\u5b83\u7b26\u5408\u672a\u77e5\u6e96\u5247\u6642\u8a72\u600e\u9ebc\u505a\u3002 \u9032\u5165 \"\u958b\u767c > \u7a0b\u5f0f\u78bc\u4e8b\u4ef6\u76e3\u807d\u5668\" \u9801\u9762\uff0c\u9ede\u9078 \"\u65b0\u589e\u7a0b\u5f0f\u78bc\u4e8b\u4ef6\u76e3\u807d\u5668\" \u6309\u9215\u3002 \u5728 \"\u76e3\u807d\u4e8b\u4ef6\" \u6b04\u4f4d\u4e2d\u9078\u64c7 criteria_user \uff08 user \u56e0\u70ba\u6211\u5011\u7684\u6e96\u5247\u5c6c\u65bc\u7528\u6236\u6e96\u5247\uff09\u3002 \u5728 \"\u57f7\u884c callback\" \u6b04\u4f4d\u4e2d\uff0c\u6211\u5011\u61c9\u8a72\u6307\u5b9a\u5339\u914d\u6e96\u5247\u6642\u8981\u547c\u53eb\u7684\u985e\u548c\u65b9\u6cd5\u3002 \u5728 addon \u6839\u76ee\u9304\u4e0b\u5efa\u7acb\u4e00\u500b\u6a94\u6848 Listener.php \uff0c\u5982\u679c\u4f60\u9084\u6c92\u6709\u7684\u8a71\uff0c\u5728\u90a3\u88e1\u65b0\u589e\u4e00\u500b\u65b0\u7684\u65b9\u6cd5 criteriaUser \uff1a <?php namespace YOUR_ADDON_ID; class Listener { public static function criteriaUser($rule, array $data, \\XF\\Entity\\User $user, &$returnValue) { } } \u4f60\u53ef\u4ee5\u7528 YOUR_ADDON_ID\\Listener \u548c criteriaUser \u5206\u5225\u586b\u5beb \"Class\" \u548c \"Method\" \u6b04\u4f4d\u3002","title":"\u589e\u52a0\u7a0b\u5f0f\u78bc\u4e8b\u4ef6\u76e3\u807d\u5668"},{"location":"criteria/#_22","text":"\u7531\u65bc\u6211\u5011\u7684 criteriaUser \u65b9\u6cd5\u5c0d\u6bcf\u500b\u672a\u77e5\u7684\u6e96\u5247\u90fd\u6703\u88ab\u89f8\u767c\uff0c\u6211\u5011\u9700\u8981\u78ba\u4fdd $rule \u7b49\u65bc likes_on_single \uff08\u6211\u5011\u5728 HTML \u6a19\u7c64\u4e2d\u6307\u5b9a\u7684\u898f\u5247\uff09\u3002 public static function criteriaUser($rule, array $data, \\XF\\Entity\\User $user, &$returnValue) { switch ($rule) { case 'likes_on_single': /** \u8655\u7406\u7a0b\u5f0f\u78bc\u5728\u9019\u88e1! */ break; } } \u73fe\u5728\uff0c\u6211\u5011\u9700\u8981\u5beb\u7a0b\u5f0f\u78bc\u4f86\u5be6\u969b\u6aa2\u67e5\u4e00\u500b\u7528\u6236\u662f\u5426\u6709 X \u500b\u6216\u66f4\u591a\u8b9a\u7684\u7559\u8a00\u3002 \u9019\u53ef\u4ee5\u901a\u904e\u7c21\u55ae\u7684 SQL \u67e5\u8a62\u8f15\u9b06\u5be6\u73fe\uff0c\u5f9e xf_post \u4e2d\u9078\u64c7\u4e00\u689d\u8d85\u904e X \u500b\u8b9a\u7684\u8a18\u9304\uff08 likes column \uff09\uff0c\u4e26\u4e14 user_id \u7b49\u65bc\u76ee\u524d\u5339\u914d\u7684\u7528\u6236 ID\u3002 \u6240\u4ee5\uff0c\u4e0b\u9762\u662f\u67e5\u8a62\u8a9e\u53e5\uff1a SELECT `likes` FROM `xf_post` WHERE `user_id` = ? ORDER BY `likes` DESC LIMIT 1 \u4ee5\u53ca\u65b9\u6cd5\u7a0b\u5f0f\u78bc\uff1a public static function criteriaUser($rule, array $data, \\XF\\Entity\\User $user, &$returnValue) { switch ($rule) { case 'likes_on_single': // \u7372\u53d6\u8cc7\u6599\u5eab $db = \\XF::db(); // \u7528\u65bc\u9078\u64c7\u55ae\u500b\u7528\u6236\u5e16\u5b50\u7684\u6700\u5927\u9ede\u8b9a\u6578\u7684\u8cc7\u6599\u5eab\u67e5\u8a62 $query = \"SELECT `likes` FROM `xf_post` WHERE `user_id` = ? ORDER BY `likes` DESC LIMIT 1\"; // \u6aa2\u7d22\u6700\u5927\u9ede\u8b9a\u6578 $likes = $db->fetchOne($query, [$user->user_id]); // \u6aa2\u67e5\u6211\u5011\u662f\u5426\u6709\u4f86\u81ea\u8cc7\u6599\u5eab\u7684\u7d50\u679c(\u6211\u5011\u671f\u671b\u6709\u4e00\u500b\u6578\u5b57) if (is_int($likes)) { // \u5982\u679c\u7528\u6236\u7684\u8cc7\u8a0a\u6709 X \u500b\u6216\u66f4\u591a\u7684\u8b9a\uff0c\u5247\u8fd4\u56de true\uff1b\u5982\u679c\u6c92\u6709\uff0c\u5247\u8fd4\u56de false $returnValue = ($likes >= $data['likes']); } else { $returnValue = false; } break; } } \u8981\u6ce8\u610f\u4ee5\u4e0b\u5e7e\u9ede\uff1a \u6211\u5011\u4f7f\u7528 $user \u8b8a\u6578\u4f86\u6aa2\u7d22\u76ee\u524d\u5339\u914d\u7684\u7528\u6236\u3002 \u6211\u5011\u53ef\u4ee5\u4f7f\u7528\u9019\u500b\u8b8a\u6578\uff0c\u56e0\u70ba\u6211\u5011\u7684\u6e96\u5247\u5c6c\u65bc \u7528\u6236 \u6e96\u5247\u3002 \u6211\u5011\u53ef\u4ee5\u901a\u904e $data \u9663\u5217\u8a2a\u554f\u8cc7\u6599\u3002 \u5b83\u5305\u542b\u4e86\u6211\u5011\u5728 \u6a21\u677f\u4fee\u6539\u4e2d\u5df2\u65b0\u589e \u7684\u6b04\u4f4d\u7684\u8cc7\u6599\u3002 \u6211\u5011\u53ea\u65b0\u589e\u4e86\u4e00\u500b <xf:numberbox... \uff0c\u5176\u4e2d name \u5c6c\u6027\u7b49\u65bc user_criteria[likes_on_single][data][likes] \u3002 \u9019\u5c31\u662f\u70ba\u4ec0\u9ebc\u6211\u5011\u53ef\u4ee5\u5728\u4e0a\u9762\u7684\u7a0b\u5f0f\u78bc\u4e2d\u4f7f\u7528 $data['likes'] \u3002 \u73fe\u5728\u4e00\u5207\u90fd\u641e\u5b9a\u4e86\u3002 \u8b93\u6211\u5011\u6e2c\u8a66\u4e00\u4e0b\u5427\uff01","title":"\u8655\u7406\u6e96\u5247"},{"location":"criteria/#_23","text":"\u5efa\u7acb\u4e00\u500b \"\u4eba\u4eba\u70ba\u6211\" \u7684\u6210\u5c31\u3002 \u5728 \"\u7528\u6236\u6e96\u5247\" \u6a19\u7c64\u4e0a\uff0c\"\u55ae\u5247\u7559\u8a00\u7684\u9ede\u8b9a\u6578\" \u6b04\u4f4d\uff0c\u4f8b\u5982\uff0c5\u3002 \u63a5\u4e0b\u4f86\uff0c\u5728\u4f60\u8ad6\u58c7\u7684\u67d0\u8655\u5efa\u7acb\u4e00\u500b\u6e2c\u8a66\u7559\u8a00\uff0c\u7136\u5f8c\u7528\u4e94\u500b\u4e0d\u540c\u7684\u7528\u6236\u9ede\u8b9a\u4e94\u6b21\uff08\u6216\u8005\u76f4\u63a5\u624b\u52d5\u8a2d\u5b9a likes \u6b04\u7684\u503c\uff09\u3002 \u7136\u5f8c\uff0c\u9032\u5165 \"\u5de5\u5177 > \u8a08\u756b\u4efb\u52d9\"\uff0c\u901a\u904e\u9ede\u64ca\u57f7\u884c\u6309\u9215 (\u5faa\u74b0-\u7bad\u982d) \"\u66f4\u65b0\u7528\u6236\u6210\u5c31\u503c\" \u8a08\u756b\u3002 \u5f88\u597d\uff01 Warning \u5982\u679c\u60a8\u6c92\u6709\u7372\u5f97 \"\u4eba\u4eba\u70ba\u6211\" \u6210\u5c31\uff0c\u8acb\u5617\u8a66\u767b\u51fa\u3001\u767b\u5165\u4e26\u91cd\u65b0\u57f7\u884c \"\u66f4\u65b0\u7528\u6236\u6210\u5c31\u503c\" \u8a08\u756b\u3002","title":"\u6e2c\u8a66\uff08\u6210\u5c31\uff09"},{"location":"criteria/#_24","text":"\u9032\u5165 \"\u806f\u7d61 > \u901a\u77e5\"\uff0c\u9ede\u9078 \"\u65b0\u589e\u901a\u77e5\" \u6309\u9215\u3002 \u5728 \"\u7528\u6236\u6e96\u5247\" \u6a19\u7c64\u4e0a\uff0c\u5c07 \"\u55ae\u5247\u7559\u8a00\u7684\u9ede\u8b9a\u6578\" \u6b04\u4f4d\u540c\u6a23\u8a2d\u5b9a\u70ba 5\u3002 \u5132\u5b58\u901a\u77e5\u3002 \u63a5\u4e0b\u4f86\uff0c\u5728\u4f60\u8ad6\u58c7\u7684\u67d0\u8655\u5efa\u7acb\u4e00\u500b\u6e2c\u8a66\u7559\u8a00\uff0c\u7136\u5f8c\u7528\u4e94\u500b\u4e0d\u540c\u7684\u7528\u6236\u9ede\u8b9a\u4e94\u6b21\uff08\u6216\u8005\u76f4\u63a5\u624b\u52d5\u8a2d\u5b9a likes \u6b04\u7684\u503c\uff09\u3002 \u73fe\u5728\uff0c\u4f60\u61c9\u8a72\u6703\u770b\u5230\u4e00\u5247\u901a\u77e5\uff1a \u4f60\u53ef\u4ee5 \u4e0b\u8f09 \u57fa\u65bc\u9019\u500b\u7bc4\u4f8b\u69cb\u5efa\u7684\u9644\u52a0\u5143\u4ef6\u8cc7\u6e90 (2.0.10)\u3002","title":"\u6e2c\u8a66\uff08\u901a\u77e5\uff09"},{"location":"criteria/#_25","text":"\u60f3\u50cf\u4e00\u4e0b\uff0c\u6211\u5011\u6b63\u5728\u5efa\u7acb\u4e00\u500b\u9644\u52a0\u5143\u4ef6\uff08\u9644\u52a0\u5143\u4ef6 ID\uff1a PostsRemover \uff09\uff0c\u7528\u65bc\u522a\u9664\u6240\u6709\u7b26\u5408\u9078\u5b9a\u6e96\u5247\u7684\u5e16\u5b50\u3002 \u4e00\u500b\u53ef\u7528\u6e96\u5247\u7684\u5217\u8868\uff1a \u5e16\u5b50\u81f3\u5c11\u6709 X \u500b\u9ede\u8b9a\u6578 \u5e16\u5b50\u4f5c\u8005\u6709\u4e00\u500b X \u7528\u6236\u540d \u5e16\u5b50\u81f3\u5c11\u88ab\u7de8\u8f2f\u4e86 X \u6b21 \u5e16\u5b50\u88ab\u7de8\u8f2f\u7684\u6b21\u6578\u4e0d\u8d85\u904e X \u6b21 \u5e16\u5b50\u5728 X \u4e4b\u524d\u767c\u8868 \u5e16\u5b50\u767c\u8868\u65bc X \u4e4b\u5f8c \u986f\u7136\uff0c\u5c0d\u65bc\u9019\u6a23\u7684\u6e96\u5247\uff0c\u6211\u5011\u9700\u8981\u4e00\u7a2e\u65b0\u7684\u6e96\u5247\u985e\u578b\uff1a\u5e16\u5b50\u6e96\u5247\u3002","title":"\u81ea\u5b9a\u7fa9\u6e96\u5247\u985e\u578b\u7bc4\u4f8b"},{"location":"criteria/#criteria-type-class-class","text":"\u6211\u5011\u61c9\u8a72\u5148\u5728 addon \u7684 Criteria \u76ee\u9304\u4e0b\u5efa\u7acb\u4e00\u500b\u7e7c\u627f AbstractCriteria \u7684\u65b0 class Post \uff1a <?php namespace PostsRemover\\Criteria; use XF\\Criteria\\AbstractCriteria; class Post extends AbstractCriteria { } \u73fe\u5728\u6211\u5011\u9700\u8981\u70ba addon \u652f\u63f4\u7684\u6240\u6709\u6e96\u5247\u5beb\u7a0b\u5f0f\u78bc\u3002 \u5728\u9019\u500b\u4f8b\u5b50\u4e2d\uff0c\u6211\u5c07\u70ba\u4e0a\u9762\u5217\u8868\u4e2d\u7684\u524d\u4e09\u500b\u6e96\u5247\u5beb\u7a0b\u5f0f\u78bc\uff1a <?php namespace PostsRemover\\Criteria; use XF\\Criteria\\AbstractCriteria; class Post extends AbstractCriteria { // \u5e16\u5b50\u81f3\u5c11\u6709 X \u500b\u9ede\u8b9a\u6578 protected function _matchLikeCount(array $data, \\XF\\Entity\\Post $post) { return ($post->likes && $post->likes >= $data['likes']); } // \u5e16\u5b50\u4f5c\u8005\u6709\u4e00\u500b X \u7528\u6236\u540d protected function _matchUsername(array $data, \\XF\\Entity\\Post $post) { return $post->username === $data['name']; } // \u5e16\u5b50\u81f3\u5c11\u88ab\u7de8\u8f2f\u4e86 X \u6b21 protected function _matchEditedCount(array $data, \\XF\\Entity\\Post $post) { return $post->edit_count && $post->edit_count >= $data['count']; } /* ================ \u8655\u7406\u5176\u4ed6\u6e96\u5247 ================ */ } isMatched(...) \u65b9\u6cd5\u7528\u65bc\u547c\u53eb\u6211\u5011\u525b\u624d\u5efa\u7acb\u7684 _match \u65b9\u6cd5\uff0c\u53ea\u63a5\u53d7 User \u5be6\u9ad4\uff0c\u6211\u5011\u8981\u5beb\u4e00\u500b\u81ea\u5b9a\u7fa9\u7684 isMatched() \u3001 isUnknownMatched() \u548c isSpecialMatched() \u65b9\u6cd5\u7684\u8b8a\u9ad4\u3002 \u7531\u65bc\u6211\u5011\u6b63\u5728\u5efa\u7acb\u5e16\u5b50\u6e96\u5247\uff0c\u6211\u5011\u9700\u8981\u5efa\u7acb\u81ea\u5df1\u7684 isMatchedPost() \u65b9\u6cd5\uff1a public function isMatchedPost(\\XF\\Entity\\Post $post) { if (!$this->criteria) { return $this->matchOnEmpty; } foreach ($this->criteria AS $criterion) { $rule = $criterion['rule']; $data = $criterion['data']; $specialResult = $this->isSpecialMatchedPost($rule, $data, $post); if ($specialResult === false) { return false; } else if ($specialResult === true) { continue; } $method = '_match' . \\XF\\Util\\Php::camelCase($rule); if (method_exists($this, $method)) { $result = $this->$method($data, $post); if (!$result) { return false; } } else { if (!$this->isUnknownMatched($rule, $data, $post)) { return false; } } } return true; } protected function isSpecialMatchedPost($rule, array $data, \\XF\\Entity\\Post $post) { return null; } protected function isUnknownMatchedPost($rule, array $data, \\XF\\Entity\\Post $post) { return false; } \u6211\u5011\u53ea\u9700\u7528 isMatched(...) \u65b9\u6cd5\u7a0b\u5f0f\u78bc\u5c07 User \u5be6\u9ad4\u985e\u578b\u7684 $user \u8b8a\u6578\u66ff\u63db\u70ba Post \u5be6\u9ad4\u985e\u578b\u7684 $post \u8b8a\u6578\u3002 \u7531\u65bc\u6211\u5011\u4e0d\u6253\u7b97\u8655\u7406\u7279\u6b8a\u548c\u672a\u77e5\u7684\u6e96\u5247\uff0c\u6211\u5011\u5728 isSpecialMatchedPost \u4e2d\u8fd4\u56de null\uff0c\u5728 isUnknownMathcedPost \u65b9\u6cd5\u4e2d\u8fd4\u56de false \u3002","title":"Criteria type class \u6e96\u5247\u985e\u578b class"},{"location":"criteria/#_26","text":"\u62cb\u958b\u65b0\u589e admin \u8def\u7531\u3001\u7de8\u5beb Controller \u548c\u5728\u5f8c\u53f0\u505a\u5176\u4ed6\u64cd\u4f5c\u7684\u904e\u7a0b\uff0c\u76f4\u63a5\u8df3\u5230\u6211\u5011\u9801\u9762\u7684\u6a21\u677f\u7a0b\u5f0f\u78bc\uff1a <xf:title>Posts Remover</xf:title> <xf:form action=\"{{ link('posts-remover/remove') }}\" ajax=\"true\" class=\"block\"> <div class=\"block-container\"> <xf:checkboxrow label=\"Post criteria\"> <xf:option label=\"Post has at least X likes\" name=\"post_criteria[like_count][rule]\" value=\"like_count\"> <xf:numberbox name=\"post_criteria[like_count][data][likes]\" size=\"5\" min=\"0\" step=\"1\" /> </xf:option> <xf:option label=\"Post author has an X username\" name=\"post_criteria[username][rule]\" value=\"username\"> <xf:textbox name=\"post_criteria[username][data][name]\" ac=\"true\" /> </xf:option> <xf:option label=\"Post was edited at least X times\" name=\"post_criteria[edited_count][rule]\" value=\"edited_count\"> <xf:numberbox name=\"post_criteria[edited_count][data][count]\" size=\"5\" min=\"0\" step=\"1\" /> </xf:option> </xf:checkboxrow> <!-- \u5176\u4ed6\u6e96\u5247\u7684\u6a21\u677f\u7a0b\u5f0f\u78bc --> <xf:submitrow sticky=\"true\" icon=\"delete\"/> </div> </xf:form>","title":"\u6a21\u677f"},{"location":"criteria/#_27","text":"\u5728\u6211\u5011\u9801\u9762\u7684 Controller \u4e2d\uff0c\u6211\u5011\u9700\u8981\u5efa\u7acb\u4e00\u500b\u540d\u70ba actionRemove \u7684\u65b9\u6cd5\u4f86\u8655\u7406 \"\u79fb\u9664\" \u6309\u9215\u7684\u9ede\u9078\uff1a public function actionRemove() { } \u9996\u5148\uff0c\u8b93\u6211\u5011\u5f9e\u9801\u9762\u8868\u55ae\u4e2d\u6aa2\u7d22 post_criteria \u9663\u5217\uff1a public function actionRemove() { $postCriteriaInput = $this->filter('post_criteria', 'array'); } \u5176\u6b21\uff0c\u6211\u5011\u9700\u8981\u5f9e\u6aa2\u7d22\u5230\u7684\u9801\u9762\u8868\u55ae\u8cc7\u6599\u4e2d\u5efa\u7acb\u4e00\u500b\u6e96\u5247\u7269\u4ef6\uff1a public function actionRemove() { $postCriteriaInput = $this->filter('post_criteria', 'array'); /** @var \\PostsRemover\\Criteria\\Post $postCriteria */ $postCriteria = $this->app()->criteria('PostsRemover:Post', $postCriteriaInput); } \u9810\u8a2d\u60c5\u6cc1\u4e0b\uff0c\u767c\u4f48\u5e16\u5b50 \u5c07\u5339\u914d empty \u6e96\u5247\uff08\u7576\u6c92\u6709\u9078\u64c7\u4efb\u4f55\u5167\u5bb9\u6642\uff09\uff0c\u9019\u5c07\u5c0e\u81f4\u6240\u6709\u8ad6\u58c7\u5e16\u5b50\u90fd\u88ab\u522a\u9664\u3002 \u70ba\u4e86\u907f\u514d\u9019\u7a2e\u60c5\u6cc1\uff0c\u6211\u5011\u9700\u8981\u901a\u904e setMatchOnEmpty() \u65b9\u6cd5\u624b\u52d5\u8a2d\u5b9a\u5339\u914d empty \u6e96\u5247\u7684\u7d50\u679c\uff1a public function actionRemove() { $postCriteriaInput = $this->filter('post_criteria', 'array'); /** @var \\PostsRemover\\Criteria\\Post $postCriteria */ $postCriteria = $this->app()->criteria('PostsRemover:Post', $postCriteriaInput); $postCriteria->setMatchOnEmpty(false); // \u5982\u679c\u6c92\u6709\u9078\u5b9a\u6e96\u5247\uff0c\u5247\u4e0d\u6703\u522a\u9664\u4efb\u4f55\u5167\u5bb9 } \u6700\u5f8c\uff0c\u6211\u5011\u9700\u8981\u6839\u64da\u9078\u5b9a\u7684\u6e96\u5247\u4f86\u5339\u914d\u6240\u6709\u8ad6\u58c7\u5e16\u5b50\u3002 \u5982\u679c\u5e16\u5b50\u7b26\u5408\u6e96\u5247\uff0c\u6211\u5011\u5c07\u522a\u9664\u5b83\u3002 public function actionRemove() { $postCriteriaInput = $this->filter('post_criteria', 'array'); /** @var \\PostsRemover\\Criteria\\Post $postCriteria */ $postCriteria = $this->app()->criteria('PostsRemover:Post', $postCriteriaInput); $postCriteria->setMatchOnEmpty(false); // \u5982\u679c\u6c92\u6709\u9078\u64c7\u6e96\u5247\uff0c\u5247\u4e0d\u6703\u522a\u9664\u4efb\u4f55\u5167\u5bb9 // \u53d6\u5f97\u6240\u6709\u8ad6\u58c7\u5e16\u5b50 $posts = $this->finder('XF:Post')->fetch(); $deletedCounter = 0; /** @var \\XF\\Entity\\Post $post */ foreach ($posts as $post) { if ($postCriteria->isMatchedPost($post)) // \u91dd\u5c0d\u6240\u9078\u5b9a\u7684\u6e96\u5247\u6aa2\u67e5\u5e16\u5b50 { $post->delete(); // \u5982\u679c\u5e16\u5b50\u7b26\u5408\u9078\u5b9a\u7684\u6e96\u5247\uff0c\u5247\u5c07\u5176\u522a\u9664\u3002 $deletedCounter++; } } return $this->message('Done! ' . $deletedCounter . ' posts were removed!'); } Note \u8acb\u6ce8\u610f\uff0c\u5c0d\u65bc XenForo 2.1 \u4ee5\u4e0b\u7684\u7248\u672c\uff0c\u6211\u5011\u4f7f\u7528 isMatchedPost($post) \u65b9\u6cd5\uff01 Warning \u4e00\u822c\u4f86\u8aaa\uff0c\u4e00\u6b21\u5f9e\u8cc7\u6599\u5eab\u4e2d\u6aa2\u7d22\u6240\u6709\u7684\u5be6\u9ad4\u662f\u4e00\u7a2e\u4e0d\u597d\u7684\u505a\u6cd5\uff08\u4e0a\u9762\u7a0b\u5f0f\u78bc\u4e2d\u7684 $this->finder('XF:Post')->fetch(); \uff09\u3002 \u8ad6\u58c7\u7684\u5e16\u5b50\u53ef\u80fd\u6709\u5e7e\u767e\u842c\u500b\uff0c\u5982\u679c\u4e00\u6b21\u5168\u90e8\u9078\u53d6\u6703\u662f\u4e00\u500b\u975e\u5e38\u6f2b\u9577\u7684\u904e\u7a0b\uff0c\u6700\u5f8c\u53ef\u80fd\u9084\u6703\u51fa\u73fe\u932f\u8aa4\u3002 \u8003\u616e\u4f7f\u7528 Job \u7cfb\u7d71\u4f86\u8655\u7406\u6578\u5341\u500b\uff08100+\uff09\u8cc7\u6599\u5eab\u9805\u76ee\u3002","title":"\u5339\u914d\u6e96\u5247"},{"location":"criteria/#_28","text":"\u662f\u6642\u5019\u6e2c\u8a66\u6211\u5011\u7684\u81ea\u5b9a\u7fa9\u6e96\u5247\u985e\u578b\u4e86\uff01 \u6211\u5728\u6211\u7684\u6e2c\u8a66\u8ad6\u58c7\u4e0a\u5efa\u7acb\u4e86\u4e09\u500b\u5e16\u5b50\u3002 \u7b2c\u4e00\u500b\u5e16\u5b50\u88ab\u9ede\u8b9a 500 \u6b21\uff0c\u7b2c\u4e8c\u500b\u5e16\u5b50\u88ab\u7de8\u8f2f 5 \u6b21\u3002 \u7b2c\u4e09\u500b\u53ea\u662f\u4e00\u500b\u539f\u5c01\u4e0d\u52d5\u7684\u6c92\u6709\u88ab\u9ede\u8b9a\u7684\u5e16\u5b50\u3002 \u73fe\u5728\uff0c\u5728\u6211\u5011\u7684 \"\u5e16\u5b50\u522a\u9664\u5668\" Admin CP \u9801\u9762\u4e0a\uff0c\u8b93\u6211\u5011\u9078\u64c7 \"\u5e16\u5b50\u81f3\u5c11\u6709 X \u500b\u9ede\u8b9a\u6578\"\uff08\u503c\u70ba 250\uff09\u548c \"\u5e16\u5b50\u81f3\u5c11\u88ab\u7de8\u8f2f\u904e X \u6b21\"\uff08\u503c\u70ba 5\uff09\u3002 \u7576\u6211\u6309\u4e0b \"\u522a\u9664\" \u9375\u6642\uff0c\u6211\u770b\u5230\u4e00\u689d\u5373\u6642\u6d88\u606f\uff0c\u544a\u8a34\u6211\u4ec0\u9ebc\u90fd\u6c92\u6709\u522a\u9664\u3002 \u70ba\u4ec0\u9ebc\u5462\uff1f \u5f88\u986f\u7136\uff0c\u56e0\u70ba\u5728 \u540c\u4e00\u6642\u9593\u5167 \u6c92\u6709\u81f3\u5c11 250 \u500b\u9ede\u8b9a\u6578\u548c\u81f3\u5c11\u7de8\u8f2f\u904e 5 \u6b21\u7684\u5e16\u5b50\u3002 \u6240\u4ee5\u6211\u5011\u53ea\u9700\u8981\u9078\u64c7\u7b2c\u4e00\u500b\u6e96\u5247\uff0c\u7136\u5f8c\u9ede\u9078 \"\u522a\u9664\"\u3002 \u9019\u6a23\u5c31\u6703\u522a\u9664\u4e00\u500b\u6709 500 \u500b\u9ede\u8b9a\u6578\u7684\u5e16\u5b50\u3002 \u63a5\u4e0b\u4f86\uff0c\u6211\u5011\u53ea\u9700\u8981\u9078\u64c7\u6700\u5f8c\u4e00\u500b\u6e96\u5247\uff0c\u7136\u5f8c\u9810\u5148\u9032\u884c\u522a\u9664\u3002 \u6709\u7de8\u8f2f\u904e 5 \u6b21\u7684\u5e16\u5b50\u5c07\u88ab\u522a\u9664\u3002 \u7d50\u679c\uff0c\u53ea\u6709\u4e00\u500b\u6e2c\u8a66\u5e16\u5b50\u5728\u6e2c\u8a66\u4e2d\u5016\u5b58\u4e0b\u4f86\uff1a \u4f60\u53ef\u4ee5 \u4e0b\u8f09 \u57fa\u65bc\u9019\u500b\u7bc4\u4f8b (2.0.10) \u6240\u69cb\u5efa\u7684\u63d2\u4ef6\u539f\u59cb\u78bc\u3002 \u5728 Admin CP \u88e1\u4f60\u53ef\u4ee5\u5728 \"\u5de5\u5177\" \u7684\u90e8\u5206\u627e\u5230 \"\u5e16\u5b50\u522a\u9664\u5668\"\u3002","title":"\u6e2c\u8a66"},{"location":"designing-styles/","text":"\u8a2d\u8a08\u6a23\u5f0f \u00b6 \u5728 XF2 \u4e2d\uff0c\u6211\u5011\u5f15\u5165\u4e86\u4e00\u7a2e\u5168\u65b0\u7684\u65b9\u5f0f\u4f86\u5efa\u7acb\u548c\u7de8\u8f2f\u6a23\u5f0f\uff0c\u7a31\u70ba \"\u8a2d\u8a08\u5e2b\u6a21\u5f0f\"\u3002 \u8a2d\u8a08\u5e2b\u6a21\u5f0f\u662f\u4e00\u500b CLI \u5de5\u5177\u96c6\u5408\uff0c\u5141\u8a31\u60a8\u76f4\u63a5\u5728\u6a94\u6848\u7cfb\u7d71\u4e2d\u4fee\u6539\u6a23\u5f0f\u4e2d\u7684\u67d0\u4e9b\u6a21\u677f\u3002 \u5b83\u9084\u8f38\u51fa\u5404\u7a2e metadata \u548c\u6a23\u5f0f\u5c6c\u6027\u8cc7\u8a0a\uff0c\u9019\u5c0d\u7248\u672c\u63a7\u5236\u548c\u5354\u540c\u5408\u4f5c\u975e\u5e38\u6709\u5e6b\u52a9\u3002 \u958b\u555f\u8a2d\u8a08\u5e2b\u6a21\u5f0f \u00b6 \u958b\u555f\u8a2d\u8a08\u5e2b\u6a21\u5f0f\u7684\u7b2c\u4e00\u6b65\u662f\u5728 config.php \u4e2d\u555f\u7528\u5b83\u3002 $config['designer']['enabled'] = true; \u60a8\u4e5f\u53ef\u4ee5\u9078\u64c7\u70ba\u8a2d\u8a08\u5668\u6a21\u5f0f\u6a94\u6848\u6307\u5b9a\u4e0d\u540c\u7684\u8def\u5f91\u5b58\u5728\u65bc\u6a94\u6848\u7cfb\u7d71\u4e2d\u3002 \u4ee5\u4e0b\u662f\u9810\u8a2d\u8def\u5f91\u3002 \u8981\u6539\u8b8a\u8def\u5f91\uff0c\u8acb\u5728\u4f60\u7684 config.php \u4e2d\u65b0\u589e\u4ee5\u4e0b\u5167\u5bb9\uff0c\u4e26\u76f8\u61c9\u4fee\u6539\u8def\u5f91\u3002 $config['designer']['basePath'] = 'src/styles'; \u958b\u555f\u6a23\u5f0f\u8a2d\u8a08\u5e2b\u6a21\u5f0f \u00b6 \u8a2d\u8a08\u5e2b\u6a21\u5f0f\u5fc5\u9808\u70ba\u6bcf\u500b\u6a23\u5f0f\u660e\u78ba\u555f\u7528\u3002 \u6211\u5011\u901a\u904e\u4f7f\u7528 CLI \u548c\u6307\u5b9a\u6a23\u5f0f\u7684\u6a23\u5f0f ID\uff0c\u4e26\u9078\u64c7 \"\u8a2d\u8a08\u5e2b\u6a21\u5f0f ID\" \u4f86\u555f\u7528\u6a23\u5f0f\u7684\u8a2d\u8a08\u5e2b\u6a21\u5f0f\uff1a Terminal $ php cmd.php xf-designer:enable [style_id] [designer_mode_id] \u8a2d\u8a08\u5e2b\u6a21\u5f0f ID \u662f\u672a\u4f86\u8207\u8a2d\u8a08\u5e2b\u6a21\u5f0f\u76f8\u95dc\u7684\u6307\u4ee4\u4e2d\u4f7f\u7528\u7684\u8b58\u5225\u7b26\u865f\u3002 \u4e00\u65e6\u958b\u555f\uff0c\u76ee\u524d\u4fee\u6539\u5f8c\u7684\u6a23\u5f0f\u5143\u4ef6\u5c07\u88ab\u532f\u51fa\u5230 [basePath]/[designer_mode_id] \u76ee\u9304\u4e2d\u3002 \u7576\u958b\u555f\u8a72\u6a23\u5f0f\u7684\u8a2d\u8a08\u5e2b\u6a21\u5f0f\u6642\uff0c\u5982\u679c\u8a72\u76ee\u9304\u5df2\u7d93\u5b58\u5728\uff0c\u4f60\u6703\u6709\u4e00\u500b\u9078\u64c7\uff0c\u5373\u6211\u5011\u662f\u5426\u61c9\u8a72\u5f9e\u6a23\u5f0f\u4e2d\u8986\u84cb\u8a72\u76ee\u9304\u7684\u7576\u524d\u5167\u5bb9\uff0c\u6216\u8005\u662f\u5426\u61c9\u8a72\u5f9e\u8a72\u76ee\u9304\u7684\u7576\u524d\u5167\u5bb9\u4e2d\u8986\u84cb\u76ee\u524d\u6a23\u5f0f\u3002 \u95dc\u9589\u6a23\u5f0f\u8a2d\u8a08\u5e2b\u6a21\u5f0f \u00b6 \u8981\u95dc\u9589\u67d0\u500b\u6a23\u5f0f\u7684\u8a2d\u8a08\u5e2b\u6a21\u5f0f\uff0c\u60a8\u53ea\u9700\u57f7\u884c\u4ee5\u4e0b CLI \u6307\u4ee4\u3002 Terminal $ php cmd.php xf-designer:disable [designer_mode_id] \u9810\u8a2d\u60c5\u6cc1\u4e0b\uff0c\u9019\u5c07\u5728\u6a94\u6848\u7cfb\u7d71\u4e2d\u4fdd\u7559\u8a2d\u8a08\u5e2b\u6a21\u5f0f\u7684\u8f38\u51fa\u526f\u672c\u3002 \u8981\u522a\u9664\u8cc7\u6599\uff0c\u4f60\u53ef\u4ee5\u7528 --clear \u9078\u9805\u57f7\u884c\u540c\u6a23\u7684\u6307\u4ee4\u3002 Terminal $ php cmd.php xf-designer:disable [designer_mode_id] --clear \u4ec0\u9ebc\u662f\u8f38\u51fa\uff0c\u5728\u54ea\u88e1\u8f38\u51fa\uff1f \u00b6 \u91cd\u8981\u7684\u662f\u8981\u8a18\u4f4f\uff0cXF \u4e2d\u7684\u6a23\u5f0f\u53ea\u7531\u5728\u8a72\u6a23\u5f0f\u4e2d \u4fee\u6539\u7684\u5167\u5bb9 \u7d44\u6210\u3002 \u9019\u610f\u5473\u8457\u8a2d\u8a08\u5e2b\u6a21\u5f0f\u7684\u8f38\u51fa\u5c07\u53ea\u5305\u62ec\u5728\u6a23\u5f0f\u4e2d\u88ab\u4fee\u6539\u7684\u5167\u5bb9\u3002 \u5728\u7236\u6a23\u5f0f\u4e2d\u88ab\u4fee\u6539\u7684\u6a21\u677f\u548c\u6a23\u5f0f\u5c6c\u6027\u4e0d\u6703\u88ab\u8f38\u51fa\u3002 \u6a21\u677f \u00b6 \u6a21\u677f\u5c07\u88ab\u8f38\u51fa\u5230 [basePath]/[designer_mode_id]/templates \u76ee\u9304\u4e2d\u3002 \u5728\u8a72\u76ee\u9304\u4e2d\uff0c\u60a8\u53ef\u4ee5\u70ba\u6bcf\u7a2e\u985e\u578b\uff08\u5982 admin\u3001email \u548c public\uff09\u8a2d\u5b9a\u53e6\u4e00\u500b\u76ee\u9304\u3002 \u6a21\u677f\u5c07\u4ee5 HTML \u683c\u5f0f\u8f38\u51fa\uff0c\u4e26\u53ef\u5728\u6a94\u6848\u7cfb\u7d71\u4e2d\u76f4\u63a5\u7de8\u8f2f\u3002 \u5728\u6a94\u6848\u7cfb\u7d71\u4e0a\u6240\u505a\u7684\u66f4\u6539\u6703\u5728\u8a72\u6a21\u677f\u8f09\u5165\u5230\u9801\u9762\u6642\u88ab\u532f\u5165\u4e26\u7de8\u8b6f\u3002 \u540c\u6a23\uff0c\u60a8\u4e5f\u53ef\u4ee5\u901a\u904e\u5f9e\u6a94\u6848\u7cfb\u7d71\u4e2d\u522a\u9664\u6a21\u677f\uff08\u5982\u679c\u5b83\u4ee5\u524d\u88ab\u4fee\u6539\u904e\uff09\u4f86\u6062\u5fa9\u5b83\u3002 \u6a23\u5f0f\u5c6c\u6027\u548c\u7fa4\u7d44 \u00b6 \u6a23\u5f0f\u5c6c\u6027\u548c\u7fa4\u7d44\u5c07\u88ab\u8f38\u51fa\u5230 [basePath]/[designer_mode_id]/style_properties \u548c [basePath]/[designer_mode_id]/style_property_groups \u76ee\u9304\u4e0b\u3002 \u5b83\u5011\u4ee5 JSON \u683c\u5f0f\u532f\u51fa\uff0c\u4f5c\u70ba\u4e00\u7a2e\u6709\u7528\u7684\u65b9\u5f0f\uff0c\u901a\u904e\u7248\u672c\u63a7\u5236\u7cfb\u7d71\u76e3\u63a7\u9019\u4e9b\u6a94\u6848\u7684\u8b8a\u5316\u3002 \u4e0d\u5efa\u8b70\u76f4\u63a5\u4fee\u6539\u9019\u4e9b\u6a94\u6848\uff0c\u56e0\u70ba\u5c0d\u5b83\u5011\u7684\u4fee\u6539 \u4e0d\u6703 \u50cf\u6a21\u677f\u90a3\u6a23\u81ea\u52d5\u532f\u5165\u3002 \u4fee\u6539\u7279\u5b9a\u6a21\u677f \u00b6 \u8003\u616e\u5230\u4e00\u500b\u6a23\u5f0f\u53ea\u4ee3\u8868\u5728\u8a72\u6a23\u5f0f\u4e2d\u88ab\u4fee\u6539\u7684\u5143\u4ef6\uff0c\u7576\u8a2d\u8a08\u5e2b\u6a21\u5f0f\u958b\u555f\u6642\uff0c\u6a94\u6848\u7cfb\u7d71\u4e5f\u5c07\u53ea\u5305\u542b\u5728\u8a72\u6a23\u5f0f\u4e2d\u88ab\u4fee\u6539\u7684\u5143\u4ef6\u3002 \u9019\u6a23\u5c31\u7121\u6cd5\u8f38\u51fa\u6bcf\u500b\u6a21\u677f\u548c\u6a23\u5f0f\u5c6c\u6027\u7684\u6709\u6548\u7248\u672c\u3002 \u8981\u5c07\u4e00\u500b\u6a21\u677f\u6a19\u8a18\u70ba\u6a23\u5f0f\u4e2d\u5df2\u4fee\u6539\u7684\uff0c\u60a8\u53ef\u4ee5\u901a\u904e\u5728 Admin CP \u4e2d\u7de8\u8f2f\u5b83\u7684\u5e38\u898f\u65b9\u5f0f\u9032\u884c\u3002 \u5982\u679c\u555f\u7528\u4e86\u8a2d\u8a08\u5668\u6a21\u5f0f\uff0c\u5728 Admin CP \u4e2d\u4fee\u6539\u7684\u6a21\u677f\u548c\u6a23\u5f0f\u5c6c\u6027\u5c07\u81ea\u52d5\u5beb\u5165\u6a94\u6848\u7cfb\u7d71\u3002 \u7136\u800c\uff0c\u4f7f\u7528 CLI \u6307\u4ee4\u4f86\u4fee\u6539\u6216 \"touch\" \u4e00\u500b\u6a21\u677f\u53ef\u80fd\u6703\u66f4\u65b9\u4fbf\u3002 Terminal $ php cmd.php xf-designer:touch-template [designer_mode_id] [template_type:template_title] \u53ea\u8981\u6307\u5b9a\u7684\u6a21\u677f\u5b58\u5728\u65bc\u7236\u6a23\u5f0f\u6216\u4e3b\u6a23\u5f0f\u4e2d\uff0c\u5b83\u5c31\u6703\u88ab\u8907\u88fd\u5230\u76ee\u524d\u6a23\u5f0f\u4e2d\uff0c\u4e26\u8f38\u51fa\u5230\u6a94\u6848\u7cfb\u7d71\u4e2d\u3002 \u7136\u5f8c\u4f60\u53ef\u4ee5\u76f4\u63a5\u5728\u6a94\u6848\u7cfb\u7d71\u4e2d\u4fee\u6539\u6a21\u677f\u3002 \u5982\u679c\u4f60\u60f3\u5728\u4f60\u7684\u6a23\u5f0f\u4e2d\u5efa\u7acb\u4e00\u500b\u5b8c\u5168\u81ea\u5b9a\u7fa9\u7684\u6a21\u677f\uff08\u5728\u6a39\u72c0\u7d50\u69cb\u4e2d\u7684\u4efb\u4f55\u5176\u4ed6\u6a23\u5f0f\u4e2d\u90fd\u4e0d\u5b58\u5728\uff09\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528\u540c\u6a23\u7684\u6307\u4ee4\uff0c\u4f46\u4f60\u53ea\u9700\u8981\u50b3\u905e --custom \u9078\u9805\uff1a Terminal $ php cmd.php xf-designer:touch-template [designer_mode_id] [template_type:template_title] --custom \u5176\u4ed6\u6709\u7528\u7684\u6307\u4ee4 \u00b6 \u9084\u6709\u5176\u4ed6\u4e00\u4e9b\u8207\u8a2d\u8a08\u5e2b\u6a21\u5f0f\u6709\u95dc\u7684\u6709\u7528\u6307\u4ee4\uff1a \u5f9e\u8cc7\u6599\u5eab\u4e2d\u532f\u51fa \u00b6 \u7576\u8a2d\u8a08\u5e2b\u6a21\u5f0f\u88ab\u555f\u7528\u6642\uff0c\u9019\u500b\u6307\u4ee4\u901a\u5e38\u6703\u81ea\u52d5\u57f7\u884c\uff0c\u4f46\u5982\u679c\u51fa\u65bc\u67d0\u7a2e\u539f\u56e0\uff0c\u4f60\u60f3\u7528\u76ee\u524d\u8cc7\u6599\u5eab\u4e2d\u7684\u5167\u5bb9\u8986\u84cb\u6a94\u6848\u7cfb\u7d71\u526f\u672c\uff0c\u90a3\u9ebc\u4f60\u53ef\u4ee5\u57f7\u884c\u4ee5\u4e0b\u6307\u4ee4\uff1a Terminal $ php cmd.php xf-designer:export [designer_mode_id] \u4e5f\u53ef\u4ee5\u53ea\u532f\u51fa\u7279\u5b9a\u7684\u985e\u578b\uff0c\u4f8b\u5982 xf-designer:export-templates \u3002 \u5f9e\u6a94\u6848\u7cfb\u7d71\u532f\u5165 \u00b6 \u9019\u689d\u6307\u4ee4\u5c07\u7528\u6a94\u6848\u7cfb\u7d71\u4e2d\u7684\u5167\u5bb9\u8986\u84cb\u8cc7\u6599\u5eab\u4e2d\u7684\u6a23\u5f0f\u526f\u672c\uff1a Terminal $ php cmd.php xf-designer:import [designer_mode_id] \u4e5f\u53ef\u4ee5\u53ea\u532f\u5165\u7279\u5b9a\u7684\u985e\u578b\uff0c\u4f8b\u5982 xf-designer:import-templates \u3002 \u540c\u6b65\u6a21\u677f \u00b6 \u8a72\u6307\u4ee4\u985e\u4f3c\u65bc\u532f\u5165\u6a21\u677f\uff08\u898b\u4e0a\u6587\uff09\uff0c\u4f46\u5b83\u4e0d\u6703\u8986\u84cb\u6240\u6709\u5167\u5bb9\uff0c\u800c\u53ea\u6703\u532f\u5165\u6a21\u677f\uff0c\u4e26\u5728 metadata \u767c\u751f\u8b8a\u5316\u6642\u91cd\u65b0\u7de8\u8b6f\u3002 \u5b83\u9084\u6703\u76f8\u61c9\u5730\u61c9\u7528\u7248\u672c\u865f\u66f4\u65b0\u3002 Terminal $ php cmd.php xf-designer:sync-templates [designer_mode_id] \u9084\u539f\u6a21\u677f \u00b6 \u9019\u500b\u6307\u4ee4\u53ef\u4ee5\u7528\u4f86\u6062\u5fa9\u6a21\u677f\uff0c\u6709\u6548\u5730\u5f9e\u76ee\u524d\u6a23\u5f0f\u4e2d\u522a\u9664\u81ea\u5b9a\u7fa9\u7248\u672c\u3002 Terminal $ php cmd.php xf-designer:revert-template [designer_mode_id] [template_type:template_title] \u4e5f\u53ef\u4ee5\u901a\u904e\u5f9e\u6a94\u6848\u7cfb\u7d71\u4e2d\u522a\u9664\u6a21\u677f\u4f86\u89f8\u767c\u9084\u539f\u3002","title":"\u8a2d\u8a08\u6a23\u5f0f"},{"location":"designing-styles/#_1","text":"\u5728 XF2 \u4e2d\uff0c\u6211\u5011\u5f15\u5165\u4e86\u4e00\u7a2e\u5168\u65b0\u7684\u65b9\u5f0f\u4f86\u5efa\u7acb\u548c\u7de8\u8f2f\u6a23\u5f0f\uff0c\u7a31\u70ba \"\u8a2d\u8a08\u5e2b\u6a21\u5f0f\"\u3002 \u8a2d\u8a08\u5e2b\u6a21\u5f0f\u662f\u4e00\u500b CLI \u5de5\u5177\u96c6\u5408\uff0c\u5141\u8a31\u60a8\u76f4\u63a5\u5728\u6a94\u6848\u7cfb\u7d71\u4e2d\u4fee\u6539\u6a23\u5f0f\u4e2d\u7684\u67d0\u4e9b\u6a21\u677f\u3002 \u5b83\u9084\u8f38\u51fa\u5404\u7a2e metadata \u548c\u6a23\u5f0f\u5c6c\u6027\u8cc7\u8a0a\uff0c\u9019\u5c0d\u7248\u672c\u63a7\u5236\u548c\u5354\u540c\u5408\u4f5c\u975e\u5e38\u6709\u5e6b\u52a9\u3002","title":"\u8a2d\u8a08\u6a23\u5f0f"},{"location":"designing-styles/#_2","text":"\u958b\u555f\u8a2d\u8a08\u5e2b\u6a21\u5f0f\u7684\u7b2c\u4e00\u6b65\u662f\u5728 config.php \u4e2d\u555f\u7528\u5b83\u3002 $config['designer']['enabled'] = true; \u60a8\u4e5f\u53ef\u4ee5\u9078\u64c7\u70ba\u8a2d\u8a08\u5668\u6a21\u5f0f\u6a94\u6848\u6307\u5b9a\u4e0d\u540c\u7684\u8def\u5f91\u5b58\u5728\u65bc\u6a94\u6848\u7cfb\u7d71\u4e2d\u3002 \u4ee5\u4e0b\u662f\u9810\u8a2d\u8def\u5f91\u3002 \u8981\u6539\u8b8a\u8def\u5f91\uff0c\u8acb\u5728\u4f60\u7684 config.php \u4e2d\u65b0\u589e\u4ee5\u4e0b\u5167\u5bb9\uff0c\u4e26\u76f8\u61c9\u4fee\u6539\u8def\u5f91\u3002 $config['designer']['basePath'] = 'src/styles';","title":"\u958b\u555f\u8a2d\u8a08\u5e2b\u6a21\u5f0f"},{"location":"designing-styles/#_3","text":"\u8a2d\u8a08\u5e2b\u6a21\u5f0f\u5fc5\u9808\u70ba\u6bcf\u500b\u6a23\u5f0f\u660e\u78ba\u555f\u7528\u3002 \u6211\u5011\u901a\u904e\u4f7f\u7528 CLI \u548c\u6307\u5b9a\u6a23\u5f0f\u7684\u6a23\u5f0f ID\uff0c\u4e26\u9078\u64c7 \"\u8a2d\u8a08\u5e2b\u6a21\u5f0f ID\" \u4f86\u555f\u7528\u6a23\u5f0f\u7684\u8a2d\u8a08\u5e2b\u6a21\u5f0f\uff1a Terminal $ php cmd.php xf-designer:enable [style_id] [designer_mode_id] \u8a2d\u8a08\u5e2b\u6a21\u5f0f ID \u662f\u672a\u4f86\u8207\u8a2d\u8a08\u5e2b\u6a21\u5f0f\u76f8\u95dc\u7684\u6307\u4ee4\u4e2d\u4f7f\u7528\u7684\u8b58\u5225\u7b26\u865f\u3002 \u4e00\u65e6\u958b\u555f\uff0c\u76ee\u524d\u4fee\u6539\u5f8c\u7684\u6a23\u5f0f\u5143\u4ef6\u5c07\u88ab\u532f\u51fa\u5230 [basePath]/[designer_mode_id] \u76ee\u9304\u4e2d\u3002 \u7576\u958b\u555f\u8a72\u6a23\u5f0f\u7684\u8a2d\u8a08\u5e2b\u6a21\u5f0f\u6642\uff0c\u5982\u679c\u8a72\u76ee\u9304\u5df2\u7d93\u5b58\u5728\uff0c\u4f60\u6703\u6709\u4e00\u500b\u9078\u64c7\uff0c\u5373\u6211\u5011\u662f\u5426\u61c9\u8a72\u5f9e\u6a23\u5f0f\u4e2d\u8986\u84cb\u8a72\u76ee\u9304\u7684\u7576\u524d\u5167\u5bb9\uff0c\u6216\u8005\u662f\u5426\u61c9\u8a72\u5f9e\u8a72\u76ee\u9304\u7684\u7576\u524d\u5167\u5bb9\u4e2d\u8986\u84cb\u76ee\u524d\u6a23\u5f0f\u3002","title":"\u958b\u555f\u6a23\u5f0f\u8a2d\u8a08\u5e2b\u6a21\u5f0f"},{"location":"designing-styles/#_4","text":"\u8981\u95dc\u9589\u67d0\u500b\u6a23\u5f0f\u7684\u8a2d\u8a08\u5e2b\u6a21\u5f0f\uff0c\u60a8\u53ea\u9700\u57f7\u884c\u4ee5\u4e0b CLI \u6307\u4ee4\u3002 Terminal $ php cmd.php xf-designer:disable [designer_mode_id] \u9810\u8a2d\u60c5\u6cc1\u4e0b\uff0c\u9019\u5c07\u5728\u6a94\u6848\u7cfb\u7d71\u4e2d\u4fdd\u7559\u8a2d\u8a08\u5e2b\u6a21\u5f0f\u7684\u8f38\u51fa\u526f\u672c\u3002 \u8981\u522a\u9664\u8cc7\u6599\uff0c\u4f60\u53ef\u4ee5\u7528 --clear \u9078\u9805\u57f7\u884c\u540c\u6a23\u7684\u6307\u4ee4\u3002 Terminal $ php cmd.php xf-designer:disable [designer_mode_id] --clear","title":"\u95dc\u9589\u6a23\u5f0f\u8a2d\u8a08\u5e2b\u6a21\u5f0f"},{"location":"designing-styles/#_5","text":"\u91cd\u8981\u7684\u662f\u8981\u8a18\u4f4f\uff0cXF \u4e2d\u7684\u6a23\u5f0f\u53ea\u7531\u5728\u8a72\u6a23\u5f0f\u4e2d \u4fee\u6539\u7684\u5167\u5bb9 \u7d44\u6210\u3002 \u9019\u610f\u5473\u8457\u8a2d\u8a08\u5e2b\u6a21\u5f0f\u7684\u8f38\u51fa\u5c07\u53ea\u5305\u62ec\u5728\u6a23\u5f0f\u4e2d\u88ab\u4fee\u6539\u7684\u5167\u5bb9\u3002 \u5728\u7236\u6a23\u5f0f\u4e2d\u88ab\u4fee\u6539\u7684\u6a21\u677f\u548c\u6a23\u5f0f\u5c6c\u6027\u4e0d\u6703\u88ab\u8f38\u51fa\u3002","title":"\u4ec0\u9ebc\u662f\u8f38\u51fa\uff0c\u5728\u54ea\u88e1\u8f38\u51fa\uff1f"},{"location":"designing-styles/#_6","text":"\u6a21\u677f\u5c07\u88ab\u8f38\u51fa\u5230 [basePath]/[designer_mode_id]/templates \u76ee\u9304\u4e2d\u3002 \u5728\u8a72\u76ee\u9304\u4e2d\uff0c\u60a8\u53ef\u4ee5\u70ba\u6bcf\u7a2e\u985e\u578b\uff08\u5982 admin\u3001email \u548c public\uff09\u8a2d\u5b9a\u53e6\u4e00\u500b\u76ee\u9304\u3002 \u6a21\u677f\u5c07\u4ee5 HTML \u683c\u5f0f\u8f38\u51fa\uff0c\u4e26\u53ef\u5728\u6a94\u6848\u7cfb\u7d71\u4e2d\u76f4\u63a5\u7de8\u8f2f\u3002 \u5728\u6a94\u6848\u7cfb\u7d71\u4e0a\u6240\u505a\u7684\u66f4\u6539\u6703\u5728\u8a72\u6a21\u677f\u8f09\u5165\u5230\u9801\u9762\u6642\u88ab\u532f\u5165\u4e26\u7de8\u8b6f\u3002 \u540c\u6a23\uff0c\u60a8\u4e5f\u53ef\u4ee5\u901a\u904e\u5f9e\u6a94\u6848\u7cfb\u7d71\u4e2d\u522a\u9664\u6a21\u677f\uff08\u5982\u679c\u5b83\u4ee5\u524d\u88ab\u4fee\u6539\u904e\uff09\u4f86\u6062\u5fa9\u5b83\u3002","title":"\u6a21\u677f"},{"location":"designing-styles/#_7","text":"\u6a23\u5f0f\u5c6c\u6027\u548c\u7fa4\u7d44\u5c07\u88ab\u8f38\u51fa\u5230 [basePath]/[designer_mode_id]/style_properties \u548c [basePath]/[designer_mode_id]/style_property_groups \u76ee\u9304\u4e0b\u3002 \u5b83\u5011\u4ee5 JSON \u683c\u5f0f\u532f\u51fa\uff0c\u4f5c\u70ba\u4e00\u7a2e\u6709\u7528\u7684\u65b9\u5f0f\uff0c\u901a\u904e\u7248\u672c\u63a7\u5236\u7cfb\u7d71\u76e3\u63a7\u9019\u4e9b\u6a94\u6848\u7684\u8b8a\u5316\u3002 \u4e0d\u5efa\u8b70\u76f4\u63a5\u4fee\u6539\u9019\u4e9b\u6a94\u6848\uff0c\u56e0\u70ba\u5c0d\u5b83\u5011\u7684\u4fee\u6539 \u4e0d\u6703 \u50cf\u6a21\u677f\u90a3\u6a23\u81ea\u52d5\u532f\u5165\u3002","title":"\u6a23\u5f0f\u5c6c\u6027\u548c\u7fa4\u7d44"},{"location":"designing-styles/#_8","text":"\u8003\u616e\u5230\u4e00\u500b\u6a23\u5f0f\u53ea\u4ee3\u8868\u5728\u8a72\u6a23\u5f0f\u4e2d\u88ab\u4fee\u6539\u7684\u5143\u4ef6\uff0c\u7576\u8a2d\u8a08\u5e2b\u6a21\u5f0f\u958b\u555f\u6642\uff0c\u6a94\u6848\u7cfb\u7d71\u4e5f\u5c07\u53ea\u5305\u542b\u5728\u8a72\u6a23\u5f0f\u4e2d\u88ab\u4fee\u6539\u7684\u5143\u4ef6\u3002 \u9019\u6a23\u5c31\u7121\u6cd5\u8f38\u51fa\u6bcf\u500b\u6a21\u677f\u548c\u6a23\u5f0f\u5c6c\u6027\u7684\u6709\u6548\u7248\u672c\u3002 \u8981\u5c07\u4e00\u500b\u6a21\u677f\u6a19\u8a18\u70ba\u6a23\u5f0f\u4e2d\u5df2\u4fee\u6539\u7684\uff0c\u60a8\u53ef\u4ee5\u901a\u904e\u5728 Admin CP \u4e2d\u7de8\u8f2f\u5b83\u7684\u5e38\u898f\u65b9\u5f0f\u9032\u884c\u3002 \u5982\u679c\u555f\u7528\u4e86\u8a2d\u8a08\u5668\u6a21\u5f0f\uff0c\u5728 Admin CP \u4e2d\u4fee\u6539\u7684\u6a21\u677f\u548c\u6a23\u5f0f\u5c6c\u6027\u5c07\u81ea\u52d5\u5beb\u5165\u6a94\u6848\u7cfb\u7d71\u3002 \u7136\u800c\uff0c\u4f7f\u7528 CLI \u6307\u4ee4\u4f86\u4fee\u6539\u6216 \"touch\" \u4e00\u500b\u6a21\u677f\u53ef\u80fd\u6703\u66f4\u65b9\u4fbf\u3002 Terminal $ php cmd.php xf-designer:touch-template [designer_mode_id] [template_type:template_title] \u53ea\u8981\u6307\u5b9a\u7684\u6a21\u677f\u5b58\u5728\u65bc\u7236\u6a23\u5f0f\u6216\u4e3b\u6a23\u5f0f\u4e2d\uff0c\u5b83\u5c31\u6703\u88ab\u8907\u88fd\u5230\u76ee\u524d\u6a23\u5f0f\u4e2d\uff0c\u4e26\u8f38\u51fa\u5230\u6a94\u6848\u7cfb\u7d71\u4e2d\u3002 \u7136\u5f8c\u4f60\u53ef\u4ee5\u76f4\u63a5\u5728\u6a94\u6848\u7cfb\u7d71\u4e2d\u4fee\u6539\u6a21\u677f\u3002 \u5982\u679c\u4f60\u60f3\u5728\u4f60\u7684\u6a23\u5f0f\u4e2d\u5efa\u7acb\u4e00\u500b\u5b8c\u5168\u81ea\u5b9a\u7fa9\u7684\u6a21\u677f\uff08\u5728\u6a39\u72c0\u7d50\u69cb\u4e2d\u7684\u4efb\u4f55\u5176\u4ed6\u6a23\u5f0f\u4e2d\u90fd\u4e0d\u5b58\u5728\uff09\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528\u540c\u6a23\u7684\u6307\u4ee4\uff0c\u4f46\u4f60\u53ea\u9700\u8981\u50b3\u905e --custom \u9078\u9805\uff1a Terminal $ php cmd.php xf-designer:touch-template [designer_mode_id] [template_type:template_title] --custom","title":"\u4fee\u6539\u7279\u5b9a\u6a21\u677f"},{"location":"designing-styles/#_9","text":"\u9084\u6709\u5176\u4ed6\u4e00\u4e9b\u8207\u8a2d\u8a08\u5e2b\u6a21\u5f0f\u6709\u95dc\u7684\u6709\u7528\u6307\u4ee4\uff1a","title":"\u5176\u4ed6\u6709\u7528\u7684\u6307\u4ee4"},{"location":"designing-styles/#_10","text":"\u7576\u8a2d\u8a08\u5e2b\u6a21\u5f0f\u88ab\u555f\u7528\u6642\uff0c\u9019\u500b\u6307\u4ee4\u901a\u5e38\u6703\u81ea\u52d5\u57f7\u884c\uff0c\u4f46\u5982\u679c\u51fa\u65bc\u67d0\u7a2e\u539f\u56e0\uff0c\u4f60\u60f3\u7528\u76ee\u524d\u8cc7\u6599\u5eab\u4e2d\u7684\u5167\u5bb9\u8986\u84cb\u6a94\u6848\u7cfb\u7d71\u526f\u672c\uff0c\u90a3\u9ebc\u4f60\u53ef\u4ee5\u57f7\u884c\u4ee5\u4e0b\u6307\u4ee4\uff1a Terminal $ php cmd.php xf-designer:export [designer_mode_id] \u4e5f\u53ef\u4ee5\u53ea\u532f\u51fa\u7279\u5b9a\u7684\u985e\u578b\uff0c\u4f8b\u5982 xf-designer:export-templates \u3002","title":"\u5f9e\u8cc7\u6599\u5eab\u4e2d\u532f\u51fa"},{"location":"designing-styles/#_11","text":"\u9019\u689d\u6307\u4ee4\u5c07\u7528\u6a94\u6848\u7cfb\u7d71\u4e2d\u7684\u5167\u5bb9\u8986\u84cb\u8cc7\u6599\u5eab\u4e2d\u7684\u6a23\u5f0f\u526f\u672c\uff1a Terminal $ php cmd.php xf-designer:import [designer_mode_id] \u4e5f\u53ef\u4ee5\u53ea\u532f\u5165\u7279\u5b9a\u7684\u985e\u578b\uff0c\u4f8b\u5982 xf-designer:import-templates \u3002","title":"\u5f9e\u6a94\u6848\u7cfb\u7d71\u532f\u5165"},{"location":"designing-styles/#_12","text":"\u8a72\u6307\u4ee4\u985e\u4f3c\u65bc\u532f\u5165\u6a21\u677f\uff08\u898b\u4e0a\u6587\uff09\uff0c\u4f46\u5b83\u4e0d\u6703\u8986\u84cb\u6240\u6709\u5167\u5bb9\uff0c\u800c\u53ea\u6703\u532f\u5165\u6a21\u677f\uff0c\u4e26\u5728 metadata \u767c\u751f\u8b8a\u5316\u6642\u91cd\u65b0\u7de8\u8b6f\u3002 \u5b83\u9084\u6703\u76f8\u61c9\u5730\u61c9\u7528\u7248\u672c\u865f\u66f4\u65b0\u3002 Terminal $ php cmd.php xf-designer:sync-templates [designer_mode_id]","title":"\u540c\u6b65\u6a21\u677f"},{"location":"designing-styles/#_13","text":"\u9019\u500b\u6307\u4ee4\u53ef\u4ee5\u7528\u4f86\u6062\u5fa9\u6a21\u677f\uff0c\u6709\u6548\u5730\u5f9e\u76ee\u524d\u6a23\u5f0f\u4e2d\u522a\u9664\u81ea\u5b9a\u7fa9\u7248\u672c\u3002 Terminal $ php cmd.php xf-designer:revert-template [designer_mode_id] [template_type:template_title] \u4e5f\u53ef\u4ee5\u901a\u904e\u5f9e\u6a94\u6848\u7cfb\u7d71\u4e2d\u522a\u9664\u6a21\u677f\u4f86\u89f8\u767c\u9084\u539f\u3002","title":"\u9084\u539f\u6a21\u677f"},{"location":"development-tools/","text":"\u958b\u767c\u5de5\u5177 \u00b6 XF2 \u70ba\u958b\u767c\u8005\u63d0\u4f9b\u4e86\u5927\u91cf\u7684\u5167\u5efa\u5de5\u5177\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528\u9019\u4e9b\u5de5\u5177\u4f86\u52a0\u5feb\u9644\u52a0\u5143\u4ef6\u7684\u958b\u767c\uff0c\u4e0b\u9762\u6211\u5011\u5c07\u4ecb\u7d39\u5176\u4e2d\u7684\u4e00\u4e9b\u3002 \u9664\u932f\u6a21\u5f0f \u00b6 \u9664\u932f\u6a21\u5f0f\u53ef\u4ee5\u5728\u4f60\u7684 config.php \u4e2d\u555f\u7528\uff0c\u9019\u5c07\u5141\u8a31\u4f60\u8a2a\u554f Admin CP \u4e2d\u7684\u67d0\u4e9b\u958b\u767c\u5de5\u5177\uff08\u5982\u5efa\u7acb\u8def\u7531\uff0c\u6b0a\u9650\uff0c\u7ba1\u7406\u5c0e\u89bd\u7b49\uff09\uff0c\u5b83\u9084\u5c07\u5728\u6bcf\u500b\u9801\u9762\u7684\u5e95\u90e8\u555f\u7528\u4e00\u500b\u63a7\u5236\u53f0\u8f38\u51fa\uff0c\u8a73\u7d30\u8aaa\u660e\u9801\u9762\u8655\u7406\u7684\u6642\u9593\uff0c\u6709\u591a\u5c11\u67e5\u8a62\u88ab\u57f7\u884c\u4f86\u6e32\u67d3\u9801\u9762\u548c\u4f7f\u7528\u4e86\u591a\u5c11\u8a18\u61b6\u9ad4\u3002 \u61f8\u505c\u6642\uff0c\u6703\u6709\u4e00\u500b\u5305\u542b\u76ee\u524d Controller\u3001 Action \u548c\u6a21\u677f\u540d\u7a31\u7b49\u8cc7\u8a0a\u7684\u5de5\u5177\u63d0\u793a\u3002 \u4f60\u4e5f\u53ef\u4ee5\u9ede\u9078\u6642\u9593\u8f38\u51fa\uff0c\u9019\u5c07\u8b93\u4f60\u8a73\u7d30\u4e86\u89e3\u5230\u5e95\u57f7\u884c\u4e86\u54ea\u4e9b\u67e5\u8a62\uff0c\u4ee5\u53ca\u5c0e\u81f4\u8a72\u67e5\u8a62\u88ab\u57f7\u884c\u7684\u5806\u758a\u8ffd\u8e64\u3002 \u4f60\u53ef\u4ee5\u901a\u904e\u5728 config.php \u4e2d\u65b0\u589e\u4ee5\u4e0b\u5167\u5bb9\u4f86\u555f\u7528\u9664\u932f\u6a21\u5f0f\uff1a $config['debug'] = true; \u555f\u7528\u958b\u767c\u6a21\u5f0f \u00b6 \u958b\u767c\u6a21\u5f0f\u662f\u4e00\u7a2e\u7279\u6b8a\u7684\u6a21\u5f0f\uff0c\u5728\u60a8\u7684 config.php \u6a94\u6848\u4e2d\u555f\u7528\uff0c\u5b83\u5c07\u89f8\u767c XF \u81ea\u52d5\u5c07\u60a8\u7684\u958b\u767c\u6a94\u6848\u5beb\u5165 _output \u76ee\u9304\u3002 \u9019\u500b\u6a21\u5f0f\u9700\u8981\u5728\u6a94\u6848\u7cfb\u7d71\u6a21\u677f\u7de8\u8f2f\u6642\u555f\u7528\u3002 \u7531\u65bc\u958b\u767c\u6a21\u5f0f\u6703\u5c07\u6a94\u6848\u5beb\u5165\u4f60\u7684\u6a94\u6848\u7cfb\u7d71\uff0c\u78ba\u4fdd\u4f60\u6709\u9069\u7576\u7684\u6a94\u6848\u6b0a\u9650\u662f\u5f88\u91cd\u8981\u7684\u3002 \u9019\u53ef\u80fd\u6703\u6839\u64da\u74b0\u5883\u7684\u4e0d\u540c\u800c\u6709\u6240\u4e0d\u540c\uff0c\u4f46\u5178\u578b\u7684\u914d\u7f6e\u662f\u78ba\u4fdd\u4f60\u6b63\u5728\u4f7f\u7528\u7684\u4efb\u4f55\u9644\u52a0\u5143\u4ef6\u7684 _output \u76ee\u9304\u7684 chmod \u8a2d\u5b9a\u70ba 0777 \u3002 \u4f8b\u5982\uff0c\u5982\u679c\u4f60\u6b63\u5728\u4f7f\u7528\u4e00\u500b ID \u70ba Demo \u7684\u9644\u52a0\u5143\u4ef6\uff0c\u5b83\u7684\u958b\u767c\u8f38\u51fa\u5c07\u88ab\u5beb\u5165\u5230 src/addons/Demo/_output \uff0c\u56e0\u6b64\u8a72\u76ee\u9304\u9700\u8981\u662f\u5b8c\u5168\u53ef\u5beb\u7684\u3002 \u555f\u7528\u958b\u767c\u6a21\u5f0f\uff0c\u4e5f\u6703\u81ea\u52d5\u555f\u7528 \u9664\u932f\u6a21\u5f0f \u3002 \u8981\u555f\u7528\u958b\u767c\u6a21\u5f0f\uff0c\u8acb\u5728\u4f60\u7684 config.php \u6a94\u6848\u4e2d\u65b0\u589e\u4ee5\u4e0b\u884c\uff1a $config['development']['enabled'] = true; $config['development']['defaultAddOn'] = 'SomeCompany/MyAddOn'; defaultAddOn \u503c\u662f\u53ef\u9078\u7684\uff0c\u4f46\u7576\u5efa\u7acb\u65b0\u5167\u5bb9\u6642\uff0c\u6dfb\u52a0\u8a72\u503c\u6703\u5728 XF Admin CP \u4e2d\u81ea\u52d5\u586b\u5145\u6307\u5b9a\u7684\u9644\u52a0\u5143\u4ef6\uff0c\u8a72\u9644\u52a0\u5143\u4ef6\u5c07\u8207\u9644\u52a0\u5143\u4ef6\u76f8\u95dc\u806f\u3002 \u9664\u4e86\u4e0a\u8ff0\uff0c\u4f60\u53ef\u80fd\u6703\u767c\u73fe\u6709\u5fc5\u8981\u65b0\u589e\u4e00\u4e9b\u984d\u5916\u7684\u914d\u7f6e\uff0c\u7279\u5225\u662f\u7576\u4f60\u4f7f\u7528\u591a\u500b XF \u5b89\u88dd\u6642\u3002 $config['enableMail'] = false; \u9019\u5c07\u95dc\u9589\u6240\u6709\u5f9e\u60a8\u7684\u8ad6\u58c7\u767c\u9001\u7684\u90f5\u4ef6\u3002 \u5982\u679c\u60a8\u4f7f\u7528\u7684\u662f\u771f\u5be6\u7528\u6236\u548c\u771f\u5be6\u90f5\u4ef6\u5730\u5740\u7684\u5be6\u6642\u8cc7\u6599\u526f\u672c\uff0c\u9019\u4e00\u9ede\u5c24\u70ba\u91cd\u8981\uff08\u5118\u7ba1\u6211\u5011\u5efa\u8b70\u4e0d\u8981\u9019\u6a23\u505a\uff01\uff09\u3002 \u9664\u4e86\u76f4\u63a5\u95dc\u9589\u90f5\u4ef6\u4e4b\u5916, \u60a8\u53ef\u4ee5\u8003\u616e\u4f7f\u7528\u4e00\u500b\u670d\u52d9, \u4f8b\u5982 MailTrap.io \u3002 \u9019\u5c07\u70ba\u60a8\u63d0\u4f9b\u4e00\u500b\u514d\u8cbb\u7684\u90f5\u7bb1\uff0c\u53ef\u4ee5\u63a5\u6536\u6240\u6709\u5f9e\u60a8\u7684\u8ad6\u58c7\u767c\u9001\u7684\u90f5\u4ef6\uff0c\u9019\u5c0d\u65bc\u6e2c\u8a66\u60a8\u7684\u65b0\u9644\u52a0\u5143\u4ef6\u53ef\u80fd\u767c\u9001\u7684\u4efb\u4f55\u96fb\u5b50\u90f5\u4ef6\u975e\u5e38\u6709\u7528\u3002 $config['cookie']['prefix'] = 'anything_'; \u5982\u679c\u60a8\u5728\u540c\u4e00\u57df\u540d\u4e0a\u4f7f\u7528\u5169\u500b\u6216\u66f4\u591a\u7684 XF \u5b89\u88dd\uff0c\u60a8\u53ef\u80fd\u6703\u9047\u5230 Cookie \u88ab\u8986\u84cb\u7684\u554f\u984c\uff0c\u9019\u662f\u7531\u5b89\u88dd\u5171\u4eab\u76f8\u540c\u7684 Cookie \u524d\u7db4\u5f15\u8d77\u7684\u3002 \u56e0\u6b64\uff0c\u5efa\u8b70\u60a8\u78ba\u4fdd\u70ba\u60a8\u8a2d\u5b9a\u7684\u6bcf\u500b XF \u5b89\u88dd\u66f4\u6539 Cookie \u524d\u7db4\u3002 \u5982\u679c\u4e0d\u9019\u6a23\u505a\uff0c\u60a8\u5c07\u6703\u9047\u5230\u4e00\u4e9b\u554f\u984c\uff0c\u4f8b\u5982\uff0c\u7576\u767b\u9304\u5230\u53e6\u4e00\u500b XF \u5b89\u88dd\u6642\uff0c\u6703\u88ab\u8a3b\u92b7\u3002 \u958b\u767c\u6307\u4ee4 \u00b6 XF 2.0 \u63d0\u4f9b\u4e86\u4e00\u4e9b\u901a\u7528\u7684\u958b\u767c\u548c\u9644\u52a0\u5143\u4ef6\u7684 CLI \u6307\u4ee4\uff0c\u9019\u4e9b\u6307\u4ee4\u7684\u76ee\u7684\u662f\u5e6b\u52a9\u60a8\u66f4\u6709\u6548\u5730\u958b\u767c\uff0c\u751a\u81f3\u53ef\u80fd\u4f7f\u4e00\u4e9b\u5e38\u898b\u7684\u904e\u7a0b\u81ea\u52d5\u5316/\u8173\u672c\u5316\u3002 \u5728\u672c\u7bc0\u4e2d\uff0c\u6211\u5011\u5c07\u4ecb\u7d39\u4e00\u4e9b\u5e38\u7528\u7684\u5de5\u5177\uff0c\u4e26\u89e3\u91cb\u5b83\u5011\u7684\u4f5c\u7528\u3002 \u9644\u52a0\u5143\u4ef6\u7279\u5b9a\u6307\u4ee4 \u00b6 \u65b0\u5efa\u4e00\u500b\u9644\u52a0\u5143\u4ef6 \u00b6 Terminal $ php cmd.php xf-addon:create xf-addon:create \u6307\u4ee4\u662f\u5982\u4f55\u521d\u59cb\u8a2d\u5b9a\u548c\u5efa\u7acb\u4e00\u500b\u65b0\u7684\u9644\u52a0\u5143\u4ef6\u3002 \u4e00\u65e6\u5b83\u57f7\u884c\uff0c\u4f60\u53ea\u9700\u8981\u56de\u7b54\u4e00\u4e9b\u57fa\u672c\u554f\u984c\uff1a \u8f38\u5165\u6b64\u9644\u52a0\u5143\u4ef6\u7684 ID \u8f38\u5165\u6a19\u984c \u8f38\u5165\u7248\u672c ID\uff08\u5982 1000010 \uff09\u3002 \u8f38\u5165\u7248\u672c\u5b57\u4e32\uff08\u5982 1.0.0 Alpha\uff09\u3002 \u7136\u5f8c\u4f60\u6703\u5f97\u5230\u4e00\u500b\u9078\u9805\u4f86\u5efa\u7acb\u9644\u52a0\u5143\u4ef6\u4e26\u5beb\u51fa\u5b83\u7684 addon.json \u6a94\u6848\uff0c\u4e26\u8a62\u554f\u4f60\u4e00\u4e9b\u95dc\u65bc\u662f\u5426\u8981\u65b0\u589e Setup.php \u6a94\u6848\u7684\u554f\u984c\u3002 \u532f\u51fa _data .XML \u6a94\u6848 \u00b6 Terminal $ php cmd.php xf-addon:export [addon_id] \u9019\u689d\u6307\u4ee4\u5c07\u7528\u65bc\u532f\u51fa\u6240\u6709\u9644\u52a0\u5143\u4ef6\u7684\u8cc7\u6599\u5230 _data \u76ee\u9304\u4e0b\u7684 XML \u6a94\u6848\u3002 \u5b83\u5f9e\u76ee\u524d\u8cc7\u6599\u5eab\u4e2d\u532f\u51fa\u8cc7\u6599\uff08\u800c\u4e0d\u662f\u5f9e\u958b\u767c\u8f38\u51fa\u6a94\u6848\u4e2d\u532f\u51fa\uff09\u3002 \u5347\u7d1a\u60a8\u7684\u9644\u52a0\u5143\u4ef6\u7248\u672c \u00b6 Terminal $ php cmd.php xf-addon:bump-version [addon_id] --version-id 1020370 --version-string 1.2.3 Note \u5982\u679c\u4f60\u7684\u7248\u672c\u5b57\u4e32\u5305\u542b\u7a7a\u683c\uff0c\u4f60\u9700\u8981\u7528\u5f15\u865f\u5c07\u5176\u5305\u570d\u3002 \u8a72\u6307\u4ee4\u7372\u53d6\u60a8\u7684\u9644\u52a0\u5143\u4ef6\u7684\u9644\u52a0\u5143\u4ef6 ID\u3001\u65b0\u7248\u672c ID \u548c\u65b0\u7248\u672c\u5b57\u4e32\u3002 \u9019\u6a23\u60a8\u5c31\u53ef\u4ee5\u8f15\u9b06\u5b8c\u6210\u5347\u7d1a\u9644\u52a0\u5143\u4ef6\u7684\u7248\u672c\uff0c\u800c\u7121\u9700\u81ea\u5df1\u57f7\u884c\u5347\u7d1a\u548c\u91cd\u5efa\u3002 \u4e0a\u9762\u7684\u9078\u9805\u662f\u53ef\u9078\u7684\uff0c\u5982\u679c\u6c92\u6709\u63d0\u4f9b\u9019\u4e9b\u9078\u9805\uff0c\u7cfb\u7d71\u6703\u63d0\u793a\u60a8\u8f38\u5165\u3002 \u5982\u679c\u60a8\u53ea\u6307\u5b9a\u7248\u672c ID\uff0c\u5982\u679c\u5b83\u7b26\u5408\u6211\u5011 \u63a8\u85a6\u7684\u7248\u672cID\u683c\u5f0f \uff0c\u6211\u5011\u5c07\u5617\u8a66\u4e26\u81ea\u52d5\u5f9e\u4e2d\u63a8\u65b7\u51fa\u6b63\u78ba\u7684\u7248\u672c\u5b57\u4e32\u3002 \u4e00\u65e6\u6307\u4ee4\u5b8c\u6210\uff0c\u5b83\u5c07\u81ea\u52d5\u66f4\u65b0 addon.json \u6a94\u6848\u548c\u8cc7\u6599\u5eab\uff0c\u4e26\u63d0\u4f9b\u6b63\u78ba\u7684\u7248\u672c\u8a73\u7d30\u8cc7\u8a0a\u3002 \u540c\u6b65\u4f60\u7684 addon.json \u5230\u8cc7\u6599\u5eab \u00b6 Terminal $ php cmd.php xf-addon:sync-json [addon_id] \u6709\u6642\u4f60\u53ef\u80fd\u66f4\u559c\u6b61\u76f4\u63a5\u7de8\u8f2f JSON \u6a94\u6848\u4e2d\u7684\u67d0\u4e9b\u7d30\u7bc0\uff0c\u9019\u53ef\u80fd\u662f\u7248\u672c\uff0c\u6216\u65b0\u7684\u5716\u793a\uff0c\u6216\u66f4\u6539\u6a19\u984c\u6216\u63cf\u8ff0\u3002 \u4ee5\u9019\u7a2e\u65b9\u5f0f\u66f4\u6539 JSON \u53ef\u80fd\u6703\u5c0e\u81f4\u9644\u52a0\u5143\u4ef6\u7cfb\u7d71\u8a8d\u70ba\u6709\u5f85\u5b9a\u7684\u66f4\u6539\u6216\u9644\u52a0\u5143\u4ef6\u662f\u53ef\u5347\u7d1a\u7684\u3002 \u5982\u679c\u60a8\u5c1a\u672a\u532f\u51fa\u76ee\u524d\u8cc7\u6599\uff0c\u5247\u91cd\u5efa\u6216\u5347\u7d1a\u53ef\u80fd\u662f\u4e00\u7a2e\u7834\u58de\u6027\u7684\u64cd\u4f5c\u3002 \u56e0\u6b64\uff0c\u5efa\u8b70\u57f7\u884c\u6b64\u6307\u4ee4\u4f5c\u70ba\u532f\u5165\u8a72\u8cc7\u6599\u7684\u65b9\u5f0f\uff0c\u800c\u4e0d\u5f71\u97ff\u60a8\u7684\u73fe\u6709\u8cc7\u6599\u3002 \u9a57\u8b49\u60a8\u7684 addon.json \u6a94\u6848 \u00b6 Terminal $ php cmd.php xf-addon:validate-json [addon_id] \u5982\u679c\u4f60\u60f3\u6aa2\u67e5\u4f60\u7684 JSON \u6a94\u6848\u662f\u5426\u5305\u542b\u6b63\u78ba\u7684\u5167\u5bb9\u548c\u6b63\u78ba\u7684\u683c\u5f0f\uff0c\u4f60\u73fe\u5728\u53ef\u4ee5\u9a57\u8b49\u5b83\u3002 \u9a57\u8b49\u5668\u5c07\u6aa2\u67e5\u5167\u5bb9\u662f\u5426\u53ef\u4ee5\u89e3\u78bc\uff0c\u662f\u5426\u5305\u542b\u6240\u6709\u6b63\u78ba\u7684\u5fc5\u586b\u6b04\u4f4d\uff08\u5982\u6a19\u984c\u548c\u7248\u672c ID \uff09\uff0c\u9084\u6aa2\u67e5\u662f\u5426\u5b58\u5728\u53ef\u9078\u7684 Key\uff08\u5982\u63cf\u8ff0\u548c\u5716\u793a\uff09\u3002 \u5982\u679c\u6709\u4efb\u4f55 Key \u4e1f\u5931\uff0c\u6211\u5011\u5c07\u70ba\u60a8\u63d0\u4f9b\u4fee\u5fa9\u554f\u984c\u7684\u670d\u52d9\u3002 \u6211\u5011\u9084\u6aa2\u67e5 JSON \u6a94\u6848\u4e2d\u662f\u5426\u6709\u4efb\u4f55\u610f\u5916\u7684\u6b04\u4f4d\u3002 \u9019\u4e9b\u53ef\u80fd\u662f\u6545\u610f\u7684\uff0c\u4e5f\u53ef\u80fd\u662f\u932f\u5225\u5b57\u3002 \u60a8\u53ef\u4ee5\u624b\u52d5\u57f7\u884c\u8a72\u547d\u4ee4\uff0c\u6216\u8005\u5728\u69cb\u5efa\u767c\u884c\u7248\u6642\u81ea\u52d5\u57f7\u884c\u8a72\u6307\u4ee4\u3002 \u57f7\u884c\u7279\u5b9a\u7684\u8a2d\u5b9a\u6b65\u9a5f \u00b6 \u6709\u6642\uff0c\u7121\u9700\u9032\u884c\u89e3\u9664\u5b89\u88dd\u548c\u91cd\u65b0\u5b89\u88dd\u904e\u7a0b\u5373\u53ef\u6aa2\u67e5 Setup class \u6b65\u9a5f\u662f\u5426\u6b63\u5e38\u904b\u884c\uff0c\u9019\u662f\u5f88\u6709\u5e6b\u52a9\u7684\u3002 \u6709\u4e09\u689d\u6307\u4ee4\u53ef\u4ee5\u5e6b\u52a9\u89e3\u6c7a\u9019\u500b\u554f\u984c\uff0c\u9019\u4e9b\u547d\u4ee4\u53ea\u9069\u7528\u65bc\u4f7f\u7528\u9810\u8a2d\u7684 StepRunner \u7279\u6027\u5efa\u7acb\u7684 Setup class\u3002 \u57f7\u884c\u5b89\u88dd\u6b65\u9a5f \u00b6 Terminal $ php cmd.php xf-addon:install-step [addon_id] [step] \u57f7\u884c\u5347\u7d1a\u6b65\u9a5f \u00b6 Terminal $ php cmd.php xf-addon:upgrade-step [addon_id] [version] [step] \u57f7\u884c\u89e3\u9664\u5b89\u88dd\u6b65\u9a5f \u00b6 Terminal $ php cmd.php xf-addon:uninstall-step [addon_id] [step] \u69cb\u5efa\u9644\u52a0\u5143\u4ef6\u767c\u884c\u7248 \u00b6 \u4e00\u65e6\u6240\u6709\u7684\u8271\u82e6\u5de5\u4f5c\u90fd\u5b8c\u6210\u4e86\uff0c\u5f88\u907a\u61be\uff0c\u5728\u771f\u6b63\u767c\u4f48\u4e4b\u524d\u9084\u8981\u7d93\u6b77\u4e00\u4e9b\u5176\u4ed6\u7684\u904e\u7a0b\u3002 \u5373\u4f7f\u662f\u5c07\u6240\u6709\u7684\u6a94\u6848\u6536\u96c6\u5230\u6b63\u78ba\u7684\u5730\u65b9\uff0c\u4e26\u624b\u52d5\u5efa\u7acb ZIP \u6a94\u6848\u7684\u904e\u7a0b\u4e5f\u662f\u5f88\u8017\u6642\u7684\uff0c\u800c\u4e14\u5bb9\u6613\u51fa\u73fe\u932f\u8aa4\u3002 \u6211\u5011\u53ef\u4ee5\u81ea\u52d5\u8655\u7406\u9019\u4e9b\u554f\u984c\uff0c\u5305\u62ec\u7528\u4e00\u500b\u7c21\u55ae\u7684\u6307\u4ee4\u7522\u751f hash.json \u6a94\u6848\u3002 Terminal $ php cmd.php xf-addon:build-release [addon_id] \u7576\u4f60\u57f7\u884c\u9019\u500b\u547d\u4ee4\u6642\uff0c\u5b83\u6703\u5148\u57f7\u884c xf-addon:export \u6307\u4ee4\uff0c\u7136\u5f8c\u5c07\u6240\u6709\u7684\u6a94\u6848\u4e00\u8d77\u6536\u96c6\u5230\u4e00\u500b\u81e8\u6642\u7684 _build \u76ee\u9304\u4e2d\uff0c\u4e26\u5c07\u5b83\u5011\u5beb\u5165\u4e00\u500b ZIP \u6a94\u6848\u3002 \u5b8c\u6210\u5f8c\u7684 ZIP \u6a94\u6848\u9084\u5c07\u5305\u542b hashes.json \u6a94\u6848\u3002 \u4e00\u65e6 ZIP \u6a94\u6848\u88ab\u5efa\u7acb\uff0c\u5b83\u5c07\u88ab\u5132\u5b58\u5230\u4f60\u7684 _releases \u76ee\u9304\u4e2d\uff0c\u4e26\u547d\u540d\u70ba <ADDON ID>-<VERSION STRING>.zip \u3002 \u81ea\u5b9a\u7fa9\u69cb\u5efa\u904e\u7a0b \u00b6 \u9664\u4e86\u5efa\u7acb\u767c\u4f48\u7684 ZIP \u4e4b\u5916\uff0c\u60a8\u53ef\u80fd\u9084\u5e0c\u671b\u5728 ZIP \u4e2d\u5305\u542b\u5176\u4ed6\u7684\u6a94\u6848\uff0c\u60a8\u5e0c\u671b\u57f7\u884c\u5176\u4ed6\u66f4\u9ad8\u7d1a\u7684\u69cb\u5efa\u904e\u7a0b\uff0c\u5982\u6700\u5c0f\u5316\u6216\u9023\u7dda JS \u6216\u57f7\u884c\u67d0\u4e9b shell \u6307\u4ee4\u3002 \u6240\u6709\u9019\u4e9b\u90fd\u53ef\u4ee5\u5728\u4f60\u7684 build.json \u6a94\u6848\u4e2d\u8655\u7406\u3002 \u9019\u662f\u4e00\u500b\u5178\u578b\u7684 build.json \u6a94\u6848\u3002 { \"additional_files\": [ \"js/demo/portal\" ], \"minify\": [ \"js/demo/portal/a.js\", \"js/demo/portal/b.js\" ], \"rollup\": { \"js/demo/portal/ab-rollup.js\": [ \"js/demo/portal/a.min.js\", \"js/demo/portal/b.min.js\" ] }, \"exec\": [ \"echo '{title} version {version_string} ({version_id}) has been built successfully!' > 'src/addons/Demo/Portal/_build/built.txt'\" ] } \u5982\u679c\u4f60\u6709\u4e00\u4e9b\u9700\u8981\u5728 add-on \u76ee\u9304\u4e4b\u5916\u63d0\u4f9b\u670d\u52d9\u7684 assets\uff0c\u6bd4\u5982 JavaScript\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528 build.json \u4e2d\u7684 additional_files \u9663\u5217\u544a\u8a34\u69cb\u5efa\u904e\u7a0b\u8907\u88fd\u6a94\u6848\u6216\u76ee\u9304\u3002 \u5728\u958b\u767c\u904e\u7a0b\u4e2d\uff0c\u5c07\u6a94\u6848\u5132\u5b58\u5728 add-on \u76ee\u9304\u4e4b\u5916\u4e26\u4e0d\u7e3d\u662f\u53ef\u884c\u7684\uff0c\u6240\u4ee5\u5982\u679c\u4f60\u9858\u610f\uff0c\u4f60\u53ef\u4ee5\u5c07\u6a94\u6848\u5132\u5b58\u5728 add-on \u7684 _files \u76ee\u9304\u4e2d\u3002 \u5728\u8907\u88fd\u9644\u52a0\u6a94\u6848\u6642\uff0c\u6211\u5011\u5c07\u9996\u5148\u6aa2\u67e5\u8a72\u6a94\u6848\u3002 \u5982\u679c\u60a8\u7684\u9644\u52a0\u5143\u4ef6\u9644\u5e36\u4e86\u4e00\u4e9b JS \u6a94\u6848\uff0c\u51fa\u65bc\u6548\u80fd\u8003\u616e\uff0c\u60a8\u53ef\u80fd\u6703\u5e0c\u671b\u5c0d\u9019\u4e9b\u6a94\u6848\u9032\u884c\u6700\u5c0f\u5316\u3002 \u60a8\u53ef\u4ee5\u5728\u60a8\u7684 build.json \u4e2d\u6307\u5b9a\u60a8\u8981\u6700\u5c0f\u5316\u7684\u6a94\u6848\u3002 \u60a8\u53ef\u4ee5\u5c07\u9019\u4e9b\u6a94\u6848\u4ee5\u9663\u5217\u7684\u5f62\u5f0f\u5217\u51fa\uff0c\u4e5f\u53ef\u4ee5\u76f4\u63a5\u6307\u5b9a\u70ba '*' \uff0c\u9019\u6a23\u5c31\u6703\u5c0d js \u76ee\u9304\u4e2d\u7684\u6240\u6709\u6a94\u6848\u9032\u884c\u6700\u5c0f\u5316\uff0c\u53ea\u8981\u8a72\u8def\u5f91\u4e2d\u5b58\u5728 JS \u6a94\u6848\uff0c\u4e26\u5c07\u984d\u5916\u7684\u6a94\u6848\u8907\u88fd\u5230\u69cb\u5efa\u4e2d\u5373\u53ef\u3002 \u4efb\u4f55\u88ab\u6700\u5c0f\u5316\u7684\u6a94\u6848\u90fd\u6703\u81ea\u52d5\u4ee5 .min.js \u4f5c\u70ba\u5f8c\u7db4\uff0c\u800c\u4e0d\u662f .js \uff0c\u4e26\u4e14\u539f\u59cb\u6a94\u6848\u4ecd\u7136\u5728\u5305\u4e2d\u3002 \u4f60\u53ef\u80fd\u66f4\u559c\u6b61\u5c07\u591a\u500b JS \u6a94\u6848\u6346\u6210\u4e00\u500b\u6a94\u6848\u3002 \u5982\u679c\u4f60\u9019\u6a23\u505a\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528 rollup \u9663\u5217\u4f86\u5b9a\u7fa9\u3002 key \u662f\u5408\u4f75\u5f8c\u7684\u6a94\u540d\uff0c\u9663\u5217\u4e2d\u7684 item \u662f JS \u6a94\u6848\u7684\u8def\u5f91\uff0c\u9019\u4e9b\u6a94\u6848\u5c07\u88ab\u5408\u4f75\u6210\u4e00\u500b\u6a94\u6848\u3002 \u6700\u5f8c\uff0c\u60a8\u53ef\u80fd\u9700\u8981\u5728\u6253\u5305\u69cb\u5efa\u548c\u6700\u7d42\u5b9a\u6848\u4e4b\u524d\u57f7\u884c\u67d0\u4e9b\u7a0b\u5e8f\u3002 \u9019\u53ef\u80fd\u662f\u4efb\u4f55\u6771\u897f\u7684\u7d44\u5408\u3002 \u6b78\u6839\u7d50\u5e95\uff0c\u5982\u679c\u5b83\u662f\u4e00\u500b\u53ef\u4ee5\u5f9e shell \u4e2d\u57f7\u884c\u7684\u6307\u4ee4\uff08\u5305\u62ec PHP \u8173\u672c\uff09\uff0c\u90a3\u9ebc\u4f60\u53ef\u4ee5\u5728\u9019\u88e1\u6307\u5b9a\u5b83\u3002 \u7576\u7136\uff0c\u4e0a\u9762\u7684\u793a\u4f8b\u662f\u6beb\u7121\u7528\u8655\u7684\uff0c\u4f46\u5b83\u81f3\u5c11\u8b49\u660e\u4e86\u67d0\u4e9b\u4fdd\u7559\u5340\u662f\u53ef\u4ee5\u4f7f\u7528\u7684\u3002 \u9019\u4e9b\u4fdd\u7559\u5340\u88ab\u66ff\u63db\u70ba\u6a19\u91cf\u503c\uff0c\u4f60\u53ef\u4ee5\u5f9e XF\\AddOn\\AddOn \u7269\u4ef6\u4e2d\u7372\u5f97\uff0c\u4e00\u822c\u4f86\u8aaa\uff0c\u9019\u500b\u7269\u4ef6\u662f addon.json \u6a94\u6848\u4e2d\u7684\u4efb\u4f55\u53ef\u7528\u503c\uff0c\u6216\u8005 AddOn \u5be6\u9ad4\u3002 \u958b\u767c\u6307\u4ee4 \u00b6 \u5176\u5be6\u8207\u958b\u767c\u76f8\u95dc\u7684\u6307\u4ee4\u6709\u4e0d\u5c11\uff0c\u4f46\u9019\u88e1\u53ea\u4ecb\u7d39\u6700\u91cd\u8981\u7684\u5169\u500b\u3002 \u8981\u4f7f\u7528\u9019\u4e9b\u6307\u4ee4\uff0c\u4f60\u5fc5\u9808\u5728\u4f60\u7684 config.php \u6a94\u6848\u4e2d\u555f\u7528 \u958b\u767c\u6a21\u5f0f \u3002 Warning \u5982\u679c\u51fa\u73fe\u8cc7\u6599\u5eab\u548c _output \u76ee\u9304\u4e0d\u540c\u6b65\u7684\u60c5\u6cc1\uff0c\u4ee5\u4e0b\u5169\u500b\u6307\u4ee4\u90fd\u6709\u53ef\u80fd\u5c0e\u81f4\u8cc7\u6599\u4e1f\u5931\u3002\u5efa\u8b70\u4f7f\u7528 VCS (\u7248\u672c\u63a7\u5236\u7cfb\u7d71)\uff0c\u5982 GitHub \u4f86\u6e1b\u8f15\u9019\u7a2e\u932f\u8aa4\u7684\u5f71\u97ff\u3002 \u532f\u5165\u958b\u767c\u8f38\u51fa \u00b6 Terminal $ php cmd.php xf-dev:import --addon [addon_id] \u57f7\u884c\u6b64\u6307\u4ee4\u5c07\u628a\u4f60\u7684\u9644\u52a0\u5143\u4ef6 _output \u76ee\u9304\u4e0b\u7684\u6240\u6709\u958b\u767c\u6642\u8f38\u51fa\u7684\u6a94\u6848\u532f\u5165\u9032\u8cc7\u6599\u5eab\u88e1\u3002 \u532f\u51fa\u958b\u767c\u8f38\u51fa \u00b6 Terminal $ php cmd.php xf-dev:export --addon [addon_id] \u9019\u5c07\u628a\u76ee\u524d\u8cc7\u6599\u5eab\u4e2d\u8207\u9644\u52a0\u5143\u4ef6\u76f8\u95dc\u806f\u7684\u6240\u6709\u8cc7\u6599\u532f\u51fa\u5230 _output \u76ee\u9304\u4e0b\u7684\u6a94\u6848\u4e2d\u3002 \u9664\u932f\u7a0b\u5f0f\u78bc \u00b6 \u61c9\u8a72\u53ef\u4ee5\u8a2d\u5b9a\u4f60\u559c\u6b61\u7684\u9664\u932f\u5de5\u5177\uff08 XDebug\uff0cZend Debugger \u7b49\uff09\u4f86\u8207 XF2 \u4e00\u8d77\u904b\u4f5c\u3002 \u96d6\u7136\uff0c\u6709\u6642\u5019\uff0c\u9664\u932f\u7a0b\u5f0f\u78bc\u53ef\u80fd\u50cf\u5feb\u901f\u67e5\u770b\u4e00\u500b\u8b8a\u6578\u5728\u7d66\u5b9a\u6642\u9593\u5167\u6301\u6709\u7684\u503c\uff08\u6216\u503c\u985e\u578b\uff09\u4e00\u6a23\u7c21\u964b\u3002 Dump \u8b8a\u6578 \u00b6 \u7576\u7136 PHP \u6709\u4e00\u500b\u5167\u5efa\u7684\u5de5\u5177\u4f86\u8655\u7406\u9019\u500b\u554f\u984c\uff0c\u60a8\u53ef\u80fd\u5c07\u5176\u7a31\u70ba var_dump() \u3002 XF \u63d0\u4f9b\u4e86\u5169\u500b\u66ff\u4ee3\u65b9\u6cd5\u4f86\u8655\u7406\u9019\u500b\u554f\u984c\uff1a \\XF::dump($var); \\XF::dumpSimple($var); \u7c21\u55ae\u7248\u672c\u4e3b\u8981\u662f\u5c07\u4e00\u500b\u8b8a\u6578\u7684\u503c\u4ee5\u7d14\u6587\u5b57\u7684\u5f62\u5f0f\u8f49\u5132\u51fa\u4f86\u3002 \u4f8b\u5982\uff0c\u5982\u679c\u4f60\u53ea\u662f\u7528\u5b83\u4f86\u8f49\u5132\u4e00\u500b\u9663\u5217\u7684\u503c\uff0c\u4f60\u6703\u5728\u9801\u9762\u9802\u90e8\u770b\u5230\u9019\u6a23\u7684\u8f38\u51fa\uff1a array(2) { [\"user_id\"] => int(1) [\"username\"] => string(5) \"Admin\" } \u9019\u5be6\u969b\u4e0a\u662f\u8207\u6a19\u6e96\u7684 var_dump \u76f8\u540c\u7684\u8f38\u51fa\uff0c\u4f46\u70ba\u4e86\u53ef\u8b80\u6027\u7a0d\u4f5c\u4fee\u6539\uff0c\u4e26\u5c07\u5176\u5305\u88f9\u5728 <pre> \u6a19\u7c64\u4e2d\uff0c\u4ee5\u78ba\u4fdd\u5728\u6e32\u67d3\u6642\u4fdd\u7559\u7a7a\u767d\u3002 \u9019\u500b\u66ff\u4ee3\u65b9\u6848\u5be6\u969b\u4e0a\u662f Symfony \u9805\u76ee\u4e2d\u7684\u4e00\u500b\u540d\u70ba VarDumper \u7684\u5143\u4ef6\u3002 \u5b83\u8f38\u51fa HTML\u3001 CSS \u548c JS \u4f86\u5efa\u7acb\u4e00\u500b\u529f\u80fd\u66f4\u5f37\u3001\u66f4\u5bb9\u6613\u95b1\u8b80\u7684\u8f38\u51fa\u3002 \u5b83\u5141\u8a31\u4f60\u647a\u758a\u67d0\u4e9b\u90e8\u5206\uff0c\u5c0d\u65bc\u67d0\u4e9b\u53ef\u4ee5\u8f38\u51fa\u5927\u91cf\u8cc7\u6599\u7684\u503c\uff0c\u6bd4\u5982\u7269\u4ef6\uff0c\u5b83\u53ef\u4ee5\u81ea\u52d5\u647a\u758a\u9019\u4e9b\u90e8\u5206\u3002","title":"\u958b\u767c\u5de5\u5177"},{"location":"development-tools/#_1","text":"XF2 \u70ba\u958b\u767c\u8005\u63d0\u4f9b\u4e86\u5927\u91cf\u7684\u5167\u5efa\u5de5\u5177\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528\u9019\u4e9b\u5de5\u5177\u4f86\u52a0\u5feb\u9644\u52a0\u5143\u4ef6\u7684\u958b\u767c\uff0c\u4e0b\u9762\u6211\u5011\u5c07\u4ecb\u7d39\u5176\u4e2d\u7684\u4e00\u4e9b\u3002","title":"\u958b\u767c\u5de5\u5177"},{"location":"development-tools/#_2","text":"\u9664\u932f\u6a21\u5f0f\u53ef\u4ee5\u5728\u4f60\u7684 config.php \u4e2d\u555f\u7528\uff0c\u9019\u5c07\u5141\u8a31\u4f60\u8a2a\u554f Admin CP \u4e2d\u7684\u67d0\u4e9b\u958b\u767c\u5de5\u5177\uff08\u5982\u5efa\u7acb\u8def\u7531\uff0c\u6b0a\u9650\uff0c\u7ba1\u7406\u5c0e\u89bd\u7b49\uff09\uff0c\u5b83\u9084\u5c07\u5728\u6bcf\u500b\u9801\u9762\u7684\u5e95\u90e8\u555f\u7528\u4e00\u500b\u63a7\u5236\u53f0\u8f38\u51fa\uff0c\u8a73\u7d30\u8aaa\u660e\u9801\u9762\u8655\u7406\u7684\u6642\u9593\uff0c\u6709\u591a\u5c11\u67e5\u8a62\u88ab\u57f7\u884c\u4f86\u6e32\u67d3\u9801\u9762\u548c\u4f7f\u7528\u4e86\u591a\u5c11\u8a18\u61b6\u9ad4\u3002 \u61f8\u505c\u6642\uff0c\u6703\u6709\u4e00\u500b\u5305\u542b\u76ee\u524d Controller\u3001 Action \u548c\u6a21\u677f\u540d\u7a31\u7b49\u8cc7\u8a0a\u7684\u5de5\u5177\u63d0\u793a\u3002 \u4f60\u4e5f\u53ef\u4ee5\u9ede\u9078\u6642\u9593\u8f38\u51fa\uff0c\u9019\u5c07\u8b93\u4f60\u8a73\u7d30\u4e86\u89e3\u5230\u5e95\u57f7\u884c\u4e86\u54ea\u4e9b\u67e5\u8a62\uff0c\u4ee5\u53ca\u5c0e\u81f4\u8a72\u67e5\u8a62\u88ab\u57f7\u884c\u7684\u5806\u758a\u8ffd\u8e64\u3002 \u4f60\u53ef\u4ee5\u901a\u904e\u5728 config.php \u4e2d\u65b0\u589e\u4ee5\u4e0b\u5167\u5bb9\u4f86\u555f\u7528\u9664\u932f\u6a21\u5f0f\uff1a $config['debug'] = true;","title":"\u9664\u932f\u6a21\u5f0f"},{"location":"development-tools/#_3","text":"\u958b\u767c\u6a21\u5f0f\u662f\u4e00\u7a2e\u7279\u6b8a\u7684\u6a21\u5f0f\uff0c\u5728\u60a8\u7684 config.php \u6a94\u6848\u4e2d\u555f\u7528\uff0c\u5b83\u5c07\u89f8\u767c XF \u81ea\u52d5\u5c07\u60a8\u7684\u958b\u767c\u6a94\u6848\u5beb\u5165 _output \u76ee\u9304\u3002 \u9019\u500b\u6a21\u5f0f\u9700\u8981\u5728\u6a94\u6848\u7cfb\u7d71\u6a21\u677f\u7de8\u8f2f\u6642\u555f\u7528\u3002 \u7531\u65bc\u958b\u767c\u6a21\u5f0f\u6703\u5c07\u6a94\u6848\u5beb\u5165\u4f60\u7684\u6a94\u6848\u7cfb\u7d71\uff0c\u78ba\u4fdd\u4f60\u6709\u9069\u7576\u7684\u6a94\u6848\u6b0a\u9650\u662f\u5f88\u91cd\u8981\u7684\u3002 \u9019\u53ef\u80fd\u6703\u6839\u64da\u74b0\u5883\u7684\u4e0d\u540c\u800c\u6709\u6240\u4e0d\u540c\uff0c\u4f46\u5178\u578b\u7684\u914d\u7f6e\u662f\u78ba\u4fdd\u4f60\u6b63\u5728\u4f7f\u7528\u7684\u4efb\u4f55\u9644\u52a0\u5143\u4ef6\u7684 _output \u76ee\u9304\u7684 chmod \u8a2d\u5b9a\u70ba 0777 \u3002 \u4f8b\u5982\uff0c\u5982\u679c\u4f60\u6b63\u5728\u4f7f\u7528\u4e00\u500b ID \u70ba Demo \u7684\u9644\u52a0\u5143\u4ef6\uff0c\u5b83\u7684\u958b\u767c\u8f38\u51fa\u5c07\u88ab\u5beb\u5165\u5230 src/addons/Demo/_output \uff0c\u56e0\u6b64\u8a72\u76ee\u9304\u9700\u8981\u662f\u5b8c\u5168\u53ef\u5beb\u7684\u3002 \u555f\u7528\u958b\u767c\u6a21\u5f0f\uff0c\u4e5f\u6703\u81ea\u52d5\u555f\u7528 \u9664\u932f\u6a21\u5f0f \u3002 \u8981\u555f\u7528\u958b\u767c\u6a21\u5f0f\uff0c\u8acb\u5728\u4f60\u7684 config.php \u6a94\u6848\u4e2d\u65b0\u589e\u4ee5\u4e0b\u884c\uff1a $config['development']['enabled'] = true; $config['development']['defaultAddOn'] = 'SomeCompany/MyAddOn'; defaultAddOn \u503c\u662f\u53ef\u9078\u7684\uff0c\u4f46\u7576\u5efa\u7acb\u65b0\u5167\u5bb9\u6642\uff0c\u6dfb\u52a0\u8a72\u503c\u6703\u5728 XF Admin CP \u4e2d\u81ea\u52d5\u586b\u5145\u6307\u5b9a\u7684\u9644\u52a0\u5143\u4ef6\uff0c\u8a72\u9644\u52a0\u5143\u4ef6\u5c07\u8207\u9644\u52a0\u5143\u4ef6\u76f8\u95dc\u806f\u3002 \u9664\u4e86\u4e0a\u8ff0\uff0c\u4f60\u53ef\u80fd\u6703\u767c\u73fe\u6709\u5fc5\u8981\u65b0\u589e\u4e00\u4e9b\u984d\u5916\u7684\u914d\u7f6e\uff0c\u7279\u5225\u662f\u7576\u4f60\u4f7f\u7528\u591a\u500b XF \u5b89\u88dd\u6642\u3002 $config['enableMail'] = false; \u9019\u5c07\u95dc\u9589\u6240\u6709\u5f9e\u60a8\u7684\u8ad6\u58c7\u767c\u9001\u7684\u90f5\u4ef6\u3002 \u5982\u679c\u60a8\u4f7f\u7528\u7684\u662f\u771f\u5be6\u7528\u6236\u548c\u771f\u5be6\u90f5\u4ef6\u5730\u5740\u7684\u5be6\u6642\u8cc7\u6599\u526f\u672c\uff0c\u9019\u4e00\u9ede\u5c24\u70ba\u91cd\u8981\uff08\u5118\u7ba1\u6211\u5011\u5efa\u8b70\u4e0d\u8981\u9019\u6a23\u505a\uff01\uff09\u3002 \u9664\u4e86\u76f4\u63a5\u95dc\u9589\u90f5\u4ef6\u4e4b\u5916, \u60a8\u53ef\u4ee5\u8003\u616e\u4f7f\u7528\u4e00\u500b\u670d\u52d9, \u4f8b\u5982 MailTrap.io \u3002 \u9019\u5c07\u70ba\u60a8\u63d0\u4f9b\u4e00\u500b\u514d\u8cbb\u7684\u90f5\u7bb1\uff0c\u53ef\u4ee5\u63a5\u6536\u6240\u6709\u5f9e\u60a8\u7684\u8ad6\u58c7\u767c\u9001\u7684\u90f5\u4ef6\uff0c\u9019\u5c0d\u65bc\u6e2c\u8a66\u60a8\u7684\u65b0\u9644\u52a0\u5143\u4ef6\u53ef\u80fd\u767c\u9001\u7684\u4efb\u4f55\u96fb\u5b50\u90f5\u4ef6\u975e\u5e38\u6709\u7528\u3002 $config['cookie']['prefix'] = 'anything_'; \u5982\u679c\u60a8\u5728\u540c\u4e00\u57df\u540d\u4e0a\u4f7f\u7528\u5169\u500b\u6216\u66f4\u591a\u7684 XF \u5b89\u88dd\uff0c\u60a8\u53ef\u80fd\u6703\u9047\u5230 Cookie \u88ab\u8986\u84cb\u7684\u554f\u984c\uff0c\u9019\u662f\u7531\u5b89\u88dd\u5171\u4eab\u76f8\u540c\u7684 Cookie \u524d\u7db4\u5f15\u8d77\u7684\u3002 \u56e0\u6b64\uff0c\u5efa\u8b70\u60a8\u78ba\u4fdd\u70ba\u60a8\u8a2d\u5b9a\u7684\u6bcf\u500b XF \u5b89\u88dd\u66f4\u6539 Cookie \u524d\u7db4\u3002 \u5982\u679c\u4e0d\u9019\u6a23\u505a\uff0c\u60a8\u5c07\u6703\u9047\u5230\u4e00\u4e9b\u554f\u984c\uff0c\u4f8b\u5982\uff0c\u7576\u767b\u9304\u5230\u53e6\u4e00\u500b XF \u5b89\u88dd\u6642\uff0c\u6703\u88ab\u8a3b\u92b7\u3002","title":"\u555f\u7528\u958b\u767c\u6a21\u5f0f"},{"location":"development-tools/#_4","text":"XF 2.0 \u63d0\u4f9b\u4e86\u4e00\u4e9b\u901a\u7528\u7684\u958b\u767c\u548c\u9644\u52a0\u5143\u4ef6\u7684 CLI \u6307\u4ee4\uff0c\u9019\u4e9b\u6307\u4ee4\u7684\u76ee\u7684\u662f\u5e6b\u52a9\u60a8\u66f4\u6709\u6548\u5730\u958b\u767c\uff0c\u751a\u81f3\u53ef\u80fd\u4f7f\u4e00\u4e9b\u5e38\u898b\u7684\u904e\u7a0b\u81ea\u52d5\u5316/\u8173\u672c\u5316\u3002 \u5728\u672c\u7bc0\u4e2d\uff0c\u6211\u5011\u5c07\u4ecb\u7d39\u4e00\u4e9b\u5e38\u7528\u7684\u5de5\u5177\uff0c\u4e26\u89e3\u91cb\u5b83\u5011\u7684\u4f5c\u7528\u3002","title":"\u958b\u767c\u6307\u4ee4"},{"location":"development-tools/#_5","text":"","title":"\u9644\u52a0\u5143\u4ef6\u7279\u5b9a\u6307\u4ee4"},{"location":"development-tools/#_6","text":"Terminal $ php cmd.php xf-addon:create xf-addon:create \u6307\u4ee4\u662f\u5982\u4f55\u521d\u59cb\u8a2d\u5b9a\u548c\u5efa\u7acb\u4e00\u500b\u65b0\u7684\u9644\u52a0\u5143\u4ef6\u3002 \u4e00\u65e6\u5b83\u57f7\u884c\uff0c\u4f60\u53ea\u9700\u8981\u56de\u7b54\u4e00\u4e9b\u57fa\u672c\u554f\u984c\uff1a \u8f38\u5165\u6b64\u9644\u52a0\u5143\u4ef6\u7684 ID \u8f38\u5165\u6a19\u984c \u8f38\u5165\u7248\u672c ID\uff08\u5982 1000010 \uff09\u3002 \u8f38\u5165\u7248\u672c\u5b57\u4e32\uff08\u5982 1.0.0 Alpha\uff09\u3002 \u7136\u5f8c\u4f60\u6703\u5f97\u5230\u4e00\u500b\u9078\u9805\u4f86\u5efa\u7acb\u9644\u52a0\u5143\u4ef6\u4e26\u5beb\u51fa\u5b83\u7684 addon.json \u6a94\u6848\uff0c\u4e26\u8a62\u554f\u4f60\u4e00\u4e9b\u95dc\u65bc\u662f\u5426\u8981\u65b0\u589e Setup.php \u6a94\u6848\u7684\u554f\u984c\u3002","title":"\u65b0\u5efa\u4e00\u500b\u9644\u52a0\u5143\u4ef6"},{"location":"development-tools/#_data-xml","text":"Terminal $ php cmd.php xf-addon:export [addon_id] \u9019\u689d\u6307\u4ee4\u5c07\u7528\u65bc\u532f\u51fa\u6240\u6709\u9644\u52a0\u5143\u4ef6\u7684\u8cc7\u6599\u5230 _data \u76ee\u9304\u4e0b\u7684 XML \u6a94\u6848\u3002 \u5b83\u5f9e\u76ee\u524d\u8cc7\u6599\u5eab\u4e2d\u532f\u51fa\u8cc7\u6599\uff08\u800c\u4e0d\u662f\u5f9e\u958b\u767c\u8f38\u51fa\u6a94\u6848\u4e2d\u532f\u51fa\uff09\u3002","title":"\u532f\u51fa _data .XML \u6a94\u6848"},{"location":"development-tools/#_7","text":"Terminal $ php cmd.php xf-addon:bump-version [addon_id] --version-id 1020370 --version-string 1.2.3 Note \u5982\u679c\u4f60\u7684\u7248\u672c\u5b57\u4e32\u5305\u542b\u7a7a\u683c\uff0c\u4f60\u9700\u8981\u7528\u5f15\u865f\u5c07\u5176\u5305\u570d\u3002 \u8a72\u6307\u4ee4\u7372\u53d6\u60a8\u7684\u9644\u52a0\u5143\u4ef6\u7684\u9644\u52a0\u5143\u4ef6 ID\u3001\u65b0\u7248\u672c ID \u548c\u65b0\u7248\u672c\u5b57\u4e32\u3002 \u9019\u6a23\u60a8\u5c31\u53ef\u4ee5\u8f15\u9b06\u5b8c\u6210\u5347\u7d1a\u9644\u52a0\u5143\u4ef6\u7684\u7248\u672c\uff0c\u800c\u7121\u9700\u81ea\u5df1\u57f7\u884c\u5347\u7d1a\u548c\u91cd\u5efa\u3002 \u4e0a\u9762\u7684\u9078\u9805\u662f\u53ef\u9078\u7684\uff0c\u5982\u679c\u6c92\u6709\u63d0\u4f9b\u9019\u4e9b\u9078\u9805\uff0c\u7cfb\u7d71\u6703\u63d0\u793a\u60a8\u8f38\u5165\u3002 \u5982\u679c\u60a8\u53ea\u6307\u5b9a\u7248\u672c ID\uff0c\u5982\u679c\u5b83\u7b26\u5408\u6211\u5011 \u63a8\u85a6\u7684\u7248\u672cID\u683c\u5f0f \uff0c\u6211\u5011\u5c07\u5617\u8a66\u4e26\u81ea\u52d5\u5f9e\u4e2d\u63a8\u65b7\u51fa\u6b63\u78ba\u7684\u7248\u672c\u5b57\u4e32\u3002 \u4e00\u65e6\u6307\u4ee4\u5b8c\u6210\uff0c\u5b83\u5c07\u81ea\u52d5\u66f4\u65b0 addon.json \u6a94\u6848\u548c\u8cc7\u6599\u5eab\uff0c\u4e26\u63d0\u4f9b\u6b63\u78ba\u7684\u7248\u672c\u8a73\u7d30\u8cc7\u8a0a\u3002","title":"\u5347\u7d1a\u60a8\u7684\u9644\u52a0\u5143\u4ef6\u7248\u672c"},{"location":"development-tools/#addonjson","text":"Terminal $ php cmd.php xf-addon:sync-json [addon_id] \u6709\u6642\u4f60\u53ef\u80fd\u66f4\u559c\u6b61\u76f4\u63a5\u7de8\u8f2f JSON \u6a94\u6848\u4e2d\u7684\u67d0\u4e9b\u7d30\u7bc0\uff0c\u9019\u53ef\u80fd\u662f\u7248\u672c\uff0c\u6216\u65b0\u7684\u5716\u793a\uff0c\u6216\u66f4\u6539\u6a19\u984c\u6216\u63cf\u8ff0\u3002 \u4ee5\u9019\u7a2e\u65b9\u5f0f\u66f4\u6539 JSON \u53ef\u80fd\u6703\u5c0e\u81f4\u9644\u52a0\u5143\u4ef6\u7cfb\u7d71\u8a8d\u70ba\u6709\u5f85\u5b9a\u7684\u66f4\u6539\u6216\u9644\u52a0\u5143\u4ef6\u662f\u53ef\u5347\u7d1a\u7684\u3002 \u5982\u679c\u60a8\u5c1a\u672a\u532f\u51fa\u76ee\u524d\u8cc7\u6599\uff0c\u5247\u91cd\u5efa\u6216\u5347\u7d1a\u53ef\u80fd\u662f\u4e00\u7a2e\u7834\u58de\u6027\u7684\u64cd\u4f5c\u3002 \u56e0\u6b64\uff0c\u5efa\u8b70\u57f7\u884c\u6b64\u6307\u4ee4\u4f5c\u70ba\u532f\u5165\u8a72\u8cc7\u6599\u7684\u65b9\u5f0f\uff0c\u800c\u4e0d\u5f71\u97ff\u60a8\u7684\u73fe\u6709\u8cc7\u6599\u3002","title":"\u540c\u6b65\u4f60\u7684 addon.json \u5230\u8cc7\u6599\u5eab"},{"location":"development-tools/#addonjson_1","text":"Terminal $ php cmd.php xf-addon:validate-json [addon_id] \u5982\u679c\u4f60\u60f3\u6aa2\u67e5\u4f60\u7684 JSON \u6a94\u6848\u662f\u5426\u5305\u542b\u6b63\u78ba\u7684\u5167\u5bb9\u548c\u6b63\u78ba\u7684\u683c\u5f0f\uff0c\u4f60\u73fe\u5728\u53ef\u4ee5\u9a57\u8b49\u5b83\u3002 \u9a57\u8b49\u5668\u5c07\u6aa2\u67e5\u5167\u5bb9\u662f\u5426\u53ef\u4ee5\u89e3\u78bc\uff0c\u662f\u5426\u5305\u542b\u6240\u6709\u6b63\u78ba\u7684\u5fc5\u586b\u6b04\u4f4d\uff08\u5982\u6a19\u984c\u548c\u7248\u672c ID \uff09\uff0c\u9084\u6aa2\u67e5\u662f\u5426\u5b58\u5728\u53ef\u9078\u7684 Key\uff08\u5982\u63cf\u8ff0\u548c\u5716\u793a\uff09\u3002 \u5982\u679c\u6709\u4efb\u4f55 Key \u4e1f\u5931\uff0c\u6211\u5011\u5c07\u70ba\u60a8\u63d0\u4f9b\u4fee\u5fa9\u554f\u984c\u7684\u670d\u52d9\u3002 \u6211\u5011\u9084\u6aa2\u67e5 JSON \u6a94\u6848\u4e2d\u662f\u5426\u6709\u4efb\u4f55\u610f\u5916\u7684\u6b04\u4f4d\u3002 \u9019\u4e9b\u53ef\u80fd\u662f\u6545\u610f\u7684\uff0c\u4e5f\u53ef\u80fd\u662f\u932f\u5225\u5b57\u3002 \u60a8\u53ef\u4ee5\u624b\u52d5\u57f7\u884c\u8a72\u547d\u4ee4\uff0c\u6216\u8005\u5728\u69cb\u5efa\u767c\u884c\u7248\u6642\u81ea\u52d5\u57f7\u884c\u8a72\u6307\u4ee4\u3002","title":"\u9a57\u8b49\u60a8\u7684 addon.json \u6a94\u6848"},{"location":"development-tools/#_8","text":"\u6709\u6642\uff0c\u7121\u9700\u9032\u884c\u89e3\u9664\u5b89\u88dd\u548c\u91cd\u65b0\u5b89\u88dd\u904e\u7a0b\u5373\u53ef\u6aa2\u67e5 Setup class \u6b65\u9a5f\u662f\u5426\u6b63\u5e38\u904b\u884c\uff0c\u9019\u662f\u5f88\u6709\u5e6b\u52a9\u7684\u3002 \u6709\u4e09\u689d\u6307\u4ee4\u53ef\u4ee5\u5e6b\u52a9\u89e3\u6c7a\u9019\u500b\u554f\u984c\uff0c\u9019\u4e9b\u547d\u4ee4\u53ea\u9069\u7528\u65bc\u4f7f\u7528\u9810\u8a2d\u7684 StepRunner \u7279\u6027\u5efa\u7acb\u7684 Setup class\u3002","title":"\u57f7\u884c\u7279\u5b9a\u7684\u8a2d\u5b9a\u6b65\u9a5f"},{"location":"development-tools/#_9","text":"Terminal $ php cmd.php xf-addon:install-step [addon_id] [step]","title":"\u57f7\u884c\u5b89\u88dd\u6b65\u9a5f"},{"location":"development-tools/#_10","text":"Terminal $ php cmd.php xf-addon:upgrade-step [addon_id] [version] [step]","title":"\u57f7\u884c\u5347\u7d1a\u6b65\u9a5f"},{"location":"development-tools/#_11","text":"Terminal $ php cmd.php xf-addon:uninstall-step [addon_id] [step]","title":"\u57f7\u884c\u89e3\u9664\u5b89\u88dd\u6b65\u9a5f"},{"location":"development-tools/#_12","text":"\u4e00\u65e6\u6240\u6709\u7684\u8271\u82e6\u5de5\u4f5c\u90fd\u5b8c\u6210\u4e86\uff0c\u5f88\u907a\u61be\uff0c\u5728\u771f\u6b63\u767c\u4f48\u4e4b\u524d\u9084\u8981\u7d93\u6b77\u4e00\u4e9b\u5176\u4ed6\u7684\u904e\u7a0b\u3002 \u5373\u4f7f\u662f\u5c07\u6240\u6709\u7684\u6a94\u6848\u6536\u96c6\u5230\u6b63\u78ba\u7684\u5730\u65b9\uff0c\u4e26\u624b\u52d5\u5efa\u7acb ZIP \u6a94\u6848\u7684\u904e\u7a0b\u4e5f\u662f\u5f88\u8017\u6642\u7684\uff0c\u800c\u4e14\u5bb9\u6613\u51fa\u73fe\u932f\u8aa4\u3002 \u6211\u5011\u53ef\u4ee5\u81ea\u52d5\u8655\u7406\u9019\u4e9b\u554f\u984c\uff0c\u5305\u62ec\u7528\u4e00\u500b\u7c21\u55ae\u7684\u6307\u4ee4\u7522\u751f hash.json \u6a94\u6848\u3002 Terminal $ php cmd.php xf-addon:build-release [addon_id] \u7576\u4f60\u57f7\u884c\u9019\u500b\u547d\u4ee4\u6642\uff0c\u5b83\u6703\u5148\u57f7\u884c xf-addon:export \u6307\u4ee4\uff0c\u7136\u5f8c\u5c07\u6240\u6709\u7684\u6a94\u6848\u4e00\u8d77\u6536\u96c6\u5230\u4e00\u500b\u81e8\u6642\u7684 _build \u76ee\u9304\u4e2d\uff0c\u4e26\u5c07\u5b83\u5011\u5beb\u5165\u4e00\u500b ZIP \u6a94\u6848\u3002 \u5b8c\u6210\u5f8c\u7684 ZIP \u6a94\u6848\u9084\u5c07\u5305\u542b hashes.json \u6a94\u6848\u3002 \u4e00\u65e6 ZIP \u6a94\u6848\u88ab\u5efa\u7acb\uff0c\u5b83\u5c07\u88ab\u5132\u5b58\u5230\u4f60\u7684 _releases \u76ee\u9304\u4e2d\uff0c\u4e26\u547d\u540d\u70ba <ADDON ID>-<VERSION STRING>.zip \u3002","title":"\u69cb\u5efa\u9644\u52a0\u5143\u4ef6\u767c\u884c\u7248"},{"location":"development-tools/#_13","text":"\u9664\u4e86\u5efa\u7acb\u767c\u4f48\u7684 ZIP \u4e4b\u5916\uff0c\u60a8\u53ef\u80fd\u9084\u5e0c\u671b\u5728 ZIP \u4e2d\u5305\u542b\u5176\u4ed6\u7684\u6a94\u6848\uff0c\u60a8\u5e0c\u671b\u57f7\u884c\u5176\u4ed6\u66f4\u9ad8\u7d1a\u7684\u69cb\u5efa\u904e\u7a0b\uff0c\u5982\u6700\u5c0f\u5316\u6216\u9023\u7dda JS \u6216\u57f7\u884c\u67d0\u4e9b shell \u6307\u4ee4\u3002 \u6240\u6709\u9019\u4e9b\u90fd\u53ef\u4ee5\u5728\u4f60\u7684 build.json \u6a94\u6848\u4e2d\u8655\u7406\u3002 \u9019\u662f\u4e00\u500b\u5178\u578b\u7684 build.json \u6a94\u6848\u3002 { \"additional_files\": [ \"js/demo/portal\" ], \"minify\": [ \"js/demo/portal/a.js\", \"js/demo/portal/b.js\" ], \"rollup\": { \"js/demo/portal/ab-rollup.js\": [ \"js/demo/portal/a.min.js\", \"js/demo/portal/b.min.js\" ] }, \"exec\": [ \"echo '{title} version {version_string} ({version_id}) has been built successfully!' > 'src/addons/Demo/Portal/_build/built.txt'\" ] } \u5982\u679c\u4f60\u6709\u4e00\u4e9b\u9700\u8981\u5728 add-on \u76ee\u9304\u4e4b\u5916\u63d0\u4f9b\u670d\u52d9\u7684 assets\uff0c\u6bd4\u5982 JavaScript\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528 build.json \u4e2d\u7684 additional_files \u9663\u5217\u544a\u8a34\u69cb\u5efa\u904e\u7a0b\u8907\u88fd\u6a94\u6848\u6216\u76ee\u9304\u3002 \u5728\u958b\u767c\u904e\u7a0b\u4e2d\uff0c\u5c07\u6a94\u6848\u5132\u5b58\u5728 add-on \u76ee\u9304\u4e4b\u5916\u4e26\u4e0d\u7e3d\u662f\u53ef\u884c\u7684\uff0c\u6240\u4ee5\u5982\u679c\u4f60\u9858\u610f\uff0c\u4f60\u53ef\u4ee5\u5c07\u6a94\u6848\u5132\u5b58\u5728 add-on \u7684 _files \u76ee\u9304\u4e2d\u3002 \u5728\u8907\u88fd\u9644\u52a0\u6a94\u6848\u6642\uff0c\u6211\u5011\u5c07\u9996\u5148\u6aa2\u67e5\u8a72\u6a94\u6848\u3002 \u5982\u679c\u60a8\u7684\u9644\u52a0\u5143\u4ef6\u9644\u5e36\u4e86\u4e00\u4e9b JS \u6a94\u6848\uff0c\u51fa\u65bc\u6548\u80fd\u8003\u616e\uff0c\u60a8\u53ef\u80fd\u6703\u5e0c\u671b\u5c0d\u9019\u4e9b\u6a94\u6848\u9032\u884c\u6700\u5c0f\u5316\u3002 \u60a8\u53ef\u4ee5\u5728\u60a8\u7684 build.json \u4e2d\u6307\u5b9a\u60a8\u8981\u6700\u5c0f\u5316\u7684\u6a94\u6848\u3002 \u60a8\u53ef\u4ee5\u5c07\u9019\u4e9b\u6a94\u6848\u4ee5\u9663\u5217\u7684\u5f62\u5f0f\u5217\u51fa\uff0c\u4e5f\u53ef\u4ee5\u76f4\u63a5\u6307\u5b9a\u70ba '*' \uff0c\u9019\u6a23\u5c31\u6703\u5c0d js \u76ee\u9304\u4e2d\u7684\u6240\u6709\u6a94\u6848\u9032\u884c\u6700\u5c0f\u5316\uff0c\u53ea\u8981\u8a72\u8def\u5f91\u4e2d\u5b58\u5728 JS \u6a94\u6848\uff0c\u4e26\u5c07\u984d\u5916\u7684\u6a94\u6848\u8907\u88fd\u5230\u69cb\u5efa\u4e2d\u5373\u53ef\u3002 \u4efb\u4f55\u88ab\u6700\u5c0f\u5316\u7684\u6a94\u6848\u90fd\u6703\u81ea\u52d5\u4ee5 .min.js \u4f5c\u70ba\u5f8c\u7db4\uff0c\u800c\u4e0d\u662f .js \uff0c\u4e26\u4e14\u539f\u59cb\u6a94\u6848\u4ecd\u7136\u5728\u5305\u4e2d\u3002 \u4f60\u53ef\u80fd\u66f4\u559c\u6b61\u5c07\u591a\u500b JS \u6a94\u6848\u6346\u6210\u4e00\u500b\u6a94\u6848\u3002 \u5982\u679c\u4f60\u9019\u6a23\u505a\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528 rollup \u9663\u5217\u4f86\u5b9a\u7fa9\u3002 key \u662f\u5408\u4f75\u5f8c\u7684\u6a94\u540d\uff0c\u9663\u5217\u4e2d\u7684 item \u662f JS \u6a94\u6848\u7684\u8def\u5f91\uff0c\u9019\u4e9b\u6a94\u6848\u5c07\u88ab\u5408\u4f75\u6210\u4e00\u500b\u6a94\u6848\u3002 \u6700\u5f8c\uff0c\u60a8\u53ef\u80fd\u9700\u8981\u5728\u6253\u5305\u69cb\u5efa\u548c\u6700\u7d42\u5b9a\u6848\u4e4b\u524d\u57f7\u884c\u67d0\u4e9b\u7a0b\u5e8f\u3002 \u9019\u53ef\u80fd\u662f\u4efb\u4f55\u6771\u897f\u7684\u7d44\u5408\u3002 \u6b78\u6839\u7d50\u5e95\uff0c\u5982\u679c\u5b83\u662f\u4e00\u500b\u53ef\u4ee5\u5f9e shell \u4e2d\u57f7\u884c\u7684\u6307\u4ee4\uff08\u5305\u62ec PHP \u8173\u672c\uff09\uff0c\u90a3\u9ebc\u4f60\u53ef\u4ee5\u5728\u9019\u88e1\u6307\u5b9a\u5b83\u3002 \u7576\u7136\uff0c\u4e0a\u9762\u7684\u793a\u4f8b\u662f\u6beb\u7121\u7528\u8655\u7684\uff0c\u4f46\u5b83\u81f3\u5c11\u8b49\u660e\u4e86\u67d0\u4e9b\u4fdd\u7559\u5340\u662f\u53ef\u4ee5\u4f7f\u7528\u7684\u3002 \u9019\u4e9b\u4fdd\u7559\u5340\u88ab\u66ff\u63db\u70ba\u6a19\u91cf\u503c\uff0c\u4f60\u53ef\u4ee5\u5f9e XF\\AddOn\\AddOn \u7269\u4ef6\u4e2d\u7372\u5f97\uff0c\u4e00\u822c\u4f86\u8aaa\uff0c\u9019\u500b\u7269\u4ef6\u662f addon.json \u6a94\u6848\u4e2d\u7684\u4efb\u4f55\u53ef\u7528\u503c\uff0c\u6216\u8005 AddOn \u5be6\u9ad4\u3002","title":"\u81ea\u5b9a\u7fa9\u69cb\u5efa\u904e\u7a0b"},{"location":"development-tools/#_14","text":"\u5176\u5be6\u8207\u958b\u767c\u76f8\u95dc\u7684\u6307\u4ee4\u6709\u4e0d\u5c11\uff0c\u4f46\u9019\u88e1\u53ea\u4ecb\u7d39\u6700\u91cd\u8981\u7684\u5169\u500b\u3002 \u8981\u4f7f\u7528\u9019\u4e9b\u6307\u4ee4\uff0c\u4f60\u5fc5\u9808\u5728\u4f60\u7684 config.php \u6a94\u6848\u4e2d\u555f\u7528 \u958b\u767c\u6a21\u5f0f \u3002 Warning \u5982\u679c\u51fa\u73fe\u8cc7\u6599\u5eab\u548c _output \u76ee\u9304\u4e0d\u540c\u6b65\u7684\u60c5\u6cc1\uff0c\u4ee5\u4e0b\u5169\u500b\u6307\u4ee4\u90fd\u6709\u53ef\u80fd\u5c0e\u81f4\u8cc7\u6599\u4e1f\u5931\u3002\u5efa\u8b70\u4f7f\u7528 VCS (\u7248\u672c\u63a7\u5236\u7cfb\u7d71)\uff0c\u5982 GitHub \u4f86\u6e1b\u8f15\u9019\u7a2e\u932f\u8aa4\u7684\u5f71\u97ff\u3002","title":"\u958b\u767c\u6307\u4ee4"},{"location":"development-tools/#_15","text":"Terminal $ php cmd.php xf-dev:import --addon [addon_id] \u57f7\u884c\u6b64\u6307\u4ee4\u5c07\u628a\u4f60\u7684\u9644\u52a0\u5143\u4ef6 _output \u76ee\u9304\u4e0b\u7684\u6240\u6709\u958b\u767c\u6642\u8f38\u51fa\u7684\u6a94\u6848\u532f\u5165\u9032\u8cc7\u6599\u5eab\u88e1\u3002","title":"\u532f\u5165\u958b\u767c\u8f38\u51fa"},{"location":"development-tools/#_16","text":"Terminal $ php cmd.php xf-dev:export --addon [addon_id] \u9019\u5c07\u628a\u76ee\u524d\u8cc7\u6599\u5eab\u4e2d\u8207\u9644\u52a0\u5143\u4ef6\u76f8\u95dc\u806f\u7684\u6240\u6709\u8cc7\u6599\u532f\u51fa\u5230 _output \u76ee\u9304\u4e0b\u7684\u6a94\u6848\u4e2d\u3002","title":"\u532f\u51fa\u958b\u767c\u8f38\u51fa"},{"location":"development-tools/#_17","text":"\u61c9\u8a72\u53ef\u4ee5\u8a2d\u5b9a\u4f60\u559c\u6b61\u7684\u9664\u932f\u5de5\u5177\uff08 XDebug\uff0cZend Debugger \u7b49\uff09\u4f86\u8207 XF2 \u4e00\u8d77\u904b\u4f5c\u3002 \u96d6\u7136\uff0c\u6709\u6642\u5019\uff0c\u9664\u932f\u7a0b\u5f0f\u78bc\u53ef\u80fd\u50cf\u5feb\u901f\u67e5\u770b\u4e00\u500b\u8b8a\u6578\u5728\u7d66\u5b9a\u6642\u9593\u5167\u6301\u6709\u7684\u503c\uff08\u6216\u503c\u985e\u578b\uff09\u4e00\u6a23\u7c21\u964b\u3002","title":"\u9664\u932f\u7a0b\u5f0f\u78bc"},{"location":"development-tools/#dump","text":"\u7576\u7136 PHP \u6709\u4e00\u500b\u5167\u5efa\u7684\u5de5\u5177\u4f86\u8655\u7406\u9019\u500b\u554f\u984c\uff0c\u60a8\u53ef\u80fd\u5c07\u5176\u7a31\u70ba var_dump() \u3002 XF \u63d0\u4f9b\u4e86\u5169\u500b\u66ff\u4ee3\u65b9\u6cd5\u4f86\u8655\u7406\u9019\u500b\u554f\u984c\uff1a \\XF::dump($var); \\XF::dumpSimple($var); \u7c21\u55ae\u7248\u672c\u4e3b\u8981\u662f\u5c07\u4e00\u500b\u8b8a\u6578\u7684\u503c\u4ee5\u7d14\u6587\u5b57\u7684\u5f62\u5f0f\u8f49\u5132\u51fa\u4f86\u3002 \u4f8b\u5982\uff0c\u5982\u679c\u4f60\u53ea\u662f\u7528\u5b83\u4f86\u8f49\u5132\u4e00\u500b\u9663\u5217\u7684\u503c\uff0c\u4f60\u6703\u5728\u9801\u9762\u9802\u90e8\u770b\u5230\u9019\u6a23\u7684\u8f38\u51fa\uff1a array(2) { [\"user_id\"] => int(1) [\"username\"] => string(5) \"Admin\" } \u9019\u5be6\u969b\u4e0a\u662f\u8207\u6a19\u6e96\u7684 var_dump \u76f8\u540c\u7684\u8f38\u51fa\uff0c\u4f46\u70ba\u4e86\u53ef\u8b80\u6027\u7a0d\u4f5c\u4fee\u6539\uff0c\u4e26\u5c07\u5176\u5305\u88f9\u5728 <pre> \u6a19\u7c64\u4e2d\uff0c\u4ee5\u78ba\u4fdd\u5728\u6e32\u67d3\u6642\u4fdd\u7559\u7a7a\u767d\u3002 \u9019\u500b\u66ff\u4ee3\u65b9\u6848\u5be6\u969b\u4e0a\u662f Symfony \u9805\u76ee\u4e2d\u7684\u4e00\u500b\u540d\u70ba VarDumper \u7684\u5143\u4ef6\u3002 \u5b83\u8f38\u51fa HTML\u3001 CSS \u548c JS \u4f86\u5efa\u7acb\u4e00\u500b\u529f\u80fd\u66f4\u5f37\u3001\u66f4\u5bb9\u6613\u95b1\u8b80\u7684\u8f38\u51fa\u3002 \u5b83\u5141\u8a31\u4f60\u647a\u758a\u67d0\u4e9b\u90e8\u5206\uff0c\u5c0d\u65bc\u67d0\u4e9b\u53ef\u4ee5\u8f38\u51fa\u5927\u91cf\u8cc7\u6599\u7684\u503c\uff0c\u6bd4\u5982\u7269\u4ef6\uff0c\u5b83\u53ef\u4ee5\u81ea\u52d5\u647a\u758a\u9019\u4e9b\u90e8\u5206\u3002","title":"Dump \u8b8a\u6578"},{"location":"entities-finders-repositories/","text":"\u8cc7\u6599\u5be6\u9ad4\u3001\u67e5\u627e\u5668\u3001\u5132\u5b58\u5eab \u00b6 \u5728 XF2 \u4e2d\uff0c\u6709\u8a31\u591a\u8207\u8cc7\u6599\u4e92\u52d5\u7684\u65b9\u6cd5\u3002 \u5728 XF1 \u4e2d\uff0c\u9019\u4e3b\u8981\u662f\u91dd\u5c0d\u5728 Model \u6a94\u6848\u4e2d\u5beb\u51fa\u539f\u59cb SQL \u8a9e\u53e5\u3002 XF2 \u4e2d\u7684\u65b9\u6cd5\u5df2\u7d93\u812b\u96e2\u4e86\u9019\u4e00\u9ede\uff0c\u6211\u5011\u589e\u52a0\u4e86\u4e00\u4e9b\u65b0\u7684\u65b9\u6cd5\u3002 \u6211\u5011\u9996\u5148\u4f86\u770b\u4e00\u4e0b\u57f7\u884c\u8cc7\u6599\u5eab\u67e5\u8a62\u7684\u9996\u9078\u65b9\u6cd5 - Finder\u3002 Finder (\u67e5\u627e\u5668\u7cfb\u7d71) \u00b6 \u6211\u5011\u5f15\u5165\u4e86\u4e00\u500b\u65b0\u7684 \"Finder\" \u7cfb\u7d71\uff0c\u5b83\u5141\u8a31\u4ee5\u7269\u4ef6\u5c0e\u5411\u7684\u65b9\u5f0f\u4ee5\u7de8\u7a0b\u65b9\u5f0f\u5efa\u7acb\u67e5\u8a62\uff0c\u9019\u6a23\u5c31\u4e0d\u9700\u8981\u7de8\u5beb\u539f\u59cb\u8cc7\u6599\u5eab\u67e5\u8a62\u3002 Finder \u7cfb\u7d71\u8207 Entity \u7cfb\u7d71\u651c\u624b\u5408\u4f5c\uff0c\u6211\u5011\u5728\u4e0b\u9762\u8a73\u7d30\u4ecb\u7d39\u3002 \u50b3\u5165 finder \u65b9\u6cd5\u7684\u7b2c\u4e00\u500b\u53c3\u6578\u662f\u4f60\u8981\u8655\u7406\u7684 Entity \u7684\u77ed\u985e\u540d\u3002 \u6211\u5011\u5c31\u628a\u4e0a\u9762\u4e00\u7bc0\u4e2d\u63d0\u5230\u7684\u4e00\u4e9b\u67e5\u8a62\u8f49\u63db\u70ba\u4f7f\u7528 finder \u7cfb\u7d71\u4f86\u4ee3\u66ff\u3002 \u4f8b\u5982\uff0c\u8981\u8a2a\u554f\u55ae\u500b\u7528\u6236\u8a18\u9304\uff1a $finder = \\XF::finder('XF:User'); $user = $finder->where('user_id', 1)->fetchOne(); \u76f4\u63a5\u67e5\u8a62\u65b9\u6cd5\u8207\u4f7f\u7528 Finder \u4e4b\u9593\u7684\u4e3b\u8981\u5340\u5225\u4e4b\u4e00\u662f Finder \u8fd4\u56de\u7684\u8cc7\u6599\u57fa\u672c\u55ae\u4f4d\u4e0d\u662f\u4e00\u500b\u9663\u5217\u3002 \u5728 Finder \u7269\u4ef6\u547c\u53eb fetchOne \u65b9\u6cd5\u7684\u60c5\u6cc1\u4e0b\uff08\u8a72\u65b9\u6cd5\u53ea\u5f9e\u8cc7\u6599\u5eab\u4e2d\u8fd4\u56de\u55ae\u500b row \uff09\uff0c\u5c07\u8fd4\u56de\u55ae\u500b Entity \u7269\u4ef6\u3002 \u8b93\u6211\u5011\u770b\u770b\u4e00\u500b\u7a0d\u5fae\u4e0d\u540c\u7684\u65b9\u6cd5\uff0c\u5b83\u5c07\u8fd4\u56de\u591a\u500b row\uff1a $finder = \\XF::finder('XF:User'); $users = $finder->limit(10)->fetch(); \u9019\u500b\u4f8b\u5b50\u5c07\u5f9e xf_user \u8cc7\u6599\u8868\u4e2d\u67e5\u8a62 10 \u689d\u8a18\u9304\uff0c\u4e26\u4ee5 ArrayCollection \u7269\u4ef6\u7684\u5f62\u5f0f\u8fd4\u56de\u3002 \u9019\u662f\u4e00\u500b\u7279\u6b8a\u7684\u7269\u4ef6\uff0c\u5b83\u7684\u4f5c\u7528\u985e\u4f3c\u65bc\u4e00\u500b\u9663\u5217\uff0c\u56e0\u70ba\u5b83\u662f\u53ef\u4ee5\u904d\u6b77\u7684\uff08\u4f60\u53ef\u4ee5\u5728\u5b83\u88e1\u9762\u5faa\u74b0\uff09\uff0c\u800c\u4e14\u5b83\u6709\u4e00\u4e9b\u7279\u6b8a\u7684\u65b9\u6cd5\uff0c\u53ef\u4ee5\u544a\u8a34\u4f60\u5b83\u6240\u64c1\u6709\u7684\u689d\u76ee\u7e3d\u6578\uff0c\u901a\u904e\u67d0\u4e9b\u503c\u9032\u884c\u5206\u7d44\uff0c\u6216\u8005\u5176\u4ed6\u985e\u4f3c\u65bc\u9663\u5217\u7684\u64cd\u4f5c\uff0c\u5982\u904e\u6ffe\u3001\u5408\u4f75\u3001\u7372\u53d6\u7b2c\u4e00\u500b\u6216\u6700\u5f8c\u4e00\u500b\u689d\u76ee\u7b49\u3002 Finder \u67e5\u8a62\uff0c\u4e00\u822c\u61c9\u8a72\u662f\u671f\u671b\u5f9e\u8cc7\u6599\u8868\u4e2d\u6aa2\u7d22\u6240\u6709\u7684 Column\uff0c\u56e0\u6b64\uff0c\u6c92\u6709\u7279\u5b9a\u7684\u5c0d\u61c9\u95dc\u4fc2\u50c5\u7372\u53d6\u67d0\u4e9b Column \u4e2d\u7684\u67d0\u4e9b\u503c\u3002 \u76f8\u53cd\uff0c\u5982\u679c\u8981\u7372\u5f97\u55ae\u500b\u503c\uff0c\u4f60\u53ea\u9700\u8981\u7372\u53d6\u4e00\u500b Entity\uff0c\u7136\u5f8c\u76f4\u63a5\u5f9e\u9019\u500b Entity \u4e2d\u8b80\u53d6\u503c\uff1a $finder = \\XF::finder('XF:User'); $username = $finder->where('user_id', 1)->fetchOne()->username; \u540c\u6a23\u5730\uff0c\u5982\u679c\u8981\u5f9e Column \u4e2d\u7372\u53d6\u4e00\u500b\u9663\u5217\u7684\u503c\uff0c\u53ef\u4ee5\u4f7f\u7528 pluckFrom \u65b9\u6cd5\uff1a $finder = \\XF::finder('XF:User'); $usernames = $finder->limit(10)->pluckFrom('username')->fetch(); \u5230\u76ee\u524d\u70ba\u6b62\uff0c\u6211\u5011\u5df2\u7d93\u770b\u5230 Finder \u61c9\u7528\u4e86\u4e00\u4e9b\u7c21\u55ae\u7684 where \u548c limit \u7d04\u675f\u3002 \u6240\u4ee5\u6211\u5011\u4f86\u770b\u770b Finder \u7684\u66f4\u591a\u8a73\u7d30\u5167\u5bb9\uff0c\u5305\u62ec\u95dc\u65bc where \u65b9\u6cd5\u672c\u8eab\u7684\u66f4\u591a\u7d30\u7bc0\u3002 where \u65b9\u6cd5 \u00b6 where \u65b9\u6cd5\u6700\u591a\u53ef\u4ee5\u652f\u63f4\u4e09\u500b\u53c3\u6578\u3002 \u7b2c\u4e00\u500b\u53c3\u6578\u662f\u689d\u4ef6\u672c\u8eab\uff0c\u4f8b\u5982\u4f60\u8981\u641c\u5c0b\u7684 Column\u3002 \u7b2c\u4e8c\u500b\u53c3\u6578\u901a\u5e38\u662f\u904b\u7b97\u5b50\u3002 \u7b2c\u4e09\u500b\u662f\u88ab\u641c\u5c0b\u7684 value\u3002 \u5982\u679c\u4f60\u53ea\u63d0\u4f9b\u4e86\u5169\u500b\u53c3\u6578\uff0c\u5c31\u50cf\u4f60\u5728\u4e0a\u9762\u770b\u5230\u7684\u90a3\u6a23\uff0c\u90a3\u9ebc\u5b83\u81ea\u52d5\u610f\u5473\u8457\u904b\u7b97\u5b50\u662f = \u3002 \u4ee5\u4e0b\u662f\u5176\u4ed6\u6709\u6548\u7684\u904b\u7b97\u5b50\u5217\u8868\uff1a = <> != > >= < <= LIKE BETWEEN \u6240\u4ee5\uff0c\u5982\u679c\u6211\u5011\u60f3\u8981\u5f97\u5230\u6700\u8fd1 7 \u5929\u5167\u8a3b\u518a\u7684\u6709\u6548\u7528\u6236\u540d\u55ae\uff1a $finder = \\XF::finder('XF:User'); $users = $finder->where('user_state', 'valid')->where('register_date', '>=', time() - 86400 * 7)->fetch(); \u6b63\u5982\u4f60\u6240\u770b\u5230\u7684\uff0c\u4f60\u53ef\u4ee5\u96a8\u610f\u547c\u53eb where \u65b9\u6cd5\uff0c\u4f46\u9664\u6b64\u4e4b\u5916\uff0c\u4f60\u9084\u53ef\u4ee5\u9078\u64c7\u50b3\u5165\u4e00\u500b\u9663\u5217\u505a\u70ba\u8a72\u65b9\u6cd5\u7684\u552f\u4e00\u53c3\u6578\uff0c\u4e26\u5728\u4e00\u6b21\u547c\u53eb\u4e2d\u5efa\u7acb\u4f60\u7684\u689d\u4ef6\u3002 \u9663\u5217\u65b9\u6cd5\u652f\u63f4\u5169\u7a2e\u985e\u578b\uff0c\u6211\u5011\u53ef\u4ee5\u5728\u4e0a\u9762\u5efa\u7acb\u7684\u67e5\u8a62\u4e2d\u4f7f\u7528\u9019\u5169\u7a2e\u985e\u578b\uff1a $finder = \\XF::finder('XF:User'); $users = $finder->where([ 'user_state' => 'valid', ['register_date', '>=', time() - 86400 * 7] ]) ->fetch(); \u901a\u5e38\u4e0d\u5efa\u8b70\u6216\u660e\u78ba\u5730\u9019\u6a23\u6df7\u5408\u4f7f\u7528\uff0c\u4f46\u5b83\u78ba\u5be6\u5728\u4e00\u5b9a\u7a0b\u5ea6\u4e0a\u5c55\u793a\u4e86\u8a72\u65b9\u6cd5\u7684\u9748\u6d3b\u6027\u3002 \u73fe\u5728\u689d\u4ef6\u5df2\u7d93\u5728\u4e00\u500b\u9663\u5217\u4e2d\uff0c\u6211\u5011\u53ef\u4ee5\u6307\u5b9a Column \u540d\uff08\u4f5c\u70ba\u9663\u5217\u7684 key\uff09\u548c\u96b1\u5f0f\u7684 = \u904b\u7b97\u5b50\u7684 value\uff0c\u6216\u8005\u6211\u5011\u53ef\u4ee5\u5be6\u969b\u5b9a\u7fa9\u53e6\u4e00\u500b\u5305\u542b column\u3001\u904b\u7b97\u5b50\u548c value \u7684\u9663\u5217\u3002 whereOr \u65b9\u6cd5 \u00b6 \u5728\u4e0a\u9762\u7684\u4f8b\u5b50\u4e2d\uff0c\u5169\u500b\u689d\u4ef6\u90fd\u9700\u8981\u6eff\u8db3\uff0c\u5373\u6bcf\u500b\u689d\u4ef6\u90fd\u7531 AND \u904b\u7b97\u5b50\u9023\u63a5\u3002 \u7136\u800c\uff0c\u6709\u6642\u9700\u8981\u53ea\u6eff\u8db3\u90e8\u5206\u689d\u4ef6\uff0c\u9019\u53ef\u4ee5\u901a\u904e\u4f7f\u7528 whereOr \u65b9\u6cd5\u4f86\u5be6\u73fe\u3002 \u4f8b\u5982\uff0c\u5982\u679c\u4f60\u60f3\u641c\u5c0b\u90a3\u4e9b\u7121\u6548\u7684\u7528\u6236\u6216\u8005\u662f\u767c\u4f48\u4e86\u96f6\u5247\u7559\u8a00\u7684\u7528\u6236\uff0c\u4f60\u53ef\u4ee5\u5efa\u7acb\u5982\u4e0b\uff1a $finder = \\XF::finder('XF:User'); $users = $finder->whereOr( ['user_state', '<>', 'valid'], ['message_count', 0] )->fetch(); \u8207\u4e0a\u4e00\u7bc0\u7684\u4f8b\u5b50\u985e\u4f3c\uff0c\u9664\u4e86\u50b3\u905e\u6700\u591a\u5169\u500b\u689d\u4ef6\u4f5c\u70ba\u55ae\u7368\u7684\u53c3\u6578\u5916\uff0c\u4f60\u4e5f\u53ef\u4ee5\u53ea\u50b3\u905e\u4e00\u500b\u689d\u4ef6\u9663\u5217\u5230\u7b2c\u4e00\u500b\u53c3\u6578\uff1a $finder = \\XF::finder('XF:User'); $users = $finder->whereOr([ ['user_state', '<>', 'valid'], ['message_count', 0], ['is_banned', 1] ])->fetch(); with \u65b9\u6cd5 \u00b6 with \u65b9\u6cd5\u672c\u8cea\u4e0a\u7b49\u540c\u65bc\u4f7f\u7528 INNER|LEFT JOIN \u8a9e\u53e5\uff0c\u5118\u7ba1\u5b83\u4f9d\u8cf4\u65bc Entity \u5df2\u7d93\u5b9a\u7fa9\u4e86\u5b83\u7684 \"Relation\"\u3002 \u6211\u5011\u5728\u4e0b\u4e00\u9801\u624d\u6703\u8a0e\u8ad6\u9019\u500b\u554f\u984c\uff0c\u4f46\u9019\u61c9\u8a72\u53ea\u662f\u8b93\u4f60\u4e86\u89e3\u5b83\u662f\u5982\u4f55\u904b\u4f5c\u7684\u3002 \u73fe\u5728\u8b93\u6211\u5011\u4f7f\u7528\u4e3b\u984c finder \u4f86\u6aa2\u7d22\u4e00\u500b\u7279\u5b9a\u7684\u4e3b\u984c\uff1a $finder = \\XF::finder('XF:Thread'); $thread = $finder->with('Forum', true)->where('thread_id', 123)->fetchOne(); \u9019\u500b\u67e5\u8a62\u5c07\u7372\u53d6 thread_id = 123 \u7684\u4e3b\u984c\u5be6\u9ad4\uff0c\u4f46\u5b83\u4e5f\u6703\u5728\u80cc\u666f\u8207 xf_forum \u8cc7\u6599\u8868\u9032\u884c join\u3002 \u5728\u63a7\u5236\u5982\u4f55\u505a INNER JOIN \u800c\u4e0d\u662f LEFT JOIN \u65b9\u9762\uff0c\u9019\u5c31\u662f\u7b2c\u4e8c\u500b\u53c3\u6578\u7684\u4f5c\u7528\u3002 \u5728\u672c\u4f8b\u4e2d\uff0c\u6211\u5011\u5c07 \"must exist\" \u53c3\u6578\u8a2d\u5b9a\u70ba true\uff0c\u6240\u4ee5\u5b83\u6703\u628a\u9023\u63a5\u8a9e\u53e5\u8f49\u63db\u70ba\u4f7f\u7528 INNER \u800c\u4e0d\u662f\u9810\u8a2d\u7684 LEFT \u3002 \u6211\u5011\u5c07\u5728\u4e0b\u4e00\u7bc0\u8a73\u7d30\u4ecb\u7d39\u5982\u4f55\u8a2a\u554f\u5f9e\u9019\u500b join \u7372\u53d6\u7684\u8cc7\u6599\u3002 \u4e5f\u53ef\u4ee5\u5728 with \u65b9\u6cd5\u4e2d\u50b3\u905e\u4e00\u500b Relation \u9663\u5217\u4f86\u9032\u884c\u591a\u91cd join\u3002 $finder = \\XF::finder('XF:Thread'); $thread = $finder->with(['Forum', 'User'], true)->where('thread_id', 123)->fetchOne(); \u9019\u5c07\u6703 join \u5230 xf_user \u8cc7\u6599\u8868\u4ee5\u7372\u5f97\u4e3b\u984c\u4f5c\u8005\u3002 \u7136\u800c\uff0c\u7531\u65bc\u7b2c\u4e8c\u500b\u53c3\u6578\u4ecd\u7136\u662f true \uff0c\u6211\u5011\u53ef\u80fd\u4e0d\u9700\u8981\u70ba User join \u505a\u4e00\u500b INNER join\uff0c\u6240\u4ee5\uff0c\u6211\u5011\u53ef\u4ee5\u7528 chain \u65b9\u6cd5\u4ee3\u66ff\uff1a $finder = \\XF::finder('XF:Thread'); $thread = $finder->with('Forum', true)->with('User')->where('thread_id', 123)->fetchOne(); order, limit \u548c limitByPage \u65b9\u6cd5 \u00b6 order \u65b9\u6cd5 \u00b6 \u9019\u500b\u65b9\u6cd5\u5141\u8a31\u4f60\u6309\u7167\u7279\u5b9a\u7684\u9806\u5e8f\u4f86\u4fee\u6539\u4f60\u7684\u67e5\u8a62\u7372\u53d6\u7d50\u679c\u3002 \u5b83\u9700\u8981\u5169\u500b\u53c3\u6578\uff0c\u7b2c\u4e00\u500b\u662f column \u540d\uff0c\u7b2c\u4e8c\u500b\u662f\u53ef\u9078\u7684\u6392\u5e8f\u65b9\u5411\u3002 \u6240\u4ee5\uff0c\u5982\u679c\u4f60\u60f3\u5217\u51fa\u64c1\u6709\u6700\u591a\u7559\u8a00\u7684 10 \u500b\u7528\u6236\uff0c\u4f60\u53ef\u4ee5\u5efa\u7acb\u50cf\u9019\u6a23\u7684\u67e5\u8a62\uff1a $finder = \\XF::finder('XF:User'); $users = $finder->order('message_count', 'DESC')->limit(10); Note \u73fe\u5728\u53ef\u80fd\u662f\u4e00\u500b\u5f88\u597d\u7684\u6642\u6a5f\u4f86\u63d0\u53ca\uff0cfinder \u65b9\u6cd5\u5927\u591a\u53ef\u4ee5\u6309\u7167\u4efb\u4f55\u9806\u5e8f\u547c\u53eb\u3002 \u4f8b\u5982\uff1a $threads = $finder->limit(10)->where('thread_id', '>', 123)->order('post_date')->with('User')->fetch(); \u96d6\u7136\u5982\u679c\u4f60\u6309\u7167\u9019\u500b\u9806\u5e8f\u5beb\u4e00\u500b MySQL \u67e5\u8a62\uff0c\u80af\u5b9a\u6703\u9047\u5230\u4e00\u4e9b\u8a9e\u6cd5\u554f\u984c\uff0c\u4f46 Finder \u7cfb\u7d71\u9084\u662f\u6703\u6309\u7167\u6b63\u78ba\u7684\u9806\u5e8f\u4f86\u69cb\u5efa\uff0c\u4e0a\u9762\u7684\u7a0b\u5f0f\u78bc\u96d6\u7136\u770b\u8d77\u4f86\u5f88\u5947\u602a\uff0c\u53ef\u80fd\u4e5f\u4e0d\u5efa\u8b70\u4f7f\u7528\uff0c\u4f46\u90a3\u6a23\u5beb\u78ba\u5be6\u662f\u5b8c\u5168\u6b63\u78ba\u7684\u3002 \u8207\u6a19\u6e96\u7684 MySQL \u67e5\u8a62\u4e00\u6a23\uff0c\u53ef\u4ee5\u5c0d\u591a\u500b Column \u7684\u7d50\u679c\u96c6\u9032\u884c\u6392\u5e8f\u3002 \u8981\u505a\u5230\u9019\u4e00\u9ede\uff0c\u4f60\u53ef\u4ee5\u518d\u6b21\u547c\u53eb order \u65b9\u6cd5\u3002 \u4e5f\u53ef\u4ee5\u4f7f\u7528\u9663\u5217\u5c07\u591a\u500b order \u5b50\u53e5\u50b3\u905e\u5230 order \u65b9\u6cd5\u4e2d\u3002 $finder = \\XF::finder('XF:User'); $users = $finder->order('message_count', 'DESC')->order('register_date')->limit(10); limit \u65b9\u6cd5 \u00b6 \u6211\u5011\u5df2\u7d93\u770b\u5230\u4e86\u5982\u4f55\u5c07\u67e5\u8a62 limit \u5728\u7279\u5b9a\u6578\u91cf\u7684\u8a18\u9304\u4e0a\uff1a $finder = \\XF::finder('XF:User'); $users = $finder->limit(10)->fetch(); \u4e0d\u904e\uff0c\u5176\u5be6\u9084\u6709\u4e00\u500b\u8fa6\u6cd5\u53ef\u4ee5\u76f4\u63a5\u547c\u53eb limit \u65b9\u6cd5\uff1a $finder = \\XF::finder('XF:User'); $users = $finder->fetch(10); \u53ef\u4ee5\u76f4\u63a5\u5c07\u4f60\u7684 limit \u50b3\u5165 fetch() \u65b9\u6cd5\u3002 \u53e6\u5916\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0c limit \uff08\u548c fetch \uff09\u65b9\u6cd5\u652f\u63f4\u5169\u500b\u53c3\u6578\u3002 \u7b2c\u4e00\u500b\u986f\u7136\u662f limit\uff0c\u7b2c\u4e8c\u500b\u662f offset\u3002 $finder = \\XF::finder('XF:User'); $users = $finder->limit(10, 100)->fetch(); \u9019\u88e1\u7684 offset \u57fa\u672c\u4e0a\u610f\u5473\u8457\u524d 100 \u500b\u7d50\u679c\u5c07\u88ab\u68c4\u7528\uff0c\u4e4b\u5f8c\u7684\u524d 10 \u500b\u7d50\u679c\u5c07\u88ab\u8fd4\u56de\u3002 \u9019\u7a2e\u65b9\u6cd5\u5c0d\u65bc\u63d0\u4f9b\u5206\u9801\u7d50\u679c\u662f\u5f88\u6709\u7528\u7684\uff0c\u4e0d\u904e\u6211\u5011\u5176\u5be6\u4e5f\u6709\u4e00\u500b\u66f4\u7c21\u55ae\u7684\u65b9\u6cd5... limitByPage \u65b9\u6cd5 \u00b6 \u9019\u500b\u65b9\u6cd5\u662f\u4e00\u7a2e\u8f14\u52a9\u65b9\u6cd5\uff0c\u6700\u7d42\u6703\u6839\u64da\u4f60\u76ee\u524d\u6aa2\u8996\u7684 \"\u9801\u9762\" \u548c\u4f60\u6240\u9700\u8981\u7684 \"\u6bcf\u9801\" \u6578\u91cf\u4f86\u8a2d\u5b9a\u76f8\u61c9\u7684 limit \u548c offset\u3002 $finder = \\XF::finder('XF:User'); $users = $finder->limitByPage(3, 20); \u5728\u9019\u7a2e\u60c5\u6cc1\u4e0b\uff0climit \u5c07\u88ab\u8a2d\u5b9a\u70ba 20\uff08\u9019\u662f\u6211\u5011\u6bcf\u9801\u7684\u503c\uff09\uff0coffset \u5c07\u88ab\u8a2d\u5b9a\u70ba 40\uff0c\u56e0\u70ba\u6211\u5011\u5f9e\u7b2c 3 \u9801\u958b\u59cb\u3002 \u5076\u723e\uff0c\u6211\u5011\u9700\u8981\u6293\u53d6\u8d85\u904e limit \u7684\u984d\u5916\u8cc7\u6599\u3002 Over-fetching \u53ef\u4ee5\u5e6b\u52a9\u5075\u6e2c\u4f60\u5728\u76ee\u524d\u9801\u9762\u4e4b\u5f8c\u662f\u5426\u6709\u984d\u5916\u7684\u8cc7\u6599\u8981\u986f\u793a\uff0c\u6216\u8005\u4f60\u662f\u5426\u9700\u8981\u6839\u64da\u6b0a\u9650\u904e\u6ffe\u8a2d\u5b9a\u4e0b\u4f86\u7684\u521d\u59cb\u7d50\u679c\u3002 \u6211\u5011\u53ef\u4ee5\u901a\u904e\u7b2c\u4e09\u500b\u53c3\u6578\u4f86\u5be6\u73fe\uff1a $finder = \\XF::finder('XF:User'); $users = $finder->limitByPage(3, 20, 1); \u9019\u6a23\u4e00\u4f86\uff0c\u5f9e\u7b2c 3 \u9801\u958b\u59cb\uff0c\u7e3d\u5171\u6700\u591a\u53ef\u7372\u5f97 21\u500b \u7528\u6236\uff0820+1\uff09\u3002 getQuery \u65b9\u6cd5 \u00b6 \u7576\u4f60\u7b2c\u4e00\u6b21\u958b\u59cb\u4f7f\u7528 finder \u6642\uff0c\u5118\u7ba1\u5b83\u5f88\u76f4\u89c0\uff0c\u4f46\u4f60\u53ef\u80fd\u5076\u723e\u6703\u60f3\u77e5\u9053\u4f60\u662f\u5426\u6b63\u78ba\u5730\u4f7f\u7528\u4e86\u5b83\uff0c\u4ee5\u53ca\u5b83\u662f\u5426\u6703\u5efa\u7acb\u4f60\u671f\u671b\u7684\u67e5\u8a62\u3002 \u6211\u5011\u6709\u4e00\u500b\u540d\u70ba getQuery \u7684\u65b9\u6cd5\uff0c\u5b83\u53ef\u4ee5\u544a\u8a34\u6211\u5011\u76ee\u524d\u7684 finder \u7269\u4ef6\u5c07\u5efa\u7acb\u7684\u67e5\u8a62\u3002 \u4f8b\u5982\uff1a $finder = \\XF::finder('XF:User') ->where('user_id', 1); \\XF::dumpSimple($finder->getQuery()); \u9019\u5c07\u8f38\u51fa\u985e\u4f3c\u65bc\u4ee5\u4e0b\u7684\u8a9e\u53e5\uff1a string(67) \"SELECT `xf_user`.* FROM `xf_user` WHERE (`xf_user`.`user_id` = 1)\" \u4f60\u53ef\u80fd\u4e0d\u6703\u7d93\u5e38\u9700\u8981\u5b83\uff0c\u4f46\u5982\u679c finder \u6c92\u6709\u8fd4\u56de\u4f60\u6240\u671f\u671b\u7684\u7d50\u679c\uff0c\u90a3\u5b83\u53ef\u80fd\u6703\u5f88\u6709\u5e6b\u52a9\u3002 \u5728 Dump \u8b8a\u6578 \u90e8\u5206\u95b1\u8b80\u66f4\u591a\u95dc\u65bc dumpSimple \u65b9\u6cd5\u7684\u5167\u5bb9\u3002 \u81ea\u5b9a\u7fa9 finder \u65b9\u6cd5 \u00b6 \u5230\u76ee\u524d\u70ba\u6b62\uff0c\u6211\u5011\u5df2\u7d93\u770b\u5230 finder \u7269\u4ef6\u88ab\u8a2d\u5b9a\u4e86\u4e00\u500b\u985e\u4f3c\u65bc XF:User \u548c XF:Thread \u7684\u53c3\u6578\u3002 \u5728\u5927\u591a\u6578\u60c5\u6cc1\u4e0b\uff0c\u9019\u6a19\u8b58\u4e86 finder \u6b63\u5728\u8655\u7406\u7684 Entity \u985e\uff0c\u4e26\u5c07\u89e3\u6790\u70ba\uff0c\u4f8b\u5982\uff0c XF/Entity/User \u3002 \u7136\u800c\uff0c\u5b83\u4e5f\u53ef\u4ee5\u53e6\u5916\u4ee3\u8868\u4e00\u500b finder \u985e\u3002 finder \u985e\u662f\u53ef\u9078\u7684\uff0c\u4f46\u5b83\u5011\u53ef\u4ee5\u4f5c\u70ba\u4e00\u7a2e\u65b9\u6cd5\u4f86\u70ba\u7279\u5b9a\u7684 finder \u985e\u578b\u65b0\u589e\u81ea\u5b9a\u7fa9 finder \u65b9\u6cd5\u3002 \u70ba\u4e86\u770b\u5230\u9019\u4e00\u9ede\uff0c\u8b93\u6211\u5011\u770b\u770b\u8207 XF:User \u76f8\u95dc\u7684 finder \u985e\uff0c\u5b83\u53ef\u4ee5\u5728 XF\\FinderUser \u985e\u4e2d\u627e\u5230\u3002 \u4e0b\u9762\u793a\u4f8b\u662f\u8a72 class \u4e2d\u7684\u4e00\u500b finder \u65b9\u6cd5\uff1a public function isRecentlyActive($days = 180) { $this->where('last_activity', '>', time() - ($days * 86400)); return $this; } \u73fe\u5728\uff0c\u6211\u5011\u53ef\u4ee5\u5728\u4efb\u4f55 User finder \u7269\u4ef6\u4e0a\u547c\u53eb\u8a72\u65b9\u6cd5\u3002 \u6240\u4ee5\uff0c\u5982\u679c\u6211\u5011\u62ff\u524d\u9762\u7684\u4e00\u500b\u4f8b\u5b50\u4f86\u8aaa\uff1a $finder = \\XF::finder('XF:User'); $users = $finder->isRecentlyActive(20)->order('message_count', 'DESC')->limit(10); \u9019\u500b\u67e5\u8a62\uff0c\u4e4b\u524d\u53ea\u662f\u6309\u7167\u7559\u8a00\u6578\u964d\u5e8f\u8fd4\u56de 10 \u500b\u7528\u6236\uff0c\u73fe\u5728\u5c07\u6309\u9019\u500b\u9806\u5e8f\u8fd4\u56de\u6700\u8fd1 20 \u5929\u5167\u6d3b\u8e8d\u7684 10 \u500b\u7528\u6236\u3002 \u5118\u7ba1\u5c0d\u65bc\u5f88\u591a Entity \u985e\u578b\u4f86\u8aaa\uff0cfinder \u985e\u662f\u4e0d\u5b58\u5728\u7684\uff0c\u4f46\u4ecd\u7136\u53ef\u4ee5\u901a\u904e \u7e7c\u627f\u985e \u4e00\u7bc0\u4e2d\u63d0\u5230\u7684\u76f8\u540c\u65b9\u5f0f\u4f86\u7e7c\u627f\u9019\u4e9b\u4e0d\u5b58\u5728\u7684\u985e\u3002 The Entity system (\u5be6\u9ad4\u7cfb\u7d71) \u00b6 \u5982\u679c\u60a8\u719f\u6089 XF1\uff0c\u60a8\u53ef\u80fd\u6703\u719f\u6089 Entity \u80cc\u5f8c\u7684\u4e00\u4e9b\u6982\u5ff5\uff0c\u56e0\u70ba\u5b83\u5011\u6700\u7d42\u662f\u5f9e\u90a3\u88e1\u7684 DataWriter \u7cfb\u7d71\u884d\u751f\u51fa\u4f86\u7684\u3002 \u5982\u679c\u60a8\u5c0d\u5b83\u5011\u4e0d\u662f\u5f88\u719f\u6089\uff0c\u4e0b\u9762\u7684\u90e8\u5206\u61c9\u8a72\u6703\u8b93\u60a8\u6709\u6240\u4e86\u89e3\u3002 Entity structure (\u5be6\u9ad4\u7d50\u69cb) \u00b6 Structure \u7269\u4ef6\u7531\u4e00\u4e9b\u5c6c\u6027\u7d44\u6210\uff0c\u9019\u4e9b\u5c6c\u6027\u5b9a\u7fa9\u4e86 Entity \u7684 Structure \u548c\u5b83\u6240\u6d89\u53ca\u7684\u8cc7\u6599\u8868\u3002 Structure \u7269\u4ef6\u672c\u8eab\u5c31\u8a2d\u5b9a\u5728\u5b83\u6240\u6d89\u53ca\u7684 Entity \u5167\u90e8\u3002 \u6211\u5011\u4f86\u770b\u770b User Entity \u4e2d\u7684\u4e00\u4e9b\u5e38\u7528\u5c6c\u6027\uff1a Table (\u8cc7\u6599\u8868) \u00b6 $structure->table = 'xf_user'; \u5b83\u8aaa\u660e\u4e86 Entity \u5728 Update \u548c Insert \u8a18\u9304\u6642\u4f7f\u7528\u54ea\u5f35\u8cc7\u6599\u8868\uff0c\u4e5f\u544a\u8a34\u6211\u5011 Finder \u5728\u69cb\u5efa\u67e5\u8a62\u57f7\u884c\u6642\u5f9e\u54ea\u5f35\u8cc7\u6599\u8868\u8b80\u53d6\u3002 \u6b64\u5916\uff0c\u5b83\u9084\u77e5\u9053\u4f60\u7684\u67e5\u8a62\u9700\u8981 join \u5230\u54ea\u4e9b\u5176\u4ed6\u8cc7\u6599\u8868\u4e2d\u8d77\u5230\u4e86\u4f5c\u7528\u3002 Short name (\u7c21\u77ed\u540d) \u00b6 $structure->shortName = 'XF:User'; \u9019\u53ea\u662f Entity \u672c\u8eab\u548c Finder \u985e\uff08\u5982\u679c\u9069\u7528\uff09\u7684\u77ed\u985e\u540d\u3002 Content type (\u5167\u5bb9\u985e\u578b) \u00b6 $structure->contentType = 'user'; \u9019\u5b9a\u7fa9\u4e86\u9019\u500b Entity \u4ee3\u8868\u7684\u5167\u5bb9\u985e\u578b\u3002 \u5728\u5927\u591a\u6578 Entity \u7d50\u69cb\u4e2d\u4e0d\u6703\u9700\u8981\u9019\u500b\u3002 \u5b83\u7528\u65bc\u9023\u63a5\u5230 \"content type\" \u7cfb\u7d71\u4f7f\u7528\u7684\u7279\u5b9a\u4e8b\u7269\uff08\u9019\u5c07\u5728\u53e6\u4e00\u7bc0\u4e2d\u4ecb\u7d39\uff09\u3002 Primary key (\u4e3b\u9375) \u00b6 $structure->primaryKey = 'user_id'; \u5b9a\u7fa9\u4e86\u4ee3\u8868\u8cc7\u6599\u8868\u4e2d Primary key \u7684 Column\uff0c\u5982\u679c\u4e00\u500b\u8cc7\u6599\u8868\u652f\u63f4\u591a\u500b Column \u4f5c\u70ba Primary key\uff0c\u90a3\u9ebc\u53ef\u4ee5\u5b9a\u7fa9\u70ba\u9663\u5217\u3002 Columns (\u591a\u884c\u8cc7\u6599) \u00b6 $structure->columns = [ 'user_id' => ['type' => self::UINT, 'autoIncrement' => true, 'nullable' => true, 'changeLog' => false], 'username' => ['type' => self::STR, 'maxLength' => 50, 'required' => 'please_enter_valid_name' ] // \u9084\u6709\u66f4\u591a\u7684 columns... ]; \u9019\u662f Entity \u8a2d\u5b9a\u7684\u95dc\u9375\u90e8\u5206\uff0c\u56e0\u70ba\u9019\u88e1\u9762\u6703\u8a73\u7d30\u89e3\u91cb Entity \u8ca0\u8cac\u7684\u6bcf\u500b\u8cc7\u6599\u5eab column \u7684\u5177\u9ad4\u60c5\u6cc1\u3002 \u9019\u544a\u8a34\u6211\u5011\u9810\u671f\u7684\u8cc7\u6599\u985e\u578b\uff0c\u662f\u5426\u9700\u8981\u4e00\u500b\u503c\uff0c\u5b83\u61c9\u8a72\u5339\u914d\u4ec0\u9ebc\u683c\u5f0f\uff0c\u662f\u5426\u61c9\u8a72\u662f\u552f\u4e00\u503c\uff0c\u5b83\u7684\u9810\u8a2d\u503c\u662f\u4ec0\u9ebc\uff0c\u7b49\u7b49\u3002 \u6839\u64da type \uff0cEntity \u7ba1\u7406\u5668\u77e5\u9053\u662f\u5426\u4ee5\u67d0\u7a2e\u65b9\u5f0f\u5c0d\u4e00\u500b\u503c\u9032\u884c\u7de8\u78bc\u6216\u89e3\u78bc\u3002 \u9019\u53ef\u4ee5\u662f\u4e00\u500b\u7c21\u55ae\u7684\u904e\u7a0b\uff0c\u5c07\u4e00\u500b\u503c\u8f49\u63db\u70ba\u4e00\u500b\u5b57\u4e32\u6216\u6574\u6578\uff0c\u6216\u8005\u7a0d\u5fae\u8907\u96dc\u4e00\u9ede\uff0c\u4f8b\u5982\u5728\u5411\u8cc7\u6599\u5eab\u5beb\u5165\u6642\uff0c\u5c0d\u4e00\u500b\u9663\u5217\u4f7f\u7528 json_encode() \uff0c\u6216\u8005\u5728\u5f9e\u8cc7\u6599\u5eab\u8b80\u53d6\u6642\uff0c\u5c0d\u4e00\u500b JSON \u5b57\u4e32\u4f7f\u7528 json_decode() \uff0c\u4ee5\u4fbf\u5c07\u8a72\u503c\u4f5c\u70ba\u4e00\u500b\u9663\u5217\u6b63\u78ba\u5730\u8fd4\u56de\u7d66 Entity \u7269\u4ef6\uff0c\u800c\u4e0d\u9700\u8981\u6211\u5011\u624b\u52d5\u9019\u6a23\u505a\u3002 \u5b83\u9084\u53ef\u4ee5\u652f\u63f4\u5c0d\u9017\u865f\u5206\u9694\u7684\u503c\u9032\u884c\u9069\u7576\u7684\u7de8\u78bc/\u89e3\u78bc\u3002 \u5076\u723e\u9700\u8981\u5728\u5beb\u5165\u4e00\u500b\u503c\u4e4b\u524d\u5c0d\u5176\u9032\u884c\u4e00\u4e9b\u984d\u5916\u7684\u9a57\u8b49\u6216\u4fee\u6539\u3002 \u8209\u500b\u4f8b\u5b50\uff0c\u5728 User Entity \u4e2d\uff0c\u8acb\u770b verifyStyleId() \u65b9\u6cd5\u3002 \u7576\u5728 style_id \u6b04\u4f4d\u4e0a\u8a2d\u5b9a\u4e00\u500b\u503c\u6642\uff0c\u6211\u5011\u6703\u81ea\u52d5\u6aa2\u67e5\u662f\u5426\u5b58\u5728\u4e00\u500b\u540d\u70ba verifyStyleId() \u7684\u65b9\u6cd5\uff0c\u5982\u679c\u5b58\u5728\uff0c\u6211\u5011\u6703\u5148\u901a\u904e\u8a72\u65b9\u6cd5\u57f7\u884c\u8a72\u503c\u3002 Behaviors (\u884c\u70ba) \u00b6 $structure->behaviors = [ 'XF:ChangeLoggable' => [] ]; \u9019\u662f\u8a72 Entity \u61c9\u4f7f\u7528\u7684 Behaviors \u985e\u9663\u5217\u3002 Behaviors \u985e\u662f\u4e00\u7a2e\u5141\u8a31\u67d0\u4e9b\u7a0b\u5f0f\u78bc\u5728\u591a\u7a2e Entity \u985e\u578b\u4e2d\u901a\u7528\u91cd\u8907\u4f7f\u7528\u7684\u65b9\u5f0f\uff08\u50c5\u5728 Entity \u8b8a\u5316\u6642\uff0c\u800c\u4e0d\u662f\u5728\u8b80\u53d6\u6642\uff09\u3002 \u4e00\u500b\u5f88\u597d\u7684\u4f8b\u5b50\u662f XF:Likeable Behaviors\uff0c\u5b83\u80fd\u5920\u5c0d\u652f\u63f4\u53ef\u88ab \"\u9ede\u8b9a\" \u7684\u5167\u5bb9\u5be6\u9ad4\u81ea\u52d5\u57f7\u884c\u67d0\u4e9b\u64cd\u4f5c\u3002 \u9019\u5305\u62ec\u7576\u5167\u5bb9\u4e2d\u767c\u751f\u53ef\u898b\u6027\u8b8a\u5316\u6642\u81ea\u52d5\u91cd\u65b0\u8a08\u6578\uff0c\u4ee5\u53ca\u7576\u5167\u5bb9\u88ab\u522a\u9664\u6642\u81ea\u52d5\u522a\u9664\u9ede\u8b9a\u6578\u3002 Getters (\u7372\u53d6\u5668) \u00b6 $structure->getters = [ 'is_super_admin' => true, 'last_activity' => true ]; \u7576\u547c\u53eb name \u6b04\u4f4d\u6642\uff0c\u6703\u81ea\u52d5\u547c\u53eb Getter \u65b9\u6cd5\u3002 \u4f8b\u5982\uff0c\u5982\u679c\u6211\u5011\u5f9e User Entity \u4e2d\u8acb\u6c42 is_super_admin \uff0c\u5c31\u6703\u81ea\u52d5\u6aa2\u67e5\u4e26\u4f7f\u7528 getIsSuperAdmin() \u65b9\u6cd5\u3002 \u6709\u8da3\u7684\u662f\uff0cxf_user \u8cc7\u6599\u8868\u5be6\u969b\u4e0a\u4e26\u6c92\u6709\u4e00\u500b\u540d\u70ba is_super_admin \u7684\u6b04\u4f4d\u3002 \u9019\u500b\u6b04\u4f4d\u5be6\u969b\u4e0a\u5b58\u5728\u65bc Admin Entity \u4e2d\uff0c\u4f46\u6211\u5011\u5c07\u5176\u4f5c\u70ba\u4e00\u500b getter \u65b9\u6cd5\u65b0\u589e\u5230\u4e86\u8cc7\u6599\u8868\u4e2d\uff0c\u4f5c\u70ba\u8a2a\u554f\u8a72\u503c\u7684\u4e00\u7a2e\u7c21\u5beb\u65b9\u5f0f\u3002 Getter \u65b9\u6cd5\u4e5f\u53ef\u4ee5\u7528\u4f86\u76f4\u63a5\u8986\u84cb\u73fe\u6709\u6b04\u4f4d\u7684\u503c\uff0c\u9019\u88e1\u7684 last_activity \u503c\u5c31\u662f\u5982\u6b64\u3002 last_activity \u5be6\u969b\u4e0a\u662f\u4e00\u500b\u5feb\u53d6\u503c\uff0c\u901a\u5e38\u5728\u7528\u6236\u767b\u51fa\u6642\u624d\u6703\u66f4\u65b0\u3002 \u7136\u800c\uff0c\u6211\u5011\u5728 xf_session_activity \u8cc7\u6599\u8868\u4e2d\u5132\u5b58\u4e86\u7528\u6236\u6700\u65b0\u7684\u6d3b\u52d5\u65e5\u671f\uff0c\u6240\u4ee5\u6211\u5011\u53ef\u4ee5\u4f7f\u7528 getLastActivity \u65b9\u6cd5\u4f86\u8fd4\u56de\u8a72\u503c\u800c\u4e0d\u662f\u5feb\u53d6\u7684\u6700\u5f8c\u6d3b\u52d5\u503c\u3002 \u5982\u679c\u4f60\u9700\u8981\u5b8c\u5168\u7e5e\u904e getter \u65b9\u6cd5\uff0c\u53ea\u9700\u8981\u5f97\u5230\u771f\u6b63\u7684 Entity \u503c\uff0c\u53ea\u9700\u8981\u5728 column \u540d\u5f8c\u52a0\u4e0a\u4e0b\u5283\u7dda\uff0c\u4f8b\u5982 $user->last_activity_ \u3002 \u56e0\u70ba\u4e00\u500b Entity \u5c31\u50cf\u5176\u4ed6\u7684 PHP \u7269\u4ef6\u4e00\u6a23\uff0c\u4f60\u53ef\u4ee5\u7d66\u5b83\u5011\u65b0\u589e\u66f4\u591a\u7684\u65b9\u6cd5\u3002 \u4e00\u500b\u5e38\u898b\u7684\u4f7f\u7528\u6848\u4f8b\u662f\u65b0\u589e\u4e00\u4e9b\u50cf\u6b0a\u9650\u6aa2\u67e5\u9019\u6a23\u7684\u65b9\u6cd5\uff0c\u9019\u4e9b\u65b9\u6cd5\u53ef\u4ee5\u5728 Entity \u81ea\u8eab\u4e0a\u9762\u547c\u53eb\u3002 Relations (\u95dc\u806f) \u00b6 $structure->relations = [ 'Admin' => [ 'entity' => 'XF:Admin', 'type' => self::TO_ONE, 'conditions' => 'user_id', 'primary' => true ] ]; \u9019\u5c31\u662f Relations \u7684\u5b9a\u7fa9\u3002 \u4ec0\u9ebc\u662f Relations\uff1f \u5b83\u5011\u5b9a\u7fa9\u4e86 Entity \u4e4b\u9593\u7684\u95dc\u806f\uff0c\u9019\u4e9b\u95dc\u806f\u53ef\u4ee5\u88ab\u7528\u4f86\u5c0d\u5176\u4ed6\u8cc7\u6599\u8868\u57f7\u884c join \u67e5\u8a62\uff0c\u6216\u8005\u5feb\u901f\u7372\u53d6\u8207 Entity \u76f8\u95dc\u7684\u8a18\u9304\u3002 \u5982\u679c\u6211\u5011\u9084\u8a18\u5f97 finder \u4e2d\u7684 with \u65b9\u6cd5\uff0c\u5047\u5982\u6211\u5011\u60f3\u7372\u53d6\u4e00\u500b\u7279\u5b9a\u7684\u7528\u6236\uff0c\u4e26\u9810\u5148\u7372\u53d6\u8a72\u7528\u6236\u7684 Admin \u8a18\u9304\uff08\u5982\u679c\u5b83\u5b58\u5728\u7684\u8a71\uff09\uff0c\u90a3\u9ebc\u6211\u5011\u5c07\u505a\u5982\u4e0b\u64cd\u4f5c\uff1a $finder = \\XF::finder('XF:User'); $user = $finder->where('user_id', 1)->with('Admin')->fetchOne(); \u9019\u5c07\u4f7f\u7528 User Entity \u4e2d\u5b9a\u7fa9\u7684 Admin \u76f8\u95dc\u7684\u8cc7\u8a0a\u548c XF:Admin Entity Structure \u7684\u7d30\u7bc0\uff0c\u77e5\u9053\u9019\u500b\u7528\u6236\u67e5\u8a62\u61c9\u8a72\u5728 xf_admin \u8cc7\u6599\u8868\u548c user_id column \u4e0a\u57f7\u884c LEFT JOIN \u3002 \u8981\u5f9e User Entity \u4e2d\u7372\u53d6 Admin \u6700\u5f8c\u767b\u9304\u65e5\u671f\uff0c\u8acb\u57f7\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a $lastLogin = $user->Admin->last_login; // \u8fd4\u56de\u6700\u5f8c\u4e00\u6b21 Admin \u767b\u9304\u7684\u6642\u9593\u6233 \u7136\u800c\uff0c\u4e26\u4e0d\u7e3d\u662f\u9700\u8981\u5728 finder \u4e2d\u9032\u884c join \u4f86\u7372\u53d6 Entity \u7684\u76f8\u95dc\u8cc7\u8a0a\u3002 \u4f8b\u5982\uff0c\u5982\u679c\u6211\u5011\u4ee5\u4e0a\u9762\u7684\u4f8b\u5b50\u70ba\u4f8b\uff0c\u4e0d\u547c\u53eb with \u65b9\u6cd5\uff1a $finder = \\XF::finder('XF:User'); $user = $finder->where('user_id', 1)->fetchOne(); $lastLogin = $user->Admin->last_login; // \u8fd4\u56de\u6700\u5f8c\u4e00\u6b21 Admin \u767b\u9304\u7684\u6642\u9593\u6233 \u6211\u5011\u5728\u9019\u88e1\u4ecd\u7136\u5f97\u5230 last_login \u503c\u3002 \u5b83\u662f\u901a\u904e\u57f7\u884c\u984d\u5916\u7684\u67e5\u8a62\u4f86\u5feb\u901f\u7372\u53d6 Admin Entity \u7684\u3002 \u4e0a\u9762\u7684\u4f8b\u5b50\u4f7f\u7528\u4e86 TO_ONE \u985e\u578b\uff0c\u56e0\u6b64\uff0c\u9019\u7a2e\u95dc\u806f\u5c07\u4e00\u500b Entity \u8207\u53e6\u4e00\u500b Entity \u806f\u7e6b\u8d77\u4f86\u3002 \u6211\u5011\u9084\u6709\u4e00\u500b TO_MANY \u985e\u578b\u3002 \u5b83\u4e0d\u53ef\u80fd\u7372\u53d6\u6574\u500b TO_MANY \u95dc\u806f\uff08\u4f8b\u5982\u5728 finder \u4e0a\u4f7f\u7528 join / with \u65b9\u6cd5\uff09\uff0c\u4f46\u4ee5\u67e5\u8a62\u70ba\u4ee3\u50f9\uff0c\u5b83\u53ef\u4ee5\u5728\u4efb\u4f55\u6642\u5019\u5feb\u901f\u8b80\u53d6\uff0c\u4f8b\u5982\u5728\u4e0a\u9762\u6700\u5f8c\u7684 last_login \u4f8b\u5b50\u4e2d\u3002 \u5728 User Entity \u4e0a\u5b9a\u7fa9\u7684\u4e00\u500b\u9019\u6a23\u7684 Relation \u662f ConnectedAccounts \u95dc\u806f\uff1a $structure->relations = [ 'ConnectedAccounts' => [ 'entity' => 'XF:UserConnectedAccount', 'type' => self::TO_MANY, 'conditions' => 'user_id', 'key' => 'provider' ] ]; \u9019\u500b relation \u80fd\u5920\u5f9e xf_user_connected_account \u8cc7\u6599\u8868\u4e2d\u8fd4\u56de\u8207\u76ee\u524d\u7528\u6236 ID \u76f8\u5339\u914d\u7684\u8a18\u9304\uff0c\u4f5c\u70ba\u4e00\u500b FinderCollection \u3002 \u9019\u985e\u4f3c\u65bc\u6211\u5011\u5728\u4e0a\u9762 Finder \u90e8\u5206\u63d0\u5230\u7684 ArrayCollection \u7269\u4ef6\u3002 \u5728 Relation \u5b9a\u7fa9\u4e2d\uff0c\u6307\u5b9a\u8a72\u96c6\u5408\u61c9\u8a72\u7531 provider \u6b04\u4f4d\u4f5c\u70ba key\u3002 \u96d6\u7136\u5728\u57f7\u884c finder \u67e5\u8a62\u6642\u4e0d\u53ef\u80fd\u7372\u53d6\u591a\u689d\u8a18\u9304\uff0c\u4f46\u53ef\u4ee5\u4f7f\u7528 TO_MANY \u95dc\u806f\u5f9e\u8a72 Relation \u4e2d\u7372\u53d6 \u55ae\u500b \u8a18\u9304\u3002 \u8209\u500b\u4f8b\u5b50\uff0c\u5982\u679c\u6211\u5011\u60f3\u67e5\u770b\u7528\u6236\u662f\u5426\u8207\u7279\u5b9a\u7684\u95dc\u806f\u5e33\u6236\u63d0\u4f9b\u5546\u76f8\u95dc\u806f\uff0c\u6211\u5011\u81f3\u5c11\u53ef\u4ee5\u5728\u67e5\u8a62\u6642\u7372\u53d6\u8a72\u8a18\u9304\uff1a $finder = \\XF::finder('XF:User'); $user = $finder->where('user_id', 1)->with('ConnectedAccounts|facebook')->fetchOne(); Options (\u9078\u9805) \u00b6 $structure->options = [ 'custom_title_disallowed' => preg_split('/\\r?\\n/', $options->disallowedCustomTitles), 'admin_edit' => false, 'skip_email_confirm' => false ]; Entity Option \u662f\u5728\u67d0\u4e9b\u689d\u4ef6\u4e0b\u4fee\u6539 Entity Behavior \u7684\u4e00\u7a2e\u65b9\u5f0f\u3002 \u4f8b\u5982\uff0c\u5982\u679c\u6211\u5011\u5c07 admin_edit \u8a2d\u5b9a\u70ba true\uff08\u5728 Admin CP \u4e2d\u7de8\u8f2f\u7528\u6236\u6642\u5c31\u662f\u5982\u6b64\uff09\uff0c\u90a3\u9ebc\u67d0\u4e9b\u6aa2\u67e5\u5c07\u88ab\u8df3\u904e\uff0c\u4f8b\u5982\u5141\u8a31\u7528\u6236\u7684\u96fb\u5b50\u90f5\u4ef6\u5730\u5740\u70ba\u7a7a\u3002 Entity \u751f\u547d\u9031\u671f \u00b6 Entity \u5728\u7ba1\u7406\u8cc7\u6599\u5eab\u5167\u8a18\u9304\u7684\u751f\u547d\u9031\u671f\u65b9\u9762\u626e\u6f14\u8457\u91cd\u8981\u89d2\u8272\u3002 \u9664\u4e86\u5f9e\u5b83\u90a3\u88e1\u8b80\u53d6\u503c\uff0c\u5411\u5b83\u5beb\u5165\u503c\u4e4b\u5916\uff0cEntity \u9084\u53ef\u4ee5\u7528\u4f86\u522a\u9664\u8a18\u9304\uff0c\u4e26\u5728\u6240\u6709\u9019\u4e9b\u64cd\u4f5c\u767c\u751f\u6642\u89f8\u767c\u67d0\u4e9b\u4e8b\u4ef6\uff0c\u5f9e\u800c\u53ef\u4ee5\u57f7\u884c\u67d0\u4e9b\u4efb\u52d9\uff0c\u6216\u8005\u4e5f\u53ef\u4ee5\u66f4\u65b0\u67d0\u4e9b\u76f8\u95dc\u8a18\u9304\u3002 \u8b93\u6211\u5011\u4f86\u770b\u770b Entity \u5728\u5132\u5b58\u6642\u767c\u751f\u7684\u4e00\u4e9b\u4e8b\u4ef6\uff1a _preSave() - \u5728\u5132\u5b58\u904e\u7a0b\u958b\u59cb\u4e4b\u524d\u767c\u751f\uff0c\u4e3b\u8981\u7528\u65bc\u57f7\u884c\u4efb\u4f55\u5176\u4ed6\u5132\u5b58\u524d\u7684\u9a57\u8b49\u6216\u5728\u5132\u5b58\u767c\u751f\u4e4b\u524d\u8a2d\u5b9a\u5176\u4ed6\u8cc7\u6599\u3002 _postSave() - \u5728\u8cc7\u6599\u88ab\u5132\u5b58\u5f8c\uff0c\u4f46\u5728\u4efb\u4f55\u4ea4\u6613\u88ab\u63d0\u4ea4\u4e4b\u524d\uff0c\u5c07\u547c\u53eb\u6b64\u65b9\u6cd5\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528\u6b64\u65b9\u6cd5\u4f86\u57f7\u884c Entity \u88ab\u5132\u5b58\u5f8c\u61c9\u89f8\u767c\u7684\u4efb\u4f55\u5176\u4ed6\u4e8b\u3002 \u53e6\u5916\u9084\u6709 _preDelete() \u548c _postDelete() \uff0c\u5b83\u5011\u7684\u904b\u4f5c\u65b9\u5f0f\u985e\u4f3c\uff0c\u4f46\u5728\u522a\u9664\u767c\u751f\u6642\u3002 Entity \u9084\u80fd\u5920\u63d0\u4f9b\u6709\u95dc\u5b83\u76ee\u524d\u72c0\u614b\u7684\u8cc7\u8a0a\u3002 \u4f8b\u5982\uff0c\u6709\u4e00\u500b isInsert() \u548c isUpdate() \u65b9\u6cd5\uff0c\u9019\u6a23\u4f60\u5c31\u53ef\u4ee5\u6aa2\u6e2c\u5230\u9019\u662f\u4e00\u500b\u65b0\u8a18\u9304\u88ab\u63d2\u5165\u9084\u662f\u4e00\u500b\u73fe\u6709\u8a18\u9304\u88ab\u66f4\u65b0\u3002 \u9084\u6709\u4e00\u500b isChanged() \u65b9\u6cd5\uff0c\u53ef\u4ee5\u544a\u8a34\u4f60\u81ea\u4e0a\u6b21\u5132\u5b58\u5f8c\uff0c\u67d0\u500b\u7279\u5b9a\u6b04\u4f4d\u662f\u5426\u767c\u751f\u4e86\u8b8a\u5316\u3002 \u8b93\u6211\u5011\u770b\u770b\u9019\u4e9b\u65b9\u6cd5\u5728 User Entity \u4e2d\u7684\u4e00\u4e9b\u5be6\u969b\u4f8b\u5b50\u3002 protected function _preSave() { if ($this->isChanged('user_group_id') || $this->isChanged('secondary_group_ids')) { $groupRepo = $this->getUserGroupRepo(); $this->display_style_group_id = $groupRepo->getDisplayGroupIdForUser($this); } // ... } protected function _postSave() { // ... if ($this->isUpdate() && $this->isChanged('username') && $this->getExistingValue('username') != null) { $this->app()->jobManager()->enqueue('XF:UserRenameCleanUp', [ 'originalUserId' => $this->user_id, 'originalUserName' => $this->getExistingValue('username'), 'newUserName' => $this->username ]); } // ... \u5728 _preSave() \u7684\u4f8b\u5b50\u4e2d\uff0c\u6211\u5011\u6839\u64da\u7528\u6236\u6539\u8b8a\u5f8c\u7684\u7528\u6236\u7d44\u4f86\u7372\u53d6\u4e26\u5feb\u53d6\u65b0\u7684\u986f\u793a Group ID\u3002 \u5728 _postSave() \u7684\u4f8b\u5b50\u4e2d\uff0c\u6211\u5011\u5728\u7528\u6236\u7684\u540d\u5b57\u88ab\u66f4\u6539\u5f8c\u89f8\u767c\u4e00\u500b\u4f5c\u696d\u4f86\u57f7\u884c\u3002 Repository (\u5132\u5b58\u5eab) \u00b6 \u5c0d\u65bc XF2 \u4f86\u8aaa\uff0cRepository \u662f\u4e00\u500b\u65b0\u7684\u6982\u5ff5\uff0c\u4f46\u662f\u5982\u679c\u628a\u5b83\u5011\u8207 XF1 \u4e2d\u7684 \"Model\" \u7269\u4ef6\u9032\u884c\u6bd4\u8f03\uff0c\u4f60\u53ef\u80fd\u4e0d\u6703\u53d7\u5230\u6307\u8cac\u3002 \u6211\u5011\u5728 XF2 \u4e2d\u6c92\u6709 Model \u7269\u4ef6\uff0c\u56e0\u70ba\u6211\u5011\u6709\u66f4\u597d\u7684\u5730\u65b9\u548c\u65b9\u6cd5\u4f86\u7372\u53d6\u548c\u5beb\u5165\u8cc7\u6599\u5230\u8cc7\u6599\u5eab\u3002 \u6240\u4ee5\uff0c\u8207\u5176\u8aaa\u6211\u5011\u6709\u4e00\u500b\u9f90\u5927\u7684 class\uff0c\u5176\u4e2d\u5305\u542b\u4e86\u4f60\u7684\u9644\u52a0\u5143\u4ef6\u6240\u9700\u8981\u7684\u6240\u6709\u67e5\u8a62\uff0c\u4ee5\u53ca\u5404\u7a2e\u4e0d\u540c\u7684\u65b9\u6cd5\u4f86\u64cd\u4f5c\u9019\u4e9b\u67e5\u8a62\uff0c\u4e0d\u5982\u8aaa\u6211\u5011\u6709 finder\uff0c\u5b83\u589e\u52a0\u4e86\u66f4\u591a\u7684\u5f48\u6027\u3002 \u53e6\u5916\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0c\u5728 XF1 \u4e2d\uff0cModel \u7269\u4ef6\u5c0d\u65bc\u8a31\u591a\u6771\u897f\u4f86\u8aaa\u6709\u9ede\u50cf \"dumping ground\"\u3002 \u5176\u4e2d\u5f88\u591a\u6771\u897f\u73fe\u5728\u90fd\u662f\u591a\u9918\u7684\u3002 \u4f8b\u5982\uff0c\u5728 XF1 \u4e2d\uff0c\u6240\u6709\u7684\u6b0a\u9650\u91cd\u5efa\u7a0b\u5f0f\u78bc\u90fd\u5728\u6b0a\u9650 Model \u4e2d\u3002 \u5728 XF2 \u4e2d\uff0c\u6211\u5011\u6709\u7279\u5b9a\u7684\u670d\u52d9\u548c\u7269\u4ef6\u4f86\u8655\u7406\u9019\u500b\u554f\u984c\u3002 \u90a3\u9ebc\uff0c\u4ec0\u9ebc\u662f Repository \u5462\uff1f \u5b83\u5011\u5c0d\u61c9\u8457\u4e00\u500b Entity \u548c\u4e00\u500b Finder\uff0c\u4e26\u6301\u6709\u65b9\u6cd5\uff0c\u4e00\u822c\u6703\u8fd4\u56de\u4e00\u500b\u70ba\u7279\u5b9a\u76ee\u7684\u8a2d\u5b9a\u7684 Finder \u7269\u4ef6\u3002 \u70ba\u4ec0\u9ebc\u4e0d\u76f4\u63a5\u8fd4\u56de Finder \u67e5\u8a62\u7684\u7d50\u679c\u5462\uff1f \u597d\u5427\uff0c\u5982\u679c\u6211\u5011\u8fd4\u56de Finder \u7269\u4ef6\u672c\u8eab\uff0c\u90a3\u9ebc\u5b83\u53ef\u4ee5\u4f5c\u70ba\u4e00\u500b\u6709\u7528\u7684\u7e7c\u627f\u9ede\uff0c\u8b93\u9644\u52a0\u5143\u4ef6\u5728 Entity \u6216\u96c6\u5408\u8fd4\u56de\u4e4b\u524d\uff0c\u5c0d\u5176\u9032\u884c\u7e7c\u627f\u4e26\u4fee\u6539 Finder \u7269\u4ef6\u3002 Repository \u4e5f\u53ef\u4ee5\u5305\u542b\u4e00\u4e9b\u5177\u9ad4\u7684\u65b9\u6cd5\uff0c\u6bd4\u5982\u5feb\u53d6\u91cd\u5efa\u3002","title":"\u8cc7\u6599\u5be6\u9ad4\u3001\u67e5\u627e\u5668\u3001\u5132\u5b58\u5eab"},{"location":"entities-finders-repositories/#_1","text":"\u5728 XF2 \u4e2d\uff0c\u6709\u8a31\u591a\u8207\u8cc7\u6599\u4e92\u52d5\u7684\u65b9\u6cd5\u3002 \u5728 XF1 \u4e2d\uff0c\u9019\u4e3b\u8981\u662f\u91dd\u5c0d\u5728 Model \u6a94\u6848\u4e2d\u5beb\u51fa\u539f\u59cb SQL \u8a9e\u53e5\u3002 XF2 \u4e2d\u7684\u65b9\u6cd5\u5df2\u7d93\u812b\u96e2\u4e86\u9019\u4e00\u9ede\uff0c\u6211\u5011\u589e\u52a0\u4e86\u4e00\u4e9b\u65b0\u7684\u65b9\u6cd5\u3002 \u6211\u5011\u9996\u5148\u4f86\u770b\u4e00\u4e0b\u57f7\u884c\u8cc7\u6599\u5eab\u67e5\u8a62\u7684\u9996\u9078\u65b9\u6cd5 - Finder\u3002","title":"\u8cc7\u6599\u5be6\u9ad4\u3001\u67e5\u627e\u5668\u3001\u5132\u5b58\u5eab"},{"location":"entities-finders-repositories/#finder","text":"\u6211\u5011\u5f15\u5165\u4e86\u4e00\u500b\u65b0\u7684 \"Finder\" \u7cfb\u7d71\uff0c\u5b83\u5141\u8a31\u4ee5\u7269\u4ef6\u5c0e\u5411\u7684\u65b9\u5f0f\u4ee5\u7de8\u7a0b\u65b9\u5f0f\u5efa\u7acb\u67e5\u8a62\uff0c\u9019\u6a23\u5c31\u4e0d\u9700\u8981\u7de8\u5beb\u539f\u59cb\u8cc7\u6599\u5eab\u67e5\u8a62\u3002 Finder \u7cfb\u7d71\u8207 Entity \u7cfb\u7d71\u651c\u624b\u5408\u4f5c\uff0c\u6211\u5011\u5728\u4e0b\u9762\u8a73\u7d30\u4ecb\u7d39\u3002 \u50b3\u5165 finder \u65b9\u6cd5\u7684\u7b2c\u4e00\u500b\u53c3\u6578\u662f\u4f60\u8981\u8655\u7406\u7684 Entity \u7684\u77ed\u985e\u540d\u3002 \u6211\u5011\u5c31\u628a\u4e0a\u9762\u4e00\u7bc0\u4e2d\u63d0\u5230\u7684\u4e00\u4e9b\u67e5\u8a62\u8f49\u63db\u70ba\u4f7f\u7528 finder \u7cfb\u7d71\u4f86\u4ee3\u66ff\u3002 \u4f8b\u5982\uff0c\u8981\u8a2a\u554f\u55ae\u500b\u7528\u6236\u8a18\u9304\uff1a $finder = \\XF::finder('XF:User'); $user = $finder->where('user_id', 1)->fetchOne(); \u76f4\u63a5\u67e5\u8a62\u65b9\u6cd5\u8207\u4f7f\u7528 Finder \u4e4b\u9593\u7684\u4e3b\u8981\u5340\u5225\u4e4b\u4e00\u662f Finder \u8fd4\u56de\u7684\u8cc7\u6599\u57fa\u672c\u55ae\u4f4d\u4e0d\u662f\u4e00\u500b\u9663\u5217\u3002 \u5728 Finder \u7269\u4ef6\u547c\u53eb fetchOne \u65b9\u6cd5\u7684\u60c5\u6cc1\u4e0b\uff08\u8a72\u65b9\u6cd5\u53ea\u5f9e\u8cc7\u6599\u5eab\u4e2d\u8fd4\u56de\u55ae\u500b row \uff09\uff0c\u5c07\u8fd4\u56de\u55ae\u500b Entity \u7269\u4ef6\u3002 \u8b93\u6211\u5011\u770b\u770b\u4e00\u500b\u7a0d\u5fae\u4e0d\u540c\u7684\u65b9\u6cd5\uff0c\u5b83\u5c07\u8fd4\u56de\u591a\u500b row\uff1a $finder = \\XF::finder('XF:User'); $users = $finder->limit(10)->fetch(); \u9019\u500b\u4f8b\u5b50\u5c07\u5f9e xf_user \u8cc7\u6599\u8868\u4e2d\u67e5\u8a62 10 \u689d\u8a18\u9304\uff0c\u4e26\u4ee5 ArrayCollection \u7269\u4ef6\u7684\u5f62\u5f0f\u8fd4\u56de\u3002 \u9019\u662f\u4e00\u500b\u7279\u6b8a\u7684\u7269\u4ef6\uff0c\u5b83\u7684\u4f5c\u7528\u985e\u4f3c\u65bc\u4e00\u500b\u9663\u5217\uff0c\u56e0\u70ba\u5b83\u662f\u53ef\u4ee5\u904d\u6b77\u7684\uff08\u4f60\u53ef\u4ee5\u5728\u5b83\u88e1\u9762\u5faa\u74b0\uff09\uff0c\u800c\u4e14\u5b83\u6709\u4e00\u4e9b\u7279\u6b8a\u7684\u65b9\u6cd5\uff0c\u53ef\u4ee5\u544a\u8a34\u4f60\u5b83\u6240\u64c1\u6709\u7684\u689d\u76ee\u7e3d\u6578\uff0c\u901a\u904e\u67d0\u4e9b\u503c\u9032\u884c\u5206\u7d44\uff0c\u6216\u8005\u5176\u4ed6\u985e\u4f3c\u65bc\u9663\u5217\u7684\u64cd\u4f5c\uff0c\u5982\u904e\u6ffe\u3001\u5408\u4f75\u3001\u7372\u53d6\u7b2c\u4e00\u500b\u6216\u6700\u5f8c\u4e00\u500b\u689d\u76ee\u7b49\u3002 Finder \u67e5\u8a62\uff0c\u4e00\u822c\u61c9\u8a72\u662f\u671f\u671b\u5f9e\u8cc7\u6599\u8868\u4e2d\u6aa2\u7d22\u6240\u6709\u7684 Column\uff0c\u56e0\u6b64\uff0c\u6c92\u6709\u7279\u5b9a\u7684\u5c0d\u61c9\u95dc\u4fc2\u50c5\u7372\u53d6\u67d0\u4e9b Column \u4e2d\u7684\u67d0\u4e9b\u503c\u3002 \u76f8\u53cd\uff0c\u5982\u679c\u8981\u7372\u5f97\u55ae\u500b\u503c\uff0c\u4f60\u53ea\u9700\u8981\u7372\u53d6\u4e00\u500b Entity\uff0c\u7136\u5f8c\u76f4\u63a5\u5f9e\u9019\u500b Entity \u4e2d\u8b80\u53d6\u503c\uff1a $finder = \\XF::finder('XF:User'); $username = $finder->where('user_id', 1)->fetchOne()->username; \u540c\u6a23\u5730\uff0c\u5982\u679c\u8981\u5f9e Column \u4e2d\u7372\u53d6\u4e00\u500b\u9663\u5217\u7684\u503c\uff0c\u53ef\u4ee5\u4f7f\u7528 pluckFrom \u65b9\u6cd5\uff1a $finder = \\XF::finder('XF:User'); $usernames = $finder->limit(10)->pluckFrom('username')->fetch(); \u5230\u76ee\u524d\u70ba\u6b62\uff0c\u6211\u5011\u5df2\u7d93\u770b\u5230 Finder \u61c9\u7528\u4e86\u4e00\u4e9b\u7c21\u55ae\u7684 where \u548c limit \u7d04\u675f\u3002 \u6240\u4ee5\u6211\u5011\u4f86\u770b\u770b Finder \u7684\u66f4\u591a\u8a73\u7d30\u5167\u5bb9\uff0c\u5305\u62ec\u95dc\u65bc where \u65b9\u6cd5\u672c\u8eab\u7684\u66f4\u591a\u7d30\u7bc0\u3002","title":"Finder (\u67e5\u627e\u5668\u7cfb\u7d71)"},{"location":"entities-finders-repositories/#where","text":"where \u65b9\u6cd5\u6700\u591a\u53ef\u4ee5\u652f\u63f4\u4e09\u500b\u53c3\u6578\u3002 \u7b2c\u4e00\u500b\u53c3\u6578\u662f\u689d\u4ef6\u672c\u8eab\uff0c\u4f8b\u5982\u4f60\u8981\u641c\u5c0b\u7684 Column\u3002 \u7b2c\u4e8c\u500b\u53c3\u6578\u901a\u5e38\u662f\u904b\u7b97\u5b50\u3002 \u7b2c\u4e09\u500b\u662f\u88ab\u641c\u5c0b\u7684 value\u3002 \u5982\u679c\u4f60\u53ea\u63d0\u4f9b\u4e86\u5169\u500b\u53c3\u6578\uff0c\u5c31\u50cf\u4f60\u5728\u4e0a\u9762\u770b\u5230\u7684\u90a3\u6a23\uff0c\u90a3\u9ebc\u5b83\u81ea\u52d5\u610f\u5473\u8457\u904b\u7b97\u5b50\u662f = \u3002 \u4ee5\u4e0b\u662f\u5176\u4ed6\u6709\u6548\u7684\u904b\u7b97\u5b50\u5217\u8868\uff1a = <> != > >= < <= LIKE BETWEEN \u6240\u4ee5\uff0c\u5982\u679c\u6211\u5011\u60f3\u8981\u5f97\u5230\u6700\u8fd1 7 \u5929\u5167\u8a3b\u518a\u7684\u6709\u6548\u7528\u6236\u540d\u55ae\uff1a $finder = \\XF::finder('XF:User'); $users = $finder->where('user_state', 'valid')->where('register_date', '>=', time() - 86400 * 7)->fetch(); \u6b63\u5982\u4f60\u6240\u770b\u5230\u7684\uff0c\u4f60\u53ef\u4ee5\u96a8\u610f\u547c\u53eb where \u65b9\u6cd5\uff0c\u4f46\u9664\u6b64\u4e4b\u5916\uff0c\u4f60\u9084\u53ef\u4ee5\u9078\u64c7\u50b3\u5165\u4e00\u500b\u9663\u5217\u505a\u70ba\u8a72\u65b9\u6cd5\u7684\u552f\u4e00\u53c3\u6578\uff0c\u4e26\u5728\u4e00\u6b21\u547c\u53eb\u4e2d\u5efa\u7acb\u4f60\u7684\u689d\u4ef6\u3002 \u9663\u5217\u65b9\u6cd5\u652f\u63f4\u5169\u7a2e\u985e\u578b\uff0c\u6211\u5011\u53ef\u4ee5\u5728\u4e0a\u9762\u5efa\u7acb\u7684\u67e5\u8a62\u4e2d\u4f7f\u7528\u9019\u5169\u7a2e\u985e\u578b\uff1a $finder = \\XF::finder('XF:User'); $users = $finder->where([ 'user_state' => 'valid', ['register_date', '>=', time() - 86400 * 7] ]) ->fetch(); \u901a\u5e38\u4e0d\u5efa\u8b70\u6216\u660e\u78ba\u5730\u9019\u6a23\u6df7\u5408\u4f7f\u7528\uff0c\u4f46\u5b83\u78ba\u5be6\u5728\u4e00\u5b9a\u7a0b\u5ea6\u4e0a\u5c55\u793a\u4e86\u8a72\u65b9\u6cd5\u7684\u9748\u6d3b\u6027\u3002 \u73fe\u5728\u689d\u4ef6\u5df2\u7d93\u5728\u4e00\u500b\u9663\u5217\u4e2d\uff0c\u6211\u5011\u53ef\u4ee5\u6307\u5b9a Column \u540d\uff08\u4f5c\u70ba\u9663\u5217\u7684 key\uff09\u548c\u96b1\u5f0f\u7684 = \u904b\u7b97\u5b50\u7684 value\uff0c\u6216\u8005\u6211\u5011\u53ef\u4ee5\u5be6\u969b\u5b9a\u7fa9\u53e6\u4e00\u500b\u5305\u542b column\u3001\u904b\u7b97\u5b50\u548c value \u7684\u9663\u5217\u3002","title":"where \u65b9\u6cd5"},{"location":"entities-finders-repositories/#whereor","text":"\u5728\u4e0a\u9762\u7684\u4f8b\u5b50\u4e2d\uff0c\u5169\u500b\u689d\u4ef6\u90fd\u9700\u8981\u6eff\u8db3\uff0c\u5373\u6bcf\u500b\u689d\u4ef6\u90fd\u7531 AND \u904b\u7b97\u5b50\u9023\u63a5\u3002 \u7136\u800c\uff0c\u6709\u6642\u9700\u8981\u53ea\u6eff\u8db3\u90e8\u5206\u689d\u4ef6\uff0c\u9019\u53ef\u4ee5\u901a\u904e\u4f7f\u7528 whereOr \u65b9\u6cd5\u4f86\u5be6\u73fe\u3002 \u4f8b\u5982\uff0c\u5982\u679c\u4f60\u60f3\u641c\u5c0b\u90a3\u4e9b\u7121\u6548\u7684\u7528\u6236\u6216\u8005\u662f\u767c\u4f48\u4e86\u96f6\u5247\u7559\u8a00\u7684\u7528\u6236\uff0c\u4f60\u53ef\u4ee5\u5efa\u7acb\u5982\u4e0b\uff1a $finder = \\XF::finder('XF:User'); $users = $finder->whereOr( ['user_state', '<>', 'valid'], ['message_count', 0] )->fetch(); \u8207\u4e0a\u4e00\u7bc0\u7684\u4f8b\u5b50\u985e\u4f3c\uff0c\u9664\u4e86\u50b3\u905e\u6700\u591a\u5169\u500b\u689d\u4ef6\u4f5c\u70ba\u55ae\u7368\u7684\u53c3\u6578\u5916\uff0c\u4f60\u4e5f\u53ef\u4ee5\u53ea\u50b3\u905e\u4e00\u500b\u689d\u4ef6\u9663\u5217\u5230\u7b2c\u4e00\u500b\u53c3\u6578\uff1a $finder = \\XF::finder('XF:User'); $users = $finder->whereOr([ ['user_state', '<>', 'valid'], ['message_count', 0], ['is_banned', 1] ])->fetch();","title":"whereOr \u65b9\u6cd5"},{"location":"entities-finders-repositories/#with","text":"with \u65b9\u6cd5\u672c\u8cea\u4e0a\u7b49\u540c\u65bc\u4f7f\u7528 INNER|LEFT JOIN \u8a9e\u53e5\uff0c\u5118\u7ba1\u5b83\u4f9d\u8cf4\u65bc Entity \u5df2\u7d93\u5b9a\u7fa9\u4e86\u5b83\u7684 \"Relation\"\u3002 \u6211\u5011\u5728\u4e0b\u4e00\u9801\u624d\u6703\u8a0e\u8ad6\u9019\u500b\u554f\u984c\uff0c\u4f46\u9019\u61c9\u8a72\u53ea\u662f\u8b93\u4f60\u4e86\u89e3\u5b83\u662f\u5982\u4f55\u904b\u4f5c\u7684\u3002 \u73fe\u5728\u8b93\u6211\u5011\u4f7f\u7528\u4e3b\u984c finder \u4f86\u6aa2\u7d22\u4e00\u500b\u7279\u5b9a\u7684\u4e3b\u984c\uff1a $finder = \\XF::finder('XF:Thread'); $thread = $finder->with('Forum', true)->where('thread_id', 123)->fetchOne(); \u9019\u500b\u67e5\u8a62\u5c07\u7372\u53d6 thread_id = 123 \u7684\u4e3b\u984c\u5be6\u9ad4\uff0c\u4f46\u5b83\u4e5f\u6703\u5728\u80cc\u666f\u8207 xf_forum \u8cc7\u6599\u8868\u9032\u884c join\u3002 \u5728\u63a7\u5236\u5982\u4f55\u505a INNER JOIN \u800c\u4e0d\u662f LEFT JOIN \u65b9\u9762\uff0c\u9019\u5c31\u662f\u7b2c\u4e8c\u500b\u53c3\u6578\u7684\u4f5c\u7528\u3002 \u5728\u672c\u4f8b\u4e2d\uff0c\u6211\u5011\u5c07 \"must exist\" \u53c3\u6578\u8a2d\u5b9a\u70ba true\uff0c\u6240\u4ee5\u5b83\u6703\u628a\u9023\u63a5\u8a9e\u53e5\u8f49\u63db\u70ba\u4f7f\u7528 INNER \u800c\u4e0d\u662f\u9810\u8a2d\u7684 LEFT \u3002 \u6211\u5011\u5c07\u5728\u4e0b\u4e00\u7bc0\u8a73\u7d30\u4ecb\u7d39\u5982\u4f55\u8a2a\u554f\u5f9e\u9019\u500b join \u7372\u53d6\u7684\u8cc7\u6599\u3002 \u4e5f\u53ef\u4ee5\u5728 with \u65b9\u6cd5\u4e2d\u50b3\u905e\u4e00\u500b Relation \u9663\u5217\u4f86\u9032\u884c\u591a\u91cd join\u3002 $finder = \\XF::finder('XF:Thread'); $thread = $finder->with(['Forum', 'User'], true)->where('thread_id', 123)->fetchOne(); \u9019\u5c07\u6703 join \u5230 xf_user \u8cc7\u6599\u8868\u4ee5\u7372\u5f97\u4e3b\u984c\u4f5c\u8005\u3002 \u7136\u800c\uff0c\u7531\u65bc\u7b2c\u4e8c\u500b\u53c3\u6578\u4ecd\u7136\u662f true \uff0c\u6211\u5011\u53ef\u80fd\u4e0d\u9700\u8981\u70ba User join \u505a\u4e00\u500b INNER join\uff0c\u6240\u4ee5\uff0c\u6211\u5011\u53ef\u4ee5\u7528 chain \u65b9\u6cd5\u4ee3\u66ff\uff1a $finder = \\XF::finder('XF:Thread'); $thread = $finder->with('Forum', true)->with('User')->where('thread_id', 123)->fetchOne();","title":"with \u65b9\u6cd5"},{"location":"entities-finders-repositories/#order-limit-limitbypage","text":"","title":"order, limit \u548c limitByPage \u65b9\u6cd5"},{"location":"entities-finders-repositories/#order","text":"\u9019\u500b\u65b9\u6cd5\u5141\u8a31\u4f60\u6309\u7167\u7279\u5b9a\u7684\u9806\u5e8f\u4f86\u4fee\u6539\u4f60\u7684\u67e5\u8a62\u7372\u53d6\u7d50\u679c\u3002 \u5b83\u9700\u8981\u5169\u500b\u53c3\u6578\uff0c\u7b2c\u4e00\u500b\u662f column \u540d\uff0c\u7b2c\u4e8c\u500b\u662f\u53ef\u9078\u7684\u6392\u5e8f\u65b9\u5411\u3002 \u6240\u4ee5\uff0c\u5982\u679c\u4f60\u60f3\u5217\u51fa\u64c1\u6709\u6700\u591a\u7559\u8a00\u7684 10 \u500b\u7528\u6236\uff0c\u4f60\u53ef\u4ee5\u5efa\u7acb\u50cf\u9019\u6a23\u7684\u67e5\u8a62\uff1a $finder = \\XF::finder('XF:User'); $users = $finder->order('message_count', 'DESC')->limit(10); Note \u73fe\u5728\u53ef\u80fd\u662f\u4e00\u500b\u5f88\u597d\u7684\u6642\u6a5f\u4f86\u63d0\u53ca\uff0cfinder \u65b9\u6cd5\u5927\u591a\u53ef\u4ee5\u6309\u7167\u4efb\u4f55\u9806\u5e8f\u547c\u53eb\u3002 \u4f8b\u5982\uff1a $threads = $finder->limit(10)->where('thread_id', '>', 123)->order('post_date')->with('User')->fetch(); \u96d6\u7136\u5982\u679c\u4f60\u6309\u7167\u9019\u500b\u9806\u5e8f\u5beb\u4e00\u500b MySQL \u67e5\u8a62\uff0c\u80af\u5b9a\u6703\u9047\u5230\u4e00\u4e9b\u8a9e\u6cd5\u554f\u984c\uff0c\u4f46 Finder \u7cfb\u7d71\u9084\u662f\u6703\u6309\u7167\u6b63\u78ba\u7684\u9806\u5e8f\u4f86\u69cb\u5efa\uff0c\u4e0a\u9762\u7684\u7a0b\u5f0f\u78bc\u96d6\u7136\u770b\u8d77\u4f86\u5f88\u5947\u602a\uff0c\u53ef\u80fd\u4e5f\u4e0d\u5efa\u8b70\u4f7f\u7528\uff0c\u4f46\u90a3\u6a23\u5beb\u78ba\u5be6\u662f\u5b8c\u5168\u6b63\u78ba\u7684\u3002 \u8207\u6a19\u6e96\u7684 MySQL \u67e5\u8a62\u4e00\u6a23\uff0c\u53ef\u4ee5\u5c0d\u591a\u500b Column \u7684\u7d50\u679c\u96c6\u9032\u884c\u6392\u5e8f\u3002 \u8981\u505a\u5230\u9019\u4e00\u9ede\uff0c\u4f60\u53ef\u4ee5\u518d\u6b21\u547c\u53eb order \u65b9\u6cd5\u3002 \u4e5f\u53ef\u4ee5\u4f7f\u7528\u9663\u5217\u5c07\u591a\u500b order \u5b50\u53e5\u50b3\u905e\u5230 order \u65b9\u6cd5\u4e2d\u3002 $finder = \\XF::finder('XF:User'); $users = $finder->order('message_count', 'DESC')->order('register_date')->limit(10);","title":"order \u65b9\u6cd5"},{"location":"entities-finders-repositories/#limit","text":"\u6211\u5011\u5df2\u7d93\u770b\u5230\u4e86\u5982\u4f55\u5c07\u67e5\u8a62 limit \u5728\u7279\u5b9a\u6578\u91cf\u7684\u8a18\u9304\u4e0a\uff1a $finder = \\XF::finder('XF:User'); $users = $finder->limit(10)->fetch(); \u4e0d\u904e\uff0c\u5176\u5be6\u9084\u6709\u4e00\u500b\u8fa6\u6cd5\u53ef\u4ee5\u76f4\u63a5\u547c\u53eb limit \u65b9\u6cd5\uff1a $finder = \\XF::finder('XF:User'); $users = $finder->fetch(10); \u53ef\u4ee5\u76f4\u63a5\u5c07\u4f60\u7684 limit \u50b3\u5165 fetch() \u65b9\u6cd5\u3002 \u53e6\u5916\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0c limit \uff08\u548c fetch \uff09\u65b9\u6cd5\u652f\u63f4\u5169\u500b\u53c3\u6578\u3002 \u7b2c\u4e00\u500b\u986f\u7136\u662f limit\uff0c\u7b2c\u4e8c\u500b\u662f offset\u3002 $finder = \\XF::finder('XF:User'); $users = $finder->limit(10, 100)->fetch(); \u9019\u88e1\u7684 offset \u57fa\u672c\u4e0a\u610f\u5473\u8457\u524d 100 \u500b\u7d50\u679c\u5c07\u88ab\u68c4\u7528\uff0c\u4e4b\u5f8c\u7684\u524d 10 \u500b\u7d50\u679c\u5c07\u88ab\u8fd4\u56de\u3002 \u9019\u7a2e\u65b9\u6cd5\u5c0d\u65bc\u63d0\u4f9b\u5206\u9801\u7d50\u679c\u662f\u5f88\u6709\u7528\u7684\uff0c\u4e0d\u904e\u6211\u5011\u5176\u5be6\u4e5f\u6709\u4e00\u500b\u66f4\u7c21\u55ae\u7684\u65b9\u6cd5...","title":"limit \u65b9\u6cd5"},{"location":"entities-finders-repositories/#limitbypage","text":"\u9019\u500b\u65b9\u6cd5\u662f\u4e00\u7a2e\u8f14\u52a9\u65b9\u6cd5\uff0c\u6700\u7d42\u6703\u6839\u64da\u4f60\u76ee\u524d\u6aa2\u8996\u7684 \"\u9801\u9762\" \u548c\u4f60\u6240\u9700\u8981\u7684 \"\u6bcf\u9801\" \u6578\u91cf\u4f86\u8a2d\u5b9a\u76f8\u61c9\u7684 limit \u548c offset\u3002 $finder = \\XF::finder('XF:User'); $users = $finder->limitByPage(3, 20); \u5728\u9019\u7a2e\u60c5\u6cc1\u4e0b\uff0climit \u5c07\u88ab\u8a2d\u5b9a\u70ba 20\uff08\u9019\u662f\u6211\u5011\u6bcf\u9801\u7684\u503c\uff09\uff0coffset \u5c07\u88ab\u8a2d\u5b9a\u70ba 40\uff0c\u56e0\u70ba\u6211\u5011\u5f9e\u7b2c 3 \u9801\u958b\u59cb\u3002 \u5076\u723e\uff0c\u6211\u5011\u9700\u8981\u6293\u53d6\u8d85\u904e limit \u7684\u984d\u5916\u8cc7\u6599\u3002 Over-fetching \u53ef\u4ee5\u5e6b\u52a9\u5075\u6e2c\u4f60\u5728\u76ee\u524d\u9801\u9762\u4e4b\u5f8c\u662f\u5426\u6709\u984d\u5916\u7684\u8cc7\u6599\u8981\u986f\u793a\uff0c\u6216\u8005\u4f60\u662f\u5426\u9700\u8981\u6839\u64da\u6b0a\u9650\u904e\u6ffe\u8a2d\u5b9a\u4e0b\u4f86\u7684\u521d\u59cb\u7d50\u679c\u3002 \u6211\u5011\u53ef\u4ee5\u901a\u904e\u7b2c\u4e09\u500b\u53c3\u6578\u4f86\u5be6\u73fe\uff1a $finder = \\XF::finder('XF:User'); $users = $finder->limitByPage(3, 20, 1); \u9019\u6a23\u4e00\u4f86\uff0c\u5f9e\u7b2c 3 \u9801\u958b\u59cb\uff0c\u7e3d\u5171\u6700\u591a\u53ef\u7372\u5f97 21\u500b \u7528\u6236\uff0820+1\uff09\u3002","title":"limitByPage \u65b9\u6cd5"},{"location":"entities-finders-repositories/#getquery","text":"\u7576\u4f60\u7b2c\u4e00\u6b21\u958b\u59cb\u4f7f\u7528 finder \u6642\uff0c\u5118\u7ba1\u5b83\u5f88\u76f4\u89c0\uff0c\u4f46\u4f60\u53ef\u80fd\u5076\u723e\u6703\u60f3\u77e5\u9053\u4f60\u662f\u5426\u6b63\u78ba\u5730\u4f7f\u7528\u4e86\u5b83\uff0c\u4ee5\u53ca\u5b83\u662f\u5426\u6703\u5efa\u7acb\u4f60\u671f\u671b\u7684\u67e5\u8a62\u3002 \u6211\u5011\u6709\u4e00\u500b\u540d\u70ba getQuery \u7684\u65b9\u6cd5\uff0c\u5b83\u53ef\u4ee5\u544a\u8a34\u6211\u5011\u76ee\u524d\u7684 finder \u7269\u4ef6\u5c07\u5efa\u7acb\u7684\u67e5\u8a62\u3002 \u4f8b\u5982\uff1a $finder = \\XF::finder('XF:User') ->where('user_id', 1); \\XF::dumpSimple($finder->getQuery()); \u9019\u5c07\u8f38\u51fa\u985e\u4f3c\u65bc\u4ee5\u4e0b\u7684\u8a9e\u53e5\uff1a string(67) \"SELECT `xf_user`.* FROM `xf_user` WHERE (`xf_user`.`user_id` = 1)\" \u4f60\u53ef\u80fd\u4e0d\u6703\u7d93\u5e38\u9700\u8981\u5b83\uff0c\u4f46\u5982\u679c finder \u6c92\u6709\u8fd4\u56de\u4f60\u6240\u671f\u671b\u7684\u7d50\u679c\uff0c\u90a3\u5b83\u53ef\u80fd\u6703\u5f88\u6709\u5e6b\u52a9\u3002 \u5728 Dump \u8b8a\u6578 \u90e8\u5206\u95b1\u8b80\u66f4\u591a\u95dc\u65bc dumpSimple \u65b9\u6cd5\u7684\u5167\u5bb9\u3002","title":"getQuery \u65b9\u6cd5"},{"location":"entities-finders-repositories/#finder_1","text":"\u5230\u76ee\u524d\u70ba\u6b62\uff0c\u6211\u5011\u5df2\u7d93\u770b\u5230 finder \u7269\u4ef6\u88ab\u8a2d\u5b9a\u4e86\u4e00\u500b\u985e\u4f3c\u65bc XF:User \u548c XF:Thread \u7684\u53c3\u6578\u3002 \u5728\u5927\u591a\u6578\u60c5\u6cc1\u4e0b\uff0c\u9019\u6a19\u8b58\u4e86 finder \u6b63\u5728\u8655\u7406\u7684 Entity \u985e\uff0c\u4e26\u5c07\u89e3\u6790\u70ba\uff0c\u4f8b\u5982\uff0c XF/Entity/User \u3002 \u7136\u800c\uff0c\u5b83\u4e5f\u53ef\u4ee5\u53e6\u5916\u4ee3\u8868\u4e00\u500b finder \u985e\u3002 finder \u985e\u662f\u53ef\u9078\u7684\uff0c\u4f46\u5b83\u5011\u53ef\u4ee5\u4f5c\u70ba\u4e00\u7a2e\u65b9\u6cd5\u4f86\u70ba\u7279\u5b9a\u7684 finder \u985e\u578b\u65b0\u589e\u81ea\u5b9a\u7fa9 finder \u65b9\u6cd5\u3002 \u70ba\u4e86\u770b\u5230\u9019\u4e00\u9ede\uff0c\u8b93\u6211\u5011\u770b\u770b\u8207 XF:User \u76f8\u95dc\u7684 finder \u985e\uff0c\u5b83\u53ef\u4ee5\u5728 XF\\FinderUser \u985e\u4e2d\u627e\u5230\u3002 \u4e0b\u9762\u793a\u4f8b\u662f\u8a72 class \u4e2d\u7684\u4e00\u500b finder \u65b9\u6cd5\uff1a public function isRecentlyActive($days = 180) { $this->where('last_activity', '>', time() - ($days * 86400)); return $this; } \u73fe\u5728\uff0c\u6211\u5011\u53ef\u4ee5\u5728\u4efb\u4f55 User finder \u7269\u4ef6\u4e0a\u547c\u53eb\u8a72\u65b9\u6cd5\u3002 \u6240\u4ee5\uff0c\u5982\u679c\u6211\u5011\u62ff\u524d\u9762\u7684\u4e00\u500b\u4f8b\u5b50\u4f86\u8aaa\uff1a $finder = \\XF::finder('XF:User'); $users = $finder->isRecentlyActive(20)->order('message_count', 'DESC')->limit(10); \u9019\u500b\u67e5\u8a62\uff0c\u4e4b\u524d\u53ea\u662f\u6309\u7167\u7559\u8a00\u6578\u964d\u5e8f\u8fd4\u56de 10 \u500b\u7528\u6236\uff0c\u73fe\u5728\u5c07\u6309\u9019\u500b\u9806\u5e8f\u8fd4\u56de\u6700\u8fd1 20 \u5929\u5167\u6d3b\u8e8d\u7684 10 \u500b\u7528\u6236\u3002 \u5118\u7ba1\u5c0d\u65bc\u5f88\u591a Entity \u985e\u578b\u4f86\u8aaa\uff0cfinder \u985e\u662f\u4e0d\u5b58\u5728\u7684\uff0c\u4f46\u4ecd\u7136\u53ef\u4ee5\u901a\u904e \u7e7c\u627f\u985e \u4e00\u7bc0\u4e2d\u63d0\u5230\u7684\u76f8\u540c\u65b9\u5f0f\u4f86\u7e7c\u627f\u9019\u4e9b\u4e0d\u5b58\u5728\u7684\u985e\u3002","title":"\u81ea\u5b9a\u7fa9 finder \u65b9\u6cd5"},{"location":"entities-finders-repositories/#the-entity-system","text":"\u5982\u679c\u60a8\u719f\u6089 XF1\uff0c\u60a8\u53ef\u80fd\u6703\u719f\u6089 Entity \u80cc\u5f8c\u7684\u4e00\u4e9b\u6982\u5ff5\uff0c\u56e0\u70ba\u5b83\u5011\u6700\u7d42\u662f\u5f9e\u90a3\u88e1\u7684 DataWriter \u7cfb\u7d71\u884d\u751f\u51fa\u4f86\u7684\u3002 \u5982\u679c\u60a8\u5c0d\u5b83\u5011\u4e0d\u662f\u5f88\u719f\u6089\uff0c\u4e0b\u9762\u7684\u90e8\u5206\u61c9\u8a72\u6703\u8b93\u60a8\u6709\u6240\u4e86\u89e3\u3002","title":"The Entity system (\u5be6\u9ad4\u7cfb\u7d71)"},{"location":"entities-finders-repositories/#entity-structure","text":"Structure \u7269\u4ef6\u7531\u4e00\u4e9b\u5c6c\u6027\u7d44\u6210\uff0c\u9019\u4e9b\u5c6c\u6027\u5b9a\u7fa9\u4e86 Entity \u7684 Structure \u548c\u5b83\u6240\u6d89\u53ca\u7684\u8cc7\u6599\u8868\u3002 Structure \u7269\u4ef6\u672c\u8eab\u5c31\u8a2d\u5b9a\u5728\u5b83\u6240\u6d89\u53ca\u7684 Entity \u5167\u90e8\u3002 \u6211\u5011\u4f86\u770b\u770b User Entity \u4e2d\u7684\u4e00\u4e9b\u5e38\u7528\u5c6c\u6027\uff1a","title":"Entity structure (\u5be6\u9ad4\u7d50\u69cb)"},{"location":"entities-finders-repositories/#table","text":"$structure->table = 'xf_user'; \u5b83\u8aaa\u660e\u4e86 Entity \u5728 Update \u548c Insert \u8a18\u9304\u6642\u4f7f\u7528\u54ea\u5f35\u8cc7\u6599\u8868\uff0c\u4e5f\u544a\u8a34\u6211\u5011 Finder \u5728\u69cb\u5efa\u67e5\u8a62\u57f7\u884c\u6642\u5f9e\u54ea\u5f35\u8cc7\u6599\u8868\u8b80\u53d6\u3002 \u6b64\u5916\uff0c\u5b83\u9084\u77e5\u9053\u4f60\u7684\u67e5\u8a62\u9700\u8981 join \u5230\u54ea\u4e9b\u5176\u4ed6\u8cc7\u6599\u8868\u4e2d\u8d77\u5230\u4e86\u4f5c\u7528\u3002","title":"Table (\u8cc7\u6599\u8868)"},{"location":"entities-finders-repositories/#short-name","text":"$structure->shortName = 'XF:User'; \u9019\u53ea\u662f Entity \u672c\u8eab\u548c Finder \u985e\uff08\u5982\u679c\u9069\u7528\uff09\u7684\u77ed\u985e\u540d\u3002","title":"Short name (\u7c21\u77ed\u540d)"},{"location":"entities-finders-repositories/#content-type","text":"$structure->contentType = 'user'; \u9019\u5b9a\u7fa9\u4e86\u9019\u500b Entity \u4ee3\u8868\u7684\u5167\u5bb9\u985e\u578b\u3002 \u5728\u5927\u591a\u6578 Entity \u7d50\u69cb\u4e2d\u4e0d\u6703\u9700\u8981\u9019\u500b\u3002 \u5b83\u7528\u65bc\u9023\u63a5\u5230 \"content type\" \u7cfb\u7d71\u4f7f\u7528\u7684\u7279\u5b9a\u4e8b\u7269\uff08\u9019\u5c07\u5728\u53e6\u4e00\u7bc0\u4e2d\u4ecb\u7d39\uff09\u3002","title":"Content type (\u5167\u5bb9\u985e\u578b)"},{"location":"entities-finders-repositories/#primary-key","text":"$structure->primaryKey = 'user_id'; \u5b9a\u7fa9\u4e86\u4ee3\u8868\u8cc7\u6599\u8868\u4e2d Primary key \u7684 Column\uff0c\u5982\u679c\u4e00\u500b\u8cc7\u6599\u8868\u652f\u63f4\u591a\u500b Column \u4f5c\u70ba Primary key\uff0c\u90a3\u9ebc\u53ef\u4ee5\u5b9a\u7fa9\u70ba\u9663\u5217\u3002","title":"Primary key (\u4e3b\u9375)"},{"location":"entities-finders-repositories/#columns","text":"$structure->columns = [ 'user_id' => ['type' => self::UINT, 'autoIncrement' => true, 'nullable' => true, 'changeLog' => false], 'username' => ['type' => self::STR, 'maxLength' => 50, 'required' => 'please_enter_valid_name' ] // \u9084\u6709\u66f4\u591a\u7684 columns... ]; \u9019\u662f Entity \u8a2d\u5b9a\u7684\u95dc\u9375\u90e8\u5206\uff0c\u56e0\u70ba\u9019\u88e1\u9762\u6703\u8a73\u7d30\u89e3\u91cb Entity \u8ca0\u8cac\u7684\u6bcf\u500b\u8cc7\u6599\u5eab column \u7684\u5177\u9ad4\u60c5\u6cc1\u3002 \u9019\u544a\u8a34\u6211\u5011\u9810\u671f\u7684\u8cc7\u6599\u985e\u578b\uff0c\u662f\u5426\u9700\u8981\u4e00\u500b\u503c\uff0c\u5b83\u61c9\u8a72\u5339\u914d\u4ec0\u9ebc\u683c\u5f0f\uff0c\u662f\u5426\u61c9\u8a72\u662f\u552f\u4e00\u503c\uff0c\u5b83\u7684\u9810\u8a2d\u503c\u662f\u4ec0\u9ebc\uff0c\u7b49\u7b49\u3002 \u6839\u64da type \uff0cEntity \u7ba1\u7406\u5668\u77e5\u9053\u662f\u5426\u4ee5\u67d0\u7a2e\u65b9\u5f0f\u5c0d\u4e00\u500b\u503c\u9032\u884c\u7de8\u78bc\u6216\u89e3\u78bc\u3002 \u9019\u53ef\u4ee5\u662f\u4e00\u500b\u7c21\u55ae\u7684\u904e\u7a0b\uff0c\u5c07\u4e00\u500b\u503c\u8f49\u63db\u70ba\u4e00\u500b\u5b57\u4e32\u6216\u6574\u6578\uff0c\u6216\u8005\u7a0d\u5fae\u8907\u96dc\u4e00\u9ede\uff0c\u4f8b\u5982\u5728\u5411\u8cc7\u6599\u5eab\u5beb\u5165\u6642\uff0c\u5c0d\u4e00\u500b\u9663\u5217\u4f7f\u7528 json_encode() \uff0c\u6216\u8005\u5728\u5f9e\u8cc7\u6599\u5eab\u8b80\u53d6\u6642\uff0c\u5c0d\u4e00\u500b JSON \u5b57\u4e32\u4f7f\u7528 json_decode() \uff0c\u4ee5\u4fbf\u5c07\u8a72\u503c\u4f5c\u70ba\u4e00\u500b\u9663\u5217\u6b63\u78ba\u5730\u8fd4\u56de\u7d66 Entity \u7269\u4ef6\uff0c\u800c\u4e0d\u9700\u8981\u6211\u5011\u624b\u52d5\u9019\u6a23\u505a\u3002 \u5b83\u9084\u53ef\u4ee5\u652f\u63f4\u5c0d\u9017\u865f\u5206\u9694\u7684\u503c\u9032\u884c\u9069\u7576\u7684\u7de8\u78bc/\u89e3\u78bc\u3002 \u5076\u723e\u9700\u8981\u5728\u5beb\u5165\u4e00\u500b\u503c\u4e4b\u524d\u5c0d\u5176\u9032\u884c\u4e00\u4e9b\u984d\u5916\u7684\u9a57\u8b49\u6216\u4fee\u6539\u3002 \u8209\u500b\u4f8b\u5b50\uff0c\u5728 User Entity \u4e2d\uff0c\u8acb\u770b verifyStyleId() \u65b9\u6cd5\u3002 \u7576\u5728 style_id \u6b04\u4f4d\u4e0a\u8a2d\u5b9a\u4e00\u500b\u503c\u6642\uff0c\u6211\u5011\u6703\u81ea\u52d5\u6aa2\u67e5\u662f\u5426\u5b58\u5728\u4e00\u500b\u540d\u70ba verifyStyleId() \u7684\u65b9\u6cd5\uff0c\u5982\u679c\u5b58\u5728\uff0c\u6211\u5011\u6703\u5148\u901a\u904e\u8a72\u65b9\u6cd5\u57f7\u884c\u8a72\u503c\u3002","title":"Columns (\u591a\u884c\u8cc7\u6599)"},{"location":"entities-finders-repositories/#behaviors","text":"$structure->behaviors = [ 'XF:ChangeLoggable' => [] ]; \u9019\u662f\u8a72 Entity \u61c9\u4f7f\u7528\u7684 Behaviors \u985e\u9663\u5217\u3002 Behaviors \u985e\u662f\u4e00\u7a2e\u5141\u8a31\u67d0\u4e9b\u7a0b\u5f0f\u78bc\u5728\u591a\u7a2e Entity \u985e\u578b\u4e2d\u901a\u7528\u91cd\u8907\u4f7f\u7528\u7684\u65b9\u5f0f\uff08\u50c5\u5728 Entity \u8b8a\u5316\u6642\uff0c\u800c\u4e0d\u662f\u5728\u8b80\u53d6\u6642\uff09\u3002 \u4e00\u500b\u5f88\u597d\u7684\u4f8b\u5b50\u662f XF:Likeable Behaviors\uff0c\u5b83\u80fd\u5920\u5c0d\u652f\u63f4\u53ef\u88ab \"\u9ede\u8b9a\" \u7684\u5167\u5bb9\u5be6\u9ad4\u81ea\u52d5\u57f7\u884c\u67d0\u4e9b\u64cd\u4f5c\u3002 \u9019\u5305\u62ec\u7576\u5167\u5bb9\u4e2d\u767c\u751f\u53ef\u898b\u6027\u8b8a\u5316\u6642\u81ea\u52d5\u91cd\u65b0\u8a08\u6578\uff0c\u4ee5\u53ca\u7576\u5167\u5bb9\u88ab\u522a\u9664\u6642\u81ea\u52d5\u522a\u9664\u9ede\u8b9a\u6578\u3002","title":"Behaviors (\u884c\u70ba)"},{"location":"entities-finders-repositories/#getters","text":"$structure->getters = [ 'is_super_admin' => true, 'last_activity' => true ]; \u7576\u547c\u53eb name \u6b04\u4f4d\u6642\uff0c\u6703\u81ea\u52d5\u547c\u53eb Getter \u65b9\u6cd5\u3002 \u4f8b\u5982\uff0c\u5982\u679c\u6211\u5011\u5f9e User Entity \u4e2d\u8acb\u6c42 is_super_admin \uff0c\u5c31\u6703\u81ea\u52d5\u6aa2\u67e5\u4e26\u4f7f\u7528 getIsSuperAdmin() \u65b9\u6cd5\u3002 \u6709\u8da3\u7684\u662f\uff0cxf_user \u8cc7\u6599\u8868\u5be6\u969b\u4e0a\u4e26\u6c92\u6709\u4e00\u500b\u540d\u70ba is_super_admin \u7684\u6b04\u4f4d\u3002 \u9019\u500b\u6b04\u4f4d\u5be6\u969b\u4e0a\u5b58\u5728\u65bc Admin Entity \u4e2d\uff0c\u4f46\u6211\u5011\u5c07\u5176\u4f5c\u70ba\u4e00\u500b getter \u65b9\u6cd5\u65b0\u589e\u5230\u4e86\u8cc7\u6599\u8868\u4e2d\uff0c\u4f5c\u70ba\u8a2a\u554f\u8a72\u503c\u7684\u4e00\u7a2e\u7c21\u5beb\u65b9\u5f0f\u3002 Getter \u65b9\u6cd5\u4e5f\u53ef\u4ee5\u7528\u4f86\u76f4\u63a5\u8986\u84cb\u73fe\u6709\u6b04\u4f4d\u7684\u503c\uff0c\u9019\u88e1\u7684 last_activity \u503c\u5c31\u662f\u5982\u6b64\u3002 last_activity \u5be6\u969b\u4e0a\u662f\u4e00\u500b\u5feb\u53d6\u503c\uff0c\u901a\u5e38\u5728\u7528\u6236\u767b\u51fa\u6642\u624d\u6703\u66f4\u65b0\u3002 \u7136\u800c\uff0c\u6211\u5011\u5728 xf_session_activity \u8cc7\u6599\u8868\u4e2d\u5132\u5b58\u4e86\u7528\u6236\u6700\u65b0\u7684\u6d3b\u52d5\u65e5\u671f\uff0c\u6240\u4ee5\u6211\u5011\u53ef\u4ee5\u4f7f\u7528 getLastActivity \u65b9\u6cd5\u4f86\u8fd4\u56de\u8a72\u503c\u800c\u4e0d\u662f\u5feb\u53d6\u7684\u6700\u5f8c\u6d3b\u52d5\u503c\u3002 \u5982\u679c\u4f60\u9700\u8981\u5b8c\u5168\u7e5e\u904e getter \u65b9\u6cd5\uff0c\u53ea\u9700\u8981\u5f97\u5230\u771f\u6b63\u7684 Entity \u503c\uff0c\u53ea\u9700\u8981\u5728 column \u540d\u5f8c\u52a0\u4e0a\u4e0b\u5283\u7dda\uff0c\u4f8b\u5982 $user->last_activity_ \u3002 \u56e0\u70ba\u4e00\u500b Entity \u5c31\u50cf\u5176\u4ed6\u7684 PHP \u7269\u4ef6\u4e00\u6a23\uff0c\u4f60\u53ef\u4ee5\u7d66\u5b83\u5011\u65b0\u589e\u66f4\u591a\u7684\u65b9\u6cd5\u3002 \u4e00\u500b\u5e38\u898b\u7684\u4f7f\u7528\u6848\u4f8b\u662f\u65b0\u589e\u4e00\u4e9b\u50cf\u6b0a\u9650\u6aa2\u67e5\u9019\u6a23\u7684\u65b9\u6cd5\uff0c\u9019\u4e9b\u65b9\u6cd5\u53ef\u4ee5\u5728 Entity \u81ea\u8eab\u4e0a\u9762\u547c\u53eb\u3002","title":"Getters (\u7372\u53d6\u5668)"},{"location":"entities-finders-repositories/#relations","text":"$structure->relations = [ 'Admin' => [ 'entity' => 'XF:Admin', 'type' => self::TO_ONE, 'conditions' => 'user_id', 'primary' => true ] ]; \u9019\u5c31\u662f Relations \u7684\u5b9a\u7fa9\u3002 \u4ec0\u9ebc\u662f Relations\uff1f \u5b83\u5011\u5b9a\u7fa9\u4e86 Entity \u4e4b\u9593\u7684\u95dc\u806f\uff0c\u9019\u4e9b\u95dc\u806f\u53ef\u4ee5\u88ab\u7528\u4f86\u5c0d\u5176\u4ed6\u8cc7\u6599\u8868\u57f7\u884c join \u67e5\u8a62\uff0c\u6216\u8005\u5feb\u901f\u7372\u53d6\u8207 Entity \u76f8\u95dc\u7684\u8a18\u9304\u3002 \u5982\u679c\u6211\u5011\u9084\u8a18\u5f97 finder \u4e2d\u7684 with \u65b9\u6cd5\uff0c\u5047\u5982\u6211\u5011\u60f3\u7372\u53d6\u4e00\u500b\u7279\u5b9a\u7684\u7528\u6236\uff0c\u4e26\u9810\u5148\u7372\u53d6\u8a72\u7528\u6236\u7684 Admin \u8a18\u9304\uff08\u5982\u679c\u5b83\u5b58\u5728\u7684\u8a71\uff09\uff0c\u90a3\u9ebc\u6211\u5011\u5c07\u505a\u5982\u4e0b\u64cd\u4f5c\uff1a $finder = \\XF::finder('XF:User'); $user = $finder->where('user_id', 1)->with('Admin')->fetchOne(); \u9019\u5c07\u4f7f\u7528 User Entity \u4e2d\u5b9a\u7fa9\u7684 Admin \u76f8\u95dc\u7684\u8cc7\u8a0a\u548c XF:Admin Entity Structure \u7684\u7d30\u7bc0\uff0c\u77e5\u9053\u9019\u500b\u7528\u6236\u67e5\u8a62\u61c9\u8a72\u5728 xf_admin \u8cc7\u6599\u8868\u548c user_id column \u4e0a\u57f7\u884c LEFT JOIN \u3002 \u8981\u5f9e User Entity \u4e2d\u7372\u53d6 Admin \u6700\u5f8c\u767b\u9304\u65e5\u671f\uff0c\u8acb\u57f7\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a $lastLogin = $user->Admin->last_login; // \u8fd4\u56de\u6700\u5f8c\u4e00\u6b21 Admin \u767b\u9304\u7684\u6642\u9593\u6233 \u7136\u800c\uff0c\u4e26\u4e0d\u7e3d\u662f\u9700\u8981\u5728 finder \u4e2d\u9032\u884c join \u4f86\u7372\u53d6 Entity \u7684\u76f8\u95dc\u8cc7\u8a0a\u3002 \u4f8b\u5982\uff0c\u5982\u679c\u6211\u5011\u4ee5\u4e0a\u9762\u7684\u4f8b\u5b50\u70ba\u4f8b\uff0c\u4e0d\u547c\u53eb with \u65b9\u6cd5\uff1a $finder = \\XF::finder('XF:User'); $user = $finder->where('user_id', 1)->fetchOne(); $lastLogin = $user->Admin->last_login; // \u8fd4\u56de\u6700\u5f8c\u4e00\u6b21 Admin \u767b\u9304\u7684\u6642\u9593\u6233 \u6211\u5011\u5728\u9019\u88e1\u4ecd\u7136\u5f97\u5230 last_login \u503c\u3002 \u5b83\u662f\u901a\u904e\u57f7\u884c\u984d\u5916\u7684\u67e5\u8a62\u4f86\u5feb\u901f\u7372\u53d6 Admin Entity \u7684\u3002 \u4e0a\u9762\u7684\u4f8b\u5b50\u4f7f\u7528\u4e86 TO_ONE \u985e\u578b\uff0c\u56e0\u6b64\uff0c\u9019\u7a2e\u95dc\u806f\u5c07\u4e00\u500b Entity \u8207\u53e6\u4e00\u500b Entity \u806f\u7e6b\u8d77\u4f86\u3002 \u6211\u5011\u9084\u6709\u4e00\u500b TO_MANY \u985e\u578b\u3002 \u5b83\u4e0d\u53ef\u80fd\u7372\u53d6\u6574\u500b TO_MANY \u95dc\u806f\uff08\u4f8b\u5982\u5728 finder \u4e0a\u4f7f\u7528 join / with \u65b9\u6cd5\uff09\uff0c\u4f46\u4ee5\u67e5\u8a62\u70ba\u4ee3\u50f9\uff0c\u5b83\u53ef\u4ee5\u5728\u4efb\u4f55\u6642\u5019\u5feb\u901f\u8b80\u53d6\uff0c\u4f8b\u5982\u5728\u4e0a\u9762\u6700\u5f8c\u7684 last_login \u4f8b\u5b50\u4e2d\u3002 \u5728 User Entity \u4e0a\u5b9a\u7fa9\u7684\u4e00\u500b\u9019\u6a23\u7684 Relation \u662f ConnectedAccounts \u95dc\u806f\uff1a $structure->relations = [ 'ConnectedAccounts' => [ 'entity' => 'XF:UserConnectedAccount', 'type' => self::TO_MANY, 'conditions' => 'user_id', 'key' => 'provider' ] ]; \u9019\u500b relation \u80fd\u5920\u5f9e xf_user_connected_account \u8cc7\u6599\u8868\u4e2d\u8fd4\u56de\u8207\u76ee\u524d\u7528\u6236 ID \u76f8\u5339\u914d\u7684\u8a18\u9304\uff0c\u4f5c\u70ba\u4e00\u500b FinderCollection \u3002 \u9019\u985e\u4f3c\u65bc\u6211\u5011\u5728\u4e0a\u9762 Finder \u90e8\u5206\u63d0\u5230\u7684 ArrayCollection \u7269\u4ef6\u3002 \u5728 Relation \u5b9a\u7fa9\u4e2d\uff0c\u6307\u5b9a\u8a72\u96c6\u5408\u61c9\u8a72\u7531 provider \u6b04\u4f4d\u4f5c\u70ba key\u3002 \u96d6\u7136\u5728\u57f7\u884c finder \u67e5\u8a62\u6642\u4e0d\u53ef\u80fd\u7372\u53d6\u591a\u689d\u8a18\u9304\uff0c\u4f46\u53ef\u4ee5\u4f7f\u7528 TO_MANY \u95dc\u806f\u5f9e\u8a72 Relation \u4e2d\u7372\u53d6 \u55ae\u500b \u8a18\u9304\u3002 \u8209\u500b\u4f8b\u5b50\uff0c\u5982\u679c\u6211\u5011\u60f3\u67e5\u770b\u7528\u6236\u662f\u5426\u8207\u7279\u5b9a\u7684\u95dc\u806f\u5e33\u6236\u63d0\u4f9b\u5546\u76f8\u95dc\u806f\uff0c\u6211\u5011\u81f3\u5c11\u53ef\u4ee5\u5728\u67e5\u8a62\u6642\u7372\u53d6\u8a72\u8a18\u9304\uff1a $finder = \\XF::finder('XF:User'); $user = $finder->where('user_id', 1)->with('ConnectedAccounts|facebook')->fetchOne();","title":"Relations (\u95dc\u806f)"},{"location":"entities-finders-repositories/#options","text":"$structure->options = [ 'custom_title_disallowed' => preg_split('/\\r?\\n/', $options->disallowedCustomTitles), 'admin_edit' => false, 'skip_email_confirm' => false ]; Entity Option \u662f\u5728\u67d0\u4e9b\u689d\u4ef6\u4e0b\u4fee\u6539 Entity Behavior \u7684\u4e00\u7a2e\u65b9\u5f0f\u3002 \u4f8b\u5982\uff0c\u5982\u679c\u6211\u5011\u5c07 admin_edit \u8a2d\u5b9a\u70ba true\uff08\u5728 Admin CP \u4e2d\u7de8\u8f2f\u7528\u6236\u6642\u5c31\u662f\u5982\u6b64\uff09\uff0c\u90a3\u9ebc\u67d0\u4e9b\u6aa2\u67e5\u5c07\u88ab\u8df3\u904e\uff0c\u4f8b\u5982\u5141\u8a31\u7528\u6236\u7684\u96fb\u5b50\u90f5\u4ef6\u5730\u5740\u70ba\u7a7a\u3002","title":"Options (\u9078\u9805)"},{"location":"entities-finders-repositories/#entity","text":"Entity \u5728\u7ba1\u7406\u8cc7\u6599\u5eab\u5167\u8a18\u9304\u7684\u751f\u547d\u9031\u671f\u65b9\u9762\u626e\u6f14\u8457\u91cd\u8981\u89d2\u8272\u3002 \u9664\u4e86\u5f9e\u5b83\u90a3\u88e1\u8b80\u53d6\u503c\uff0c\u5411\u5b83\u5beb\u5165\u503c\u4e4b\u5916\uff0cEntity \u9084\u53ef\u4ee5\u7528\u4f86\u522a\u9664\u8a18\u9304\uff0c\u4e26\u5728\u6240\u6709\u9019\u4e9b\u64cd\u4f5c\u767c\u751f\u6642\u89f8\u767c\u67d0\u4e9b\u4e8b\u4ef6\uff0c\u5f9e\u800c\u53ef\u4ee5\u57f7\u884c\u67d0\u4e9b\u4efb\u52d9\uff0c\u6216\u8005\u4e5f\u53ef\u4ee5\u66f4\u65b0\u67d0\u4e9b\u76f8\u95dc\u8a18\u9304\u3002 \u8b93\u6211\u5011\u4f86\u770b\u770b Entity \u5728\u5132\u5b58\u6642\u767c\u751f\u7684\u4e00\u4e9b\u4e8b\u4ef6\uff1a _preSave() - \u5728\u5132\u5b58\u904e\u7a0b\u958b\u59cb\u4e4b\u524d\u767c\u751f\uff0c\u4e3b\u8981\u7528\u65bc\u57f7\u884c\u4efb\u4f55\u5176\u4ed6\u5132\u5b58\u524d\u7684\u9a57\u8b49\u6216\u5728\u5132\u5b58\u767c\u751f\u4e4b\u524d\u8a2d\u5b9a\u5176\u4ed6\u8cc7\u6599\u3002 _postSave() - \u5728\u8cc7\u6599\u88ab\u5132\u5b58\u5f8c\uff0c\u4f46\u5728\u4efb\u4f55\u4ea4\u6613\u88ab\u63d0\u4ea4\u4e4b\u524d\uff0c\u5c07\u547c\u53eb\u6b64\u65b9\u6cd5\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528\u6b64\u65b9\u6cd5\u4f86\u57f7\u884c Entity \u88ab\u5132\u5b58\u5f8c\u61c9\u89f8\u767c\u7684\u4efb\u4f55\u5176\u4ed6\u4e8b\u3002 \u53e6\u5916\u9084\u6709 _preDelete() \u548c _postDelete() \uff0c\u5b83\u5011\u7684\u904b\u4f5c\u65b9\u5f0f\u985e\u4f3c\uff0c\u4f46\u5728\u522a\u9664\u767c\u751f\u6642\u3002 Entity \u9084\u80fd\u5920\u63d0\u4f9b\u6709\u95dc\u5b83\u76ee\u524d\u72c0\u614b\u7684\u8cc7\u8a0a\u3002 \u4f8b\u5982\uff0c\u6709\u4e00\u500b isInsert() \u548c isUpdate() \u65b9\u6cd5\uff0c\u9019\u6a23\u4f60\u5c31\u53ef\u4ee5\u6aa2\u6e2c\u5230\u9019\u662f\u4e00\u500b\u65b0\u8a18\u9304\u88ab\u63d2\u5165\u9084\u662f\u4e00\u500b\u73fe\u6709\u8a18\u9304\u88ab\u66f4\u65b0\u3002 \u9084\u6709\u4e00\u500b isChanged() \u65b9\u6cd5\uff0c\u53ef\u4ee5\u544a\u8a34\u4f60\u81ea\u4e0a\u6b21\u5132\u5b58\u5f8c\uff0c\u67d0\u500b\u7279\u5b9a\u6b04\u4f4d\u662f\u5426\u767c\u751f\u4e86\u8b8a\u5316\u3002 \u8b93\u6211\u5011\u770b\u770b\u9019\u4e9b\u65b9\u6cd5\u5728 User Entity \u4e2d\u7684\u4e00\u4e9b\u5be6\u969b\u4f8b\u5b50\u3002 protected function _preSave() { if ($this->isChanged('user_group_id') || $this->isChanged('secondary_group_ids')) { $groupRepo = $this->getUserGroupRepo(); $this->display_style_group_id = $groupRepo->getDisplayGroupIdForUser($this); } // ... } protected function _postSave() { // ... if ($this->isUpdate() && $this->isChanged('username') && $this->getExistingValue('username') != null) { $this->app()->jobManager()->enqueue('XF:UserRenameCleanUp', [ 'originalUserId' => $this->user_id, 'originalUserName' => $this->getExistingValue('username'), 'newUserName' => $this->username ]); } // ... \u5728 _preSave() \u7684\u4f8b\u5b50\u4e2d\uff0c\u6211\u5011\u6839\u64da\u7528\u6236\u6539\u8b8a\u5f8c\u7684\u7528\u6236\u7d44\u4f86\u7372\u53d6\u4e26\u5feb\u53d6\u65b0\u7684\u986f\u793a Group ID\u3002 \u5728 _postSave() \u7684\u4f8b\u5b50\u4e2d\uff0c\u6211\u5011\u5728\u7528\u6236\u7684\u540d\u5b57\u88ab\u66f4\u6539\u5f8c\u89f8\u767c\u4e00\u500b\u4f5c\u696d\u4f86\u57f7\u884c\u3002","title":"Entity \u751f\u547d\u9031\u671f"},{"location":"entities-finders-repositories/#repository","text":"\u5c0d\u65bc XF2 \u4f86\u8aaa\uff0cRepository \u662f\u4e00\u500b\u65b0\u7684\u6982\u5ff5\uff0c\u4f46\u662f\u5982\u679c\u628a\u5b83\u5011\u8207 XF1 \u4e2d\u7684 \"Model\" \u7269\u4ef6\u9032\u884c\u6bd4\u8f03\uff0c\u4f60\u53ef\u80fd\u4e0d\u6703\u53d7\u5230\u6307\u8cac\u3002 \u6211\u5011\u5728 XF2 \u4e2d\u6c92\u6709 Model \u7269\u4ef6\uff0c\u56e0\u70ba\u6211\u5011\u6709\u66f4\u597d\u7684\u5730\u65b9\u548c\u65b9\u6cd5\u4f86\u7372\u53d6\u548c\u5beb\u5165\u8cc7\u6599\u5230\u8cc7\u6599\u5eab\u3002 \u6240\u4ee5\uff0c\u8207\u5176\u8aaa\u6211\u5011\u6709\u4e00\u500b\u9f90\u5927\u7684 class\uff0c\u5176\u4e2d\u5305\u542b\u4e86\u4f60\u7684\u9644\u52a0\u5143\u4ef6\u6240\u9700\u8981\u7684\u6240\u6709\u67e5\u8a62\uff0c\u4ee5\u53ca\u5404\u7a2e\u4e0d\u540c\u7684\u65b9\u6cd5\u4f86\u64cd\u4f5c\u9019\u4e9b\u67e5\u8a62\uff0c\u4e0d\u5982\u8aaa\u6211\u5011\u6709 finder\uff0c\u5b83\u589e\u52a0\u4e86\u66f4\u591a\u7684\u5f48\u6027\u3002 \u53e6\u5916\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0c\u5728 XF1 \u4e2d\uff0cModel \u7269\u4ef6\u5c0d\u65bc\u8a31\u591a\u6771\u897f\u4f86\u8aaa\u6709\u9ede\u50cf \"dumping ground\"\u3002 \u5176\u4e2d\u5f88\u591a\u6771\u897f\u73fe\u5728\u90fd\u662f\u591a\u9918\u7684\u3002 \u4f8b\u5982\uff0c\u5728 XF1 \u4e2d\uff0c\u6240\u6709\u7684\u6b0a\u9650\u91cd\u5efa\u7a0b\u5f0f\u78bc\u90fd\u5728\u6b0a\u9650 Model \u4e2d\u3002 \u5728 XF2 \u4e2d\uff0c\u6211\u5011\u6709\u7279\u5b9a\u7684\u670d\u52d9\u548c\u7269\u4ef6\u4f86\u8655\u7406\u9019\u500b\u554f\u984c\u3002 \u90a3\u9ebc\uff0c\u4ec0\u9ebc\u662f Repository \u5462\uff1f \u5b83\u5011\u5c0d\u61c9\u8457\u4e00\u500b Entity \u548c\u4e00\u500b Finder\uff0c\u4e26\u6301\u6709\u65b9\u6cd5\uff0c\u4e00\u822c\u6703\u8fd4\u56de\u4e00\u500b\u70ba\u7279\u5b9a\u76ee\u7684\u8a2d\u5b9a\u7684 Finder \u7269\u4ef6\u3002 \u70ba\u4ec0\u9ebc\u4e0d\u76f4\u63a5\u8fd4\u56de Finder \u67e5\u8a62\u7684\u7d50\u679c\u5462\uff1f \u597d\u5427\uff0c\u5982\u679c\u6211\u5011\u8fd4\u56de Finder \u7269\u4ef6\u672c\u8eab\uff0c\u90a3\u9ebc\u5b83\u53ef\u4ee5\u4f5c\u70ba\u4e00\u500b\u6709\u7528\u7684\u7e7c\u627f\u9ede\uff0c\u8b93\u9644\u52a0\u5143\u4ef6\u5728 Entity \u6216\u96c6\u5408\u8fd4\u56de\u4e4b\u524d\uff0c\u5c0d\u5176\u9032\u884c\u7e7c\u627f\u4e26\u4fee\u6539 Finder \u7269\u4ef6\u3002 Repository \u4e5f\u53ef\u4ee5\u5305\u542b\u4e00\u4e9b\u5177\u9ad4\u7684\u65b9\u6cd5\uff0c\u6bd4\u5982\u5feb\u53d6\u91cd\u5efa\u3002","title":"Repository (\u5132\u5b58\u5eab)"},{"location":"general-concepts/","text":"\u901a\u7528\u6982\u5ff5 \u00b6 \u4ee5\u4e0b\u90e8\u5206\u5c07\u8a73\u7d30\u4ecb\u7d39\u958b\u767c XenForo \u9644\u52a0\u5143\u4ef6\u6642\u5c07\u6703\u9047\u5230\u7684\u4e00\u4e9b\u901a\u7528\u7cfb\u7d71\u548c\u6982\u5ff5\u3002 \u5982\u679c\u60a8\u719f\u6089 XenForo 1.x \u7684\u958b\u767c\uff0c\u90a3\u9ebc\u9019\u4e9b\u6982\u5ff5\u4e2d\u7684\u5f88\u591a\u5167\u5bb9\u60a8\u90fd\u6703\u89ba\u5f97\u5f88\u719f\u6089\uff0c\u4e0d\u904e\u503c\u5f97\u56de\u9867\u4e00\u4e0b\uff0c\u56e0\u70ba\u6709\u4e00\u4e9b\u512a\u79c0\u7684\u65b0\u5de5\u5177\u548c\u529f\u80fd\u53ef\u4ee5\u5e6b\u52a9\u60a8\u958b\u767c\u9644\u52a0\u5143\u4ef6\u3002 Vendor \u5143\u4ef6 \u00b6 XF2 \u4e26\u4e0d\u50cf XF1 \u90a3\u6a23\u7531\u4e00\u500b\u7279\u5b9a\u7684\u6846\u67b6\u4f86\u9a45\u52d5\uff0c\u7136\u800c\uff0c\u6211\u5011\u4f7f\u7528\u4e86\u67d0\u4e9b\u6d41\u884c\u7684\u3001\u7d93\u904e\u826f\u597d\u6e2c\u8a66\u7684\u3001\u958b\u6e90\u7684\u8edf\u9ad4\u5305\u4f86\u5e6b\u52a9\u5b8c\u6210\u7279\u5b9a\u7684\u4efb\u52d9\u3002 \u4f8b\u5982\uff0c\u6211\u5011\u4f7f\u7528\u4e00\u500b\u540d\u70ba SwiftMailer \u7684\u9805\u76ee\u4f86\u767c\u9001\u96fb\u5b50\u90f5\u4ef6\uff0c\u4ee5\u53ca\u4e00\u500b\u540d\u70ba Guzzle \u7684\u9805\u76ee\u4f5c\u70ba HTTP \u5ba2\u6236\u7aef\u3002 \u6240\u6709\u7684\u7b2c\u4e09\u65b9\u9805\u76ee\u90fd\u662f\u5f9e src/vendor \u76ee\u9304\u4e0b\u8f09\u5165\u7684\u3002 \u76ee\u524d\uff0c\u9644\u52a0\u5143\u4ef6\u958b\u767c\u8005\u9084\u4e0d\u80fd\u5c07\u81ea\u5df1\u7684\u4f9d\u8cf4\u95dc\u4fc2\u6dfb\u52a0\u5230\u9019\u500b\u4f4d\u7f6e\u3002 \u6574\u5408\u958b\u767c\u74b0\u5883 (IDE) \u00b6 \u5728\u958b\u59cb XF2 \u958b\u767c\u5de5\u4f5c\u4e4b\u524d\uff0c\u4f60\u53ef\u80fd\u9700\u8981\u82b1\u4e00\u4e9b\u6642\u9593\u4f86\u8a55\u4f30\u4f60\u5c07\u5be6\u969b\u5efa\u7acb\u548c\u7de8\u8f2f PHP \u6a94\u6848\u7684\u61c9\u7528\u7a0b\u5f0f\u3002 \u9019\u901a\u5e38\u88ab\u7a31\u70ba IDE\u3002 \u6709\u8a31\u591a\u53ef\u7528\u7684\u9078\u9805\uff0c\u5f9e\u57fa\u672c\u7684\u8a18\u4e8b\u672c\u5230\u50cf Sublime Text \u9019\u6a23\u53ef\u4ee5\u901a\u904e\u9644\u52a0\u5143\u4ef6\u64f4\u5c55\u4ee5\u7372\u5f97\u66f4\u597d\u7684 PHP \u652f\u6301\u7684\u6771\u897f\uff0c\u76f4\u5230\u4e00\u500b\u5408\u9069\u7684 IDE\uff0c\u5982 PhpStorm \u3002 \u5728\u5167\u90e8\uff0c\u6211\u5011\u4f7f\u7528 PhpStorm \u4f5c\u70ba\u6211\u5011\u7684\u9996\u9078 IDE\u3002 \u9019\u662f\u4e00\u500b\u9ad8\u7d1a\u7684\u5546\u696d\u7522\u54c1\uff0c\u4f46\u4e5f\u6709\u53ef\u80fd\u662f\u514d\u8cbb\u7684\u3002 \u7121\u8ad6\u54ea\u7a2e\u65b9\u5f0f\uff0c\u6c92\u6709\u4eba\u80fd\u544a\u8a34\u4f60\u6700\u7b26\u5408\u60a8\u9700\u6c42\u7684\u6700\u4f73\u61c9\u7528\u7a0b\u5e8f\u662f\u54ea\u500b\uff0c\u4f60\u61c9\u8a72\u82b1\u4e9b\u6642\u9593\u591a\u4f7f\u7528\u4e00\u4e9b\u7522\u54c1\uff08\u751a\u81f3\u662f\u514d\u8cbb\u7684\uff09\uff0c\u4e26\u4f7f\u7528\u9019\u4e9b\u7d93\u9a57\u4f86\u627e\u51fa\u4f60\u7684\u559c\u597d\u3002 \u81ea\u52d5\u8f09\u5165\u5668 \u00b6 XF2 \u4f7f\u7528\u4e00\u500b\u7531 Composer \u81ea\u52d5\u7522\u751f\u7684\u81ea\u52d5\u8f09\u5165\u5668\u3002 \u9019\u5141\u8a31\u6240\u6709\u7684 XF \u7a0b\u5f0f\u78bc\u3001\u7b2c\u4e09\u65b9\u4f9b\u61c9\u5546\u7a0b\u5f0f\u78bc\uff0c\u4ee5\u53ca\u4efb\u4f55\u9644\u52a0\u5143\u4ef6\u7684\u958b\u767c\u8005\u7a0b\u5f0f\u78bc\u5728\u6574\u500b\u9805\u76ee\u4e2d\u81ea\u52d5\u5305\u542b\u9032\u53bb\uff0c\u800c\u4e0d\u9700\u8981\u624b\u52d5 include/require \u4f60\u7684 class\u3002 \u6240\u6709 XF \u9644\u52a0\u5143\u4ef6\u7684\u81ea\u52d5\u8f09\u5165\u6839\u76ee\u9304\u662f src/addons \u76ee\u9304\u3002 \u9019\u610f\u5473\u8457\u4f60\u6240\u6709\u7684 class \u540d\u90fd\u6703\u76f8\u5c0d\u65bc\u9019\u500b\u57fa\u790e\u4f4d\u7f6e\u3002 \u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0cXF2 \u63a1\u7528\u4e86\u56b4\u683c\u7684 \"\u6bcf\u500b\u6a94\u6848\u4e00\u500b\u985e\" \u7684\u547d\u540d\u6a21\u5f0f\u3002 \u6bcf\u500b\u6a94\u6848\u61c9\u8a72\u53ea\u5305\u542b\u4e00\u500b\u985e\uff0c\u800c\u4e14\u9019\u500b\u985e\u7684\u540d\u5b57\u61c9\u8a72\u78ba\u5b9a\u8a72\u985e\u7684 PHP \u6a94\u6848\u5728\u6a94\u6848\u7cfb\u7d71\u4e2d\u7684\u78ba\u5207\u4f4d\u7f6e\u3002 \u4f8b\u5982\uff0c\u5982\u679c\u4f60\u60f3\u5728\u4e00\u500b\u540d\u70ba src/addons/Demo/Setup.php \u7684\u6a94\u6848\u4e2d\u5efa\u7acb\u4e00\u500b\u65b0\u7684 class\uff08\u5176\u4e2d Demo \u662f\u4f60\u7684 \u9644\u52a0\u5143\u4ef6 ID\uff09\uff0c\u90a3\u9ebc\u9019\u500b class \u5c07\u88ab\u547d\u540d\u70ba Demo\\Setup \u3002 \u76f8\u53cd\uff0c\u5982\u679c\u4f60\u6709\u4e00\u500b\u540d\u70ba Demo\\Entity\\Thing \u7684 class\uff0c\u90a3\u9ebc\u4f60\u6703\u77e5\u9053\u9019\u500b class \u7684\u6a94\u6848\u4f4d\u65bc\u8def\u5f91 src/addons/Demo/Entity/Thing.php \u4e2d\u3002 \u547d\u540d\u7a7a\u9593 \u00b6 \u5728\u6574\u500b XF \u4e2d\uff0c\u6211\u5011\u4f7f\u7528\u4e86 \u547d\u540d\u7a7a\u9593 \uff0c\u9019\u6a23\u6211\u5011\u53ef\u4ee5\u66f4\u7c21\u6f54\u5730\u53c3\u8003\u540c\u4e00\u540d\u7a31\u7a7a\u9593\u4e2d\u7684\u985e\u3002\u5efa\u8b70\u6240\u6709\u7684\u9644\u52a0\u5143\u4ef6\u4e5f\u4f7f\u7528\u540d\u7a31\u7a7a\u9593\u3002 \u5728\u4e0a\u9762\u7684\u4f8b\u5b50\u4e2d\uff0c\u6211\u5011\u8ac7\u5230\u4e86\u4e00\u500b\u540d\u70ba Demo\\Setup \u7684\u985e\u3002 \u4f7f\u7528\u547d\u540d\u7a7a\u9593\uff0c\u9019\u500b\u985e\u5be6\u969b\u4e0a\u6703\u88ab\u7c21\u55ae\u5730\u547d\u540d\u70ba Setup \uff0c\u4f46\u547d\u540d\u7a7a\u9593\u6703\u88ab\u8a2d\u5b9a\u70ba Demo \u3002 \u4f5c\u70ba\u4e00\u500b\u66f4\u5177\u9ad4\u7684\u4f8b\u5b50\uff0c\u6211\u5011\u5728\u4e0a\u9762\u4e5f\u8ac7\u5230\u4e86\u4e00\u500b\u540d\u70ba Demo\\Entity\\Thing \u7684\u985e\u3002 \u8b93\u6211\u5011\u4f86\u770b\u770b\u9019\u500b\u985e\u7684 PHP \u7a0b\u5f0f\u78bc\u662f\u4ec0\u9ebc\u6a23\u5b50\u7684\uff1a <?php namespace Demo\\Entity; class Thing { } \u5982\u679c\u5728 src/addons/Demo/Entity \u76ee\u9304\u4e0b\u6709\u4e00\u500b\u540d\u70ba AnotherThing \u7684 class\uff0c\u6211\u5011\u53ef\u4ee5\u5728 Thing class \u4e2d\u7c21\u55ae\u5730\u5c07\u9019\u500b class \u5f15\u7528\u70ba AnotherThing \uff0c\u56e0\u70ba\u9019\u500b class \u5728\u540c\u4e00\u500b Demo\\Entity \u547d\u540d\u7a7a\u9593\u4e2d\u3002 \u77ed\u985e\u540d \u00b6 \u5076\u723e\uff0cXF \u4e2d\u53c3\u8003\u7684 class \u6703\u88ab\u7e2e\u77ed\u3002 \u4f8b\u5982\uff0c\u5982\u679c\u60a8\u5e0c\u671b\u547c\u53eb User \u5be6\u9ad4\uff08\u66f4\u591a\u95dc\u65bc\u5be6\u9ad4\u7684\u5167\u5bb9\u898b\u4e0b\u6587\uff09\uff0c\u90a3\u9ebc\u60a8\u53ef\u80fd\u6703\u770b\u5230\u88ab\u5f15\u7528\u7684 class \u540d\u53ea\u662f XF:User \u3002 \u77ed\u985e\u540d\u7684\u4f7f\u7528\u548c\u5b83\u5011\u6240\u89e3\u6790\u7684\u5168\u985e\u540d\uff0c\u5b8c\u5168\u662f\u4f9d\u7167 context sensitive \u7684\u3002 \u56e0\u6b64\uff0c\u5728\u547c\u53eb\u5be6\u9ad4\u7684 context \u4e2d\uff0c\u77ed\u985e\u540d\u5c07\u89e3\u6790\u70ba\u4ee5\u4e0b\u5168\u985e\u540d XF/Entity/User \u3002 XF \u90e8\u5206\u8868\u793a\u6a94\u6848\u8def\u5f91 (\u57fa\u65bc\u9644\u52a0\u7684 ID )\uff0c Entity \u90e8\u5206\u662f\u901a\u904e\u547c\u53eb\u5be6\u9ad4\u6697\u793a\u7684\uff0c User \u90e8\u5206\u8868\u793a\u7279\u5b9a\u7684\u5be6\u9ad4\u3002 \u540c\u6a23\u7576\u4f60\u958b\u59cb\u5efa\u7acb\u81ea\u5df1\u7684 class \u6642\uff0c\u4f60\u4e5f\u6703\u4f7f\u7528\u7c21\u77ed\u7684 class \u540d\u4f86\u5f15\u7528\u81ea\u5df1\u7684 class\u3002 \u4f8b\u5982\uff0c\u5982\u679c\u4f60\u9700\u8981\u70ba\u4f60\u7684 Demo \u9644\u52a0\u5143\u4ef6\u5efa\u7acb\u4e00\u500b\u65b0\u7684 Thing \u5be6\u9ad4\uff0c\u90a3\u9ebc\u4f60\u6703\u5beb\u51fa\u4ee5\u4e0b\u5167\u5bb9\u3002 \\XF::em()->create('Demo:Thing'); \u9019\u5c07\u89e3\u6790\u70ba Demo\\Entity\\Thing class\u3002 \u540c\u6a23\uff0c\u5982\u679c\u4f60\u60f3\u8a2a\u554f\u4e00\u500b Thing \u5132\u5b58\u5eab\uff0c\u4f60\u53ef\u4ee5\u9019\u6a23\u5beb\u3002 \\XF::repository('Demo:Thing'); \u8acb\u6ce8\u610f\u9019\u4e9b\u77ed\u985e\u540d\u662f\u5982\u4f55\u76f8\u540c\u7684\u3002 \u5132\u5b58\u5eab\u7684\u547c\u53eb\u5be6\u969b\u4e0a\u6703\u89e3\u6790\u70ba Demo\\Repository\\Thing \u3002 \u7e7c\u627f\u985e \u00b6 XF2 \u4e2d\u5927\u591a\u6578\u7684 class \u90fd\u662f\u53ef\u7e7c\u627f\u7684\uff0c\u9019\u4f7f\u5f97\u958b\u767c\u4eba\u54e1\u53ef\u4ee5\u7e7c\u627f\u548c\u8986\u84cb\u6838\u5fc3\u7a0b\u5f0f\u78bc\uff0c\u800c\u7121\u9700\u76f4\u63a5\u7de8\u8f2f\u5b83\u3002 \u5982\u679c\u4f60\u719f\u6089 XF1 \u7684\u958b\u767c\uff0c\u4f60\u6703\u5c0d\u4e0b\u9762\u7684\u904e\u7a0b\u6709\u4e9b\u719f\u6089\uff1a \u5efa\u7acb\u4e00\u500b\u76e3\u807d\u5668 PHP \u6a94\u6848 \u5efa\u7acb\u4e00\u500b class\uff0c\u8a72 class \u6700\u7d42\u5c07\u7e7c\u627f\u539f\u6709\u7684 class \u7de8\u5beb\u4e00\u500b function\uff0c\u8a72 function \u8207\u9810\u671f\u7684 load_class \u4e8b\u4ef6\u7684 callback \u7c3d\u7ae0\u76f8\u7b26\u5408\uff0c\u4e26\u65b0\u589e\u7e7c\u627f class \u7684\u540d\u7a31 \u5728 Admin CP \u4e2d\u65b0\u589e\u4e00\u500b \"\u7a0b\u5f0f\u78bc\u4e8b\u4ef6\u76e3\u807d\u5668\"\uff0c\u6307\u5b9a\u4e0a\u8ff0 function \u7684\u76e3\u807d\u5668 class \u548c method \u540d\uff0c\u4e26\u53ef\u9078\u5730\u63d0\u793a\u7e7c\u627f\u7684\u662f\u54ea\u500b class \u5728 XF2 \u4e2d\uff0c\u6211\u5011\u53bb\u6389\u4e86\u9019\u4e9b\u4e8b\u4ef6\uff0c\u800c\u63a1\u7528\u4e86\u4e00\u500b\u540d\u70ba \"Class extensions\" \u7684\u7279\u5b9a\u7cfb\u7d71\u3002 \u9019\u500b\u904e\u7a0b\u5982\u4e0b\u3002 \u5efa\u7acb\u4e00\u500b class\uff0c\u8a72 class \u6700\u7d42\u5c07\u7e7c\u627f\u539f\u6709\u7684 class \u5728 Admin CP \u4e2d\u65b0\u589e\u4e00\u500b \"Class extension\"\uff0c\u6307\u5b9a\u4f60\u8981\u7e7c\u627f\u7684 class \u7684\u540d\u7a31\u548c\u6b63\u5728\u7e7c\u627f\u7684 class \u7684\u540d\u7a31\u3002 \u9019\u986f\u7136\u6e1b\u5c11\u4e86\u4e00\u4e9b\u7e7c\u627f class \u6240\u9700\u7684\u6a21\u677f\uff0c\u4e5f\u63d0\u4f9b\u4e86\u4e00\u500b\u5c08\u9580\u7684 UI \u4f86\u67e5\u770b\u548c\u7ba1\u7406\u9019\u4e9b\u7e7c\u627f\u3002 \u8b93\u6211\u5011\u901a\u904e\u7e7c\u627f public Member controller \u4f86\u770b\u770b\u9019\u500b\u904e\u7a0b\uff0c\u4e26\u65b0\u589e\u4e00\u500b\u65b0\u7684\u52d5\u4f5c\u4f86\u986f\u793a\u4e00\u500b\u7c21\u55ae\u7684\u8a0a\u606f\u3002 \u9996\u5148\u8981\u505a\u7684\u662f\u5efa\u7acb\u4e00\u500b\u9644\u52a0\u5143\u4ef6\u3002 \u6211\u5011\u4e4b\u524d\u5df2\u7d93\u4ecb\u7d39\u904e\u5982\u4f55\u4f7f\u7528 xf-addon:create \u6307\u4ee4 \u5728\u9019\u88e1 \u3002 \u5728\u9019\u500b\u4f8b\u5b50\u4e2d\uff0c\u6211\u5011\u5c07\u5047\u8a2d\u4f60\u5efa\u7acb\u4e86\u4e00\u500b ID \u548c\u6a19\u984c\u70ba \"Demo\" \u7684\u9644\u52a0\u5143\u4ef6\u3002 \u73fe\u5728\uff0c\u60a8\u5c07\u5728\u4ee5\u4e0b\u4f4d\u7f6e\u4e2d\u51fa\u73fe\u6b64\u9644\u52a0\u5143\u4ef6\u7684 addon.json \u6a94\u6848 src/addons/Demo/addon.json \u3002 Note \u96d6\u7136\u56b4\u683c\u4f86\u8aaa\uff0c\u4f60\u53ef\u4ee5\u628a\u7e7c\u627f class \u653e\u5728\u9644\u52a0\u5143\u4ef6\u76ee\u9304\u4e0b\u4efb\u4f55\u4f60\u559c\u6b61\u7684\u5730\u65b9\uff0c\u4f46\u5efa\u8b70\u628a\u7e7c\u627f class \u653e\u5728\u4e00\u500b\u5bb9\u6613\u8b58\u5225\u7684\u76ee\u9304\u4e0b a) class \u6240\u5c6c\u7684\u9644\u52a0\u5143\u4ef6 b) \u88ab\u7e7c\u627f \u7684 class \u985e\u578b c) \u88ab\u7e7c\u627f\u7684 class \u540d\u7a31 \u5728\u4e0b\u9762\u7684\u4f8b\u5b50\u4e2d\uff0c\u6211\u5011\u8981\u7e7c\u627f public \u7684 XF Member Controller\uff0c\u6240\u4ee5\u6211\u5011\u5c07\u6211\u5011\u7684\u7e7c\u627f class \u653e\u5728\u4e0b\u9762\u7684\u8def\u5f91\u4e2d\uff1a src/addons/Demo/XF/Pub/Controller/Member.php \u3002 \u5728\u6211\u5011\u5c07 Class extension \u65b0\u589e\u5230 Admin CP \u4e4b\u524d\uff0c\u7e7c\u627f\u7684 class \u9700\u8981\u5b58\u5728\u3002 \u6240\u4ee5\uff0c\u8acb\u6309\u7167\u4e0b\u9762\u7684\u8aaa\u660e\u9032\u884c\u64cd\u4f5c\uff1a \u5728 src/addons/Demo \u5167\u65b0\u5efa\u4e00\u500b\u540d\u70ba XF \u7684\u76ee\u9304\u3002 \u5728 src/addons/Demo/XF \u5167\u65b0\u5efa\u4e00\u500b\u540d\u70ba Pub \u7684\u76ee\u9304\u3002 \u5728 src/addons/Demo/XF/Pub \u5167\u65b0\u5efa\u4e00\u500b\u540d\u70ba Controller \u7684\u76ee\u9304\u3002 \u5728 src/addons/Demo/XF/Pub/Controller \u5167\u65b0\u5efa\u4e00\u500b\u540d\u70ba Member.php \u7684\u6a94\u6848\u3002 \u4f60\u7684PHP\u6a94\u6848\u521d\u59cb\u5167\u5bb9\uff0c\u61c9\u8a72\u5982\u4e0b\u6240\u793a\uff1a <?php namespace Demo\\XF\\Pub\\Controller; class Member extends XFCP_Member { } \u5982\u679c\u4f60\u5c0d\u4e00\u822c\u7684 PHP class \u7e7c\u627f\u6bd4\u8f03\u719f\u6089\uff0c\u4f46\u5c0d XF \u4e0d\u719f\u6089\uff0c\u4e0a\u9762\u7684\u4f8b\u5b50\u6700\u521d\u53ef\u80fd\u6703\u8b93\u4f60\u611f\u5230\u56f0\u60d1\u3002 \u539f\u56e0\u662f\u4f60\u53ef\u80fd\u671f\u671b\u76f4\u63a5\u7e7c\u627f XF\\Pub\\Controller\\Member \u985e\u76ee\u9304\uff0c\u800c\u4e0d\u662f XFCP_Member \u3002 \u5728 XF \u4e2d\uff0c\u6211\u5011\u4f7f\u7528 \"XenForo Class Proxy\" \u7cfb\u7d71\uff08\u7c21\u7a31 XFCP \uff09\u4f86\u69cb\u5efa\u4e00\u500b \"inheritance chain\"\uff0c\u6700\u7d42\u5141\u8a31\u4e00\u500b class \u88ab\u591a\u500b\u9644\u52a0\u5143\u4ef6\u7e7c\u627f\u3002 \u6163\u4f8b\u662f\u53c3\u8003\u4e00\u500b\u865b\u64ec\u7684\u7e7c\u627f class\uff0c\u4e5f\u5c31\u662f\u76ee\u524d\u7684 class \u540d Member \uff0c\u4e26\u4ee5 XFCP_ \u70ba\u524d\u7db4\u3002 \u73fe\u5728 class \u5df2\u7d93\u5efa\u7acb\u597d\u4e86\uff0c\u6211\u5011\u53ef\u4ee5\u5728 Admin CP > \u958b\u767c > Class extensions > \u65b0\u589e Class extensions \u9801\u9762\u4e0a\u5275\u5efa Class extension\u3002 \u4f60\u9700\u8981\u505a\u7684\u5c31\u662f\u5728\u7b2c\u4e00\u500b\u6b04\u4f4d\u4e2d\u8f38\u5165\u57fa\u672c class \u540d\uff08 XF\\Pub\\Controller\\Member \uff09\uff0c\u5728\u7b2c\u4e8c\u500b\u6b04\u4f4d\u4e2d\u8f38\u5165\u7e7c\u627f class \u540d\uff08\u4f60\u525b\u525b\u5efa\u7acb\u7684\uff09\uff08 Demo\\XF\\Pub\\Controller\\Member \uff09\uff0c\u7136\u5f8c\u9ede\u9078 \"\u5132\u5b58\" \u6309\u9215\u3002 \u4f60\u7684 Class extension \u73fe\u5728\u61c9\u8a72\u662f\u88ab\u555f\u7528\u7684\uff0c\u4f46\u76ee\u524d\u6c92\u6709\u505a\u4efb\u4f55\u4e8b\u60c5\u3002 \u8981\u505a\u4e00\u4e9b\u4e8b\u60c5\uff0c\u6211\u5011\u9700\u8981\u901a\u904e\u5efa\u7acb\u4e00\u500b\u8207\u73fe\u6709 method \u540c\u540d\u7684 method \u4f86 override \u9019\u500b class \u4e2d\u7684\u73fe\u6709 method\uff0c\u6216\u8005\u5efa\u7acb\u4e00\u500b\u5168\u65b0\u7684 method\u3002 \u8b93\u6211\u5011\u4f86\u505a\u5f8c\u8005\uff0c\u5efa\u7acb\u5168\u65b0\u7684 method\u3002 <?php namespace Demo\\XF\\Pub\\Controller; class Member extends XFCP_Member { public function actionHelloWorld() { return $this->message('Hello world!'); } } \u6211\u5011\u5728 Controller \u57fa\u790e\u77e5\u8b58 \u7684\u9801\u9762\u4e2d\u6703\u66f4\u591a\u7684\u8b1b\u5230 Controller \u3001 Action \u548c Reply\uff0c\u6240\u4ee5\u73fe\u5728\u4e0d\u7528\u7279\u5225\u64d4\u5fc3\u4e86\u89e3\u9019\u4e9b\u3002 \u73fe\u5728\u6211\u5011\u5df2\u7d93\u65b0\u589e\u4e86\u4e00\u4e9b\u7a0b\u5f0f\u78bc\u5230\u6211\u5011\u7684\u7e7c\u627f Controller \u4e2d\uff0c\u8b93\u6211\u5011\u4f86\u770b\u770b\u5b83\u7684\u904b\u4f5c\u3002 \u7c21\u55ae\u5730\u8f38\u5165\u4ee5\u4e0b\u7db2\u5740 (\u76f8\u5c0d\u65bc\u4f60\u7684\u8ad6\u58c7URL): index.php?members/hello-world \u3002 \u73fe\u5728\u4f60\u61c9\u8a72\u6703\u770b\u5230\u4e00\u500b \"Hello world!\" \u7684\u8a0a\u606f\uff01 \u5982\u524d\u6240\u8ff0\uff0c\u5728\u4e00\u500b class \u4e2d\u4e5f\u53ef\u4ee5\u8986\u84cb\u73fe\u6709\u7684\u65b9\u6cd5\u3002 \u4f8b\u5982\uff0c\u5982\u679c\u6211\u5011\u5c07 actionHelloWorld() \u6539\u70ba actionIndex() \uff0c\u90a3\u9ebc\u4f60\u5c07\u4e0d\u518d\u6709 \"Notable members\" \u5217\u8868\uff0c\u800c\u662f\u986f\u793a \"Hello world!\" \u8a0a\u606f\uff01 \u4e8b\u5be6\u4e0a\uff0c\u9019\u4e26\u4e0d\u662f\u7e7c\u627f\u73fe\u6709 Controller \u52d5\u4f5c\uff08\u6216\u4efb\u4f55 class \u65b9\u6cd5\uff09\u7684\u6b63\u78ba\u65b9\u5f0f\uff0c\u4f46\u6211\u5011\u6703\u5728 \u4fee\u6539 Controller Action Reply\uff08properly\uff09 \u4e00\u7bc0\u4e2d\u8a73\u7d30\u4ecb\u7d39\u3002 \u985e\u578b\u63d0\u793a \u00b6 XF \u4e2d\u7684\u5f88\u591a\u7269\u4ef6\u90fd\u662f\u901a\u904e\u5de5\u5ee0\u65b9\u6cd5\u5be6\u9ad4\u5316\u7684\u3002 \u4f8b\u5982\uff0c\u5982\u679c\u6211\u5011\u60f3\u5be6\u9ad4\u5316\u4e00\u500b\u7279\u5b9a\u7684\u5132\u5b58\u5eab\uff0c\u6211\u5011\u6703\u5beb\u4ee5\u4e0b\u5167\u5bb9\uff1a $repo = \\XF::repository('Demo:Thing'); \u9019\u662f\u4e00\u7a2e\u975e\u5e38\u65b9\u4fbf\u548c\u4e00\u81f4\u7684\u5be6\u9ad4\u5316\u7269\u4ef6\u7684\u65b9\u5f0f\u3002 \u6211\u5011\u53ea\u8981\u770b\u4e00\u773c\uff0c\u5c31\u77e5\u9053\u6703\u5be6\u9ad4\u5316\u4ec0\u9ebc\u7269\u4ef6\u3002 \u8a72\u65b9\u6cd5\u4e2d\u7522\u751f\u7684\u7a0b\u5f0f\u78bc\u77e5\u9053\u5982\u4f55\u70ba\u6211\u5011\u8acb\u6c42\u7684\u6771\u897f\u8fd4\u56de\u6b63\u78ba\u7684\u7269\u4ef6\u3002 \u7136\u800c\uff0c\u4e0d\u5e78\u7684\u662f\uff0c\u4f60\u7684 IDE \u53ef\u80fd\u4e0d\u77e5\u9053\uff08\u81f3\u5c11\u9810\u8a2d\u60c5\u6cc1\u4e0b\u662f\u9019\u6a23\uff09\u3002 \u5c31 IDE \u800c\u8a00\uff0c\u9019\u500b\u65b9\u6cd5\u5c07\u8fd4\u56de\u4e00\u500b XF\\Mvc\\Entity\\Repository \u7684\u7269\u4ef6\u5be6\u9ad4\u3002 \u9019\u5728\u4e00\u5b9a\u7a0b\u5ea6\u4e0a\u662f\u6709\u7528\u7684\uff0c\u4f46\u662f\u5728\u7279\u5b9a\u7684 Demo\\Repository\\Thing \u7269\u4ef6\u4e2d\u53ef\u80fd\u6709\u5f88\u591a\u65b9\u6cd5\u662f\u4f60\u7684 IDE \u4e0d\u77e5\u9053\u7684\u3002 \u9019\u6700\u7d42\u610f\u5473\u8457\uff0c\u7576\u4f60\u8a66\u5716\u5728\u7a0b\u5f0f\u78bc\u4e2d\u4f7f\u7528\u4f60\u7684 $repo \u7269\u4ef6\u6642\uff0c\u4f60\u7684 IDE \u5c07\u7121\u6cd5\u63d0\u51fa\u5efa\u8b70\u6216\u81ea\u52d5\u5b8c\u6210\u65b9\u6cd5\u540d\u548c\u5b83\u6240\u9700\u8981\u7684\u53c3\u6578\u3002 \u9019\u5c31\u662f\u985e\u578b\u63d0\u793a\u7684\u7528\u8655\uff0c\u800c\u4e14\u5927\u591a\u6578 IDE \u548c\u4e00\u4e9b\u80fd\u5920 \"\u8b58\u5225 PHP\" \u7684\u6587\u5b57\u7de8\u8f2f\u5668\u90fd\u61c9\u8a72\u6a19\u6e96\u5730\u652f\u63f4\u9019\u7a2e\u8a9e\u6cd5\u3002 \u6211\u5011\u53ea\u9700\u5c07\u5132\u5b58\u5eab\u7684\u547c\u53eb\u4fee\u6539\u5982\u4e0b\uff1a /** @var \\Demo\\Repository\\Thing $repo */ $repo = \\XF::repository('Demo:Thing'); \u5132\u5b58\u5eab\u547c\u53eb\u4e0a\u9762\u7684\u985e\u578b\u63d0\u793a\u73fe\u5728\u544a\u8a34 IDE\uff0c $repo \u6d89\u53ca\u5230\u4e00\u500b\u7531 Demo\\Repository\\Thing class \u8868\u793a\u7684\u7269\u4ef6\uff0c\u800c\u4e0d\u662f\u539f\u4f86\u81ea\u52d5\u63a8\u65b7\u7684\u7269\u4ef6\u3002 \u985e\u578b\u63d0\u793a\u5728\u7e7c\u627f class \u7684\u6642\u5019\u4e5f\u7279\u5225\u6709\u7528\u3002 \u6211\u5011\u7684 Class extension \u65b9\u6cd5\u6709\u4e00\u500b\u6f5b\u5728\u7684\u554f\u984c\uff0c\u90a3\u5c31\u662f\u57fa\u672c\u4e0a\u4f60\u7684 class \u4e26\u6c92\u6709\u7e7c\u627f\u4f60\u8981\u7e7c\u627f\u7684\u539f class\uff0c\u800c\u662f\u901a\u904e\u4e00\u500b\u5be6\u969b\u4e0a\u4e26\u4e0d\u5b58\u5728\u7684 class \u4f86\u4ee3\u7406\u9019\u500b class\uff0c\u6bd4\u5982 \u4e0a\u9762\u4f8b\u5b50 \u4e2d\u7684 XFCP_Member \u3002 \u70ba\u4e86\u89e3\u6c7a\u9019\u500b\u554f\u984c\uff0c\u6211\u5011\u6703\u81ea\u52d5\u7522\u751f\u4e00\u500b\u540d\u70ba extension_hint.php \u7684\u6a94\u6848\uff0c\u4e26\u5c07\u5176\u5132\u5b58\u5728\u4f60\u7684 _output \u76ee\u9304\u4e0b\u3002 \u9019\u5c31\u589e\u52a0\u4e86\u4e00\u500b IDE \u53ef\u4ee5\u8b80\u53d6\u4f46 PHP \u4e0d\u80fd\u8b80\u53d6\u7684\u53c3\u8003\uff0c\u6240\u4ee5 IDE \u73fe\u5728\u53ef\u4ee5\u7406\u89e3\uff0c\u7576\u6211\u5011\u5728\u9019\u500b\u7e7c\u627f class \u7684\u4efb\u4f55\u65b9\u6cd5\u4e2d\u4f7f\u7528 $this \u6642\uff0c\u5b83\u53ef\u4ee5\u5efa\u8b70\u4e26\u81ea\u52d5\u5b8c\u6210\u5728 Member Controller \u6216\u5176\u7236\u985e\u4e2d\u53ef\u7528\u7684\u65b9\u6cd5\u548c\u5c6c\u6027\u3002","title":"\u901a\u7528\u6982\u5ff5"},{"location":"general-concepts/#_1","text":"\u4ee5\u4e0b\u90e8\u5206\u5c07\u8a73\u7d30\u4ecb\u7d39\u958b\u767c XenForo \u9644\u52a0\u5143\u4ef6\u6642\u5c07\u6703\u9047\u5230\u7684\u4e00\u4e9b\u901a\u7528\u7cfb\u7d71\u548c\u6982\u5ff5\u3002 \u5982\u679c\u60a8\u719f\u6089 XenForo 1.x \u7684\u958b\u767c\uff0c\u90a3\u9ebc\u9019\u4e9b\u6982\u5ff5\u4e2d\u7684\u5f88\u591a\u5167\u5bb9\u60a8\u90fd\u6703\u89ba\u5f97\u5f88\u719f\u6089\uff0c\u4e0d\u904e\u503c\u5f97\u56de\u9867\u4e00\u4e0b\uff0c\u56e0\u70ba\u6709\u4e00\u4e9b\u512a\u79c0\u7684\u65b0\u5de5\u5177\u548c\u529f\u80fd\u53ef\u4ee5\u5e6b\u52a9\u60a8\u958b\u767c\u9644\u52a0\u5143\u4ef6\u3002","title":"\u901a\u7528\u6982\u5ff5"},{"location":"general-concepts/#vendor","text":"XF2 \u4e26\u4e0d\u50cf XF1 \u90a3\u6a23\u7531\u4e00\u500b\u7279\u5b9a\u7684\u6846\u67b6\u4f86\u9a45\u52d5\uff0c\u7136\u800c\uff0c\u6211\u5011\u4f7f\u7528\u4e86\u67d0\u4e9b\u6d41\u884c\u7684\u3001\u7d93\u904e\u826f\u597d\u6e2c\u8a66\u7684\u3001\u958b\u6e90\u7684\u8edf\u9ad4\u5305\u4f86\u5e6b\u52a9\u5b8c\u6210\u7279\u5b9a\u7684\u4efb\u52d9\u3002 \u4f8b\u5982\uff0c\u6211\u5011\u4f7f\u7528\u4e00\u500b\u540d\u70ba SwiftMailer \u7684\u9805\u76ee\u4f86\u767c\u9001\u96fb\u5b50\u90f5\u4ef6\uff0c\u4ee5\u53ca\u4e00\u500b\u540d\u70ba Guzzle \u7684\u9805\u76ee\u4f5c\u70ba HTTP \u5ba2\u6236\u7aef\u3002 \u6240\u6709\u7684\u7b2c\u4e09\u65b9\u9805\u76ee\u90fd\u662f\u5f9e src/vendor \u76ee\u9304\u4e0b\u8f09\u5165\u7684\u3002 \u76ee\u524d\uff0c\u9644\u52a0\u5143\u4ef6\u958b\u767c\u8005\u9084\u4e0d\u80fd\u5c07\u81ea\u5df1\u7684\u4f9d\u8cf4\u95dc\u4fc2\u6dfb\u52a0\u5230\u9019\u500b\u4f4d\u7f6e\u3002","title":"Vendor \u5143\u4ef6"},{"location":"general-concepts/#ide","text":"\u5728\u958b\u59cb XF2 \u958b\u767c\u5de5\u4f5c\u4e4b\u524d\uff0c\u4f60\u53ef\u80fd\u9700\u8981\u82b1\u4e00\u4e9b\u6642\u9593\u4f86\u8a55\u4f30\u4f60\u5c07\u5be6\u969b\u5efa\u7acb\u548c\u7de8\u8f2f PHP \u6a94\u6848\u7684\u61c9\u7528\u7a0b\u5f0f\u3002 \u9019\u901a\u5e38\u88ab\u7a31\u70ba IDE\u3002 \u6709\u8a31\u591a\u53ef\u7528\u7684\u9078\u9805\uff0c\u5f9e\u57fa\u672c\u7684\u8a18\u4e8b\u672c\u5230\u50cf Sublime Text \u9019\u6a23\u53ef\u4ee5\u901a\u904e\u9644\u52a0\u5143\u4ef6\u64f4\u5c55\u4ee5\u7372\u5f97\u66f4\u597d\u7684 PHP \u652f\u6301\u7684\u6771\u897f\uff0c\u76f4\u5230\u4e00\u500b\u5408\u9069\u7684 IDE\uff0c\u5982 PhpStorm \u3002 \u5728\u5167\u90e8\uff0c\u6211\u5011\u4f7f\u7528 PhpStorm \u4f5c\u70ba\u6211\u5011\u7684\u9996\u9078 IDE\u3002 \u9019\u662f\u4e00\u500b\u9ad8\u7d1a\u7684\u5546\u696d\u7522\u54c1\uff0c\u4f46\u4e5f\u6709\u53ef\u80fd\u662f\u514d\u8cbb\u7684\u3002 \u7121\u8ad6\u54ea\u7a2e\u65b9\u5f0f\uff0c\u6c92\u6709\u4eba\u80fd\u544a\u8a34\u4f60\u6700\u7b26\u5408\u60a8\u9700\u6c42\u7684\u6700\u4f73\u61c9\u7528\u7a0b\u5e8f\u662f\u54ea\u500b\uff0c\u4f60\u61c9\u8a72\u82b1\u4e9b\u6642\u9593\u591a\u4f7f\u7528\u4e00\u4e9b\u7522\u54c1\uff08\u751a\u81f3\u662f\u514d\u8cbb\u7684\uff09\uff0c\u4e26\u4f7f\u7528\u9019\u4e9b\u7d93\u9a57\u4f86\u627e\u51fa\u4f60\u7684\u559c\u597d\u3002","title":"\u6574\u5408\u958b\u767c\u74b0\u5883 (IDE)"},{"location":"general-concepts/#_2","text":"XF2 \u4f7f\u7528\u4e00\u500b\u7531 Composer \u81ea\u52d5\u7522\u751f\u7684\u81ea\u52d5\u8f09\u5165\u5668\u3002 \u9019\u5141\u8a31\u6240\u6709\u7684 XF \u7a0b\u5f0f\u78bc\u3001\u7b2c\u4e09\u65b9\u4f9b\u61c9\u5546\u7a0b\u5f0f\u78bc\uff0c\u4ee5\u53ca\u4efb\u4f55\u9644\u52a0\u5143\u4ef6\u7684\u958b\u767c\u8005\u7a0b\u5f0f\u78bc\u5728\u6574\u500b\u9805\u76ee\u4e2d\u81ea\u52d5\u5305\u542b\u9032\u53bb\uff0c\u800c\u4e0d\u9700\u8981\u624b\u52d5 include/require \u4f60\u7684 class\u3002 \u6240\u6709 XF \u9644\u52a0\u5143\u4ef6\u7684\u81ea\u52d5\u8f09\u5165\u6839\u76ee\u9304\u662f src/addons \u76ee\u9304\u3002 \u9019\u610f\u5473\u8457\u4f60\u6240\u6709\u7684 class \u540d\u90fd\u6703\u76f8\u5c0d\u65bc\u9019\u500b\u57fa\u790e\u4f4d\u7f6e\u3002 \u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0cXF2 \u63a1\u7528\u4e86\u56b4\u683c\u7684 \"\u6bcf\u500b\u6a94\u6848\u4e00\u500b\u985e\" \u7684\u547d\u540d\u6a21\u5f0f\u3002 \u6bcf\u500b\u6a94\u6848\u61c9\u8a72\u53ea\u5305\u542b\u4e00\u500b\u985e\uff0c\u800c\u4e14\u9019\u500b\u985e\u7684\u540d\u5b57\u61c9\u8a72\u78ba\u5b9a\u8a72\u985e\u7684 PHP \u6a94\u6848\u5728\u6a94\u6848\u7cfb\u7d71\u4e2d\u7684\u78ba\u5207\u4f4d\u7f6e\u3002 \u4f8b\u5982\uff0c\u5982\u679c\u4f60\u60f3\u5728\u4e00\u500b\u540d\u70ba src/addons/Demo/Setup.php \u7684\u6a94\u6848\u4e2d\u5efa\u7acb\u4e00\u500b\u65b0\u7684 class\uff08\u5176\u4e2d Demo \u662f\u4f60\u7684 \u9644\u52a0\u5143\u4ef6 ID\uff09\uff0c\u90a3\u9ebc\u9019\u500b class \u5c07\u88ab\u547d\u540d\u70ba Demo\\Setup \u3002 \u76f8\u53cd\uff0c\u5982\u679c\u4f60\u6709\u4e00\u500b\u540d\u70ba Demo\\Entity\\Thing \u7684 class\uff0c\u90a3\u9ebc\u4f60\u6703\u77e5\u9053\u9019\u500b class \u7684\u6a94\u6848\u4f4d\u65bc\u8def\u5f91 src/addons/Demo/Entity/Thing.php \u4e2d\u3002","title":"\u81ea\u52d5\u8f09\u5165\u5668"},{"location":"general-concepts/#_3","text":"\u5728\u6574\u500b XF \u4e2d\uff0c\u6211\u5011\u4f7f\u7528\u4e86 \u547d\u540d\u7a7a\u9593 \uff0c\u9019\u6a23\u6211\u5011\u53ef\u4ee5\u66f4\u7c21\u6f54\u5730\u53c3\u8003\u540c\u4e00\u540d\u7a31\u7a7a\u9593\u4e2d\u7684\u985e\u3002\u5efa\u8b70\u6240\u6709\u7684\u9644\u52a0\u5143\u4ef6\u4e5f\u4f7f\u7528\u540d\u7a31\u7a7a\u9593\u3002 \u5728\u4e0a\u9762\u7684\u4f8b\u5b50\u4e2d\uff0c\u6211\u5011\u8ac7\u5230\u4e86\u4e00\u500b\u540d\u70ba Demo\\Setup \u7684\u985e\u3002 \u4f7f\u7528\u547d\u540d\u7a7a\u9593\uff0c\u9019\u500b\u985e\u5be6\u969b\u4e0a\u6703\u88ab\u7c21\u55ae\u5730\u547d\u540d\u70ba Setup \uff0c\u4f46\u547d\u540d\u7a7a\u9593\u6703\u88ab\u8a2d\u5b9a\u70ba Demo \u3002 \u4f5c\u70ba\u4e00\u500b\u66f4\u5177\u9ad4\u7684\u4f8b\u5b50\uff0c\u6211\u5011\u5728\u4e0a\u9762\u4e5f\u8ac7\u5230\u4e86\u4e00\u500b\u540d\u70ba Demo\\Entity\\Thing \u7684\u985e\u3002 \u8b93\u6211\u5011\u4f86\u770b\u770b\u9019\u500b\u985e\u7684 PHP \u7a0b\u5f0f\u78bc\u662f\u4ec0\u9ebc\u6a23\u5b50\u7684\uff1a <?php namespace Demo\\Entity; class Thing { } \u5982\u679c\u5728 src/addons/Demo/Entity \u76ee\u9304\u4e0b\u6709\u4e00\u500b\u540d\u70ba AnotherThing \u7684 class\uff0c\u6211\u5011\u53ef\u4ee5\u5728 Thing class \u4e2d\u7c21\u55ae\u5730\u5c07\u9019\u500b class \u5f15\u7528\u70ba AnotherThing \uff0c\u56e0\u70ba\u9019\u500b class \u5728\u540c\u4e00\u500b Demo\\Entity \u547d\u540d\u7a7a\u9593\u4e2d\u3002","title":"\u547d\u540d\u7a7a\u9593"},{"location":"general-concepts/#_4","text":"\u5076\u723e\uff0cXF \u4e2d\u53c3\u8003\u7684 class \u6703\u88ab\u7e2e\u77ed\u3002 \u4f8b\u5982\uff0c\u5982\u679c\u60a8\u5e0c\u671b\u547c\u53eb User \u5be6\u9ad4\uff08\u66f4\u591a\u95dc\u65bc\u5be6\u9ad4\u7684\u5167\u5bb9\u898b\u4e0b\u6587\uff09\uff0c\u90a3\u9ebc\u60a8\u53ef\u80fd\u6703\u770b\u5230\u88ab\u5f15\u7528\u7684 class \u540d\u53ea\u662f XF:User \u3002 \u77ed\u985e\u540d\u7684\u4f7f\u7528\u548c\u5b83\u5011\u6240\u89e3\u6790\u7684\u5168\u985e\u540d\uff0c\u5b8c\u5168\u662f\u4f9d\u7167 context sensitive \u7684\u3002 \u56e0\u6b64\uff0c\u5728\u547c\u53eb\u5be6\u9ad4\u7684 context \u4e2d\uff0c\u77ed\u985e\u540d\u5c07\u89e3\u6790\u70ba\u4ee5\u4e0b\u5168\u985e\u540d XF/Entity/User \u3002 XF \u90e8\u5206\u8868\u793a\u6a94\u6848\u8def\u5f91 (\u57fa\u65bc\u9644\u52a0\u7684 ID )\uff0c Entity \u90e8\u5206\u662f\u901a\u904e\u547c\u53eb\u5be6\u9ad4\u6697\u793a\u7684\uff0c User \u90e8\u5206\u8868\u793a\u7279\u5b9a\u7684\u5be6\u9ad4\u3002 \u540c\u6a23\u7576\u4f60\u958b\u59cb\u5efa\u7acb\u81ea\u5df1\u7684 class \u6642\uff0c\u4f60\u4e5f\u6703\u4f7f\u7528\u7c21\u77ed\u7684 class \u540d\u4f86\u5f15\u7528\u81ea\u5df1\u7684 class\u3002 \u4f8b\u5982\uff0c\u5982\u679c\u4f60\u9700\u8981\u70ba\u4f60\u7684 Demo \u9644\u52a0\u5143\u4ef6\u5efa\u7acb\u4e00\u500b\u65b0\u7684 Thing \u5be6\u9ad4\uff0c\u90a3\u9ebc\u4f60\u6703\u5beb\u51fa\u4ee5\u4e0b\u5167\u5bb9\u3002 \\XF::em()->create('Demo:Thing'); \u9019\u5c07\u89e3\u6790\u70ba Demo\\Entity\\Thing class\u3002 \u540c\u6a23\uff0c\u5982\u679c\u4f60\u60f3\u8a2a\u554f\u4e00\u500b Thing \u5132\u5b58\u5eab\uff0c\u4f60\u53ef\u4ee5\u9019\u6a23\u5beb\u3002 \\XF::repository('Demo:Thing'); \u8acb\u6ce8\u610f\u9019\u4e9b\u77ed\u985e\u540d\u662f\u5982\u4f55\u76f8\u540c\u7684\u3002 \u5132\u5b58\u5eab\u7684\u547c\u53eb\u5be6\u969b\u4e0a\u6703\u89e3\u6790\u70ba Demo\\Repository\\Thing \u3002","title":"\u77ed\u985e\u540d"},{"location":"general-concepts/#_5","text":"XF2 \u4e2d\u5927\u591a\u6578\u7684 class \u90fd\u662f\u53ef\u7e7c\u627f\u7684\uff0c\u9019\u4f7f\u5f97\u958b\u767c\u4eba\u54e1\u53ef\u4ee5\u7e7c\u627f\u548c\u8986\u84cb\u6838\u5fc3\u7a0b\u5f0f\u78bc\uff0c\u800c\u7121\u9700\u76f4\u63a5\u7de8\u8f2f\u5b83\u3002 \u5982\u679c\u4f60\u719f\u6089 XF1 \u7684\u958b\u767c\uff0c\u4f60\u6703\u5c0d\u4e0b\u9762\u7684\u904e\u7a0b\u6709\u4e9b\u719f\u6089\uff1a \u5efa\u7acb\u4e00\u500b\u76e3\u807d\u5668 PHP \u6a94\u6848 \u5efa\u7acb\u4e00\u500b class\uff0c\u8a72 class \u6700\u7d42\u5c07\u7e7c\u627f\u539f\u6709\u7684 class \u7de8\u5beb\u4e00\u500b function\uff0c\u8a72 function \u8207\u9810\u671f\u7684 load_class \u4e8b\u4ef6\u7684 callback \u7c3d\u7ae0\u76f8\u7b26\u5408\uff0c\u4e26\u65b0\u589e\u7e7c\u627f class \u7684\u540d\u7a31 \u5728 Admin CP \u4e2d\u65b0\u589e\u4e00\u500b \"\u7a0b\u5f0f\u78bc\u4e8b\u4ef6\u76e3\u807d\u5668\"\uff0c\u6307\u5b9a\u4e0a\u8ff0 function \u7684\u76e3\u807d\u5668 class \u548c method \u540d\uff0c\u4e26\u53ef\u9078\u5730\u63d0\u793a\u7e7c\u627f\u7684\u662f\u54ea\u500b class \u5728 XF2 \u4e2d\uff0c\u6211\u5011\u53bb\u6389\u4e86\u9019\u4e9b\u4e8b\u4ef6\uff0c\u800c\u63a1\u7528\u4e86\u4e00\u500b\u540d\u70ba \"Class extensions\" \u7684\u7279\u5b9a\u7cfb\u7d71\u3002 \u9019\u500b\u904e\u7a0b\u5982\u4e0b\u3002 \u5efa\u7acb\u4e00\u500b class\uff0c\u8a72 class \u6700\u7d42\u5c07\u7e7c\u627f\u539f\u6709\u7684 class \u5728 Admin CP \u4e2d\u65b0\u589e\u4e00\u500b \"Class extension\"\uff0c\u6307\u5b9a\u4f60\u8981\u7e7c\u627f\u7684 class \u7684\u540d\u7a31\u548c\u6b63\u5728\u7e7c\u627f\u7684 class \u7684\u540d\u7a31\u3002 \u9019\u986f\u7136\u6e1b\u5c11\u4e86\u4e00\u4e9b\u7e7c\u627f class \u6240\u9700\u7684\u6a21\u677f\uff0c\u4e5f\u63d0\u4f9b\u4e86\u4e00\u500b\u5c08\u9580\u7684 UI \u4f86\u67e5\u770b\u548c\u7ba1\u7406\u9019\u4e9b\u7e7c\u627f\u3002 \u8b93\u6211\u5011\u901a\u904e\u7e7c\u627f public Member controller \u4f86\u770b\u770b\u9019\u500b\u904e\u7a0b\uff0c\u4e26\u65b0\u589e\u4e00\u500b\u65b0\u7684\u52d5\u4f5c\u4f86\u986f\u793a\u4e00\u500b\u7c21\u55ae\u7684\u8a0a\u606f\u3002 \u9996\u5148\u8981\u505a\u7684\u662f\u5efa\u7acb\u4e00\u500b\u9644\u52a0\u5143\u4ef6\u3002 \u6211\u5011\u4e4b\u524d\u5df2\u7d93\u4ecb\u7d39\u904e\u5982\u4f55\u4f7f\u7528 xf-addon:create \u6307\u4ee4 \u5728\u9019\u88e1 \u3002 \u5728\u9019\u500b\u4f8b\u5b50\u4e2d\uff0c\u6211\u5011\u5c07\u5047\u8a2d\u4f60\u5efa\u7acb\u4e86\u4e00\u500b ID \u548c\u6a19\u984c\u70ba \"Demo\" \u7684\u9644\u52a0\u5143\u4ef6\u3002 \u73fe\u5728\uff0c\u60a8\u5c07\u5728\u4ee5\u4e0b\u4f4d\u7f6e\u4e2d\u51fa\u73fe\u6b64\u9644\u52a0\u5143\u4ef6\u7684 addon.json \u6a94\u6848 src/addons/Demo/addon.json \u3002 Note \u96d6\u7136\u56b4\u683c\u4f86\u8aaa\uff0c\u4f60\u53ef\u4ee5\u628a\u7e7c\u627f class \u653e\u5728\u9644\u52a0\u5143\u4ef6\u76ee\u9304\u4e0b\u4efb\u4f55\u4f60\u559c\u6b61\u7684\u5730\u65b9\uff0c\u4f46\u5efa\u8b70\u628a\u7e7c\u627f class \u653e\u5728\u4e00\u500b\u5bb9\u6613\u8b58\u5225\u7684\u76ee\u9304\u4e0b a) class \u6240\u5c6c\u7684\u9644\u52a0\u5143\u4ef6 b) \u88ab\u7e7c\u627f \u7684 class \u985e\u578b c) \u88ab\u7e7c\u627f\u7684 class \u540d\u7a31 \u5728\u4e0b\u9762\u7684\u4f8b\u5b50\u4e2d\uff0c\u6211\u5011\u8981\u7e7c\u627f public \u7684 XF Member Controller\uff0c\u6240\u4ee5\u6211\u5011\u5c07\u6211\u5011\u7684\u7e7c\u627f class \u653e\u5728\u4e0b\u9762\u7684\u8def\u5f91\u4e2d\uff1a src/addons/Demo/XF/Pub/Controller/Member.php \u3002 \u5728\u6211\u5011\u5c07 Class extension \u65b0\u589e\u5230 Admin CP \u4e4b\u524d\uff0c\u7e7c\u627f\u7684 class \u9700\u8981\u5b58\u5728\u3002 \u6240\u4ee5\uff0c\u8acb\u6309\u7167\u4e0b\u9762\u7684\u8aaa\u660e\u9032\u884c\u64cd\u4f5c\uff1a \u5728 src/addons/Demo \u5167\u65b0\u5efa\u4e00\u500b\u540d\u70ba XF \u7684\u76ee\u9304\u3002 \u5728 src/addons/Demo/XF \u5167\u65b0\u5efa\u4e00\u500b\u540d\u70ba Pub \u7684\u76ee\u9304\u3002 \u5728 src/addons/Demo/XF/Pub \u5167\u65b0\u5efa\u4e00\u500b\u540d\u70ba Controller \u7684\u76ee\u9304\u3002 \u5728 src/addons/Demo/XF/Pub/Controller \u5167\u65b0\u5efa\u4e00\u500b\u540d\u70ba Member.php \u7684\u6a94\u6848\u3002 \u4f60\u7684PHP\u6a94\u6848\u521d\u59cb\u5167\u5bb9\uff0c\u61c9\u8a72\u5982\u4e0b\u6240\u793a\uff1a <?php namespace Demo\\XF\\Pub\\Controller; class Member extends XFCP_Member { } \u5982\u679c\u4f60\u5c0d\u4e00\u822c\u7684 PHP class \u7e7c\u627f\u6bd4\u8f03\u719f\u6089\uff0c\u4f46\u5c0d XF \u4e0d\u719f\u6089\uff0c\u4e0a\u9762\u7684\u4f8b\u5b50\u6700\u521d\u53ef\u80fd\u6703\u8b93\u4f60\u611f\u5230\u56f0\u60d1\u3002 \u539f\u56e0\u662f\u4f60\u53ef\u80fd\u671f\u671b\u76f4\u63a5\u7e7c\u627f XF\\Pub\\Controller\\Member \u985e\u76ee\u9304\uff0c\u800c\u4e0d\u662f XFCP_Member \u3002 \u5728 XF \u4e2d\uff0c\u6211\u5011\u4f7f\u7528 \"XenForo Class Proxy\" \u7cfb\u7d71\uff08\u7c21\u7a31 XFCP \uff09\u4f86\u69cb\u5efa\u4e00\u500b \"inheritance chain\"\uff0c\u6700\u7d42\u5141\u8a31\u4e00\u500b class \u88ab\u591a\u500b\u9644\u52a0\u5143\u4ef6\u7e7c\u627f\u3002 \u6163\u4f8b\u662f\u53c3\u8003\u4e00\u500b\u865b\u64ec\u7684\u7e7c\u627f class\uff0c\u4e5f\u5c31\u662f\u76ee\u524d\u7684 class \u540d Member \uff0c\u4e26\u4ee5 XFCP_ \u70ba\u524d\u7db4\u3002 \u73fe\u5728 class \u5df2\u7d93\u5efa\u7acb\u597d\u4e86\uff0c\u6211\u5011\u53ef\u4ee5\u5728 Admin CP > \u958b\u767c > Class extensions > \u65b0\u589e Class extensions \u9801\u9762\u4e0a\u5275\u5efa Class extension\u3002 \u4f60\u9700\u8981\u505a\u7684\u5c31\u662f\u5728\u7b2c\u4e00\u500b\u6b04\u4f4d\u4e2d\u8f38\u5165\u57fa\u672c class \u540d\uff08 XF\\Pub\\Controller\\Member \uff09\uff0c\u5728\u7b2c\u4e8c\u500b\u6b04\u4f4d\u4e2d\u8f38\u5165\u7e7c\u627f class \u540d\uff08\u4f60\u525b\u525b\u5efa\u7acb\u7684\uff09\uff08 Demo\\XF\\Pub\\Controller\\Member \uff09\uff0c\u7136\u5f8c\u9ede\u9078 \"\u5132\u5b58\" \u6309\u9215\u3002 \u4f60\u7684 Class extension \u73fe\u5728\u61c9\u8a72\u662f\u88ab\u555f\u7528\u7684\uff0c\u4f46\u76ee\u524d\u6c92\u6709\u505a\u4efb\u4f55\u4e8b\u60c5\u3002 \u8981\u505a\u4e00\u4e9b\u4e8b\u60c5\uff0c\u6211\u5011\u9700\u8981\u901a\u904e\u5efa\u7acb\u4e00\u500b\u8207\u73fe\u6709 method \u540c\u540d\u7684 method \u4f86 override \u9019\u500b class \u4e2d\u7684\u73fe\u6709 method\uff0c\u6216\u8005\u5efa\u7acb\u4e00\u500b\u5168\u65b0\u7684 method\u3002 \u8b93\u6211\u5011\u4f86\u505a\u5f8c\u8005\uff0c\u5efa\u7acb\u5168\u65b0\u7684 method\u3002 <?php namespace Demo\\XF\\Pub\\Controller; class Member extends XFCP_Member { public function actionHelloWorld() { return $this->message('Hello world!'); } } \u6211\u5011\u5728 Controller \u57fa\u790e\u77e5\u8b58 \u7684\u9801\u9762\u4e2d\u6703\u66f4\u591a\u7684\u8b1b\u5230 Controller \u3001 Action \u548c Reply\uff0c\u6240\u4ee5\u73fe\u5728\u4e0d\u7528\u7279\u5225\u64d4\u5fc3\u4e86\u89e3\u9019\u4e9b\u3002 \u73fe\u5728\u6211\u5011\u5df2\u7d93\u65b0\u589e\u4e86\u4e00\u4e9b\u7a0b\u5f0f\u78bc\u5230\u6211\u5011\u7684\u7e7c\u627f Controller \u4e2d\uff0c\u8b93\u6211\u5011\u4f86\u770b\u770b\u5b83\u7684\u904b\u4f5c\u3002 \u7c21\u55ae\u5730\u8f38\u5165\u4ee5\u4e0b\u7db2\u5740 (\u76f8\u5c0d\u65bc\u4f60\u7684\u8ad6\u58c7URL): index.php?members/hello-world \u3002 \u73fe\u5728\u4f60\u61c9\u8a72\u6703\u770b\u5230\u4e00\u500b \"Hello world!\" \u7684\u8a0a\u606f\uff01 \u5982\u524d\u6240\u8ff0\uff0c\u5728\u4e00\u500b class \u4e2d\u4e5f\u53ef\u4ee5\u8986\u84cb\u73fe\u6709\u7684\u65b9\u6cd5\u3002 \u4f8b\u5982\uff0c\u5982\u679c\u6211\u5011\u5c07 actionHelloWorld() \u6539\u70ba actionIndex() \uff0c\u90a3\u9ebc\u4f60\u5c07\u4e0d\u518d\u6709 \"Notable members\" \u5217\u8868\uff0c\u800c\u662f\u986f\u793a \"Hello world!\" \u8a0a\u606f\uff01 \u4e8b\u5be6\u4e0a\uff0c\u9019\u4e26\u4e0d\u662f\u7e7c\u627f\u73fe\u6709 Controller \u52d5\u4f5c\uff08\u6216\u4efb\u4f55 class \u65b9\u6cd5\uff09\u7684\u6b63\u78ba\u65b9\u5f0f\uff0c\u4f46\u6211\u5011\u6703\u5728 \u4fee\u6539 Controller Action Reply\uff08properly\uff09 \u4e00\u7bc0\u4e2d\u8a73\u7d30\u4ecb\u7d39\u3002","title":"\u7e7c\u627f\u985e"},{"location":"general-concepts/#_6","text":"XF \u4e2d\u7684\u5f88\u591a\u7269\u4ef6\u90fd\u662f\u901a\u904e\u5de5\u5ee0\u65b9\u6cd5\u5be6\u9ad4\u5316\u7684\u3002 \u4f8b\u5982\uff0c\u5982\u679c\u6211\u5011\u60f3\u5be6\u9ad4\u5316\u4e00\u500b\u7279\u5b9a\u7684\u5132\u5b58\u5eab\uff0c\u6211\u5011\u6703\u5beb\u4ee5\u4e0b\u5167\u5bb9\uff1a $repo = \\XF::repository('Demo:Thing'); \u9019\u662f\u4e00\u7a2e\u975e\u5e38\u65b9\u4fbf\u548c\u4e00\u81f4\u7684\u5be6\u9ad4\u5316\u7269\u4ef6\u7684\u65b9\u5f0f\u3002 \u6211\u5011\u53ea\u8981\u770b\u4e00\u773c\uff0c\u5c31\u77e5\u9053\u6703\u5be6\u9ad4\u5316\u4ec0\u9ebc\u7269\u4ef6\u3002 \u8a72\u65b9\u6cd5\u4e2d\u7522\u751f\u7684\u7a0b\u5f0f\u78bc\u77e5\u9053\u5982\u4f55\u70ba\u6211\u5011\u8acb\u6c42\u7684\u6771\u897f\u8fd4\u56de\u6b63\u78ba\u7684\u7269\u4ef6\u3002 \u7136\u800c\uff0c\u4e0d\u5e78\u7684\u662f\uff0c\u4f60\u7684 IDE \u53ef\u80fd\u4e0d\u77e5\u9053\uff08\u81f3\u5c11\u9810\u8a2d\u60c5\u6cc1\u4e0b\u662f\u9019\u6a23\uff09\u3002 \u5c31 IDE \u800c\u8a00\uff0c\u9019\u500b\u65b9\u6cd5\u5c07\u8fd4\u56de\u4e00\u500b XF\\Mvc\\Entity\\Repository \u7684\u7269\u4ef6\u5be6\u9ad4\u3002 \u9019\u5728\u4e00\u5b9a\u7a0b\u5ea6\u4e0a\u662f\u6709\u7528\u7684\uff0c\u4f46\u662f\u5728\u7279\u5b9a\u7684 Demo\\Repository\\Thing \u7269\u4ef6\u4e2d\u53ef\u80fd\u6709\u5f88\u591a\u65b9\u6cd5\u662f\u4f60\u7684 IDE \u4e0d\u77e5\u9053\u7684\u3002 \u9019\u6700\u7d42\u610f\u5473\u8457\uff0c\u7576\u4f60\u8a66\u5716\u5728\u7a0b\u5f0f\u78bc\u4e2d\u4f7f\u7528\u4f60\u7684 $repo \u7269\u4ef6\u6642\uff0c\u4f60\u7684 IDE \u5c07\u7121\u6cd5\u63d0\u51fa\u5efa\u8b70\u6216\u81ea\u52d5\u5b8c\u6210\u65b9\u6cd5\u540d\u548c\u5b83\u6240\u9700\u8981\u7684\u53c3\u6578\u3002 \u9019\u5c31\u662f\u985e\u578b\u63d0\u793a\u7684\u7528\u8655\uff0c\u800c\u4e14\u5927\u591a\u6578 IDE \u548c\u4e00\u4e9b\u80fd\u5920 \"\u8b58\u5225 PHP\" \u7684\u6587\u5b57\u7de8\u8f2f\u5668\u90fd\u61c9\u8a72\u6a19\u6e96\u5730\u652f\u63f4\u9019\u7a2e\u8a9e\u6cd5\u3002 \u6211\u5011\u53ea\u9700\u5c07\u5132\u5b58\u5eab\u7684\u547c\u53eb\u4fee\u6539\u5982\u4e0b\uff1a /** @var \\Demo\\Repository\\Thing $repo */ $repo = \\XF::repository('Demo:Thing'); \u5132\u5b58\u5eab\u547c\u53eb\u4e0a\u9762\u7684\u985e\u578b\u63d0\u793a\u73fe\u5728\u544a\u8a34 IDE\uff0c $repo \u6d89\u53ca\u5230\u4e00\u500b\u7531 Demo\\Repository\\Thing class \u8868\u793a\u7684\u7269\u4ef6\uff0c\u800c\u4e0d\u662f\u539f\u4f86\u81ea\u52d5\u63a8\u65b7\u7684\u7269\u4ef6\u3002 \u985e\u578b\u63d0\u793a\u5728\u7e7c\u627f class \u7684\u6642\u5019\u4e5f\u7279\u5225\u6709\u7528\u3002 \u6211\u5011\u7684 Class extension \u65b9\u6cd5\u6709\u4e00\u500b\u6f5b\u5728\u7684\u554f\u984c\uff0c\u90a3\u5c31\u662f\u57fa\u672c\u4e0a\u4f60\u7684 class \u4e26\u6c92\u6709\u7e7c\u627f\u4f60\u8981\u7e7c\u627f\u7684\u539f class\uff0c\u800c\u662f\u901a\u904e\u4e00\u500b\u5be6\u969b\u4e0a\u4e26\u4e0d\u5b58\u5728\u7684 class \u4f86\u4ee3\u7406\u9019\u500b class\uff0c\u6bd4\u5982 \u4e0a\u9762\u4f8b\u5b50 \u4e2d\u7684 XFCP_Member \u3002 \u70ba\u4e86\u89e3\u6c7a\u9019\u500b\u554f\u984c\uff0c\u6211\u5011\u6703\u81ea\u52d5\u7522\u751f\u4e00\u500b\u540d\u70ba extension_hint.php \u7684\u6a94\u6848\uff0c\u4e26\u5c07\u5176\u5132\u5b58\u5728\u4f60\u7684 _output \u76ee\u9304\u4e0b\u3002 \u9019\u5c31\u589e\u52a0\u4e86\u4e00\u500b IDE \u53ef\u4ee5\u8b80\u53d6\u4f46 PHP \u4e0d\u80fd\u8b80\u53d6\u7684\u53c3\u8003\uff0c\u6240\u4ee5 IDE \u73fe\u5728\u53ef\u4ee5\u7406\u89e3\uff0c\u7576\u6211\u5011\u5728\u9019\u500b\u7e7c\u627f class \u7684\u4efb\u4f55\u65b9\u6cd5\u4e2d\u4f7f\u7528 $this \u6642\uff0c\u5b83\u53ef\u4ee5\u5efa\u8b70\u4e26\u81ea\u52d5\u5b8c\u6210\u5728 Member Controller \u6216\u5176\u7236\u985e\u4e2d\u53ef\u7528\u7684\u65b9\u6cd5\u548c\u5c6c\u6027\u3002","title":"\u985e\u578b\u63d0\u793a"},{"location":"lets-build-an-add-on/","text":"\u5efa\u7acb\u4e00\u500b\u9644\u52a0\u7d44\u4ef6 \u00b6 \u5c0d\u65bc\u4e00\u4e9b\u4eba\u4f86\u8aaa\uff0c\u76f4\u63a5\u9032\u5165\u4e00\u500b\u9805\u76ee\u662f\u6700\u597d\u7684\u5b78\u7fd2\u65b9\u5f0f\uff0c\u6211\u5011\u7684\u76ee\u7684\u662f\u5728\u4e0b\u9762\u7684\u7ae0\u7bc0\u4e2d\uff0c\u60a8\u5c07\u5b78\u7fd2\u5982\u4f55\u5f9e\u982d\u958b\u59cb\u69cb\u5efa\u4e00\u500b\u9644\u52a0\u5143\u4ef6\u3002 \u505a\u597d\u6e96\u5099\uff1b\u9019\u4e0d\u662f\u4e00\u500b\u7c21\u55ae\u7684 'Hello world' \u985e\u578b\u7684\u6f14\u793a\u3002 \u9019\u5be6\u969b\u4e0a\u662f\u4e00\u500b\u529f\u80fd\u76f8\u7576\u9f4a\u5168\u7684\u6f14\u793a\u63d2\u4ef6\uff0c\u6db5\u84cb\u4e86 XF2 \u4e2d\u7684\u8a31\u591a\u6982\u5ff5\u3002 \u6211\u5011\u8981\u5efa\u7acb\u7684\u9644\u52a0\u5143\u4ef6\u5c07\u5141\u8a31\u64c1\u6709\u9069\u7576\u6b0a\u9650\u7684\u7528\u6236 \"\u7cbe\u9078\" \u4e00\u500b\u4e3b\u984c\uff0c\u4e26\u5141\u8a31\u8a72\u4e3b\u984c\u5728\u65b0\u9801\u9762\u4e0a\u986f\u793a\u3002 \u6211\u5011\u751a\u81f3\u6703\u8a2d\u5b9a\u4e00\u500b\u6d41\u7a0b\uff0c\u81ea\u52d5\u5728\u7279\u5b9a\u7684\u8ad6\u58c7\u4e2d\u5c0d\u4e3b\u984c\u9032\u884c\u7cbe\u9078\u8655\u7406\u3002 \u6211\u5011\u5c07\u70ba\u6b64\u4f7f\u7528\u4e00\u500b\u65b0\u7684\u8def\u7531\uff0c\u547d\u540d\u70ba portal \uff0c\u4e26\u6700\u7d42\u5c07\u5176\u8a2d\u5b9a\u70ba\u7d22\u5f15\u9801\u8def\u7531\uff0c\u4e26\u8a2d\u5b9a\u5728\u700f\u89bd\u8a72\u9801\u9762\u6642\u9078\u64c7 \"Home\" \u6a19\u7c64\u3002 \u5efa\u7acb\u9644\u52a0\u5143\u4ef6 \u00b6 \u5728\u6574\u500b\u9644\u52a0\u5143\u4ef6\u4e2d\uff0c\u6211\u5011\u5c07\u4f7f\u7528\u9644\u52a0\u5143\u4ef6 ID \u70ba Demo/Portal \u3002 \u9996\u5148\u6211\u5011\u9700\u8981\u505a\u7684\u662f\u5efa\u7acb\u9644\u52a0\u5143\u4ef6\uff0c\u70ba\u6b64\u6211\u5011\u9700\u8981\u6253\u958b \u547d\u4ee4\u63d0\u793a\u5b57\u5143 / shell / \u7d42\u7aef\u8996\u7a97\uff0c\u5c07\u76ee\u9304\u6539\u70ba\u4f60\u7684 XF \u5b89\u88dd\u6839\u76ee\u9304\uff08\u5373 cmd.php \u6240\u5728\u7684\u4f4d\u7f6e\uff09\uff0c\u7136\u5f8c\u57f7\u884c\u4ee5\u4e0b\u6307\u4ee4\uff0c\u4e26\u8f38\u5165\u4e0b\u9762\u986f\u793a\u7684\u5c0d\u7b56\uff1a Terminal $ php cmd.php xf-addon:create Enter an ID for this add-on: Demo/Portal Enter a title: Demo - Portal Enter a version ID: This integer will be used for internal variable comparisons. Each release of your addon should increase this number: 1000010 Version string set to: 1.0.0 Alpha Does this add-on supersede a XenForo 1 add-on? (y/n) n The addon.json file was successfully written out to /var/www/src/addons/Demo/Portal/addon.json Does your add-on need a Setup file? (y/n) y Does your Setup need to support running multiple steps? (y/n) y The Setup.php file was successfully written out to /var/www/src/addons/Demo/Portal/Setup.php \u9644\u52a0\u5143\u4ef6\u73fe\u5728\u5df2\u7d93\u5efa\u7acb\uff0c\u4f60\u6703\u767c\u73fe\u4f60\u5728 src/addons \u76ee\u9304\u4e0b\u6709\u4e00\u500b\u65b0\u7684\u76ee\u9304\uff0c\u4f60\u6703\u5728 Admin CP \u7684 \"\u5df2\u5b89\u88dd add-ons\" \u5217\u8868\u4e2d\u627e\u5230\u8a72\u9644\u52a0\u5143\u4ef6\u3002 \u5176\u4e2d\u4e00\u500b\u5df2\u7d93\u5efa\u7acb\u7684\u6a94\u6848\u662f addon.json \u6a94\u6848\uff0c\u5b83\u76ee\u524d\u7684\u6a23\u5b50\u662f\u9019\u6a23\u7684\uff1a { \"legacy_addon_id\": \"\", \"title\": \"Demo - Portal\", \"description\": \"\", \"version_id\": 1000010, \"version_string\": \"1.0.0 Alpha\", \"dev\": \"\", \"dev_url\": \"\", \"faq_url\": \"\", \"support_url\": \"\", \"extra_urls\": [], \"require\": [], \"icon\": \"\" } \u8b93\u6211\u5011\u4f86\u586b\u4e00\u4e0b\u9019\u4e9b\u8a73\u7d30\u5167\u5bb9\uff1a { \"legacy_addon_id\": \"\", \"title\": \"Demo - Portal\", \"description\": \"Add-on which will display featured threads on the forum home page.\", \"version_id\": 1000010, \"version_string\": \"1.0.0 Alpha\", \"dev\": \"You!\", \"dev_url\": \"\", \"faq_url\": \"\", \"support_url\": \"\", \"extra_urls\": [], \"require\": [], \"icon\": \"fa-home\" } \u73fe\u5728\uff0c\u6211\u5011\u5df2\u7d93\u65b0\u589e\u4e86 description \uff0c\u958b\u767c\u8005\u7684\u540d\u5b57 ( dev )\uff0c\u4e26\u6307\u5b9a\u6211\u5011\u8981\u986f\u793a\u4e00\u500b\u5716\u793a ( icon )\u3002 \u5716\u793a\u53ef\u4ee5\u662f\u4e00\u500b\u8def\u5f91\uff08\u76f8\u5c0d\u65bc\u4f60\u7684 add-on \u6839\u76ee\u9304\uff09\uff0c\u4e5f\u53ef\u4ee5\u662f\u4e00\u500b Font Awesome \u5716\u793a \u7684\u540d\u7a31\uff0c\u5c31\u50cf\u6211\u5011\u5728\u9019\u88e1\u505a\u7684\u90a3\u6a23\u3002 \u7531\u65bc\u6211\u5011\u4e0d\u662f\u8981\u53d6\u4ee3 XenForo 1 \u9644\u52a0\u5143\u4ef6\uff0c\u6240\u4ee5\u6211\u5011\u53ef\u4ee5\u5ffd\u7565 legacy_addon_id \u3002 \u95dc\u65bc addon.json \u6a94\u6848\u4e2d\u6240\u6709\u5c6c\u6027\u7684\u5b8c\u6574\u89e3\u91cb\uff0c\u8acb\u53c3\u8003 \u9644\u52a0\u5143\u4ef6\u7d50\u69cb\u90e8\u5206 \u3002 \u5efa\u7acb Setup \u985e \u00b6 \u597d\u5427\uff0c\u56b4\u683c\u4f86\u8aaa\uff0c\u9019\u500b\u985e\u5df2\u7d93\u88ab\u5efa\u7acb\u4e26\u5beb\u5165\u4e86 Setup.php \uff0c\u4f46\u73fe\u5728\u5b83\u4e26\u6c92\u6709\u771f\u6b63\u505a\u4ec0\u9ebc\u3002 \u6211\u5011\u57fa\u672c\u4e0a\u5df2\u7d93\u6709\u4e86\u4e00\u500b class \u9aa8\u67b6\uff0c\u5b83\u770b\u8d77\u4f86\u50cf\u9019\u6a23\uff1a <?php namespace Demo\\Portal; use XF\\AddOn\\AbstractSetup; use XF\\AddOn\\StepRunnerInstallTrait; use XF\\AddOn\\StepRunnerUninstallTrait; use XF\\AddOn\\StepRunnerUpgradeTrait; class Setup extends AbstractSetup { use StepRunnerInstallTrait; use StepRunnerUpgradeTrait; use StepRunnerUninstallTrait; } \u6211\u5011\u5df2\u7d93\u8ac7\u904e\u4e00\u9ede\u95dc\u65bc Setup \u985e\u7684\u5167\u5bb9\u3002 \u6211\u5011\u5c07\u628a\u5b89\u88dd\u3001\u5347\u7d1a\u548c\u89e3\u9664\u5b89\u88dd\u904e\u7a0b\u5206\u6210\u4e0d\u540c\u7684\u6b65\u9a5f\u3002 \u8b93\u6211\u5011\u5f9e\u532f\u5165\u4e00\u4e9b\u6709\u7528\u7684 Schema \u985e\u958b\u59cb\u3002 \u5982\u679c\u4f60\u60f3\u4e86\u89e3\u66f4\u591a\u95dc\u65bc\u5b83\u5011\u7684\u8cc7\u8a0a\uff0c\u4f60\u53ef\u4ee5\u53c3\u8003 \u7ba1\u7406 Schema \u90e8\u5206 \u3002 \u5728\u6700\u5f8c\u4e00\u500b use \u8072\u660e\u4e4b\u5f8c\uff0c\u65b0\u589e\u4ee5\u4e0b\u5e7e\u884c\uff1a use XF\\Db\\Schema\\Alter; use XF\\Db\\Schema\\Create; \u9019\u88e1\u7684 StepRunner \u7279\u6027\u5c07\u8655\u7406\u6240\u6709\u53ef\u7528\u6b65\u9a5f\u7684\u5faa\u74b0\u904e\u7a0b\uff0c\u6240\u4ee5\u6211\u5011\u8981\u505a\u7684\u5c31\u662f\u958b\u59cb\u5efa\u7acb\u9019\u4e9b\u6b65\u9a5f\u3002 \u6211\u5011\u9996\u5148\u65b0\u589e\u4e00\u4e9b\u7a0b\u5f0f\u78bc\uff0c\u5728 xf_forum \u8cc7\u6599\u8868\u4e2d\u5efa\u7acb\u4e00\u500b\u65b0\u7684 column\uff1a <?php namespace Demo\\Portal; use XF\\AddOn\\AbstractSetup; use XF\\AddOn\\StepRunnerInstallTrait; use XF\\AddOn\\StepRunnerUninstallTrait; use XF\\AddOn\\StepRunnerUpgradeTrait; use XF\\Db\\Schema\\Alter; use XF\\Db\\Schema\\Create; class Setup extends \\XF\\AddOn\\AbstractSetup { use StepRunnerInstallTrait; use StepRunnerUpgradeTrait; use StepRunnerUninstallTrait; public function installStep1() { $this->schemaManager()->alterTable('xf_forum', function(Alter $table) { $table->addColumn('demo_portal_auto_feature', 'tinyint')->setDefault(0); }); } } \u9019\u4e00 column \u88ab\u65b0\u589e\u5230 xf_forum \u8cc7\u6599\u8868\u4e2d\uff0c\u9019\u6a23\u6211\u5011\u5c31\u53ef\u4ee5\u8a2d\u5b9a\u67d0\u4e9b\u8ad6\u58c7\u5728\u5efa\u7acb\u4e3b\u984c\u6642\u81ea\u52d5\u986f\u793a\u3002 \u9019\u88e1\u7684\u547d\u540d\u5f88\u91cd\u8981\uff0c\u65b0\u589e\u5230\u6838\u5fc3 XF \u8cc7\u6599\u8868\u4e2d\u7684 columns \u7e3d\u662f\u61c9\u8a72\u6709\u524d\u7db4\u3002 \u9019\u6709\u5169\u500b\u91cd\u8981\u7684\u76ee\u7684\u3002 \u7b2c\u4e00\u500b\u662f\u6e1b\u5c11\u4e86\u91cd\u8907 column \u540d\u767c\u751f\u885d\u7a81\u7684\u98a8\u96aa\uff0c\u4ee5\u9632 XF \u6216\u5176\u4ed6\u9644\u52a0\u5143\u4ef6\u6709\u7406\u7531\u5728\u5c07\u4f86\u65b0\u589e\u8a72 column\u3002 \u7b2c\u4e8c\u500b\u76ee\u7684\u662f\uff0c\u5b83\u6709\u52a9\u65bc\u66f4\u5bb9\u6613\u5730\u8b58\u5225\u54ea\u4e9b columns \u5c6c\u65bc\u54ea\u4e9b\u9644\u52a0\u5143\u4ef6\uff0c\u4ee5\u9632\u5c07\u4f86\u51fa\u73fe\u4e00\u4e9b\u554f\u984c\u3002 \u65e2\u7136\u5982\u6b64\uff0c\u6211\u5011\u4e0d\u59a8\u5728\u5b89\u88dd\u7a0b\u5f0f\u4e2d\u518d\u589e\u52a0\u4e00\u500b\u6b65\u9a5f\u3002 \u70ba\u4e86\u7c21\u6f54\u8d77\u898b\uff0c\u6211\u5011\u53ea\u986f\u793a\u65b0\u7a0b\u5f0f\u78bc\uff0c\u800c\u4e0d\u662f\u6574\u500b\u985e\u3002 \u5b83\u61c9\u8a72\u76f4\u63a5\u653e\u5728 installStep1() \u65b9\u6cd5\u7684\u4e0b\u9762\uff1a public function installStep2() { $this->schemaManager()->alterTable('xf_thread', function(Alter $table) { $table->addColumn('demo_portal_featured', 'tinyint')->setDefault(0); }); } \u9019\u4e00\u6b65\u9a5f\u8207\u4e0a\u9762\u7684\u6b65\u9a5f\u985e\u4f3c\uff0c\u9019\u6b21\u5c07\u5728 xf_thread \u8cc7\u6599\u8868\u4e2d\u65b0\u589e\u4e00\u500b\u65b0 column\u3002 \u6211\u5011\u5c07\u4f7f\u7528\u9019\u4e00 column \u4f5c\u70ba\u4e00\u500b\u5feb\u53d6\u503c\u4f86\u5feb\u901f\u8b58\u5225\u4e00\u500b\u4e3b\u984c\u662f\u5426\u6709\u7cbe\u9078\uff0c\u800c\u4e0d\u9700\u8981\u91dd\u5c0d xf_demo_portal_featured_thread \u8cc7\u6599\u8868\u67e5\u627e\u6216\u9032\u884c\u984d\u5916\u7684\u67e5\u8a62\u3002 \u8aaa\u5230\u9019\u88e1\uff0c\u6211\u5011\u73fe\u5728\u61c9\u8a72\u628a\u90a3\u500b\u8cc7\u6599\u8868\u52a0\u9032\u53bb\u4e86\u3002 \u9019\u6b21\u76f4\u63a5\u52a0\u5728 installStep2() \u4e0b\u9762\uff1a public function installStep3() { $this->schemaManager()->createTable('xf_demo_portal_featured_thread', function(Create $table) { $table->addColumn('thread_id', 'int'); $table->addColumn('featured_date', 'int'); $table->addPrimaryKey('thread_id'); }); } \u9019\u4e00\u6b65\u5c07\u5efa\u7acb\u65b0\u7684\u8cc7\u6599\u8868\u3002 \u9019\u5f35\u8cc7\u6599\u8868\u5c07\u7528\u4f86\u8a18\u9304\u6240\u6709\u88ab\u7cbe\u9078\u7684\u4e3b\u984c\uff0c\u4ee5\u53ca\u5b83\u5011\u88ab\u7cbe\u9078\u7684\u6642\u9593\u3002 \u5728\u547d\u540d\u65b9\u9762\uff0c\u540c\u6a23\u7684\u539f\u5247\u4e5f\u9069\u7528\u65bc\u6b64\u3002 \u4e00\u500b\u91cd\u8981\u7684\u5340\u5225\u662f\uff0c\u6240\u6709\u7684\u8cc7\u6599\u8868\u90fd\u61c9\u8a72\u53e6\u5916\u52a0\u4e0a xf_ \u7684\u524d\u7db4\u3002 \u9019\u6a23\u505a\u7684\u539f\u56e0\u662f\uff0c\u5982\u679c\u9032\u884c\u4e86\u4e7e\u6de8\u7684 XF \u5b89\u88dd\uff0c\u6211\u5011\u53ef\u4ee5\u522a\u9664\u6240\u6709\u5e36\u6709 xf_ \u524d\u7db4\u7684\u8cc7\u6599\u8868\uff0c\u5305\u62ec\u90a3\u4e9b\u7531\u9644\u52a0\u5143\u4ef6\u5efa\u7acb\u7684\u8cc7\u6599\u8868\u3002 \u5728\u65b0\u589e\u7a0b\u5f0f\u78bc\u6642\uff0c\u6700\u5bb9\u6613\u5fd8\u8a18\u7684\u4e00\u4ef6\u4e8b\u5c31\u662f\uff0c\u6dfb\u52a0\u4e86\u5404\u7a2e schema \u66f4\u6539\u5f8c\u5fd8\u8a18\u81ea\u5df1\u5957\u7528\u7684 schema \u66f4\u6539\u3002 \u4f60\u53ef\u4ee5\u4f7f\u7528 CLI \u6307\u4ee4\u57f7\u884c \u5b89\u88dd/\u5347\u7d1a \u6b65\u9a5f\u3002 \u5728\u9019\u7a2e\u60c5\u6cc1\u4e0b\uff0c\u57f7\u884c\u4ee5\u4e0b\u6307\u4ee4\uff1a Terminal $ php cmd.php xf-addon:install-step Demo/Portal 1 $ php cmd.php xf-addon:install-step Demo/Portal 2 $ php cmd.php xf-addon:install-step Demo/Portal 3 \u7e7c\u627f\u8ad6\u58c7\u5be6\u9ad4 \u00b6 \u5230\u76ee\u524d\u70ba\u6b62\uff0c\u6211\u5011\u5df2\u7d93\u5728 xf_forum \u8cc7\u6599\u8868\u4e2d\u65b0\u589e\u4e86\u4e00 column\uff0c\u73fe\u5728\u662f\u6642\u5019\u7e7c\u627f\u8ad6\u58c7 Entity \u7d50\u69cb\u4e86\u3002 \u6211\u5011\u9700\u8981\u9019\u6a23\u505a\uff0c\u4ee5\u4fbf Entity \u77e5\u9053\u6211\u5011\u7684\u65b0 column\uff0c\u4e26\u4e14\u53ef\u4ee5\u901a\u904e Entity \u5411\u5176\u8b80\u5beb\u8cc7\u6599\u3002 Note \u4ee5\u4e0b\u6b65\u9a5f\u9700\u8981\u555f\u7528 \u958b\u767c\u6a21\u5f0f \u3002 \u8a18\u5f97\u5728 config.php \u4e2d\u8a2d\u5b9a Demo/Portal \u70ba defaultAddOn \u503c\u3002 \u9019\u500b\u904e\u7a0b\u7684\u7b2c\u4e00\u6b65\u662f\u5efa\u7acb\u4e00\u500b \"\u7a0b\u5f0f\u78bc\u4e8b\u4ef6\u76e3\u807d\u5668\"\u3002 \u9019\u53ef\u4ee5\u5728\u958b\u767c\u4e0b\u7684 Admin CP \u4e2d\uff0c\u9ede\u9078 \"\u7a0b\u5f0f\u78bc\u4e8b\u4ef6\u76e3\u807d\u5668\" \u9023\u7d50\uff0c\u7136\u5f8c\u9ede\u9078 \"\u65b0\u589e\u7a0b\u5f0f\u78bc\u4e8b\u4ef6\u76e3\u807d\u5668\" \u6309\u9215\u3002 \u6211\u5011\u9700\u8981\u76e3\u807d entity_structure \u4e8b\u4ef6\u3002 \u6211\u5011\u5c07\u4f7f\u7528\u5b83\u4f86\u4fee\u6539\u9810\u8a2d\u7684\u8ad6\u58c7 Entity \u7d50\u69cb\uff0c\u4ee5\u65b0\u589e\u6211\u5011\u65b0\u5efa\u7acb\u7684 demo_portal_auto_feature column\u3002 \u5728 \"\u4e8b\u4ef6\u63d0\u793a\" \u6b04\u4f4d\u4e2d\uff0c\u6211\u5011\u5c07\u8f38\u5165\u8981\u7e7c\u627f\u7684\u985e\u540d\uff0c\u4f8b\u5982 XF\\Entity\\Forum \u3002 \u9019\u5c07\u78ba\u4fdd\u6211\u5011\u7684\u76e3\u807d\u5668\u53ea\u5728\u8ad6\u58c7 Entity \u4e0a\u57f7\u884c\u3002 \u5c0d\u65bc \"\u57f7\u884c callback\" \u985e\u8f38\u5165 Demo\\Portal\\Listener \uff0c\u5c0d\u65bc\u65b9\u6cd5\u8f38\u5165 forumEntityStructure \u3002 \u503c\u5f97\u65b0\u589e\u4e00\u500b\u63cf\u8ff0\u4f86\u89e3\u91cb\u9019\u500b\u76e3\u807d\u5668\u7684\u7528\u9014\uff0c\u56e0\u70ba\u9019\u5c07\u6709\u52a9\u65bc\u66f4\u5bb9\u6613\u5730\u5728\u7a0b\u5f0f\u78bc\u4e8b\u4ef6\u76e3\u807d\u5668\u5217\u8868\u4e2d\u8b58\u5225\u76e3\u807d\u5668\u3002 \"\u7e7c\u627f XF\\Entity\\Forum \u7d50\u69cb\" \u61c9\u8a72\u5c31\u5920\u4e86\u3002 \u6700\u5f8c\uff0c\u78ba\u4fdd \"Demo - Portal\" \u9644\u52a0\u5143\u4ef6\u88ab\u9078\u4e2d\u3002 \u5728\u9ede\u9078 \"\u5132\u5b58\" \u4e4b\u524d\uff0c\u6211\u5011\u9700\u8981\u5be6\u969b\u5efa\u7acb Listener \u985e\u3002 \u6240\u4ee5\u5728 src/addons/Demo/Portal \u4e2d\u5efa\u7acb\u4e00\u500b\u540d\u70ba Listener.php \u7684\u65b0\u6a94\u6848\u3002 \u9019\u500b\u6a94\u6848\u7684\u5167\u5bb9\u6700\u521d\u61c9\u8a72\u662f\u9019\u6a23\u7684\u3002 \u6211\u5011\u5f9e\u7a0b\u5f0f\u78bc\u4e8b\u4ef6\u9078\u64c7\u5668\u4e0b\u9762\u7684\u6a94\u6848\u4e2d\u77e5\u9053\u9019\u500b\u51fd\u6578\u9700\u8981\u7684\u53c3\u6578\u3002 <?php namespace Demo\\Portal; use XF\\Mvc\\Entity\\Entity; class Listener { public static function forumEntityStructure(\\XF\\Mvc\\Entity\\Manager $em, \\XF\\Mvc\\Entity\\Structure &$structure) { } } \u6ce8\u610f namespace \u548c class \u540d\u7a31\u4e4b\u9593\u7684 use \u5ba3\u544a\u3002 \u6211\u5011\u5c07\u4e0d\u6b62\u4e00\u6b21\u5730\u5f15\u7528\u9019\u88e1\u5ba3\u544a\u7684 class\uff0c\u56e0\u6b64\u5728\u9019\u88e1\u5ba3\u544a\u5b83\u78ba\u5be6\u5141\u8a31\u6211\u5011\u7528\u5b83\u66f4\u77ed\u7684\u5225\u540d\u4f86\u5f15\u7528\u5b83\uff0c\u5728\u672c\u4f8b\u4e2d\u662f Entity \u3002 \u9019\u6bb5\u7a0b\u5f0f\u78bc\u5be6\u969b\u4e0a\u9084\u4e0d\u6703\u505a\u4efb\u4f55\u4e8b\u60c5\uff0c\u4f46\u73fe\u5728\u662f\u5132\u5b58\u7a0b\u5f0f\u78bc\u4e8b\u4ef6\u76e3\u807d\u5668\u7684\u597d\u6642\u6a5f\uff0c\u6240\u4ee5\u8acb\u7e7c\u7e8c\u9ede\u9078 \"\u5132\u5b58\" \u6309\u9215\u3002 \u5728\u6211\u5011\u70ba\u65b0\u51fd\u6578\u6dfb\u52a0\u4e00\u4e9b\u529f\u80fd\u7a0b\u5f0f\u78bc\u4e4b\u524d\uff0c\u73fe\u5728\u4e5f\u8a31\u662f\u500b\u5f88\u597d\u7684\u6642\u6a5f\u4f86\u770b\u770b\u958b\u767c\u8f38\u51fa\u7cfb\u7d71\u662f\u5982\u4f55\u904b\u4f5c\u7684\u3002 \u6aa2\u67e5\u4e00\u4e0b\u65b0\u589e\u5230\u4f60 add-on \u76ee\u9304\u4e2d\u7684\u65b0\u76ee\u9304\u548c\u6a94\u6848\u3002 \u7279\u5225\u662f\u5728 _output/code_event_listeners \u76ee\u9304\u4e0b\u6709\u4e00\u500b\u65b0\u7684 JSON \u6a94\u6848\uff0c\u5b83\u61c9\u8a72\u662f\u9019\u6a23\u7684\uff1a { \"event_id\": \"entity_structure\", \"execute_order\": 10, \"callback_class\": \"Demo\\\\Portal\\\\Listener\", \"callback_method\": \"forumEntityStructure\", \"active\": true, \"hint\": \"XF\\\\Entity\\\\Forum\", \"description\": \"Extends the XF\\\\Entity\\\\Forum structure\" } \u6bcf\u7576\u76e3\u807d\u5668\u767c\u751f\u8b8a\u5316\u6642\uff0c\u9019\u500b\u6a94\u6848\u6703\u81ea\u52d5\u66f4\u65b0\u3002 \u597d\u4e86\uff0c\u6211\u5011\u518d\u4f86\u65b0\u589e\u4e00\u4e9b\u7a0b\u5f0f\u78bc\u3002 \u56de\u5230 Listener \u985e\u4e2d\uff0c\u5728 forumEntityStructure \u51fd\u6578\u4e2d\u65b0\u589e\u4ee5\u4e0b\u5167\u5bb9\uff1a $structure->columns['demo_portal_auto_feature'] = ['type' => Entity::BOOL, 'default' => false]; \u8ad6\u58c7 Entity \u73fe\u5728\u5df2\u7d93\u77e5\u9053\u4e86\u6211\u5011\u7684\u65b0 column\uff0c\u4f46\u5728\u958b\u59cb\u5be6\u4f5c\u5c0d\u8a72 column \u9032\u884c\u5be6\u969b\u8a2d\u5b9a\u503c\u7684\u65b9\u6cd5\u4e4b\u524d\uff0c\u6211\u5011\u9084\u9700\u8981\u5148\u8655\u7406\u5e7e\u500b\u6b65\u9a5f\u3002 \u7e7c\u627f\u4e3b\u984c\u5be6\u9ad4 \u00b6 \u540c\u6a23\uff0c\u7531\u65bc\u6211\u5011\u5728 xf_thread \u8cc7\u6599\u8868\u4e2d\u65b0\u589e\u4e86\u4e00\u500b\u65b0\u7684 column\uff0c\u6211\u5011\u61c9\u8a72\u8b93\u4e3b\u984c\u5be6\u9ad4\u77e5\u9053\u9019\u4e00\u9ede\u3002 \u9019\u8207\u6211\u5011\u4e0a\u9762\u7684\u4f5c\u6cd5\u975e\u5e38\u76f8\u4f3c\u3002 \u56de\u5230 \"\u65b0\u589e\u7a0b\u5f0f\u78bc\u4e8b\u4ef6\u76e3\u807d\u5668\"\uff0c\u518d\u6b21\u76e3\u807d entity_structure \u3002 \u9019\u6b21\u7684 \"\u4e8b\u4ef6\u63d0\u793a\" \u5c07\u662f XF\\Entity\\Thread \u3002 \u6211\u5011\u53ef\u4ee5\u4f7f\u7528\u8207\u4e4b\u524d\u76f8\u540c\u7684 callback \u985e\uff08 Demo\\Portal\\Listener \uff09\uff0c\u4f46\u9019\u6b21\u7684\u65b9\u6cd5\u5c07\u547d\u540d\u70ba threadEntityStructure \u3002 \u65b0\u589e\u985e\u4f3c\u4e4b\u524d\u7684\u63cf\u8ff0\u3002 \u5728\u5132\u5b58\u4e4b\u524d\uff0c\u6211\u5011\u61c9\u8a72\u5728 forumEntityStructure \u51fd\u6578\u4e0b\u9762\u76f4\u63a5\u65b0\u589e\u7a0b\u5f0f\u78bc\uff1a public static function threadEntityStructure(\\XF\\Mvc\\Entity\\Manager $em, \\XF\\Mvc\\Entity\\Structure &$structure) { $structure->columns['demo_portal_featured'] = ['type' => Entity::BOOL, 'default' => false]; } \u9019\u6bb5\u7a0b\u5f0f\u78bc\u8207\u6211\u5011\u5728\u8ad6\u58c7 Entity \u7d50\u69cb\u4e2d\u65b0\u589e\u7684\u7a0b\u5f0f\u78bc\u5e7e\u4e4e\u76f8\u540c\uff0c\u552f\u4e00\u4e0d\u540c\u7684\u662f column \u540d\u3002 \u4f46\u662f\uff0c\u6211\u5011\u78ba\u5be6\u9700\u8981\u65b0\u589e\u4e00\u4e9b\u5176\u4ed6\u7684\u6771\u897f\u3002 \u6211\u5011\u61c9\u8a72\u5efa\u7acb\u4e00\u500b Entity \u95dc\u806f\uff0c\u9019\u6a23\uff0c\u4ee5\u5f8c\u6211\u5011\u9700\u8981\u8a2a\u554f\u7cbe\u9078\u4e3b\u984c Entity\uff08\u6211\u5011\u5728\u4e0b\u4e00\u7bc0\u5efa\u7acb\uff09\u6642\uff0c\u6211\u5011\u5c31\u53ef\u4ee5\u5f88\u5bb9\u6613\u5730\u901a\u904e Finder \u67e5\u8a62\u4f86\u5be6\u73fe\u3002 \u5728 $structure->columns \u884c\u4e0b\u9762\u65b0\u589e\uff1a $structure->relations['FeaturedThread'] = [ 'entity' => 'Demo\\Portal:FeaturedThread', 'type' => Entity::TO_ONE, 'conditions' => 'thread_id', 'primary' => true ]; \u6709\u95dc \u95dc\u806f \u7684\u66f4\u591a\u8cc7\u8a0a\uff0c\u8acb\u53c3\u898b\u95dc\u806f\u3002 \u9ede\u9078 \"\u5132\u5b58\" \u4f86\u5132\u5b58\u76e3\u807d\u5668\u3002 \u5efa\u7acb\u4e00\u500b\u65b0\u5be6\u9ad4 \u00b6 \u4e0a\u9762\u5728 installStep3() \u4e2d\uff0c\u6211\u5011\u5efa\u7acb\u4e86\u4e00\u500b\u65b0\u8cc7\u6599\u8868\u3002 \u6211\u5011\u9700\u8981\u5efa\u7acb\u4e00\u500b Entity \u4f86\u8207\u9019\u500b\u8cc7\u6599\u8868\u4e92\u52d5\u4e26\u5efa\u7acb\u65b0\u7684\u8a18\u9304\u3002 \u56e0\u70ba\u9019\u662f\u4e00\u500b\u5168\u65b0\u7684 Entity\uff0c\u6211\u5011\u9664\u4e86\u5728 src/addons/Demo/Portal/Entity/FeaturedThread.php \u4e2d\u5efa\u7acb class \u4e4b\u5916\uff0c\u4e0d\u9700\u8981\u505a\u4efb\u4f55\u5176\u4ed6\u7684\u4e8b\u60c5\uff0c\u5b83\u7684\u67b6\u69cb\u770b\u8d77\u4f86\u50cf\u9019\u6a23\uff1a <?php namespace Demo\\Portal\\Entity; use XF\\Mvc\\Entity\\Structure; class FeaturedThread extends \\XF\\Mvc\\Entity\\Entity { } \u6211\u5011\u9700\u8981\u7528\u5b83\u4f86\u5b9a\u7fa9 Entity \u7d50\u69cb\uff0c\u5b83\u4ee3\u8868\u6211\u5011\u4e4b\u524d\u5efa\u7acb\u7684\u65b0 xf_demo_portal_featured_thread \u8cc7\u6599\u8868\u3002 \u9019\u500b Entity \u7684\u7d50\u69cb\u61c9\u8a72\u662f\u9019\u6a23\u7684\uff1a public static function getStructure(Structure $structure) { $structure->table = 'xf_demo_portal_featured_thread'; $structure->shortName = 'Demo\\Portal:FeaturedThread'; $structure->primaryKey = 'thread_id'; $structure->columns = [ 'thread_id' => ['type' => self::UINT, 'required' => true], 'featured_date' => ['type' => self::UINT, 'default' => time()] ]; $structure->getters = []; $structure->relations = [ 'Thread' => [ 'entity' => 'XF:Thread', 'type' => self::TO_ONE, 'conditions' => 'thread_id', 'primary' => true ], ]; return $structure; } \u6839\u64da\u6211\u5011\u524d\u9762\u5beb\u7684 MySQL \u5efa\u7acb\u8cc7\u6599\u8868\uff0ccolumns \u7684\u5217\u8868\u5927\u6982\u4e0d\u9700\u8981\u52a0\u4ee5\u8aaa\u660e\u3002 \u95dc\u806f\u4e2d\u5305\u62ec\u4e00\u500b Thread \u95dc\u806f\uff0c\u5b83\u5c07\u5141\u8a31\u6211\u5011\u5f9e\u9019\u500b Entity \u4e2d\u7372\u5f97\u76f8\u95dc\u7684\u4e3b\u984c Entity \u8a18\u9304\uff08\u751a\u81f3\u4e3b\u984c Entity \u95dc\u806f\uff09\u3002 \u4fee\u6539\u8ad6\u58c7\u7de8\u8f2f\u8868\u55ae \u00b6 \u6211\u5011\u73fe\u5728\u9700\u8981\u4e00\u7a2e\u65b9\u6cd5\u4f86\u4fee\u6539 forum_edit \u6a21\u677f\uff0c\u5728\u90a3\u88e1\u65b0\u589e\u4e00\u500b\u65b0\u7684 checkbox\uff0c\u6700\u7d42\u53ef\u4ee5\u5beb\u56de\u6211\u5011\u73fe\u5728\u5efa\u7acb\u7684\u65b0 column\u3002 \u6211\u5011\u5c07\u901a\u904e\u5efa\u7acb\u4e00\u500b\u6a21\u677f\u4fee\u6539\u4f86\u5be6\u73fe\u3002 \u9019\u662f\u5728 Admin CP \u4e0b\u7684\u5916\u89c0\u4e2d\u5b8c\u6210\u7684\uff0c\u7136\u5f8c\u9ede\u9078\u6a21\u677f\u4fee\u6539\u3002 \u9ede\u9078 \"Admin\" \u6a19\u7c64\uff0c\u7136\u5f8c\u518d\u9ede\u9078 \"\u65b0\u589e\u6a21\u677f\u4fee\u6539\" \u6309\u9215\u3002 \u5728 \"\u6a21\u677f\" \u6b04\u4e2d\uff0c\u8f38\u5165 \"forum_edit\"\u3002 \u9019\u5c31\u662f\u6211\u5011\u9700\u8981\u4fee\u6539\u7684\u6a21\u677f\u3002 \u5728 \"\u4fee\u6539 key\" \u6b04\u4f4d\u4e2d\uff0c\u8f38\u5165 \"demo_portal_forum_edit\"\u3002 \u9019\u662f\u4e00\u500b\u552f\u4e00\u7684 key\uff0c\u7528\u65bc\u6a19\u8b58\u60a8\u7684\u6a21\u677f\u4fee\u6539\u3002 \u9019\u90e8\u5206\u6700\u597d\u7684\u7fd2\u6163\u662f\uff0c\u6700\u8d77\u78bc\u8981\u5728\u88ab\u4fee\u6539\u7684\u6a21\u677f\u540d\u7a31\u5f8c\u9762\u8a3b\u660e\u9644\u52a0\u5143\u4ef6\u3002 \"\u63cf\u8ff0\" \u6b04\u4f4d\u61c9\u8a72\u5305\u542b\u4e00\u4e9b\u6587\u5b57\uff0c\u4ee5\u5e6b\u52a9\u60a8\u5728\u67e5\u770b\u6a21\u677f\u4fee\u6539\u5217\u8868\u6642\u78ba\u5b9a\u6b64\u4fee\u6539\u7684\u76ee\u7684\u3002 \u5c31\u50cf\u662f \"\u65b0\u589e\u81ea\u52d5\u7cbe\u9078 checkbox \u5230 forum_edit \u6a21\u677f\" \u9019\u6a23\u7684\u5167\u5bb9\u61c9\u8a72\u8db3\u5920\u4e86\u3002 \u7576\u60a8\u5728 \"\u6a21\u677f\" \u6b04\u4f4d\u4e2d\u8f38\u5165\u6a21\u677f\u540d\u7a31\u6642\uff0c\u60a8\u53ef\u80fd\u6703\u6ce8\u610f\u5230\u986f\u793a\u4e86\u6a21\u677f\u5167\u5bb9\u7684\u9810\u89bd\u3002 \u6211\u5011\u9700\u8981\u5229\u7528\u9019\u500b\u4f86\u78ba\u5b9a checkbox \u7684\u504f\u597d\u4f4d\u7f6e\u3002 \u5728\u67e5\u770b\u8ad6\u58c7\u7de8\u8f2f\u9801\u9762\u6642\uff0c\u4f60\u53ef\u80fd\u6703\u6ce8\u610f\u5230\u6709\u4e00\u7cfb\u5217\u7684 checkbox\uff0c\u9019\u770b\u8d77\u4f86\u662f\u4e00\u500b\u5408\u7406\u7684\u4f4d\u7f6e\u3002 \u6700\u7c21\u55ae\u7684\u65b9\u6cd5\u662f\u5728\u9019\u500b\u90e8\u5206\u653e\u7f6e\u4e00\u500b checkbox\uff0c\u5c0d\u4e0a\u9762\u7684 checkbox \u9032\u884c\u7c21\u55ae\u7684\u66ff\u63db\uff0c\u6240\u4ee5\u5728 \"\u67e5\u8a62\" \u6b04\u4e2d\u65b0\u589e\uff1a <xf:option name=\"allow_posting\" \u4e26\u5728\u6b04\u4f4d\u4e2d\u66ff\u63db\uff1a <xf:option name=\"demo_portal_auto_feature\" selected=\"$forum.demo_portal_auto_feature\" label=\"Automatically feature threads in this forum\" hint=\"If selected, any new threads posted in this forum will be automatically featured.\" /> $0 \u6211\u5011\u9084\u4e0d\u9700\u8981\u64d4\u5fc3\u5efa\u7acb\u77ed\u8a9e\u7684\u554f\u984c\uff0c\u6211\u5011\u53ef\u4ee5\u7a0d\u5f8c\u518d\u4f86\u62fe\u53d6\u9019\u4e9b\u3002 \u6ce8\u610f\uff0c\u540d\u7a31\u5c6c\u6027\u5fc5\u9808\u8207\u6211\u5011\u4e4b\u524d\u5efa\u7acb\u7684 column \u540d\u76f8\u5339\u914d\uff0c\u66f4\u91cd\u8981\u7684\u662f\uff0ccheckbox row \u7684\u52fe\u9078\u72c0\u614b\u4e5f\u662f\u5f9e\u8ad6\u58c7 Entity \u4e2d\u8b80\u53d6\u65b0\u589e\u52a0\u7684 column\u3002 \u7576\u6211\u5011\u7a0d\u5f8c\u5132\u5b58\u6a21\u677f\u4fee\u6539\u6642\uff0c\u5982\u679c\u67e5\u8a62\u6b04\u4f4d\u7684\u5167\u5bb9\u8207\u6a21\u677f\u7684\u4efb\u4f55\u90e8\u5206\u76f8\u5339\u914d\uff0c\u90a3\u9ebc\u5b83\u5c07\u88ab\u66ff\u63db\u6b04\u4f4d\u7684\u5167\u5bb9\u6240\u53d6\u4ee3\u3002 \u5be6\u969b\u4e0a\u6211\u5011\u4e26\u6c92\u6709\u522a\u9664\u5339\u914d\u7684\u5167\u5bb9\uff0c\u56e0\u70ba\u66ff\u63db\u6b04\u4f4d\u4e2d\u7684 $0 \u662f\u91cd\u65b0\u63d2\u5165\u5339\u914d\u7684\u6587\u5b57\u3002 \u6211\u5011\u53ef\u4ee5\u4f7f\u7528 \"\u6e2c\u8a66\" \u6309\u9215\u4f86\u6aa2\u67e5\u66ff\u63db\u7684\u904b\u4f5c\u662f\u5426\u7b26\u5408\u9810\u671f\u3002 \u7576\u9ede\u64ca\u6e2c\u8a66\u6309\u9215\u6642\uff0c\u6703\u51fa\u73fe\u4e00\u500b\u8986\u84cb\u5c64\u5e36\u6709\u4fee\u6539\u5f8c\u7684\u6a21\u677f\u3002 \u5982\u679c\u4e00\u5207\u9806\u5229\uff0c\u4e00\u500b\u7da0\u8272\u5340\u57df\u61c9\u8a72\u9ad8\u4eae\u986f\u793a\u6211\u5011\u8981\u6dfb\u52a0\u7684\u65b0\u7a0b\u5f0f\u78bc\u3002 Note \u9019\u662f\u4e00\u500b\u76f8\u7576\u7c21\u55ae\u7684\u66ff\u63db\u3002 \u5c0d\u65bc\u66f4\u9032\u968e\u7684\u5339\u914d\uff0c\u4f60\u4e5f\u53ef\u4ee5\u4f7f\u7528 \"\u6b63\u898f\u8868\u9054\u5f0f\" \u985e\u578b\u3002 \u95dc\u65bc\u4f7f\u7528\u6b63\u898f\u8868\u9054\u5f0f\u7684\u8a73\u7d30\u89e3\u91cb\u8d85\u51fa\u4e86\u672c\u6307\u5357\u7684\u7bc4\u570d\uff0c\u4f46\u7db2\u4e0a\u6709\u5f88\u591a\u8cc7\u6e90\u53ef\u80fd\u6703\u6709\u6240\u5e6b\u52a9\u3002 \u6700\u5f8c\uff0c\u9ede\u9078\u5132\u5b58\uff0c\u5132\u5b58\u4f60\u7684\u6a21\u677f\u4fee\u6539\u3002 \u5982\u679c\u4e00\u5207\u9806\u5229\uff0c\u7576\u4f60\u8fd4\u56de\u6a21\u677f\u4fee\u6539\u5217\u8868\u6642\uff0c\u4f60\u6703\u770b\u5230\u65e5\u8a8c\u6458\u8981\u986f\u793a 1 / 0 / 0 \u56e0\u6b64\u8868\u660e\u4fee\u6539\u6210\u529f\u5957\u7528\u4e00\u6b21\u3002 \u4e00\u500b\u66f4\u597d\u7684\u6307\u793a\u662f\u9032\u5165 Admin CP \u4e2d \"\u8ad6\u58c7\" \u4e0b\u7684 \"\u7bc0\u9ede\" \u9801\u9762\uff0c\u7de8\u8f2f\u4e00\u500b\u73fe\u6709\u7684\u8ad6\u58c7\u3002 \u73fe\u5728\u61c9\u8a72\u6703\u51fa\u73fe\u6211\u5011\u65b0\u6dfb\u52a0\u7684\u6a21\u677f\u4fee\u6539\u3002 \u7e7c\u627f\u8ad6\u58c7\u7684\u5132\u5b58\u904e\u7a0b \u00b6 \u6211\u5011\u6709\u4e86 column\uff0c\u6709\u4e86\u4e00\u500b UI \u4f86\u50b3\u905e input \u5230\u8a72 column\uff0c\u73fe\u5728\u6211\u5011\u5fc5\u9808\u8655\u7406\u5132\u5b58\u8cc7\u6599\u5230\u8a72 column\u3002 \u6211\u5011\u5c07\u901a\u904e\u7e7c\u627f\u8ad6\u58c7 Controller \u548c\u7e7c\u627f\u4e00\u500b\u7279\u6b8a\u7684\u65b9\u6cd5\u4f86\u5be6\u73fe\u9019\u500b\u76ee\u7684\uff0c\u7576\u4e00\u500b\u7bc0\u9ede\u53ca\u5176\u8cc7\u6599\u88ab\u5132\u5b58\u6642\uff0c\u8a72\u65b9\u6cd5\u5c07\u88ab\u547c\u53eb\u3002 \u9996\u5148\uff0c\u8b93\u6211\u5011\u5efa\u7acb\u4e00\u500b \"Class extension\"\uff0c\u5b83\u53ef\u4ee5\u5728 Admin CP \u7684 \"\u958b\u767c\" \u689d\u76ee\u4e0b\u627e\u5230\u3002 \u9ede\u9078 \"\u65b0\u589e Class extension\"\u3002 \u5728\u9019\u88e1\uff0c\u6211\u5011\u9700\u8981\u6307\u5b9a\u4e00\u500b \"\u7236\u985e\u540d\u7a31\"\uff0c\u4e5f\u5c31\u662f\u6211\u5011\u8981\u7e7c\u627f\u7684 class \u540d\u7a31\uff0c\u5728\u672c\u4f8b\u4e2d\u662f XF\\Admin\\Controller\\Forum \u3002 \u4e26\u4e14\u6211\u5011\u9700\u8981\u6307\u5b9a\u4e00\u500b \"\u7e7c\u627f class \u540d\u7a31\"\uff0c\u4e5f\u5c31\u662f\u7e7c\u627f\u7236\u985e\u7684 class\u3002 \u8f38\u5165 Demo\\Portal\\XF\\Admin\\Controller\\Forum \u3002 \u6211\u5011\u61c9\u8a72\u5728\u9ede\u9078\u5132\u5b58\u4e4b\u524d\u5efa\u7acb\u9019\u500b class\u3002 \u5728 src/addons/Demo/Portal/XF/Admin/Controller \u4e2d\u5efa\u7acb\u4e00\u500b\u65b0\u6a94\u6848\uff0c\u547d\u540d\u70ba Forum.php \u3002 \u9019\u53ef\u80fd\u770b\u8d77\u4f86\u50cf\u4e00\u500b\u5f88\u9577\u7684\u8def\u5f91\uff0c\u4f46\u6211\u5011\u5efa\u8b70\u7e7c\u627f class \u4f7f\u7528\u9019\u6a23\u7684\u8def\u5f91\u3002 \u5b83\u53ef\u4ee5\u8b93\u4f60\u66f4\u5bb9\u6613\u5730\u8b58\u5225\u51fa\u4ee3\u8868\u7e7c\u627f class \u7684\u6a94\u6848\uff0c\u56e0\u70ba\u5b83\u5011\u5728\u4e00\u500b\u8207\u7e7c\u627f\u7684 \"add-on\" ID (\u672c\u4f8b\u4e2d\u70ba XF ) \u540c\u540d\u7684\u76ee\u9304\u4e2d\u3002 \u5b83\u9084\u53ef\u4ee5\u6e05\u695a\u5730\u8aaa\u660e\u5230\u5e95\u662f\u54ea\u500b class \u88ab\u7e7c\u627f\u4e86\uff0c\u56e0\u70ba\u76ee\u9304\u7d50\u69cb\u8207\u9810\u8a2d class \u7684\u8def\u5f91\u76f8\u540c\u3002 \u76ee\u524d\uff0c\u6a94\u6848\u7684\u5167\u5bb9\u61c9\u8a72\u662f\u9019\u6a23\u7684\uff1a <?php namespace Demo\\Portal\\XF\\Admin\\Controller; class Forum extends XFCP_Forum { } \u66f4\u591a\u8cc7\u8a0a\u8acb\u53c3\u898b \u7e7c\u627f\u985e \u548c \u985e\u578b\u63d0\u793a \u3002 \u9ede\u9078\u5132\u5b58\uff0c\u5132\u5b58 Class extension\u3002 \u73fe\u5728\u6211\u5011\u53ef\u4ee5\u65b0\u589e\u4e00\u4e9b\u7a0b\u5f0f\u78bc\u4e86\u3002 \u6211\u5011\u9700\u8981\u7e7c\u627f\u7684\u7279\u5b9a\u65b9\u6cd5\u662f\u4e00\u500b\u540d\u70ba saveTypeData \u7684 protected \u51fd\u6578\u3002 \u7576\u7e7c\u627f\u4efb\u4f55\u985e\u4e2d\u73fe\u6709\u7684\u65b9\u6cd5\u6642\uff0c\u6aa2\u67e5\u539f\u59cb\u65b9\u6cd5\u662f\u5f88\u91cd\u8981\u7684\uff0c\u539f\u56e0\u6709\u5e7e\u500b\u3002 \u7b2c\u4e00\u500b\u539f\u56e0\u662f\u6211\u5011\u8981\u78ba\u4fdd\u6211\u5011\u5728\u7e7c\u627f\u65b9\u6cd5\u4e2d\u4f7f\u7528\u7684\u53c3\u6578\u8207\u6211\u5011\u8981\u7e7c\u627f\u7684\u65b9\u6cd5\u76f8\u5339\u914d\u3002 \u7b2c\u4e8c\u500b\u539f\u56e0\u662f\uff0c\u6211\u5011\u9700\u8981\u77e5\u9053\u9019\u500b\u65b9\u6cd5\u5be6\u969b\u4e0a\u662f\u505a\u4ec0\u9ebc\u7684\u3002 \u4f8b\u5982\uff0c\u9019\u500b\u65b9\u6cd5\u61c9\u8a72\u8fd4\u56de\u67d0\u500b\u7279\u5b9a\u985e\u578b\u7684\u6771\u897f\uff0c\u9084\u662f\u67d0\u500b\u7269\u4ef6\uff1f \u9019\u5728\u5927\u591a\u6578 Controller action \u4e2d\u80af\u5b9a\u662f\u9019\u6a23\u7684\uff0c\u6211\u5011\u5728 \u4fee\u6539 Controller action \u56de\u61c9\uff08properly\uff09 \u4e00\u7bc0\u4e2d\u63d0\u5230\u904e\u3002 \u7136\u800c\uff0c\u96d6\u7136\u9019\u500b\u65b9\u6cd5\u662f\u5728\u4e00\u500b Controller \u5167\uff0c\u4f46\u5be6\u969b\u4e0a\u5b83\u672c\u8eab\u4e26\u4e0d\u662f\u4e00\u500b Controller action\u3002 \u4e8b\u5be6\u4e0a\uff0c\u9019\u500b\u65b9\u6cd5\u662f\u4e00\u500b \"void\" \u65b9\u6cd5\uff1b\u5b83\u4e0d\u9700\u8981\u8fd4\u56de\u4efb\u4f55\u6771\u897f\u3002 \u7136\u800c\uff0c\u6211\u5011\u61c9\u8a72\u59cb\u7d42\u78ba\u4fdd\u6211\u5011\u5728\u7e7c\u627f\u65b9\u6cd5\u4e2d\u547c\u53eb\u7236\u985e\u65b9\u6cd5\uff0c\u6240\u4ee5\u6211\u5011\u53ea\u9700\u6dfb\u52a0\u65b0\u65b9\u6cd5\u672c\u8eab\uff0c\u800c\u4e0d\u9700\u8981\u6dfb\u52a0\u65b0\u7684\u7a0b\u5f0f\u78bc\uff1a protected function saveTypeData(FormAction $form, \\XF\\Entity\\Node $node, \\XF\\Entity\\AbstractNode $data) { parent::saveTypeData($form, $node, $data); } Warning \u6b64\u7279\u5b9a\u65b9\u6cd5\u7684\u53c3\u6578\u5217\u8868\u5047\u5b9a\u6211\u5011\u6709\u4e00\u500b use \u5ba3\u544a\uff0c\u5b83\u5c07\u5b8c\u6574\u7684 \\XF\\Mvc\\FormAction \u985e\u5225\u540d\u70ba\u7c21\u55ae\u7684 FormAction \u3002 \u56e0\u6b64\u4f60\u9700\u8981\u81ea\u5df1\u65b0\u589e\u90a3\u500b use \u5ba3\u544a\u3002 \u5728 namespace \u548c class \u884c\u4e4b\u9593\u65b0\u589e use XF\\Mvc\\FormAction; \u3002 \u6240\u4ee5\uff0c\u73fe\u5728\uff0c\u6211\u5011\u5df2\u7d93\u7e7c\u627f\u4e86\u90a3\u500b\u65b9\u6cd5\uff0c\u800c\u6211\u5011\u7684\u7e7c\u627f\u61c9\u8a72\u88ab\u547c\u53eb\uff0c\u4f46\u73fe\u5728\u5b83\u9664\u4e86\u547c\u53eb\u5b83\u7684\u7236\u985e\u65b9\u6cd5\u5916\uff0c\u6c92\u6709\u505a\u4efb\u4f55\u4e8b\u60c5\u3002 \u73fe\u5728\u6211\u5011\u9700\u8981\u5f9e\u8ad6\u58c7\u7de8\u8f2f\u9801\u9762\u7372\u53d6\u8f38\u5165\u503c\uff0c\u4e26\u5c07\u5176\u5957\u7528\u5230 $data \u5be6\u9ad4\uff08\u5728\u672c\u4f8b\u4e2d\u662f\u8ad6\u58c7\u5be6\u9ad4\uff09\u3002 protected function saveTypeData(FormAction $form, \\XF\\Entity\\Node $node, \\XF\\Entity\\AbstractNode $data) { parent::saveTypeData($form, $node, $data); $form->setup(function() use ($data) { $data->demo_portal_auto_feature = $this->filter('demo_portal_auto_feature', 'bool'); }); } \u4f7f\u7528 FormAction \u7269\u4ef6\u5141\u8a31\u6211\u5011\u5728\u5178\u578b\u7684\u8868\u55ae\u63d0\u4ea4\u904e\u7a0b\u4e2d\uff0c\u5177\u6709\u5404\u7a2e\u4e0d\u540c\u7684 extension points \u5230\u7a0b\u5e8f\u4e2d\u904b\u884c\u3002 \u4e26\u4e0d\u662f\u6240\u6709\u7684 Controller action \u90fd\u53ef\u4ee5\u4f7f\u7528\u3002 \u4f8b\u5982\uff0c\u5b83\u5728 Admin CP \u4e2d\u66f4\u70ba\u666e\u904d\uff0c\u5b83\u901a\u5e38\u9075\u5faa\u7c21\u55ae\u7684 CRUD \u6a21\u578b\uff08\u65b0\u589e\u3001\u67e5\u8a62\u3001\u4fee\u6539\u3001\u522a\u9664\uff09\u3002 XF \u4e2d\u7684\u8a31\u591a\u5176\u4ed6\u7a0b\u5e8f\u90fd\u767c\u751f\u5728 Service \u7269\u4ef6\u5167\uff0cService \u7269\u4ef6\u901a\u5e38\u6709\u8207\u6b63\u5728\u904b\u884c\u7684\u670d\u52d9\u76f8\u95dc\u7279\u5b9a extension points\u3002 FormAction \u7269\u4ef6\u7684\u9019\u7a2e\u7279\u6b8a\u7528\u6cd5\u8207\u4f60\u901a\u5e38\u6703\u9047\u5230\u7684\u60c5\u6cc1\u6709\u4e9b\u4e0d\u540c\u3002 \u5132\u5b58\u4e00\u500b\u7bc0\u9ede\u662f\u500b\u6709\u4e9b\u4e0d\u540c\u7684\u7a0b\u5e8f\uff0c\u56e0\u70ba\u9664\u4e86\u8207\u7bc0\u9ede\u5be6\u9ad4\u4e00\u8d77\u904b\u4f5c\u5916\uff0c\u4f60\u9084\u6703\u8207\u76f8\u95dc\u7684\u7bc0\u9ede\u985e\u578b\u4e00\u8d77\u904b\u4f5c\uff0c\u4f8b\u5982\u4e00\u500b\u8ad6\u58c7 Entity\u3002 \u4e0d\u904e\u5728\u9019\u500b\u65b9\u6cd5\u4e2d\uff0c\u6211\u5011\u78ba\u5be6\u53ef\u4ee5\u8a2a\u554f\u8868\u55ae action \u7269\u4ef6\uff0c\u6240\u4ee5\u6211\u5011\u61c9\u8a72\u4f7f\u7528\u5b83\u3002 \u6211\u5011\u5728\u9019\u88e1\u4f7f\u7528\u5b83\u4f86\u70ba\u7a0b\u5e8f\u7684 \"\u8a2d\u5b9a\" \u968e\u6bb5\u65b0\u589e\u4e00\u500b\u7279\u5b9a\u7684\u884c\u70ba\u3002 \u4e5f\u5c31\u662f\u8aaa\uff0c\u7576\u547c\u53eb FormAction \u7269\u4ef6\u7684 run() \u65b9\u6cd5\u6642\uff0c\u5b83\u5c07\u6309\u7167\u7279\u5b9a\u7684\u9806\u5e8f\u57f7\u884c\u5404\u500b\u968e\u6bb5\u3002 \u4e0d\u7ba1\u9019\u4e9b\u884c\u70ba\u662f\u4ee5\u54ea\u7a2e\u9806\u5e8f\u65b0\u589e\u5230\u7269\u4ef6\u4e2d\u7684\uff0c\u5b83\u5011\u4ecd\u7136\u6703\u6309\u7167 setup \u3001 validate \u3001 apply \u3001 complete \u7684\u9806\u5e8f\u57f7\u884c\u3002 \u901a\u904e\u4e0a\u9762\u7684\u7a0b\u5f0f\u78bc\uff0c\u6211\u5011\u53ef\u4ee5\u5c07\u8ad6\u58c7 Entity \u4e2d\u7684 demo_portal_auto_feature column \u8a2d\u5b9a\u70ba\u6211\u5011\u65b0\u589e\u5230\u8ad6\u58c7\u7de8\u8f2f\u9801\u9762\u7684 demo_portal_auto_feature \u8f38\u5165\u5b58\u5132\u7684\u4efb\u4f55\u503c\u3002 \u73fe\u5728\u61c9\u8a72\u53ef\u4ee5\u6e2c\u8a66\u6240\u6709\u9019\u4e9b\u5de5\u4f5c\u4e86\u3002 \u53ea\u9700\u7de8\u8f2f\u60a8\u9078\u64c7\u7684\u8ad6\u58c7\u4e26\u52fe\u9078 checkbox\u3002 \u4f60\u61c9\u8a72\u53ef\u4ee5\u89c0\u5bdf\u5230\u5169\u4ef6\u4e8b\u3002 \u9996\u5148\uff0c\u7576\u4f60\u56de\u5230\u7de8\u8f2f\u90a3\u500b\u8ad6\u58c7\u6642\uff0ccheckbox \u73fe\u5728\u61c9\u8a72\u88ab\u52fe\u9078\u4e86\u3002 \u7b2c\u4e8c\uff0c\u5982\u679c\u4f60\u5728 xf_forum \u8cc7\u6599\u8868\u4e2d\u67e5\u770b\u4f60\u525b\u525b\u7de8\u8f2f\u7684\u8ad6\u58c7\uff0c demo_portal_auto_feature \u6b04\u4f4d\u73fe\u5728\u61c9\u8a72\u8a2d\u5b9a\u70ba 1\u3002 \u8acb\u4fdd\u6301\u9019\u500b\u503c\uff0c\u56e0\u70ba\u6211\u5011\u6700\u7d42\u6703\u81ea\u52d5\u7cbe\u9078\u8a72\u8ad6\u58c7\u7684\u4e3b\u984c\u3002 \u8a2d\u7f6e\u4e3b\u984c\u81ea\u52d5\u986f\u793a \u00b6 \u6211\u5011\u5df2\u7d93\u5728\u8ad6\u58c7 Entity \u4e2d\u65b0\u589e\u4e86\u4e00\u500b\u65b0\u7684 column\uff0c\u9019\u5c07\u5141\u8a31\u6211\u5011\u5728\u8ad6\u58c7\u4e2d\u65b0\u5efa\u7acb\u4e00\u500b\u4e3b\u984c\u6642\u81ea\u52d5\u9032\u884c\u7cbe\u9078\u4ecb\u7d39\uff0c\u6240\u4ee5\u73fe\u5728\u662f\u6642\u5019\u65b0\u589e\u7a0b\u5f0f\u78bc\u4f86\u5be6\u73fe\u9019\u500b\u529f\u80fd\u4e86\u3002 \u5728 XF2 \u4e2d\uff0c\u6211\u5011\u5927\u91cf\u4f7f\u7528 Service \u7269\u4ef6\u3002 \u9019\u4e9b\u7269\u4ef6\u901a\u5e38\u63a1\u7528 \"setup and go\" \u985e\u578b\u7684\u65b9\u6cd5\uff1b\u4f60\u8a2d\u5b9a\u4f60\u7684\u914d\u7f6e\uff0c\u7136\u5f8c\u547c\u53eb\u4e00\u500b\u65b9\u6cd5\u4f86\u5b8c\u6210\u52d5\u4f5c\u3002 \u6211\u5011\u4f7f\u7528 Service \u7269\u4ef6\u4f86\u8a2d\u5b9a\u548c\u5b8c\u6210\u4e3b\u984c\u5275\u5efa\uff0c\u6240\u4ee5\u9019\u662f\u4e00\u500b\u5b8c\u7f8e\u7684\u4f4d\u7f6e\u4f86\u6dfb\u52a0\u6211\u5011\u9700\u8981\u7684\u7a0b\u5f0f\u78bc\u3002 \u9019\u4e00\u5207\u90fd\u8981\u5f9e\u53e6\u4e00\u500b Class extension \u958b\u59cb\uff0c\u6240\u4ee5\u9032\u5165 \"\u65b0\u589e Class extension\" \u9801\u9762\u3002 \u9019\u4e00\u6b21\uff0c\u57fa\u985e\u6703\u662f XF\\Service\\Thread\\Creator \uff0c\u7e7c\u627f\u985e\u5247\u662f Demo\\Portal\\XF\\Service\\Thread\\Creator \uff0c\u548c\u5f80\u5e38\u4e00\u6a23\uff0c\u9019\u500b\u65b0 class \u5c07\u770b\u8d77\u4f86\u50cf\u4e0b\u9762\u7684\u7a0b\u5f0f\u78bc\u3002 \u5728\u8def\u5f91 src/addons/Demo/Portal/XF/Service/Thread/Creator.php \u4e2d\u5efa\u7acb\u8a72\u7a0b\u5f0f\u78bc\uff0c\u7136\u5f8c\u9ede\u9078 \"\u5132\u5b58\" \u4f86\u5efa\u7acb\u7e7c\u627f\u985e\u3002 <?php namespace Demo\\Portal\\XF\\Service\\Thread; class Creator extends XFCP_Creator { } \u5728\u9019\u88e1\uff0c\u6211\u5011\u9084\u5c07\u5efa\u7acb\u53e6\u4e00\u500b\u7e7c\u627f\u985e\u3002 \u57fa\u790e\u985e\u662f XF\\Pub\\Controller\\Forum \uff0c\u7e7c\u627f\u985e\u662f Demo\\Portal\\XF\\Pub\\Controller\\Forum \u3002 \u5728\u8def\u5f91 src/addons/Demo/Portal/XF/Pub/Controller/Forum.php \u4e2d\u5efa\u7acb\u4ee5\u4e0b\u7a0b\u5f0f\u78bc\uff0c\u4e26\u9ede\u9078 \"\u5132\u5b58\"\uff1a <?php namespace Demo\\Portal\\XF\\Pub\\Controller; class Forum extends XFCP_Forum { } \u6211\u5011\u6700\u7d42\u5c07\u5728\u88ab\u7e7c\u627f\u7684\u4e3b\u984c\u4f5c\u8005\u7269\u4ef6\u4e2d\u7e7c\u627f _save() \u65b9\u6cd5\uff0c\u9019\u6a23\u6211\u5011\u5c31\u53ef\u4ee5\u5728\u5efa\u7acb\u4e3b\u984c\u5f8c\u5c0d\u5176\u9032\u884c\u7cbe\u9078\u3002 \u70ba\u4e86\u914d\u5408 \"setup and go\" \u7684\u65b9\u91dd\uff0c\u6211\u5011\u5c07\u5efa\u7acb\u4e00\u500b\u65b9\u6cd5\uff0c\u5b83\u53ef\u4ee5\u7528\u4f86\u6307\u793a\u4e3b\u984c\u662f\u5426\u61c9\u8a72\u88ab\u5efa\u7acb\u70ba\u7cbe\u9078\uff0c\u6216\u8005\u4e0d\u61c9\u8a72\u3002 \u70ba\u6b64\uff0c\u6211\u5011\u9700\u8981\u5169\u6a23\u6771\u897f\uff1a\u4e00\u500b\u662f\u7528\u4f86\u5132\u5b58 value \u7684 class \u5c6c\u6027\uff08\u9810\u8a2d\u70ba null \uff09\u548c\u4e00\u500b\u5141\u8a31\u8a2d\u5b9a\u8a72\u5c6c\u6027\u7684 public \u65b9\u6cd5\u3002 protected $featureThread; public function setFeatureThread($featureThread) { $this->featureThread = $featureThread; } \u56de\u5230\u6211\u5011\u65b0\u7e7c\u627f\u7684\u8ad6\u58c7 Controller\uff0c\u6211\u5011\u73fe\u5728\u5c07\u7e7c\u627f\u8a2d\u5b9a creator \u670d\u52d9\u7684\u65b9\u6cd5\uff0c\u5982\u679c\u8ad6\u58c7 Entity \u6709\u5fc5\u8981\u7684\u8a2d\u5b9a\u503c\uff0c\u5247\u9078\u64c7\u52a0\u5165\u7cbe\u9078\u3002 \u8acb\u8a18\u4f4f\uff0c\u5728\u7e7c\u627f\u4e00\u500b\u65b9\u6cd5\u4e4b\u524d\uff0c\u6211\u5011\u9700\u8981\u77e5\u9053\u5b83\u9810\u8a08\u6703\u8fd4\u56de\u4ec0\u9ebc\uff08\u5982\u679c\u6709\u7684\u8a71\uff09\uff0c\u4e26\u78ba\u4fdd\u6211\u5011\u547c\u53eb\u7236\u985e\u65b9\u6cd5\u3002 \u5982\u679c\u7236\u985e\u65b9\u6cd5\u78ba\u5be6\u8fd4\u56de\u4e86\u4e9b\u4ec0\u9ebc\uff0c\u90a3\u9ebc\u6211\u5011\u61c9\u8a72\u5728\u7a0b\u5f0f\u78bc\u5b8c\u6210\u5f8c\u8fd4\u56de\u9019\u500b\u65b9\u6cd5\u3002 \u5728\u9019\u7a2e\u60c5\u6cc1\u4e0b\uff0c setupThreadCreate() \u65b9\u6cd5\u6703\u8fd4\u56de\u8a2d\u5b9a\u597d\u7684 creator \u670d\u52d9\uff0c\u6240\u4ee5\u6211\u5011\u5c07\u6309\u7167\u4ee5\u4e0b\u65b9\u5f0f\u958b\u59cb\uff1a protected function setupThreadCreate(\\XF\\Entity\\Forum $forum) { /** @var \\Demo\\Portal\\XF\\Service\\Thread\\Creator $creator */ $creator = parent::setupThreadCreate($forum); return $creator; } \u6b63\u5982\u9810\u671f\u7684\u90a3\u6a23\uff0c\u9019\u5be6\u969b\u4e0a\u4e26\u6c92\u6709\u505a\u4efb\u4f55\u4e8b\u60c5\uff1b\u7e7c\u627f\u7684\u7a0b\u5f0f\u78bc\u88ab\u547c\u53eb\u4e86\uff0c\u4f46\u5b83\u6240\u505a\u7684\u53ea\u662f\u8fd4\u56de\u7236\u985e\u547c\u53eb\u6240\u8fd4\u56de\u7684\u5167\u5bb9\u3002 \u73fe\u5728\u6211\u5011\u61c9\u8a72\u4fee\u6539 $creator \u4f86\u8a2d\u5b9a\u7cbe\u9078\uff0c\u5982\u679c\u5b83\u9069\u7528\u65bc\u6211\u5011\u76ee\u524d\u6b63\u5728\u4f7f\u7528\u7684\u8ad6\u58c7\u3002 \u5728 $creator \u884c\u548c return \u884c\u4e4b\u9593\u52a0\u4e0a\uff1a if ($forum->demo_portal_auto_feature) { $creator->setFeatureThread(true); } \u73fe\u5728\u6211\u5011\u53ef\u4ee5\u5728\u7e7c\u627f\u7684 creator \u985e\u4e2d\u65b0\u589e _save() \u65b9\u6cd5\uff1a protected function _save() { $thread = parent::_save(); return $thread; } \u70ba\u4e86\u78ba\u4fdd\u9019\u689d\u4e3b\u984c\u88ab\u7cbe\u9078\uff0c\u5728 $thread \u884c\u548c return \u884c\u4e4b\u9593\uff0c\u6211\u5011\u53ea\u9700\u8981\u65b0\u589e\uff1a if ($this->featureThread && $thread->discussion_state == 'visible') { /** @var \\Demo\\Portal\\Entity\\FeaturedThread $featuredThread */ $featuredThread = $thread->getRelationOrDefault('FeaturedThread'); $featuredThread->save(); $thread->fastUpdate('demo_portal_featured', true); } \u56e0\u70ba\u6211\u5011\u4e4b\u524d\u5728\u4e3b\u984c Entity \u4e0a\u5efa\u7acb\u4e86 FeaturedThread \u95dc\u806f\uff0c\u6240\u4ee5\u5be6\u969b\u4e0a\u6211\u5011\u4e5f\u53ef\u4ee5\u4f7f\u7528\u9019\u500b\u95dc\u806f\u4f86\u5efa\u7acb\uff01 \u6211\u5011\u5728\u9019\u88e1\u4f7f\u7528\u4e86\u4e00\u500b\u540d\u70ba getRelationOrDefault() \u7684\u65b9\u6cd5\u3002 \u5b83\u5c07\u67e5\u770b\u8a72\u95dc\u806f\u662f\u5426\u5be6\u969b\u8fd4\u56de\u4e00\u500b\u73fe\u6709\u7684\u8a18\u9304\uff0c\u5982\u679c\u6c92\u6709\uff0c\u5b83\u5c07\u5efa\u7acb\u8a72 Entity \u4e26\u4f7f\u7528\u4efb\u4f55\u9810\u8a2d\u503c\uff08\u5305\u62ec\u4e3b\u984cID\uff09\u5c0d\u5176\u9032\u884c\u8a2d\u7f6e\uff01 \u9019\u610f\u5473\u8457\u6211\u5011\u5be6\u969b\u4e0a\u9700\u8981\u505a\u7684\u53ea\u662f\u7372\u53d6\u9810\u8a2d\u7684\u95dc\u806f\uff0c\u4e26\u5c07\u5176\u5132\u5b58\u4e0b\u4f86\u63d2\u5165\u5230\u8cc7\u6599\u5eab\u4e2d\u3002 \u6b64\u5916\uff0c\u6211\u5011\u61c9\u8a72\u5c07 demo_portal_featured \u6b04\u4f4d\u8a2d\u5b9a\u70ba true\u3002 \u56e0\u70ba\u4e3b\u984c Entity \u5df2\u7d93\u88ab\u5132\u5b58\u4e86\uff08\u7576\u539f class \u5132\u5b58 Entity \u6642\uff09\uff0c\u6211\u5011\u53ef\u4ee5\u4f7f\u7528 fastUpdate() \u65b9\u6cd5\u4f86\u5feb\u901f\u4fee\u6539\u8a72\u6b04\u4f4d\u3002 \u6211\u5011\u73fe\u5728\u9700\u8981\u5617\u8a66\u9019\u4e00\u5207\uff0c\u4e26\u78ba\u4fdd\u5b83\u80fd\u6b63\u5e38\u904b\u4f5c\u3002 \u524d\u5f80\u60a8\u4e4b\u524d\u555f\u7528\u4e86 demo_portal_auto_feature \u9078\u9805\u7684\u8ad6\u58c7\uff0c\u4e26\u5efa\u7acb\u4e00\u500b\u65b0\u7684\u4e3b\u984c\u3002 \u73fe\u5728\u552f\u4e00\u7684\u65b9\u6cd5\u5c31\u662f\u6aa2\u67e5 xf_demo_portal_featured_thread \u8cc7\u6599\u8868\uff0c\u5728\u90a3\u88e1\u6211\u5011\u61c9\u8a72\u53ef\u4ee5\u770b\u5230\u4e00\u689d\u65b0\u7684\u8a18\u9304\u3002 \u5efa\u7acb Portal \u9801\u9762 \u00b6 \u5728\u6211\u5011\u5b8c\u6210\u4e4b\u524d\uff0c\u9084\u6709\u76f8\u7576\u591a\u7684\u5de5\u4f5c\u8981\u505a\uff0c\u4f46\u73fe\u5728\u6211\u5011\u5df2\u7d93\u6709\u4e86\u7cbe\u9078\u4e3b\u984c\u7684\u80fd\u529b\uff0c\u5982\u679c\u6211\u5011\u80fd\u5728\u67d0\u500b\u5730\u65b9\u986f\u793a\u5b83\u5011\uff0c\u7576\u7136\u6703\u5f88\u597d\uff0c\u6240\u4ee5\u8b93\u6211\u5011\u958b\u59cb\u5efa\u7acb\u6211\u5011\u7684\u5165\u53e3\u9801\u9762\u3002 \u8981\u505a\u5230\u9019\u4e00\u9ede\uff0c\u6211\u5011\u9700\u8981\u65b0\u5efa\u4e00\u689d Public \u8def\u7531\u3002 \u9032\u5165 Admin CP\uff0c\u5728 \"\u958b\u767c\" \u4e0b\u9ede\u9078 \"\u8def\u7531\"\uff0c\u7136\u5f8c\u9ede\u9078 \"\u6dfb\u52a0\u8def\u7531\uff1a Public\"\u3002 \u6211\u5011\u66ab\u6642\u5148\u628a\u4e8b\u60c5\u7c21\u55ae\u5316\u3002 \u8def\u7531\u7684\u524d\u7db4\u662f \"portal\"\uff0cSection context \u662f \"home\"\uff0cController \u662f \"Demo\\Portal:Portal\"\u3002 \u73fe\u5728\u6211\u5011\u61c9\u8a72\u5728\u8def\u5f91 src/addons/Demo/Portal/Pub/Controller/Portal.php \u4e2d\u5efa\u7acb Controller\uff0c\u57fa\u672c\u5167\u5bb9\u5982\u4e0b\uff1a <?php namespace Demo\\Portal\\Pub\\Controller; class Portal extends \\XF\\Pub\\Controller\\AbstractController { } \u6211\u5011\u5e0c\u671b\u7576\u4eba\u5011\u8a2a\u554f index.php?portal \u9801\u9762\u6642\uff0c\u6211\u5011\u7684 portal \u9801\u9762\u6703\u986f\u793a\u5728\u4ed6\u5011\u9762\u524d\u3002 \u9019\u500b URL \u6c92\u6709 \"action\" \u90e8\u5206 - \u53ea\u6709\u6211\u5011\u525b\u525b\u5efa\u7acb\u7684\u8def\u7531\u524d\u7db4\u3002 \u8003\u616e\u5230\u9019\u4e00\u9ede\uff0c\u6211\u5011\u9700\u8981\u5728 actionIndex() \u65b9\u6cd5\u4e2d\u65b0\u589e\u986f\u793a portal \u9801\u9762\u7684\u7a0b\u5f0f\u78bc\u3002 \u6211\u5011\u5728\u5176\u4e2d\u9700\u8981\u7684\u57fa\u672c\u7a0b\u5f0f\u78bc\u662f\uff1a public function actionIndex() { $viewParams = []; return $this->view('Demo\\Portal:View', 'demo_portal_view', $viewParams); } \u73fe\u5728\uff0c\u9019\u9084\u4e0d\u80fd\u5b8c\u5168\u6b63\u5e38\u904b\u4f5c\uff0c\u56e0\u70ba\u6211\u5011\u9084\u6c92\u6709\u5efa\u7acb\u6a21\u677f\uff0c\u4f46\u9019\u5df2\u7d93\u8db3\u5920\u4e86\uff0c\u81f3\u5c11\u8b49\u660e\u4e86\u6211\u5011\u7684 Route \u548c Controller \u662f\u76f8\u4e92\u6e9d\u901a\u7684\u3002 \u6240\u4ee5\u8a2a\u554f index.php?portal \u81f3\u5c11\u61c9\u8a72\u986f\u793a '\u6a21\u677f\u932f\u8aa4'\u3002 \u6b63\u5982\u5728 View \u56de\u61c9 \u4e00\u7bc0\u4e2d\u63d0\u5230\u7684\uff0c\u7b2c\u4e00\u500b\u53c3\u6578\u662f\u4e00\u500b View class\uff0c\u4f46\u6211\u5011\u4e26\u4e0d\u9700\u8981\u5be6\u969b\u5efa\u7acb\u9019\u500b\u985e\u3002 \u5982\u679c\u6709\u5fc5\u8981\uff0c\u9019\u500b class \u53ef\u4ee5\u7531\u5176\u4ed6\u9644\u52a0\u5143\u4ef6\u7e7c\u627f\uff0c\u5373\u4f7f\u5b83\u4e0d\u5b58\u5728\u3002 \u7b2c\u4e8c\u500b\u53c3\u6578\u662f\u6a21\u677f\uff0c\u6211\u5011\u73fe\u5728\u9700\u8981\u5728\u8def\u5f91 src/addons/Demo/Portal/_output/templates/public/demo_portal_view.html \u4e2d\u5efa\u7acb\u9019\u500b\u6a21\u677f\u3002 \u76ee\u524d\uff0c\u9019\u500b\u6a21\u677f\u61c9\u8a72\u7c21\u55ae\u5730\u5305\u542b\u4ee5\u4e0b\u5167\u5bb9\u3002 <xf:title>Portal</xf:title> \u5982\u679c\u6211\u5011\u73fe\u5728\u8a2a\u554f portal \u9801\u9762\uff0c\u6a21\u677f\u932f\u8aa4\u5c31\u6703\u6d88\u5931\uff0c\u96d6\u7136\u6211\u5011\u4ecd\u7136\u6703\u6709\u4e00\u500b\u770b\u8d77\u4f86\u76f8\u7576\u7a7a\u767d\u7684\u9801\u9762\uff0c\u4f46\u81f3\u5c11\u73fe\u5728\u6703\u6709 \"Portal\" \u6a19\u984c\u3002 \u73fe\u5728\uff0c\u662f\u6642\u5019\u958b\u59cb\u65b0\u589e\u7a0b\u5f0f\u78bc\u4e86\uff0c\u5b83\u5c07\u986f\u793a\u7cbe\u9078\u4e3b\u984c\u7684\u5217\u8868\u3002 \u7b2c\u4e00\u6b65\u662f\u70ba\u6211\u5011\u5e38\u898b\u7684\u4e00\u4e9b\u57fa\u790e Finder \u67e5\u8a62\u5efa\u7acb\u4e00\u500b repository\u3002 \u56e0\u6b64\uff0c\u5728\u8def\u5f91 src/addons/Demo/Portal/Repository/FeaturedThread.php \u4e2d\u5efa\u7acb\u4e00\u500b\u65b0\u6a94\u6848\uff0c\u4e26\u65b0\u589e\u4ee5\u4e0b\u7a0b\u5f0f\u78bc\u3002 <?php namespace Demo\\Portal\\Repository; use XF\\Mvc\\Entity\\Finder; use XF\\Mvc\\Entity\\Repository; class FeaturedThread extends Repository { /** * @return Finder */ public function findFeaturedThreadsForPortalView() { $visitor = \\XF::visitor(); $finder = $this->finder('Demo\\Portal:FeaturedThread'); $finder ->setDefaultOrder('featured_date', 'DESC') ->with('Thread', true) ->with('Thread.User') ->with('Thread.Forum', true) ->with('Thread.Forum.Node.Permissions|' . $visitor->permission_combination_id) ->with('Thread.FirstPost', true) ->with('Thread.FirstPost.User') ->where('Thread.discussion_type', '<>', 'redirect') ->where('Thread.discussion_state', 'visible'); return $finder; } } \u6211\u5011\u5728\u9019\u88e1\u505a\u7684\u662f\u4f7f\u7528 finder \u67e5\u8a62\u6240\u6709\u7684\u7cbe\u9078\u4e3b\u984c\uff0c\u6309\u7167\u76f8\u53cd\u7684 featured_date \u9806\u5e8f\uff0cjoin \u5230 xf_thread \u8cc7\u6599\u8868\uff0c\u4e26\u5f9e\u8a72\u8cc7\u6599\u8868 join \u5230\u4e3b\u984c\u5275\u5efa\u8005\u7684 xf_user \u8cc7\u6599\u8868\u3001 xf_forum \u8cc7\u6599\u8868\u3001 xf_post \u8cc7\u6599\u8868\uff0c\u7136\u5f8c\u518d\u5f9e\u90a3\u88e1 join \u5230 xf_user \u8cc7\u6599\u8868\uff0c\u91cd\u65b0\u5275\u5efa\u5e16\u5b50\u8cc7\u6599\u8868\u3002 \u6211\u5011\u901a\u904e\u6307\u5b9a\u53c3\u6578 true \u4f86\u78ba\u5b9a\u4e3b\u984c\u3001\u8ad6\u58c7\u548c\u7b2c\u4e00\u500b\u5e16\u5b50\u5fc5\u9808\u5b58\u5728\uff0c\u6240\u4ee5\u9019\u4e9b\u5c07\u4ee5 INNER JOIN \u7684\u65b9\u5f0f\u57f7\u884c\uff0c\u800c\u7528\u6236\u67e5\u8a62\u5c07\u4ee5 LEFT JOIN \u7684\u65b9\u5f0f\u57f7\u884c\u3002 \u6709\u4e9b\u4e3b\u984c\u548c\u5e16\u5b50\u7684\u4f5c\u8005\u53ef\u80fd\u4e0d\u5b58\u5728\uff08\u4f8b\u5982\uff0c\u5982\u679c\u5b83\u5011\u662f\u7531 RSS feed \u7cfb\u7d71\u81ea\u52d5\u767c\u4f48\u7684\uff0c\u6216\u7531\u8a2a\u5ba2\u767c\u4f48\u7684\uff09\u3002 \u6211\u5011\u5728\u9019\u88e1\u9084\u6709\u4e00\u500b\u7279\u6b8a\u7684 join\uff0c\u53ef\u4ee5\u5728\u67e5\u8a62\u7684\u540c\u6642\u7372\u53d6\u76ee\u524d\u8a2a\u554f\u8005\u7684\u6b0a\u9650\u3002 \u9019\u5c07\u6e1b\u5c11\u6e32\u67d3 portal \u9801\u9762\u6240\u9700\u7684\u67e5\u8a62\u6b21\u6578\uff0c\u56e0\u70ba\u6211\u5011\u5c07\u505a\u4e00\u4e9b\u4e8b\u60c5\uff08\u4e4b\u5f8c\uff09\uff0c\u53ea\u5411\u6709\u6b0a\u9650\u67e5\u770b\u7684\u7528\u6236\u986f\u793a\u7cbe\u9078\u4e3b\u984c\u3002 \u9019\u4e26\u4e0d\u80fd\u8fd4\u56de\u9019\u500b\u67e5\u8a62\u7684\u7d50\u679c\u3002 \u9019\u5c07\u8fd4\u56de Finder \u7269\u4ef6\u672c\u8eab\u3002 \u9019\u6a23\u5c31\u53ef\u4ee5\u5728\u5176\u4ed6\u9644\u52a0\u5143\u4ef6\u9700\u8981\u7e7c\u627f\u6211\u5011\u7684\u7a0b\u5f0f\u78bc\u6642\uff0c\u6709\u4e00\u500b\u660e\u78ba\u7684 extension point\uff0c\u540c\u6642\u4e5f\u5141\u8a31\u6211\u5011\u5728\u7372\u53d6\u8cc7\u6599\u4e4b\u524d\u505a\u9032\u4e00\u6b65\u7684\u4fee\u6539\uff08\u4f8b\u5982\u70ba\u5206\u9801\u8a2d\u5b9a\u4e00\u500b limit/offset\uff0c\u6216\u8005\u8a2d\u5b9a\u4e0d\u540c\u7684\u6392\u5e8f\uff09\u3002 \u73fe\u5728\u8b93\u6211\u5011\u5728 Portal Controller \u7684 actionIndex() \u65b9\u6cd5\u4e2d\u4f7f\u7528\u5b83\u3002 \u5c07\u73fe\u6709\u7684\u9019\u4e00\u884c $viewParams = []; \u6539\u70ba\u5982\u4e0b\uff1a /** @var \\Demo\\Portal\\Repository\\FeaturedThread $repo */ $repo = $this->repository('Demo\\Portal:FeaturedThread'); $finder = $repo->findFeaturedThreadsForPortalView(); $viewParams = [ 'featuredThreads' => $finder->fetch() ]; \u5728\u9019\u500b\u968e\u6bb5\uff0c\u6211\u5011\u4e0d\u6253\u7b97\u64d4\u5fc3\u4fee\u6539\u6211\u5011\u5f9e repo \u4e2d\u6aa2\u7d22\u5230\u7684\u57fa\u790e finder\u3002 \u76f8\u53cd\uff0c\u6211\u5011\u958b\u59cb\u5be6\u969b\u770b\u5230\u4e00\u4e9b\u7d50\u679c\uff0c\u4e26\u66f4\u65b0 demo_portal_view \u6a21\u677f\u5982\u4e0b\uff08\u5728 <xf:title> \u6a19\u7c64\u4e4b\u5f8c\uff09\uff1a <xf:if is=\"$featuredThreads is not empty\"> <xf:foreach loop=\"$featuredThreads\" value=\"$featuredThread\"> <xf:macro name=\"thread_block\" arg-thread=\"{$featuredThread.Thread}\" arg-post=\"{$featuredThread.Thread.FirstPost}\" arg-featuredThread=\"{$featuredThread}\" /> </xf:foreach> <xf:else /> <div class=\"blockMessage\">\u76ee\u524d\u9084\u6c92\u6709\u4efb\u4f55\u5e16\u5b50\u88ab\u7cbe\u9078\u3002</div> </xf:if> <xf:macro name=\"thread_block\" arg-thread=\"!\" arg-post=\"!\" arg-featuredThread=\"!\"> <xf:css src=\"message.less\" /> <div class=\"block\"> <div class=\"block-container\" data-xf-init=\"lightbox\"> <h4 class=\"block-header\"><a href=\"{{ link('threads', $thread) }}\">{$thread.title}</a></h4> <div class=\"block-body\"> <xf:macro name=\"message\" arg-post=\"{$post}\" arg-thread=\"{$thread}\" arg-featuredThread=\"{$featuredThread}\" /> </div> <div class=\"block-footer\"> <a href=\"{{ link('threads', $thread) }}\">\u7e7c\u7e8c\u95b1\u8b80...</a> </div> </div> </div> </xf:macro> <xf:macro name=\"message\" arg-post=\"!\" arg-thread=\"!\" arg-featuredThread=\"!\"> <div class=\"message message--post message--simple\"> <div class=\"message-inner\"> <div class=\"message-cell message-cell--main\"> <div class=\"message-content js-messageContent\"> <div class=\"message-attribution\"> <div class=\"contentRow contentRow--alignMiddle\"> <div class=\"contentRow-figure\"> <xf:avatar user=\"{$post.User}\" size=\"xxs\" defaultname=\"{$post.username}\" href=\"\" /> </div> <div class=\"contentRow-main contentRow-main--close\"> <ul class=\"listInline listInline--bullet u-muted\"> <li><xf:username user=\"{$thread.User}\" /></li> <li><xf:date time=\"{$featuredThread.featured_date}\" /></li> <li><a href=\"{{ link('forums', $thread.Forum) }}\">{$thread.Forum.title}</a></li> <li>{{ phrase('replies:') }} {$thread.reply_count|number}</li> </ul> </div> </div> </div> <div class=\"message-userContent lbContainer js-lbContainer\" data-lb-id=\"post-{$post.post_id}\" data-lb-caption-desc=\"{{ $post.User ? $post.User.username : $post.username }} &middot; {{ date_time($post.post_date) }}\" > <blockquote class=\"message-body\"> {{ bb_code($post.message, 'post', $post.User, { 'attachments': $post.attach_count ? $post.Attachments : [], 'viewAttachments': $thread.canViewAttachments() }) }} </blockquote> </div> </div> </div> </div> </div> </xf:macro> \u73fe\u5728\uff0c\u6211\u627f\u8a8d\uff0c\u9019\u88e1\u6709 \u5f88\u591a \u7684\u5167\u5bb9\u3002 \u96d6\u7136\u5b83\u53ef\u80fd\u770b\u8d77\u4f86\u4ee4\u4eba\u751f\u754f\uff0c\u4f46\u5b83\u4e3b\u8981\u662f\u4ee5\u5408\u7406\u7684\u98a8\u683c\u4f86\u986f\u793a\u6211\u5011\u7684\u7cbe\u9078\u4e3b\u984c\u7684\u6a19\u8a18\u3002 \u4e0d\u904e\u6709\u5e7e\u4ef6\u4e8b\u503c\u5f97\u6ce8\u610f\u3002 \u6211\u5011\u7528\u4e00\u500b\u689d\u4ef6\u958b\u59cb\u6a21\u677f\uff0c\u9019\u500b\u689d\u4ef6\u662f <xf:if is=\"$featuredThreads is not empty\"> \u3002 \u9019\u662f\u70ba\u4e86\u6aa2\u67e5 finder \u8fd4\u56de\u7684\u7269\u4ef6\u662f\u5426\u771f\u7684\u5305\u542b\u7cbe\u9078\u4e3b\u984c\u8a18\u9304\u3002 \u5982\u679c\u4e0d\u5305\u542b\uff0c\u6211\u5011\u5c07\u986f\u793a\u4e00\u500b\u9069\u7576\u7684\u8a0a\u606f\u3002 \u5982\u679c\u78ba\u5be6\u6709\u4e00\u4e9b\u8a18\u9304\uff0c\u6211\u5011\u9700\u8981\u5faa\u74b0\u700f\u89bd\u6bcf\u4e00\u689d\u8a18\u9304\u4f86\u986f\u793a\u5b83\u3002 \u5c0d\u65bc\u6bcf\u689d\u8a18\u9304\uff0c\u6211\u5011\u547c\u53eb\u4e00\u500b macro \u3002 \u5de8\u96c6\u662f\u6a21\u677f\u7a0b\u5f0f\u78bc\u4e2d\u53ef\u91cd\u8907\u4f7f\u7528\u7684\u90e8\u5206\uff0c\u5b83\u662f\u81ea\u884c\u8a18\u9304\u7684\uff08\u4f60\u53ef\u4ee5\u770b\u5230\u54ea\u4e9b\u53c3\u6578\u662f\u652f\u63f4\u7684\uff09\uff0c\u4e26\u4fdd\u6301\u81ea\u5df1\u7684\u4f5c\u7528\u57df\uff0c\u4e0d\u80fd\u88ab\u547c\u53eb\u5de8\u96c6\u6a21\u677f\u4e2d\u7684\u53c3\u6578\u6240\u6c61\u67d3\uff1b\u9019\u610f\u5473\u8457\u5de8\u96c6\u53ea\u77e5\u9053\u660e\u78ba\u50b3\u905e\u9032\u4f86\u7684\u53c3\u6578\u548c\u5168\u57df\u7684 $xf \u53c3\u6578\u3002 \u4e3b\u984c\u5340\u584a\u5de8\u96c6\u986f\u793a\u7cbe\u9078\u4e3b\u984c\u7684\u57fa\u672c\u5340\u584a\uff0c\u7136\u5f8c\u547c\u53eb\u53e6\u4e00\u500b\u5de8\u96c6\u4f86\u986f\u793a\u6bcf\u500b\u8a0a\u606f\u3002 \u5be6\u4f5c\u5c0e\u89bd\u6a19\u7c64 \u00b6 \u4f60\u53ef\u80fd\u5df2\u7d93\u767c\u73fe\uff0c\u5728\u8a2d\u5b9a\u8def\u5f91\u6642\uff0c\u6211\u5011\u5c07 Section context \u6307\u5b9a\u70ba \"\u4e3b\u9801\"\uff0c\u7576\u4f60\u8a2a\u554f portal \u9801\u9762\u6642\uff0c\u4e3b\u9801\u6a19\u7c64\u88ab\u9078\u4e2d\uff0c\u6216\u8005\u5982\u679c\u5728\u9078\u9805\u4e2d\u6c92\u6709\u8a2d\u5b9a homePageUrl \uff0c\u4f60\u53ef\u80fd\u6839\u672c\u4e0d\u6703\u770b\u5230\u4e3b\u9801\u6a19\u7c64\u3002 \u6211\u5011\u5e0c\u671b\u4f7f\u7528\u9810\u8a2d\u7684\u4e3b\u9801\u6a19\u7c64\uff0c\u800c\u4e0d\u662f\u81ea\u5df1\u5efa\u7acb\u4e00\u500b\u6a19\u7c64\uff0c\u9019\u6a23\u53ef\u80fd\u6703\u6709\u4e00\u500b\u91cd\u8907\u7684\u6a19\u7c64\u3002 \u8981\u505a\u5230\u9019\u4e00\u9ede\uff0c\u6211\u5011\u61c9\u8a72\u4f7f\u7528\u7a0b\u5f0f\u78bc\u4e8b\u4ef6\u76e3\u807d\u5668\u5c07 URL \u6539\u70ba\u6211\u5011\u7684 portal URL\u3002 \u5728 Admin CP \u4e0b\u7684\u958b\u767c\u4e2d\u9ede\u9078 \"\u7a0b\u5f0f\u78bc\u4e8b\u4ef6\u76e3\u807d\u5668\"\uff0c\u7136\u5f8c\u9ede\u9078 \"\u65b0\u589e\u7a0b\u5f0f\u78bc\u4e8b\u4ef6\u76e3\u807d\u5668\"\u3002 \u76e3\u807d\u4e8b\u4ef6 home_page_url \uff0ccallback class \u53c8\u6703\u662f Demo\\Portal\\Listener \uff0c\u9019\u6b21\u7684\u65b9\u6cd5\u547d\u540d\u70ba homePageUrl \u3002 \u9019\u500b\u65b0\u65b9\u6cd5\u7684\u7a0b\u5f0f\u78bc\u61c9\u8a72\u76f8\u7576\u7c21\u55ae\uff1a public static function homePageUrl(&$homePageUrl, \\XF\\Mvc\\Router $router) { $homePageUrl = $router->buildLink('canonical:portal'); } \u6700\u5f8c\uff0c\u6211\u5011\u61c9\u8a72\u8003\u616e\u66f4\u6539\u6211\u5011 portal \u9801\u9762\u7684\u9996\u9801\u8def\u5f91\u3002 \u9032\u5165 Admin CP\uff0c\u5728\u8a2d\u5b9a\u4e0b\u9ede\u9078\u9078\u9805\uff0c\u7136\u5f8c\u9ede\u9078 \"\u57fa\u672c\u677f\u584a\u8cc7\u8a0a\"\u3002 \u5c07 \"\u9996\u9801\u8def\u5f91\" \u9078\u9805\u6539\u70ba portal/ \u3002 \u7576\u4f60\u5728 Admin CP \u4e2d\u6642\uff0c\u4f86\u770b\u770b\u7576\u4f60\u9ede\u9078 Header \u7684\u677f\u584a\u6a19\u984c\u6642\uff0c\u6703\u767c\u751f\u4ec0\u9ebc\u3002 \u9019\u61c9\u8a72\u6703\u5e36\u4f60\u5230\u4f60\u7684\u9996\u9801\u3002 \u4e00\u5207\u6b63\u5e38\uff0c\u90a3\u500b\u9996\u9801\u73fe\u5728\u61c9\u8a72\u662f\u4f60\u7684 portal \u9801\u9762\u4e86\uff01 \u9664\u6b64\u4e4b\u5916\uff0c\u4e3b\u9801\u6a19\u7c64\u61c9\u8a72\u662f\u53ef\u898b\u7684\uff0c\u4e26\u4e14\u88ab\u9078\u4e2d\u4e86\u3002 \u4f5c\u70ba\u53ef\u9078\u6b65\u9a5f\uff0c\u4f60\u53ef\u4ee5\u9078\u64c7\u5728\u4e3b\u9801\u6a19\u7c64\u4e0b\u65b0\u589e\u4e00\u4e9b\u984d\u5916\u7684\u5c0e\u89bd\u689d\u76ee\u3002 \u4e0d\u904e\uff0c\u73fe\u5728\u8b93\u6211\u5011\u5148\u7e7c\u7e8c\u5f80\u4e0b\u3002 \u624b\u52d5\u986f\u793a\uff08\u6216\u4e0d\u986f\u793a\uff09\u4e3b\u984c \u00b6 \u6240\u4ee5\uff0c\u6211\u5011\u53ef\u4ee5\u81ea\u52d5\u7cbe\u9078\u65b0\u4e3b\u984c\u3002 \u90a3\u9ebc\u624b\u52d5\u986f\u793a\u73fe\u6709\u7684\u4e3b\u984c\u5462\uff1f \u6216\u8005\u662f\u5728\u5efa\u7acb\u904e\u7a0b\u4e2d\uff0c\u5728\u4e0d\u652f\u63f4\u81ea\u52d5\u7cbe\u9078\u7684\u60c5\u6cc1\u4e0b\uff0c\u624b\u52d5\u7cbe\u9078\u4e3b\u984c\uff1f \u9019\u5c07\u662f\u4e00\u500b\u5f88\u597d\u7684\u65b9\u6cd5\uff0c\u8b93\u6211\u5011\u76ee\u524d\u7684 portal \u9801\u9762\u770b\u8d77\u4f86\u66f4\u5fd9\u788c\u3002 \u70ba\u4e86\u9054\u5230\u9019\u500b\u76ee\u7684\uff0c\u6211\u5011\u5c07\u5728\u4e00\u500b\u7279\u5b9a\u7684\u5de8\u96c6\u4e2d\u65b0\u589e\u4e00\u500b\u6a21\u677f\u4fee\u6539\uff0c\u9019\u500b\u5de8\u96c6\u5be6\u969b\u4e0a\u662f\u5728\u4e3b\u984c\u56de\u8986\u3001\u4e3b\u984c\u7de8\u8f2f\u548c\u5efa\u7acb\u4e3b\u984c\u6642\u4f7f\u7528\u7684\u3002 \u9019\u5c07\u727d\u6d89\u5230\u7e7c\u627f\u7de8\u8f2f\u5668\u670d\u52d9\uff0c\u4e26\u5c0d\u8655\u7406\u81ea\u52d5\u7cbe\u9078\u7684\u73fe\u6709\u7a0b\u5f0f\u78bc\u9032\u884c\u4fee\u6539\u3002 \u7b2c\u4e00\u6b65\u5c31\u662f\u65b0\u5efa\u6a21\u677f\u4fee\u6539\u3002 \u9032\u5230 \"\u65b0\u589e\u6a21\u677f\u4fee\u6539\"\uff08\u78ba\u4fdd\u5728 \"\u6a21\u677f\u4fee\u6539\" \u5217\u8868\u4e2d\u9078\u64c7 \"Public\" \u6a19\u7c64\uff09\u3002 \u9019\u6b21\u6211\u5011\u8981\u4fee\u6539\u7684\u6a21\u677f\u662f helper_thread_options \uff0c\u6211\u5011\u7528 demo_portal_helper_thread_options \u4f5c\u70ba key\uff0c\u4f60\u53ef\u4ee5\u5beb\u4e00\u500b\u5408\u7406\u7684\u63cf\u8ff0\u3002 \u5be6\u969b\u4e0a\uff0c\u6211\u5011\u53ef\u4ee5\u5728\u9019\u88e1\u505a\u4e00\u500b \"\u7c21\u55ae\u66ff\u63db\"\uff0c\u6240\u4ee5\u8acb\u9078\u4e2d\u9019\u500b\u55ae\u9078\u6309\u9215\uff0c\u4e26\u5728 \"\u67e5\u8a62\" \u6b04\u4f4d\u4e2d\u586b\u4e0a\uff1a <xf:if is=\"$thread.canLockUnlock()\"> \u5728 \"\u66ff\u63db\" \u6b04\u4f4d\u4e2d\u586b\u4e0a\uff1a <xf:if is=\"($thread.isInsert() AND !$thread.Forum.demo_portal_auto_feature AND $thread.canFeatureUnfeature()) OR ($thread.isUpdate() && $thread.canFeatureUnfeature())\" > <xf:option label=\"{{ phrase('demo_portal_featured') }}\" name=\"featured\" value=\"1\" selected=\"{$thread.demo_portal_featured}\"> <xf:hint>{{ phrase('demo_portal_featured_hint') }}</xf:hint> <xf:afterhtml> <xf:hiddenval name=\"_xfSet[featured]\" value=\"1\" /> </xf:afterhtml> </xf:option> </xf:if> $0 \u9019\u500b\u689d\u4ef6\u5224\u65b7\u6709\u9ede\u504f\u9577\u4e86\uff0c\u4f46\u5b83\u5141\u8a31\u6211\u5011\u5728\u5169\u500b\u7279\u5b9a\u7684\u689d\u4ef6\u4e0b\u986f\u793a\u7cbe\u9078 checkbox\uff1a a)\u5982\u679c\u5e16\u5b50\u9084\u6c92\u6709\u5efa\u7acb\uff0c\u4e26\u4e14\u8ad6\u58c7\u7684\u81ea\u52d5\u7cbe\u9078\u9078\u9805\u88ab\u95dc\u9589\uff0c\u4e26\u4e14\u6709\u7cbe\u9078\u7684\u6b0a\u9650\uff0c\u6216\u8005 b)\u5b83\u662f\u4e00\u500b\u5df2\u7d93\u5b58\u5728\u7684\u5e16\u5b50\uff0c\u4e26\u4e14\u6709 \u7cbe\u9078/\u975e\u7cbe\u9078 \u7684\u6b0a\u9650\u3002 \u4e00\u500b\u5feb\u901f\u7684 \"\u6e2c\u8a66\" \u61c9\u8a72\u6703\u986f\u793a\u9019\u500b\u9644\u52a0\u7684\u7a0b\u5f0f\u78bc\u5c07\u88ab\u63d2\u5165\u5230\u73fe\u6709\u7684 <xf:checkboxrow> \u4e2d \"\u6253\u958b\" checkbox \u4e0a\u65b9\u3002 \u5982\u679c\u9019\u4e00\u5207\u770b\u8d77\u4f86\u90fd\u6b63\u5e38\uff0c\u5c31\u9ede\u9078 \"\u5132\u5b58\"\u3002 \u6211\u5011\u4e0d\u5f97\u4e0d\u5728\u9019\u88e1\u76f4\u63a5\u5728\u4fee\u6539\u4e2d\u4f7f\u7528\u6a21\u677f\u7a0b\u5f0f\u78bc\uff0c\u56e0\u70ba\u5728\u5df2\u7d93\u5b58\u5728\u7684 input \u6216 row \u6a19\u7c64\u4e2d\u52a0\u5165\u4e00\u500b\u6a21\u677f\uff08\u50cf\u6211\u5011\u4e4b\u524d\u505a\u7684\u90a3\u6a23\uff09\u9019\u6a23\u662f\u6703\u7121\u6cd5\u904b\u4f5c\u7684\u3002 \u6211\u5011\u73fe\u5728\u9084\u9700\u8981\u70ba\u6a19\u7c64\u548c\u63d0\u793a\u5efa\u7acb\u77ed\u8a9e\uff0c\u56e0\u70ba\u4ee5\u5f8c\u5c07\u7121\u6cd5\u6aa2\u6e2c\u5230\u9019\u4e9b\u4e86\u3002 \u5728 \"\u5916\u89c0\" \u4e0b\u9032\u5165 \"\u77ed\u8a9e\" \u4e26\u9ede\u9078 \"\u65b0\u589e\u77ed\u8a9e\"\u3002 \u78ba\u4fdd\u4f60\u7684\u9644\u52a0\u5143\u4ef6\u88ab\u9078\u4e2d\u3002 \u7b2c\u4e00\u500b\u77ed\u8a9e\u7684 \"Title\" \u5c07\u662f \"demo_portal_featured\"\uff0c\u6587\u5b57\u5c07\u662f\u7c21\u55ae\u7684 \"\u7cbe\u9078\"\u3002 \u9ede\u9078 \"\u5132\u5b58\u4e26\u9000\u51fa\"\u3002 \u518d\u6b21\u9ede\u9078 \"\u65b0\u589e\u77ed\u8a9e\"\u3002 \u7b2c\u4e8c\u500b\u77ed\u8a9e\u7684 \"\u6a19\u984c\" \u6703\u662f \"demo_portal_featured_hint\"\uff0c\u6587\u5b57\u6703\u662f \"\u7cbe\u9078\u4e3b\u984c\u5c07\u51fa\u73fe\u5728 Portal \u9801\u9762\"\u3002 \u56de\u5230\u6211\u5011\u525b\u525b\u65b0\u589e\u4fee\u6539\u7684\u6a21\u677f\u7a0b\u5f0f\u78bc\uff0c\u4f60\u53ef\u80fd\u5df2\u7d93\u6ce8\u610f\u5230\u4e86\u4e00\u4e9b\u4e8b\u60c5\u3002 \u6211\u5011\u5728\u4e3b\u984c Entity \u4e0a\u547c\u53eb\u4e86\u4e00\u500b\u65b9\u6cd5\uff0c canFeatureUnfeature() \uff0c\u800c\u9019\u500b\u65b9\u6cd5\u9084\u4e0d\u5b58\u5728\u3002 \u6211\u5011\u6700\u7d42\u8981\u7528\u9019\u500b\u4f86\u505a\u4e00\u500b\u6b0a\u9650\u6aa2\u67e5\uff0c\u63a7\u5236\u7528\u6236\u662f\u5426\u53ef\u4ee5\u624b\u52d5\u5c0d\u4e00\u500b\u4e3b\u984c\u9032\u884c\u7cbe\u9078\u64cd\u4f5c\u3002 \u70ba\u4e86\u65b0\u589e\u9019\u500b\u65b9\u6cd5\uff0c\u6211\u5011\u9700\u8981\u70ba XF\\Entity\\Thread Entity \u65b0\u5efa\u4e00\u500b Class extension\u3002 \u6240\u4ee5\uff0c\u73fe\u5728\u5c31\u50cf\u6211\u5011\u4e4b\u524d\u505a\u7684\u90a3\u6a23\u505a\u3002 \u7e7c\u627f class \u5c07\u662f Demo\\Portal\\XF\\Entity\\Thread \uff0c\u6240\u4ee5\u5728\u8def\u5f91 src/addons/Demo/Portal/XF/Entity/Thread.php \u4e2d\u5efa\u7acb\u9019\u500b class\uff0c\u5167\u5bb9\u5982\u4e0b\uff1a <?php namespace Demo\\Portal\\XF\\Entity; class Thread extends XFCP_Thread { public function canFeatureUnfeature() { return true; } } \u597d\u5427\uff0c\u6240\u4ee5\uff0c\u6211\u5011\u4e26\u6c92\u6709\u5728\u9019\u88e1\u505a\u592a\u591a\u6709\u50f9\u503c\u7684\u4e8b\u60c5\u3002 canFeatureUnfeature() \u65b9\u6cd5\u73fe\u5728\u6240\u505a\u7684\u5c31\u662f\u8fd4\u56de true \u3002 \u4ee5\u5f8c\uff0c\u6211\u5011\u6703\u5be6\u4f5c\u4e00\u4e9b\u9069\u7576\u7684\u6b0a\u9650\uff0c\u4e26\u5728\u9019\u88e1\u65b0\u589e\u3002 \u6e2c\u8a66\u4e00\u4e0b\u76ee\u524d\u7684\u6548\u679c\uff0c\u6253\u958b\u4f60\u4e4b\u524d\u7cbe\u9078\u7684\u4e00\u500b\u4e3b\u984c\uff0c\u5728\u5de5\u5177\u9078\u55ae\u4e2d\u9078\u64c7 \"\u7de8\u8f2f\u4e3b\u984c\"\u3002 \u6211\u5011\u61c9\u8a72\u770b\u5230 \"\u8a2d\u5b9a\u4e3b\u984c\u72c0\u614b\" checkbox row \u6709\u6211\u5011\u65b0\u589e\u7684 \"\u7cbe\u9078\" checkbox\uff0c\u800c\u4e14\u61c9\u8a72\u662f\u52fe\u9078\u7684\uff0c\u8aaa\u660e\u9019\u500b\u4e3b\u984c\u78ba\u5be6\u662f\u5177\u6709\u7cbe\u9078\u7684\u3002 \u6211\u5011\u73fe\u5728\u53ef\u4ee5\u7e7c\u7e8c\u6539\u8b8a\u4e3b\u984c\u7de8\u8f2f\u5668\u670d\u52d9\u4f86\u5c0b\u627e\u9019\u500b\u503c\uff0c\u4e26\u76f8\u61c9\u5730\u9032\u884c\u7cbe\u9078\u6216\u53d6\u6d88\u7cbe\u9078\u3002 \u70ba\u6b64\u6211\u5011\u9700\u8981\u5169\u500b\u65b0\u7684 Class extensions\u3002 \u56de\u5230 \"Class extensions\" \u9801\u9762\u3002 \u7b2c\u4e00\u500b\u5c07\u6709\u4e00\u500b\u57fa\u985e XF\\Pub\\Controller\\Thread \u548c\u7e7c\u627f\u985e Demo\\Portal\\XF\\Pub\\Controller\\Thread \u3002 \u7b2c\u4e8c\u500b\u5c07\u6709\u4e00\u500b XF\\Service\\Thread\\Editor \u7684\u57fa\u985e\u548c\u4e00\u500b Demo\\Portal\\XF\\Service\\Thread\\Editor \u7684\u7e7c\u627f\u985e\u3002 \u7de8\u8f2f\u5668\u670d\u52d9\u5176\u5be6\u8981\u548c\u6211\u5011\u4e4b\u524d\u5efa\u7acb\u7684\u7e7c\u627f creator \u670d\u52d9\u975e\u5e38\u76f8\u4f3c\uff0c\u6240\u4ee5\u5728\u76f8\u95dc\u4f4d\u7f6e\u5efa\u7acb\u3002 \u4e0b\u9762\u662f\u7e7c\u627f\u985e\u7684\u6240\u6709\u7a0b\u5f0f\u78bc\uff1a <?php namespace Demo\\Portal\\XF\\Service\\Thread; class Editor extends XFCP_Editor { protected $featureThread; public function setFeatureThread($featureThread) { $this->featureThread = $featureThread; } protected function _save() { $thread = parent::_save(); if ($this->featureThread !== null && $thread->discussion_state == 'visible') { /** @var \\Demo\\Portal\\Entity\\FeaturedThread $featuredThread */ $featuredThread = $thread->getRelationOrDefault('FeaturedThread', false); if ($this->featureThread) { if (!$featuredThread->exists()) { $featuredThread->save(); $thread->fastUpdate('demo_portal_featured', true); } } else { if ($featuredThread->exists()) { $featuredThread->delete(); $thread->fastUpdate('demo_portal_featured', false); } } } return $thread; } } \u9019\u6bd4 creator \u670d\u52d9\u4e2d\u7684\u7a0b\u5f0f\u78bc\u8981\u8907\u96dc\u4e00\u4e9b\u3002 \u4f8b\u5982\uff0c\u6709\u53ef\u80fd\u6703\u51fa\u73fe\u9019\u6a23\u7684\u60c5\u6cc1\uff0c\u4e00\u500b\u4e3b\u984c\u88ab\u7de8\u8f2f\u4e86\uff0c\u800c\u7528\u6236\u6c92\u6709\u7de8\u8f2f\u8a72\u4e3b\u984c\u7684\u6b0a\u9650\uff0c\u56e0\u6b64\u6211\u5011\u4e0d\u986f\u793a checkbox\u3002 \u5728\u9019\u4e9b\u60c5\u6cc1\u4e0b\uff0c\u6211\u5011\u4e0d\u5e0c\u671b\u81ea\u52d5\u8a8d\u70ba\u8a72\u4e3b\u984c\u61c9\u8a72\u662f\u7121\u7cbe\u9078\u7684\u3002 \u7531\u65bc\u985e $featureThread \u5c6c\u6027\u7684\u9810\u8a2d\u503c\u662f null \uff0c\u6211\u5011\u53ef\u4ee5\u4f7f\u7528\u9019\u500b\u5c6c\u6027\uff0c\u9019\u6a23\u672c\u8cea\u4e0a\u8a72\u5c6c\u6027\u6709\u4e09\u7a2e\u72c0\u614b\u3002 \u5728\u9019\u7a2e\u60c5\u6cc1\u4e0b\uff0c null \u8868\u793a \"\u6c92\u6709\u8b8a\u5316\"\uff0c true \u8868\u793a\u6211\u5011\u5c0d\u8a72\u4e3b\u984c\u9032\u884c\u4e86\u7cbe\u9078\u8a2d\u5b9a\uff0c false \u8868\u793a\u6211\u5011\u53d6\u6d88\u4e86\u5b83\u7684\u7cbe\u9078\u3002 \u5728\u975e\u7cbe\u9078\u5316\u7684\u60c5\u6cc1\u4e0b\uff0c\u6211\u5011\u5be6\u969b\u4e0a\u53ea\u662f\u901a\u904e\u547c\u53eb delete() \u65b9\u6cd5\u4f86\u522a\u9664\u7cbe\u9078\u4e3b\u984c Entity\u3002 \u5728\u9019\u5169\u7a2e\u60c5\u6cc1\u4e0b\uff0c\u6211\u5011\u518d\u6b21\u4f7f\u7528 fastUpdate() \u65b9\u6cd5\u66f4\u65b0\u4e3b\u984c Entity \u4e2d\u7684\u5feb\u53d6\u503c\uff0c\u4ee5\u8868\u793a\u76ee\u524d\u7684\u7cbe\u9078\u72c0\u614b\u3002 \u5728\u5b8c\u6210\u7de8\u8f2f\u904e\u7a0b\u4e4b\u524d\uff0c\u6211\u5011\u9700\u8981\u70ba\u6211\u5011\u7684\u7e7c\u627f\u4e3b\u984c Controller \u65b0\u589e\u7a0b\u5f0f\u78bc\uff0c\u7279\u5225\u662f\u7e7c\u627f setupThreadEdit() \u65b9\u6cd5\u3002 \u6574\u500b\u7e7c\u627f\u4e3b\u984c Controller \u7684\u7a0b\u5f0f\u78bc\u770b\u8d77\u4f86\u5c07\u6703\u662f\u9019\u6a23\uff1a <?php namespace Demo\\Portal\\XF\\Pub\\Controller; class Thread extends XFCP_Thread { public function setupThreadEdit(\\XF\\Entity\\Thread $thread) { /** @var \\Demo\\Portal\\XF\\Service\\Thread\\Editor $editor */ $editor = parent::setupThreadEdit($thread); $canFeatureUnfeature = $thread->canFeatureUnfeature(); if ($canFeatureUnfeature) { $editor->setFeatureThread($this->filter('featured', 'bool')); } return $editor; } } \u9019\u61c9\u8a72\u8db3\u4ee5\u8b93\u60a8\u7de8\u8f2f\u4e00\u500b\u4e3b\u984c\uff0c\u4e26\u5c07\u5176\u72c0\u614b\u8a2d\u5b9a\u70ba\u7cbe\u9078\uff08\u6216\u975e\u7cbe\u9078\uff09\u3002 \u5982\u679c\u60a8\u73fe\u5728\u5617\u8a66\u4e00\u4e0b\uff0c\u60a8\u61c9\u8a72\u53ef\u4ee5\u770b\u5230\u4e3b\u984c\u76f8\u61c9\u5730\u5f9e\u60a8\u7684 portal \u9801\u9762\u51fa\u73fe\u548c\u6d88\u5931\u3002 \u6211\u5011\u9700\u8981\u5728\u4e3b\u984c Controller \u4e2d\u7e7c\u627f\u53e6\u4e00\u500b\u65b9\u6cd5\uff0c\u4ee5\u8655\u7406\u4e3b\u984c\u72c0\u614b\u63a7\u5236\u4e5f\u986f\u793a\u5728\u4e00\u4e9b\u4e3b\u984c\u56de\u8986\u8868\u55ae\u4e0a\u7684\u60c5\u6cc1\u3002 \u6211\u5011\u53ea\u9700\u8981\u5728\u4e0a\u9762\u65b0\u589e\u7684 setupThreadEdit() \u65b9\u6cd5\u4e0b\u9762\u65b0\u589e\u4ee5\u4e0b\u7a0b\u5f0f\u78bc\u5373\u53ef\uff1a public function finalizeThreadReply(\\XF\\Service\\Thread\\Replier $replier) { parent::finalizeThreadReply($replier); $setOptions = $this->filter('_xfSet', 'array-bool'); if ($setOptions) { $thread = $replier->getThread(); if ($thread->canFeatureUnfeature() && isset($setOptions['featured'])) { $replier->setFeatureThread($this->filter('featured', 'bool')); } } } \u8acb\u6ce8\u610f\uff0c\u6211\u5011\u5728\u9019\u500b\u65b9\u6cd5\u4e2d\u4e26\u6c92\u6709\u5be6\u969b\u8fd4\u56de\u4efb\u4f55\u6771\u897f\uff0c\u56e0\u70ba\u4e26\u4e0d\u671f\u671b\u5b83\u8fd4\u56de\u4efb\u4f55\u6771\u897f\u3002 \u6700\u5f8c\u4e00\u6b65\uff0c\u6211\u5011\u9700\u8981\u56de\u5230\u8ad6\u58c7 Controller\uff0c\u7a0d\u5fae\u4fee\u6539\u4e00\u4e0b\u6211\u5011\u73fe\u6709\u7684\u7a0b\u5f0f\u78bc\uff0c\u9019\u6a23\uff0c\u5982\u679c\u7cbe\u9078\u4e0d\u662f\u81ea\u52d5\u7684\uff0c\u6211\u5011\u53ef\u4ee5\u624b\u52d5\u8655\u7406\u3002 \u9019\u61c9\u8a72\u662f\u76f8\u7576\u76f4\u63a5\u7684\u3002 \u9032\u5165\u60a8\u7684\u7e7c\u627f\u8ad6\u58c7 Controller\uff0c\u7136\u5f8c\u5c07\u66ff\u63db\u9019\u500b\uff1a if ($forum->demo_portal_auto_feature) { $creator->setFeatureThread(true); } \u6539\u6210\u4e0b\u9762\u9019\u6a23\uff1a if ($forum->demo_portal_auto_feature) { $creator->setFeatureThread(true); } else { $setOptions = $this->filter('_xfSet', 'array-bool'); if ($setOptions) { $thread = $creator->getThread(); if ($thread->canFeatureUnfeature() && isset($setOptions['featured'])) { $creator->setFeatureThread($this->filter('featured', 'bool')); } } } \u9019\u548c\u6211\u5011\u5df2\u7d93\u64c1\u6709\u7684\u57fa\u672c\u76f8\u540c\uff0c\u4f8b\u5982\uff0c\u5982\u679c\u8ad6\u58c7\u958b\u555f\u4e86\u81ea\u52d5\u7cbe\u9078\uff0c\u90a3\u9ebc\u6211\u5011\u53ea\u9700\u5c07\u8a72\u4e3b\u984c\u8a2d\u5b9a\u70ba\u7cbe\u9078\uff0c\u5426\u5247\uff0c\u6211\u5011\u6aa2\u67e5\u662f\u5426\u6709 checkbox\uff0c\u5c31\u50cf\u6211\u5011\u5c0d\u5176\u4ed6\u60c5\u6cc1\u6240\u505a\u7684\u90a3\u6a23\uff0c\u5c07\u5176\u8a2d\u5b9a\u70ba checkbox \u72c0\u614b\u3002 \u6211\u5011\u73fe\u5728\u61c9\u8a72\u6e2c\u8a66\u5efa\u7acb 3 \u500b\u4e3b\u984c\uff0c\u4ee5\u78ba\u4fdd\u5176\u904b\u4f5c\u6b63\u5e38\u3002 \u7b2c\u4e00\u500b\u662f\u5728\u958b\u555f\u4e86\u81ea\u52d5\u7cbe\u9078\u7684\u8ad6\u58c7\u4e2d\uff0c\u78ba\u4fdd\u5b83\u4ecd\u7136\u6709\u6548\uff0c\u7136\u5f8c\u662f\u5728\u6c92\u6709\u958b\u555f\u81ea\u52d5\u7cbe\u9078\u7684\u8ad6\u58c7\u4e2d\uff0c\u52fe\u9078 \"\u7cbe\u9078\" checkbox\uff0c\u518d\u52fe\u9078\u5b83\u3002 \u5047\u8a2d\u4e00\u5207\u6b63\u5e38\uff0c\u8b93\u6211\u5011\u7e7c\u7e8c\u524d\u9032\u3002 \u6539\u9032\u5165\u53e3\u7db2\u7ad9\u9801\u9762 \u00b6 \u96d6\u7136\uff0cportal \u9801\u9762\u770b\u8d77\u4f86\u5f88\u5408\u7406\uff0c\u4f46\u6211\u5011\u53ef\u4ee5\u505a\u5f97\u66f4\u597d\u4e00\u4e9b\u3002 \u9996\u5148\uff0c\u6211\u5011\u61c9\u8a72\u8abf\u6574\u6211\u5011\u7684\u7a0b\u5f0f\u78bc\uff0c\u4f7f\u6211\u5011\u53ea\u986f\u793a X \u500b\u7279\u8272\u4e3b\u984c\uff0c\u6211\u5011\u9084\u61c9\u8a72\u65b0\u589e\u4e00\u4e9b\u9801\u9762\u5c0e\u89bd\u3002 \u5728\u9019\u4e00\u9ede\u4e0a\uff0c\u5982\u679c\u4f60\u9084\u6c92\u6709\u7684\u8a71\uff0c\u53ef\u80fd\u503c\u5f97\u518d\u591a\u7cbe\u9078\u4e00\u4e9b\u4e3b\u984c\uff0c\u9019\u6a23\u6211\u5011\u5c31\u53ef\u4ee5\u5be6\u969b\u6e2c\u8a66\u5206\u9801\u4e86\uff01 \u9996\u5148\uff0c\u6211\u5011\u9700\u8981\u56de\u5230\u6211\u5011\u7684 portal Controller\uff0c\u4e26\u5728 actionIndex() \u65b9\u6cd5\u7684\u9802\u90e8\u65b0\u589e\u4e00\u4e9b\u7a0b\u5f0f\u78bc\uff1a $page = $this->filterPage(); $perPage = 5; \u9019\u88e1\u7684\u7b2c\u4e00\u884c\u662f\u4e00\u500b\u7279\u5b9a\u7684 helper \u65b9\u6cd5\uff0c\u7528\u4f86\u7372\u53d6\u76ee\u524d\u7684\u9801\u78bc\u3002 \u7b2c\u4e8c\u884c\u662f\u6211\u5011\u6bcf\u9801\u8981\u8f09\u5165\u591a\u5c11\u500b\u9805\u76ee\uff0c\u9019\u901a\u5e38\u4f86\u81ea\u4e00\u500b\u9078\u9805\uff0c\u4f46\u6211\u5011\u73fe\u5728\u5c07\u786c\u5beb\u6b7b\u70ba 5\u3002 \u63a5\u4e0b\u4f86\u8981\u505a\u7684\u5c31\u662f\u628a\u9019\u4e00\u884c\uff1a $finder = $repo->findFeaturedThreadsForPortalView(); \u4fee\u6539\u6210\u9019\u6a23\uff1a $finder = $repo->findFeaturedThreadsForPortalView() ->limitByPage($page, $perPage); \u9019\u5c31\u6539\u8b8a\u4e86\u6211\u5011\u7684\u67e5\u8a62\uff0c\u4f7f\u5b83\u80fd\u6839\u64da\u6211\u5011\u4e0a\u9762\u5b9a\u7fa9\u7684 \u9801/\u6bcf\u9801 \u503c\u9032\u884c limit\u3002 \u9019\u5c07\u81ea\u52d5\u8a08\u7b97\u51fa\u76ee\u524d\u9801\u9762\u7684\u6b63\u78ba limit ( $perPage ) \u548c offset ( ($page - 1) * $perPage )\u3002 \u63a5\u4e0b\u4f86\uff0c\u6211\u5011\u9700\u8981\u518d\u50b3\u905e\u4e00\u4e9b\u53c3\u6578\u5230\u6211\u5011\u7684 view \u53c3\u6578\u4e2d\uff0c\u6240\u4ee5\u5c07\u4e0b\u9762\uff1a $viewParams = [ 'featuredThreads' => $finder->fetch() ]; \u6539\u8b8a\u6210\uff1a $viewParams = [ 'featuredThreads' => $finder->fetch(), 'total' => $finder->total(), 'page' => $page, 'perPage' => $perPage ]; \u8981\u4f7f\u7528\u986f\u793a\u6211\u5011\u7684\u9801\u9762\u5c0e\u89bd\uff0c\u6211\u5011\u9700\u8981\u77e5\u9053\u689d\u76ee\u7684\u7e3d\u6578\uff0c\u6211\u5011\u53ef\u4ee5\u901a\u904e total() \u65b9\u6cd5\u5f9e finder \u4e2d\u5f97\u5230\uff0c\u76ee\u524d\u7684\u9801\u78bc\u548c\u6211\u5011\u6bcf\u9801\u986f\u793a\u7684\u6578\u91cf\u3002 \u5982\u679c\u4f60\u56de\u5230 portal\uff0c\u73fe\u5728\u4f60\u6703\u770b\u5230\u53ea\u6709 5 \u500b\u7cbe\u9078\u4e3b\u984c\u986f\u793a\u3002 \u4e0d\u904e\uff0c\u6211\u5011\u73fe\u5728\u9700\u8981\u65b0\u589e\u9801\u9762\u5c0e\u89bd\u3002 \u6240\u4ee5\u6253\u958b demo_portal_view \u6a21\u677f\uff0c\u5728 </xf:foreach> \u6a19\u7c64\u5f8c\u76f4\u63a5\u65b0\u589e\u4ee5\u4e0b\u5167\u5bb9\uff1a <xf:pagenav page=\"{$page}\" perpage=\"{$perPage}\" total=\"{$total}\" link=\"portal\" wrapperclass=\"block\" /> \u6b64\u6642\u91cd\u65b0\u8f09\u5165 portal \u9801\u9762\uff0c\u53ea\u8981\u4f60\u6709 5 \u500b\u4ee5\u4e0a\u7684\u7cbe\u9078\u4e3b\u984c\uff0c\u73fe\u5728\u5c31\u6703\u5728\u7cbe\u9078\u4e3b\u984c\u5217\u8868\u7684\u5e95\u90e8\u770b\u5230\u9801\u9762\u5c0e\u89bd\u3002 \u5176\u4ed6\u4e00\u4e9b\u53ef\u80fd\u6709\u52a9\u65bc\u6539\u5584\u9019\u500b\u9801\u9762\u7684\u5916\u89c0\u7684\u6771\u897f\u662f\u65b0\u589e\u4e00\u500b\u5074\u908a\u6b04\uff0c\u6216\u8005\u66f4\u6e96\u78ba\u5730\u8aaa\uff0c\u4e00\u500b\u986f\u793a\u5728\u5074\u908a\u6b04\u7684\u5c0f\u7d44\u4ef6\u4f4d\u7f6e\u3002 \u5c0f\u7d44\u4ef6\u4f4d\u7f6e\u662f\u5728 Admin CP\u7684 \"\u958b\u767c\" \u4e0b\u65b0\u589e\u7684\u3002 \u9032\u5165 \"\u5c0f\u7d44\u4ef6\u4f4d\u7f6e\" \u9801\u9762\uff0c\u9ede\u9078 \"\u65b0\u589e\u5c0f\u7d44\u4ef6\u4f4d\u7f6e\"\u3002 \u8f38\u5165 \"\u4f4d\u7f6e ID\" \u70ba demo_portal_view_sidebar \uff0c\"Title\" \u70ba Demo portal view: Sidebar \u548c\u4e00\u500b\u9069\u7576\u7684\u63cf\u8ff0\u3002 \u78ba\u4fdd\u4f4d\u7f6e\u5df2\u958b\u555f\uff0c\u4e26\u9078\u64c7\u4e86\u6b63\u78ba\u7684\u9644\u52a0\u5143\u4ef6 ID \u5f8c\uff0c\u9ede\u9078 \"\u5132\u5b58\"\u3002 \u8981\u5c07\u9019\u500b\u4f4d\u7f6e\u65b0\u589e\u5230\u6a21\u677f\u4e2d\uff0c\u53ea\u9700\u5728 <xf:title> \u6a19\u7c64\u4e0b\u9762\u65b0\u589e\u4ee5\u4e0b\u5167\u5bb9\uff1a <xf:widgetpos id=\"demo_portal_view_sidebar\" position=\"sidebar\" /> \u7576\u7136\uff0c\u5728\u6c92\u6709\u65b0\u589e\u4e00\u4e9b\u5c0f\u7d44\u4ef6\u4e4b\u524d\uff0c\u6211\u5011\u9084\u662f\u4e0d\u6703\u770b\u5230\u5074\u908a\u6b04\u3002 \u5c0f\u7d44\u4ef6\u672c\u8eab\u662f\u4e0d\u6307\u6d3e\u7d66\u9644\u52a0\u5143\u4ef6\u7684\uff0c\u6240\u4ee5\u4f60\u70ba\u9019\u500b\u4f4d\u7f6e\u5efa\u7acb\u7684\u5c0f\u7d44\u4ef6\uff0c\u5982\u679c\u4f60\u60f3\u5728\u9810\u8a2d\u60c5\u6cc1\u4e0b\u767c\u9001\u4e00\u4e9b\u914d\u7f6e\u597d\u7684\u5c0f\u7d44\u4ef6\uff0c\u5c07\u9700\u8981\u65b0\u589e\u5230 Setup class \u4e2d\u3002 \u70ba\u4e86\u7c21\u55ae\u8d77\u898b\uff0c\u6211\u5011\u53ea\u9700\u8981\u8907\u88fd\u76ee\u524d\u6307\u6d3e\u7d66 forum_list_sidebar \u4f4d\u7f6e\u7684\u5c0f\u7d44\u4ef6\uff08\u9810\u8a2d\u60c5\u6cc1\u4e0b\uff09\u3002 \u6240\u4ee5\uff0c\u6211\u5011\u5c07\u628a\u9019\u4e9b\u65b0\u589e\u5230 Setup class \u4e2d\u7684\u4e00\u500b\u65b0\u7684 installStep4() \u65b9\u6cd5\u4e2d\uff1a public function installStep4() { $this->createWidget('demo_portal_view_members_online', 'members_online', [ 'positions' => ['demo_portal_view_sidebar' => 10] ]); $this->createWidget('demo_portal_view_new_posts', 'new_posts', [ 'positions' => ['demo_portal_view_sidebar' => 20] ]); $this->createWidget('demo_portal_view_new_profile_posts', 'new_profile_posts', [ 'positions' => ['demo_portal_view_sidebar' => 30] ]); $this->createWidget('demo_portal_view_forum_statistics', 'forum_statistics', [ 'positions' => ['demo_portal_view_sidebar' => 40] ]); $this->createWidget('demo_portal_view_share_page', 'share_page', [ 'positions' => ['demo_portal_view_sidebar' => 50] ]); } \u7576\u7136\uff0c\u5225\u5fd8\u4e86\u81ea\u5df1\u57f7\u884c\u9019\u500b\u8a2d\u5b9a\u6b65\u9a5f\uff1a Terminal $ php cmd.php xf-addon:install-step Demo/Portal 4 \u5be6\u73fe\u6b0a\u9650\u548c\u512a\u5316 \u00b6 \u73fe\u5728\uff0c\u6211\u5011\u5728 portal \u9801\u9762\u4e2d\u986f\u793a\u6240\u6709\u7684\u7cbe\u9078\u4e3b\u984c\uff0c\u4e0d\u7ba1\u8a2a\u554f\u8005\u662f\u5426\u6709\u6b0a\u9650\u67e5\u770b\u5b83\u5011\u3002 \u9019\u4e0d\u662f\u5f88\u7406\u60f3\uff1b\u5728\u67d0\u4e9b\u60c5\u6cc1\u4e0b\uff0c\u60a8\u53ef\u80fd\u5e0c\u671b\u5728\u67d0\u4e9b\u53d7\u9650\u5236\u7684\u8ad6\u58c7\u4e0a\u767c\u4f48\u4e3b\u984c\uff0c\u4e26\u4e14\u53ea\u8b93\u90a3\u4e9b\u53ef\u4ee5\u6b63\u5e38\u6aa2\u8996\u8a72\u8ad6\u58c7\u7684\u7528\u6236\u53ef\u898b\u3002 \u8981\u505a\u5230\u9019\u4e00\u9ede\uff0c\u6211\u5011\u9700\u8981\u6539\u8b8a\u6211\u5011\u7684\u7a0b\u5f0f\u78bc\uff0c\u4ee5\u4fbf\u6211\u5011 \"over-fetch\" \u6211\u5011\u9700\u8981\u986f\u793a\u7684\u8a18\u9304\u6578\u91cf\uff0c\u904e\u6ffe\u6389\u4efb\u4f55\u770b\u4e0d\u898b\u7684\u7d50\u679c\uff0c\u7136\u5f8c\u5c07\u7d50\u679c\u96c6\u5207\u6210\u6211\u5011\u60f3\u8981\u5728\u6bcf\u9801\u986f\u793a\u7684\u5be6\u969b\u6578\u91cf\u3002 \u9019\u6bd4\u807d\u8d77\u4f86\u8981\u7c21\u55ae\u4e00\u4e9b\u3002 \u9996\u5148\uff0c\u8acb\u9032\u5165 Portal Controller\uff0c\u4e26\u5c07\u9019\u4e00\u884c\uff1a ->limitByPage($page, $perPage); \u66f4\u6539\u6210\u9019\u6a23\uff1a ->limit($perPage * 3); \u7136\u5f8c\u4e0b\u9762\u518d\u52a0\u4e0a\uff1a $featuredThreads = $finder->fetch() ->filter(function(\\Demo\\Portal\\Entity\\FeaturedThread $featuredThread) { return ($featuredThread->Thread->canView()); }) ->sliceToPage($page, $perPage); \u6700\u5f8c\u5c07\u9019\u884c\uff1a 'featuredThreads' => $finder->fetch(), \u66f4\u6539\u70ba\uff1a 'featuredThreads' => $featuredThreads, \u4f60\u53ef\u80fd\u5728\u524d\u9762\u7684 demo_portal_view \u6a21\u677f\u4e2d\u5df2\u7d93\u767c\u73fe\uff0c\u6211\u5011\u5448\u73fe\u7684\u6bcf\u4e00\u7bc7\u6587\u7ae0\u4e5f\u6307\u5b9a\u5176\u9644\u4ef6\uff1a 'attachments': $post.attach_count ? $post.Attachments : [], \u73fe\u5728\uff0c\u9019\u5c07\u70ba\u6bcf\u500b\u5e16\u5b50\u7522\u751f\u4e00\u500b\u984d\u5916\u7684\u67e5\u8a62\u3002 \u6240\u4ee5\uff0c\u6211\u5011\u61c9\u8a72\u5617\u8a66\u5c0d\u6211\u5011\u8981\u986f\u793a\u7684\u6240\u6709\u5e16\u5b50\u9032\u884c\u4e00\u6b21\u67e5\u8a62\uff0c\u4e26\u63d0\u524d\u5c07\u5b83\u5011\u65b0\u589e\u5230\u5e16\u5b50\u4e2d\u3002 \u9019\u53ef\u80fd\u807d\u8d77\u4f86\u6bd4\u5be6\u969b\u60c5\u6cc1\u66f4\u8907\u96dc\u3002 \u53ea\u8981\u5728 ->slice(0, $perPage, true); \u884c\u4e0b\u9762\u65b0\u589e\u4ee5\u4e0b\u7a0b\u5f0f\u78bc\u5373\u53ef\u3002 $threads = $featuredThreads->pluckNamed('Thread'); $posts = $threads->pluckNamed('FirstPost', 'first_post_id'); /** @var \\XF\\Repository\\Attachment $attachRepo */ $attachRepo = $this->repository('XF:Attachment'); $attachRepo->addAttachmentsToContent($posts, 'post'); \u6211\u5011\u9996\u5148\u4f7f\u7528 pluckNamed() \u65b9\u6cd5\u7372\u5f97\u4e00\u500b\u4e3b\u984c\u7684\u96c6\u5408\uff0c\u7136\u5f8c\u518d\u5f9e\u4e3b\u984c\u4e2d\u7372\u5f97\u4e00\u500b\u5e16\u5b50\u7684\u96c6\u5408\uff08\u4ee5\u5e16\u5b50 ID \u70ba key \uff09\u3002 \u4e00\u65e6\u6211\u5011\u5f97\u5230\u4e86\u5e16\u5b50\uff0c\u6211\u5011\u53ea\u9700\u5c07\u5b83\u5011\u50b3\u905e\u5230\u9644\u4ef6 repository \u7684\u4e00\u500b\u7279\u6b8a\u65b9\u6cd5\u4e2d\u5c31\u53ef\u4ee5\u4e86\uff0c\u8a72\u65b9\u6cd5\u57f7\u884c\u4e00\u500b\u55ae\u4e00\u7684\u67e5\u8a62\uff0c\u4e26\u70ba\u6bcf\u500b\u5e16\u5b50\u7684\u9644\u4ef6\u95dc\u806f \"hydrates\"\u3002 \u6700\u5f8c\u8981\u5b8c\u6210\u7684\u6b0a\u9650\u76f8\u95dc\u4e8b\u60c5\u662f\u5efa\u7acb\u4e00\u500b\u65b0\u7684\u6b0a\u9650\u4f86\u63a7\u5236\u8ab0\u53ef\u4ee5\u624b\u52d5\u5730\u5c0d\u4e3b\u984c\u9032\u884c \u7cbe\u9078/\u53d6\u6d88\u7cbe\u9078\u3002 \u8981\u505a\u5230\u9019\u4e00\u9ede\uff0c\u5728 Admin CP \u7684 \"\u958b\u767c\" \u4e2d\u9ede\u9078 \"\u6b0a\u9650\u5b9a\u7fa9\"\uff0c\u7136\u5f8c\u9ede\u9078 \"\u65b0\u589e\u6b0a\u9650\"\u3002 \"\u6b0a\u9650\u7d44\" \u70ba \"\u8ad6\u58c7\"\uff0c\"\u6b0a\u9650 ID\" \u70ba demoPortalFeature \uff0c\"Title\" \u61c9\u8a72\u662f Can feature / unfeature threads \uff0c\u5c07 \"\u4ecb\u9762\u7d44\" \u8a2d\u5b9a\u70ba Forum moderator permissions \uff0c\u5728\u9078\u64c7\u4e86\u9069\u7576\u7684\u986f\u793a\u9806\u5e8f\u4e26\u78ba\u4fdd\u9078\u64c7\u4e86\u60a8\u7684\u9644\u52a0\u5143\u4ef6\u4e4b\u5f8c\uff0c\u9ede\u9078 \"\u5132\u5b58\"\u3002 \u8981\u771f\u6b63\u4f7f\u7528\u9019\u500b\u6b0a\u9650\uff0c\u6211\u5011\u9700\u8981\u56de\u5230\u6211\u5011\u7684\u7e7c\u627f\u4e3b\u984c Entity\uff0c\u4fee\u6539 canFeatureUnfeature() \u65b9\u6cd5\u3002 \u5c07 return true; \u66ff\u63db\u70ba\uff1a return \\XF::visitor()->hasNodePermission($this->node_id, 'demoPortalFeature'); \u6b64\u6642\uff0c\u7531\u65bc\u6b0a\u9650\u6c92\u6709\u4efb\u4f55\u9810\u8a2d\u503c\uff0c\u5982\u679c\u4f60\u53bb\u7de8\u8f2f\u4efb\u4f55\u4e00\u500b\u5e16\u5b50\uff0c\u4f60\u61c9\u8a72\u6703\u767c\u73fe \"\u7cbe\u9078\" checkbox \u4e0d\u898b\u4e86\u3002 \u4f46\u662f\uff0c\u5982\u679c\u60a8\u6388\u4e88\u81ea\u5df1\u8a72\u6b0a\u9650\uff0c\u5247\u8a72c heckbox \u5c07\u518d\u6b21\u51fa\u73fe\u3002 \u56e0\u6b64\uff0c\u9019\u61c9\u8a72\u8868\u660e\u4e86\u6b0a\u9650\u7684\u904b\u4f5c\u662f\u7b26\u5408\u9810\u671f\u7684! \u5efa\u7acb\u4e00\u4e9b\u9078\u9805 \u00b6 \u6211\u5011\u76ee\u524d\u6bcf\u9801\u53ea\u986f\u793a 5 \u500b\u7cbe\u9078\u4e3b\u984c\uff0c\u4f46\u5982\u679c\u80fd\u6709\u66f4\u591a\u7684\u986f\u793a\u9078\u9805\u5c31\u66f4\u597d\u4e86\u3002 \u5efa\u7acb\u9078\u9805\u5f88\u7c21\u55ae\u3002 \u96d6\u7136\u4e0d\u662f\u5fc5\u9808\u7684\uff0c\u4f46\u6211\u5011\u9996\u5148\u8981\u5efa\u7acb\u4e00\u500b\u65b0\u7684\u9078\u9805\u7d44\uff0c\u7136\u5f8c\u5411\u8a72\u7d44\u65b0\u589e\u4e00\u500b\u65b0\u7684\u9078\u9805\u3002 \u5728 Admin CP \u7684\u8a2d\u5b9a\u7136\u5f8c\u9078\u9805\u4e0b\u9ede\u9078 \"\u65b0\u589e\u9078\u9805\u7d44\" \u6309\u9215\u3002 \u6211\u5011\u5c07 \"\u7528\u6236\u7d44 ID\" \u7a31\u70ba demoPortal \uff0c\u4e26\u7d66\u5b83\u4e00\u500b \"Demo - Portal options\" \u7684\u6a19\u984c\u3002 \u7d66\u5b83\u4e00\u500b\u5408\u9069\u7684 \"\u63cf\u8ff0\" \u548c \"\u986f\u793a\u9806\u5e8f\"\uff0c\u7136\u5f8c\u9ede\u9078 \"\u5132\u5b58\"\u3002 \u73fe\u5728\u9ede\u9078 \"\u65b0\u589e\u9078\u9805\"\u3002 \u5c07 \"\u9078\u9805 ID\" \u8a2d\u5b9a\u70ba demoPortalFeaturedPerPage \uff0c\"Title\" \u8a2d\u5b9a\u70ba Featured threads per page \uff0c\u7de8\u8f2f\u683c\u5f0f\u8a2d\u5b9a\u70ba Spin box \uff0c\"\u8cc7\u6599\u985e\u578b\" \u8a2d\u5b9a\u70ba Positive integer \uff0c\"\u9810\u8a2d\u503c\" \u8a2d\u5b9a\u70ba \"10\"\u3002 \u9ede\u64ca \"\u5132\u5b58\"\u3002 \u8981\u5be6\u73fe\u9019\u4e00\u9ede\uff0c\u8acb\u56de\u5230 portal Controller\uff0c\u4e26\u5c07\uff1a $perPage = 5; \u66f4\u6539\u70ba\uff1a $perPage = $this->options()->demoPortalFeaturedPerPage; \u589e\u52a0\u53e6\u4e00\u500b\u9078\u9805\u53ef\u80fd\u4e0d\u6703\u6709\u4ec0\u9ebc\u5f71\u97ff\u3002 \u4e5f\u8a31\u53e6\u4e00\u500b\u6709\u7528\u7684\u9078\u9805\u662f\u53ef\u4ee5\u5c07\u9810\u8a2d\u7684\u6392\u5e8f\u9806\u5e8f\u5f9e xf_demo_portal_featured_thread.feartured_date \u6539\u70ba xf_thread.post_date \u3002 \u56de\u5230 \"Demo - Portal options\" \u7d44\uff0c\u9ede\u9078 \"\u65b0\u589e\u9078\u9805\"\u3002 \u5c07 \"\u9078\u9805 ID\" \u8a2d\u5b9a\u70ba demoPortalDefaultSort \uff0c\"Title\" \u8a2d\u5b9a\u70ba Default sort order \uff0c\"\u7de8\u8f2f\u683c\u5f0f\" \u8a2d\u5b9a\u70ba Radio buttons \u3002 \"\u683c\u5f0f\u53c3\u6578\" \u8a2d\u5b9a\u5982\u4e0b\uff1a plain featured_date={{ phrase('demo_portal_featured_date') }} post_date={{ phrase('demo_portal_post_date') }} \u6700\u5f8c\u5c07 \"\u9810\u8a2d\u503c\" \u8a2d\u5b9a\u70ba featured_date \uff0c\u9ede\u9078 \"\u5132\u5b58\"\u3002 \u6211\u5011\u9700\u8981\u5efa\u7acb\u7528\u65bc\u55ae\u9078\u6309\u9215\u6a19\u7c64\u7684\u77ed\u8a9e\uff0c\u985e\u4f3c\u65bc\u6211\u5011\u4e4b\u524d\u5efa\u7acb\u6a21\u677f\u4fee\u6539\u7684\u77ed\u8a9e\u3002 \u5c07\u9078\u9805\u503c\u8a2d\u5b9a\u70ba \"\u767c\u4f48\u65e5\u671f\"\u3002 \u56b4\u683c\u4f86\u8aaa\uff0c\u6211\u5011\u53ef\u4ee5\u76f4\u63a5\u66f4\u65b0\u6211\u5011\u7684 repository \u65b9\u6cd5\u4f86\u4f7f\u7528\u65b0\u7684\u9078\u9805\uff0c\u4f46\u662f\uff0c\u4e5f\u8a31\u503c\u5f97\u770b\u770b\u81ea\u5b9a\u7fa9 finder \u65b9\u6cd5\u662f\u5982\u4f55\u904b\u4f5c\u7684\u3002 \u5728\u8def\u5f91 src/addons/Demo/Portal/Finder/FeaturedThread.php \u4e2d\u5efa\u7acb\u4e00\u500b\u65b0\u6a94\u6848\uff0c\u5167\u5bb9\u5982\u4e0b\uff1a <?php namespace Demo\\Portal\\Finder; use XF\\Mvc\\Entity\\Finder; class FeaturedThread extends Finder { public function applyFeaturedOrder($direction = 'ASC') { $options = \\XF::options(); if ($options->demoPortalDefaultSort == 'featured_date') { $this->setDefaultOrder('featured_date', $direction); } else { $this->setDefaultOrder('Thread.post_date', $direction); } return $this; } } \u6b63\u5982\u4f60\u6240\u770b\u5230\u7684\uff0c\u6211\u5011\u5728\u9019\u88e1\u6240\u505a\u7684\u53ea\u662f\u5efa\u7acb\u4e86\u4e00\u500b\u76f8\u7576\u57fa\u672c\u7684\u985e\uff0c\u5b83\u7e7c\u627f\u4e86 XF Finder \u7269\u4ef6\uff0c\u4e26\u5275\u5efa\u4e00\u500b\u7c21\u55ae\u7684\u65b9\u6cd5\u4f86\u67e5\u770b\u6211\u5011\u9078\u9805\u7684\u503c\u4e26\u5957\u7528\u9069\u7576\u7684\u9810\u8a2d\u9806\u5e8f\u3002 \u73fe\u5728\u6211\u5011\u53ef\u4ee5\u66f4\u65b0\u6211\u5011\u7684 repository \u65b9\u6cd5\u4f86\u53d6\u4ee3\u9019\u500b\u65b9\u6cd5\u3002 \u5728\u6211\u5011\u7684\u7cbe\u9078\u4e3b\u984c repository \u88e1\u9762\uff0c\u627e\u5230\uff1a ->setDefaultOrder('featured_date', 'DESC') \u4e26\u6539\u6210\uff1a ->applyFeaturedOrder('DESC') \u6700\u5f8c\uff0c\u66f4\u65b0\u6211\u5011\u7684 portal view \u4ee5\u986f\u793a\u9069\u7576\u7684\u6642\u9593\u6233\u5927\u62b5\u5982\u6b64 - \u6839\u64da\u6211\u5011\u7684\u9078\u9805\u503c\uff0c\u53ef\u4ee5\u662f\u7cbe\u9078\u65e5\u671f\u6216\u767c\u4f48\u65e5\u671f\u3002 \u5728 demo_portal_view \u6a21\u677f\u4e2d\u5c07\uff1a <li><xf:date time=\"{$featuredThread.featured_date}\" /></li> \u66f4\u6539\u70ba\uff1a <li> <xf:if is=\"$xf.options.demoPortalDefaultSort == 'featured_date'\"> <xf:date time=\"{$featuredThread.featured_date}\" /> <xf:else /> <xf:date time=\"{$thread.post_date}\" /> </xf:if> </li> \u5728\u53ef\u898b\u6027\u8b8a\u66f4\u4e0a\u53d6\u6d88\u7cbe\u9078 \u00b6 \u70ba\u4e86\u89e3\u6c7a\u9019\u500b\u554f\u984c\uff0c\u6211\u5011\u9700\u8981\u518d\u6b21\u4fee\u6539\u4e3b\u984c Entity\uff0c\u4f46\u9019\u6b21\u6211\u5011\u5c07\u901a\u904e entity_post_save \u4e8b\u4ef6\u4f86\u5be6\u73fe\u3002 \u6b63\u5982\u6211\u5011\u5728 \u5be6\u9ad4\u751f\u547d\u9031\u671f \u4e2d\u63d0\u5230\u7684\uff0c _postSave() \u65b9\u6cd5\u662f\u5728 Entity \u88ab\u63d2\u5165\u6216\u4fee\u6539\u5f8c\u53ef\u4ee5\u57f7\u884c\u52d5\u4f5c\u7684\u5730\u65b9\u3002 \u6700\u521d\u6211\u5011\u6703\u5728\u4e00\u500b\u4e3b\u984c\u4e0d\u518d\u53ef\u898b\u7684\u6642\u5019\uff0c\u53d6\u6d88\u5c0d\u8a72\u4e3b\u984c\u7684\u7cbe\u9078\u3002 \u6240\u4ee5\uff0c\u56de\u5230 \"\u65b0\u589e\u7a0b\u5f0f\u78bc\u4e8b\u4ef6\u76e3\u807d\" \u9801\u9762\uff0c\u9019\u6b21\u76e3\u807d entity_post_save \u4e8b\u4ef6\u3002 \u9019\u6b21\u7684\u4e8b\u4ef6\u63d0\u793a\u5c07\u662f XF\\Entity\\Thread \u3002 \u5c0d\u65bc\u57f7\u884c callback\uff0c\u6211\u5011\u5c07\u4f7f\u7528\u8207\u4e4b\u524d\u76f8\u540c\u7684 class ( Dem\\Portal\\Listener )\uff0c\u4f46\u662f\u6211\u5011\u5c07\u5728\u9019\u88e1\u65b0\u589e\u4e00\u500b\u65b0\u7684\u65b9\u6cd5\uff0c\u547d\u540d\u70ba threadEntityPostSave \u3002 \u73fe\u5728\u8b93\u6211\u5011\u65b0\u589e\u9019\u500b\u65b9\u6cd5\uff0c\u9019\u6a23\u7576\u6211\u5011\u5132\u5b58\u76e3\u807d\u5668\u6642\uff0c\u5b83\u5c31\u6703\u51fa\u73fe\uff1a public static function threadEntityPostSave(\\XF\\Mvc\\Entity\\Entity $entity) { } \u9ede\u64ca \"\u5132\u5b58\" \u4f86\u5132\u5b58\u76e3\u807d\u5668\u3002 \u9019\u500b\u51fd\u6578\u7684\u5167\u5bb9\u76f8\u7576\u7c21\u55ae\uff0c\u6211\u5011\u4f86\u770b\u4e00\u4e0b\uff1a if ($entity->isUpdate()) { $visibilityChange = $entity->isStateChanged('discussion_state', 'visible'); if ($visibilityChange == 'leave') { $featuredThread = $entity->FeaturedThread; if ($featuredThread) { $featuredThread->delete(); $entity->fastUpdate('demo_portal_featured', false); } } } \u6211\u5011\u4e4b\u524d\u5df2\u7d93\u53d6\u6d88\u4e86\u4e3b\u984c\u7684\u7cbe\u9078\uff0c\u4f46\u9019\u4e00\u6b21\u6211\u5011\u8981\u4ee5\u4e3b\u984c\u7684\u72c0\u614b\u70ba\u689d\u4ef6\u3002 \u6211\u5011\u53ef\u4ee5\u4f7f\u7528 isStateChanged \u65b9\u6cd5\u6aa2\u6e2c\u72c0\u614b\u8b8a\u5316\u3002 \u9019\u5c07\u5c0d\u50b3\u905e\u9032\u4f86\u7684 column \u540d\u548c value \u8fd4\u56de enter \u6216 leave \u3002 \u4f8b\u5982\uff0c\u5982\u679c discussion_state \u5f9e visible \u8b8a\u70ba deleted \uff0c\u90a3\u9ebc\u5728\u4e0a\u9762\u7684\u4f8b\u5b50\u4e2d\uff0c\u8a72\u65b9\u6cd5\u5c07\u8fd4\u56de leave \u3002 \u4e00\u65e6\u6211\u5011\u6aa2\u6e2c\u5230\u81ea\u5df1 \"\u96e2\u958b\" \u53ef\u898b\u72c0\u614b\u5f8c\uff0c\u5c31\u53ef\u4ee5\u76f4\u63a5\u78ba\u5b9a\u81ea\u5df1\u6709\u4e00\u500b\u7cbe\u9078\u7684\u4e3b\u984c\u95dc\u806f\uff0c\u522a\u9664\u5b83\uff0c\u4e26\u66f4\u65b0\u5feb\u53d6\u503c\u3002 \u9019\u53ea\u6db5\u84cb\u4e86\u4e3b\u984c\u88ab\u66ab\u6642\u522a\u9664\u6216\u9001\u5165\u6279\u51c6\u4f47\u5217\u7684\u60c5\u6cc1\uff0c\u6211\u5011\u9084\u9700\u8981\u6db5\u84cb\u4e3b\u984c\u88ab\u6c38\u4e45\u522a\u9664\u7684\u60c5\u6cc1\u3002 \u70ba\u6b64\uff0c\u6211\u5011\u9700\u8981\u53e6\u4e00\u500b\u76e3\u807d\u5668\uff0c\u9019\u6b21\u662f\u91dd\u5c0d entity_post_delete \u4e8b\u4ef6\u3002 \u56e0\u6b64\uff0c\u4f7f\u7528\u76f8\u540c\u7684 callback class \u65b0\u589e\u8a72\u76e3\u807d\u5668\uff0c\u9019\u6b21\u7684\u65b9\u6cd5\u540d\u7a31\u70ba threadEntityPostDelete \u3002 \u5728\u76e3\u807d\u5668 class \u4e2d\u65b0\u589e\u4ee5\u4e0b\u7a0b\u5f0f\u78bc\uff1a public static function threadEntityPostDelete(\\XF\\Mvc\\Entity\\Entity $entity) { $featuredThread = $entity->FeaturedThread; if ($featuredThread) { $featuredThread->delete(); } } \u9ede\u9078 \"\u5132\u5b58\" \u4ee5\u5132\u5b58\u76e3\u807d\u5668\u5f8c\uff0c\u5c31\u53ef\u4ee5\u5c0d\u6b64\u9032\u884c\u6e2c\u8a66\u4e86\u3002 \u70ba\u4e86\u6e2c\u8a66\u9019\u500b\uff0c\u5176\u5be6\u4f60\u6700\u597d\u7559\u610f\u4e00\u4e0b xf_demo_portal_featured_thread \u8cc7\u6599\u8868\uff0c\u56e0\u70ba\u5230\u76ee\u524d\u70ba\u6b62\uff0c\u7a0b\u5f0f\u78bc\u5df2\u7d93\u4e0d\u6703\u986f\u793a\u4e0d\u53ef\u898b\u7684\u4e3b\u984c\u4e86\uff0c\u4f46\u91cd\u8981\u7684\u662f\u4e0d\u8981\u7559\u4e0b\u5b64\u5152\u8cc7\u6599\u3002 \u4e00\u5207\u90fd\u5f88\u9806\u5229\uff0c\u6211\u5011\u5df2\u7d93\u975e\u5e38\u63a5\u8fd1\u5b8c\u6210\u4e86...... \u6700\u5f8c\u4e00\u4e9b\u672a\u4ea4\u5f85\u6e05\u695a\u7684\u4e8b\u60c5 \u00b6 \u8aaa\u5230\u5b64\u5152\u8cc7\u6599\uff0c\u6bcf\u7576\u89e3\u9664\u5b89\u88dd\u9644\u52a0\u5143\u4ef6\u6642\uff0c\u6211\u5011\u90fd\u61c9\u8a72\u5c0d\u8cc7\u6599\u5eab\u9032\u884c\u6574\u7406\u3002 \u6211\u5011\u53ef\u4ee5\u5728\u6211\u5011\u4e4b\u524d\u5efa\u7acb\u7684 Setup class \u4e2d\u5b8c\u6210\u9019\u9805\u5de5\u4f5c\u3002 \u6211\u5011\u5c07\u5efa\u7acb 3 \u500b\u65b0\u65b9\u6cd5\uff0c\u5c0d\u61c9\u6211\u5011\u7684\u524d 3 \u500b\u5b89\u88dd\u6b65\u9a5f\uff1a public function uninstallStep1() { $this->schemaManager()->alterTable('xf_forum', function(Alter $table) { $table->dropColumns('demo_portal_auto_feature'); }); } public function uninstallStep2() { $this->schemaManager()->alterTable('xf_thread', function(Alter $table) { $table->dropColumns('demo_portal_featured'); }); } public function uninstallStep3() { $this->schemaManager()->dropTable('xf_demo_portal_featured_thread'); } \u6211\u5011\u4e0d\u9700\u8981\u5efa\u7acb\u89e3\u9664\u5b89\u88dd\u6b65\u9a5f\u4f86\u79fb\u9664\u5c0f\u7d44\u4ef6\uff0c\u56e0\u70ba\u7576\u5c0f\u7d44\u4ef6\u4f4d\u7f6e\u88ab\u79fb\u9664\u6642\uff0c\u5b83\u5011\u6703\u88ab\u81ea\u52d5\u79fb\u9664\u3002 \u5c0d\u65bc\u6211\u5011\u5efa\u7acb\u4e26\u8207\u9644\u52a0\u5143\u4ef6\u76f8\u95dc\u806f\u7684\u4efb\u4f55\u5176\u4ed6\u8cc7\u6599\u4e5f\u662f\u5982\u6b64 -- \u5b83\u5011\u5c07\u5728\u89e3\u9664\u5b89\u88dd\u6642\u81ea\u52d5\u522a\u9664\u3002 \u69cb\u5efa\u9644\u52a0\u5143\u4ef6 \u00b6 \u4efb\u4f55\u9644\u52a0\u5143\u4ef6\u7684\u6700\u5f8c\u4e00\u6b65\uff0c\u5c31\u662f\u767c\u4f48\u5b83\uff01 \u9019\u6d89\u53ca\u5230\u5f9e\u8cc7\u6599\u5eab\u4e2d\u63d0\u53d6 XML \u6a94\u6848\uff08\u5728\u8edf\u9ad4\u5305\u4e2d\u63d0\u4f9b\u4e26\u7528\u65bc\u5b89\u88dd\uff09\uff0c\u8a08\u7b97\u6bcf\u500b\u6a94\u6848\u7684\u96dc\u6e4a\u78bc\uff0c\u4e26\u5c07\u5176\u65b0\u589e\u5230\u6211\u5011\u7684 hashes.json \u4e2d\uff0c\u4e26\u5c07\u76f8\u95dc\u6a94\u6848\u6253\u5305\u6210\u4e00\u500b ZIP \u6a94\u6848\u3002 \u503c\u5f97\u6176\u5e78\u7684\u662f\uff0c\u9019\u53ef\u4ee5\u901a\u904e\u4e00\u500b CLI \u6307\u4ee4\u4f86\u5b8c\u6210! \u53ea\u8981\u57f7\u884c\u4e0b\u9762\u7684\u6307\u4ee4\u5c31\u53ef\u4ee5\u4e86\uff1a Terminal $ php cmd.php xf-addon:build-release Demo/Portal Performing add-on export. Exporting data for Demo - Portal to ../src/addons/Demo/Portal/_data. 10/10 [============================] 100% Written successfully. Building release ZIP. Writing release ZIP to ../src/addons/Demo/Portal/_releases. Release written successfully. \u90a3\u9ebc\uff0c\u6211\u5011\u7684\u6f14\u793a\u63d2\u4ef6\u5c31\u5230\u6b64\u7d50\u675f\u4e86\uff01 \u5982\u679c\u60a8\u60f3\u4e0b\u8f09\u9019\u500b\u9644\u52a0\u5143\u4ef6\u7684\u539f\u59cb\u78bc\uff0c\u8acb\u9ede\u9078\u9019\u88e1\uff1a Demo-Portal-1.0.0 Alpha.zip \u3002","title":"\u5275\u5efa\u4e00\u500b\u9644\u52a0\u7d44\u4ef6"},{"location":"lets-build-an-add-on/#_1","text":"\u5c0d\u65bc\u4e00\u4e9b\u4eba\u4f86\u8aaa\uff0c\u76f4\u63a5\u9032\u5165\u4e00\u500b\u9805\u76ee\u662f\u6700\u597d\u7684\u5b78\u7fd2\u65b9\u5f0f\uff0c\u6211\u5011\u7684\u76ee\u7684\u662f\u5728\u4e0b\u9762\u7684\u7ae0\u7bc0\u4e2d\uff0c\u60a8\u5c07\u5b78\u7fd2\u5982\u4f55\u5f9e\u982d\u958b\u59cb\u69cb\u5efa\u4e00\u500b\u9644\u52a0\u5143\u4ef6\u3002 \u505a\u597d\u6e96\u5099\uff1b\u9019\u4e0d\u662f\u4e00\u500b\u7c21\u55ae\u7684 'Hello world' \u985e\u578b\u7684\u6f14\u793a\u3002 \u9019\u5be6\u969b\u4e0a\u662f\u4e00\u500b\u529f\u80fd\u76f8\u7576\u9f4a\u5168\u7684\u6f14\u793a\u63d2\u4ef6\uff0c\u6db5\u84cb\u4e86 XF2 \u4e2d\u7684\u8a31\u591a\u6982\u5ff5\u3002 \u6211\u5011\u8981\u5efa\u7acb\u7684\u9644\u52a0\u5143\u4ef6\u5c07\u5141\u8a31\u64c1\u6709\u9069\u7576\u6b0a\u9650\u7684\u7528\u6236 \"\u7cbe\u9078\" \u4e00\u500b\u4e3b\u984c\uff0c\u4e26\u5141\u8a31\u8a72\u4e3b\u984c\u5728\u65b0\u9801\u9762\u4e0a\u986f\u793a\u3002 \u6211\u5011\u751a\u81f3\u6703\u8a2d\u5b9a\u4e00\u500b\u6d41\u7a0b\uff0c\u81ea\u52d5\u5728\u7279\u5b9a\u7684\u8ad6\u58c7\u4e2d\u5c0d\u4e3b\u984c\u9032\u884c\u7cbe\u9078\u8655\u7406\u3002 \u6211\u5011\u5c07\u70ba\u6b64\u4f7f\u7528\u4e00\u500b\u65b0\u7684\u8def\u7531\uff0c\u547d\u540d\u70ba portal \uff0c\u4e26\u6700\u7d42\u5c07\u5176\u8a2d\u5b9a\u70ba\u7d22\u5f15\u9801\u8def\u7531\uff0c\u4e26\u8a2d\u5b9a\u5728\u700f\u89bd\u8a72\u9801\u9762\u6642\u9078\u64c7 \"Home\" \u6a19\u7c64\u3002","title":"\u5efa\u7acb\u4e00\u500b\u9644\u52a0\u7d44\u4ef6"},{"location":"lets-build-an-add-on/#_2","text":"\u5728\u6574\u500b\u9644\u52a0\u5143\u4ef6\u4e2d\uff0c\u6211\u5011\u5c07\u4f7f\u7528\u9644\u52a0\u5143\u4ef6 ID \u70ba Demo/Portal \u3002 \u9996\u5148\u6211\u5011\u9700\u8981\u505a\u7684\u662f\u5efa\u7acb\u9644\u52a0\u5143\u4ef6\uff0c\u70ba\u6b64\u6211\u5011\u9700\u8981\u6253\u958b \u547d\u4ee4\u63d0\u793a\u5b57\u5143 / shell / \u7d42\u7aef\u8996\u7a97\uff0c\u5c07\u76ee\u9304\u6539\u70ba\u4f60\u7684 XF \u5b89\u88dd\u6839\u76ee\u9304\uff08\u5373 cmd.php \u6240\u5728\u7684\u4f4d\u7f6e\uff09\uff0c\u7136\u5f8c\u57f7\u884c\u4ee5\u4e0b\u6307\u4ee4\uff0c\u4e26\u8f38\u5165\u4e0b\u9762\u986f\u793a\u7684\u5c0d\u7b56\uff1a Terminal $ php cmd.php xf-addon:create Enter an ID for this add-on: Demo/Portal Enter a title: Demo - Portal Enter a version ID: This integer will be used for internal variable comparisons. Each release of your addon should increase this number: 1000010 Version string set to: 1.0.0 Alpha Does this add-on supersede a XenForo 1 add-on? (y/n) n The addon.json file was successfully written out to /var/www/src/addons/Demo/Portal/addon.json Does your add-on need a Setup file? (y/n) y Does your Setup need to support running multiple steps? (y/n) y The Setup.php file was successfully written out to /var/www/src/addons/Demo/Portal/Setup.php \u9644\u52a0\u5143\u4ef6\u73fe\u5728\u5df2\u7d93\u5efa\u7acb\uff0c\u4f60\u6703\u767c\u73fe\u4f60\u5728 src/addons \u76ee\u9304\u4e0b\u6709\u4e00\u500b\u65b0\u7684\u76ee\u9304\uff0c\u4f60\u6703\u5728 Admin CP \u7684 \"\u5df2\u5b89\u88dd add-ons\" \u5217\u8868\u4e2d\u627e\u5230\u8a72\u9644\u52a0\u5143\u4ef6\u3002 \u5176\u4e2d\u4e00\u500b\u5df2\u7d93\u5efa\u7acb\u7684\u6a94\u6848\u662f addon.json \u6a94\u6848\uff0c\u5b83\u76ee\u524d\u7684\u6a23\u5b50\u662f\u9019\u6a23\u7684\uff1a { \"legacy_addon_id\": \"\", \"title\": \"Demo - Portal\", \"description\": \"\", \"version_id\": 1000010, \"version_string\": \"1.0.0 Alpha\", \"dev\": \"\", \"dev_url\": \"\", \"faq_url\": \"\", \"support_url\": \"\", \"extra_urls\": [], \"require\": [], \"icon\": \"\" } \u8b93\u6211\u5011\u4f86\u586b\u4e00\u4e0b\u9019\u4e9b\u8a73\u7d30\u5167\u5bb9\uff1a { \"legacy_addon_id\": \"\", \"title\": \"Demo - Portal\", \"description\": \"Add-on which will display featured threads on the forum home page.\", \"version_id\": 1000010, \"version_string\": \"1.0.0 Alpha\", \"dev\": \"You!\", \"dev_url\": \"\", \"faq_url\": \"\", \"support_url\": \"\", \"extra_urls\": [], \"require\": [], \"icon\": \"fa-home\" } \u73fe\u5728\uff0c\u6211\u5011\u5df2\u7d93\u65b0\u589e\u4e86 description \uff0c\u958b\u767c\u8005\u7684\u540d\u5b57 ( dev )\uff0c\u4e26\u6307\u5b9a\u6211\u5011\u8981\u986f\u793a\u4e00\u500b\u5716\u793a ( icon )\u3002 \u5716\u793a\u53ef\u4ee5\u662f\u4e00\u500b\u8def\u5f91\uff08\u76f8\u5c0d\u65bc\u4f60\u7684 add-on \u6839\u76ee\u9304\uff09\uff0c\u4e5f\u53ef\u4ee5\u662f\u4e00\u500b Font Awesome \u5716\u793a \u7684\u540d\u7a31\uff0c\u5c31\u50cf\u6211\u5011\u5728\u9019\u88e1\u505a\u7684\u90a3\u6a23\u3002 \u7531\u65bc\u6211\u5011\u4e0d\u662f\u8981\u53d6\u4ee3 XenForo 1 \u9644\u52a0\u5143\u4ef6\uff0c\u6240\u4ee5\u6211\u5011\u53ef\u4ee5\u5ffd\u7565 legacy_addon_id \u3002 \u95dc\u65bc addon.json \u6a94\u6848\u4e2d\u6240\u6709\u5c6c\u6027\u7684\u5b8c\u6574\u89e3\u91cb\uff0c\u8acb\u53c3\u8003 \u9644\u52a0\u5143\u4ef6\u7d50\u69cb\u90e8\u5206 \u3002","title":"\u5efa\u7acb\u9644\u52a0\u5143\u4ef6"},{"location":"lets-build-an-add-on/#setup","text":"\u597d\u5427\uff0c\u56b4\u683c\u4f86\u8aaa\uff0c\u9019\u500b\u985e\u5df2\u7d93\u88ab\u5efa\u7acb\u4e26\u5beb\u5165\u4e86 Setup.php \uff0c\u4f46\u73fe\u5728\u5b83\u4e26\u6c92\u6709\u771f\u6b63\u505a\u4ec0\u9ebc\u3002 \u6211\u5011\u57fa\u672c\u4e0a\u5df2\u7d93\u6709\u4e86\u4e00\u500b class \u9aa8\u67b6\uff0c\u5b83\u770b\u8d77\u4f86\u50cf\u9019\u6a23\uff1a <?php namespace Demo\\Portal; use XF\\AddOn\\AbstractSetup; use XF\\AddOn\\StepRunnerInstallTrait; use XF\\AddOn\\StepRunnerUninstallTrait; use XF\\AddOn\\StepRunnerUpgradeTrait; class Setup extends AbstractSetup { use StepRunnerInstallTrait; use StepRunnerUpgradeTrait; use StepRunnerUninstallTrait; } \u6211\u5011\u5df2\u7d93\u8ac7\u904e\u4e00\u9ede\u95dc\u65bc Setup \u985e\u7684\u5167\u5bb9\u3002 \u6211\u5011\u5c07\u628a\u5b89\u88dd\u3001\u5347\u7d1a\u548c\u89e3\u9664\u5b89\u88dd\u904e\u7a0b\u5206\u6210\u4e0d\u540c\u7684\u6b65\u9a5f\u3002 \u8b93\u6211\u5011\u5f9e\u532f\u5165\u4e00\u4e9b\u6709\u7528\u7684 Schema \u985e\u958b\u59cb\u3002 \u5982\u679c\u4f60\u60f3\u4e86\u89e3\u66f4\u591a\u95dc\u65bc\u5b83\u5011\u7684\u8cc7\u8a0a\uff0c\u4f60\u53ef\u4ee5\u53c3\u8003 \u7ba1\u7406 Schema \u90e8\u5206 \u3002 \u5728\u6700\u5f8c\u4e00\u500b use \u8072\u660e\u4e4b\u5f8c\uff0c\u65b0\u589e\u4ee5\u4e0b\u5e7e\u884c\uff1a use XF\\Db\\Schema\\Alter; use XF\\Db\\Schema\\Create; \u9019\u88e1\u7684 StepRunner \u7279\u6027\u5c07\u8655\u7406\u6240\u6709\u53ef\u7528\u6b65\u9a5f\u7684\u5faa\u74b0\u904e\u7a0b\uff0c\u6240\u4ee5\u6211\u5011\u8981\u505a\u7684\u5c31\u662f\u958b\u59cb\u5efa\u7acb\u9019\u4e9b\u6b65\u9a5f\u3002 \u6211\u5011\u9996\u5148\u65b0\u589e\u4e00\u4e9b\u7a0b\u5f0f\u78bc\uff0c\u5728 xf_forum \u8cc7\u6599\u8868\u4e2d\u5efa\u7acb\u4e00\u500b\u65b0\u7684 column\uff1a <?php namespace Demo\\Portal; use XF\\AddOn\\AbstractSetup; use XF\\AddOn\\StepRunnerInstallTrait; use XF\\AddOn\\StepRunnerUninstallTrait; use XF\\AddOn\\StepRunnerUpgradeTrait; use XF\\Db\\Schema\\Alter; use XF\\Db\\Schema\\Create; class Setup extends \\XF\\AddOn\\AbstractSetup { use StepRunnerInstallTrait; use StepRunnerUpgradeTrait; use StepRunnerUninstallTrait; public function installStep1() { $this->schemaManager()->alterTable('xf_forum', function(Alter $table) { $table->addColumn('demo_portal_auto_feature', 'tinyint')->setDefault(0); }); } } \u9019\u4e00 column \u88ab\u65b0\u589e\u5230 xf_forum \u8cc7\u6599\u8868\u4e2d\uff0c\u9019\u6a23\u6211\u5011\u5c31\u53ef\u4ee5\u8a2d\u5b9a\u67d0\u4e9b\u8ad6\u58c7\u5728\u5efa\u7acb\u4e3b\u984c\u6642\u81ea\u52d5\u986f\u793a\u3002 \u9019\u88e1\u7684\u547d\u540d\u5f88\u91cd\u8981\uff0c\u65b0\u589e\u5230\u6838\u5fc3 XF \u8cc7\u6599\u8868\u4e2d\u7684 columns \u7e3d\u662f\u61c9\u8a72\u6709\u524d\u7db4\u3002 \u9019\u6709\u5169\u500b\u91cd\u8981\u7684\u76ee\u7684\u3002 \u7b2c\u4e00\u500b\u662f\u6e1b\u5c11\u4e86\u91cd\u8907 column \u540d\u767c\u751f\u885d\u7a81\u7684\u98a8\u96aa\uff0c\u4ee5\u9632 XF \u6216\u5176\u4ed6\u9644\u52a0\u5143\u4ef6\u6709\u7406\u7531\u5728\u5c07\u4f86\u65b0\u589e\u8a72 column\u3002 \u7b2c\u4e8c\u500b\u76ee\u7684\u662f\uff0c\u5b83\u6709\u52a9\u65bc\u66f4\u5bb9\u6613\u5730\u8b58\u5225\u54ea\u4e9b columns \u5c6c\u65bc\u54ea\u4e9b\u9644\u52a0\u5143\u4ef6\uff0c\u4ee5\u9632\u5c07\u4f86\u51fa\u73fe\u4e00\u4e9b\u554f\u984c\u3002 \u65e2\u7136\u5982\u6b64\uff0c\u6211\u5011\u4e0d\u59a8\u5728\u5b89\u88dd\u7a0b\u5f0f\u4e2d\u518d\u589e\u52a0\u4e00\u500b\u6b65\u9a5f\u3002 \u70ba\u4e86\u7c21\u6f54\u8d77\u898b\uff0c\u6211\u5011\u53ea\u986f\u793a\u65b0\u7a0b\u5f0f\u78bc\uff0c\u800c\u4e0d\u662f\u6574\u500b\u985e\u3002 \u5b83\u61c9\u8a72\u76f4\u63a5\u653e\u5728 installStep1() \u65b9\u6cd5\u7684\u4e0b\u9762\uff1a public function installStep2() { $this->schemaManager()->alterTable('xf_thread', function(Alter $table) { $table->addColumn('demo_portal_featured', 'tinyint')->setDefault(0); }); } \u9019\u4e00\u6b65\u9a5f\u8207\u4e0a\u9762\u7684\u6b65\u9a5f\u985e\u4f3c\uff0c\u9019\u6b21\u5c07\u5728 xf_thread \u8cc7\u6599\u8868\u4e2d\u65b0\u589e\u4e00\u500b\u65b0 column\u3002 \u6211\u5011\u5c07\u4f7f\u7528\u9019\u4e00 column \u4f5c\u70ba\u4e00\u500b\u5feb\u53d6\u503c\u4f86\u5feb\u901f\u8b58\u5225\u4e00\u500b\u4e3b\u984c\u662f\u5426\u6709\u7cbe\u9078\uff0c\u800c\u4e0d\u9700\u8981\u91dd\u5c0d xf_demo_portal_featured_thread \u8cc7\u6599\u8868\u67e5\u627e\u6216\u9032\u884c\u984d\u5916\u7684\u67e5\u8a62\u3002 \u8aaa\u5230\u9019\u88e1\uff0c\u6211\u5011\u73fe\u5728\u61c9\u8a72\u628a\u90a3\u500b\u8cc7\u6599\u8868\u52a0\u9032\u53bb\u4e86\u3002 \u9019\u6b21\u76f4\u63a5\u52a0\u5728 installStep2() \u4e0b\u9762\uff1a public function installStep3() { $this->schemaManager()->createTable('xf_demo_portal_featured_thread', function(Create $table) { $table->addColumn('thread_id', 'int'); $table->addColumn('featured_date', 'int'); $table->addPrimaryKey('thread_id'); }); } \u9019\u4e00\u6b65\u5c07\u5efa\u7acb\u65b0\u7684\u8cc7\u6599\u8868\u3002 \u9019\u5f35\u8cc7\u6599\u8868\u5c07\u7528\u4f86\u8a18\u9304\u6240\u6709\u88ab\u7cbe\u9078\u7684\u4e3b\u984c\uff0c\u4ee5\u53ca\u5b83\u5011\u88ab\u7cbe\u9078\u7684\u6642\u9593\u3002 \u5728\u547d\u540d\u65b9\u9762\uff0c\u540c\u6a23\u7684\u539f\u5247\u4e5f\u9069\u7528\u65bc\u6b64\u3002 \u4e00\u500b\u91cd\u8981\u7684\u5340\u5225\u662f\uff0c\u6240\u6709\u7684\u8cc7\u6599\u8868\u90fd\u61c9\u8a72\u53e6\u5916\u52a0\u4e0a xf_ \u7684\u524d\u7db4\u3002 \u9019\u6a23\u505a\u7684\u539f\u56e0\u662f\uff0c\u5982\u679c\u9032\u884c\u4e86\u4e7e\u6de8\u7684 XF \u5b89\u88dd\uff0c\u6211\u5011\u53ef\u4ee5\u522a\u9664\u6240\u6709\u5e36\u6709 xf_ \u524d\u7db4\u7684\u8cc7\u6599\u8868\uff0c\u5305\u62ec\u90a3\u4e9b\u7531\u9644\u52a0\u5143\u4ef6\u5efa\u7acb\u7684\u8cc7\u6599\u8868\u3002 \u5728\u65b0\u589e\u7a0b\u5f0f\u78bc\u6642\uff0c\u6700\u5bb9\u6613\u5fd8\u8a18\u7684\u4e00\u4ef6\u4e8b\u5c31\u662f\uff0c\u6dfb\u52a0\u4e86\u5404\u7a2e schema \u66f4\u6539\u5f8c\u5fd8\u8a18\u81ea\u5df1\u5957\u7528\u7684 schema \u66f4\u6539\u3002 \u4f60\u53ef\u4ee5\u4f7f\u7528 CLI \u6307\u4ee4\u57f7\u884c \u5b89\u88dd/\u5347\u7d1a \u6b65\u9a5f\u3002 \u5728\u9019\u7a2e\u60c5\u6cc1\u4e0b\uff0c\u57f7\u884c\u4ee5\u4e0b\u6307\u4ee4\uff1a Terminal $ php cmd.php xf-addon:install-step Demo/Portal 1 $ php cmd.php xf-addon:install-step Demo/Portal 2 $ php cmd.php xf-addon:install-step Demo/Portal 3","title":"\u5efa\u7acb Setup \u985e"},{"location":"lets-build-an-add-on/#_3","text":"\u5230\u76ee\u524d\u70ba\u6b62\uff0c\u6211\u5011\u5df2\u7d93\u5728 xf_forum \u8cc7\u6599\u8868\u4e2d\u65b0\u589e\u4e86\u4e00 column\uff0c\u73fe\u5728\u662f\u6642\u5019\u7e7c\u627f\u8ad6\u58c7 Entity \u7d50\u69cb\u4e86\u3002 \u6211\u5011\u9700\u8981\u9019\u6a23\u505a\uff0c\u4ee5\u4fbf Entity \u77e5\u9053\u6211\u5011\u7684\u65b0 column\uff0c\u4e26\u4e14\u53ef\u4ee5\u901a\u904e Entity \u5411\u5176\u8b80\u5beb\u8cc7\u6599\u3002 Note \u4ee5\u4e0b\u6b65\u9a5f\u9700\u8981\u555f\u7528 \u958b\u767c\u6a21\u5f0f \u3002 \u8a18\u5f97\u5728 config.php \u4e2d\u8a2d\u5b9a Demo/Portal \u70ba defaultAddOn \u503c\u3002 \u9019\u500b\u904e\u7a0b\u7684\u7b2c\u4e00\u6b65\u662f\u5efa\u7acb\u4e00\u500b \"\u7a0b\u5f0f\u78bc\u4e8b\u4ef6\u76e3\u807d\u5668\"\u3002 \u9019\u53ef\u4ee5\u5728\u958b\u767c\u4e0b\u7684 Admin CP \u4e2d\uff0c\u9ede\u9078 \"\u7a0b\u5f0f\u78bc\u4e8b\u4ef6\u76e3\u807d\u5668\" \u9023\u7d50\uff0c\u7136\u5f8c\u9ede\u9078 \"\u65b0\u589e\u7a0b\u5f0f\u78bc\u4e8b\u4ef6\u76e3\u807d\u5668\" \u6309\u9215\u3002 \u6211\u5011\u9700\u8981\u76e3\u807d entity_structure \u4e8b\u4ef6\u3002 \u6211\u5011\u5c07\u4f7f\u7528\u5b83\u4f86\u4fee\u6539\u9810\u8a2d\u7684\u8ad6\u58c7 Entity \u7d50\u69cb\uff0c\u4ee5\u65b0\u589e\u6211\u5011\u65b0\u5efa\u7acb\u7684 demo_portal_auto_feature column\u3002 \u5728 \"\u4e8b\u4ef6\u63d0\u793a\" \u6b04\u4f4d\u4e2d\uff0c\u6211\u5011\u5c07\u8f38\u5165\u8981\u7e7c\u627f\u7684\u985e\u540d\uff0c\u4f8b\u5982 XF\\Entity\\Forum \u3002 \u9019\u5c07\u78ba\u4fdd\u6211\u5011\u7684\u76e3\u807d\u5668\u53ea\u5728\u8ad6\u58c7 Entity \u4e0a\u57f7\u884c\u3002 \u5c0d\u65bc \"\u57f7\u884c callback\" \u985e\u8f38\u5165 Demo\\Portal\\Listener \uff0c\u5c0d\u65bc\u65b9\u6cd5\u8f38\u5165 forumEntityStructure \u3002 \u503c\u5f97\u65b0\u589e\u4e00\u500b\u63cf\u8ff0\u4f86\u89e3\u91cb\u9019\u500b\u76e3\u807d\u5668\u7684\u7528\u9014\uff0c\u56e0\u70ba\u9019\u5c07\u6709\u52a9\u65bc\u66f4\u5bb9\u6613\u5730\u5728\u7a0b\u5f0f\u78bc\u4e8b\u4ef6\u76e3\u807d\u5668\u5217\u8868\u4e2d\u8b58\u5225\u76e3\u807d\u5668\u3002 \"\u7e7c\u627f XF\\Entity\\Forum \u7d50\u69cb\" \u61c9\u8a72\u5c31\u5920\u4e86\u3002 \u6700\u5f8c\uff0c\u78ba\u4fdd \"Demo - Portal\" \u9644\u52a0\u5143\u4ef6\u88ab\u9078\u4e2d\u3002 \u5728\u9ede\u9078 \"\u5132\u5b58\" \u4e4b\u524d\uff0c\u6211\u5011\u9700\u8981\u5be6\u969b\u5efa\u7acb Listener \u985e\u3002 \u6240\u4ee5\u5728 src/addons/Demo/Portal \u4e2d\u5efa\u7acb\u4e00\u500b\u540d\u70ba Listener.php \u7684\u65b0\u6a94\u6848\u3002 \u9019\u500b\u6a94\u6848\u7684\u5167\u5bb9\u6700\u521d\u61c9\u8a72\u662f\u9019\u6a23\u7684\u3002 \u6211\u5011\u5f9e\u7a0b\u5f0f\u78bc\u4e8b\u4ef6\u9078\u64c7\u5668\u4e0b\u9762\u7684\u6a94\u6848\u4e2d\u77e5\u9053\u9019\u500b\u51fd\u6578\u9700\u8981\u7684\u53c3\u6578\u3002 <?php namespace Demo\\Portal; use XF\\Mvc\\Entity\\Entity; class Listener { public static function forumEntityStructure(\\XF\\Mvc\\Entity\\Manager $em, \\XF\\Mvc\\Entity\\Structure &$structure) { } } \u6ce8\u610f namespace \u548c class \u540d\u7a31\u4e4b\u9593\u7684 use \u5ba3\u544a\u3002 \u6211\u5011\u5c07\u4e0d\u6b62\u4e00\u6b21\u5730\u5f15\u7528\u9019\u88e1\u5ba3\u544a\u7684 class\uff0c\u56e0\u6b64\u5728\u9019\u88e1\u5ba3\u544a\u5b83\u78ba\u5be6\u5141\u8a31\u6211\u5011\u7528\u5b83\u66f4\u77ed\u7684\u5225\u540d\u4f86\u5f15\u7528\u5b83\uff0c\u5728\u672c\u4f8b\u4e2d\u662f Entity \u3002 \u9019\u6bb5\u7a0b\u5f0f\u78bc\u5be6\u969b\u4e0a\u9084\u4e0d\u6703\u505a\u4efb\u4f55\u4e8b\u60c5\uff0c\u4f46\u73fe\u5728\u662f\u5132\u5b58\u7a0b\u5f0f\u78bc\u4e8b\u4ef6\u76e3\u807d\u5668\u7684\u597d\u6642\u6a5f\uff0c\u6240\u4ee5\u8acb\u7e7c\u7e8c\u9ede\u9078 \"\u5132\u5b58\" \u6309\u9215\u3002 \u5728\u6211\u5011\u70ba\u65b0\u51fd\u6578\u6dfb\u52a0\u4e00\u4e9b\u529f\u80fd\u7a0b\u5f0f\u78bc\u4e4b\u524d\uff0c\u73fe\u5728\u4e5f\u8a31\u662f\u500b\u5f88\u597d\u7684\u6642\u6a5f\u4f86\u770b\u770b\u958b\u767c\u8f38\u51fa\u7cfb\u7d71\u662f\u5982\u4f55\u904b\u4f5c\u7684\u3002 \u6aa2\u67e5\u4e00\u4e0b\u65b0\u589e\u5230\u4f60 add-on \u76ee\u9304\u4e2d\u7684\u65b0\u76ee\u9304\u548c\u6a94\u6848\u3002 \u7279\u5225\u662f\u5728 _output/code_event_listeners \u76ee\u9304\u4e0b\u6709\u4e00\u500b\u65b0\u7684 JSON \u6a94\u6848\uff0c\u5b83\u61c9\u8a72\u662f\u9019\u6a23\u7684\uff1a { \"event_id\": \"entity_structure\", \"execute_order\": 10, \"callback_class\": \"Demo\\\\Portal\\\\Listener\", \"callback_method\": \"forumEntityStructure\", \"active\": true, \"hint\": \"XF\\\\Entity\\\\Forum\", \"description\": \"Extends the XF\\\\Entity\\\\Forum structure\" } \u6bcf\u7576\u76e3\u807d\u5668\u767c\u751f\u8b8a\u5316\u6642\uff0c\u9019\u500b\u6a94\u6848\u6703\u81ea\u52d5\u66f4\u65b0\u3002 \u597d\u4e86\uff0c\u6211\u5011\u518d\u4f86\u65b0\u589e\u4e00\u4e9b\u7a0b\u5f0f\u78bc\u3002 \u56de\u5230 Listener \u985e\u4e2d\uff0c\u5728 forumEntityStructure \u51fd\u6578\u4e2d\u65b0\u589e\u4ee5\u4e0b\u5167\u5bb9\uff1a $structure->columns['demo_portal_auto_feature'] = ['type' => Entity::BOOL, 'default' => false]; \u8ad6\u58c7 Entity \u73fe\u5728\u5df2\u7d93\u77e5\u9053\u4e86\u6211\u5011\u7684\u65b0 column\uff0c\u4f46\u5728\u958b\u59cb\u5be6\u4f5c\u5c0d\u8a72 column \u9032\u884c\u5be6\u969b\u8a2d\u5b9a\u503c\u7684\u65b9\u6cd5\u4e4b\u524d\uff0c\u6211\u5011\u9084\u9700\u8981\u5148\u8655\u7406\u5e7e\u500b\u6b65\u9a5f\u3002","title":"\u7e7c\u627f\u8ad6\u58c7\u5be6\u9ad4"},{"location":"lets-build-an-add-on/#_4","text":"\u540c\u6a23\uff0c\u7531\u65bc\u6211\u5011\u5728 xf_thread \u8cc7\u6599\u8868\u4e2d\u65b0\u589e\u4e86\u4e00\u500b\u65b0\u7684 column\uff0c\u6211\u5011\u61c9\u8a72\u8b93\u4e3b\u984c\u5be6\u9ad4\u77e5\u9053\u9019\u4e00\u9ede\u3002 \u9019\u8207\u6211\u5011\u4e0a\u9762\u7684\u4f5c\u6cd5\u975e\u5e38\u76f8\u4f3c\u3002 \u56de\u5230 \"\u65b0\u589e\u7a0b\u5f0f\u78bc\u4e8b\u4ef6\u76e3\u807d\u5668\"\uff0c\u518d\u6b21\u76e3\u807d entity_structure \u3002 \u9019\u6b21\u7684 \"\u4e8b\u4ef6\u63d0\u793a\" \u5c07\u662f XF\\Entity\\Thread \u3002 \u6211\u5011\u53ef\u4ee5\u4f7f\u7528\u8207\u4e4b\u524d\u76f8\u540c\u7684 callback \u985e\uff08 Demo\\Portal\\Listener \uff09\uff0c\u4f46\u9019\u6b21\u7684\u65b9\u6cd5\u5c07\u547d\u540d\u70ba threadEntityStructure \u3002 \u65b0\u589e\u985e\u4f3c\u4e4b\u524d\u7684\u63cf\u8ff0\u3002 \u5728\u5132\u5b58\u4e4b\u524d\uff0c\u6211\u5011\u61c9\u8a72\u5728 forumEntityStructure \u51fd\u6578\u4e0b\u9762\u76f4\u63a5\u65b0\u589e\u7a0b\u5f0f\u78bc\uff1a public static function threadEntityStructure(\\XF\\Mvc\\Entity\\Manager $em, \\XF\\Mvc\\Entity\\Structure &$structure) { $structure->columns['demo_portal_featured'] = ['type' => Entity::BOOL, 'default' => false]; } \u9019\u6bb5\u7a0b\u5f0f\u78bc\u8207\u6211\u5011\u5728\u8ad6\u58c7 Entity \u7d50\u69cb\u4e2d\u65b0\u589e\u7684\u7a0b\u5f0f\u78bc\u5e7e\u4e4e\u76f8\u540c\uff0c\u552f\u4e00\u4e0d\u540c\u7684\u662f column \u540d\u3002 \u4f46\u662f\uff0c\u6211\u5011\u78ba\u5be6\u9700\u8981\u65b0\u589e\u4e00\u4e9b\u5176\u4ed6\u7684\u6771\u897f\u3002 \u6211\u5011\u61c9\u8a72\u5efa\u7acb\u4e00\u500b Entity \u95dc\u806f\uff0c\u9019\u6a23\uff0c\u4ee5\u5f8c\u6211\u5011\u9700\u8981\u8a2a\u554f\u7cbe\u9078\u4e3b\u984c Entity\uff08\u6211\u5011\u5728\u4e0b\u4e00\u7bc0\u5efa\u7acb\uff09\u6642\uff0c\u6211\u5011\u5c31\u53ef\u4ee5\u5f88\u5bb9\u6613\u5730\u901a\u904e Finder \u67e5\u8a62\u4f86\u5be6\u73fe\u3002 \u5728 $structure->columns \u884c\u4e0b\u9762\u65b0\u589e\uff1a $structure->relations['FeaturedThread'] = [ 'entity' => 'Demo\\Portal:FeaturedThread', 'type' => Entity::TO_ONE, 'conditions' => 'thread_id', 'primary' => true ]; \u6709\u95dc \u95dc\u806f \u7684\u66f4\u591a\u8cc7\u8a0a\uff0c\u8acb\u53c3\u898b\u95dc\u806f\u3002 \u9ede\u9078 \"\u5132\u5b58\" \u4f86\u5132\u5b58\u76e3\u807d\u5668\u3002","title":"\u7e7c\u627f\u4e3b\u984c\u5be6\u9ad4"},{"location":"lets-build-an-add-on/#_5","text":"\u4e0a\u9762\u5728 installStep3() \u4e2d\uff0c\u6211\u5011\u5efa\u7acb\u4e86\u4e00\u500b\u65b0\u8cc7\u6599\u8868\u3002 \u6211\u5011\u9700\u8981\u5efa\u7acb\u4e00\u500b Entity \u4f86\u8207\u9019\u500b\u8cc7\u6599\u8868\u4e92\u52d5\u4e26\u5efa\u7acb\u65b0\u7684\u8a18\u9304\u3002 \u56e0\u70ba\u9019\u662f\u4e00\u500b\u5168\u65b0\u7684 Entity\uff0c\u6211\u5011\u9664\u4e86\u5728 src/addons/Demo/Portal/Entity/FeaturedThread.php \u4e2d\u5efa\u7acb class \u4e4b\u5916\uff0c\u4e0d\u9700\u8981\u505a\u4efb\u4f55\u5176\u4ed6\u7684\u4e8b\u60c5\uff0c\u5b83\u7684\u67b6\u69cb\u770b\u8d77\u4f86\u50cf\u9019\u6a23\uff1a <?php namespace Demo\\Portal\\Entity; use XF\\Mvc\\Entity\\Structure; class FeaturedThread extends \\XF\\Mvc\\Entity\\Entity { } \u6211\u5011\u9700\u8981\u7528\u5b83\u4f86\u5b9a\u7fa9 Entity \u7d50\u69cb\uff0c\u5b83\u4ee3\u8868\u6211\u5011\u4e4b\u524d\u5efa\u7acb\u7684\u65b0 xf_demo_portal_featured_thread \u8cc7\u6599\u8868\u3002 \u9019\u500b Entity \u7684\u7d50\u69cb\u61c9\u8a72\u662f\u9019\u6a23\u7684\uff1a public static function getStructure(Structure $structure) { $structure->table = 'xf_demo_portal_featured_thread'; $structure->shortName = 'Demo\\Portal:FeaturedThread'; $structure->primaryKey = 'thread_id'; $structure->columns = [ 'thread_id' => ['type' => self::UINT, 'required' => true], 'featured_date' => ['type' => self::UINT, 'default' => time()] ]; $structure->getters = []; $structure->relations = [ 'Thread' => [ 'entity' => 'XF:Thread', 'type' => self::TO_ONE, 'conditions' => 'thread_id', 'primary' => true ], ]; return $structure; } \u6839\u64da\u6211\u5011\u524d\u9762\u5beb\u7684 MySQL \u5efa\u7acb\u8cc7\u6599\u8868\uff0ccolumns \u7684\u5217\u8868\u5927\u6982\u4e0d\u9700\u8981\u52a0\u4ee5\u8aaa\u660e\u3002 \u95dc\u806f\u4e2d\u5305\u62ec\u4e00\u500b Thread \u95dc\u806f\uff0c\u5b83\u5c07\u5141\u8a31\u6211\u5011\u5f9e\u9019\u500b Entity \u4e2d\u7372\u5f97\u76f8\u95dc\u7684\u4e3b\u984c Entity \u8a18\u9304\uff08\u751a\u81f3\u4e3b\u984c Entity \u95dc\u806f\uff09\u3002","title":"\u5efa\u7acb\u4e00\u500b\u65b0\u5be6\u9ad4"},{"location":"lets-build-an-add-on/#_6","text":"\u6211\u5011\u73fe\u5728\u9700\u8981\u4e00\u7a2e\u65b9\u6cd5\u4f86\u4fee\u6539 forum_edit \u6a21\u677f\uff0c\u5728\u90a3\u88e1\u65b0\u589e\u4e00\u500b\u65b0\u7684 checkbox\uff0c\u6700\u7d42\u53ef\u4ee5\u5beb\u56de\u6211\u5011\u73fe\u5728\u5efa\u7acb\u7684\u65b0 column\u3002 \u6211\u5011\u5c07\u901a\u904e\u5efa\u7acb\u4e00\u500b\u6a21\u677f\u4fee\u6539\u4f86\u5be6\u73fe\u3002 \u9019\u662f\u5728 Admin CP \u4e0b\u7684\u5916\u89c0\u4e2d\u5b8c\u6210\u7684\uff0c\u7136\u5f8c\u9ede\u9078\u6a21\u677f\u4fee\u6539\u3002 \u9ede\u9078 \"Admin\" \u6a19\u7c64\uff0c\u7136\u5f8c\u518d\u9ede\u9078 \"\u65b0\u589e\u6a21\u677f\u4fee\u6539\" \u6309\u9215\u3002 \u5728 \"\u6a21\u677f\" \u6b04\u4e2d\uff0c\u8f38\u5165 \"forum_edit\"\u3002 \u9019\u5c31\u662f\u6211\u5011\u9700\u8981\u4fee\u6539\u7684\u6a21\u677f\u3002 \u5728 \"\u4fee\u6539 key\" \u6b04\u4f4d\u4e2d\uff0c\u8f38\u5165 \"demo_portal_forum_edit\"\u3002 \u9019\u662f\u4e00\u500b\u552f\u4e00\u7684 key\uff0c\u7528\u65bc\u6a19\u8b58\u60a8\u7684\u6a21\u677f\u4fee\u6539\u3002 \u9019\u90e8\u5206\u6700\u597d\u7684\u7fd2\u6163\u662f\uff0c\u6700\u8d77\u78bc\u8981\u5728\u88ab\u4fee\u6539\u7684\u6a21\u677f\u540d\u7a31\u5f8c\u9762\u8a3b\u660e\u9644\u52a0\u5143\u4ef6\u3002 \"\u63cf\u8ff0\" \u6b04\u4f4d\u61c9\u8a72\u5305\u542b\u4e00\u4e9b\u6587\u5b57\uff0c\u4ee5\u5e6b\u52a9\u60a8\u5728\u67e5\u770b\u6a21\u677f\u4fee\u6539\u5217\u8868\u6642\u78ba\u5b9a\u6b64\u4fee\u6539\u7684\u76ee\u7684\u3002 \u5c31\u50cf\u662f \"\u65b0\u589e\u81ea\u52d5\u7cbe\u9078 checkbox \u5230 forum_edit \u6a21\u677f\" \u9019\u6a23\u7684\u5167\u5bb9\u61c9\u8a72\u8db3\u5920\u4e86\u3002 \u7576\u60a8\u5728 \"\u6a21\u677f\" \u6b04\u4f4d\u4e2d\u8f38\u5165\u6a21\u677f\u540d\u7a31\u6642\uff0c\u60a8\u53ef\u80fd\u6703\u6ce8\u610f\u5230\u986f\u793a\u4e86\u6a21\u677f\u5167\u5bb9\u7684\u9810\u89bd\u3002 \u6211\u5011\u9700\u8981\u5229\u7528\u9019\u500b\u4f86\u78ba\u5b9a checkbox \u7684\u504f\u597d\u4f4d\u7f6e\u3002 \u5728\u67e5\u770b\u8ad6\u58c7\u7de8\u8f2f\u9801\u9762\u6642\uff0c\u4f60\u53ef\u80fd\u6703\u6ce8\u610f\u5230\u6709\u4e00\u7cfb\u5217\u7684 checkbox\uff0c\u9019\u770b\u8d77\u4f86\u662f\u4e00\u500b\u5408\u7406\u7684\u4f4d\u7f6e\u3002 \u6700\u7c21\u55ae\u7684\u65b9\u6cd5\u662f\u5728\u9019\u500b\u90e8\u5206\u653e\u7f6e\u4e00\u500b checkbox\uff0c\u5c0d\u4e0a\u9762\u7684 checkbox \u9032\u884c\u7c21\u55ae\u7684\u66ff\u63db\uff0c\u6240\u4ee5\u5728 \"\u67e5\u8a62\" \u6b04\u4e2d\u65b0\u589e\uff1a <xf:option name=\"allow_posting\" \u4e26\u5728\u6b04\u4f4d\u4e2d\u66ff\u63db\uff1a <xf:option name=\"demo_portal_auto_feature\" selected=\"$forum.demo_portal_auto_feature\" label=\"Automatically feature threads in this forum\" hint=\"If selected, any new threads posted in this forum will be automatically featured.\" /> $0 \u6211\u5011\u9084\u4e0d\u9700\u8981\u64d4\u5fc3\u5efa\u7acb\u77ed\u8a9e\u7684\u554f\u984c\uff0c\u6211\u5011\u53ef\u4ee5\u7a0d\u5f8c\u518d\u4f86\u62fe\u53d6\u9019\u4e9b\u3002 \u6ce8\u610f\uff0c\u540d\u7a31\u5c6c\u6027\u5fc5\u9808\u8207\u6211\u5011\u4e4b\u524d\u5efa\u7acb\u7684 column \u540d\u76f8\u5339\u914d\uff0c\u66f4\u91cd\u8981\u7684\u662f\uff0ccheckbox row \u7684\u52fe\u9078\u72c0\u614b\u4e5f\u662f\u5f9e\u8ad6\u58c7 Entity \u4e2d\u8b80\u53d6\u65b0\u589e\u52a0\u7684 column\u3002 \u7576\u6211\u5011\u7a0d\u5f8c\u5132\u5b58\u6a21\u677f\u4fee\u6539\u6642\uff0c\u5982\u679c\u67e5\u8a62\u6b04\u4f4d\u7684\u5167\u5bb9\u8207\u6a21\u677f\u7684\u4efb\u4f55\u90e8\u5206\u76f8\u5339\u914d\uff0c\u90a3\u9ebc\u5b83\u5c07\u88ab\u66ff\u63db\u6b04\u4f4d\u7684\u5167\u5bb9\u6240\u53d6\u4ee3\u3002 \u5be6\u969b\u4e0a\u6211\u5011\u4e26\u6c92\u6709\u522a\u9664\u5339\u914d\u7684\u5167\u5bb9\uff0c\u56e0\u70ba\u66ff\u63db\u6b04\u4f4d\u4e2d\u7684 $0 \u662f\u91cd\u65b0\u63d2\u5165\u5339\u914d\u7684\u6587\u5b57\u3002 \u6211\u5011\u53ef\u4ee5\u4f7f\u7528 \"\u6e2c\u8a66\" \u6309\u9215\u4f86\u6aa2\u67e5\u66ff\u63db\u7684\u904b\u4f5c\u662f\u5426\u7b26\u5408\u9810\u671f\u3002 \u7576\u9ede\u64ca\u6e2c\u8a66\u6309\u9215\u6642\uff0c\u6703\u51fa\u73fe\u4e00\u500b\u8986\u84cb\u5c64\u5e36\u6709\u4fee\u6539\u5f8c\u7684\u6a21\u677f\u3002 \u5982\u679c\u4e00\u5207\u9806\u5229\uff0c\u4e00\u500b\u7da0\u8272\u5340\u57df\u61c9\u8a72\u9ad8\u4eae\u986f\u793a\u6211\u5011\u8981\u6dfb\u52a0\u7684\u65b0\u7a0b\u5f0f\u78bc\u3002 Note \u9019\u662f\u4e00\u500b\u76f8\u7576\u7c21\u55ae\u7684\u66ff\u63db\u3002 \u5c0d\u65bc\u66f4\u9032\u968e\u7684\u5339\u914d\uff0c\u4f60\u4e5f\u53ef\u4ee5\u4f7f\u7528 \"\u6b63\u898f\u8868\u9054\u5f0f\" \u985e\u578b\u3002 \u95dc\u65bc\u4f7f\u7528\u6b63\u898f\u8868\u9054\u5f0f\u7684\u8a73\u7d30\u89e3\u91cb\u8d85\u51fa\u4e86\u672c\u6307\u5357\u7684\u7bc4\u570d\uff0c\u4f46\u7db2\u4e0a\u6709\u5f88\u591a\u8cc7\u6e90\u53ef\u80fd\u6703\u6709\u6240\u5e6b\u52a9\u3002 \u6700\u5f8c\uff0c\u9ede\u9078\u5132\u5b58\uff0c\u5132\u5b58\u4f60\u7684\u6a21\u677f\u4fee\u6539\u3002 \u5982\u679c\u4e00\u5207\u9806\u5229\uff0c\u7576\u4f60\u8fd4\u56de\u6a21\u677f\u4fee\u6539\u5217\u8868\u6642\uff0c\u4f60\u6703\u770b\u5230\u65e5\u8a8c\u6458\u8981\u986f\u793a 1 / 0 / 0 \u56e0\u6b64\u8868\u660e\u4fee\u6539\u6210\u529f\u5957\u7528\u4e00\u6b21\u3002 \u4e00\u500b\u66f4\u597d\u7684\u6307\u793a\u662f\u9032\u5165 Admin CP \u4e2d \"\u8ad6\u58c7\" \u4e0b\u7684 \"\u7bc0\u9ede\" \u9801\u9762\uff0c\u7de8\u8f2f\u4e00\u500b\u73fe\u6709\u7684\u8ad6\u58c7\u3002 \u73fe\u5728\u61c9\u8a72\u6703\u51fa\u73fe\u6211\u5011\u65b0\u6dfb\u52a0\u7684\u6a21\u677f\u4fee\u6539\u3002","title":"\u4fee\u6539\u8ad6\u58c7\u7de8\u8f2f\u8868\u55ae"},{"location":"lets-build-an-add-on/#_7","text":"\u6211\u5011\u6709\u4e86 column\uff0c\u6709\u4e86\u4e00\u500b UI \u4f86\u50b3\u905e input \u5230\u8a72 column\uff0c\u73fe\u5728\u6211\u5011\u5fc5\u9808\u8655\u7406\u5132\u5b58\u8cc7\u6599\u5230\u8a72 column\u3002 \u6211\u5011\u5c07\u901a\u904e\u7e7c\u627f\u8ad6\u58c7 Controller \u548c\u7e7c\u627f\u4e00\u500b\u7279\u6b8a\u7684\u65b9\u6cd5\u4f86\u5be6\u73fe\u9019\u500b\u76ee\u7684\uff0c\u7576\u4e00\u500b\u7bc0\u9ede\u53ca\u5176\u8cc7\u6599\u88ab\u5132\u5b58\u6642\uff0c\u8a72\u65b9\u6cd5\u5c07\u88ab\u547c\u53eb\u3002 \u9996\u5148\uff0c\u8b93\u6211\u5011\u5efa\u7acb\u4e00\u500b \"Class extension\"\uff0c\u5b83\u53ef\u4ee5\u5728 Admin CP \u7684 \"\u958b\u767c\" \u689d\u76ee\u4e0b\u627e\u5230\u3002 \u9ede\u9078 \"\u65b0\u589e Class extension\"\u3002 \u5728\u9019\u88e1\uff0c\u6211\u5011\u9700\u8981\u6307\u5b9a\u4e00\u500b \"\u7236\u985e\u540d\u7a31\"\uff0c\u4e5f\u5c31\u662f\u6211\u5011\u8981\u7e7c\u627f\u7684 class \u540d\u7a31\uff0c\u5728\u672c\u4f8b\u4e2d\u662f XF\\Admin\\Controller\\Forum \u3002 \u4e26\u4e14\u6211\u5011\u9700\u8981\u6307\u5b9a\u4e00\u500b \"\u7e7c\u627f class \u540d\u7a31\"\uff0c\u4e5f\u5c31\u662f\u7e7c\u627f\u7236\u985e\u7684 class\u3002 \u8f38\u5165 Demo\\Portal\\XF\\Admin\\Controller\\Forum \u3002 \u6211\u5011\u61c9\u8a72\u5728\u9ede\u9078\u5132\u5b58\u4e4b\u524d\u5efa\u7acb\u9019\u500b class\u3002 \u5728 src/addons/Demo/Portal/XF/Admin/Controller \u4e2d\u5efa\u7acb\u4e00\u500b\u65b0\u6a94\u6848\uff0c\u547d\u540d\u70ba Forum.php \u3002 \u9019\u53ef\u80fd\u770b\u8d77\u4f86\u50cf\u4e00\u500b\u5f88\u9577\u7684\u8def\u5f91\uff0c\u4f46\u6211\u5011\u5efa\u8b70\u7e7c\u627f class \u4f7f\u7528\u9019\u6a23\u7684\u8def\u5f91\u3002 \u5b83\u53ef\u4ee5\u8b93\u4f60\u66f4\u5bb9\u6613\u5730\u8b58\u5225\u51fa\u4ee3\u8868\u7e7c\u627f class \u7684\u6a94\u6848\uff0c\u56e0\u70ba\u5b83\u5011\u5728\u4e00\u500b\u8207\u7e7c\u627f\u7684 \"add-on\" ID (\u672c\u4f8b\u4e2d\u70ba XF ) \u540c\u540d\u7684\u76ee\u9304\u4e2d\u3002 \u5b83\u9084\u53ef\u4ee5\u6e05\u695a\u5730\u8aaa\u660e\u5230\u5e95\u662f\u54ea\u500b class \u88ab\u7e7c\u627f\u4e86\uff0c\u56e0\u70ba\u76ee\u9304\u7d50\u69cb\u8207\u9810\u8a2d class \u7684\u8def\u5f91\u76f8\u540c\u3002 \u76ee\u524d\uff0c\u6a94\u6848\u7684\u5167\u5bb9\u61c9\u8a72\u662f\u9019\u6a23\u7684\uff1a <?php namespace Demo\\Portal\\XF\\Admin\\Controller; class Forum extends XFCP_Forum { } \u66f4\u591a\u8cc7\u8a0a\u8acb\u53c3\u898b \u7e7c\u627f\u985e \u548c \u985e\u578b\u63d0\u793a \u3002 \u9ede\u9078\u5132\u5b58\uff0c\u5132\u5b58 Class extension\u3002 \u73fe\u5728\u6211\u5011\u53ef\u4ee5\u65b0\u589e\u4e00\u4e9b\u7a0b\u5f0f\u78bc\u4e86\u3002 \u6211\u5011\u9700\u8981\u7e7c\u627f\u7684\u7279\u5b9a\u65b9\u6cd5\u662f\u4e00\u500b\u540d\u70ba saveTypeData \u7684 protected \u51fd\u6578\u3002 \u7576\u7e7c\u627f\u4efb\u4f55\u985e\u4e2d\u73fe\u6709\u7684\u65b9\u6cd5\u6642\uff0c\u6aa2\u67e5\u539f\u59cb\u65b9\u6cd5\u662f\u5f88\u91cd\u8981\u7684\uff0c\u539f\u56e0\u6709\u5e7e\u500b\u3002 \u7b2c\u4e00\u500b\u539f\u56e0\u662f\u6211\u5011\u8981\u78ba\u4fdd\u6211\u5011\u5728\u7e7c\u627f\u65b9\u6cd5\u4e2d\u4f7f\u7528\u7684\u53c3\u6578\u8207\u6211\u5011\u8981\u7e7c\u627f\u7684\u65b9\u6cd5\u76f8\u5339\u914d\u3002 \u7b2c\u4e8c\u500b\u539f\u56e0\u662f\uff0c\u6211\u5011\u9700\u8981\u77e5\u9053\u9019\u500b\u65b9\u6cd5\u5be6\u969b\u4e0a\u662f\u505a\u4ec0\u9ebc\u7684\u3002 \u4f8b\u5982\uff0c\u9019\u500b\u65b9\u6cd5\u61c9\u8a72\u8fd4\u56de\u67d0\u500b\u7279\u5b9a\u985e\u578b\u7684\u6771\u897f\uff0c\u9084\u662f\u67d0\u500b\u7269\u4ef6\uff1f \u9019\u5728\u5927\u591a\u6578 Controller action \u4e2d\u80af\u5b9a\u662f\u9019\u6a23\u7684\uff0c\u6211\u5011\u5728 \u4fee\u6539 Controller action \u56de\u61c9\uff08properly\uff09 \u4e00\u7bc0\u4e2d\u63d0\u5230\u904e\u3002 \u7136\u800c\uff0c\u96d6\u7136\u9019\u500b\u65b9\u6cd5\u662f\u5728\u4e00\u500b Controller \u5167\uff0c\u4f46\u5be6\u969b\u4e0a\u5b83\u672c\u8eab\u4e26\u4e0d\u662f\u4e00\u500b Controller action\u3002 \u4e8b\u5be6\u4e0a\uff0c\u9019\u500b\u65b9\u6cd5\u662f\u4e00\u500b \"void\" \u65b9\u6cd5\uff1b\u5b83\u4e0d\u9700\u8981\u8fd4\u56de\u4efb\u4f55\u6771\u897f\u3002 \u7136\u800c\uff0c\u6211\u5011\u61c9\u8a72\u59cb\u7d42\u78ba\u4fdd\u6211\u5011\u5728\u7e7c\u627f\u65b9\u6cd5\u4e2d\u547c\u53eb\u7236\u985e\u65b9\u6cd5\uff0c\u6240\u4ee5\u6211\u5011\u53ea\u9700\u6dfb\u52a0\u65b0\u65b9\u6cd5\u672c\u8eab\uff0c\u800c\u4e0d\u9700\u8981\u6dfb\u52a0\u65b0\u7684\u7a0b\u5f0f\u78bc\uff1a protected function saveTypeData(FormAction $form, \\XF\\Entity\\Node $node, \\XF\\Entity\\AbstractNode $data) { parent::saveTypeData($form, $node, $data); } Warning \u6b64\u7279\u5b9a\u65b9\u6cd5\u7684\u53c3\u6578\u5217\u8868\u5047\u5b9a\u6211\u5011\u6709\u4e00\u500b use \u5ba3\u544a\uff0c\u5b83\u5c07\u5b8c\u6574\u7684 \\XF\\Mvc\\FormAction \u985e\u5225\u540d\u70ba\u7c21\u55ae\u7684 FormAction \u3002 \u56e0\u6b64\u4f60\u9700\u8981\u81ea\u5df1\u65b0\u589e\u90a3\u500b use \u5ba3\u544a\u3002 \u5728 namespace \u548c class \u884c\u4e4b\u9593\u65b0\u589e use XF\\Mvc\\FormAction; \u3002 \u6240\u4ee5\uff0c\u73fe\u5728\uff0c\u6211\u5011\u5df2\u7d93\u7e7c\u627f\u4e86\u90a3\u500b\u65b9\u6cd5\uff0c\u800c\u6211\u5011\u7684\u7e7c\u627f\u61c9\u8a72\u88ab\u547c\u53eb\uff0c\u4f46\u73fe\u5728\u5b83\u9664\u4e86\u547c\u53eb\u5b83\u7684\u7236\u985e\u65b9\u6cd5\u5916\uff0c\u6c92\u6709\u505a\u4efb\u4f55\u4e8b\u60c5\u3002 \u73fe\u5728\u6211\u5011\u9700\u8981\u5f9e\u8ad6\u58c7\u7de8\u8f2f\u9801\u9762\u7372\u53d6\u8f38\u5165\u503c\uff0c\u4e26\u5c07\u5176\u5957\u7528\u5230 $data \u5be6\u9ad4\uff08\u5728\u672c\u4f8b\u4e2d\u662f\u8ad6\u58c7\u5be6\u9ad4\uff09\u3002 protected function saveTypeData(FormAction $form, \\XF\\Entity\\Node $node, \\XF\\Entity\\AbstractNode $data) { parent::saveTypeData($form, $node, $data); $form->setup(function() use ($data) { $data->demo_portal_auto_feature = $this->filter('demo_portal_auto_feature', 'bool'); }); } \u4f7f\u7528 FormAction \u7269\u4ef6\u5141\u8a31\u6211\u5011\u5728\u5178\u578b\u7684\u8868\u55ae\u63d0\u4ea4\u904e\u7a0b\u4e2d\uff0c\u5177\u6709\u5404\u7a2e\u4e0d\u540c\u7684 extension points \u5230\u7a0b\u5e8f\u4e2d\u904b\u884c\u3002 \u4e26\u4e0d\u662f\u6240\u6709\u7684 Controller action \u90fd\u53ef\u4ee5\u4f7f\u7528\u3002 \u4f8b\u5982\uff0c\u5b83\u5728 Admin CP \u4e2d\u66f4\u70ba\u666e\u904d\uff0c\u5b83\u901a\u5e38\u9075\u5faa\u7c21\u55ae\u7684 CRUD \u6a21\u578b\uff08\u65b0\u589e\u3001\u67e5\u8a62\u3001\u4fee\u6539\u3001\u522a\u9664\uff09\u3002 XF \u4e2d\u7684\u8a31\u591a\u5176\u4ed6\u7a0b\u5e8f\u90fd\u767c\u751f\u5728 Service \u7269\u4ef6\u5167\uff0cService \u7269\u4ef6\u901a\u5e38\u6709\u8207\u6b63\u5728\u904b\u884c\u7684\u670d\u52d9\u76f8\u95dc\u7279\u5b9a extension points\u3002 FormAction \u7269\u4ef6\u7684\u9019\u7a2e\u7279\u6b8a\u7528\u6cd5\u8207\u4f60\u901a\u5e38\u6703\u9047\u5230\u7684\u60c5\u6cc1\u6709\u4e9b\u4e0d\u540c\u3002 \u5132\u5b58\u4e00\u500b\u7bc0\u9ede\u662f\u500b\u6709\u4e9b\u4e0d\u540c\u7684\u7a0b\u5e8f\uff0c\u56e0\u70ba\u9664\u4e86\u8207\u7bc0\u9ede\u5be6\u9ad4\u4e00\u8d77\u904b\u4f5c\u5916\uff0c\u4f60\u9084\u6703\u8207\u76f8\u95dc\u7684\u7bc0\u9ede\u985e\u578b\u4e00\u8d77\u904b\u4f5c\uff0c\u4f8b\u5982\u4e00\u500b\u8ad6\u58c7 Entity\u3002 \u4e0d\u904e\u5728\u9019\u500b\u65b9\u6cd5\u4e2d\uff0c\u6211\u5011\u78ba\u5be6\u53ef\u4ee5\u8a2a\u554f\u8868\u55ae action \u7269\u4ef6\uff0c\u6240\u4ee5\u6211\u5011\u61c9\u8a72\u4f7f\u7528\u5b83\u3002 \u6211\u5011\u5728\u9019\u88e1\u4f7f\u7528\u5b83\u4f86\u70ba\u7a0b\u5e8f\u7684 \"\u8a2d\u5b9a\" \u968e\u6bb5\u65b0\u589e\u4e00\u500b\u7279\u5b9a\u7684\u884c\u70ba\u3002 \u4e5f\u5c31\u662f\u8aaa\uff0c\u7576\u547c\u53eb FormAction \u7269\u4ef6\u7684 run() \u65b9\u6cd5\u6642\uff0c\u5b83\u5c07\u6309\u7167\u7279\u5b9a\u7684\u9806\u5e8f\u57f7\u884c\u5404\u500b\u968e\u6bb5\u3002 \u4e0d\u7ba1\u9019\u4e9b\u884c\u70ba\u662f\u4ee5\u54ea\u7a2e\u9806\u5e8f\u65b0\u589e\u5230\u7269\u4ef6\u4e2d\u7684\uff0c\u5b83\u5011\u4ecd\u7136\u6703\u6309\u7167 setup \u3001 validate \u3001 apply \u3001 complete \u7684\u9806\u5e8f\u57f7\u884c\u3002 \u901a\u904e\u4e0a\u9762\u7684\u7a0b\u5f0f\u78bc\uff0c\u6211\u5011\u53ef\u4ee5\u5c07\u8ad6\u58c7 Entity \u4e2d\u7684 demo_portal_auto_feature column \u8a2d\u5b9a\u70ba\u6211\u5011\u65b0\u589e\u5230\u8ad6\u58c7\u7de8\u8f2f\u9801\u9762\u7684 demo_portal_auto_feature \u8f38\u5165\u5b58\u5132\u7684\u4efb\u4f55\u503c\u3002 \u73fe\u5728\u61c9\u8a72\u53ef\u4ee5\u6e2c\u8a66\u6240\u6709\u9019\u4e9b\u5de5\u4f5c\u4e86\u3002 \u53ea\u9700\u7de8\u8f2f\u60a8\u9078\u64c7\u7684\u8ad6\u58c7\u4e26\u52fe\u9078 checkbox\u3002 \u4f60\u61c9\u8a72\u53ef\u4ee5\u89c0\u5bdf\u5230\u5169\u4ef6\u4e8b\u3002 \u9996\u5148\uff0c\u7576\u4f60\u56de\u5230\u7de8\u8f2f\u90a3\u500b\u8ad6\u58c7\u6642\uff0ccheckbox \u73fe\u5728\u61c9\u8a72\u88ab\u52fe\u9078\u4e86\u3002 \u7b2c\u4e8c\uff0c\u5982\u679c\u4f60\u5728 xf_forum \u8cc7\u6599\u8868\u4e2d\u67e5\u770b\u4f60\u525b\u525b\u7de8\u8f2f\u7684\u8ad6\u58c7\uff0c demo_portal_auto_feature \u6b04\u4f4d\u73fe\u5728\u61c9\u8a72\u8a2d\u5b9a\u70ba 1\u3002 \u8acb\u4fdd\u6301\u9019\u500b\u503c\uff0c\u56e0\u70ba\u6211\u5011\u6700\u7d42\u6703\u81ea\u52d5\u7cbe\u9078\u8a72\u8ad6\u58c7\u7684\u4e3b\u984c\u3002","title":"\u7e7c\u627f\u8ad6\u58c7\u7684\u5132\u5b58\u904e\u7a0b"},{"location":"lets-build-an-add-on/#_8","text":"\u6211\u5011\u5df2\u7d93\u5728\u8ad6\u58c7 Entity \u4e2d\u65b0\u589e\u4e86\u4e00\u500b\u65b0\u7684 column\uff0c\u9019\u5c07\u5141\u8a31\u6211\u5011\u5728\u8ad6\u58c7\u4e2d\u65b0\u5efa\u7acb\u4e00\u500b\u4e3b\u984c\u6642\u81ea\u52d5\u9032\u884c\u7cbe\u9078\u4ecb\u7d39\uff0c\u6240\u4ee5\u73fe\u5728\u662f\u6642\u5019\u65b0\u589e\u7a0b\u5f0f\u78bc\u4f86\u5be6\u73fe\u9019\u500b\u529f\u80fd\u4e86\u3002 \u5728 XF2 \u4e2d\uff0c\u6211\u5011\u5927\u91cf\u4f7f\u7528 Service \u7269\u4ef6\u3002 \u9019\u4e9b\u7269\u4ef6\u901a\u5e38\u63a1\u7528 \"setup and go\" \u985e\u578b\u7684\u65b9\u6cd5\uff1b\u4f60\u8a2d\u5b9a\u4f60\u7684\u914d\u7f6e\uff0c\u7136\u5f8c\u547c\u53eb\u4e00\u500b\u65b9\u6cd5\u4f86\u5b8c\u6210\u52d5\u4f5c\u3002 \u6211\u5011\u4f7f\u7528 Service \u7269\u4ef6\u4f86\u8a2d\u5b9a\u548c\u5b8c\u6210\u4e3b\u984c\u5275\u5efa\uff0c\u6240\u4ee5\u9019\u662f\u4e00\u500b\u5b8c\u7f8e\u7684\u4f4d\u7f6e\u4f86\u6dfb\u52a0\u6211\u5011\u9700\u8981\u7684\u7a0b\u5f0f\u78bc\u3002 \u9019\u4e00\u5207\u90fd\u8981\u5f9e\u53e6\u4e00\u500b Class extension \u958b\u59cb\uff0c\u6240\u4ee5\u9032\u5165 \"\u65b0\u589e Class extension\" \u9801\u9762\u3002 \u9019\u4e00\u6b21\uff0c\u57fa\u985e\u6703\u662f XF\\Service\\Thread\\Creator \uff0c\u7e7c\u627f\u985e\u5247\u662f Demo\\Portal\\XF\\Service\\Thread\\Creator \uff0c\u548c\u5f80\u5e38\u4e00\u6a23\uff0c\u9019\u500b\u65b0 class \u5c07\u770b\u8d77\u4f86\u50cf\u4e0b\u9762\u7684\u7a0b\u5f0f\u78bc\u3002 \u5728\u8def\u5f91 src/addons/Demo/Portal/XF/Service/Thread/Creator.php \u4e2d\u5efa\u7acb\u8a72\u7a0b\u5f0f\u78bc\uff0c\u7136\u5f8c\u9ede\u9078 \"\u5132\u5b58\" \u4f86\u5efa\u7acb\u7e7c\u627f\u985e\u3002 <?php namespace Demo\\Portal\\XF\\Service\\Thread; class Creator extends XFCP_Creator { } \u5728\u9019\u88e1\uff0c\u6211\u5011\u9084\u5c07\u5efa\u7acb\u53e6\u4e00\u500b\u7e7c\u627f\u985e\u3002 \u57fa\u790e\u985e\u662f XF\\Pub\\Controller\\Forum \uff0c\u7e7c\u627f\u985e\u662f Demo\\Portal\\XF\\Pub\\Controller\\Forum \u3002 \u5728\u8def\u5f91 src/addons/Demo/Portal/XF/Pub/Controller/Forum.php \u4e2d\u5efa\u7acb\u4ee5\u4e0b\u7a0b\u5f0f\u78bc\uff0c\u4e26\u9ede\u9078 \"\u5132\u5b58\"\uff1a <?php namespace Demo\\Portal\\XF\\Pub\\Controller; class Forum extends XFCP_Forum { } \u6211\u5011\u6700\u7d42\u5c07\u5728\u88ab\u7e7c\u627f\u7684\u4e3b\u984c\u4f5c\u8005\u7269\u4ef6\u4e2d\u7e7c\u627f _save() \u65b9\u6cd5\uff0c\u9019\u6a23\u6211\u5011\u5c31\u53ef\u4ee5\u5728\u5efa\u7acb\u4e3b\u984c\u5f8c\u5c0d\u5176\u9032\u884c\u7cbe\u9078\u3002 \u70ba\u4e86\u914d\u5408 \"setup and go\" \u7684\u65b9\u91dd\uff0c\u6211\u5011\u5c07\u5efa\u7acb\u4e00\u500b\u65b9\u6cd5\uff0c\u5b83\u53ef\u4ee5\u7528\u4f86\u6307\u793a\u4e3b\u984c\u662f\u5426\u61c9\u8a72\u88ab\u5efa\u7acb\u70ba\u7cbe\u9078\uff0c\u6216\u8005\u4e0d\u61c9\u8a72\u3002 \u70ba\u6b64\uff0c\u6211\u5011\u9700\u8981\u5169\u6a23\u6771\u897f\uff1a\u4e00\u500b\u662f\u7528\u4f86\u5132\u5b58 value \u7684 class \u5c6c\u6027\uff08\u9810\u8a2d\u70ba null \uff09\u548c\u4e00\u500b\u5141\u8a31\u8a2d\u5b9a\u8a72\u5c6c\u6027\u7684 public \u65b9\u6cd5\u3002 protected $featureThread; public function setFeatureThread($featureThread) { $this->featureThread = $featureThread; } \u56de\u5230\u6211\u5011\u65b0\u7e7c\u627f\u7684\u8ad6\u58c7 Controller\uff0c\u6211\u5011\u73fe\u5728\u5c07\u7e7c\u627f\u8a2d\u5b9a creator \u670d\u52d9\u7684\u65b9\u6cd5\uff0c\u5982\u679c\u8ad6\u58c7 Entity \u6709\u5fc5\u8981\u7684\u8a2d\u5b9a\u503c\uff0c\u5247\u9078\u64c7\u52a0\u5165\u7cbe\u9078\u3002 \u8acb\u8a18\u4f4f\uff0c\u5728\u7e7c\u627f\u4e00\u500b\u65b9\u6cd5\u4e4b\u524d\uff0c\u6211\u5011\u9700\u8981\u77e5\u9053\u5b83\u9810\u8a08\u6703\u8fd4\u56de\u4ec0\u9ebc\uff08\u5982\u679c\u6709\u7684\u8a71\uff09\uff0c\u4e26\u78ba\u4fdd\u6211\u5011\u547c\u53eb\u7236\u985e\u65b9\u6cd5\u3002 \u5982\u679c\u7236\u985e\u65b9\u6cd5\u78ba\u5be6\u8fd4\u56de\u4e86\u4e9b\u4ec0\u9ebc\uff0c\u90a3\u9ebc\u6211\u5011\u61c9\u8a72\u5728\u7a0b\u5f0f\u78bc\u5b8c\u6210\u5f8c\u8fd4\u56de\u9019\u500b\u65b9\u6cd5\u3002 \u5728\u9019\u7a2e\u60c5\u6cc1\u4e0b\uff0c setupThreadCreate() \u65b9\u6cd5\u6703\u8fd4\u56de\u8a2d\u5b9a\u597d\u7684 creator \u670d\u52d9\uff0c\u6240\u4ee5\u6211\u5011\u5c07\u6309\u7167\u4ee5\u4e0b\u65b9\u5f0f\u958b\u59cb\uff1a protected function setupThreadCreate(\\XF\\Entity\\Forum $forum) { /** @var \\Demo\\Portal\\XF\\Service\\Thread\\Creator $creator */ $creator = parent::setupThreadCreate($forum); return $creator; } \u6b63\u5982\u9810\u671f\u7684\u90a3\u6a23\uff0c\u9019\u5be6\u969b\u4e0a\u4e26\u6c92\u6709\u505a\u4efb\u4f55\u4e8b\u60c5\uff1b\u7e7c\u627f\u7684\u7a0b\u5f0f\u78bc\u88ab\u547c\u53eb\u4e86\uff0c\u4f46\u5b83\u6240\u505a\u7684\u53ea\u662f\u8fd4\u56de\u7236\u985e\u547c\u53eb\u6240\u8fd4\u56de\u7684\u5167\u5bb9\u3002 \u73fe\u5728\u6211\u5011\u61c9\u8a72\u4fee\u6539 $creator \u4f86\u8a2d\u5b9a\u7cbe\u9078\uff0c\u5982\u679c\u5b83\u9069\u7528\u65bc\u6211\u5011\u76ee\u524d\u6b63\u5728\u4f7f\u7528\u7684\u8ad6\u58c7\u3002 \u5728 $creator \u884c\u548c return \u884c\u4e4b\u9593\u52a0\u4e0a\uff1a if ($forum->demo_portal_auto_feature) { $creator->setFeatureThread(true); } \u73fe\u5728\u6211\u5011\u53ef\u4ee5\u5728\u7e7c\u627f\u7684 creator \u985e\u4e2d\u65b0\u589e _save() \u65b9\u6cd5\uff1a protected function _save() { $thread = parent::_save(); return $thread; } \u70ba\u4e86\u78ba\u4fdd\u9019\u689d\u4e3b\u984c\u88ab\u7cbe\u9078\uff0c\u5728 $thread \u884c\u548c return \u884c\u4e4b\u9593\uff0c\u6211\u5011\u53ea\u9700\u8981\u65b0\u589e\uff1a if ($this->featureThread && $thread->discussion_state == 'visible') { /** @var \\Demo\\Portal\\Entity\\FeaturedThread $featuredThread */ $featuredThread = $thread->getRelationOrDefault('FeaturedThread'); $featuredThread->save(); $thread->fastUpdate('demo_portal_featured', true); } \u56e0\u70ba\u6211\u5011\u4e4b\u524d\u5728\u4e3b\u984c Entity \u4e0a\u5efa\u7acb\u4e86 FeaturedThread \u95dc\u806f\uff0c\u6240\u4ee5\u5be6\u969b\u4e0a\u6211\u5011\u4e5f\u53ef\u4ee5\u4f7f\u7528\u9019\u500b\u95dc\u806f\u4f86\u5efa\u7acb\uff01 \u6211\u5011\u5728\u9019\u88e1\u4f7f\u7528\u4e86\u4e00\u500b\u540d\u70ba getRelationOrDefault() \u7684\u65b9\u6cd5\u3002 \u5b83\u5c07\u67e5\u770b\u8a72\u95dc\u806f\u662f\u5426\u5be6\u969b\u8fd4\u56de\u4e00\u500b\u73fe\u6709\u7684\u8a18\u9304\uff0c\u5982\u679c\u6c92\u6709\uff0c\u5b83\u5c07\u5efa\u7acb\u8a72 Entity \u4e26\u4f7f\u7528\u4efb\u4f55\u9810\u8a2d\u503c\uff08\u5305\u62ec\u4e3b\u984cID\uff09\u5c0d\u5176\u9032\u884c\u8a2d\u7f6e\uff01 \u9019\u610f\u5473\u8457\u6211\u5011\u5be6\u969b\u4e0a\u9700\u8981\u505a\u7684\u53ea\u662f\u7372\u53d6\u9810\u8a2d\u7684\u95dc\u806f\uff0c\u4e26\u5c07\u5176\u5132\u5b58\u4e0b\u4f86\u63d2\u5165\u5230\u8cc7\u6599\u5eab\u4e2d\u3002 \u6b64\u5916\uff0c\u6211\u5011\u61c9\u8a72\u5c07 demo_portal_featured \u6b04\u4f4d\u8a2d\u5b9a\u70ba true\u3002 \u56e0\u70ba\u4e3b\u984c Entity \u5df2\u7d93\u88ab\u5132\u5b58\u4e86\uff08\u7576\u539f class \u5132\u5b58 Entity \u6642\uff09\uff0c\u6211\u5011\u53ef\u4ee5\u4f7f\u7528 fastUpdate() \u65b9\u6cd5\u4f86\u5feb\u901f\u4fee\u6539\u8a72\u6b04\u4f4d\u3002 \u6211\u5011\u73fe\u5728\u9700\u8981\u5617\u8a66\u9019\u4e00\u5207\uff0c\u4e26\u78ba\u4fdd\u5b83\u80fd\u6b63\u5e38\u904b\u4f5c\u3002 \u524d\u5f80\u60a8\u4e4b\u524d\u555f\u7528\u4e86 demo_portal_auto_feature \u9078\u9805\u7684\u8ad6\u58c7\uff0c\u4e26\u5efa\u7acb\u4e00\u500b\u65b0\u7684\u4e3b\u984c\u3002 \u73fe\u5728\u552f\u4e00\u7684\u65b9\u6cd5\u5c31\u662f\u6aa2\u67e5 xf_demo_portal_featured_thread \u8cc7\u6599\u8868\uff0c\u5728\u90a3\u88e1\u6211\u5011\u61c9\u8a72\u53ef\u4ee5\u770b\u5230\u4e00\u689d\u65b0\u7684\u8a18\u9304\u3002","title":"\u8a2d\u7f6e\u4e3b\u984c\u81ea\u52d5\u986f\u793a"},{"location":"lets-build-an-add-on/#portal","text":"\u5728\u6211\u5011\u5b8c\u6210\u4e4b\u524d\uff0c\u9084\u6709\u76f8\u7576\u591a\u7684\u5de5\u4f5c\u8981\u505a\uff0c\u4f46\u73fe\u5728\u6211\u5011\u5df2\u7d93\u6709\u4e86\u7cbe\u9078\u4e3b\u984c\u7684\u80fd\u529b\uff0c\u5982\u679c\u6211\u5011\u80fd\u5728\u67d0\u500b\u5730\u65b9\u986f\u793a\u5b83\u5011\uff0c\u7576\u7136\u6703\u5f88\u597d\uff0c\u6240\u4ee5\u8b93\u6211\u5011\u958b\u59cb\u5efa\u7acb\u6211\u5011\u7684\u5165\u53e3\u9801\u9762\u3002 \u8981\u505a\u5230\u9019\u4e00\u9ede\uff0c\u6211\u5011\u9700\u8981\u65b0\u5efa\u4e00\u689d Public \u8def\u7531\u3002 \u9032\u5165 Admin CP\uff0c\u5728 \"\u958b\u767c\" \u4e0b\u9ede\u9078 \"\u8def\u7531\"\uff0c\u7136\u5f8c\u9ede\u9078 \"\u6dfb\u52a0\u8def\u7531\uff1a Public\"\u3002 \u6211\u5011\u66ab\u6642\u5148\u628a\u4e8b\u60c5\u7c21\u55ae\u5316\u3002 \u8def\u7531\u7684\u524d\u7db4\u662f \"portal\"\uff0cSection context \u662f \"home\"\uff0cController \u662f \"Demo\\Portal:Portal\"\u3002 \u73fe\u5728\u6211\u5011\u61c9\u8a72\u5728\u8def\u5f91 src/addons/Demo/Portal/Pub/Controller/Portal.php \u4e2d\u5efa\u7acb Controller\uff0c\u57fa\u672c\u5167\u5bb9\u5982\u4e0b\uff1a <?php namespace Demo\\Portal\\Pub\\Controller; class Portal extends \\XF\\Pub\\Controller\\AbstractController { } \u6211\u5011\u5e0c\u671b\u7576\u4eba\u5011\u8a2a\u554f index.php?portal \u9801\u9762\u6642\uff0c\u6211\u5011\u7684 portal \u9801\u9762\u6703\u986f\u793a\u5728\u4ed6\u5011\u9762\u524d\u3002 \u9019\u500b URL \u6c92\u6709 \"action\" \u90e8\u5206 - \u53ea\u6709\u6211\u5011\u525b\u525b\u5efa\u7acb\u7684\u8def\u7531\u524d\u7db4\u3002 \u8003\u616e\u5230\u9019\u4e00\u9ede\uff0c\u6211\u5011\u9700\u8981\u5728 actionIndex() \u65b9\u6cd5\u4e2d\u65b0\u589e\u986f\u793a portal \u9801\u9762\u7684\u7a0b\u5f0f\u78bc\u3002 \u6211\u5011\u5728\u5176\u4e2d\u9700\u8981\u7684\u57fa\u672c\u7a0b\u5f0f\u78bc\u662f\uff1a public function actionIndex() { $viewParams = []; return $this->view('Demo\\Portal:View', 'demo_portal_view', $viewParams); } \u73fe\u5728\uff0c\u9019\u9084\u4e0d\u80fd\u5b8c\u5168\u6b63\u5e38\u904b\u4f5c\uff0c\u56e0\u70ba\u6211\u5011\u9084\u6c92\u6709\u5efa\u7acb\u6a21\u677f\uff0c\u4f46\u9019\u5df2\u7d93\u8db3\u5920\u4e86\uff0c\u81f3\u5c11\u8b49\u660e\u4e86\u6211\u5011\u7684 Route \u548c Controller \u662f\u76f8\u4e92\u6e9d\u901a\u7684\u3002 \u6240\u4ee5\u8a2a\u554f index.php?portal \u81f3\u5c11\u61c9\u8a72\u986f\u793a '\u6a21\u677f\u932f\u8aa4'\u3002 \u6b63\u5982\u5728 View \u56de\u61c9 \u4e00\u7bc0\u4e2d\u63d0\u5230\u7684\uff0c\u7b2c\u4e00\u500b\u53c3\u6578\u662f\u4e00\u500b View class\uff0c\u4f46\u6211\u5011\u4e26\u4e0d\u9700\u8981\u5be6\u969b\u5efa\u7acb\u9019\u500b\u985e\u3002 \u5982\u679c\u6709\u5fc5\u8981\uff0c\u9019\u500b class \u53ef\u4ee5\u7531\u5176\u4ed6\u9644\u52a0\u5143\u4ef6\u7e7c\u627f\uff0c\u5373\u4f7f\u5b83\u4e0d\u5b58\u5728\u3002 \u7b2c\u4e8c\u500b\u53c3\u6578\u662f\u6a21\u677f\uff0c\u6211\u5011\u73fe\u5728\u9700\u8981\u5728\u8def\u5f91 src/addons/Demo/Portal/_output/templates/public/demo_portal_view.html \u4e2d\u5efa\u7acb\u9019\u500b\u6a21\u677f\u3002 \u76ee\u524d\uff0c\u9019\u500b\u6a21\u677f\u61c9\u8a72\u7c21\u55ae\u5730\u5305\u542b\u4ee5\u4e0b\u5167\u5bb9\u3002 <xf:title>Portal</xf:title> \u5982\u679c\u6211\u5011\u73fe\u5728\u8a2a\u554f portal \u9801\u9762\uff0c\u6a21\u677f\u932f\u8aa4\u5c31\u6703\u6d88\u5931\uff0c\u96d6\u7136\u6211\u5011\u4ecd\u7136\u6703\u6709\u4e00\u500b\u770b\u8d77\u4f86\u76f8\u7576\u7a7a\u767d\u7684\u9801\u9762\uff0c\u4f46\u81f3\u5c11\u73fe\u5728\u6703\u6709 \"Portal\" \u6a19\u984c\u3002 \u73fe\u5728\uff0c\u662f\u6642\u5019\u958b\u59cb\u65b0\u589e\u7a0b\u5f0f\u78bc\u4e86\uff0c\u5b83\u5c07\u986f\u793a\u7cbe\u9078\u4e3b\u984c\u7684\u5217\u8868\u3002 \u7b2c\u4e00\u6b65\u662f\u70ba\u6211\u5011\u5e38\u898b\u7684\u4e00\u4e9b\u57fa\u790e Finder \u67e5\u8a62\u5efa\u7acb\u4e00\u500b repository\u3002 \u56e0\u6b64\uff0c\u5728\u8def\u5f91 src/addons/Demo/Portal/Repository/FeaturedThread.php \u4e2d\u5efa\u7acb\u4e00\u500b\u65b0\u6a94\u6848\uff0c\u4e26\u65b0\u589e\u4ee5\u4e0b\u7a0b\u5f0f\u78bc\u3002 <?php namespace Demo\\Portal\\Repository; use XF\\Mvc\\Entity\\Finder; use XF\\Mvc\\Entity\\Repository; class FeaturedThread extends Repository { /** * @return Finder */ public function findFeaturedThreadsForPortalView() { $visitor = \\XF::visitor(); $finder = $this->finder('Demo\\Portal:FeaturedThread'); $finder ->setDefaultOrder('featured_date', 'DESC') ->with('Thread', true) ->with('Thread.User') ->with('Thread.Forum', true) ->with('Thread.Forum.Node.Permissions|' . $visitor->permission_combination_id) ->with('Thread.FirstPost', true) ->with('Thread.FirstPost.User') ->where('Thread.discussion_type', '<>', 'redirect') ->where('Thread.discussion_state', 'visible'); return $finder; } } \u6211\u5011\u5728\u9019\u88e1\u505a\u7684\u662f\u4f7f\u7528 finder \u67e5\u8a62\u6240\u6709\u7684\u7cbe\u9078\u4e3b\u984c\uff0c\u6309\u7167\u76f8\u53cd\u7684 featured_date \u9806\u5e8f\uff0cjoin \u5230 xf_thread \u8cc7\u6599\u8868\uff0c\u4e26\u5f9e\u8a72\u8cc7\u6599\u8868 join \u5230\u4e3b\u984c\u5275\u5efa\u8005\u7684 xf_user \u8cc7\u6599\u8868\u3001 xf_forum \u8cc7\u6599\u8868\u3001 xf_post \u8cc7\u6599\u8868\uff0c\u7136\u5f8c\u518d\u5f9e\u90a3\u88e1 join \u5230 xf_user \u8cc7\u6599\u8868\uff0c\u91cd\u65b0\u5275\u5efa\u5e16\u5b50\u8cc7\u6599\u8868\u3002 \u6211\u5011\u901a\u904e\u6307\u5b9a\u53c3\u6578 true \u4f86\u78ba\u5b9a\u4e3b\u984c\u3001\u8ad6\u58c7\u548c\u7b2c\u4e00\u500b\u5e16\u5b50\u5fc5\u9808\u5b58\u5728\uff0c\u6240\u4ee5\u9019\u4e9b\u5c07\u4ee5 INNER JOIN \u7684\u65b9\u5f0f\u57f7\u884c\uff0c\u800c\u7528\u6236\u67e5\u8a62\u5c07\u4ee5 LEFT JOIN \u7684\u65b9\u5f0f\u57f7\u884c\u3002 \u6709\u4e9b\u4e3b\u984c\u548c\u5e16\u5b50\u7684\u4f5c\u8005\u53ef\u80fd\u4e0d\u5b58\u5728\uff08\u4f8b\u5982\uff0c\u5982\u679c\u5b83\u5011\u662f\u7531 RSS feed \u7cfb\u7d71\u81ea\u52d5\u767c\u4f48\u7684\uff0c\u6216\u7531\u8a2a\u5ba2\u767c\u4f48\u7684\uff09\u3002 \u6211\u5011\u5728\u9019\u88e1\u9084\u6709\u4e00\u500b\u7279\u6b8a\u7684 join\uff0c\u53ef\u4ee5\u5728\u67e5\u8a62\u7684\u540c\u6642\u7372\u53d6\u76ee\u524d\u8a2a\u554f\u8005\u7684\u6b0a\u9650\u3002 \u9019\u5c07\u6e1b\u5c11\u6e32\u67d3 portal \u9801\u9762\u6240\u9700\u7684\u67e5\u8a62\u6b21\u6578\uff0c\u56e0\u70ba\u6211\u5011\u5c07\u505a\u4e00\u4e9b\u4e8b\u60c5\uff08\u4e4b\u5f8c\uff09\uff0c\u53ea\u5411\u6709\u6b0a\u9650\u67e5\u770b\u7684\u7528\u6236\u986f\u793a\u7cbe\u9078\u4e3b\u984c\u3002 \u9019\u4e26\u4e0d\u80fd\u8fd4\u56de\u9019\u500b\u67e5\u8a62\u7684\u7d50\u679c\u3002 \u9019\u5c07\u8fd4\u56de Finder \u7269\u4ef6\u672c\u8eab\u3002 \u9019\u6a23\u5c31\u53ef\u4ee5\u5728\u5176\u4ed6\u9644\u52a0\u5143\u4ef6\u9700\u8981\u7e7c\u627f\u6211\u5011\u7684\u7a0b\u5f0f\u78bc\u6642\uff0c\u6709\u4e00\u500b\u660e\u78ba\u7684 extension point\uff0c\u540c\u6642\u4e5f\u5141\u8a31\u6211\u5011\u5728\u7372\u53d6\u8cc7\u6599\u4e4b\u524d\u505a\u9032\u4e00\u6b65\u7684\u4fee\u6539\uff08\u4f8b\u5982\u70ba\u5206\u9801\u8a2d\u5b9a\u4e00\u500b limit/offset\uff0c\u6216\u8005\u8a2d\u5b9a\u4e0d\u540c\u7684\u6392\u5e8f\uff09\u3002 \u73fe\u5728\u8b93\u6211\u5011\u5728 Portal Controller \u7684 actionIndex() \u65b9\u6cd5\u4e2d\u4f7f\u7528\u5b83\u3002 \u5c07\u73fe\u6709\u7684\u9019\u4e00\u884c $viewParams = []; \u6539\u70ba\u5982\u4e0b\uff1a /** @var \\Demo\\Portal\\Repository\\FeaturedThread $repo */ $repo = $this->repository('Demo\\Portal:FeaturedThread'); $finder = $repo->findFeaturedThreadsForPortalView(); $viewParams = [ 'featuredThreads' => $finder->fetch() ]; \u5728\u9019\u500b\u968e\u6bb5\uff0c\u6211\u5011\u4e0d\u6253\u7b97\u64d4\u5fc3\u4fee\u6539\u6211\u5011\u5f9e repo \u4e2d\u6aa2\u7d22\u5230\u7684\u57fa\u790e finder\u3002 \u76f8\u53cd\uff0c\u6211\u5011\u958b\u59cb\u5be6\u969b\u770b\u5230\u4e00\u4e9b\u7d50\u679c\uff0c\u4e26\u66f4\u65b0 demo_portal_view \u6a21\u677f\u5982\u4e0b\uff08\u5728 <xf:title> \u6a19\u7c64\u4e4b\u5f8c\uff09\uff1a <xf:if is=\"$featuredThreads is not empty\"> <xf:foreach loop=\"$featuredThreads\" value=\"$featuredThread\"> <xf:macro name=\"thread_block\" arg-thread=\"{$featuredThread.Thread}\" arg-post=\"{$featuredThread.Thread.FirstPost}\" arg-featuredThread=\"{$featuredThread}\" /> </xf:foreach> <xf:else /> <div class=\"blockMessage\">\u76ee\u524d\u9084\u6c92\u6709\u4efb\u4f55\u5e16\u5b50\u88ab\u7cbe\u9078\u3002</div> </xf:if> <xf:macro name=\"thread_block\" arg-thread=\"!\" arg-post=\"!\" arg-featuredThread=\"!\"> <xf:css src=\"message.less\" /> <div class=\"block\"> <div class=\"block-container\" data-xf-init=\"lightbox\"> <h4 class=\"block-header\"><a href=\"{{ link('threads', $thread) }}\">{$thread.title}</a></h4> <div class=\"block-body\"> <xf:macro name=\"message\" arg-post=\"{$post}\" arg-thread=\"{$thread}\" arg-featuredThread=\"{$featuredThread}\" /> </div> <div class=\"block-footer\"> <a href=\"{{ link('threads', $thread) }}\">\u7e7c\u7e8c\u95b1\u8b80...</a> </div> </div> </div> </xf:macro> <xf:macro name=\"message\" arg-post=\"!\" arg-thread=\"!\" arg-featuredThread=\"!\"> <div class=\"message message--post message--simple\"> <div class=\"message-inner\"> <div class=\"message-cell message-cell--main\"> <div class=\"message-content js-messageContent\"> <div class=\"message-attribution\"> <div class=\"contentRow contentRow--alignMiddle\"> <div class=\"contentRow-figure\"> <xf:avatar user=\"{$post.User}\" size=\"xxs\" defaultname=\"{$post.username}\" href=\"\" /> </div> <div class=\"contentRow-main contentRow-main--close\"> <ul class=\"listInline listInline--bullet u-muted\"> <li><xf:username user=\"{$thread.User}\" /></li> <li><xf:date time=\"{$featuredThread.featured_date}\" /></li> <li><a href=\"{{ link('forums', $thread.Forum) }}\">{$thread.Forum.title}</a></li> <li>{{ phrase('replies:') }} {$thread.reply_count|number}</li> </ul> </div> </div> </div> <div class=\"message-userContent lbContainer js-lbContainer\" data-lb-id=\"post-{$post.post_id}\" data-lb-caption-desc=\"{{ $post.User ? $post.User.username : $post.username }} &middot; {{ date_time($post.post_date) }}\" > <blockquote class=\"message-body\"> {{ bb_code($post.message, 'post', $post.User, { 'attachments': $post.attach_count ? $post.Attachments : [], 'viewAttachments': $thread.canViewAttachments() }) }} </blockquote> </div> </div> </div> </div> </div> </xf:macro> \u73fe\u5728\uff0c\u6211\u627f\u8a8d\uff0c\u9019\u88e1\u6709 \u5f88\u591a \u7684\u5167\u5bb9\u3002 \u96d6\u7136\u5b83\u53ef\u80fd\u770b\u8d77\u4f86\u4ee4\u4eba\u751f\u754f\uff0c\u4f46\u5b83\u4e3b\u8981\u662f\u4ee5\u5408\u7406\u7684\u98a8\u683c\u4f86\u986f\u793a\u6211\u5011\u7684\u7cbe\u9078\u4e3b\u984c\u7684\u6a19\u8a18\u3002 \u4e0d\u904e\u6709\u5e7e\u4ef6\u4e8b\u503c\u5f97\u6ce8\u610f\u3002 \u6211\u5011\u7528\u4e00\u500b\u689d\u4ef6\u958b\u59cb\u6a21\u677f\uff0c\u9019\u500b\u689d\u4ef6\u662f <xf:if is=\"$featuredThreads is not empty\"> \u3002 \u9019\u662f\u70ba\u4e86\u6aa2\u67e5 finder \u8fd4\u56de\u7684\u7269\u4ef6\u662f\u5426\u771f\u7684\u5305\u542b\u7cbe\u9078\u4e3b\u984c\u8a18\u9304\u3002 \u5982\u679c\u4e0d\u5305\u542b\uff0c\u6211\u5011\u5c07\u986f\u793a\u4e00\u500b\u9069\u7576\u7684\u8a0a\u606f\u3002 \u5982\u679c\u78ba\u5be6\u6709\u4e00\u4e9b\u8a18\u9304\uff0c\u6211\u5011\u9700\u8981\u5faa\u74b0\u700f\u89bd\u6bcf\u4e00\u689d\u8a18\u9304\u4f86\u986f\u793a\u5b83\u3002 \u5c0d\u65bc\u6bcf\u689d\u8a18\u9304\uff0c\u6211\u5011\u547c\u53eb\u4e00\u500b macro \u3002 \u5de8\u96c6\u662f\u6a21\u677f\u7a0b\u5f0f\u78bc\u4e2d\u53ef\u91cd\u8907\u4f7f\u7528\u7684\u90e8\u5206\uff0c\u5b83\u662f\u81ea\u884c\u8a18\u9304\u7684\uff08\u4f60\u53ef\u4ee5\u770b\u5230\u54ea\u4e9b\u53c3\u6578\u662f\u652f\u63f4\u7684\uff09\uff0c\u4e26\u4fdd\u6301\u81ea\u5df1\u7684\u4f5c\u7528\u57df\uff0c\u4e0d\u80fd\u88ab\u547c\u53eb\u5de8\u96c6\u6a21\u677f\u4e2d\u7684\u53c3\u6578\u6240\u6c61\u67d3\uff1b\u9019\u610f\u5473\u8457\u5de8\u96c6\u53ea\u77e5\u9053\u660e\u78ba\u50b3\u905e\u9032\u4f86\u7684\u53c3\u6578\u548c\u5168\u57df\u7684 $xf \u53c3\u6578\u3002 \u4e3b\u984c\u5340\u584a\u5de8\u96c6\u986f\u793a\u7cbe\u9078\u4e3b\u984c\u7684\u57fa\u672c\u5340\u584a\uff0c\u7136\u5f8c\u547c\u53eb\u53e6\u4e00\u500b\u5de8\u96c6\u4f86\u986f\u793a\u6bcf\u500b\u8a0a\u606f\u3002","title":"\u5efa\u7acb Portal \u9801\u9762"},{"location":"lets-build-an-add-on/#_9","text":"\u4f60\u53ef\u80fd\u5df2\u7d93\u767c\u73fe\uff0c\u5728\u8a2d\u5b9a\u8def\u5f91\u6642\uff0c\u6211\u5011\u5c07 Section context \u6307\u5b9a\u70ba \"\u4e3b\u9801\"\uff0c\u7576\u4f60\u8a2a\u554f portal \u9801\u9762\u6642\uff0c\u4e3b\u9801\u6a19\u7c64\u88ab\u9078\u4e2d\uff0c\u6216\u8005\u5982\u679c\u5728\u9078\u9805\u4e2d\u6c92\u6709\u8a2d\u5b9a homePageUrl \uff0c\u4f60\u53ef\u80fd\u6839\u672c\u4e0d\u6703\u770b\u5230\u4e3b\u9801\u6a19\u7c64\u3002 \u6211\u5011\u5e0c\u671b\u4f7f\u7528\u9810\u8a2d\u7684\u4e3b\u9801\u6a19\u7c64\uff0c\u800c\u4e0d\u662f\u81ea\u5df1\u5efa\u7acb\u4e00\u500b\u6a19\u7c64\uff0c\u9019\u6a23\u53ef\u80fd\u6703\u6709\u4e00\u500b\u91cd\u8907\u7684\u6a19\u7c64\u3002 \u8981\u505a\u5230\u9019\u4e00\u9ede\uff0c\u6211\u5011\u61c9\u8a72\u4f7f\u7528\u7a0b\u5f0f\u78bc\u4e8b\u4ef6\u76e3\u807d\u5668\u5c07 URL \u6539\u70ba\u6211\u5011\u7684 portal URL\u3002 \u5728 Admin CP \u4e0b\u7684\u958b\u767c\u4e2d\u9ede\u9078 \"\u7a0b\u5f0f\u78bc\u4e8b\u4ef6\u76e3\u807d\u5668\"\uff0c\u7136\u5f8c\u9ede\u9078 \"\u65b0\u589e\u7a0b\u5f0f\u78bc\u4e8b\u4ef6\u76e3\u807d\u5668\"\u3002 \u76e3\u807d\u4e8b\u4ef6 home_page_url \uff0ccallback class \u53c8\u6703\u662f Demo\\Portal\\Listener \uff0c\u9019\u6b21\u7684\u65b9\u6cd5\u547d\u540d\u70ba homePageUrl \u3002 \u9019\u500b\u65b0\u65b9\u6cd5\u7684\u7a0b\u5f0f\u78bc\u61c9\u8a72\u76f8\u7576\u7c21\u55ae\uff1a public static function homePageUrl(&$homePageUrl, \\XF\\Mvc\\Router $router) { $homePageUrl = $router->buildLink('canonical:portal'); } \u6700\u5f8c\uff0c\u6211\u5011\u61c9\u8a72\u8003\u616e\u66f4\u6539\u6211\u5011 portal \u9801\u9762\u7684\u9996\u9801\u8def\u5f91\u3002 \u9032\u5165 Admin CP\uff0c\u5728\u8a2d\u5b9a\u4e0b\u9ede\u9078\u9078\u9805\uff0c\u7136\u5f8c\u9ede\u9078 \"\u57fa\u672c\u677f\u584a\u8cc7\u8a0a\"\u3002 \u5c07 \"\u9996\u9801\u8def\u5f91\" \u9078\u9805\u6539\u70ba portal/ \u3002 \u7576\u4f60\u5728 Admin CP \u4e2d\u6642\uff0c\u4f86\u770b\u770b\u7576\u4f60\u9ede\u9078 Header \u7684\u677f\u584a\u6a19\u984c\u6642\uff0c\u6703\u767c\u751f\u4ec0\u9ebc\u3002 \u9019\u61c9\u8a72\u6703\u5e36\u4f60\u5230\u4f60\u7684\u9996\u9801\u3002 \u4e00\u5207\u6b63\u5e38\uff0c\u90a3\u500b\u9996\u9801\u73fe\u5728\u61c9\u8a72\u662f\u4f60\u7684 portal \u9801\u9762\u4e86\uff01 \u9664\u6b64\u4e4b\u5916\uff0c\u4e3b\u9801\u6a19\u7c64\u61c9\u8a72\u662f\u53ef\u898b\u7684\uff0c\u4e26\u4e14\u88ab\u9078\u4e2d\u4e86\u3002 \u4f5c\u70ba\u53ef\u9078\u6b65\u9a5f\uff0c\u4f60\u53ef\u4ee5\u9078\u64c7\u5728\u4e3b\u9801\u6a19\u7c64\u4e0b\u65b0\u589e\u4e00\u4e9b\u984d\u5916\u7684\u5c0e\u89bd\u689d\u76ee\u3002 \u4e0d\u904e\uff0c\u73fe\u5728\u8b93\u6211\u5011\u5148\u7e7c\u7e8c\u5f80\u4e0b\u3002","title":"\u5be6\u4f5c\u5c0e\u89bd\u6a19\u7c64"},{"location":"lets-build-an-add-on/#_10","text":"\u6240\u4ee5\uff0c\u6211\u5011\u53ef\u4ee5\u81ea\u52d5\u7cbe\u9078\u65b0\u4e3b\u984c\u3002 \u90a3\u9ebc\u624b\u52d5\u986f\u793a\u73fe\u6709\u7684\u4e3b\u984c\u5462\uff1f \u6216\u8005\u662f\u5728\u5efa\u7acb\u904e\u7a0b\u4e2d\uff0c\u5728\u4e0d\u652f\u63f4\u81ea\u52d5\u7cbe\u9078\u7684\u60c5\u6cc1\u4e0b\uff0c\u624b\u52d5\u7cbe\u9078\u4e3b\u984c\uff1f \u9019\u5c07\u662f\u4e00\u500b\u5f88\u597d\u7684\u65b9\u6cd5\uff0c\u8b93\u6211\u5011\u76ee\u524d\u7684 portal \u9801\u9762\u770b\u8d77\u4f86\u66f4\u5fd9\u788c\u3002 \u70ba\u4e86\u9054\u5230\u9019\u500b\u76ee\u7684\uff0c\u6211\u5011\u5c07\u5728\u4e00\u500b\u7279\u5b9a\u7684\u5de8\u96c6\u4e2d\u65b0\u589e\u4e00\u500b\u6a21\u677f\u4fee\u6539\uff0c\u9019\u500b\u5de8\u96c6\u5be6\u969b\u4e0a\u662f\u5728\u4e3b\u984c\u56de\u8986\u3001\u4e3b\u984c\u7de8\u8f2f\u548c\u5efa\u7acb\u4e3b\u984c\u6642\u4f7f\u7528\u7684\u3002 \u9019\u5c07\u727d\u6d89\u5230\u7e7c\u627f\u7de8\u8f2f\u5668\u670d\u52d9\uff0c\u4e26\u5c0d\u8655\u7406\u81ea\u52d5\u7cbe\u9078\u7684\u73fe\u6709\u7a0b\u5f0f\u78bc\u9032\u884c\u4fee\u6539\u3002 \u7b2c\u4e00\u6b65\u5c31\u662f\u65b0\u5efa\u6a21\u677f\u4fee\u6539\u3002 \u9032\u5230 \"\u65b0\u589e\u6a21\u677f\u4fee\u6539\"\uff08\u78ba\u4fdd\u5728 \"\u6a21\u677f\u4fee\u6539\" \u5217\u8868\u4e2d\u9078\u64c7 \"Public\" \u6a19\u7c64\uff09\u3002 \u9019\u6b21\u6211\u5011\u8981\u4fee\u6539\u7684\u6a21\u677f\u662f helper_thread_options \uff0c\u6211\u5011\u7528 demo_portal_helper_thread_options \u4f5c\u70ba key\uff0c\u4f60\u53ef\u4ee5\u5beb\u4e00\u500b\u5408\u7406\u7684\u63cf\u8ff0\u3002 \u5be6\u969b\u4e0a\uff0c\u6211\u5011\u53ef\u4ee5\u5728\u9019\u88e1\u505a\u4e00\u500b \"\u7c21\u55ae\u66ff\u63db\"\uff0c\u6240\u4ee5\u8acb\u9078\u4e2d\u9019\u500b\u55ae\u9078\u6309\u9215\uff0c\u4e26\u5728 \"\u67e5\u8a62\" \u6b04\u4f4d\u4e2d\u586b\u4e0a\uff1a <xf:if is=\"$thread.canLockUnlock()\"> \u5728 \"\u66ff\u63db\" \u6b04\u4f4d\u4e2d\u586b\u4e0a\uff1a <xf:if is=\"($thread.isInsert() AND !$thread.Forum.demo_portal_auto_feature AND $thread.canFeatureUnfeature()) OR ($thread.isUpdate() && $thread.canFeatureUnfeature())\" > <xf:option label=\"{{ phrase('demo_portal_featured') }}\" name=\"featured\" value=\"1\" selected=\"{$thread.demo_portal_featured}\"> <xf:hint>{{ phrase('demo_portal_featured_hint') }}</xf:hint> <xf:afterhtml> <xf:hiddenval name=\"_xfSet[featured]\" value=\"1\" /> </xf:afterhtml> </xf:option> </xf:if> $0 \u9019\u500b\u689d\u4ef6\u5224\u65b7\u6709\u9ede\u504f\u9577\u4e86\uff0c\u4f46\u5b83\u5141\u8a31\u6211\u5011\u5728\u5169\u500b\u7279\u5b9a\u7684\u689d\u4ef6\u4e0b\u986f\u793a\u7cbe\u9078 checkbox\uff1a a)\u5982\u679c\u5e16\u5b50\u9084\u6c92\u6709\u5efa\u7acb\uff0c\u4e26\u4e14\u8ad6\u58c7\u7684\u81ea\u52d5\u7cbe\u9078\u9078\u9805\u88ab\u95dc\u9589\uff0c\u4e26\u4e14\u6709\u7cbe\u9078\u7684\u6b0a\u9650\uff0c\u6216\u8005 b)\u5b83\u662f\u4e00\u500b\u5df2\u7d93\u5b58\u5728\u7684\u5e16\u5b50\uff0c\u4e26\u4e14\u6709 \u7cbe\u9078/\u975e\u7cbe\u9078 \u7684\u6b0a\u9650\u3002 \u4e00\u500b\u5feb\u901f\u7684 \"\u6e2c\u8a66\" \u61c9\u8a72\u6703\u986f\u793a\u9019\u500b\u9644\u52a0\u7684\u7a0b\u5f0f\u78bc\u5c07\u88ab\u63d2\u5165\u5230\u73fe\u6709\u7684 <xf:checkboxrow> \u4e2d \"\u6253\u958b\" checkbox \u4e0a\u65b9\u3002 \u5982\u679c\u9019\u4e00\u5207\u770b\u8d77\u4f86\u90fd\u6b63\u5e38\uff0c\u5c31\u9ede\u9078 \"\u5132\u5b58\"\u3002 \u6211\u5011\u4e0d\u5f97\u4e0d\u5728\u9019\u88e1\u76f4\u63a5\u5728\u4fee\u6539\u4e2d\u4f7f\u7528\u6a21\u677f\u7a0b\u5f0f\u78bc\uff0c\u56e0\u70ba\u5728\u5df2\u7d93\u5b58\u5728\u7684 input \u6216 row \u6a19\u7c64\u4e2d\u52a0\u5165\u4e00\u500b\u6a21\u677f\uff08\u50cf\u6211\u5011\u4e4b\u524d\u505a\u7684\u90a3\u6a23\uff09\u9019\u6a23\u662f\u6703\u7121\u6cd5\u904b\u4f5c\u7684\u3002 \u6211\u5011\u73fe\u5728\u9084\u9700\u8981\u70ba\u6a19\u7c64\u548c\u63d0\u793a\u5efa\u7acb\u77ed\u8a9e\uff0c\u56e0\u70ba\u4ee5\u5f8c\u5c07\u7121\u6cd5\u6aa2\u6e2c\u5230\u9019\u4e9b\u4e86\u3002 \u5728 \"\u5916\u89c0\" \u4e0b\u9032\u5165 \"\u77ed\u8a9e\" \u4e26\u9ede\u9078 \"\u65b0\u589e\u77ed\u8a9e\"\u3002 \u78ba\u4fdd\u4f60\u7684\u9644\u52a0\u5143\u4ef6\u88ab\u9078\u4e2d\u3002 \u7b2c\u4e00\u500b\u77ed\u8a9e\u7684 \"Title\" \u5c07\u662f \"demo_portal_featured\"\uff0c\u6587\u5b57\u5c07\u662f\u7c21\u55ae\u7684 \"\u7cbe\u9078\"\u3002 \u9ede\u9078 \"\u5132\u5b58\u4e26\u9000\u51fa\"\u3002 \u518d\u6b21\u9ede\u9078 \"\u65b0\u589e\u77ed\u8a9e\"\u3002 \u7b2c\u4e8c\u500b\u77ed\u8a9e\u7684 \"\u6a19\u984c\" \u6703\u662f \"demo_portal_featured_hint\"\uff0c\u6587\u5b57\u6703\u662f \"\u7cbe\u9078\u4e3b\u984c\u5c07\u51fa\u73fe\u5728 Portal \u9801\u9762\"\u3002 \u56de\u5230\u6211\u5011\u525b\u525b\u65b0\u589e\u4fee\u6539\u7684\u6a21\u677f\u7a0b\u5f0f\u78bc\uff0c\u4f60\u53ef\u80fd\u5df2\u7d93\u6ce8\u610f\u5230\u4e86\u4e00\u4e9b\u4e8b\u60c5\u3002 \u6211\u5011\u5728\u4e3b\u984c Entity \u4e0a\u547c\u53eb\u4e86\u4e00\u500b\u65b9\u6cd5\uff0c canFeatureUnfeature() \uff0c\u800c\u9019\u500b\u65b9\u6cd5\u9084\u4e0d\u5b58\u5728\u3002 \u6211\u5011\u6700\u7d42\u8981\u7528\u9019\u500b\u4f86\u505a\u4e00\u500b\u6b0a\u9650\u6aa2\u67e5\uff0c\u63a7\u5236\u7528\u6236\u662f\u5426\u53ef\u4ee5\u624b\u52d5\u5c0d\u4e00\u500b\u4e3b\u984c\u9032\u884c\u7cbe\u9078\u64cd\u4f5c\u3002 \u70ba\u4e86\u65b0\u589e\u9019\u500b\u65b9\u6cd5\uff0c\u6211\u5011\u9700\u8981\u70ba XF\\Entity\\Thread Entity \u65b0\u5efa\u4e00\u500b Class extension\u3002 \u6240\u4ee5\uff0c\u73fe\u5728\u5c31\u50cf\u6211\u5011\u4e4b\u524d\u505a\u7684\u90a3\u6a23\u505a\u3002 \u7e7c\u627f class \u5c07\u662f Demo\\Portal\\XF\\Entity\\Thread \uff0c\u6240\u4ee5\u5728\u8def\u5f91 src/addons/Demo/Portal/XF/Entity/Thread.php \u4e2d\u5efa\u7acb\u9019\u500b class\uff0c\u5167\u5bb9\u5982\u4e0b\uff1a <?php namespace Demo\\Portal\\XF\\Entity; class Thread extends XFCP_Thread { public function canFeatureUnfeature() { return true; } } \u597d\u5427\uff0c\u6240\u4ee5\uff0c\u6211\u5011\u4e26\u6c92\u6709\u5728\u9019\u88e1\u505a\u592a\u591a\u6709\u50f9\u503c\u7684\u4e8b\u60c5\u3002 canFeatureUnfeature() \u65b9\u6cd5\u73fe\u5728\u6240\u505a\u7684\u5c31\u662f\u8fd4\u56de true \u3002 \u4ee5\u5f8c\uff0c\u6211\u5011\u6703\u5be6\u4f5c\u4e00\u4e9b\u9069\u7576\u7684\u6b0a\u9650\uff0c\u4e26\u5728\u9019\u88e1\u65b0\u589e\u3002 \u6e2c\u8a66\u4e00\u4e0b\u76ee\u524d\u7684\u6548\u679c\uff0c\u6253\u958b\u4f60\u4e4b\u524d\u7cbe\u9078\u7684\u4e00\u500b\u4e3b\u984c\uff0c\u5728\u5de5\u5177\u9078\u55ae\u4e2d\u9078\u64c7 \"\u7de8\u8f2f\u4e3b\u984c\"\u3002 \u6211\u5011\u61c9\u8a72\u770b\u5230 \"\u8a2d\u5b9a\u4e3b\u984c\u72c0\u614b\" checkbox row \u6709\u6211\u5011\u65b0\u589e\u7684 \"\u7cbe\u9078\" checkbox\uff0c\u800c\u4e14\u61c9\u8a72\u662f\u52fe\u9078\u7684\uff0c\u8aaa\u660e\u9019\u500b\u4e3b\u984c\u78ba\u5be6\u662f\u5177\u6709\u7cbe\u9078\u7684\u3002 \u6211\u5011\u73fe\u5728\u53ef\u4ee5\u7e7c\u7e8c\u6539\u8b8a\u4e3b\u984c\u7de8\u8f2f\u5668\u670d\u52d9\u4f86\u5c0b\u627e\u9019\u500b\u503c\uff0c\u4e26\u76f8\u61c9\u5730\u9032\u884c\u7cbe\u9078\u6216\u53d6\u6d88\u7cbe\u9078\u3002 \u70ba\u6b64\u6211\u5011\u9700\u8981\u5169\u500b\u65b0\u7684 Class extensions\u3002 \u56de\u5230 \"Class extensions\" \u9801\u9762\u3002 \u7b2c\u4e00\u500b\u5c07\u6709\u4e00\u500b\u57fa\u985e XF\\Pub\\Controller\\Thread \u548c\u7e7c\u627f\u985e Demo\\Portal\\XF\\Pub\\Controller\\Thread \u3002 \u7b2c\u4e8c\u500b\u5c07\u6709\u4e00\u500b XF\\Service\\Thread\\Editor \u7684\u57fa\u985e\u548c\u4e00\u500b Demo\\Portal\\XF\\Service\\Thread\\Editor \u7684\u7e7c\u627f\u985e\u3002 \u7de8\u8f2f\u5668\u670d\u52d9\u5176\u5be6\u8981\u548c\u6211\u5011\u4e4b\u524d\u5efa\u7acb\u7684\u7e7c\u627f creator \u670d\u52d9\u975e\u5e38\u76f8\u4f3c\uff0c\u6240\u4ee5\u5728\u76f8\u95dc\u4f4d\u7f6e\u5efa\u7acb\u3002 \u4e0b\u9762\u662f\u7e7c\u627f\u985e\u7684\u6240\u6709\u7a0b\u5f0f\u78bc\uff1a <?php namespace Demo\\Portal\\XF\\Service\\Thread; class Editor extends XFCP_Editor { protected $featureThread; public function setFeatureThread($featureThread) { $this->featureThread = $featureThread; } protected function _save() { $thread = parent::_save(); if ($this->featureThread !== null && $thread->discussion_state == 'visible') { /** @var \\Demo\\Portal\\Entity\\FeaturedThread $featuredThread */ $featuredThread = $thread->getRelationOrDefault('FeaturedThread', false); if ($this->featureThread) { if (!$featuredThread->exists()) { $featuredThread->save(); $thread->fastUpdate('demo_portal_featured', true); } } else { if ($featuredThread->exists()) { $featuredThread->delete(); $thread->fastUpdate('demo_portal_featured', false); } } } return $thread; } } \u9019\u6bd4 creator \u670d\u52d9\u4e2d\u7684\u7a0b\u5f0f\u78bc\u8981\u8907\u96dc\u4e00\u4e9b\u3002 \u4f8b\u5982\uff0c\u6709\u53ef\u80fd\u6703\u51fa\u73fe\u9019\u6a23\u7684\u60c5\u6cc1\uff0c\u4e00\u500b\u4e3b\u984c\u88ab\u7de8\u8f2f\u4e86\uff0c\u800c\u7528\u6236\u6c92\u6709\u7de8\u8f2f\u8a72\u4e3b\u984c\u7684\u6b0a\u9650\uff0c\u56e0\u6b64\u6211\u5011\u4e0d\u986f\u793a checkbox\u3002 \u5728\u9019\u4e9b\u60c5\u6cc1\u4e0b\uff0c\u6211\u5011\u4e0d\u5e0c\u671b\u81ea\u52d5\u8a8d\u70ba\u8a72\u4e3b\u984c\u61c9\u8a72\u662f\u7121\u7cbe\u9078\u7684\u3002 \u7531\u65bc\u985e $featureThread \u5c6c\u6027\u7684\u9810\u8a2d\u503c\u662f null \uff0c\u6211\u5011\u53ef\u4ee5\u4f7f\u7528\u9019\u500b\u5c6c\u6027\uff0c\u9019\u6a23\u672c\u8cea\u4e0a\u8a72\u5c6c\u6027\u6709\u4e09\u7a2e\u72c0\u614b\u3002 \u5728\u9019\u7a2e\u60c5\u6cc1\u4e0b\uff0c null \u8868\u793a \"\u6c92\u6709\u8b8a\u5316\"\uff0c true \u8868\u793a\u6211\u5011\u5c0d\u8a72\u4e3b\u984c\u9032\u884c\u4e86\u7cbe\u9078\u8a2d\u5b9a\uff0c false \u8868\u793a\u6211\u5011\u53d6\u6d88\u4e86\u5b83\u7684\u7cbe\u9078\u3002 \u5728\u975e\u7cbe\u9078\u5316\u7684\u60c5\u6cc1\u4e0b\uff0c\u6211\u5011\u5be6\u969b\u4e0a\u53ea\u662f\u901a\u904e\u547c\u53eb delete() \u65b9\u6cd5\u4f86\u522a\u9664\u7cbe\u9078\u4e3b\u984c Entity\u3002 \u5728\u9019\u5169\u7a2e\u60c5\u6cc1\u4e0b\uff0c\u6211\u5011\u518d\u6b21\u4f7f\u7528 fastUpdate() \u65b9\u6cd5\u66f4\u65b0\u4e3b\u984c Entity \u4e2d\u7684\u5feb\u53d6\u503c\uff0c\u4ee5\u8868\u793a\u76ee\u524d\u7684\u7cbe\u9078\u72c0\u614b\u3002 \u5728\u5b8c\u6210\u7de8\u8f2f\u904e\u7a0b\u4e4b\u524d\uff0c\u6211\u5011\u9700\u8981\u70ba\u6211\u5011\u7684\u7e7c\u627f\u4e3b\u984c Controller \u65b0\u589e\u7a0b\u5f0f\u78bc\uff0c\u7279\u5225\u662f\u7e7c\u627f setupThreadEdit() \u65b9\u6cd5\u3002 \u6574\u500b\u7e7c\u627f\u4e3b\u984c Controller \u7684\u7a0b\u5f0f\u78bc\u770b\u8d77\u4f86\u5c07\u6703\u662f\u9019\u6a23\uff1a <?php namespace Demo\\Portal\\XF\\Pub\\Controller; class Thread extends XFCP_Thread { public function setupThreadEdit(\\XF\\Entity\\Thread $thread) { /** @var \\Demo\\Portal\\XF\\Service\\Thread\\Editor $editor */ $editor = parent::setupThreadEdit($thread); $canFeatureUnfeature = $thread->canFeatureUnfeature(); if ($canFeatureUnfeature) { $editor->setFeatureThread($this->filter('featured', 'bool')); } return $editor; } } \u9019\u61c9\u8a72\u8db3\u4ee5\u8b93\u60a8\u7de8\u8f2f\u4e00\u500b\u4e3b\u984c\uff0c\u4e26\u5c07\u5176\u72c0\u614b\u8a2d\u5b9a\u70ba\u7cbe\u9078\uff08\u6216\u975e\u7cbe\u9078\uff09\u3002 \u5982\u679c\u60a8\u73fe\u5728\u5617\u8a66\u4e00\u4e0b\uff0c\u60a8\u61c9\u8a72\u53ef\u4ee5\u770b\u5230\u4e3b\u984c\u76f8\u61c9\u5730\u5f9e\u60a8\u7684 portal \u9801\u9762\u51fa\u73fe\u548c\u6d88\u5931\u3002 \u6211\u5011\u9700\u8981\u5728\u4e3b\u984c Controller \u4e2d\u7e7c\u627f\u53e6\u4e00\u500b\u65b9\u6cd5\uff0c\u4ee5\u8655\u7406\u4e3b\u984c\u72c0\u614b\u63a7\u5236\u4e5f\u986f\u793a\u5728\u4e00\u4e9b\u4e3b\u984c\u56de\u8986\u8868\u55ae\u4e0a\u7684\u60c5\u6cc1\u3002 \u6211\u5011\u53ea\u9700\u8981\u5728\u4e0a\u9762\u65b0\u589e\u7684 setupThreadEdit() \u65b9\u6cd5\u4e0b\u9762\u65b0\u589e\u4ee5\u4e0b\u7a0b\u5f0f\u78bc\u5373\u53ef\uff1a public function finalizeThreadReply(\\XF\\Service\\Thread\\Replier $replier) { parent::finalizeThreadReply($replier); $setOptions = $this->filter('_xfSet', 'array-bool'); if ($setOptions) { $thread = $replier->getThread(); if ($thread->canFeatureUnfeature() && isset($setOptions['featured'])) { $replier->setFeatureThread($this->filter('featured', 'bool')); } } } \u8acb\u6ce8\u610f\uff0c\u6211\u5011\u5728\u9019\u500b\u65b9\u6cd5\u4e2d\u4e26\u6c92\u6709\u5be6\u969b\u8fd4\u56de\u4efb\u4f55\u6771\u897f\uff0c\u56e0\u70ba\u4e26\u4e0d\u671f\u671b\u5b83\u8fd4\u56de\u4efb\u4f55\u6771\u897f\u3002 \u6700\u5f8c\u4e00\u6b65\uff0c\u6211\u5011\u9700\u8981\u56de\u5230\u8ad6\u58c7 Controller\uff0c\u7a0d\u5fae\u4fee\u6539\u4e00\u4e0b\u6211\u5011\u73fe\u6709\u7684\u7a0b\u5f0f\u78bc\uff0c\u9019\u6a23\uff0c\u5982\u679c\u7cbe\u9078\u4e0d\u662f\u81ea\u52d5\u7684\uff0c\u6211\u5011\u53ef\u4ee5\u624b\u52d5\u8655\u7406\u3002 \u9019\u61c9\u8a72\u662f\u76f8\u7576\u76f4\u63a5\u7684\u3002 \u9032\u5165\u60a8\u7684\u7e7c\u627f\u8ad6\u58c7 Controller\uff0c\u7136\u5f8c\u5c07\u66ff\u63db\u9019\u500b\uff1a if ($forum->demo_portal_auto_feature) { $creator->setFeatureThread(true); } \u6539\u6210\u4e0b\u9762\u9019\u6a23\uff1a if ($forum->demo_portal_auto_feature) { $creator->setFeatureThread(true); } else { $setOptions = $this->filter('_xfSet', 'array-bool'); if ($setOptions) { $thread = $creator->getThread(); if ($thread->canFeatureUnfeature() && isset($setOptions['featured'])) { $creator->setFeatureThread($this->filter('featured', 'bool')); } } } \u9019\u548c\u6211\u5011\u5df2\u7d93\u64c1\u6709\u7684\u57fa\u672c\u76f8\u540c\uff0c\u4f8b\u5982\uff0c\u5982\u679c\u8ad6\u58c7\u958b\u555f\u4e86\u81ea\u52d5\u7cbe\u9078\uff0c\u90a3\u9ebc\u6211\u5011\u53ea\u9700\u5c07\u8a72\u4e3b\u984c\u8a2d\u5b9a\u70ba\u7cbe\u9078\uff0c\u5426\u5247\uff0c\u6211\u5011\u6aa2\u67e5\u662f\u5426\u6709 checkbox\uff0c\u5c31\u50cf\u6211\u5011\u5c0d\u5176\u4ed6\u60c5\u6cc1\u6240\u505a\u7684\u90a3\u6a23\uff0c\u5c07\u5176\u8a2d\u5b9a\u70ba checkbox \u72c0\u614b\u3002 \u6211\u5011\u73fe\u5728\u61c9\u8a72\u6e2c\u8a66\u5efa\u7acb 3 \u500b\u4e3b\u984c\uff0c\u4ee5\u78ba\u4fdd\u5176\u904b\u4f5c\u6b63\u5e38\u3002 \u7b2c\u4e00\u500b\u662f\u5728\u958b\u555f\u4e86\u81ea\u52d5\u7cbe\u9078\u7684\u8ad6\u58c7\u4e2d\uff0c\u78ba\u4fdd\u5b83\u4ecd\u7136\u6709\u6548\uff0c\u7136\u5f8c\u662f\u5728\u6c92\u6709\u958b\u555f\u81ea\u52d5\u7cbe\u9078\u7684\u8ad6\u58c7\u4e2d\uff0c\u52fe\u9078 \"\u7cbe\u9078\" checkbox\uff0c\u518d\u52fe\u9078\u5b83\u3002 \u5047\u8a2d\u4e00\u5207\u6b63\u5e38\uff0c\u8b93\u6211\u5011\u7e7c\u7e8c\u524d\u9032\u3002","title":"\u624b\u52d5\u986f\u793a\uff08\u6216\u4e0d\u986f\u793a\uff09\u4e3b\u984c"},{"location":"lets-build-an-add-on/#_11","text":"\u96d6\u7136\uff0cportal \u9801\u9762\u770b\u8d77\u4f86\u5f88\u5408\u7406\uff0c\u4f46\u6211\u5011\u53ef\u4ee5\u505a\u5f97\u66f4\u597d\u4e00\u4e9b\u3002 \u9996\u5148\uff0c\u6211\u5011\u61c9\u8a72\u8abf\u6574\u6211\u5011\u7684\u7a0b\u5f0f\u78bc\uff0c\u4f7f\u6211\u5011\u53ea\u986f\u793a X \u500b\u7279\u8272\u4e3b\u984c\uff0c\u6211\u5011\u9084\u61c9\u8a72\u65b0\u589e\u4e00\u4e9b\u9801\u9762\u5c0e\u89bd\u3002 \u5728\u9019\u4e00\u9ede\u4e0a\uff0c\u5982\u679c\u4f60\u9084\u6c92\u6709\u7684\u8a71\uff0c\u53ef\u80fd\u503c\u5f97\u518d\u591a\u7cbe\u9078\u4e00\u4e9b\u4e3b\u984c\uff0c\u9019\u6a23\u6211\u5011\u5c31\u53ef\u4ee5\u5be6\u969b\u6e2c\u8a66\u5206\u9801\u4e86\uff01 \u9996\u5148\uff0c\u6211\u5011\u9700\u8981\u56de\u5230\u6211\u5011\u7684 portal Controller\uff0c\u4e26\u5728 actionIndex() \u65b9\u6cd5\u7684\u9802\u90e8\u65b0\u589e\u4e00\u4e9b\u7a0b\u5f0f\u78bc\uff1a $page = $this->filterPage(); $perPage = 5; \u9019\u88e1\u7684\u7b2c\u4e00\u884c\u662f\u4e00\u500b\u7279\u5b9a\u7684 helper \u65b9\u6cd5\uff0c\u7528\u4f86\u7372\u53d6\u76ee\u524d\u7684\u9801\u78bc\u3002 \u7b2c\u4e8c\u884c\u662f\u6211\u5011\u6bcf\u9801\u8981\u8f09\u5165\u591a\u5c11\u500b\u9805\u76ee\uff0c\u9019\u901a\u5e38\u4f86\u81ea\u4e00\u500b\u9078\u9805\uff0c\u4f46\u6211\u5011\u73fe\u5728\u5c07\u786c\u5beb\u6b7b\u70ba 5\u3002 \u63a5\u4e0b\u4f86\u8981\u505a\u7684\u5c31\u662f\u628a\u9019\u4e00\u884c\uff1a $finder = $repo->findFeaturedThreadsForPortalView(); \u4fee\u6539\u6210\u9019\u6a23\uff1a $finder = $repo->findFeaturedThreadsForPortalView() ->limitByPage($page, $perPage); \u9019\u5c31\u6539\u8b8a\u4e86\u6211\u5011\u7684\u67e5\u8a62\uff0c\u4f7f\u5b83\u80fd\u6839\u64da\u6211\u5011\u4e0a\u9762\u5b9a\u7fa9\u7684 \u9801/\u6bcf\u9801 \u503c\u9032\u884c limit\u3002 \u9019\u5c07\u81ea\u52d5\u8a08\u7b97\u51fa\u76ee\u524d\u9801\u9762\u7684\u6b63\u78ba limit ( $perPage ) \u548c offset ( ($page - 1) * $perPage )\u3002 \u63a5\u4e0b\u4f86\uff0c\u6211\u5011\u9700\u8981\u518d\u50b3\u905e\u4e00\u4e9b\u53c3\u6578\u5230\u6211\u5011\u7684 view \u53c3\u6578\u4e2d\uff0c\u6240\u4ee5\u5c07\u4e0b\u9762\uff1a $viewParams = [ 'featuredThreads' => $finder->fetch() ]; \u6539\u8b8a\u6210\uff1a $viewParams = [ 'featuredThreads' => $finder->fetch(), 'total' => $finder->total(), 'page' => $page, 'perPage' => $perPage ]; \u8981\u4f7f\u7528\u986f\u793a\u6211\u5011\u7684\u9801\u9762\u5c0e\u89bd\uff0c\u6211\u5011\u9700\u8981\u77e5\u9053\u689d\u76ee\u7684\u7e3d\u6578\uff0c\u6211\u5011\u53ef\u4ee5\u901a\u904e total() \u65b9\u6cd5\u5f9e finder \u4e2d\u5f97\u5230\uff0c\u76ee\u524d\u7684\u9801\u78bc\u548c\u6211\u5011\u6bcf\u9801\u986f\u793a\u7684\u6578\u91cf\u3002 \u5982\u679c\u4f60\u56de\u5230 portal\uff0c\u73fe\u5728\u4f60\u6703\u770b\u5230\u53ea\u6709 5 \u500b\u7cbe\u9078\u4e3b\u984c\u986f\u793a\u3002 \u4e0d\u904e\uff0c\u6211\u5011\u73fe\u5728\u9700\u8981\u65b0\u589e\u9801\u9762\u5c0e\u89bd\u3002 \u6240\u4ee5\u6253\u958b demo_portal_view \u6a21\u677f\uff0c\u5728 </xf:foreach> \u6a19\u7c64\u5f8c\u76f4\u63a5\u65b0\u589e\u4ee5\u4e0b\u5167\u5bb9\uff1a <xf:pagenav page=\"{$page}\" perpage=\"{$perPage}\" total=\"{$total}\" link=\"portal\" wrapperclass=\"block\" /> \u6b64\u6642\u91cd\u65b0\u8f09\u5165 portal \u9801\u9762\uff0c\u53ea\u8981\u4f60\u6709 5 \u500b\u4ee5\u4e0a\u7684\u7cbe\u9078\u4e3b\u984c\uff0c\u73fe\u5728\u5c31\u6703\u5728\u7cbe\u9078\u4e3b\u984c\u5217\u8868\u7684\u5e95\u90e8\u770b\u5230\u9801\u9762\u5c0e\u89bd\u3002 \u5176\u4ed6\u4e00\u4e9b\u53ef\u80fd\u6709\u52a9\u65bc\u6539\u5584\u9019\u500b\u9801\u9762\u7684\u5916\u89c0\u7684\u6771\u897f\u662f\u65b0\u589e\u4e00\u500b\u5074\u908a\u6b04\uff0c\u6216\u8005\u66f4\u6e96\u78ba\u5730\u8aaa\uff0c\u4e00\u500b\u986f\u793a\u5728\u5074\u908a\u6b04\u7684\u5c0f\u7d44\u4ef6\u4f4d\u7f6e\u3002 \u5c0f\u7d44\u4ef6\u4f4d\u7f6e\u662f\u5728 Admin CP\u7684 \"\u958b\u767c\" \u4e0b\u65b0\u589e\u7684\u3002 \u9032\u5165 \"\u5c0f\u7d44\u4ef6\u4f4d\u7f6e\" \u9801\u9762\uff0c\u9ede\u9078 \"\u65b0\u589e\u5c0f\u7d44\u4ef6\u4f4d\u7f6e\"\u3002 \u8f38\u5165 \"\u4f4d\u7f6e ID\" \u70ba demo_portal_view_sidebar \uff0c\"Title\" \u70ba Demo portal view: Sidebar \u548c\u4e00\u500b\u9069\u7576\u7684\u63cf\u8ff0\u3002 \u78ba\u4fdd\u4f4d\u7f6e\u5df2\u958b\u555f\uff0c\u4e26\u9078\u64c7\u4e86\u6b63\u78ba\u7684\u9644\u52a0\u5143\u4ef6 ID \u5f8c\uff0c\u9ede\u9078 \"\u5132\u5b58\"\u3002 \u8981\u5c07\u9019\u500b\u4f4d\u7f6e\u65b0\u589e\u5230\u6a21\u677f\u4e2d\uff0c\u53ea\u9700\u5728 <xf:title> \u6a19\u7c64\u4e0b\u9762\u65b0\u589e\u4ee5\u4e0b\u5167\u5bb9\uff1a <xf:widgetpos id=\"demo_portal_view_sidebar\" position=\"sidebar\" /> \u7576\u7136\uff0c\u5728\u6c92\u6709\u65b0\u589e\u4e00\u4e9b\u5c0f\u7d44\u4ef6\u4e4b\u524d\uff0c\u6211\u5011\u9084\u662f\u4e0d\u6703\u770b\u5230\u5074\u908a\u6b04\u3002 \u5c0f\u7d44\u4ef6\u672c\u8eab\u662f\u4e0d\u6307\u6d3e\u7d66\u9644\u52a0\u5143\u4ef6\u7684\uff0c\u6240\u4ee5\u4f60\u70ba\u9019\u500b\u4f4d\u7f6e\u5efa\u7acb\u7684\u5c0f\u7d44\u4ef6\uff0c\u5982\u679c\u4f60\u60f3\u5728\u9810\u8a2d\u60c5\u6cc1\u4e0b\u767c\u9001\u4e00\u4e9b\u914d\u7f6e\u597d\u7684\u5c0f\u7d44\u4ef6\uff0c\u5c07\u9700\u8981\u65b0\u589e\u5230 Setup class \u4e2d\u3002 \u70ba\u4e86\u7c21\u55ae\u8d77\u898b\uff0c\u6211\u5011\u53ea\u9700\u8981\u8907\u88fd\u76ee\u524d\u6307\u6d3e\u7d66 forum_list_sidebar \u4f4d\u7f6e\u7684\u5c0f\u7d44\u4ef6\uff08\u9810\u8a2d\u60c5\u6cc1\u4e0b\uff09\u3002 \u6240\u4ee5\uff0c\u6211\u5011\u5c07\u628a\u9019\u4e9b\u65b0\u589e\u5230 Setup class \u4e2d\u7684\u4e00\u500b\u65b0\u7684 installStep4() \u65b9\u6cd5\u4e2d\uff1a public function installStep4() { $this->createWidget('demo_portal_view_members_online', 'members_online', [ 'positions' => ['demo_portal_view_sidebar' => 10] ]); $this->createWidget('demo_portal_view_new_posts', 'new_posts', [ 'positions' => ['demo_portal_view_sidebar' => 20] ]); $this->createWidget('demo_portal_view_new_profile_posts', 'new_profile_posts', [ 'positions' => ['demo_portal_view_sidebar' => 30] ]); $this->createWidget('demo_portal_view_forum_statistics', 'forum_statistics', [ 'positions' => ['demo_portal_view_sidebar' => 40] ]); $this->createWidget('demo_portal_view_share_page', 'share_page', [ 'positions' => ['demo_portal_view_sidebar' => 50] ]); } \u7576\u7136\uff0c\u5225\u5fd8\u4e86\u81ea\u5df1\u57f7\u884c\u9019\u500b\u8a2d\u5b9a\u6b65\u9a5f\uff1a Terminal $ php cmd.php xf-addon:install-step Demo/Portal 4","title":"\u6539\u9032\u5165\u53e3\u7db2\u7ad9\u9801\u9762"},{"location":"lets-build-an-add-on/#_12","text":"\u73fe\u5728\uff0c\u6211\u5011\u5728 portal \u9801\u9762\u4e2d\u986f\u793a\u6240\u6709\u7684\u7cbe\u9078\u4e3b\u984c\uff0c\u4e0d\u7ba1\u8a2a\u554f\u8005\u662f\u5426\u6709\u6b0a\u9650\u67e5\u770b\u5b83\u5011\u3002 \u9019\u4e0d\u662f\u5f88\u7406\u60f3\uff1b\u5728\u67d0\u4e9b\u60c5\u6cc1\u4e0b\uff0c\u60a8\u53ef\u80fd\u5e0c\u671b\u5728\u67d0\u4e9b\u53d7\u9650\u5236\u7684\u8ad6\u58c7\u4e0a\u767c\u4f48\u4e3b\u984c\uff0c\u4e26\u4e14\u53ea\u8b93\u90a3\u4e9b\u53ef\u4ee5\u6b63\u5e38\u6aa2\u8996\u8a72\u8ad6\u58c7\u7684\u7528\u6236\u53ef\u898b\u3002 \u8981\u505a\u5230\u9019\u4e00\u9ede\uff0c\u6211\u5011\u9700\u8981\u6539\u8b8a\u6211\u5011\u7684\u7a0b\u5f0f\u78bc\uff0c\u4ee5\u4fbf\u6211\u5011 \"over-fetch\" \u6211\u5011\u9700\u8981\u986f\u793a\u7684\u8a18\u9304\u6578\u91cf\uff0c\u904e\u6ffe\u6389\u4efb\u4f55\u770b\u4e0d\u898b\u7684\u7d50\u679c\uff0c\u7136\u5f8c\u5c07\u7d50\u679c\u96c6\u5207\u6210\u6211\u5011\u60f3\u8981\u5728\u6bcf\u9801\u986f\u793a\u7684\u5be6\u969b\u6578\u91cf\u3002 \u9019\u6bd4\u807d\u8d77\u4f86\u8981\u7c21\u55ae\u4e00\u4e9b\u3002 \u9996\u5148\uff0c\u8acb\u9032\u5165 Portal Controller\uff0c\u4e26\u5c07\u9019\u4e00\u884c\uff1a ->limitByPage($page, $perPage); \u66f4\u6539\u6210\u9019\u6a23\uff1a ->limit($perPage * 3); \u7136\u5f8c\u4e0b\u9762\u518d\u52a0\u4e0a\uff1a $featuredThreads = $finder->fetch() ->filter(function(\\Demo\\Portal\\Entity\\FeaturedThread $featuredThread) { return ($featuredThread->Thread->canView()); }) ->sliceToPage($page, $perPage); \u6700\u5f8c\u5c07\u9019\u884c\uff1a 'featuredThreads' => $finder->fetch(), \u66f4\u6539\u70ba\uff1a 'featuredThreads' => $featuredThreads, \u4f60\u53ef\u80fd\u5728\u524d\u9762\u7684 demo_portal_view \u6a21\u677f\u4e2d\u5df2\u7d93\u767c\u73fe\uff0c\u6211\u5011\u5448\u73fe\u7684\u6bcf\u4e00\u7bc7\u6587\u7ae0\u4e5f\u6307\u5b9a\u5176\u9644\u4ef6\uff1a 'attachments': $post.attach_count ? $post.Attachments : [], \u73fe\u5728\uff0c\u9019\u5c07\u70ba\u6bcf\u500b\u5e16\u5b50\u7522\u751f\u4e00\u500b\u984d\u5916\u7684\u67e5\u8a62\u3002 \u6240\u4ee5\uff0c\u6211\u5011\u61c9\u8a72\u5617\u8a66\u5c0d\u6211\u5011\u8981\u986f\u793a\u7684\u6240\u6709\u5e16\u5b50\u9032\u884c\u4e00\u6b21\u67e5\u8a62\uff0c\u4e26\u63d0\u524d\u5c07\u5b83\u5011\u65b0\u589e\u5230\u5e16\u5b50\u4e2d\u3002 \u9019\u53ef\u80fd\u807d\u8d77\u4f86\u6bd4\u5be6\u969b\u60c5\u6cc1\u66f4\u8907\u96dc\u3002 \u53ea\u8981\u5728 ->slice(0, $perPage, true); \u884c\u4e0b\u9762\u65b0\u589e\u4ee5\u4e0b\u7a0b\u5f0f\u78bc\u5373\u53ef\u3002 $threads = $featuredThreads->pluckNamed('Thread'); $posts = $threads->pluckNamed('FirstPost', 'first_post_id'); /** @var \\XF\\Repository\\Attachment $attachRepo */ $attachRepo = $this->repository('XF:Attachment'); $attachRepo->addAttachmentsToContent($posts, 'post'); \u6211\u5011\u9996\u5148\u4f7f\u7528 pluckNamed() \u65b9\u6cd5\u7372\u5f97\u4e00\u500b\u4e3b\u984c\u7684\u96c6\u5408\uff0c\u7136\u5f8c\u518d\u5f9e\u4e3b\u984c\u4e2d\u7372\u5f97\u4e00\u500b\u5e16\u5b50\u7684\u96c6\u5408\uff08\u4ee5\u5e16\u5b50 ID \u70ba key \uff09\u3002 \u4e00\u65e6\u6211\u5011\u5f97\u5230\u4e86\u5e16\u5b50\uff0c\u6211\u5011\u53ea\u9700\u5c07\u5b83\u5011\u50b3\u905e\u5230\u9644\u4ef6 repository \u7684\u4e00\u500b\u7279\u6b8a\u65b9\u6cd5\u4e2d\u5c31\u53ef\u4ee5\u4e86\uff0c\u8a72\u65b9\u6cd5\u57f7\u884c\u4e00\u500b\u55ae\u4e00\u7684\u67e5\u8a62\uff0c\u4e26\u70ba\u6bcf\u500b\u5e16\u5b50\u7684\u9644\u4ef6\u95dc\u806f \"hydrates\"\u3002 \u6700\u5f8c\u8981\u5b8c\u6210\u7684\u6b0a\u9650\u76f8\u95dc\u4e8b\u60c5\u662f\u5efa\u7acb\u4e00\u500b\u65b0\u7684\u6b0a\u9650\u4f86\u63a7\u5236\u8ab0\u53ef\u4ee5\u624b\u52d5\u5730\u5c0d\u4e3b\u984c\u9032\u884c \u7cbe\u9078/\u53d6\u6d88\u7cbe\u9078\u3002 \u8981\u505a\u5230\u9019\u4e00\u9ede\uff0c\u5728 Admin CP \u7684 \"\u958b\u767c\" \u4e2d\u9ede\u9078 \"\u6b0a\u9650\u5b9a\u7fa9\"\uff0c\u7136\u5f8c\u9ede\u9078 \"\u65b0\u589e\u6b0a\u9650\"\u3002 \"\u6b0a\u9650\u7d44\" \u70ba \"\u8ad6\u58c7\"\uff0c\"\u6b0a\u9650 ID\" \u70ba demoPortalFeature \uff0c\"Title\" \u61c9\u8a72\u662f Can feature / unfeature threads \uff0c\u5c07 \"\u4ecb\u9762\u7d44\" \u8a2d\u5b9a\u70ba Forum moderator permissions \uff0c\u5728\u9078\u64c7\u4e86\u9069\u7576\u7684\u986f\u793a\u9806\u5e8f\u4e26\u78ba\u4fdd\u9078\u64c7\u4e86\u60a8\u7684\u9644\u52a0\u5143\u4ef6\u4e4b\u5f8c\uff0c\u9ede\u9078 \"\u5132\u5b58\"\u3002 \u8981\u771f\u6b63\u4f7f\u7528\u9019\u500b\u6b0a\u9650\uff0c\u6211\u5011\u9700\u8981\u56de\u5230\u6211\u5011\u7684\u7e7c\u627f\u4e3b\u984c Entity\uff0c\u4fee\u6539 canFeatureUnfeature() \u65b9\u6cd5\u3002 \u5c07 return true; \u66ff\u63db\u70ba\uff1a return \\XF::visitor()->hasNodePermission($this->node_id, 'demoPortalFeature'); \u6b64\u6642\uff0c\u7531\u65bc\u6b0a\u9650\u6c92\u6709\u4efb\u4f55\u9810\u8a2d\u503c\uff0c\u5982\u679c\u4f60\u53bb\u7de8\u8f2f\u4efb\u4f55\u4e00\u500b\u5e16\u5b50\uff0c\u4f60\u61c9\u8a72\u6703\u767c\u73fe \"\u7cbe\u9078\" checkbox \u4e0d\u898b\u4e86\u3002 \u4f46\u662f\uff0c\u5982\u679c\u60a8\u6388\u4e88\u81ea\u5df1\u8a72\u6b0a\u9650\uff0c\u5247\u8a72c heckbox \u5c07\u518d\u6b21\u51fa\u73fe\u3002 \u56e0\u6b64\uff0c\u9019\u61c9\u8a72\u8868\u660e\u4e86\u6b0a\u9650\u7684\u904b\u4f5c\u662f\u7b26\u5408\u9810\u671f\u7684!","title":"\u5be6\u73fe\u6b0a\u9650\u548c\u512a\u5316"},{"location":"lets-build-an-add-on/#_13","text":"\u6211\u5011\u76ee\u524d\u6bcf\u9801\u53ea\u986f\u793a 5 \u500b\u7cbe\u9078\u4e3b\u984c\uff0c\u4f46\u5982\u679c\u80fd\u6709\u66f4\u591a\u7684\u986f\u793a\u9078\u9805\u5c31\u66f4\u597d\u4e86\u3002 \u5efa\u7acb\u9078\u9805\u5f88\u7c21\u55ae\u3002 \u96d6\u7136\u4e0d\u662f\u5fc5\u9808\u7684\uff0c\u4f46\u6211\u5011\u9996\u5148\u8981\u5efa\u7acb\u4e00\u500b\u65b0\u7684\u9078\u9805\u7d44\uff0c\u7136\u5f8c\u5411\u8a72\u7d44\u65b0\u589e\u4e00\u500b\u65b0\u7684\u9078\u9805\u3002 \u5728 Admin CP \u7684\u8a2d\u5b9a\u7136\u5f8c\u9078\u9805\u4e0b\u9ede\u9078 \"\u65b0\u589e\u9078\u9805\u7d44\" \u6309\u9215\u3002 \u6211\u5011\u5c07 \"\u7528\u6236\u7d44 ID\" \u7a31\u70ba demoPortal \uff0c\u4e26\u7d66\u5b83\u4e00\u500b \"Demo - Portal options\" \u7684\u6a19\u984c\u3002 \u7d66\u5b83\u4e00\u500b\u5408\u9069\u7684 \"\u63cf\u8ff0\" \u548c \"\u986f\u793a\u9806\u5e8f\"\uff0c\u7136\u5f8c\u9ede\u9078 \"\u5132\u5b58\"\u3002 \u73fe\u5728\u9ede\u9078 \"\u65b0\u589e\u9078\u9805\"\u3002 \u5c07 \"\u9078\u9805 ID\" \u8a2d\u5b9a\u70ba demoPortalFeaturedPerPage \uff0c\"Title\" \u8a2d\u5b9a\u70ba Featured threads per page \uff0c\u7de8\u8f2f\u683c\u5f0f\u8a2d\u5b9a\u70ba Spin box \uff0c\"\u8cc7\u6599\u985e\u578b\" \u8a2d\u5b9a\u70ba Positive integer \uff0c\"\u9810\u8a2d\u503c\" \u8a2d\u5b9a\u70ba \"10\"\u3002 \u9ede\u64ca \"\u5132\u5b58\"\u3002 \u8981\u5be6\u73fe\u9019\u4e00\u9ede\uff0c\u8acb\u56de\u5230 portal Controller\uff0c\u4e26\u5c07\uff1a $perPage = 5; \u66f4\u6539\u70ba\uff1a $perPage = $this->options()->demoPortalFeaturedPerPage; \u589e\u52a0\u53e6\u4e00\u500b\u9078\u9805\u53ef\u80fd\u4e0d\u6703\u6709\u4ec0\u9ebc\u5f71\u97ff\u3002 \u4e5f\u8a31\u53e6\u4e00\u500b\u6709\u7528\u7684\u9078\u9805\u662f\u53ef\u4ee5\u5c07\u9810\u8a2d\u7684\u6392\u5e8f\u9806\u5e8f\u5f9e xf_demo_portal_featured_thread.feartured_date \u6539\u70ba xf_thread.post_date \u3002 \u56de\u5230 \"Demo - Portal options\" \u7d44\uff0c\u9ede\u9078 \"\u65b0\u589e\u9078\u9805\"\u3002 \u5c07 \"\u9078\u9805 ID\" \u8a2d\u5b9a\u70ba demoPortalDefaultSort \uff0c\"Title\" \u8a2d\u5b9a\u70ba Default sort order \uff0c\"\u7de8\u8f2f\u683c\u5f0f\" \u8a2d\u5b9a\u70ba Radio buttons \u3002 \"\u683c\u5f0f\u53c3\u6578\" \u8a2d\u5b9a\u5982\u4e0b\uff1a plain featured_date={{ phrase('demo_portal_featured_date') }} post_date={{ phrase('demo_portal_post_date') }} \u6700\u5f8c\u5c07 \"\u9810\u8a2d\u503c\" \u8a2d\u5b9a\u70ba featured_date \uff0c\u9ede\u9078 \"\u5132\u5b58\"\u3002 \u6211\u5011\u9700\u8981\u5efa\u7acb\u7528\u65bc\u55ae\u9078\u6309\u9215\u6a19\u7c64\u7684\u77ed\u8a9e\uff0c\u985e\u4f3c\u65bc\u6211\u5011\u4e4b\u524d\u5efa\u7acb\u6a21\u677f\u4fee\u6539\u7684\u77ed\u8a9e\u3002 \u5c07\u9078\u9805\u503c\u8a2d\u5b9a\u70ba \"\u767c\u4f48\u65e5\u671f\"\u3002 \u56b4\u683c\u4f86\u8aaa\uff0c\u6211\u5011\u53ef\u4ee5\u76f4\u63a5\u66f4\u65b0\u6211\u5011\u7684 repository \u65b9\u6cd5\u4f86\u4f7f\u7528\u65b0\u7684\u9078\u9805\uff0c\u4f46\u662f\uff0c\u4e5f\u8a31\u503c\u5f97\u770b\u770b\u81ea\u5b9a\u7fa9 finder \u65b9\u6cd5\u662f\u5982\u4f55\u904b\u4f5c\u7684\u3002 \u5728\u8def\u5f91 src/addons/Demo/Portal/Finder/FeaturedThread.php \u4e2d\u5efa\u7acb\u4e00\u500b\u65b0\u6a94\u6848\uff0c\u5167\u5bb9\u5982\u4e0b\uff1a <?php namespace Demo\\Portal\\Finder; use XF\\Mvc\\Entity\\Finder; class FeaturedThread extends Finder { public function applyFeaturedOrder($direction = 'ASC') { $options = \\XF::options(); if ($options->demoPortalDefaultSort == 'featured_date') { $this->setDefaultOrder('featured_date', $direction); } else { $this->setDefaultOrder('Thread.post_date', $direction); } return $this; } } \u6b63\u5982\u4f60\u6240\u770b\u5230\u7684\uff0c\u6211\u5011\u5728\u9019\u88e1\u6240\u505a\u7684\u53ea\u662f\u5efa\u7acb\u4e86\u4e00\u500b\u76f8\u7576\u57fa\u672c\u7684\u985e\uff0c\u5b83\u7e7c\u627f\u4e86 XF Finder \u7269\u4ef6\uff0c\u4e26\u5275\u5efa\u4e00\u500b\u7c21\u55ae\u7684\u65b9\u6cd5\u4f86\u67e5\u770b\u6211\u5011\u9078\u9805\u7684\u503c\u4e26\u5957\u7528\u9069\u7576\u7684\u9810\u8a2d\u9806\u5e8f\u3002 \u73fe\u5728\u6211\u5011\u53ef\u4ee5\u66f4\u65b0\u6211\u5011\u7684 repository \u65b9\u6cd5\u4f86\u53d6\u4ee3\u9019\u500b\u65b9\u6cd5\u3002 \u5728\u6211\u5011\u7684\u7cbe\u9078\u4e3b\u984c repository \u88e1\u9762\uff0c\u627e\u5230\uff1a ->setDefaultOrder('featured_date', 'DESC') \u4e26\u6539\u6210\uff1a ->applyFeaturedOrder('DESC') \u6700\u5f8c\uff0c\u66f4\u65b0\u6211\u5011\u7684 portal view \u4ee5\u986f\u793a\u9069\u7576\u7684\u6642\u9593\u6233\u5927\u62b5\u5982\u6b64 - \u6839\u64da\u6211\u5011\u7684\u9078\u9805\u503c\uff0c\u53ef\u4ee5\u662f\u7cbe\u9078\u65e5\u671f\u6216\u767c\u4f48\u65e5\u671f\u3002 \u5728 demo_portal_view \u6a21\u677f\u4e2d\u5c07\uff1a <li><xf:date time=\"{$featuredThread.featured_date}\" /></li> \u66f4\u6539\u70ba\uff1a <li> <xf:if is=\"$xf.options.demoPortalDefaultSort == 'featured_date'\"> <xf:date time=\"{$featuredThread.featured_date}\" /> <xf:else /> <xf:date time=\"{$thread.post_date}\" /> </xf:if> </li>","title":"\u5efa\u7acb\u4e00\u4e9b\u9078\u9805"},{"location":"lets-build-an-add-on/#_14","text":"\u70ba\u4e86\u89e3\u6c7a\u9019\u500b\u554f\u984c\uff0c\u6211\u5011\u9700\u8981\u518d\u6b21\u4fee\u6539\u4e3b\u984c Entity\uff0c\u4f46\u9019\u6b21\u6211\u5011\u5c07\u901a\u904e entity_post_save \u4e8b\u4ef6\u4f86\u5be6\u73fe\u3002 \u6b63\u5982\u6211\u5011\u5728 \u5be6\u9ad4\u751f\u547d\u9031\u671f \u4e2d\u63d0\u5230\u7684\uff0c _postSave() \u65b9\u6cd5\u662f\u5728 Entity \u88ab\u63d2\u5165\u6216\u4fee\u6539\u5f8c\u53ef\u4ee5\u57f7\u884c\u52d5\u4f5c\u7684\u5730\u65b9\u3002 \u6700\u521d\u6211\u5011\u6703\u5728\u4e00\u500b\u4e3b\u984c\u4e0d\u518d\u53ef\u898b\u7684\u6642\u5019\uff0c\u53d6\u6d88\u5c0d\u8a72\u4e3b\u984c\u7684\u7cbe\u9078\u3002 \u6240\u4ee5\uff0c\u56de\u5230 \"\u65b0\u589e\u7a0b\u5f0f\u78bc\u4e8b\u4ef6\u76e3\u807d\" \u9801\u9762\uff0c\u9019\u6b21\u76e3\u807d entity_post_save \u4e8b\u4ef6\u3002 \u9019\u6b21\u7684\u4e8b\u4ef6\u63d0\u793a\u5c07\u662f XF\\Entity\\Thread \u3002 \u5c0d\u65bc\u57f7\u884c callback\uff0c\u6211\u5011\u5c07\u4f7f\u7528\u8207\u4e4b\u524d\u76f8\u540c\u7684 class ( Dem\\Portal\\Listener )\uff0c\u4f46\u662f\u6211\u5011\u5c07\u5728\u9019\u88e1\u65b0\u589e\u4e00\u500b\u65b0\u7684\u65b9\u6cd5\uff0c\u547d\u540d\u70ba threadEntityPostSave \u3002 \u73fe\u5728\u8b93\u6211\u5011\u65b0\u589e\u9019\u500b\u65b9\u6cd5\uff0c\u9019\u6a23\u7576\u6211\u5011\u5132\u5b58\u76e3\u807d\u5668\u6642\uff0c\u5b83\u5c31\u6703\u51fa\u73fe\uff1a public static function threadEntityPostSave(\\XF\\Mvc\\Entity\\Entity $entity) { } \u9ede\u64ca \"\u5132\u5b58\" \u4f86\u5132\u5b58\u76e3\u807d\u5668\u3002 \u9019\u500b\u51fd\u6578\u7684\u5167\u5bb9\u76f8\u7576\u7c21\u55ae\uff0c\u6211\u5011\u4f86\u770b\u4e00\u4e0b\uff1a if ($entity->isUpdate()) { $visibilityChange = $entity->isStateChanged('discussion_state', 'visible'); if ($visibilityChange == 'leave') { $featuredThread = $entity->FeaturedThread; if ($featuredThread) { $featuredThread->delete(); $entity->fastUpdate('demo_portal_featured', false); } } } \u6211\u5011\u4e4b\u524d\u5df2\u7d93\u53d6\u6d88\u4e86\u4e3b\u984c\u7684\u7cbe\u9078\uff0c\u4f46\u9019\u4e00\u6b21\u6211\u5011\u8981\u4ee5\u4e3b\u984c\u7684\u72c0\u614b\u70ba\u689d\u4ef6\u3002 \u6211\u5011\u53ef\u4ee5\u4f7f\u7528 isStateChanged \u65b9\u6cd5\u6aa2\u6e2c\u72c0\u614b\u8b8a\u5316\u3002 \u9019\u5c07\u5c0d\u50b3\u905e\u9032\u4f86\u7684 column \u540d\u548c value \u8fd4\u56de enter \u6216 leave \u3002 \u4f8b\u5982\uff0c\u5982\u679c discussion_state \u5f9e visible \u8b8a\u70ba deleted \uff0c\u90a3\u9ebc\u5728\u4e0a\u9762\u7684\u4f8b\u5b50\u4e2d\uff0c\u8a72\u65b9\u6cd5\u5c07\u8fd4\u56de leave \u3002 \u4e00\u65e6\u6211\u5011\u6aa2\u6e2c\u5230\u81ea\u5df1 \"\u96e2\u958b\" \u53ef\u898b\u72c0\u614b\u5f8c\uff0c\u5c31\u53ef\u4ee5\u76f4\u63a5\u78ba\u5b9a\u81ea\u5df1\u6709\u4e00\u500b\u7cbe\u9078\u7684\u4e3b\u984c\u95dc\u806f\uff0c\u522a\u9664\u5b83\uff0c\u4e26\u66f4\u65b0\u5feb\u53d6\u503c\u3002 \u9019\u53ea\u6db5\u84cb\u4e86\u4e3b\u984c\u88ab\u66ab\u6642\u522a\u9664\u6216\u9001\u5165\u6279\u51c6\u4f47\u5217\u7684\u60c5\u6cc1\uff0c\u6211\u5011\u9084\u9700\u8981\u6db5\u84cb\u4e3b\u984c\u88ab\u6c38\u4e45\u522a\u9664\u7684\u60c5\u6cc1\u3002 \u70ba\u6b64\uff0c\u6211\u5011\u9700\u8981\u53e6\u4e00\u500b\u76e3\u807d\u5668\uff0c\u9019\u6b21\u662f\u91dd\u5c0d entity_post_delete \u4e8b\u4ef6\u3002 \u56e0\u6b64\uff0c\u4f7f\u7528\u76f8\u540c\u7684 callback class \u65b0\u589e\u8a72\u76e3\u807d\u5668\uff0c\u9019\u6b21\u7684\u65b9\u6cd5\u540d\u7a31\u70ba threadEntityPostDelete \u3002 \u5728\u76e3\u807d\u5668 class \u4e2d\u65b0\u589e\u4ee5\u4e0b\u7a0b\u5f0f\u78bc\uff1a public static function threadEntityPostDelete(\\XF\\Mvc\\Entity\\Entity $entity) { $featuredThread = $entity->FeaturedThread; if ($featuredThread) { $featuredThread->delete(); } } \u9ede\u9078 \"\u5132\u5b58\" \u4ee5\u5132\u5b58\u76e3\u807d\u5668\u5f8c\uff0c\u5c31\u53ef\u4ee5\u5c0d\u6b64\u9032\u884c\u6e2c\u8a66\u4e86\u3002 \u70ba\u4e86\u6e2c\u8a66\u9019\u500b\uff0c\u5176\u5be6\u4f60\u6700\u597d\u7559\u610f\u4e00\u4e0b xf_demo_portal_featured_thread \u8cc7\u6599\u8868\uff0c\u56e0\u70ba\u5230\u76ee\u524d\u70ba\u6b62\uff0c\u7a0b\u5f0f\u78bc\u5df2\u7d93\u4e0d\u6703\u986f\u793a\u4e0d\u53ef\u898b\u7684\u4e3b\u984c\u4e86\uff0c\u4f46\u91cd\u8981\u7684\u662f\u4e0d\u8981\u7559\u4e0b\u5b64\u5152\u8cc7\u6599\u3002 \u4e00\u5207\u90fd\u5f88\u9806\u5229\uff0c\u6211\u5011\u5df2\u7d93\u975e\u5e38\u63a5\u8fd1\u5b8c\u6210\u4e86......","title":"\u5728\u53ef\u898b\u6027\u8b8a\u66f4\u4e0a\u53d6\u6d88\u7cbe\u9078"},{"location":"lets-build-an-add-on/#_15","text":"\u8aaa\u5230\u5b64\u5152\u8cc7\u6599\uff0c\u6bcf\u7576\u89e3\u9664\u5b89\u88dd\u9644\u52a0\u5143\u4ef6\u6642\uff0c\u6211\u5011\u90fd\u61c9\u8a72\u5c0d\u8cc7\u6599\u5eab\u9032\u884c\u6574\u7406\u3002 \u6211\u5011\u53ef\u4ee5\u5728\u6211\u5011\u4e4b\u524d\u5efa\u7acb\u7684 Setup class \u4e2d\u5b8c\u6210\u9019\u9805\u5de5\u4f5c\u3002 \u6211\u5011\u5c07\u5efa\u7acb 3 \u500b\u65b0\u65b9\u6cd5\uff0c\u5c0d\u61c9\u6211\u5011\u7684\u524d 3 \u500b\u5b89\u88dd\u6b65\u9a5f\uff1a public function uninstallStep1() { $this->schemaManager()->alterTable('xf_forum', function(Alter $table) { $table->dropColumns('demo_portal_auto_feature'); }); } public function uninstallStep2() { $this->schemaManager()->alterTable('xf_thread', function(Alter $table) { $table->dropColumns('demo_portal_featured'); }); } public function uninstallStep3() { $this->schemaManager()->dropTable('xf_demo_portal_featured_thread'); } \u6211\u5011\u4e0d\u9700\u8981\u5efa\u7acb\u89e3\u9664\u5b89\u88dd\u6b65\u9a5f\u4f86\u79fb\u9664\u5c0f\u7d44\u4ef6\uff0c\u56e0\u70ba\u7576\u5c0f\u7d44\u4ef6\u4f4d\u7f6e\u88ab\u79fb\u9664\u6642\uff0c\u5b83\u5011\u6703\u88ab\u81ea\u52d5\u79fb\u9664\u3002 \u5c0d\u65bc\u6211\u5011\u5efa\u7acb\u4e26\u8207\u9644\u52a0\u5143\u4ef6\u76f8\u95dc\u806f\u7684\u4efb\u4f55\u5176\u4ed6\u8cc7\u6599\u4e5f\u662f\u5982\u6b64 -- \u5b83\u5011\u5c07\u5728\u89e3\u9664\u5b89\u88dd\u6642\u81ea\u52d5\u522a\u9664\u3002","title":"\u6700\u5f8c\u4e00\u4e9b\u672a\u4ea4\u5f85\u6e05\u695a\u7684\u4e8b\u60c5"},{"location":"lets-build-an-add-on/#_16","text":"\u4efb\u4f55\u9644\u52a0\u5143\u4ef6\u7684\u6700\u5f8c\u4e00\u6b65\uff0c\u5c31\u662f\u767c\u4f48\u5b83\uff01 \u9019\u6d89\u53ca\u5230\u5f9e\u8cc7\u6599\u5eab\u4e2d\u63d0\u53d6 XML \u6a94\u6848\uff08\u5728\u8edf\u9ad4\u5305\u4e2d\u63d0\u4f9b\u4e26\u7528\u65bc\u5b89\u88dd\uff09\uff0c\u8a08\u7b97\u6bcf\u500b\u6a94\u6848\u7684\u96dc\u6e4a\u78bc\uff0c\u4e26\u5c07\u5176\u65b0\u589e\u5230\u6211\u5011\u7684 hashes.json \u4e2d\uff0c\u4e26\u5c07\u76f8\u95dc\u6a94\u6848\u6253\u5305\u6210\u4e00\u500b ZIP \u6a94\u6848\u3002 \u503c\u5f97\u6176\u5e78\u7684\u662f\uff0c\u9019\u53ef\u4ee5\u901a\u904e\u4e00\u500b CLI \u6307\u4ee4\u4f86\u5b8c\u6210! \u53ea\u8981\u57f7\u884c\u4e0b\u9762\u7684\u6307\u4ee4\u5c31\u53ef\u4ee5\u4e86\uff1a Terminal $ php cmd.php xf-addon:build-release Demo/Portal Performing add-on export. Exporting data for Demo - Portal to ../src/addons/Demo/Portal/_data. 10/10 [============================] 100% Written successfully. Building release ZIP. Writing release ZIP to ../src/addons/Demo/Portal/_releases. Release written successfully. \u90a3\u9ebc\uff0c\u6211\u5011\u7684\u6f14\u793a\u63d2\u4ef6\u5c31\u5230\u6b64\u7d50\u675f\u4e86\uff01 \u5982\u679c\u60a8\u60f3\u4e0b\u8f09\u9019\u500b\u9644\u52a0\u5143\u4ef6\u7684\u539f\u59cb\u78bc\uff0c\u8acb\u9ede\u9078\u9019\u88e1\uff1a Demo-Portal-1.0.0 Alpha.zip \u3002","title":"\u69cb\u5efa\u9644\u52a0\u5143\u4ef6"},{"location":"managing-the-schema/","text":"\u7ba1\u7406 Schema \u00b6 \u6211\u5011\u5df2\u7d93\u770b\u4e86\u4e00\u4e9b\u53ef\u7528\u65bc\u8207\u8cc7\u6599\u4ea4\u4e92\u7684\u65b0\u65b9\u6cd5\u3002 \u7576\u7136\uff0c\u5728\u4e00\u4e9b\u7279\u5b9a\u60c5\u6cc1\u4e0b\uff0c\u53ef\u80fd\u9700\u8981\u76f4\u63a5\u8207\u8cc7\u6599\u5eab\u9032\u884c\u4ea4\u4e92\u3002 \u8cc7\u6599\u5eab\u9069\u914d\u5668 \u00b6 XF2 \u4e2d\u9810\u8a2d\u7684\u8cc7\u6599\u5eab\u9069\u914d\u5668\u662f\u57fa\u65bc MySQL \u548c PHP \u7684 mysqli \u64f4\u5c55\u3002 \u5728\u4efb\u4f55 XF \u985e\u4e2d\u90fd\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u65b9\u6cd5\u8a2a\u554f\u8a2d\u5b9a\u7684\u8cc7\u6599\u5eab\u9069\u914d\u5668\uff1a $db = \\XF::db(); \u9069\u914d\u5668\u6709\u8a31\u591a\u53ef\u7528\u7684\u65b9\u6cd5\uff0c\u9019\u4e9b\u65b9\u6cd5\u5c07\u57f7\u884c\u4e00\u500b SQL \u67e5\u8a62\uff0c\u7136\u5f8c\u5c07\u7d50\u679c\u683c\u5f0f\u5316\u70ba\u4e00\u500b\u9663\u5217\u3002 \u4f8b\u5982\uff0c\u8981\u8a2a\u554f\u4e00\u500b\u7528\u6236\u8a18\u9304\uff1a $db = \\XF::db(); $user = $db->fetchRow('SELECT * FROM xf_user WHERE user_id = ?', 1); $user \u8b8a\u6578\u73fe\u5728\u5c07\u5305\u542b\u4e00\u500b\u9663\u5217\uff0c\u5176\u4e2d\u5305\u542b\u67e5\u8a62\u7d50\u679c\u96c6\u4e2d\u7b2c\u4e00\u884c\u7684\u6240\u6709\u503c\u3002 \u8981\u60f3\u5f9e\u8a72\u67e5\u8a62\u4e2d\u7372\u5f97\u55ae\u4e00\u7684\u503c\uff0c\u4f8b\u5982\u7528\u6236\u540d\uff0c\u53ef\u4ee5\u57f7\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a $username = $user['username']; Warning \u76f4\u63a5\u7de8\u5beb\u4e26\u50b3\u905e\u7d66\u8cc7\u6599\u5eab\u9069\u914d\u5668\u7684\u8cc7\u6599\u5eab\u67e5\u8a62\u4e26\u975e\u81ea\u52d5 \"\u5b89\u5168\"\u3002 \u5982\u679c\u7528\u6236\u7684\u8f38\u5165\u6c92\u6709\u7d93\u904e\u6e05\u9664\uff0c\u4e26\u4e14\u6c92\u6709\u7d93\u904e\u6e96\u5099\u5c31\u50b3\u5165\u67e5\u8a62\uff0c\u5b83\u5011\u5c31\u6703\u5e36\u4f86 SQL \u96b1\u78bc\u653b\u64ca\u6f0f\u6d1e\u7684\u98a8\u96aa\u3002 \u6b63\u78ba\u7684\u65b9\u6cd5\u662f\u4f7f\u7528\u6e96\u5099\u597d\u7684\u8a9e\u53e5\uff0c\u5c31\u50cf\u4e0a\u9762\u7684\u4f8b\u5b50\u4e00\u6a23\u3002 \u5728\u67e5\u8a62\u672c\u8eab\u4e2d\u4f7f\u7528 ? \u4f54\u4f4d\u7b26\u4f86\u8868\u793a\u53c3\u6578\u3002 \u9019\u4e9b\u4f54\u4f4d\u7b26\u7d93\u904e\u9069\u7576\u7684\u8f49\u7fa9\u5f8c\uff0c\u6703\u88ab\u4e0b\u4e00\u500b\u53c3\u6578\u4e2d\u7684\u503c\u66ff\u63db\u3002 \u5982\u679c\u4f60\u9700\u8981\u4f7f\u7528\u7684\u53c3\u6578\u4e0d\u6b62\u4e00\u500b\uff0c\u90a3\u61c9\u8a72\u4ee5\u9663\u5217\u7684\u5f62\u5f0f\u50b3\u905e\u5230 fetch \u985e\u578b\u65b9\u6cd5\u4e2d\u3002 \u5982\u6709\u5fc5\u8981\uff0c\u4f60\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528 $db->quote($value) \u5c0d\u503c\u9032\u884c\u8f49\u7fa9\u6216\u5f15\u7528\u3002 \u60a8\u53ef\u4ee5 \u5728\u9019\u88e1 \u627e\u5230\u66f4\u591a\u95dc\u65bc\u6e96\u5099\u597d\u7684\u8a9e\u53e5\u8cc7\u8a0a\u3002 \u4e5f\u53ef\u4ee5\u5f9e\u4e00\u689d\u8a18\u9304\u4e2d\u67e5\u8a62\u4e00\u500b\u503c\u3002 \u4f8b\u5982\uff1a $db = \\XF::db(); $username = $db->fetchOne('SELECT username FROM xf_user WHERE user_id = ?', 1); \u5982\u679c\u4f60\u6709\u4e00\u500b\u9700\u8981\u8fd4\u56de\u591a\u689d\u8a18\u9304\u7684\u67e5\u8a62\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528 fetchAll \uff1a $db = \\XF::db(); $users = $db->fetchAll('SELECT * FROM xf_user LIMIT 10'); \u6216\u8005 fetchAllKeyed \uff1a $db = \\XF::db(); $users = $db->fetchAllKeyed('SELECT * FROM xf_user LIMIT 10', 'user_id'); \u9019\u5169\u7a2e\u65b9\u6cd5\u90fd\u5c07\u8fd4\u56de\u4e00\u500b\u4ee3\u8868\u6bcf\u500b\u7528\u6236\u8a18\u9304\u7684\u9663\u5217\u3002 fetchAll \u548c fetchAllKeyed \u65b9\u6cd5\u4e4b\u9593\u7684\u5340\u5225\u662f\uff0c\u8fd4\u56de\u7684\u9663\u5217\u7684 key \u503c\u4e0d\u540c\u3002 \u4f7f\u7528 fetchAll \u65b9\u6cd5\u6642\uff0c\u9663\u5217\u5c07\u7528\u9023\u7e8c\u7684\u6578\u5b57\u6574\u6578\u9032\u884c key \u9396\u5b9a\u3002 \u7528 fetchAllKeyed \u65b9\u6cd5\uff0c\u9663\u5217\u5c07\u7528\u7b2c\u4e8c\u500b\u53c3\u6578\u4e2d\u547d\u540d\u7684\u6b04\u4f4d\u540d\u9032\u884c key \u9396\u5b9a\u3002 Note \u5982\u679c\u4f60\u4f7f\u7528 fetchAllKeyed \uff0c\u8acb\u6ce8\u610f\u7b2c\u4e8c\u500b\u53c3\u6578\u662f\u8981\u5c0d\u9663\u5217\u9032\u884c key \u9396\u5b9a\u7684\u6b04\u4f4d\uff0c\u4f46 \u7b2c\u4e09\u500b \u53c3\u6578\u662f\u4f60\u50b3\u905e param \u503c\u4ee5\u5339\u914d ? \u4f54\u4f4d\u7b26\u7684\u5730\u65b9\u3002 \u9084\u6709\u4e00\u4e9b\u5176\u4ed6\u7372\u53d6\u985e\u578b\u7684\u65b9\u6cd5\uff0c\u5305\u62ec fetchAllColumn \uff0c\u7528\u65bc\u5f9e\u6240\u6709\u8fd4\u56de\u7684 rows \u4e2d\u6293\u53d6\u4e00\u500b\u7279\u5b9a column \u7684\u503c\u7684\u9663\u5217\uff1a $db = \\XF::db(); $usernames = $db->fetchAllColumn('SELECT username FROM xf_user LIMIT 10'); \u4e0a\u9762\u7684\u4f8b\u5b50\u5c07\u8fd4\u56de\u4e00\u500b\u5f9e\u7d50\u679c\u67e5\u8a62\u4e2d\u627e\u5230\u7684 10 \u500b\u7528\u6236\u540d\u7684\u9663\u5217\u3002 \u6700\u5f8c\uff0c\u4f60\u53ef\u80fd\u4e26\u4e0d\u60f3\u8981\u6216\u4e0d\u9700\u8981\u8fd4\u56de\u4efb\u4f55\u8cc7\u6599\uff0c\u5728\u9019\u7a2e\u60c5\u6cc1\u4e0b\uff0c\u4f60\u53ef\u4ee5\u53ea\u505a\u4e00\u500b\u666e\u901a\u67e5\u8a62\uff1a $db = \\XF::db(); $db->query('DELETE FROM xf_user WHERE user_id = ?', 1); \u7db1\u8981\u7ba1\u7406 \u00b6 XF2 \u5305\u542b\u4e86\u4e00\u7a2e\u5168\u65b0\u7684\u7ba1\u7406\u8cc7\u6599\u5eab\u6a21\u5f0f\u7684\u65b9\u5f0f\uff0c\u5b83\u63a1\u7528\u7269\u4ef6\u5c0e\u5411\u7684\u65b9\u5f0f\u4f86\u57f7\u884c\u67d0\u4e9b\u8868\u7684\u64cd\u4f5c\u3002 \u8b93\u6211\u5011\u5148\u770b\u770b\u50b3\u7d71\u7684\u6539\u8b8a\uff0c\u4f7f\u7528\u8cc7\u6599\u5eab\u9069\u914d\u5668\uff0c\u5c31\u50cf\u6211\u5011\u4e0a\u9762\u7684\u90a3\u6a23\u3002 $db = \\XF::db(); $db->query(\" ALTER TABLE xf_some_existing_table ADD COLUMN new_column INT(10) UNSIGNED NOT NULL DEFAULT 0, MODIFY COLUMN some_existing_column varchar(250) NOT NULL DEFAULT '' \"); \u6211\u5011\u4e5f\u4f86\u770b\u770b\u4e00\u500b\u5178\u578b\u7684\u5efa\u7acb\u8cc7\u6599\u8868\u67e5\u8a62\uff1a $db = \\XF::db(); $sm = $db->getSchemaManager(); $defaultTableConfig = $sm->getTableConfigSql(); $db->query(\" CREATE TABLE xf_some_table ( some_id INT(10) UNSIGNED NOT NULL AUTO_INCREMENT, some_name VARCHAR(50) NOT NULL, PRIMARY KEY (user_id) ) {$defaultTableConfig} \"); \u5728 XF2 \u4e2d\uff0c\u53e6\u4e00\u7a2e\u548c\u9996\u9078\u7684\u65b9\u6cd5\u662f\u4f7f\u7528\u65b0\u7684 SchemaManager \u7269\u4ef6\u3002 \u8b93\u6211\u5011\u4f86\u770b\u770b\u9019\u5169\u500b\u7531\u6a21\u5f0f\u7ba1\u7406\u5668\u57f7\u884c\u7684\u67e5\u8a62\uff0c\u9996\u5148\u662f alter\uff1a $sm = \\XF::db()->getSchemaManager(); $sm->alterTable('xf_some_existing_table', function(\\XF\\Db\\Schema\\Alter $table) { $table->addColumn('new_column', 'int')->setDefault(0); $table->changeColumn('some_existing_column')->length(250); }); \u9084\u6709\u8cc7\u6599\u8868\u7684\u5efa\u7acb\uff1a $sm = \\XF::db()->getSchemaManager(); $sm->createTable('xf_some_table', function(\\XF\\Db\\Schema\\Create $table) { $table->addColumn('some_id', 'int')->autoIncrement(); $table->addColumn('some_name', 'varchar', 50); }); Warning \u7576\u60a8\u66f4\u6539\u73fe\u6709\u7684 XenForo \u8cc7\u6599\u8868\u6216\u5efa\u7acb\u81ea\u5df1\u7684\u8cc7\u6599\u8868\u6642\uff0c \u5fc5\u9808 \u6307\u5b9a\u4e00\u500b\u9810\u8a2d\u503c\uff0c\u5426\u5247\u5728\u67e5\u8a62\u8cc7\u6599\u8868\u6642\u5c07\u6703\u9047\u5230\u554f\u984c\u3002 \u9019\u5169\u500b\u4f8b\u5b50\u7522\u751f\u7684\u67e5\u8a62\u7d50\u679c\u548c\u4e0a\u9762\u66f4\u76f4\u63a5\u7684\u4f8b\u5b50\u5b8c\u5168\u4e00\u6a23\u3002 \u4e0d\u904e\u4f60\u53ef\u80fd\u6703\u6ce8\u610f\u5230\uff0c\u6709\u4e9b\u6771\u897f\u662f\uff08\u6545\u610f\uff09\u907a\u6f0f\u7684\u3002 \u4f8b\u5982\uff0c\u6c92\u6709\u4e00\u500b\u4f8b\u5b50\u70ba int \u6b04\u4f4d\u6307\u5b9a\u4e00\u500b\u9577\u5ea6\u3002 \u9019\u53ea\u662f\u56e0\u70ba\u7701\u7565\u4e86\u9019\u4e00\u9ede\uff0cMySQL \u6703\u7d66\u5b83\u63d0\u4f9b\u4e00\u500b\u9810\u8a2d\u503c\uff0c\u5c0d\u65bc\u7121\u7b26\u865f\u6574\u6578\u4f86\u8aaa\u662f 10\u3002\u8aaa\u5230\u9019\u88e1\uff0c\u6211\u5011\u4e5f\u6c92\u6709\u6307\u5b9a some_id column \u662f\u7121\u7b26\u865f\u7684\u3002 \u5728 XF \u5167\u4f7f\u7528\u7121\u7b26\u865f\u6574\u6578\u662f\u76ee\u524d\u6700\u5e38\u898b\u7684\u4f7f\u7528\u6848\u4f8b\uff0c\u6240\u4ee5\u6703\u81ea\u52d5\u65b0\u589e\u3002 \u5982\u679c\u4f60\u771f\u6b63\u9700\u8981\u652f\u6301\u8ca0\u6574\u6578\u7684\u80fd\u529b\uff0c\u4f60\u53ef\u4ee5\u7528 ->unsigned(false) \u65b9\u6cd5\u53cd\u904e\u4f86\u3002 \u53e6\u4e00\u500b\u907a\u6f0f\u662f\u6c92\u6709\u70ba\u6240\u6709\u7684\u6771\u897f\u5b9a\u7fa9 NOT NULL \u3002 \u540c\u6a23\uff0c\u9019\u662f\u81ea\u52d5\u61c9\u7528\u7684\uff0c\u4f46\u4f60\u53ef\u4ee5\u7528 ->nullable(true) \u4f86\u626d\u8f49\u9019\u7a2e\u60c5\u6cc1\u3002 \u5f9e alter \u7684\u4f8b\u5b50\u4e2d\u53ef\u80fd\u770b\u4e0d\u6e05\u695a\uff0c\u4f46\u662f\u7576\u6539\u8b8a\u73fe\u6709\u7684\u6b04\u4f4d\u6642\uff0c\u73fe\u6709\u7684\u6b04\u4f4d\u5b9a\u7fa9\u6703\u81ea\u52d5\u4fdd\u7559\u3002 \u9019\u610f\u5473\u8457\uff0c\u4f60\u4e0d\u5fc5\u6307\u5b9a\u6574\u500b column \u7684\u5b9a\u7fa9\uff0c\u5305\u62ec\u6240\u6709\u6c92\u6709\u5be6\u969b\u6539\u8b8a\u7684\u90e8\u5206\uff0c\u4f60\u53ef\u4ee5\u53ea\u6307\u5b9a\u4f60\u8981\u6539\u8b8a\u7684\u90e8\u5206\u3002 \u95dc\u65bc Primary Key\uff0c\u9084\u6709\u4e00\u4e9b\u5176\u4ed6\u7684\u81ea\u52d5\u63a8\u65b7\u3002 \u5982\u679c\u4f60\u9858\u610f\u7684\u8a71\uff0c\u4f60\u53ef\u4ee5\u660e\u78ba\u5730\u5b9a\u7fa9 Primary Key\uff08\u6216\u4efb\u4f55\u5176\u4ed6\u985e\u578b\u7684 Key \uff09\uff0c\u4f46\u901a\u5e38\u81ea\u52d5\u905e\u589e\u7684\u6b04\u4f4d\u901a\u5e38\u6703\u6210\u70ba\u4f60\u7684\u8cc7\u6599\u8868\u7684 Primary Key\u3002 \u6240\u4ee5\u5728\u5efa\u7acb\u8cc7\u6599\u8868\u7684\u4f8b\u5b50\u4e2d\uff0c some_id \u6b04\u4f4d\u88ab\u81ea\u52d5\u5206\u914d\u70ba\u8a72\u8cc7\u6599\u8868\u7684 Primary Key\u3002 \u6700\u5f8c\uff0c\u5c0d\u65bc\u5efa\u7acb\u8cc7\u6599\u8868\u7684\u65b9\u6cd5\uff0c\u6211\u5011\u53ef\u4ee5\u70ba\u6307\u5b9a\u7684\u5132\u5b58\u5f15\u64ce\u81ea\u52d5\u65b0\u589e\u6b63\u78ba\u7684\u8cc7\u6599\u8868\u8a2d\u5b9a\uff08\u9810\u8a2d\u70ba InnoDB \uff0c\u4f46\u53ef\u4ee5\u5f88\u5bb9\u6613\u5730\u6539\u8b8a\u70ba\u5176\u4ed6\u5f15\u64ce\u985e\u578b\uff09\u3002","title":"\u7ba1\u7406 Schema"},{"location":"managing-the-schema/#schema","text":"\u6211\u5011\u5df2\u7d93\u770b\u4e86\u4e00\u4e9b\u53ef\u7528\u65bc\u8207\u8cc7\u6599\u4ea4\u4e92\u7684\u65b0\u65b9\u6cd5\u3002 \u7576\u7136\uff0c\u5728\u4e00\u4e9b\u7279\u5b9a\u60c5\u6cc1\u4e0b\uff0c\u53ef\u80fd\u9700\u8981\u76f4\u63a5\u8207\u8cc7\u6599\u5eab\u9032\u884c\u4ea4\u4e92\u3002","title":"\u7ba1\u7406 Schema"},{"location":"managing-the-schema/#_1","text":"XF2 \u4e2d\u9810\u8a2d\u7684\u8cc7\u6599\u5eab\u9069\u914d\u5668\u662f\u57fa\u65bc MySQL \u548c PHP \u7684 mysqli \u64f4\u5c55\u3002 \u5728\u4efb\u4f55 XF \u985e\u4e2d\u90fd\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u65b9\u6cd5\u8a2a\u554f\u8a2d\u5b9a\u7684\u8cc7\u6599\u5eab\u9069\u914d\u5668\uff1a $db = \\XF::db(); \u9069\u914d\u5668\u6709\u8a31\u591a\u53ef\u7528\u7684\u65b9\u6cd5\uff0c\u9019\u4e9b\u65b9\u6cd5\u5c07\u57f7\u884c\u4e00\u500b SQL \u67e5\u8a62\uff0c\u7136\u5f8c\u5c07\u7d50\u679c\u683c\u5f0f\u5316\u70ba\u4e00\u500b\u9663\u5217\u3002 \u4f8b\u5982\uff0c\u8981\u8a2a\u554f\u4e00\u500b\u7528\u6236\u8a18\u9304\uff1a $db = \\XF::db(); $user = $db->fetchRow('SELECT * FROM xf_user WHERE user_id = ?', 1); $user \u8b8a\u6578\u73fe\u5728\u5c07\u5305\u542b\u4e00\u500b\u9663\u5217\uff0c\u5176\u4e2d\u5305\u542b\u67e5\u8a62\u7d50\u679c\u96c6\u4e2d\u7b2c\u4e00\u884c\u7684\u6240\u6709\u503c\u3002 \u8981\u60f3\u5f9e\u8a72\u67e5\u8a62\u4e2d\u7372\u5f97\u55ae\u4e00\u7684\u503c\uff0c\u4f8b\u5982\u7528\u6236\u540d\uff0c\u53ef\u4ee5\u57f7\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a $username = $user['username']; Warning \u76f4\u63a5\u7de8\u5beb\u4e26\u50b3\u905e\u7d66\u8cc7\u6599\u5eab\u9069\u914d\u5668\u7684\u8cc7\u6599\u5eab\u67e5\u8a62\u4e26\u975e\u81ea\u52d5 \"\u5b89\u5168\"\u3002 \u5982\u679c\u7528\u6236\u7684\u8f38\u5165\u6c92\u6709\u7d93\u904e\u6e05\u9664\uff0c\u4e26\u4e14\u6c92\u6709\u7d93\u904e\u6e96\u5099\u5c31\u50b3\u5165\u67e5\u8a62\uff0c\u5b83\u5011\u5c31\u6703\u5e36\u4f86 SQL \u96b1\u78bc\u653b\u64ca\u6f0f\u6d1e\u7684\u98a8\u96aa\u3002 \u6b63\u78ba\u7684\u65b9\u6cd5\u662f\u4f7f\u7528\u6e96\u5099\u597d\u7684\u8a9e\u53e5\uff0c\u5c31\u50cf\u4e0a\u9762\u7684\u4f8b\u5b50\u4e00\u6a23\u3002 \u5728\u67e5\u8a62\u672c\u8eab\u4e2d\u4f7f\u7528 ? \u4f54\u4f4d\u7b26\u4f86\u8868\u793a\u53c3\u6578\u3002 \u9019\u4e9b\u4f54\u4f4d\u7b26\u7d93\u904e\u9069\u7576\u7684\u8f49\u7fa9\u5f8c\uff0c\u6703\u88ab\u4e0b\u4e00\u500b\u53c3\u6578\u4e2d\u7684\u503c\u66ff\u63db\u3002 \u5982\u679c\u4f60\u9700\u8981\u4f7f\u7528\u7684\u53c3\u6578\u4e0d\u6b62\u4e00\u500b\uff0c\u90a3\u61c9\u8a72\u4ee5\u9663\u5217\u7684\u5f62\u5f0f\u50b3\u905e\u5230 fetch \u985e\u578b\u65b9\u6cd5\u4e2d\u3002 \u5982\u6709\u5fc5\u8981\uff0c\u4f60\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528 $db->quote($value) \u5c0d\u503c\u9032\u884c\u8f49\u7fa9\u6216\u5f15\u7528\u3002 \u60a8\u53ef\u4ee5 \u5728\u9019\u88e1 \u627e\u5230\u66f4\u591a\u95dc\u65bc\u6e96\u5099\u597d\u7684\u8a9e\u53e5\u8cc7\u8a0a\u3002 \u4e5f\u53ef\u4ee5\u5f9e\u4e00\u689d\u8a18\u9304\u4e2d\u67e5\u8a62\u4e00\u500b\u503c\u3002 \u4f8b\u5982\uff1a $db = \\XF::db(); $username = $db->fetchOne('SELECT username FROM xf_user WHERE user_id = ?', 1); \u5982\u679c\u4f60\u6709\u4e00\u500b\u9700\u8981\u8fd4\u56de\u591a\u689d\u8a18\u9304\u7684\u67e5\u8a62\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528 fetchAll \uff1a $db = \\XF::db(); $users = $db->fetchAll('SELECT * FROM xf_user LIMIT 10'); \u6216\u8005 fetchAllKeyed \uff1a $db = \\XF::db(); $users = $db->fetchAllKeyed('SELECT * FROM xf_user LIMIT 10', 'user_id'); \u9019\u5169\u7a2e\u65b9\u6cd5\u90fd\u5c07\u8fd4\u56de\u4e00\u500b\u4ee3\u8868\u6bcf\u500b\u7528\u6236\u8a18\u9304\u7684\u9663\u5217\u3002 fetchAll \u548c fetchAllKeyed \u65b9\u6cd5\u4e4b\u9593\u7684\u5340\u5225\u662f\uff0c\u8fd4\u56de\u7684\u9663\u5217\u7684 key \u503c\u4e0d\u540c\u3002 \u4f7f\u7528 fetchAll \u65b9\u6cd5\u6642\uff0c\u9663\u5217\u5c07\u7528\u9023\u7e8c\u7684\u6578\u5b57\u6574\u6578\u9032\u884c key \u9396\u5b9a\u3002 \u7528 fetchAllKeyed \u65b9\u6cd5\uff0c\u9663\u5217\u5c07\u7528\u7b2c\u4e8c\u500b\u53c3\u6578\u4e2d\u547d\u540d\u7684\u6b04\u4f4d\u540d\u9032\u884c key \u9396\u5b9a\u3002 Note \u5982\u679c\u4f60\u4f7f\u7528 fetchAllKeyed \uff0c\u8acb\u6ce8\u610f\u7b2c\u4e8c\u500b\u53c3\u6578\u662f\u8981\u5c0d\u9663\u5217\u9032\u884c key \u9396\u5b9a\u7684\u6b04\u4f4d\uff0c\u4f46 \u7b2c\u4e09\u500b \u53c3\u6578\u662f\u4f60\u50b3\u905e param \u503c\u4ee5\u5339\u914d ? \u4f54\u4f4d\u7b26\u7684\u5730\u65b9\u3002 \u9084\u6709\u4e00\u4e9b\u5176\u4ed6\u7372\u53d6\u985e\u578b\u7684\u65b9\u6cd5\uff0c\u5305\u62ec fetchAllColumn \uff0c\u7528\u65bc\u5f9e\u6240\u6709\u8fd4\u56de\u7684 rows \u4e2d\u6293\u53d6\u4e00\u500b\u7279\u5b9a column \u7684\u503c\u7684\u9663\u5217\uff1a $db = \\XF::db(); $usernames = $db->fetchAllColumn('SELECT username FROM xf_user LIMIT 10'); \u4e0a\u9762\u7684\u4f8b\u5b50\u5c07\u8fd4\u56de\u4e00\u500b\u5f9e\u7d50\u679c\u67e5\u8a62\u4e2d\u627e\u5230\u7684 10 \u500b\u7528\u6236\u540d\u7684\u9663\u5217\u3002 \u6700\u5f8c\uff0c\u4f60\u53ef\u80fd\u4e26\u4e0d\u60f3\u8981\u6216\u4e0d\u9700\u8981\u8fd4\u56de\u4efb\u4f55\u8cc7\u6599\uff0c\u5728\u9019\u7a2e\u60c5\u6cc1\u4e0b\uff0c\u4f60\u53ef\u4ee5\u53ea\u505a\u4e00\u500b\u666e\u901a\u67e5\u8a62\uff1a $db = \\XF::db(); $db->query('DELETE FROM xf_user WHERE user_id = ?', 1);","title":"\u8cc7\u6599\u5eab\u9069\u914d\u5668"},{"location":"managing-the-schema/#_2","text":"XF2 \u5305\u542b\u4e86\u4e00\u7a2e\u5168\u65b0\u7684\u7ba1\u7406\u8cc7\u6599\u5eab\u6a21\u5f0f\u7684\u65b9\u5f0f\uff0c\u5b83\u63a1\u7528\u7269\u4ef6\u5c0e\u5411\u7684\u65b9\u5f0f\u4f86\u57f7\u884c\u67d0\u4e9b\u8868\u7684\u64cd\u4f5c\u3002 \u8b93\u6211\u5011\u5148\u770b\u770b\u50b3\u7d71\u7684\u6539\u8b8a\uff0c\u4f7f\u7528\u8cc7\u6599\u5eab\u9069\u914d\u5668\uff0c\u5c31\u50cf\u6211\u5011\u4e0a\u9762\u7684\u90a3\u6a23\u3002 $db = \\XF::db(); $db->query(\" ALTER TABLE xf_some_existing_table ADD COLUMN new_column INT(10) UNSIGNED NOT NULL DEFAULT 0, MODIFY COLUMN some_existing_column varchar(250) NOT NULL DEFAULT '' \"); \u6211\u5011\u4e5f\u4f86\u770b\u770b\u4e00\u500b\u5178\u578b\u7684\u5efa\u7acb\u8cc7\u6599\u8868\u67e5\u8a62\uff1a $db = \\XF::db(); $sm = $db->getSchemaManager(); $defaultTableConfig = $sm->getTableConfigSql(); $db->query(\" CREATE TABLE xf_some_table ( some_id INT(10) UNSIGNED NOT NULL AUTO_INCREMENT, some_name VARCHAR(50) NOT NULL, PRIMARY KEY (user_id) ) {$defaultTableConfig} \"); \u5728 XF2 \u4e2d\uff0c\u53e6\u4e00\u7a2e\u548c\u9996\u9078\u7684\u65b9\u6cd5\u662f\u4f7f\u7528\u65b0\u7684 SchemaManager \u7269\u4ef6\u3002 \u8b93\u6211\u5011\u4f86\u770b\u770b\u9019\u5169\u500b\u7531\u6a21\u5f0f\u7ba1\u7406\u5668\u57f7\u884c\u7684\u67e5\u8a62\uff0c\u9996\u5148\u662f alter\uff1a $sm = \\XF::db()->getSchemaManager(); $sm->alterTable('xf_some_existing_table', function(\\XF\\Db\\Schema\\Alter $table) { $table->addColumn('new_column', 'int')->setDefault(0); $table->changeColumn('some_existing_column')->length(250); }); \u9084\u6709\u8cc7\u6599\u8868\u7684\u5efa\u7acb\uff1a $sm = \\XF::db()->getSchemaManager(); $sm->createTable('xf_some_table', function(\\XF\\Db\\Schema\\Create $table) { $table->addColumn('some_id', 'int')->autoIncrement(); $table->addColumn('some_name', 'varchar', 50); }); Warning \u7576\u60a8\u66f4\u6539\u73fe\u6709\u7684 XenForo \u8cc7\u6599\u8868\u6216\u5efa\u7acb\u81ea\u5df1\u7684\u8cc7\u6599\u8868\u6642\uff0c \u5fc5\u9808 \u6307\u5b9a\u4e00\u500b\u9810\u8a2d\u503c\uff0c\u5426\u5247\u5728\u67e5\u8a62\u8cc7\u6599\u8868\u6642\u5c07\u6703\u9047\u5230\u554f\u984c\u3002 \u9019\u5169\u500b\u4f8b\u5b50\u7522\u751f\u7684\u67e5\u8a62\u7d50\u679c\u548c\u4e0a\u9762\u66f4\u76f4\u63a5\u7684\u4f8b\u5b50\u5b8c\u5168\u4e00\u6a23\u3002 \u4e0d\u904e\u4f60\u53ef\u80fd\u6703\u6ce8\u610f\u5230\uff0c\u6709\u4e9b\u6771\u897f\u662f\uff08\u6545\u610f\uff09\u907a\u6f0f\u7684\u3002 \u4f8b\u5982\uff0c\u6c92\u6709\u4e00\u500b\u4f8b\u5b50\u70ba int \u6b04\u4f4d\u6307\u5b9a\u4e00\u500b\u9577\u5ea6\u3002 \u9019\u53ea\u662f\u56e0\u70ba\u7701\u7565\u4e86\u9019\u4e00\u9ede\uff0cMySQL \u6703\u7d66\u5b83\u63d0\u4f9b\u4e00\u500b\u9810\u8a2d\u503c\uff0c\u5c0d\u65bc\u7121\u7b26\u865f\u6574\u6578\u4f86\u8aaa\u662f 10\u3002\u8aaa\u5230\u9019\u88e1\uff0c\u6211\u5011\u4e5f\u6c92\u6709\u6307\u5b9a some_id column \u662f\u7121\u7b26\u865f\u7684\u3002 \u5728 XF \u5167\u4f7f\u7528\u7121\u7b26\u865f\u6574\u6578\u662f\u76ee\u524d\u6700\u5e38\u898b\u7684\u4f7f\u7528\u6848\u4f8b\uff0c\u6240\u4ee5\u6703\u81ea\u52d5\u65b0\u589e\u3002 \u5982\u679c\u4f60\u771f\u6b63\u9700\u8981\u652f\u6301\u8ca0\u6574\u6578\u7684\u80fd\u529b\uff0c\u4f60\u53ef\u4ee5\u7528 ->unsigned(false) \u65b9\u6cd5\u53cd\u904e\u4f86\u3002 \u53e6\u4e00\u500b\u907a\u6f0f\u662f\u6c92\u6709\u70ba\u6240\u6709\u7684\u6771\u897f\u5b9a\u7fa9 NOT NULL \u3002 \u540c\u6a23\uff0c\u9019\u662f\u81ea\u52d5\u61c9\u7528\u7684\uff0c\u4f46\u4f60\u53ef\u4ee5\u7528 ->nullable(true) \u4f86\u626d\u8f49\u9019\u7a2e\u60c5\u6cc1\u3002 \u5f9e alter \u7684\u4f8b\u5b50\u4e2d\u53ef\u80fd\u770b\u4e0d\u6e05\u695a\uff0c\u4f46\u662f\u7576\u6539\u8b8a\u73fe\u6709\u7684\u6b04\u4f4d\u6642\uff0c\u73fe\u6709\u7684\u6b04\u4f4d\u5b9a\u7fa9\u6703\u81ea\u52d5\u4fdd\u7559\u3002 \u9019\u610f\u5473\u8457\uff0c\u4f60\u4e0d\u5fc5\u6307\u5b9a\u6574\u500b column \u7684\u5b9a\u7fa9\uff0c\u5305\u62ec\u6240\u6709\u6c92\u6709\u5be6\u969b\u6539\u8b8a\u7684\u90e8\u5206\uff0c\u4f60\u53ef\u4ee5\u53ea\u6307\u5b9a\u4f60\u8981\u6539\u8b8a\u7684\u90e8\u5206\u3002 \u95dc\u65bc Primary Key\uff0c\u9084\u6709\u4e00\u4e9b\u5176\u4ed6\u7684\u81ea\u52d5\u63a8\u65b7\u3002 \u5982\u679c\u4f60\u9858\u610f\u7684\u8a71\uff0c\u4f60\u53ef\u4ee5\u660e\u78ba\u5730\u5b9a\u7fa9 Primary Key\uff08\u6216\u4efb\u4f55\u5176\u4ed6\u985e\u578b\u7684 Key \uff09\uff0c\u4f46\u901a\u5e38\u81ea\u52d5\u905e\u589e\u7684\u6b04\u4f4d\u901a\u5e38\u6703\u6210\u70ba\u4f60\u7684\u8cc7\u6599\u8868\u7684 Primary Key\u3002 \u6240\u4ee5\u5728\u5efa\u7acb\u8cc7\u6599\u8868\u7684\u4f8b\u5b50\u4e2d\uff0c some_id \u6b04\u4f4d\u88ab\u81ea\u52d5\u5206\u914d\u70ba\u8a72\u8cc7\u6599\u8868\u7684 Primary Key\u3002 \u6700\u5f8c\uff0c\u5c0d\u65bc\u5efa\u7acb\u8cc7\u6599\u8868\u7684\u65b9\u6cd5\uff0c\u6211\u5011\u53ef\u4ee5\u70ba\u6307\u5b9a\u7684\u5132\u5b58\u5f15\u64ce\u81ea\u52d5\u65b0\u589e\u6b63\u78ba\u7684\u8cc7\u6599\u8868\u8a2d\u5b9a\uff08\u9810\u8a2d\u70ba InnoDB \uff0c\u4f46\u53ef\u4ee5\u5f88\u5bb9\u6613\u5730\u6539\u8b8a\u70ba\u5176\u4ed6\u5f15\u64ce\u985e\u578b\uff09\u3002","title":"\u7db1\u8981\u7ba1\u7406"},{"location":"rest-api/","text":"REST API \u00b6 \u5728 XenForo 2.1 \u4e2d\uff0c\u6dfb\u52a0\u4e86 REST API\u3002\u9019\u4f7f\u60a8\u53ef\u4ee5\u901a\u904e\u7de8\u7a0b\u7684\u65b9\u5f0f\u8207 XenForo \u5b89\u88dd\u7684\u8a31\u591a\u5340\u57df\u9032\u884c\u4ea4\u4e92\u3002 \u8981\u8a2a\u554f API\uff0c\u9700\u8981\u901a\u904e\u7ba1\u7406\u54e1\u63a7\u5236\u9762\u677f\u7522\u751f\u5bc6\u9470\u3002\u672a\u7d93\u8a8d\u8b49\u7684 API \u6c92\u6709\u8fa6\u6cd5\u8a2a\u554f\uff0c\u6b64\u6642\u7528\u6236\u4e5f\u4e0d\u80fd\u81ea\u5df1\u7522\u751f\u5bc6\u9470\u4f86\u8a2a\u554f API\u3002 \u7279\u5b9a XenForo \u5b89\u88dd\u7684 API \u53ef\u901a\u904e <XenForo \u57fa\u672c URL>/api/ \u8a2a\u554f\u3002\u6240\u6709\u7aef\u9ede\u90fd\u4ee5\u8a72 URL \u70ba\u524d\u7db4\u3002\u4f8b\u5982\uff0c\u5982\u679c XenForo \u5b89\u88dd\u5728 https://example.com/community/ \uff0c\u90a3\u9ebcAPI URL\u5c07\u4ee5 https://example.com/community/api/ \u958b\u982d\u3002\u5728\u672c\u4f8b\u4e2d\uff0c\u8a2a\u554f\u57f7\u884c\u7dd2\u5217\u8868\u53ef\u901a\u904e https://example.com/community/api/threads/ \u9032\u884c\u3002 \u9ed8\u8a8d\u60c5\u6cc1\u4e0b API \u662f\u555f\u7528\u7684\u3002\u5982\u679c\u9700\u8981\uff0c\u53ef\u4ee5\u901a\u904e\u5728 src/config.php \u4e2d\u6dfb\u52a0\u4ee5\u4e0b\u5167\u5bb9\u4f86\u5feb\u901f\u95dc\u9589\u6240\u6709 API \u8a2a\u554f\uff1a $config['enableApi'] = false; API \u5bc6\u9470 \u00b6 \u901a\u904e\u7ba1\u7406\u54e1\u63a7\u5236\u9762\u677f\u5230 \u8a2d\u5b9a > API \u5bc6\u9470 \u5efa\u7acb API \u5bc6\u9470\u3002 \u7531\u65bc\u7522\u751f API \u5bc6\u9470\u53ef\u4ee5\u5141\u8a31\u8a2a\u554f\u9ad8\u5ea6\u7279\u6b0a\u7684\u8cc7\u6599\uff0c\u56e0\u6b64\u53ea\u6709\u8d85\u7d1a\u7ba1\u7406\u54e1\u53ef\u4ee5\u8a2a\u554f\u672c\u7cfb\u7d71\u3002 \u7576\u7522\u751f API \u5bc6\u9470\u6642\uff0c\u6240\u6709\u8d85\u7d1a\u7ba1\u7406\u54e1\u90fd\u6703\u6536\u5230\u4e00\u5c01\u90f5\u4ef6\uff0c\u4ee5\u78ba\u4fdd\u8acb\u6c42\u6709\u6548\u3002 \u5275\u5efa\u5bc6\u9470\u5f8c\uff0c\u5c07\u751f\u6210\u4e00\u500b\u96a8\u6a5f\u5b57\u4e32\uff0c\u8a72\u5b57\u4e32\u5c07\u7528\u65bc\u901a\u904e API \u9032\u884c\u8eab\u4efd\u9a57\u8b49\u3002 \u5c07\u6b64\u5bc6\u9470\u4fdd\u5bc6\u662f\u5f88\u91cd\u8981\u7684\u3002 \u5982\u679c\u60a8\u8a8d\u70ba API \u5bc6\u9470\u5df2\u88ab\u76dc\u7528\uff0c\u4f60\u61c9\u8a72\u7acb\u5373\u91cd\u65b0\u751f\u6210\u65b0\u7684\u5bc6\u9470\u4e26\u66f4\u65b0\u4efb\u4f55\u4f7f\u7528\u820a\u5bc6\u9470\u7684\u7a0b\u5f0f\u78bc\u3002 \u5bc6\u9470\u985e\u578b \u00b6 \u6240\u6709\u7684 API \u8a2a\u554f\u90fd\u662f\u5728\u7279\u5b9a\u7528\u6236\u7684 Context \u4e2d\u9032\u884c\u7684\u3002 \u4f8b\u5982\uff0c\u5982\u679c\u6211\u4ee5 \"John\" \u7684\u8eab\u4efd\u8a2a\u554f API\uff0c\u4e26\u4e14\u6211\u63d0\u51fa\u4e86\u4e00\u500b\u767c\u4f48\u4e3b\u984c\u7684\u8acb\u6c42\uff0c\u90a3\u9ebc\u9019\u500b\u4e3b\u984c\u5c07\u7531 \"John\" \u5efa\u7acb\u3002 \u5728\u5927\u591a\u6578\u60c5\u6cc1\u4e0b\uff0cAPI \u4e5f\u6703\u9075\u5b88\u70ba\u9019\u500b\u7528\u6236\u6307\u5b9a\u5c0d\u61c9\u7684\u6b0a\u9650\uff0c\u6240\u4ee5\u4ed6\u5011\u4e0d\u80fd\u8a2a\u554f\u4ed6\u5011\u5728\u6b63\u5e38\u700f\u89bd\u8ad6\u58c7\u6642\u770b\u4e0d\u5230\u7684\u8cc7\u6599\u3002 \u70ba\u4e86\u5c0d\u6b64\u9032\u884c\u63a7\u5236\uff0c\u5171\u6709\u4e09\u7a2e\u985e\u578b\u7684 API \u5bc6\u9470\uff1a \u8a2a\u5ba2\u5bc6\u9470 - \u6b64\u5bc6\u9470\u7e3d\u662f\u4ee5\u8a2a\u5ba2\u7528\u6236\u8eab\u4efd\u5b58\u53d6 API\u3002\u9019\u4e9b\u8acb\u6c42\u5c07\u59cb\u7d42\u9075\u5b88\u8a2a\u5ba2\u7684\u6b0a\u9650\u3002\u4f8b\u5982\uff0c\u5982\u679c\u5ba2\u4eba\u4e0d\u80fd\u56de\u8986\u4e3b\u984c\uff0c\u90a3\u9ebc\u56de\u8986\u4e3b\u984c\u7684 API \u8acb\u6c42\u5c07\u7522\u751f\u4e00\u500b\u6c92\u6709\u6b0a\u9650\u7684\u932f\u8aa4\u3002 \u7528\u6236\u5bc6\u9470 - \u9019\u500b\u5bc6\u9470\u7e3d\u662f\u4ee5\u6307\u5b9a\u7528\u6236\u7684\u8eab\u4efd\u8a2a\u554f API\uff0c\u4e26\u59cb\u7d42\u9075\u5b88\u8a72\u7528\u6236\u7684\u6b0a\u9650\uff0c\u985e\u4f3c\u65bc\u8a2a\u5ba2\u5bc6\u9470\u3002 \u8d85\u7d1a\u7528\u6236\u5bc6\u9470 - \u9019\u500b\u5bc6\u9470\u53ef\u4ee5\u901a\u904e\u50b3\u905e\u4e00\u500b\u984d\u5916\u7684\u503c\uff0c\u4ee5\u4efb\u4f55\u7528\u6236\u7684\u8eab\u4efd\u8a2a\u554f API\u3002\uff08\u53ef\u9078\uff09\u6b64\u5bc6\u9470\u53ef\u4ee5\u7e5e\u904e\u7528\u6236\u767c\u51fa\u8acb\u6c42\u7684\u6b0a\u9650\uff0c\u5f9e\u800c\u5141\u8a31\u4ed6\u5011\u57f7\u884c\u64cd\u4f5c\u6216\u67e5\u770b\u901a\u5e38\u4e0d\u5177\u6709\u8a2a\u554f\u6b0a\u9650\u7684\u5167\u5bb9\u3002 \u8d85\u7d1a\u7528\u6236\u5bc6\u9470\u5c0d\u65bc\u8207\u5176\u4ed6\u7cfb\u7d71\u6216\u61c9\u7528\u7a0b\u5f0f\u7684\u6574\u5408\u975e\u5e38\u6709\u7528\u3002 \u4f8b\u5982\uff0c\u60a8\u53ef\u80fd\u6703\u8207\u7b2c\u4e09\u65b9 CMS \u6574\u5408\uff0c\u6bcf\u7576\u60a8\u767c\u4f48\u4e00\u7bc7\u65b0\u6587\u7ae0\u6642\uff0c\u8a72 CMS \u5c31\u6703\u5efa\u7acb\u4e00\u500b\u4e3b\u984c\u3002 \u9019\u7a2e\u985e\u578b\u7684\u5bc6\u9470\u5c07\u5141\u8a31\u60a8\u6839\u64da\u6587\u7ae0\u4f5c\u8005\u6216\u5728\u7528\u6236\u901a\u5e38\u4e0d\u80fd\u767c\u4f48\u7684\u8ad6\u58c7\u4e2d\u5efa\u7acb\u4e00\u500b\u4e0d\u540c\u7528\u6236\u7684\u4e3b\u984c\u3002 \u5bc6\u9470\u4f5c\u7528\u57df \u00b6 \u70ba\u4e86\u5e6b\u52a9\u9650\u5236\u88ab\u6d29\u9732\u7684\u5bc6\u9470\u6240\u9020\u6210\u7684\u640d\u5bb3\uff0c\u6bcf\u500b\u5bc6\u9470\u90fd\u53ef\u4ee5\u63a7\u5236\u5176\u53ef\u4ee5\u8a2a\u554f\u7684 API \u4f5c\u7528\u57df\u3002 \u4f5c\u7528\u57df\u9650\u5236\u4e86\u5c0d API \u5340\u57df\u7684\u8a2a\u554f\uff0c\u8207\u7528\u6236\u7684\u8acb\u6c42\u6b0a\u9650\u7121\u95dc\u3002 API \u4e2d\u7684\u6bcf\u500b\u7aef\u9ede\u90fd\u6703\u88ab\u4e00\u500b\u6216\u591a\u500b\u4f5c\u7528\u57df\u6240\u8986\u84cb\u3002\u5982\u679c API \u6c92\u6709\u88ab\u6388\u4e88\u4efb\u4f55\u9019\u4e9b\u4f5c\u7528\u57df\uff0c\u5247\u8acb\u6c42\u5c07\u5931\u6557\u3002 \u70ba\u4e86\u5b89\u5168\u8d77\u898b\uff0c\u6211\u5011\u5efa\u8b70\u60a8\u50c5\u70ba\u5bc6\u9470\u6388\u4e88\u6240\u9700\u7684\u4f5c\u7528\u57df\u3002\u5982\u679c\u60a8\u5728\u4ee5\u5f8c\u9700\u8981\u5176\u4ed6\u7684\u4f5c\u7528\u57df\uff0c\u5247\u53ef\u4ee5\u5728\u9700\u8981\u6642\u6dfb\u52a0\u5b83\u5011\u3002 \u8a2a\u554f API \u00b6 \u4e00\u65e6\u77e5\u9053\u8a2a\u554f API \u7684 URL \u4e26\u7372\u5f97\u5bc6\u9470\u5f8c\uff0c\u5c31\u53ef\u4ee5\u958b\u59cb\u5c0d\u5176\u767c\u51fa\u8acb\u6c42\u3002 \u6240\u6709\u7684 API Response \u90fd\u5c07\u4ee5 JSON \u683c\u5f0f\u8fd4\u56de\uff0c\u9664\u975e\u662f\u7279\u5225\u8981\u6c42\u4e8c\u9032\u5236\u6a94\u6848\uff08\u4f8b\u5982\uff0c\u4e0b\u8f09\u9644\u4ef6\u6642\uff09\u3002\u932f\u8aa4\u5c07\u8fd4\u56de\u4e00\u500b 400 \u7bc4\u570d\u5167\u7684 Response \u72c0\u614b\u78bc\u3002\u6210\u529f\u7684\u8acb\u6c42\u5c07\u8fd4\u56de\u4e00\u500b 200 \u72c0\u614b\u78bc\u3002\u96d6\u7136\u4e0d\u5e38\u7528\uff0c\u4f46\u91cd\u5b9a\u5411\u5c07\u8fd4\u56de\u4e00\u500b 300 \u7bc4\u570d\u7684\u72c0\u614b\u78bc\u3002 Request body \u5fc5\u9808\u4f7f\u7528 application/x-www-form-urlencoded \u7de8\u78bc\u767c\u9001\uff0c\u6216\u8005\uff0c\u5982\u679c\u662f\u4e0a\u50b3\u6a94\u6848\uff0c\u5247\u4f7f\u7528 multipart/form-data \u7de8\u78bc\u767c\u9001\u3002\u53c3\u6578\u4e5f\u53ef\u4ee5\u901a\u904e\u67e5\u8a62\u5b57\u4e32\u4f86\u50b3\u905e\u3002 \u6240\u6709 Request \u8cc7\u6599\u5fc5\u9808\u4f7f\u7528 UTF-8 \u5b57\u7b26\u96c6\u3002 Request \u5fc5\u9808\u901a\u904e XF-API-Key Header \u50b3\u905e\u8981\u4f7f\u7528\u7684 API \u5bc6\u9470\u3002\u6240\u6709 Request \u4e2d\u90fd\u5fc5\u9808\u6709\u9019\u500b\u5bc6\u9470\u3002 \u5982\u679c\u9078\u64c7\u7684 API \u5bc6\u9470\u662f\u8d85\u7d1a\u7528\u6236\u5bc6\u9470\uff0c\u4f60\u53ef\u4ee5\u901a\u904e XF-API-User Header \u50b3\u905e Context User \u7684\u7528\u6236ID\u3002 \u5982\u679c\u6c92\u6709\u50b3\u905e\u7528\u6236 ID\uff0cContext \u5c07\u9ed8\u8a8d\u70ba\u8a2a\u5ba2\u3002 \u5982\u679c Request \u662f\u7528\u8d85\u7d1a\u7528\u6236\u5bc6\u9470\u767c\u51fa\u7684\uff0c\u4e26\u4e14\u4f60\u5e0c\u671b\u7e5e\u904e Context User \u7684\u6b0a\u9650\uff0c\u5247\u53ef\u4ee5\u901a\u904e\u5c07 api_bypass_permissions \u53c3\u6578\u8a2d\u5b9a\u70ba 1 \u4f86\u5be6\u73fe\u3002(\u9019\u500b\u53c3\u6578\u53ef\u4ee5\u901a\u904e query string \u6216\u4f5c\u70ba Request body \u7684\u4e00\u90e8\u5206\u4f86\u9032\u884c\u50b3\u905e\u3002) \u932f\u8aa4\u8655\u7406 \u00b6 \u7576\u9047\u5230 Error \u6642\uff0cresponse \u72c0\u614b\u78bc\u5c07\u5728 400 \u7bc4\u570d\u5167\u3002\u6709\u6642\uff0c\u53ef\u80fd\u6703\u51fa\u73fe 500 \u7bc4\u570d\u7684\u932f\u8aa4\uff0c\u4e0d\u904e\u9019\u8868\u660e\u4f3a\u670d\u5668\u7121\u6cd5\u8655\u7406\u8a72 request\u3002 API \u53ef\u80fd\u88ab\u66ab\u6642\u95dc\u9589\uff0c\u6216\u8005\u767c\u751f\u4e86\u5176\u4ed6\u4f3a\u670d\u5668\u932f\u8aa4\u3002 \u932f\u8aa4\u8a0a\u606f\u5177\u6709\u6a19\u6e96\u683c\u5f0f\u3002 \u9019\u662f\u4e00\u500b\u4f8b\u5b50\uff1a { \"errors\": [ { \"code\": \"api_key_not_found\", \"message\": \"\u672a\u627e\u5230 Request \u4e2d\u63d0\u4f9b\u7684 API \u5bc6\u9470\u3002\", \"params\": [] } ] } \u6700\u4e0a\u5c64\u5c07\u662f\u4e00\u500b\u5e36\u6709 errors key \u7684\u7269\u4ef6\u3002\u9019\u5c07\u662f\u5305\u542b 1 \u500b\u6216\u591a\u500b entry \u7684\u9663\u5217\u3002\u6bcf\u500b entry \u90fd\u662f\u4e00\u500b\u7269\u4ef6\uff0c\u53c3\u6578\u5982\u4e0b\uff1a code - \u9019\u662f\u6a5f\u5668\u53ef\u4ee5\u8b80\u61c2\u7684\u932f\u8aa4\u78bc\u3002 \u6709\u8a31\u591a\u53ef\u80fd\u7684\u932f\u8aa4\u78bc\uff0c\u56e0\u70ba\u5b83\u5011\u53d6\u6c7a\u65bc\u60c5\u6cc1\u3002 message - \u4eba\u985e\u53ef\u4ee5\u8b80\u61c2\u7684\u932f\u8aa4\u8a0a\u606f\u3002 \u9019\u53ef\u80fd\u6703\u6539\u8b8a\uff0c\u4e5f\u53ef\u80fd\u6703\u88ab\u7ffb\u8b6f\uff0c\u4e0d\u61c9\u8a72\u7528\u65bc\u8b58\u5225\u932f\u8aa4\u985e\u578b\u3002 params - \u9019\u662f\u89f8\u767c\u932f\u8aa4\u76f8\u95dc\u7684 key-value \u53c3\u6578\u5217\u8868\u3002\u5b83\u5011\u53ef\u4ee5\u88dc\u5145\u932f\u8aa4\u78bc\u548c\u8a0a\u606f\uff0c\u4ee5\u63d0\u4f9b\u6709\u95dc\u932f\u8aa4\u7684\u66f4\u591a\u660e\u78ba\u7684\u8a73\u7d30\u8a0a\u606f\u3002 API \u7aef\u9ede \u00b6 \u8a72 API \u5177\u6709\u8a31\u591a Endpoints \u548c\u53ef\u4ee5\u63a1\u53d6\u7684\u63aa\u65bd\u3002\u5c07\u4f86\u53ef\u80fd\u6703\u65b0\u589e\u5176\u4ed6 Endpoint \u548c\u8cc7\u6599\u3002 \u67e5\u770b API \u7aef\u9ede\u6587\u4ef6 \u8a72 Endpoint \u6587\u4ef6\u662f\u6839\u64da API \u8cc7\u6599\u548c\u7a0b\u5f0f\u78bc\u4e2d\u7684\u8a3b\u91cb\u751f\u6210\u7684\u3002\u5b83\u5c07\u96a8\u8457\u6642\u9593\u7684\u63a8\u79fb\u9032\u884c\u64f4\u5c55\u548c\u66f4\u65b0\u3002","title":"REST API"},{"location":"rest-api/#rest-api","text":"\u5728 XenForo 2.1 \u4e2d\uff0c\u6dfb\u52a0\u4e86 REST API\u3002\u9019\u4f7f\u60a8\u53ef\u4ee5\u901a\u904e\u7de8\u7a0b\u7684\u65b9\u5f0f\u8207 XenForo \u5b89\u88dd\u7684\u8a31\u591a\u5340\u57df\u9032\u884c\u4ea4\u4e92\u3002 \u8981\u8a2a\u554f API\uff0c\u9700\u8981\u901a\u904e\u7ba1\u7406\u54e1\u63a7\u5236\u9762\u677f\u7522\u751f\u5bc6\u9470\u3002\u672a\u7d93\u8a8d\u8b49\u7684 API \u6c92\u6709\u8fa6\u6cd5\u8a2a\u554f\uff0c\u6b64\u6642\u7528\u6236\u4e5f\u4e0d\u80fd\u81ea\u5df1\u7522\u751f\u5bc6\u9470\u4f86\u8a2a\u554f API\u3002 \u7279\u5b9a XenForo \u5b89\u88dd\u7684 API \u53ef\u901a\u904e <XenForo \u57fa\u672c URL>/api/ \u8a2a\u554f\u3002\u6240\u6709\u7aef\u9ede\u90fd\u4ee5\u8a72 URL \u70ba\u524d\u7db4\u3002\u4f8b\u5982\uff0c\u5982\u679c XenForo \u5b89\u88dd\u5728 https://example.com/community/ \uff0c\u90a3\u9ebcAPI URL\u5c07\u4ee5 https://example.com/community/api/ \u958b\u982d\u3002\u5728\u672c\u4f8b\u4e2d\uff0c\u8a2a\u554f\u57f7\u884c\u7dd2\u5217\u8868\u53ef\u901a\u904e https://example.com/community/api/threads/ \u9032\u884c\u3002 \u9ed8\u8a8d\u60c5\u6cc1\u4e0b API \u662f\u555f\u7528\u7684\u3002\u5982\u679c\u9700\u8981\uff0c\u53ef\u4ee5\u901a\u904e\u5728 src/config.php \u4e2d\u6dfb\u52a0\u4ee5\u4e0b\u5167\u5bb9\u4f86\u5feb\u901f\u95dc\u9589\u6240\u6709 API \u8a2a\u554f\uff1a $config['enableApi'] = false;","title":"REST API"},{"location":"rest-api/#api","text":"\u901a\u904e\u7ba1\u7406\u54e1\u63a7\u5236\u9762\u677f\u5230 \u8a2d\u5b9a > API \u5bc6\u9470 \u5efa\u7acb API \u5bc6\u9470\u3002 \u7531\u65bc\u7522\u751f API \u5bc6\u9470\u53ef\u4ee5\u5141\u8a31\u8a2a\u554f\u9ad8\u5ea6\u7279\u6b0a\u7684\u8cc7\u6599\uff0c\u56e0\u6b64\u53ea\u6709\u8d85\u7d1a\u7ba1\u7406\u54e1\u53ef\u4ee5\u8a2a\u554f\u672c\u7cfb\u7d71\u3002 \u7576\u7522\u751f API \u5bc6\u9470\u6642\uff0c\u6240\u6709\u8d85\u7d1a\u7ba1\u7406\u54e1\u90fd\u6703\u6536\u5230\u4e00\u5c01\u90f5\u4ef6\uff0c\u4ee5\u78ba\u4fdd\u8acb\u6c42\u6709\u6548\u3002 \u5275\u5efa\u5bc6\u9470\u5f8c\uff0c\u5c07\u751f\u6210\u4e00\u500b\u96a8\u6a5f\u5b57\u4e32\uff0c\u8a72\u5b57\u4e32\u5c07\u7528\u65bc\u901a\u904e API \u9032\u884c\u8eab\u4efd\u9a57\u8b49\u3002 \u5c07\u6b64\u5bc6\u9470\u4fdd\u5bc6\u662f\u5f88\u91cd\u8981\u7684\u3002 \u5982\u679c\u60a8\u8a8d\u70ba API \u5bc6\u9470\u5df2\u88ab\u76dc\u7528\uff0c\u4f60\u61c9\u8a72\u7acb\u5373\u91cd\u65b0\u751f\u6210\u65b0\u7684\u5bc6\u9470\u4e26\u66f4\u65b0\u4efb\u4f55\u4f7f\u7528\u820a\u5bc6\u9470\u7684\u7a0b\u5f0f\u78bc\u3002","title":"API \u5bc6\u9470"},{"location":"rest-api/#_1","text":"\u6240\u6709\u7684 API \u8a2a\u554f\u90fd\u662f\u5728\u7279\u5b9a\u7528\u6236\u7684 Context \u4e2d\u9032\u884c\u7684\u3002 \u4f8b\u5982\uff0c\u5982\u679c\u6211\u4ee5 \"John\" \u7684\u8eab\u4efd\u8a2a\u554f API\uff0c\u4e26\u4e14\u6211\u63d0\u51fa\u4e86\u4e00\u500b\u767c\u4f48\u4e3b\u984c\u7684\u8acb\u6c42\uff0c\u90a3\u9ebc\u9019\u500b\u4e3b\u984c\u5c07\u7531 \"John\" \u5efa\u7acb\u3002 \u5728\u5927\u591a\u6578\u60c5\u6cc1\u4e0b\uff0cAPI \u4e5f\u6703\u9075\u5b88\u70ba\u9019\u500b\u7528\u6236\u6307\u5b9a\u5c0d\u61c9\u7684\u6b0a\u9650\uff0c\u6240\u4ee5\u4ed6\u5011\u4e0d\u80fd\u8a2a\u554f\u4ed6\u5011\u5728\u6b63\u5e38\u700f\u89bd\u8ad6\u58c7\u6642\u770b\u4e0d\u5230\u7684\u8cc7\u6599\u3002 \u70ba\u4e86\u5c0d\u6b64\u9032\u884c\u63a7\u5236\uff0c\u5171\u6709\u4e09\u7a2e\u985e\u578b\u7684 API \u5bc6\u9470\uff1a \u8a2a\u5ba2\u5bc6\u9470 - \u6b64\u5bc6\u9470\u7e3d\u662f\u4ee5\u8a2a\u5ba2\u7528\u6236\u8eab\u4efd\u5b58\u53d6 API\u3002\u9019\u4e9b\u8acb\u6c42\u5c07\u59cb\u7d42\u9075\u5b88\u8a2a\u5ba2\u7684\u6b0a\u9650\u3002\u4f8b\u5982\uff0c\u5982\u679c\u5ba2\u4eba\u4e0d\u80fd\u56de\u8986\u4e3b\u984c\uff0c\u90a3\u9ebc\u56de\u8986\u4e3b\u984c\u7684 API \u8acb\u6c42\u5c07\u7522\u751f\u4e00\u500b\u6c92\u6709\u6b0a\u9650\u7684\u932f\u8aa4\u3002 \u7528\u6236\u5bc6\u9470 - \u9019\u500b\u5bc6\u9470\u7e3d\u662f\u4ee5\u6307\u5b9a\u7528\u6236\u7684\u8eab\u4efd\u8a2a\u554f API\uff0c\u4e26\u59cb\u7d42\u9075\u5b88\u8a72\u7528\u6236\u7684\u6b0a\u9650\uff0c\u985e\u4f3c\u65bc\u8a2a\u5ba2\u5bc6\u9470\u3002 \u8d85\u7d1a\u7528\u6236\u5bc6\u9470 - \u9019\u500b\u5bc6\u9470\u53ef\u4ee5\u901a\u904e\u50b3\u905e\u4e00\u500b\u984d\u5916\u7684\u503c\uff0c\u4ee5\u4efb\u4f55\u7528\u6236\u7684\u8eab\u4efd\u8a2a\u554f API\u3002\uff08\u53ef\u9078\uff09\u6b64\u5bc6\u9470\u53ef\u4ee5\u7e5e\u904e\u7528\u6236\u767c\u51fa\u8acb\u6c42\u7684\u6b0a\u9650\uff0c\u5f9e\u800c\u5141\u8a31\u4ed6\u5011\u57f7\u884c\u64cd\u4f5c\u6216\u67e5\u770b\u901a\u5e38\u4e0d\u5177\u6709\u8a2a\u554f\u6b0a\u9650\u7684\u5167\u5bb9\u3002 \u8d85\u7d1a\u7528\u6236\u5bc6\u9470\u5c0d\u65bc\u8207\u5176\u4ed6\u7cfb\u7d71\u6216\u61c9\u7528\u7a0b\u5f0f\u7684\u6574\u5408\u975e\u5e38\u6709\u7528\u3002 \u4f8b\u5982\uff0c\u60a8\u53ef\u80fd\u6703\u8207\u7b2c\u4e09\u65b9 CMS \u6574\u5408\uff0c\u6bcf\u7576\u60a8\u767c\u4f48\u4e00\u7bc7\u65b0\u6587\u7ae0\u6642\uff0c\u8a72 CMS \u5c31\u6703\u5efa\u7acb\u4e00\u500b\u4e3b\u984c\u3002 \u9019\u7a2e\u985e\u578b\u7684\u5bc6\u9470\u5c07\u5141\u8a31\u60a8\u6839\u64da\u6587\u7ae0\u4f5c\u8005\u6216\u5728\u7528\u6236\u901a\u5e38\u4e0d\u80fd\u767c\u4f48\u7684\u8ad6\u58c7\u4e2d\u5efa\u7acb\u4e00\u500b\u4e0d\u540c\u7528\u6236\u7684\u4e3b\u984c\u3002","title":"\u5bc6\u9470\u985e\u578b"},{"location":"rest-api/#_2","text":"\u70ba\u4e86\u5e6b\u52a9\u9650\u5236\u88ab\u6d29\u9732\u7684\u5bc6\u9470\u6240\u9020\u6210\u7684\u640d\u5bb3\uff0c\u6bcf\u500b\u5bc6\u9470\u90fd\u53ef\u4ee5\u63a7\u5236\u5176\u53ef\u4ee5\u8a2a\u554f\u7684 API \u4f5c\u7528\u57df\u3002 \u4f5c\u7528\u57df\u9650\u5236\u4e86\u5c0d API \u5340\u57df\u7684\u8a2a\u554f\uff0c\u8207\u7528\u6236\u7684\u8acb\u6c42\u6b0a\u9650\u7121\u95dc\u3002 API \u4e2d\u7684\u6bcf\u500b\u7aef\u9ede\u90fd\u6703\u88ab\u4e00\u500b\u6216\u591a\u500b\u4f5c\u7528\u57df\u6240\u8986\u84cb\u3002\u5982\u679c API \u6c92\u6709\u88ab\u6388\u4e88\u4efb\u4f55\u9019\u4e9b\u4f5c\u7528\u57df\uff0c\u5247\u8acb\u6c42\u5c07\u5931\u6557\u3002 \u70ba\u4e86\u5b89\u5168\u8d77\u898b\uff0c\u6211\u5011\u5efa\u8b70\u60a8\u50c5\u70ba\u5bc6\u9470\u6388\u4e88\u6240\u9700\u7684\u4f5c\u7528\u57df\u3002\u5982\u679c\u60a8\u5728\u4ee5\u5f8c\u9700\u8981\u5176\u4ed6\u7684\u4f5c\u7528\u57df\uff0c\u5247\u53ef\u4ee5\u5728\u9700\u8981\u6642\u6dfb\u52a0\u5b83\u5011\u3002","title":"\u5bc6\u9470\u4f5c\u7528\u57df"},{"location":"rest-api/#api_1","text":"\u4e00\u65e6\u77e5\u9053\u8a2a\u554f API \u7684 URL \u4e26\u7372\u5f97\u5bc6\u9470\u5f8c\uff0c\u5c31\u53ef\u4ee5\u958b\u59cb\u5c0d\u5176\u767c\u51fa\u8acb\u6c42\u3002 \u6240\u6709\u7684 API Response \u90fd\u5c07\u4ee5 JSON \u683c\u5f0f\u8fd4\u56de\uff0c\u9664\u975e\u662f\u7279\u5225\u8981\u6c42\u4e8c\u9032\u5236\u6a94\u6848\uff08\u4f8b\u5982\uff0c\u4e0b\u8f09\u9644\u4ef6\u6642\uff09\u3002\u932f\u8aa4\u5c07\u8fd4\u56de\u4e00\u500b 400 \u7bc4\u570d\u5167\u7684 Response \u72c0\u614b\u78bc\u3002\u6210\u529f\u7684\u8acb\u6c42\u5c07\u8fd4\u56de\u4e00\u500b 200 \u72c0\u614b\u78bc\u3002\u96d6\u7136\u4e0d\u5e38\u7528\uff0c\u4f46\u91cd\u5b9a\u5411\u5c07\u8fd4\u56de\u4e00\u500b 300 \u7bc4\u570d\u7684\u72c0\u614b\u78bc\u3002 Request body \u5fc5\u9808\u4f7f\u7528 application/x-www-form-urlencoded \u7de8\u78bc\u767c\u9001\uff0c\u6216\u8005\uff0c\u5982\u679c\u662f\u4e0a\u50b3\u6a94\u6848\uff0c\u5247\u4f7f\u7528 multipart/form-data \u7de8\u78bc\u767c\u9001\u3002\u53c3\u6578\u4e5f\u53ef\u4ee5\u901a\u904e\u67e5\u8a62\u5b57\u4e32\u4f86\u50b3\u905e\u3002 \u6240\u6709 Request \u8cc7\u6599\u5fc5\u9808\u4f7f\u7528 UTF-8 \u5b57\u7b26\u96c6\u3002 Request \u5fc5\u9808\u901a\u904e XF-API-Key Header \u50b3\u905e\u8981\u4f7f\u7528\u7684 API \u5bc6\u9470\u3002\u6240\u6709 Request \u4e2d\u90fd\u5fc5\u9808\u6709\u9019\u500b\u5bc6\u9470\u3002 \u5982\u679c\u9078\u64c7\u7684 API \u5bc6\u9470\u662f\u8d85\u7d1a\u7528\u6236\u5bc6\u9470\uff0c\u4f60\u53ef\u4ee5\u901a\u904e XF-API-User Header \u50b3\u905e Context User \u7684\u7528\u6236ID\u3002 \u5982\u679c\u6c92\u6709\u50b3\u905e\u7528\u6236 ID\uff0cContext \u5c07\u9ed8\u8a8d\u70ba\u8a2a\u5ba2\u3002 \u5982\u679c Request \u662f\u7528\u8d85\u7d1a\u7528\u6236\u5bc6\u9470\u767c\u51fa\u7684\uff0c\u4e26\u4e14\u4f60\u5e0c\u671b\u7e5e\u904e Context User \u7684\u6b0a\u9650\uff0c\u5247\u53ef\u4ee5\u901a\u904e\u5c07 api_bypass_permissions \u53c3\u6578\u8a2d\u5b9a\u70ba 1 \u4f86\u5be6\u73fe\u3002(\u9019\u500b\u53c3\u6578\u53ef\u4ee5\u901a\u904e query string \u6216\u4f5c\u70ba Request body \u7684\u4e00\u90e8\u5206\u4f86\u9032\u884c\u50b3\u905e\u3002)","title":"\u8a2a\u554f API"},{"location":"rest-api/#_3","text":"\u7576\u9047\u5230 Error \u6642\uff0cresponse \u72c0\u614b\u78bc\u5c07\u5728 400 \u7bc4\u570d\u5167\u3002\u6709\u6642\uff0c\u53ef\u80fd\u6703\u51fa\u73fe 500 \u7bc4\u570d\u7684\u932f\u8aa4\uff0c\u4e0d\u904e\u9019\u8868\u660e\u4f3a\u670d\u5668\u7121\u6cd5\u8655\u7406\u8a72 request\u3002 API \u53ef\u80fd\u88ab\u66ab\u6642\u95dc\u9589\uff0c\u6216\u8005\u767c\u751f\u4e86\u5176\u4ed6\u4f3a\u670d\u5668\u932f\u8aa4\u3002 \u932f\u8aa4\u8a0a\u606f\u5177\u6709\u6a19\u6e96\u683c\u5f0f\u3002 \u9019\u662f\u4e00\u500b\u4f8b\u5b50\uff1a { \"errors\": [ { \"code\": \"api_key_not_found\", \"message\": \"\u672a\u627e\u5230 Request \u4e2d\u63d0\u4f9b\u7684 API \u5bc6\u9470\u3002\", \"params\": [] } ] } \u6700\u4e0a\u5c64\u5c07\u662f\u4e00\u500b\u5e36\u6709 errors key \u7684\u7269\u4ef6\u3002\u9019\u5c07\u662f\u5305\u542b 1 \u500b\u6216\u591a\u500b entry \u7684\u9663\u5217\u3002\u6bcf\u500b entry \u90fd\u662f\u4e00\u500b\u7269\u4ef6\uff0c\u53c3\u6578\u5982\u4e0b\uff1a code - \u9019\u662f\u6a5f\u5668\u53ef\u4ee5\u8b80\u61c2\u7684\u932f\u8aa4\u78bc\u3002 \u6709\u8a31\u591a\u53ef\u80fd\u7684\u932f\u8aa4\u78bc\uff0c\u56e0\u70ba\u5b83\u5011\u53d6\u6c7a\u65bc\u60c5\u6cc1\u3002 message - \u4eba\u985e\u53ef\u4ee5\u8b80\u61c2\u7684\u932f\u8aa4\u8a0a\u606f\u3002 \u9019\u53ef\u80fd\u6703\u6539\u8b8a\uff0c\u4e5f\u53ef\u80fd\u6703\u88ab\u7ffb\u8b6f\uff0c\u4e0d\u61c9\u8a72\u7528\u65bc\u8b58\u5225\u932f\u8aa4\u985e\u578b\u3002 params - \u9019\u662f\u89f8\u767c\u932f\u8aa4\u76f8\u95dc\u7684 key-value \u53c3\u6578\u5217\u8868\u3002\u5b83\u5011\u53ef\u4ee5\u88dc\u5145\u932f\u8aa4\u78bc\u548c\u8a0a\u606f\uff0c\u4ee5\u63d0\u4f9b\u6709\u95dc\u932f\u8aa4\u7684\u66f4\u591a\u660e\u78ba\u7684\u8a73\u7d30\u8a0a\u606f\u3002","title":"\u932f\u8aa4\u8655\u7406"},{"location":"rest-api/#api_2","text":"\u8a72 API \u5177\u6709\u8a31\u591a Endpoints \u548c\u53ef\u4ee5\u63a1\u53d6\u7684\u63aa\u65bd\u3002\u5c07\u4f86\u53ef\u80fd\u6703\u65b0\u589e\u5176\u4ed6 Endpoint \u548c\u8cc7\u6599\u3002 \u67e5\u770b API \u7aef\u9ede\u6587\u4ef6 \u8a72 Endpoint \u6587\u4ef6\u662f\u6839\u64da API \u8cc7\u6599\u548c\u7a0b\u5f0f\u78bc\u4e2d\u7684\u8a3b\u91cb\u751f\u6210\u7684\u3002\u5b83\u5c07\u96a8\u8457\u6642\u9593\u7684\u63a8\u79fb\u9032\u884c\u64f4\u5c55\u548c\u66f4\u65b0\u3002","title":"API \u7aef\u9ede"},{"location":"routing-basics/","text":"\u8def\u7531\u57fa\u790e\u77e5\u8b58 \u00b6 \u5728 PHP \u61c9\u7528\u7a0b\u5f0f\u4e2d\uff0c\u50cf\u662f XF2\uff0c\u6211\u5011\u9700\u8981\u4e00\u7a2e\u80fd\u5920\u63a5\u53d7\u7528\u6236\u5c0d\u7279\u5b9a URL \u7684\u8acb\u6c42\u7684\u65b9\u6cd5\uff0c\u4e86\u89e3\u8a72 URL \u4ee3\u8868\u7684 controller\u3001 action \u548c\u8cc7\u6599\uff0c\u4ee5\u4fbf\u5411\u7528\u6236\u63d0\u4f9b\u9069\u7576\u7684\u97ff\u61c9\u3002 \u5c07\u4e00\u500b URL \u8f49\u63db\u70ba\u7a0b\u5f0f\u78bc\u4e2d\u7684\u4e00\u500b\u4f4d\u7f6e\u7684\u6982\u5ff5\u88ab\u7a31\u70ba \"\u8def\u7531\"\u3002 \u5728 XF2 \u4e2d\uff0c\u8def\u7531\u9078\u64c7\u5e7e\u4e4e\u5b8c\u5168\u7531 Admin CP \u4e2d\u7684\u4e00\u500b\u4f4d\u7f6e\u7ba1\u7406\u3002 \u8a72\u4f4d\u7f6e\u662f Admin CP > Development > Routes \u3002 \u8def\u7531\u6309\u5169\u7a2e\u985e\u578b\u4e4b\u4e00\u5206\u7d44\uff0c\u5373 Public \u548c Admin \u985e\u578b\uff0c\u5b83\u5011\u5206\u5225\u5728 Public \u548c Admin \u61c9\u7528\u7a0b\u5f0f\u4e2d\u63d0\u4f9b\u8acb\u6c42\u7684\u8def\u7531\u3002 \u7c21\u55ae\u7684\u4f8b\u5b50 \u00b6 \u5728\u8def\u7531\u9801\u9762 (\u898b\u4e0a\u6587)\uff0c\u4f60\u61c9\u8a72\u770b\u5230\u4e00\u500b account/ \u7684\u689d\u76ee\u3002 \u9019\u662f\u4e00\u500b Public \u8def\u7531\uff0c\u63d0\u4f9b\u4e86\u5c0d URL index.php?account/ \u7684\u8acb\u6c42\u7684\u8def\u7531\u3002 \u9019\u500b\u8def\u7531\u975e\u5e38\u7c21\u55ae\uff0c\u5b83\u53ea\u5305\u542b\u4e86\u5c11\u91cf\u7684\u914d\u7f6e\u3002 \u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0c\u5b83\u7531\u4e00\u500b \"\u8def\u7531\u524d\u7db4\"\uff0c\u4e00\u500b Section context \u548c\u4e00\u500b Controller class \u7d44\u6210\u3002 \u8b93\u6211\u5011\u66f4\u8a73\u7d30\u5730\u4e86\u89e3\u9019\u4e9b\u90e8\u5206\uff1a \u8def\u7531\u524d\u7db4 \u00b6 \u8def\u7531\u524d\u7db4\u4e3b\u8981\u662f\u6307\u5728 index.php? \u4e4b\u5f8c\u548c\u7b2c\u4e00\u500b / \u4e4b\u524d\u7684\u4f4d\u7f6e\u3002 \u5b83\u662f\u78ba\u5b9a\u8def\u7531\u8acb\u6c42\u7d66\u54ea\u500b Controller \u7684\u7b2c\u4e00\u6b65\u3002 Section context \u00b6 \u6b64 Section context \u544a\u8a34 XF \u4e2d\u7684\u5c0e\u89bd\u7cfb\u7d71\uff0c\u7576\u8a2a\u554f\u8005\u700f\u89bd\u7531\u8a72\u8def\u7531\u8f49\u5230\u7684\u9801\u9762\u6642\uff0c\u61c9\u8a72\u9078\u64c7\u54ea\u500b\u5c0e\u89bd\u9805\u3002 \u5c0d\u65bc Public \u8def\u7531\uff0cSection context \u61c9\u8a72\u662f\u6700\u9ad8\u7d1a\u5225\u5c0e\u89bd\u9805\u7684 ID\u3002 \u5c0d\u65bc Admin \u8def\u7531\uff0c\u61c9\u8a72\u662f\u6700\u7279\u5b9a\u7684\u7ba1\u7406\u5c0e\u89bd\u689d\u76ee\u7684 ID\uff08\u7121\u8ad6\u6df1\u5ea6\uff09\u3002 \u5982\u679c\u662f\u5e33\u865f\u8def\u7531\uff0c\u9810\u8a2d\u60c5\u6cc1\u4e0b\uff0cSection context \u4e0d\u4e00\u5b9a\u9069\u7528\uff0c\u56e0\u70ba\u6211\u5011\u6c92\u6709 \"account\" \u5c0e\u89bd\u6a19\u7c64\u3002 \u4f46\u662f\uff0c\u8981\u60f3\u770b\u5230\u9019\u500b action\uff0c\u53ea\u9700\u5c07\u9019\u88e1\u7684 \"Section context\" \u503c\u6539\u70ba \"forums\"\uff0c\u5132\u5b58\u66f4\u6539\u4e26\u5728\u524d\u7aef\u9032\u5165\u4f60\u7684\u5e33\u865f\u3002 \u73fe\u5728\uff0c\u4f60\u61c9\u8a72\u770b\u5230 \"Forums\" \u5c0e\u89bd\u6a19\u7c64\u88ab\u9078\u4e2d\u4e86\uff01 Controller \u00b6 \u9019\u662f\u7576\u8acb\u6c42\u8207\u9019\u500b\u8def\u7531\u5339\u914d\u6642\uff0c\u61c9\u8a72\u88ab\u547c\u53eb\u7684 Controller \u7684 class \u540d\u3002 \u5728 \"account/\" \u8def\u7531\u4e2d\uff0c\u6211\u5011\u6307\u5b9a\u4e86 XF:Account \u3002 \u9019\u5c07\u8f09\u5165 Account \u63a7\u5236\u5668\u3002 \uff08\u66f4\u591a\u8cc7\u8a0a\u8acb\u53c3\u898b \u77ed\u985e\u540d \uff09\u3002 \u7a0b\u5f0f\u78bc\u4f4d\u65bc\u4ee5\u4e0b\u4f4d\u7f6e src/XF/Pub/Controller/Account.php \u3002 \u6ce8\u610f\u77ed\u985e\u540d\u662f\u5982\u4f55\u89e3\u6790\u70ba \"infix\" \u4ee5\u53ca\u524d\u7db4 (XF) \u548c\u5f8c\u7db4 (Account) \u7684\u3002 \u5728\u672c\u4f8b\u4e2d\uff0c\u9019\u500b\u63a7\u5236\u5668\u7684\u4e0b\u6a19 (Pub) \u662f\u7531 Account \u8def\u7531\u985e\u578b (public) \u63a8\u65b7\u51fa\u4f86\u7684\u3002 Controller action \u00b6 \u4e0a\u9762\u6211\u5011\u89e3\u91cb\u4e86\u5982\u4f55\u5c07\u8def\u7531\u5339\u914d\u5230\u4e00\u500b\u7279\u5b9a\u7684 Controller\uff0c\u4f46\u6211\u5011\u9084\u4e0d\u77e5\u9053\u5982\u4f55\u547c\u53eb\u8a72 Controller \u5167\u7684\u7279\u5b9a action\u3002 Controller \u672c\u8cea\u4e0a\u662f\u4e00\u500b\u5305\u542b\u4e86\u8a31\u591a action \u65b9\u6cd5\u7684 class\uff0cURL \u4e2d \u8def\u7531\u524d\u7db4 \u5f8c\u9762\u7684\u90e8\u5206\u8868\u793a Controller \u7684 action\u3002 \u7d66\u5b9a\u4e00\u500b URL \u70ba index.php?account/account-details \uff0c\u4f60\u61c9\u8a72\u88ab\u8def\u7531\u5230 XF/Pub/Controller/Account class \u548c actionAccountDetails() \u65b9\u6cd5\u3002 \u5982\u679c\u8def\u7531\u6c92\u6709\u6307\u5b9a action\uff0c\u90a3\u9ebc\u547c\u53eb\u7684\u65b9\u6cd5\u53ea\u662f actionIndex() \u3002 \u4f60\u53ef\u4ee5\u5728 \u63a7\u5236\u5668\u57fa\u790e\u77e5\u8b58 \u90e8\u5206\u95b1\u8b80\u66f4\u591a\u95dc\u65bc\u63a7\u5236\u5668\u7684\u5167\u5bb9\u3002 \u66f4\u9032\u968e\u7684\u4f8b\u5b50\uff08\u8def\u7531\u683c\u5f0f\uff09 \u00b6 \u8b93\u6211\u5011\u770b\u770b members/ \u8def\u7531\u3002 \u9019\u500b\u8def\u7531\u548c account/ \u8def\u7531\u4e00\u6a23\uff0c\u9084\u662f\u5f88\u7c21\u55ae\u7684\uff0c\u4f46\u662f\u5b83\u591a\u4e86\u4e00\u500b\u6b04\u4f4d\uff1a\"\u8def\u7531\u683c\u5f0f\"\u3002 \u8981\u4e86\u89e3\u5b83\u662f\u5982\u4f55\u5de5\u4f5c\u7684\uff0c\u770b\u770b\u4f60\u81ea\u5df1\u5728\u524d\u7aef\u7684\u7528\u6236\u500b\u4eba\u8cc7\u6599\u3002 \u8a72\u914d\u7f6e\u6a94\u6848\u7684 URL \u770b\u8d77\u4f86\u6703\u662f\u9019\u6a23\u7684 index.php?members/your-name.1 \u3002\u5177\u9ad4\u800c\u8a00\uff0c\u8acb\u6ce8\u610f your-name.1 \u7684\u90e8\u5206\u3002 \u9019\u662f\u6211\u5011\u8a66\u5716\u4f7f\u7528 \"\u8def\u7531\u683c\u5f0f\" \u4f86\u5339\u914d\u7684\u90e8\u5206\u3002 \"\u8def\u7531\u683c\u5f0f\" \u5141\u8a31\u6211\u5011\u5f9e\u8acb\u6c42 URL \u4e2d\u63d0\u53d6\u8cc7\u6599\uff0c\u56e0\u6b64\u6211\u5011\u53ef\u4ee5\u5c07\u8a72\u8cc7\u8a0a\u50b3\u905e\u5230 Controller action \u4e2d\uff0c\u4ee5\u4fbf\u8a72 action \u53ef\u4ee5\u8f09\u5165\u7279\u5b9a\u7684\u8cc7\u8a0a\uff1b\u5728\u9019\u7a2e\u60c5\u6cc1\u4e0b\uff0c\u5b83\u8f09\u5165\u8acb\u6c42\u7684\u7528\u6236\u500b\u4eba\u8cc7\u6599\u7684\u8a73\u7d30\u8cc7\u8a0a\u3002 \u5b83\u9084\u53ef\u4ee5\u5e6b\u52a9\u6211\u5011\u5f9e\u50b3\u905e\u9032\u4f86\u7684\u8cc7\u6599\u4e2d\u5efa\u7acb\u9023\u7d50\u3002 \u4e0b\u9762\u662f\u8a9e\u6cd5\uff1a :int<user_id,username>/:page \u6709\u8da3\u7684\u662f\uff0c\u6b64\u6642\u8981\u6ce8\u610f\u7684\u662f\uff0c\u500b\u4eba\u8cc7\u6599 URL \u4e2d\u7528\u65bc\u67e5\u8a62\u500b\u4eba\u8cc7\u6599\u7684\u91cd\u8981\u90e8\u5206\u5176\u5be6\u4e26\u4e0d\u662f your-name \u9019\u4e00\u9ede\uff0c\u800c\u5be6\u969b\u4e0a\u662f\u7528\u6236ID\uff08 1 \uff09\u3002 \u70ba\u4e86\u8b49\u660e\u9019\u4e00\u9ede\uff0c\u6539\u8b8a URL\uff0c\u7528 not-your-name \u4ee3\u66ff your-name \u3002 \u4f60\u6703\u770b\u5230\u627e\u5230\u4e86\u6b63\u78ba\u7684\u500b\u4eba\u8cc7\u6599\uff0c\u4e26\u4e14\u91cd\u65b0\u5b9a\u5411\u5230\u4e86\u6b63\u78ba\u7684 URL\u3002 \u4e0a\u9762\u7684\u683c\u5f0f\u8868\u660e\u5b83\u662f\u4e00\u500b\u57fa\u65bc\u6574\u6578\u7684\u53c3\u6578\u3002 \u5728\u5efa\u7acb\u5916\u90e8\u93c8\u7d50\u6642\uff0c\u6211\u5011\u5f9e\u50b3\u5165\u8cc7\u6599\u7684 user_id key \u4e2d\u63d0\u53d6\u6574\u6578\u3002 \u5982\u679c\u8cc7\u6599\u4e2d\u50b3\u905e\u4e86\u4e00\u500b\u7528\u6236\u540d\uff0c\u5b83\u5c07\u88ab \"slugified\"\uff0c\u5c31\u50cf\u4f60\u5728\u4f60\u7684\u500b\u4eba\u8cc7\u6599\u7684 URL \u4e2d\u770b\u5230\u7684\u6574\u6578 ID \u4e00\u6a23\u3002 \u5c0d\u65bc\u5339\u914d\u50b3\u5165\u7684 URL\uff0c\u9019\u5c07\u8b8a\u6210\u4e00\u500b\u5339\u914d\u6574\u6578\u53c3\u6578\u683c\u5f0f\u7684\u6b63\u898f\u5316\u8868\u9054\u5f0f\u3002 :page \u662f\u7528\u65bc\u751f\u6210\u9023\u7d50\u7684 page-123 \u90e8\u5206\u7684\u5feb\u6377\u65b9\u5f0f\u3002 \u5728\u9019\u7a2e\u60c5\u6cc1\u4e0b\uff0c\u5b83\u5728\u9023\u7d50\u53c3\u6578\u4e2d\u5c0b\u627e\u9801\u9762\u3002 \u5982\u679c\u627e\u5230\u4e86\uff0c\u5b83\u5c31\u6703\u88ab\u653e\u5728 URL \u4e2d\uff0c\u7136\u5f8c\u5f9e\u53c3\u6578\u4e2d\u522a\u9664\u3002 \u5c0d\u65bc\u50b3\u5165\u7684\u89e3\u6790\uff0c\u5982\u679c\u5339\u914d\uff08\u5b83\u53ef\u4ee5\u662f\u7a7a\u7684\uff09\uff0c\u5b83\u5c07\u628a\u9801\u78bc\u65b0\u589e\u5230\u50b3\u905e\u7d66 Controller \u7684\u53c3\u6578\u4e2d\u3002 \u8def\u7531\u53c3\u6578 \u00b6 \u7576\u8def\u7531\u8207\u7279\u5b9a\u7684 Controller \u548c action \u5339\u914d\u6642\uff0cURL \u4e2d\u7684\u4efb\u4f55\u53c3\u6578\u90fd\u6703\u88ab\u5c01\u88dd\u5230\u4e00\u500b\u7279\u6b8a\u7684\u7269\u4ef6\u4e2d\uff0c\u6211\u5011\u7a31\u4e4b\u70ba ParameterBag \u3002 \u9019\u500b\u7269\u4ef6\u5c08\u9580\u7528\u65bc\u5c07\u666e\u901a URL \u53c3\u6578\u8207\u4f86\u81ea\u8def\u7531\u5339\u914d\u7684 URL \u53c3\u6578\u5206\u958b\u7684\u3002 ParameterBag \u7269\u4ef6\u88ab\u50b3\u905e\u5230\u6bcf\u500b Controller action \u4e2d\uff0c\u4f7f\u7528\u65b9\u6cd5\u5982\u4e0b\uff1a $userId = $params->user_id; Sub-names \u00b6 \u4e5f\u53ef\u4ee5\u5c07\u8def\u7531\u5206\u5272\u6210\u66f4\u591a\u7684 Sub-names\u3002 \u4f60\u53ef\u4ee5\u901a\u904e members/following \u8def\u7531\u4f86\u770b\u5230\u9019\u500b action\u3002 \u5728\u9019\u500b\u4f8b\u5b50\u4e2d\uff0c following \u662f\u8def\u7531 members \u7684 Sub-names\u3002 \u901a\u5e38\u60c5\u6cc1\u4e0b\uff0c\u770b\u8d77\u4f86\u50cf index.php?members/following \u7684 URL\uff0c following \u7684\u90e8\u5206\u5c07\u8868\u793a action\uff0c\u4e26\u7c21\u55ae\u5730\u8207\u666e\u901a\u7684 members/ \u8def\u7531\u9032\u884c\u5339\u914d\u3002 \u4f46\u662f\uff0c\u5982\u679c\u6709\u4e00\u500b\u8def\u7531\u5339\u914d\u4e86\u524d\u7db4 \"members\" \u548c\u5f8c\u9762\u7684 \"Sub-names\"\uff0c\u5c31\u6703\u88ab\u4f7f\u7528\u3002 \u9019\u88e1\u4e5f\u662f\u5982\u6b64\uff0c\u6240\u4ee5\u5b83\u5efa\u7acb\u4e86\u4e00\u500b\u50cf\u662f\u4e0b\u9762\u7684\u9023\u7d50\uff1a members/:int<user_id,username>/following/:page \u5c0d\u65bc\u50b3\u5165\u8def\u7531\u7684\u5339\u914d\uff0c\u8a72\u8def\u7531\u5c07\u5728\u57fa\u672c\u6210\u54e1\u8def\u7531\u4e4b\u524d\u9032\u884c\u6e2c\u8a66\uff1b\u5982\u679c\u5339\u914d\uff0c\u5247\u4f7f\u7528\u8a72\u8def\u7531\u3002 \u9019\u7a2e sub-name \u7cfb\u7d71\u5141\u8a31\u884c\u70ba\u6539\u8b8a\uff0c\u4f8b\u5982\u6539\u8b8a\u53c3\u6578\u7684\u4f4d\u7f6e\u6216\u8005\u5c07\u8def\u7531\u5206\u7d44\u5230\u4e0d\u540c\u7684 Controller \u4e2d\u6216\u4f7f\u7528\u4e0d\u540c\u7684\u53c3\u6578\u3002 \u60a8\u53ef\u4ee5\u5728\u8cc7\u6e90\u7ba1\u7406\u5668\u548c\u5a92\u9ad4\u5eab\u9644\u52a0\u5143\u4ef6\u4e2d\u770b\u5230\u5f8c\u8005\u7684\u4f8b\u5b50\u3002","title":"\u8def\u7531\u57fa\u790e\u77e5\u8b58"},{"location":"routing-basics/#_1","text":"\u5728 PHP \u61c9\u7528\u7a0b\u5f0f\u4e2d\uff0c\u50cf\u662f XF2\uff0c\u6211\u5011\u9700\u8981\u4e00\u7a2e\u80fd\u5920\u63a5\u53d7\u7528\u6236\u5c0d\u7279\u5b9a URL \u7684\u8acb\u6c42\u7684\u65b9\u6cd5\uff0c\u4e86\u89e3\u8a72 URL \u4ee3\u8868\u7684 controller\u3001 action \u548c\u8cc7\u6599\uff0c\u4ee5\u4fbf\u5411\u7528\u6236\u63d0\u4f9b\u9069\u7576\u7684\u97ff\u61c9\u3002 \u5c07\u4e00\u500b URL \u8f49\u63db\u70ba\u7a0b\u5f0f\u78bc\u4e2d\u7684\u4e00\u500b\u4f4d\u7f6e\u7684\u6982\u5ff5\u88ab\u7a31\u70ba \"\u8def\u7531\"\u3002 \u5728 XF2 \u4e2d\uff0c\u8def\u7531\u9078\u64c7\u5e7e\u4e4e\u5b8c\u5168\u7531 Admin CP \u4e2d\u7684\u4e00\u500b\u4f4d\u7f6e\u7ba1\u7406\u3002 \u8a72\u4f4d\u7f6e\u662f Admin CP > Development > Routes \u3002 \u8def\u7531\u6309\u5169\u7a2e\u985e\u578b\u4e4b\u4e00\u5206\u7d44\uff0c\u5373 Public \u548c Admin \u985e\u578b\uff0c\u5b83\u5011\u5206\u5225\u5728 Public \u548c Admin \u61c9\u7528\u7a0b\u5f0f\u4e2d\u63d0\u4f9b\u8acb\u6c42\u7684\u8def\u7531\u3002","title":"\u8def\u7531\u57fa\u790e\u77e5\u8b58"},{"location":"routing-basics/#_2","text":"\u5728\u8def\u7531\u9801\u9762 (\u898b\u4e0a\u6587)\uff0c\u4f60\u61c9\u8a72\u770b\u5230\u4e00\u500b account/ \u7684\u689d\u76ee\u3002 \u9019\u662f\u4e00\u500b Public \u8def\u7531\uff0c\u63d0\u4f9b\u4e86\u5c0d URL index.php?account/ \u7684\u8acb\u6c42\u7684\u8def\u7531\u3002 \u9019\u500b\u8def\u7531\u975e\u5e38\u7c21\u55ae\uff0c\u5b83\u53ea\u5305\u542b\u4e86\u5c11\u91cf\u7684\u914d\u7f6e\u3002 \u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0c\u5b83\u7531\u4e00\u500b \"\u8def\u7531\u524d\u7db4\"\uff0c\u4e00\u500b Section context \u548c\u4e00\u500b Controller class \u7d44\u6210\u3002 \u8b93\u6211\u5011\u66f4\u8a73\u7d30\u5730\u4e86\u89e3\u9019\u4e9b\u90e8\u5206\uff1a","title":"\u7c21\u55ae\u7684\u4f8b\u5b50"},{"location":"routing-basics/#_3","text":"\u8def\u7531\u524d\u7db4\u4e3b\u8981\u662f\u6307\u5728 index.php? \u4e4b\u5f8c\u548c\u7b2c\u4e00\u500b / \u4e4b\u524d\u7684\u4f4d\u7f6e\u3002 \u5b83\u662f\u78ba\u5b9a\u8def\u7531\u8acb\u6c42\u7d66\u54ea\u500b Controller \u7684\u7b2c\u4e00\u6b65\u3002","title":"\u8def\u7531\u524d\u7db4"},{"location":"routing-basics/#section-context","text":"\u6b64 Section context \u544a\u8a34 XF \u4e2d\u7684\u5c0e\u89bd\u7cfb\u7d71\uff0c\u7576\u8a2a\u554f\u8005\u700f\u89bd\u7531\u8a72\u8def\u7531\u8f49\u5230\u7684\u9801\u9762\u6642\uff0c\u61c9\u8a72\u9078\u64c7\u54ea\u500b\u5c0e\u89bd\u9805\u3002 \u5c0d\u65bc Public \u8def\u7531\uff0cSection context \u61c9\u8a72\u662f\u6700\u9ad8\u7d1a\u5225\u5c0e\u89bd\u9805\u7684 ID\u3002 \u5c0d\u65bc Admin \u8def\u7531\uff0c\u61c9\u8a72\u662f\u6700\u7279\u5b9a\u7684\u7ba1\u7406\u5c0e\u89bd\u689d\u76ee\u7684 ID\uff08\u7121\u8ad6\u6df1\u5ea6\uff09\u3002 \u5982\u679c\u662f\u5e33\u865f\u8def\u7531\uff0c\u9810\u8a2d\u60c5\u6cc1\u4e0b\uff0cSection context \u4e0d\u4e00\u5b9a\u9069\u7528\uff0c\u56e0\u70ba\u6211\u5011\u6c92\u6709 \"account\" \u5c0e\u89bd\u6a19\u7c64\u3002 \u4f46\u662f\uff0c\u8981\u60f3\u770b\u5230\u9019\u500b action\uff0c\u53ea\u9700\u5c07\u9019\u88e1\u7684 \"Section context\" \u503c\u6539\u70ba \"forums\"\uff0c\u5132\u5b58\u66f4\u6539\u4e26\u5728\u524d\u7aef\u9032\u5165\u4f60\u7684\u5e33\u865f\u3002 \u73fe\u5728\uff0c\u4f60\u61c9\u8a72\u770b\u5230 \"Forums\" \u5c0e\u89bd\u6a19\u7c64\u88ab\u9078\u4e2d\u4e86\uff01","title":"Section context"},{"location":"routing-basics/#controller","text":"\u9019\u662f\u7576\u8acb\u6c42\u8207\u9019\u500b\u8def\u7531\u5339\u914d\u6642\uff0c\u61c9\u8a72\u88ab\u547c\u53eb\u7684 Controller \u7684 class \u540d\u3002 \u5728 \"account/\" \u8def\u7531\u4e2d\uff0c\u6211\u5011\u6307\u5b9a\u4e86 XF:Account \u3002 \u9019\u5c07\u8f09\u5165 Account \u63a7\u5236\u5668\u3002 \uff08\u66f4\u591a\u8cc7\u8a0a\u8acb\u53c3\u898b \u77ed\u985e\u540d \uff09\u3002 \u7a0b\u5f0f\u78bc\u4f4d\u65bc\u4ee5\u4e0b\u4f4d\u7f6e src/XF/Pub/Controller/Account.php \u3002 \u6ce8\u610f\u77ed\u985e\u540d\u662f\u5982\u4f55\u89e3\u6790\u70ba \"infix\" \u4ee5\u53ca\u524d\u7db4 (XF) \u548c\u5f8c\u7db4 (Account) \u7684\u3002 \u5728\u672c\u4f8b\u4e2d\uff0c\u9019\u500b\u63a7\u5236\u5668\u7684\u4e0b\u6a19 (Pub) \u662f\u7531 Account \u8def\u7531\u985e\u578b (public) \u63a8\u65b7\u51fa\u4f86\u7684\u3002","title":"Controller"},{"location":"routing-basics/#controller-action","text":"\u4e0a\u9762\u6211\u5011\u89e3\u91cb\u4e86\u5982\u4f55\u5c07\u8def\u7531\u5339\u914d\u5230\u4e00\u500b\u7279\u5b9a\u7684 Controller\uff0c\u4f46\u6211\u5011\u9084\u4e0d\u77e5\u9053\u5982\u4f55\u547c\u53eb\u8a72 Controller \u5167\u7684\u7279\u5b9a action\u3002 Controller \u672c\u8cea\u4e0a\u662f\u4e00\u500b\u5305\u542b\u4e86\u8a31\u591a action \u65b9\u6cd5\u7684 class\uff0cURL \u4e2d \u8def\u7531\u524d\u7db4 \u5f8c\u9762\u7684\u90e8\u5206\u8868\u793a Controller \u7684 action\u3002 \u7d66\u5b9a\u4e00\u500b URL \u70ba index.php?account/account-details \uff0c\u4f60\u61c9\u8a72\u88ab\u8def\u7531\u5230 XF/Pub/Controller/Account class \u548c actionAccountDetails() \u65b9\u6cd5\u3002 \u5982\u679c\u8def\u7531\u6c92\u6709\u6307\u5b9a action\uff0c\u90a3\u9ebc\u547c\u53eb\u7684\u65b9\u6cd5\u53ea\u662f actionIndex() \u3002 \u4f60\u53ef\u4ee5\u5728 \u63a7\u5236\u5668\u57fa\u790e\u77e5\u8b58 \u90e8\u5206\u95b1\u8b80\u66f4\u591a\u95dc\u65bc\u63a7\u5236\u5668\u7684\u5167\u5bb9\u3002","title":"Controller action"},{"location":"routing-basics/#_4","text":"\u8b93\u6211\u5011\u770b\u770b members/ \u8def\u7531\u3002 \u9019\u500b\u8def\u7531\u548c account/ \u8def\u7531\u4e00\u6a23\uff0c\u9084\u662f\u5f88\u7c21\u55ae\u7684\uff0c\u4f46\u662f\u5b83\u591a\u4e86\u4e00\u500b\u6b04\u4f4d\uff1a\"\u8def\u7531\u683c\u5f0f\"\u3002 \u8981\u4e86\u89e3\u5b83\u662f\u5982\u4f55\u5de5\u4f5c\u7684\uff0c\u770b\u770b\u4f60\u81ea\u5df1\u5728\u524d\u7aef\u7684\u7528\u6236\u500b\u4eba\u8cc7\u6599\u3002 \u8a72\u914d\u7f6e\u6a94\u6848\u7684 URL \u770b\u8d77\u4f86\u6703\u662f\u9019\u6a23\u7684 index.php?members/your-name.1 \u3002\u5177\u9ad4\u800c\u8a00\uff0c\u8acb\u6ce8\u610f your-name.1 \u7684\u90e8\u5206\u3002 \u9019\u662f\u6211\u5011\u8a66\u5716\u4f7f\u7528 \"\u8def\u7531\u683c\u5f0f\" \u4f86\u5339\u914d\u7684\u90e8\u5206\u3002 \"\u8def\u7531\u683c\u5f0f\" \u5141\u8a31\u6211\u5011\u5f9e\u8acb\u6c42 URL \u4e2d\u63d0\u53d6\u8cc7\u6599\uff0c\u56e0\u6b64\u6211\u5011\u53ef\u4ee5\u5c07\u8a72\u8cc7\u8a0a\u50b3\u905e\u5230 Controller action \u4e2d\uff0c\u4ee5\u4fbf\u8a72 action \u53ef\u4ee5\u8f09\u5165\u7279\u5b9a\u7684\u8cc7\u8a0a\uff1b\u5728\u9019\u7a2e\u60c5\u6cc1\u4e0b\uff0c\u5b83\u8f09\u5165\u8acb\u6c42\u7684\u7528\u6236\u500b\u4eba\u8cc7\u6599\u7684\u8a73\u7d30\u8cc7\u8a0a\u3002 \u5b83\u9084\u53ef\u4ee5\u5e6b\u52a9\u6211\u5011\u5f9e\u50b3\u905e\u9032\u4f86\u7684\u8cc7\u6599\u4e2d\u5efa\u7acb\u9023\u7d50\u3002 \u4e0b\u9762\u662f\u8a9e\u6cd5\uff1a :int<user_id,username>/:page \u6709\u8da3\u7684\u662f\uff0c\u6b64\u6642\u8981\u6ce8\u610f\u7684\u662f\uff0c\u500b\u4eba\u8cc7\u6599 URL \u4e2d\u7528\u65bc\u67e5\u8a62\u500b\u4eba\u8cc7\u6599\u7684\u91cd\u8981\u90e8\u5206\u5176\u5be6\u4e26\u4e0d\u662f your-name \u9019\u4e00\u9ede\uff0c\u800c\u5be6\u969b\u4e0a\u662f\u7528\u6236ID\uff08 1 \uff09\u3002 \u70ba\u4e86\u8b49\u660e\u9019\u4e00\u9ede\uff0c\u6539\u8b8a URL\uff0c\u7528 not-your-name \u4ee3\u66ff your-name \u3002 \u4f60\u6703\u770b\u5230\u627e\u5230\u4e86\u6b63\u78ba\u7684\u500b\u4eba\u8cc7\u6599\uff0c\u4e26\u4e14\u91cd\u65b0\u5b9a\u5411\u5230\u4e86\u6b63\u78ba\u7684 URL\u3002 \u4e0a\u9762\u7684\u683c\u5f0f\u8868\u660e\u5b83\u662f\u4e00\u500b\u57fa\u65bc\u6574\u6578\u7684\u53c3\u6578\u3002 \u5728\u5efa\u7acb\u5916\u90e8\u93c8\u7d50\u6642\uff0c\u6211\u5011\u5f9e\u50b3\u5165\u8cc7\u6599\u7684 user_id key \u4e2d\u63d0\u53d6\u6574\u6578\u3002 \u5982\u679c\u8cc7\u6599\u4e2d\u50b3\u905e\u4e86\u4e00\u500b\u7528\u6236\u540d\uff0c\u5b83\u5c07\u88ab \"slugified\"\uff0c\u5c31\u50cf\u4f60\u5728\u4f60\u7684\u500b\u4eba\u8cc7\u6599\u7684 URL \u4e2d\u770b\u5230\u7684\u6574\u6578 ID \u4e00\u6a23\u3002 \u5c0d\u65bc\u5339\u914d\u50b3\u5165\u7684 URL\uff0c\u9019\u5c07\u8b8a\u6210\u4e00\u500b\u5339\u914d\u6574\u6578\u53c3\u6578\u683c\u5f0f\u7684\u6b63\u898f\u5316\u8868\u9054\u5f0f\u3002 :page \u662f\u7528\u65bc\u751f\u6210\u9023\u7d50\u7684 page-123 \u90e8\u5206\u7684\u5feb\u6377\u65b9\u5f0f\u3002 \u5728\u9019\u7a2e\u60c5\u6cc1\u4e0b\uff0c\u5b83\u5728\u9023\u7d50\u53c3\u6578\u4e2d\u5c0b\u627e\u9801\u9762\u3002 \u5982\u679c\u627e\u5230\u4e86\uff0c\u5b83\u5c31\u6703\u88ab\u653e\u5728 URL \u4e2d\uff0c\u7136\u5f8c\u5f9e\u53c3\u6578\u4e2d\u522a\u9664\u3002 \u5c0d\u65bc\u50b3\u5165\u7684\u89e3\u6790\uff0c\u5982\u679c\u5339\u914d\uff08\u5b83\u53ef\u4ee5\u662f\u7a7a\u7684\uff09\uff0c\u5b83\u5c07\u628a\u9801\u78bc\u65b0\u589e\u5230\u50b3\u905e\u7d66 Controller \u7684\u53c3\u6578\u4e2d\u3002","title":"\u66f4\u9032\u968e\u7684\u4f8b\u5b50\uff08\u8def\u7531\u683c\u5f0f\uff09"},{"location":"routing-basics/#_5","text":"\u7576\u8def\u7531\u8207\u7279\u5b9a\u7684 Controller \u548c action \u5339\u914d\u6642\uff0cURL \u4e2d\u7684\u4efb\u4f55\u53c3\u6578\u90fd\u6703\u88ab\u5c01\u88dd\u5230\u4e00\u500b\u7279\u6b8a\u7684\u7269\u4ef6\u4e2d\uff0c\u6211\u5011\u7a31\u4e4b\u70ba ParameterBag \u3002 \u9019\u500b\u7269\u4ef6\u5c08\u9580\u7528\u65bc\u5c07\u666e\u901a URL \u53c3\u6578\u8207\u4f86\u81ea\u8def\u7531\u5339\u914d\u7684 URL \u53c3\u6578\u5206\u958b\u7684\u3002 ParameterBag \u7269\u4ef6\u88ab\u50b3\u905e\u5230\u6bcf\u500b Controller action \u4e2d\uff0c\u4f7f\u7528\u65b9\u6cd5\u5982\u4e0b\uff1a $userId = $params->user_id;","title":"\u8def\u7531\u53c3\u6578"},{"location":"routing-basics/#sub-names","text":"\u4e5f\u53ef\u4ee5\u5c07\u8def\u7531\u5206\u5272\u6210\u66f4\u591a\u7684 Sub-names\u3002 \u4f60\u53ef\u4ee5\u901a\u904e members/following \u8def\u7531\u4f86\u770b\u5230\u9019\u500b action\u3002 \u5728\u9019\u500b\u4f8b\u5b50\u4e2d\uff0c following \u662f\u8def\u7531 members \u7684 Sub-names\u3002 \u901a\u5e38\u60c5\u6cc1\u4e0b\uff0c\u770b\u8d77\u4f86\u50cf index.php?members/following \u7684 URL\uff0c following \u7684\u90e8\u5206\u5c07\u8868\u793a action\uff0c\u4e26\u7c21\u55ae\u5730\u8207\u666e\u901a\u7684 members/ \u8def\u7531\u9032\u884c\u5339\u914d\u3002 \u4f46\u662f\uff0c\u5982\u679c\u6709\u4e00\u500b\u8def\u7531\u5339\u914d\u4e86\u524d\u7db4 \"members\" \u548c\u5f8c\u9762\u7684 \"Sub-names\"\uff0c\u5c31\u6703\u88ab\u4f7f\u7528\u3002 \u9019\u88e1\u4e5f\u662f\u5982\u6b64\uff0c\u6240\u4ee5\u5b83\u5efa\u7acb\u4e86\u4e00\u500b\u50cf\u662f\u4e0b\u9762\u7684\u9023\u7d50\uff1a members/:int<user_id,username>/following/:page \u5c0d\u65bc\u50b3\u5165\u8def\u7531\u7684\u5339\u914d\uff0c\u8a72\u8def\u7531\u5c07\u5728\u57fa\u672c\u6210\u54e1\u8def\u7531\u4e4b\u524d\u9032\u884c\u6e2c\u8a66\uff1b\u5982\u679c\u5339\u914d\uff0c\u5247\u4f7f\u7528\u8a72\u8def\u7531\u3002 \u9019\u7a2e sub-name \u7cfb\u7d71\u5141\u8a31\u884c\u70ba\u6539\u8b8a\uff0c\u4f8b\u5982\u6539\u8b8a\u53c3\u6578\u7684\u4f4d\u7f6e\u6216\u8005\u5c07\u8def\u7531\u5206\u7d44\u5230\u4e0d\u540c\u7684 Controller \u4e2d\u6216\u4f7f\u7528\u4e0d\u540c\u7684\u53c3\u6578\u3002 \u60a8\u53ef\u4ee5\u5728\u8cc7\u6e90\u7ba1\u7406\u5668\u548c\u5a92\u9ad4\u5eab\u9644\u52a0\u5143\u4ef6\u4e2d\u770b\u5230\u5f8c\u8005\u7684\u4f8b\u5b50\u3002","title":"Sub-names"},{"location":"scotchbox/","text":"\u9644\u9304: Scotch Box \u00b6 \u4e0b\u9762\u4ecb\u7d39\u5982\u4f55\u5c07\u512a\u79c0\u7684 Scotch Box \u5b89\u88dd\u5230\u81ea\u5df1\u7684\u96fb\u8166\u4e0a\uff0c\u4ee5\u4fbf\u5728\u5e7e\u5206\u9418\u5167\u901a\u904e\u7c21\u55ae\u7684\u547d\u4ee4\u5c31\u80fd\u64c1\u6709\u4e00\u500b\u5b8c\u5168\u53ef\u64cd\u4f5c\u7684 XenForo \u958b\u767c\u74b0\u5883\u3002 XenForo \u6709\u81ea\u5b9a\u7fa9\u7684 Scotch Box \u914d\u7f6e\uff0c\u5b83\u63d0\u4f9b\u4e86\u57f7\u884c XenForo \u6240\u9700\u7684\u4e00\u5207\uff0c\u5305\u62ec\u5075\u932f\u7a0b\u5f0f\u548c\u6548\u80fd\u589e\u5f37\u7684\u8cc7\u6599\u5feb\u53d6\u3002 Scotch Box \u7684\u904b\u884c\u74b0\u5883\u5728 VirtualBox / Vagrant \u4e2d\u3002 \u5b89\u88dd Scotch Box \u865b\u64ec\u6a5f \u00b6 \u9996\u5148\u78ba\u5b9a\u60a8\u5e0c\u671b\u865b\u64ec Web \u4f3a\u670d\u5668\u5728\u96fb\u8166\u4e0a\u5132\u5b58\u5176\u6a94\u6848\u7684\u4f4d\u7f6e\u3002\u5efa\u8b70\u60a8\u5728\u81ea\u5df1\u7684\u7528\u6236\u4e3b\u76ee\u9304\u4e2d\u9078\u64c7\u4e00\u500b\u4f4d\u7f6e\u3002 \u5728\u4ee5\u4e0b\u793a\u4f8b\u4f4d\u7f6e\uff0c\u6211\u5011\u5c07\u4f7f\u7528\u540d\u70ba MyServer \u7684\u76ee\u9304\uff0c\u6b64\u76ee\u9304\u4f4d\u65bc\u60a8\u81ea\u5df1\u4f7f\u7528\u8005\u76ee\u9304\u7684\u6839\u76ee\u9304\u4e2d\uff0c\u4e26\u7531\u60a8\u7684\u540d\u7a31 {username} \u6a19\u8b58\uff1a /Users/{username}/MyServer \uff08Mac\uff09 C:\\Users\\{username}\\MyServer \uff08Windows\uff09 /home/{username}/MyServer \uff08\u67d0\u4e9b Linux \u767c\u884c\u7248\u672c\uff09 /users/{username}/MyServer \uff08\u5176\u4ed6 Linux \u767c\u884c\u7248\u672c\uff09 \u9078\u64c7\u4f4d\u7f6e\u5f8c\uff0c\u8acb\u6309\u7167\u4ee5\u4e0b\u6b65\u9a5f\u64cd\u4f5c\uff1a \u5728\u96fb\u8166\u4e0a\u5b89\u88dd VirtualBox \u5728\u96fb\u8166\u4e0a\u5b89\u88dd Vagrant \u4f7f\u7528 git \u5ba2\u6236\u7aef\uff0cclone https://github.com/scotch-io/scotch-box \u5230 MyServer \u76ee\u9304\u4e2d\u3002\u5728\u4e0a\u9762\u7684 Mac \u793a\u4f8b\u4f4d\u7f6e\u4e2d\u4f7f\u7528\u547d\u4ee4\u884c Client \u7aef\uff0c\u6307\u4ee4\u662f\uff1a git clone https://github.com/scotch-io/scotch-box /Users/{username}/MyServer clone \u904e\u7a0b\u5b8c\u6210\u5f8c\uff0c\u4e0b\u8f09\u6b64\u81ea\u5b9a\u7fa9 Vagrantfile \u4e26\u8986\u84cb\u5728 */Users/{username}/MyServer/Vagrantfile \u4e2d\u5275\u5efa\u7684 Vagrantfile : \u4e0b\u8f09\u81ea\u5b9a\u7fa9 Vagrantfile \u3002 \u81ea\u5b9a\u7fa9 Vagrantfile \u653e\u7f6e\u5230\u4f4d\u5f8c\uff0c\u57f7\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a cd /Users/{username}/MyServer vagrant up \u60a8\u7684 Scotch Box \u865b\u64ec\u6a5f\u73fe\u5728\u5df2\u7d93\u5275\u5efa\u4e26\u53ef\u4ee5\u4f7f\u7528\u3002 Note Scotch Box \u9084\u63d0\u4f9b\u4e86\u4e00\u500b ' Scotch Box Pro ' \u7248\u672c\u7684\u865b\u64ec\u6a5f\uff0c\u8cfc\u8cb7\u50f9\u683c\u5408\u7406\u3002\u5982\u679c\u4f60\u6bd4\u8f03\u504f\u5411\u559c\u6b61\u4f7f\u7528 Scotch Box Pro\uff0c\u8acb\u53c3\u95b1\u4e0b\u9762\u7684\u90e8\u5206 \u4ecb\u7d39 Scotch Box \u548c Scotch Box Pro \u5728\u914d\u7f6e\u548c\u57f7\u884c\u4e4b\u9593\u7684\u5dee\u7570 \u3002 \u6a94\u6848\u90fd\u5728\u54ea\u5152\uff1f \u00b6 \u4e00\u65e6\u60a8\u7684 Scotch Box \u555f\u52d5\u4e26\u57f7\u884c\u5f8c\uff0c\u60a8\u53ef\u4ee5\u5c07 XenForo \u7684 PHP \u548c JS \u6a94\u6848\u4fdd\u7559\u5728\u60a8\u7684\u4e3b\u6a5f\u4e0a\uff0c\u5f9e\u800c\u5141\u8a31\u60a8\u4f7f\u7528\u60a8\u6240\u9078\u64c7\u7684\u6587\u5b57\u7de8\u8f2f\u5668\u6216 IDE\uff0c\u800c\u865b\u64ec\u6a5f\u5247\u8ca0\u8cac\u901a\u904e\u5176 Web \u4f3a\u670d\u5668\u7de8\u8b6f\u548c\u63d0\u4f9b\u9019\u4e9b\u6a94\u6848\u3002 \u60a8\u5c07\u80fd\u5920\u901a\u904e\u4ee5\u4e0b\u5730\u5740\u5728 Web \u700f\u89bd\u5668\u4e2d\u8a2a\u554f\u65b0\u7684 Web \u4f3a\u670d\u5668\uff1a http://192.168.33.10 Web \u4f3a\u670d\u5668\u5c07\u5f9e\u4ee5\u4e0b\u4f4d\u7f6e\u63d0\u53d6\u8981\u63d0\u4f9b\u7684\u6a94\u6848 /Users/{username}/MyServer/public \u5982\u679c\u4f60\u5e0c\u671b XenForo \u5b89\u88dd\u5728 http://192.168.33.10/xenforo \uff0c\u4f60\u61c9\u8a72\u628a XenForo \u5305\u4e2d upload \u8cc7\u6599\u593e\u7684\u5167\u5bb9\u653e\u5230 /Users/{username}/MyServer/public/xenforo \u4e2d\u3002 \u505c\u6b62\u548c\u91cd\u65b0\u555f\u52d5\u4f3a\u670d\u5668 \u00b6 \u60a8\u53ef\u4ee5\u5728\u4efb\u4f55\u6642\u5019\u901a\u904e\u57f7\u884c\u4ee5\u4e0b\u6307\u4ee4\u505c\u6b62 Scotch Box \u4f3a\u670d\u5668 cd /Users/{username}/MyServer vagrant halt ... \uff0c\u4e26\u4e14\u60a8\u53ef\u4ee5\u901a\u904e\u57f7\u884c\u91cd\u65b0\u555f\u52d5\u5b83 cd /Users/{username}/MyServer vagrant up Note \u96d6\u7136 Vagrant / Scotch Box \u6703\u5728\u60a8\u91cd\u65b0\u555f\u52d5\u96fb\u8166\u6642\u81ea\u52d5\u95dc\u9589\uff0c\u4f46\u5b83\u4e0d\u6703\u81ea\u52d5\u518d\u6b21\u555f\u52d5\u3002 \u6bcf\u7576\u60a8\u91cd\u65b0\u555f\u52d5\u6642\uff0c\u60a8\u9700\u8981\u518d\u6b21\u57f7\u884c vagrant up \u6307\u4ee4\u624d\u80fd\u4f7f\u7528\u4f3a\u670d\u5668\u3002 \u5b98\u65b9\u6587\u4ef6 \u00b6 \u672c\u6307\u5357\u6458\u81ea Scotch Box \u5b98\u65b9\u6587\u4ef6\uff0c\u8a72\u6587\u4ef6\u4f4d\u65bc https://box.scotch.io Scotch Box Pro \u00b6 \u57fa\u672c\u7684 Scotch Box \u9700\u8981\u4e00\u4e9b\u984d\u5916\u7684\u914d\u7f6e\uff08\u901a\u904e\u81ea\u5b9a\u7fa9\u7684 Vagrantfile \u4f86\u50b3\u905e\uff09\u624d\u80fd\u57f7\u884c XenForo 2\uff0c\u800c Scotch Box Pro \u4e0d\u9700\u8981\u984d\u5916\u7684\u914d\u7f6e\uff0c\u7121\u9700\u4e0b\u8f09\u984d\u5916\u7684\u5305\u5c31\u53ef\u4ee5\u57f7\u884c XenForo 2\u3002 \u8981\u57f7\u884c Scotch Box Pro\uff0c\u8acb\u5f9e Scotch Box Pro \u7db2\u7ad9\u8cfc\u8cb7\u5b83\uff0c\u5728\u60a8\u8cfc\u8cb7\u5f8c\u5c07\u6703\u6536\u5230\u4e00\u90e8\u5206\u57f7\u884c git clone \u6307\u4ee4\u7684\u6307\u793a\u8aaa\u660e\u3002 \u73fe\u5728\u60a8\u53ef\u4ee5\u4f7f\u7528\u8207\u4e0a\u8ff0\u76f8\u540c\u7684\u8aaa\u660e\u9032\u884c\u5b89\u88dd\uff0c\u552f\u4e00\u7684\u4f8b\u5916\u662f\u60a8\u61c9\u8a72\u4e0b\u8f09 \u6b64\u81ea\u5b9a\u7fa9\u7684 Vagrantfile \uff0c\u800c\u4e0d\u662f Scotch Box \u8aaa\u660e\u4e2d\u5217\u51fa\u7684\u90a3\u500b\u5167\u5bb9\u3002","title":"\u9644\u9304\uff1aScotch Box"},{"location":"scotchbox/#scotch-box","text":"\u4e0b\u9762\u4ecb\u7d39\u5982\u4f55\u5c07\u512a\u79c0\u7684 Scotch Box \u5b89\u88dd\u5230\u81ea\u5df1\u7684\u96fb\u8166\u4e0a\uff0c\u4ee5\u4fbf\u5728\u5e7e\u5206\u9418\u5167\u901a\u904e\u7c21\u55ae\u7684\u547d\u4ee4\u5c31\u80fd\u64c1\u6709\u4e00\u500b\u5b8c\u5168\u53ef\u64cd\u4f5c\u7684 XenForo \u958b\u767c\u74b0\u5883\u3002 XenForo \u6709\u81ea\u5b9a\u7fa9\u7684 Scotch Box \u914d\u7f6e\uff0c\u5b83\u63d0\u4f9b\u4e86\u57f7\u884c XenForo \u6240\u9700\u7684\u4e00\u5207\uff0c\u5305\u62ec\u5075\u932f\u7a0b\u5f0f\u548c\u6548\u80fd\u589e\u5f37\u7684\u8cc7\u6599\u5feb\u53d6\u3002 Scotch Box \u7684\u904b\u884c\u74b0\u5883\u5728 VirtualBox / Vagrant \u4e2d\u3002","title":"\u9644\u9304: Scotch Box"},{"location":"scotchbox/#scotch-box_1","text":"\u9996\u5148\u78ba\u5b9a\u60a8\u5e0c\u671b\u865b\u64ec Web \u4f3a\u670d\u5668\u5728\u96fb\u8166\u4e0a\u5132\u5b58\u5176\u6a94\u6848\u7684\u4f4d\u7f6e\u3002\u5efa\u8b70\u60a8\u5728\u81ea\u5df1\u7684\u7528\u6236\u4e3b\u76ee\u9304\u4e2d\u9078\u64c7\u4e00\u500b\u4f4d\u7f6e\u3002 \u5728\u4ee5\u4e0b\u793a\u4f8b\u4f4d\u7f6e\uff0c\u6211\u5011\u5c07\u4f7f\u7528\u540d\u70ba MyServer \u7684\u76ee\u9304\uff0c\u6b64\u76ee\u9304\u4f4d\u65bc\u60a8\u81ea\u5df1\u4f7f\u7528\u8005\u76ee\u9304\u7684\u6839\u76ee\u9304\u4e2d\uff0c\u4e26\u7531\u60a8\u7684\u540d\u7a31 {username} \u6a19\u8b58\uff1a /Users/{username}/MyServer \uff08Mac\uff09 C:\\Users\\{username}\\MyServer \uff08Windows\uff09 /home/{username}/MyServer \uff08\u67d0\u4e9b Linux \u767c\u884c\u7248\u672c\uff09 /users/{username}/MyServer \uff08\u5176\u4ed6 Linux \u767c\u884c\u7248\u672c\uff09 \u9078\u64c7\u4f4d\u7f6e\u5f8c\uff0c\u8acb\u6309\u7167\u4ee5\u4e0b\u6b65\u9a5f\u64cd\u4f5c\uff1a \u5728\u96fb\u8166\u4e0a\u5b89\u88dd VirtualBox \u5728\u96fb\u8166\u4e0a\u5b89\u88dd Vagrant \u4f7f\u7528 git \u5ba2\u6236\u7aef\uff0cclone https://github.com/scotch-io/scotch-box \u5230 MyServer \u76ee\u9304\u4e2d\u3002\u5728\u4e0a\u9762\u7684 Mac \u793a\u4f8b\u4f4d\u7f6e\u4e2d\u4f7f\u7528\u547d\u4ee4\u884c Client \u7aef\uff0c\u6307\u4ee4\u662f\uff1a git clone https://github.com/scotch-io/scotch-box /Users/{username}/MyServer clone \u904e\u7a0b\u5b8c\u6210\u5f8c\uff0c\u4e0b\u8f09\u6b64\u81ea\u5b9a\u7fa9 Vagrantfile \u4e26\u8986\u84cb\u5728 */Users/{username}/MyServer/Vagrantfile \u4e2d\u5275\u5efa\u7684 Vagrantfile : \u4e0b\u8f09\u81ea\u5b9a\u7fa9 Vagrantfile \u3002 \u81ea\u5b9a\u7fa9 Vagrantfile \u653e\u7f6e\u5230\u4f4d\u5f8c\uff0c\u57f7\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a cd /Users/{username}/MyServer vagrant up \u60a8\u7684 Scotch Box \u865b\u64ec\u6a5f\u73fe\u5728\u5df2\u7d93\u5275\u5efa\u4e26\u53ef\u4ee5\u4f7f\u7528\u3002 Note Scotch Box \u9084\u63d0\u4f9b\u4e86\u4e00\u500b ' Scotch Box Pro ' \u7248\u672c\u7684\u865b\u64ec\u6a5f\uff0c\u8cfc\u8cb7\u50f9\u683c\u5408\u7406\u3002\u5982\u679c\u4f60\u6bd4\u8f03\u504f\u5411\u559c\u6b61\u4f7f\u7528 Scotch Box Pro\uff0c\u8acb\u53c3\u95b1\u4e0b\u9762\u7684\u90e8\u5206 \u4ecb\u7d39 Scotch Box \u548c Scotch Box Pro \u5728\u914d\u7f6e\u548c\u57f7\u884c\u4e4b\u9593\u7684\u5dee\u7570 \u3002","title":"\u5b89\u88dd Scotch Box \u865b\u64ec\u6a5f"},{"location":"scotchbox/#_1","text":"\u4e00\u65e6\u60a8\u7684 Scotch Box \u555f\u52d5\u4e26\u57f7\u884c\u5f8c\uff0c\u60a8\u53ef\u4ee5\u5c07 XenForo \u7684 PHP \u548c JS \u6a94\u6848\u4fdd\u7559\u5728\u60a8\u7684\u4e3b\u6a5f\u4e0a\uff0c\u5f9e\u800c\u5141\u8a31\u60a8\u4f7f\u7528\u60a8\u6240\u9078\u64c7\u7684\u6587\u5b57\u7de8\u8f2f\u5668\u6216 IDE\uff0c\u800c\u865b\u64ec\u6a5f\u5247\u8ca0\u8cac\u901a\u904e\u5176 Web \u4f3a\u670d\u5668\u7de8\u8b6f\u548c\u63d0\u4f9b\u9019\u4e9b\u6a94\u6848\u3002 \u60a8\u5c07\u80fd\u5920\u901a\u904e\u4ee5\u4e0b\u5730\u5740\u5728 Web \u700f\u89bd\u5668\u4e2d\u8a2a\u554f\u65b0\u7684 Web \u4f3a\u670d\u5668\uff1a http://192.168.33.10 Web \u4f3a\u670d\u5668\u5c07\u5f9e\u4ee5\u4e0b\u4f4d\u7f6e\u63d0\u53d6\u8981\u63d0\u4f9b\u7684\u6a94\u6848 /Users/{username}/MyServer/public \u5982\u679c\u4f60\u5e0c\u671b XenForo \u5b89\u88dd\u5728 http://192.168.33.10/xenforo \uff0c\u4f60\u61c9\u8a72\u628a XenForo \u5305\u4e2d upload \u8cc7\u6599\u593e\u7684\u5167\u5bb9\u653e\u5230 /Users/{username}/MyServer/public/xenforo \u4e2d\u3002","title":"\u6a94\u6848\u90fd\u5728\u54ea\u5152\uff1f"},{"location":"scotchbox/#_2","text":"\u60a8\u53ef\u4ee5\u5728\u4efb\u4f55\u6642\u5019\u901a\u904e\u57f7\u884c\u4ee5\u4e0b\u6307\u4ee4\u505c\u6b62 Scotch Box \u4f3a\u670d\u5668 cd /Users/{username}/MyServer vagrant halt ... \uff0c\u4e26\u4e14\u60a8\u53ef\u4ee5\u901a\u904e\u57f7\u884c\u91cd\u65b0\u555f\u52d5\u5b83 cd /Users/{username}/MyServer vagrant up Note \u96d6\u7136 Vagrant / Scotch Box \u6703\u5728\u60a8\u91cd\u65b0\u555f\u52d5\u96fb\u8166\u6642\u81ea\u52d5\u95dc\u9589\uff0c\u4f46\u5b83\u4e0d\u6703\u81ea\u52d5\u518d\u6b21\u555f\u52d5\u3002 \u6bcf\u7576\u60a8\u91cd\u65b0\u555f\u52d5\u6642\uff0c\u60a8\u9700\u8981\u518d\u6b21\u57f7\u884c vagrant up \u6307\u4ee4\u624d\u80fd\u4f7f\u7528\u4f3a\u670d\u5668\u3002","title":"\u505c\u6b62\u548c\u91cd\u65b0\u555f\u52d5\u4f3a\u670d\u5668"},{"location":"scotchbox/#_3","text":"\u672c\u6307\u5357\u6458\u81ea Scotch Box \u5b98\u65b9\u6587\u4ef6\uff0c\u8a72\u6587\u4ef6\u4f4d\u65bc https://box.scotch.io","title":"\u5b98\u65b9\u6587\u4ef6"},{"location":"scotchbox/#scotch-box-pro","text":"\u57fa\u672c\u7684 Scotch Box \u9700\u8981\u4e00\u4e9b\u984d\u5916\u7684\u914d\u7f6e\uff08\u901a\u904e\u81ea\u5b9a\u7fa9\u7684 Vagrantfile \u4f86\u50b3\u905e\uff09\u624d\u80fd\u57f7\u884c XenForo 2\uff0c\u800c Scotch Box Pro \u4e0d\u9700\u8981\u984d\u5916\u7684\u914d\u7f6e\uff0c\u7121\u9700\u4e0b\u8f09\u984d\u5916\u7684\u5305\u5c31\u53ef\u4ee5\u57f7\u884c XenForo 2\u3002 \u8981\u57f7\u884c Scotch Box Pro\uff0c\u8acb\u5f9e Scotch Box Pro \u7db2\u7ad9\u8cfc\u8cb7\u5b83\uff0c\u5728\u60a8\u8cfc\u8cb7\u5f8c\u5c07\u6703\u6536\u5230\u4e00\u90e8\u5206\u57f7\u884c git clone \u6307\u4ee4\u7684\u6307\u793a\u8aaa\u660e\u3002 \u73fe\u5728\u60a8\u53ef\u4ee5\u4f7f\u7528\u8207\u4e0a\u8ff0\u76f8\u540c\u7684\u8aaa\u660e\u9032\u884c\u5b89\u88dd\uff0c\u552f\u4e00\u7684\u4f8b\u5916\u662f\u60a8\u61c9\u8a72\u4e0b\u8f09 \u6b64\u81ea\u5b9a\u7fa9\u7684 Vagrantfile \uff0c\u800c\u4e0d\u662f Scotch Box \u8aaa\u660e\u4e2d\u5217\u51fa\u7684\u90a3\u500b\u5167\u5bb9\u3002","title":"Scotch Box Pro"},{"location":"template-syntax/","text":"\u6a21\u677f\u8a9e\u6cd5 \u00b6 XenForo 2 \u6a21\u677f\u8a9e\u6cd5\u5c0d\u65bc\u958b\u767c\u4eba\u54e1\u548c\u8ad6\u58c7\u7ba1\u7406\u54e1\u90fd\u662f\u5f37\u5927\u7684\u5de5\u5177\uff0c\u4f7f\u60a8\u53ef\u4ee5\u5b8c\u5168\u63a7\u5236 XenForo \u9801\u9762\u7684\u6392\u7248\u3002 \u6700\u4f73\u793a\u4f8b \u00b6 \u6309\u7167\u6163\u4f8b\uff0cXenForo \u7684\u6a19\u7c64\u662f lowercase \u3002 \u6240\u6709 XenForo \u6a19\u7c64\u90fd\u4ee5 xf: \u547d\u540d\u7a7a\u9593\u70ba\u524d\u7db4\u3002 \u6709\u5e6b\u52a9\u7684\u8a0a\u606f \u00b6 \u5c0d\u6a21\u677f\u9032\u884c\u8a3b\u91cb \u00b6 \u5982\u679c\u60a8\u60f3\u8a3b\u91cb\u6389\u4e00\u4e9b\u60a8\u4e0d\u60f3\u5728\u6700\u7d42\u9801\u9762\u539f\u59cb\u78bc\u4e2d\u770b\u5230\u7684\u6a21\u677f\u4ee3\u78bc\uff08\u6216\u8005\u52f5\u5fd7\u7684\u8a0a\u606f\uff09\uff0c\u5247\u53ef\u4ee5\u4f7f\u7528 xf:comment \u6a19\u7c64\u3002 <xf:comment> \u5982\u679c\u4f60\u4e0d\u518d\u4ee5\u4f60\u559c\u6b61\u4ec0\u9ebc\u548c\u4e0d\u559c\u6b61\u4ec0\u9ebc\u4f86\u770b\u5f85\u9019\u500b\u4e16\u754c\uff0c \u800c\u662f\u770b\u5230\u4e86\u4e8b\u7269\u672c\u8eab\u7684\u771f\u5be6\u9762\u76ee\uff0c \u4f60\u5c31\u6703\u767c\u73fe\u4f60\u7684\u751f\u6d3b\u5c07\u6703\u66f4\u52a0\u5730\u7965\u548c\u3002 </xf:comment> \u5728\u6a21\u677f\u4e2d\u52a0\u5165\u53e6\u4e00\u500b\u6a21\u677f \u00b6 xf:include \u6a19\u7c64\u5141\u8a31\u4f60\u5728\u7576\u524d\u6a21\u677f\u4e2d\u52a0\u5165\u4e00\u500b\u4e0d\u540c\u7684\u6a21\u677f\u3002 <xf:include template=\"my_template\" /> \u53ea\u9700\u5c07 template \u5c6c\u6027\u8a2d\u5b9a\u70ba\u4f60\u60f3\u52a0\u5165\u7684\u6a21\u677f\u540d\u7a31\u5373\u53ef\u3002 \u6a21\u677f\u5de8\u96c6 \u00b6 \u6a21\u677f\u5de8\u96c6\u662f XenForo \u6a21\u677f\u8a9e\u6cd5\u7684\u4e00\u500b\u975e\u5e38\u5f37\u5927\u7684\u90e8\u5206\u3002 \u901a\u5e38\uff0c\u4f60\u61c9\u8a72\u5728\u7a0b\u5f0f\u8a2d\u8a08\u8a9e\u8a00\u4e2d\u4f7f\u7528\u51fd\u6578\u6216\u5b50\u7a0b\u5f0f\u7684\u4efb\u4f55\u5730\u65b9\u4f7f\u7528\u5de8\u96c6\u3002 \u5c0d\u65bc\u975e\u7a0b\u5f0f\u8a2d\u8a08\u5e2b\u4f86\u8aaa\uff0c\u6211\u628a\u9019\u4e00\u9ede\u7e3d\u7d50\u70ba\uff1a \u8981\u9ebc\u5728 \u4efb\u4f55\u60a8\u60f3\u5728\u591a\u500b\u4e0d\u540c\u6a94\u6848\u4e2d\u591a\u6b21\u7522\u751f\u76f8\u540c\u4e8b\u7269\u7684\u5730\u65b9\u4f7f\u7528\u5de8\u96c6\uff0c \u6216\u8005 \u5728\u4e0d\u540c\u60c5\u6cc1\u4e0b\u7522\u751f\u4e0d\u540c\u7684\u6771\u897f\uff08\u5982\u679c\u4f60\u67e5\u770b\u5b9a\u7fa9\u5de8\u96c6\u7684\u6307\u5357\uff0c\u9019\u53ef\u80fd\u6703\u66f4\u6709\u5e6b\u52a9\uff09\u3002 Warning \u51fa\u65bc\u53ef\u8b80\u6027\u539f\u56e0\uff0c\u60a8\u4e0d\u61c9\u8a72\u4f7f\u7528\u5de8\u96c6\u6a19\u7c64\u4f5c\u70ba\u8b8a\u6578\u3002 \u60a8\u61c9\u8a72\u4f7f\u7528 Set \u6a19\u7c64\uff0c\u4e26\u50cf\u5c0d\u5f85\u4efb\u4f55\u6a21\u677f\u8b8a\u91cf\u4e00\u6a23\u5c0d\u5f85\u8b8a\u91cf\u3002 \u5b9a\u7fa9\u5de8\u96c6 \u00b6 <xf:macro name=\"my_macro_name\"> <!-- \u4f60\u7684\u5de8\u96c6\u5167\u5bb9 --> </xf:macro> \u6700\u7c21\u55ae\u7684\uff0c\u53ef\u4ee5\u7528 name \u5c6c\u6027\u5b9a\u7fa9\u4e00\u500b\u5de8\u96c6\uff0c\u4e26\u5728\u5de8\u96c6\u6a19\u7c64\u4e2d\u91cd\u8907\u4f60\u60f3\u8981\u7684\u5167\u5bb9\u3002 Note \u7576\u60a8\u5728\u591a\u500b\u6a94\u6848\u4e2d\u4f7f\u7528\u5de8\u96c6\u6642\uff0c\u6700\u4f73\u505a\u6cd5\u662f\u5c07\u5de8\u96c6\u653e\u5165\u81ea\u5df1\u7684\u6a21\u677f\u4e2d\u3002 \u5de8\u96c6\u53c3\u6578 \u00b6 <xf:macro name=\"my_macro_name\" arg-message=\"\u6211\u8d85\u53b2\u5bb3\u7684\u5de8\u96c6\u8a0a\u606f\uff01\"> <h1>\u8a0a\u606f</h1> <p>{$message}</p> </xf:macro> \u5728\u6b64\u793a\u4f8b\u4e2d\uff0c\u70ba\u5de8\u96c6\u5b9a\u7fa9\u4e86 arg-message ( \u6211\u9a5a\u4eba\u7684\u5de8\u96c6\u8a0a\u606f\uff01 ) \u7684\u9810\u8a2d\u503c\u3002 \u5982\u679c\u4f7f\u7528 message \u53c3\u6578\u547c\u53eb\u5de8\u96c6\uff0c\u5247\u8a72\u503c\u5c07\u88ab\u8986\u84cb\u3002 \u6709\u6642\u9700\u8981\u5c07\u4e00\u500b\u53c3\u6578\u6a19\u8a18\u70ba\u5fc5\u586b\u9805\u3002 \u9019\u53ef\u4ee5\u901a\u904e\u5728\u5de8\u96c6\u5b9a\u7fa9\u4e2d\u628a\u53c3\u6578\u503c\u8a2d\u5b9a\u70ba ! \u4f86\u5be6\u73fe\u3002 \u52a0\u5165\u548c\u4f7f\u7528\u5de8\u96c6 \u00b6 <xf:macro template=\"my_macro_template\" name=\"my_macro_name\" /> \u6700\u7c21\u55ae\u7684\u65b9\u6cd5\u662f\uff0c\u901a\u904e\u8a2d\u7f6e name \u5c6c\u6027\u4e26\u5c07\u6a19\u7c64\u4fdd\u7559\u70ba\u7a7a\u4f86\u52a0\u5165\u5de8\u96c6\u3002 Note \u4f7f\u7528\u5de8\u96c6\u6a19\u7c64\u6642\uff0c\u4f60\u61c9\u8a72\u4f7f\u7528\u6a19\u7c64\u7684\u81ea\u52d5\u95dc\u9589\u5f62\u5f0f\uff0c\u4ee5\u4fbf\u8b93\u5225\u4eba\u66f4\u5bb9\u6613\u5340\u5206\u5de8\u96c6\u7684\u5b9a\u7fa9\u548c\u7528\u6cd5\u7684\u5340\u5225\u3002 \u5de8\u96c6\u53c3\u6578 \u00b6 \u60a8\u9084\u53ef\u4ee5\u70ba\u5de8\u96c6\u63d0\u4f9b\u53c3\u6578\uff1a <xf:macro template=\"my_macro_template\" name=\"my_macro_name\" arg-argName=\"argValue\" /> \u5176\u4e2d argName \u662f\u5de8\u96c6\u53c3\u6578\u7684\u540d\u7a31\u3002 Note \u60a8\u61c9\u8a72\u4f7f\u7528 lowerCamelCase \u4f86\u547d\u540d\u4f60\u7684\u5de8\u96c6\u53c3\u6578\u3002 \u6a21\u677f\u63a7\u5236\u7d50\u69cb \u00b6 XenForo 2 \u6a21\u677f\u8a9e\u6cd5\u652f\u63f4\u67d0\u4e9b\u63a7\u5236\u5143\u4ef6\u7d50\u69cb\uff0c\u4ee5\u4f7f\u67d0\u4e9b\u4efb\u52d9\u66f4\u6613\u65bc\u5be6\u73fe\u3002 If \u6a19\u7c64 \u00b6 if \u6a21\u677f\u6a19\u7c64\u53ef\u7528\u65bc\u6709\u689d\u4ef6\u5730\u986f\u793a\u4e00\u4e9b HTML \u6216\u6a21\u677f\u7684\u4e00\u90e8\u5206\u3002 <!-- Shows content only if a user is signed in... --> <xf:if is=\"$xf.visitor.user_id\"> <!-- \u505a\u9ede\u4ec0\u9ebc... --> </xf:if> if \u6a19\u7c64\u5177\u6709\u4ee5\u4e0b\u5c6c\u6027\uff1a is - \u6eff\u8db3\u689d\u4ef6\u6642\u61c9\u986f\u793a\u6a19\u7c64\u5167\u5bb9\u7684\u689d\u4ef6\u3002 \u689d\u4ef6 \u00b6 \u8a72 is \u5c6c\u6027\u652f\u63f4\u4e00\u4e9b\u908f\u8f2f\u904b\u7b97\u7b26\uff1a OR - \u7528\u65bc\u9023\u63a5\u66ff\u4ee3\u689d\u4ef6\u3002\uff08\u4e8c\u64c7\u4e00\uff1a || \uff09 AND - \u7528\u65bc\u9023\u63a5\u5176\u4ed6\u689d\u4ef6\u3002 (\u4e8c\u64c7\u4e00: && \uff09 ! - \u653e\u5728\u689d\u4ef6\u524d\uff0c\u4f7f\u5176\u53cd\u8f49\u3002\uff08\u7a31\u70ba\uff1a\"\u5426\"\uff09 XOR - \u5982\u679c\u5169\u500b\u689d\u4ef6\u4e2d\u53ea\u6709\u4e00\u500b\u70ba true\uff0c\u5247\u8fd4\u56de true\u3002\uff08\u7a31\u70ba\uff1a\"\u7570\u6216\"\uff09 Else/Else-If \u6a19\u7c64 \u00b6 else \u548c else-if \u6a19\u7c64\u8207 if \u6a19\u7c64\u7d50\u5408\u4f7f\u7528\uff0c\u4ee5\u6309\u540d\u7a31\u5efa\u8b70\u7684\u65b9\u5f0f\u6709\u689d\u4ef6\u5730\u986f\u793a HTML\u3002 else \u7528\u6cd5\u793a\u4f8b\uff1a <xf:if is=\"$xf.visitor.is_admin\"> <!-- \u9019\u88e1\u7684\u5167\u5bb9\u53ea\u6709\u7ba1\u7406\u54e1\u624d\u6703\u770b\u5230... --> <xf:else /> <!-- \u9019\u88e1\u7684\u5167\u5bb9\u5c07\u88ab\u986f\u793a\u7d66\u4efb\u4f55\u975e\u7ba1\u7406\u54e1\u7684\u4eba\u770b\u5230\uff01 --> </xf:if> else-if \u7684\u7528\u6cd5\u793a\u4f8b\uff1a <xf:if is=\"$xf.visitor.is_admin\"> <!-- \u9019\u88e1\u7684\u5167\u5bb9\u53ea\u6709\u7ba1\u7406\u54e1\u624d\u6703\u770b\u5230... --> <xf:elseif is=\"$xf.visitor.is_moderator\" /> <!-- \u9019\u88e1\u7684\u5167\u5bb9\u53ea\u6703\u986f\u793a\u7d66\u7248\u4e3b(\u4e0d\u5305\u62ec\u517c\u4efb\u7ba1\u7406\u54e1\u7684\u7528\u6236)\u3002 --> <xf:else /> <!-- \u9019\u88e1\u7684\u5167\u5bb9\u5c07\u986f\u793a\u7d66\u975e\u7ba1\u7406\u54e1\u6216\u7248\u4e3b\u7684\u4efb\u4f55\u4eba\u3002 --> </xf:if> \u6b63\u5982\u4f60\u6240\u770b\u5230\u7684\uff0c\u4e00\u65e6\u4e00\u500b\u689d\u4ef6\u88ab\u6eff\u8db3\uff0c\u5176\u9918\u7684 if \u8a9e\u53e5\u5c07\u88ab\u5ffd\u7565\u3002\uff08\u6240\u4ee5\uff0c\u5728\u9019\u7a2e\u60c5\u6cc1\u4e0b\uff0c\u5982\u679c\u4f7f\u7528\u8005\u662f\u7ba1\u7406\u54e1\uff0c\u4e0a\u9762\u7684 xf:if \u90e8\u5206\u88ab\u57f7\u884c\uff0c\u5176\u9918\u7684 if \u8a9e\u53e5\u5247\u88ab\u5ffd\u7565\u3002) For-each \u6a19\u7c64 \u00b6 for-each \u6a19\u7c64\u4f7f\u60a8\u53ef\u4ee5\u904d\u6b77\u9805\u76ee\u9663\u5217\uff0c\u70ba\u6bcf\u500b\u9805\u76ee\u5370\u51fa HTML \u5340\u584a\u3002 <xf:set var=\"$names\" value=\"{{ ['\u6d3e\u7fe0\u514b', '\u7279\u9e97\u838e', '\u91d1\u535a\u723e', '\u97cb\u6069', '\u683c\u96f7\u65af'] }}\" /> <xf:foreach loop=\"$names\" key=\"$key\" value=\"$name\" i=\"$i\"> <p>\u4f60\u597d\uff0c {$name}\u3002 \u9019\u662f\u540d\u5b57 {$i} \u3002 \u8a72\u5143\u7d20\u7684\u9663\u5217 key \u503c\u70ba\uff1a {$key}</p> </xf:foreach> for-each \u6a19\u7c64\u5177\u6709\u4ee5\u4e0b\u5c6c\u6027\uff1a loop - \u8981\u5faa\u74b0\u7684\u9663\u5217\u3002 key - \u5728\u5faa\u74b0\u4e2d\u4f7f\u7528\u7684\u8b8a\u6578\u540d\u7a31\uff0c\u4ee5\u7372\u53d6\u7576\u524d\u5143\u7d20\u7684\u9663\u5217 key\u3002 \u53ef\u4ee5\u662f\u6574\u6578\uff08\u666e\u901a\u9663\u5217\uff09\u6216\u5b57\u4e32\uff08\u95dc\u806f\u9663\u5217\uff09\u3002 value - \u5728\u5faa\u74b0\u4e2d\u4f7f\u7528\u7684\u8b8a\u6578\u540d\u7a31\uff0c\u5305\u542b\u7576\u524d\u9663\u5217\u9805\u3002 i - \u5728\u5faa\u74b0\u4e2d\u7528\u65bc\u7576\u524d\u7d22\u5f15\u7684\u8b8a\u6578\u540d\u7a31\u3002 \u8f38\u51fa\u793a\u4f8b \u00b6 \u4f60\u597d\uff0c\u6d3e\u7fe0\u514b\u3002 \u9019\u662f\u540d\u5b57 1\u3002 \u4f60\u597d\uff0c\u7279\u9e97\u838e\u3002 \u9019\u662f\u540d\u5b57 2\u3002 \u4f60\u597d\uff0c\u91d1\u535a\u723e\u3002 \u9019\u662f\u540d\u5b57 3\u3002 \u4f60\u597d\uff0c\u97cb\u6069\u3002 \u9019\u662f\u540d\u5b57 4\u3002 \u4f60\u597d\uff0c\u683c\u96f7\u65af\u3002 \u9019\u662f\u540d\u5b57 5\u3002 \u6a21\u677f\u6a19\u7c64 \u00b6 \u982d\u50cf\u6a19\u7c64 \u00b6 \u5728\u9801\u9762\u4e2d\u63d2\u5165\u7528\u6236\u7684\u982d\u50cf\u3002 <xf:avatar user=\"{$xf.visitor}\" size=\"o\" canonical=\"true\" /> \u982d\u50cf\u6a19\u7c64\u5177\u6709\u4ee5\u4e0b\u5c6c\u6027\uff1a user - \u8981\u7522\u751f\u982d\u50cf\u7684 XenForo \u7528\u6236\u7269\u4ef6\u3002 size - \u8981\u7522\u751f\u7684\u5716\u7247\u5927\u5c0f\u3002(\u53c3\u898b\u5716\u7247\u5c3a\u5bf8) canonical - \u662f\u5426\u4f7f\u7528\u6709\u5229\u65bc SEO \u7684\u5b8c\u6574 URL\u3002\u8a72\u503c\u53ea\u5c0d custom \u982d\u50cf\u6709\u6548\u3002 notooltip - \u7576\u6ed1\u9f20\u61f8\u505c\u5728\u982d\u50cf\u4e0a\u6642\u986f\u793a\u7684\u5de5\u5177\u63d0\u793a\u662f\u5426\u61c9\u8a72\u88ab\u95dc\u9589\u3002 forcetype - \u53ef\u4ee5\u7528\u4f86\u5f37\u5236\u53d6\u5f97 gravatar \u6216 custom \u982d\u50cf\uff0c\u8a2d\u5b9a\u503c\u70ba\u5176\u4e2d\u4e4b\u4e00\u3002 defaultname - \u5982\u679c user \u5c6c\u6027\u5305\u542b\u4e00\u500b\u7121\u6548\u7684\u4f7f\u7528\u8005\u6642\uff0c\u9810\u8a2d\u8981\u4f7f\u7528\u7684\u4f7f\u7528\u8005\u540d\u7a31\u3002 \u5716\u7247\u5927\u5c0f \u00b6 \u5982\u679c\u63d0\u4f9b\u7684\u982d\u50cf\u5927\u5c0f\u7121\u6548\uff0c\u5247\u4ee3\u78bc\u5c07\u56de\u9000\u5230\u5927\u5c0f ' s '\u3002 o - 384px h - 384px l - 192px m - 96px s - 48px \u9801\u9762\u8def\u5f91\u5c0e\u89bd\u5217\u6a19\u7c64 \u00b6 \u4fee\u6539\u9801\u9762\u8def\u5f91\u5c0e\u89bd\u5217\u3002 <xf:breadcrumb href=\"{{ link('my_page') }}\">{{ phrase('my_page_name') }}</xf:breadcrumb> \u9801\u9762\u8def\u5f91\u5c0e\u89bd\u5217\u6a19\u7c64\u5177\u6709\u4ee5\u4e0b\u5c6c\u6027\uff1a href - \u70ba\u9801\u9762\u8def\u5f91\u5c0e\u89bd\u5217\u4e2d\u7684\u6700\u5f8c\u4e00\u500b\u5143\u7d20\u8a2d\u5b9a\u7684\u9023\u7d50\u3002 \u6a19\u7c64\u7684\u503c\u53ef\u7528\u65bc\u8a2d\u7f6e\u9801\u9762\u8def\u5f91\u5c0e\u89bd\u5217\u4e2d\u6700\u5f8c\u4e00\u500b\u5143\u7d20\u7684\u540d\u7a31\u3002 \u5176\u4ed6\u7528\u6cd5 \u00b6 <xf:breadcrumb source=\"$category.getBreadcrumbs(false)\" /> \u60a8\u9084\u53ef\u4ee5\u901a\u904e source \u5728\u9801\u9762\u8def\u5f91\u5c0e\u89bd\u5217\u6a19\u7c64\u7684\u5c6c\u6027\u4e2d\u547c\u53eb\u51fd\u6578\u4f86\u4ee5\u7a0b\u5f0f\u8a2d\u8a08\u65b9\u5f0f\u5b9a\u7fa9\u81ea\u5df1\u7684\u9801\u9762\u8def\u5f91\u5c0e\u89bd\u5217\u3002 \u8a72 source \u53c3\u6578\u57fa\u672c\u4e0a\u63a1\u7528\u4e00\u500b\u5177\u6709 href \u548c value \u5c6c\u6027\u7684\u7269\u4ef6\u9663\u5217\uff08\u591a\u7dad\u9663\u5217\uff09\uff0c\u5176\u4e2d\u6bcf\u500b\u7269\u4ef6\u90fd\u662f\u4e00\u500b\u9801\u9762\u8def\u5f91\u5c0e\u89bd\u5217\u5143\u7d20\u3002 Note \u5982\u679c\u8981\u66f4\u6539\u6839\u76ee\u9304\u9801\u9762\u8def\u5f91\u5c0e\u89bd\u5217\uff0c\u53ef\u4ee5\u5728 \"\u57fa\u672c\u4fe1\u606f\u9762\u677f\" \u9078\u9805\u90e8\u5206\u4e2d\u66f4\u6539 \"Root breadcrumb\" \u9078\u9805\u3002 \u6309\u9215\u6a19\u7c64 \u00b6 \u6dfb\u52a0\u5177\u6709\u9069\u7576\u985e\u7684\u6309\u9215\u5143\u7d20\u4ee5\u53ca\uff08\u53ef\u9078\uff09\u5716\u793a\u3002 <xf:button icon=\"save\"></xf:button> button \u6a19\u7c64\u5177\u6709\u4ee5\u4e0b\u5c6c\u6027\uff1a icon - \u61c9\u7528\u65bc\u6309\u9215\u7684\u5716\u793a\u985e\u3002(\u53c3\u898b\u6309\u9215\u5716\u793a) \u6309\u9215\u5716\u793a \u00b6 \u9ed8\u8a8d\u60c5\u6cc1\u4e0b\uff0cXenForo \u6309\u9215\u652f\u63f4\u4ee5\u4e0b\u5716\u793a\uff08\u4f7f\u7528CSS\u5275\u5efa\uff09\uff1a add confirm write import export download disable edit save reply quote purchase payment convert search sort upload attach login rate config refresh translate vote result history cancel preview conversation bolt list prev next markRead notificationsOn notificationsOff merge move copy approve unapprove delete undelete stick unstick lock unlock Callback \u6a19\u7c64 \u00b6 \u57f7\u884c\u4e00\u500b PHP Callback \u65b9\u6cd5\u3002 <xf:callback class=\"Vendor\\Addon\\Class\" method=\"getX\" params=\"['abc']\"></xf:callback> \u6b64 callback \u6a19\u7c64\u5177\u6709\u4ee5\u4e0b\u5c6c\u6027\uff1a class - \u8a72 class\uff08\u5f9e root \u547d\u540d\u7a7a\u9593\uff09\u5305\u542b\u8981\u57f7\u884c\u7684\u65b9\u6cd5\u3002 method - \u8981\u57f7\u884c\u7684\u65b9\u6cd5\u3002 (\u53c3\u898b callback \u65b9\u6cd5) params - \u63d0\u4f9b\u7d66\u6b64\u65b9\u6cd5\u7684\u53c3\u6578\u9663\u5217\u3002 Callback \u65b9\u6cd5 \u00b6 \u70ba\u4e86\u4f7f\u4e00\u500b\u65b9\u6cd5\u88ab\u8a8d\u70ba\u662f callback \u65b9\u6cd5\uff0c\u5fc5\u9808\u5c0d\u5176\u9032\u884c\u9069\u7576\u7684\u547d\u540d\uff0c\u5426\u5247\u5b83\u5c07\u62cb\u51fa\u932f\u8aa4 ' callback_method_x_does_not_appear_to_indicate_read_only '\u3002\u70ba\u4e86\u4f7f\u5b83\u88ab\u8a8d\u70ba\u662f\u552f\u8b80\u7684\uff0c\u65b9\u6cd5\u540d\u7a31\u5fc5\u9808\u4ee5\u4e0b\u5217\u524d\u7db4\u4e4b\u4e00\u958b\u982d\uff1a are can count data display does exists fetch filter find get has is pluck print render return show total validate verify view CSS \u6a19\u7c64 \u00b6 \u52a0\u5165\u4e00\u500b\u5916\u90e8 CSS \u6216 LESS \u6a21\u677f\u6a94\u6848\u3002 <xf:css src=\"mycss_file.css\" /> CSS \u6a19\u7c64\u5177\u6709\u4ee5\u4e0b\u5c6c\u6027\uff1a src - \u8981\u52a0\u5165\u7684 CSS \u6216 LESS \u6a21\u677f\u6a94\u6848\u3002 \u5176\u4ed6\u7528\u6cd5 \u00b6 <xf:css> html, body { font-family: \"Roboto\", sans-serif; } </xf:css> \u5982\u679c CSS \u6a19\u7c64\u4e0d\u70ba\u7a7a\uff0c\u5247\u6a19\u7c64\u4e2d\u7684\u6240\u6709\u5167\u5bb9\u90fd\u5c07\u8f49\u63db\u70ba\u5d4c\u5165\u5f0f CSS\u3002 \u9032\u4e00\u6b65\u8aaa\u660e \u00b6 \u5c0d\u65bc[CSS]\uff0c\u4e0d\u7528\u518d\u5c07\u5b83\u5011\u7a31\u70ba\u6a94\u6848\u4e86\u3002\u5c07\u5b83\u5011\u8907\u88fd\u4e26\u8cbc\u4e0a\u5230\u65b0\u6a21\u677f\u4e2d\uff0c\u4e26\u6309\u5982\u4e0b\u6240\u793a\u9032\u884c\u8abf\u7528\uff1a \u4f86\u6e90\u81ea\uff1a \u514b\u91cc\u65af\u00b7D\uff0cXenForo \u958b\u767c\u4eba\u54e1 <xf:css src=\"questionthreads_fonticonpicker.css\" /> <xf:css src=\"questionthreads_fonticonpicker_grey.css\" /> JS \u6a19\u7c64 \u00b6 \u52a0\u5165\u4e00\u500bJavaScript\u6a94\u6848\u3002 <xf:js src=\"myaddon/vendor/scripts/myjs_file.js\" /> JS \u6a19\u7c64\u5177\u6709\u4ee5\u4e0b\u5c6c\u6027\uff1a src - \u8981\u52a0\u5165\u5230\u6a21\u677f\u4e2d\u7684 JS \u6a94\u6848\u3002 prod - \u8981\u52a0\u5165\u5230\u6a21\u677f\u4e2d\u7684 JS \u6a94\u6848\uff0c\u53ea\u9069\u7528\u65bc\u751f\u7522\u6a21\u5f0f\u3002 dev - \u8981\u52a0\u5165\u5230\u6a21\u677f\u4e2d\u7684 JS \u6a94\u6848\uff0c\u53ea\u9069\u7528\u65bc\u958b\u767c\u6a21\u5f0f\u3002 min - \u662f\u5426\u8981\u52a0\u5165\u6700\u5c0f\u5316\u7248\u672c\u7684\u6a94\u6848\u3002(\u7528 .min.js \u53d6\u4ee3 .js ) - \u53ea\u9700\u8981\u5728\u751f\u7522\u6a21\u5f0f\u4e0b\u95dc\u5fc3\u3002 addon - \u662f\u5426\u8981\u4f7f\u7528\u958b\u767c\u4e2d JS \u7684 URL\u3002 - \u53ea\u9700\u8981\u5728\u958b\u767c\u6a21\u5f0f\u4e0b\u95dc\u5fc3\u3002 Warning The src tag cannot be used in conjunction with either the prod or dev tags. \u5176\u4ed6\u7528\u6cd5 \u00b6 <xf:js> alert(\"\u771f\u76f8\u5f88\u50b7\u4eba\uff0c\u6211\u77e5\u9053\u3002\u5176\u5be6\u9019\u662f\u57fa\u65bc\u751f\u7269\u5b78\u4e0a\u7684\u3002\"); </xf:js> \u5982\u679c JS \u6a19\u7c64\u4e0d\u70ba\u7a7a\uff0c\u5247\u6a19\u7c64\u4e2d\u7684\u6240\u6709\u5167\u5bb9\u90fd\u6703\u8f49\u63db\u70ba\u5d4c\u5165\u5f0f JS\u3002 \u9032\u4e00\u6b65\u8aaa\u660e \u00b6 JavaScript \u6a94\u6848\u662f\u76f8\u5c0d\u65bc /js \u76ee\u9304\u63d0\u4f9b\u7684\u3002\u5118\u7ba1\u4e0d\u5efa\u8b70\u9019\u6a23\u505a\uff0c\u4f46\u60a8\u4e5f\u53ef\u4ee5\u5728\u6b64\u6a19\u7c64\u4e2d\u52a0\u5165\u5916\u90e8\u8cc7\u6e90\u3002 \u9019\u500b\u6a19\u7c64\u5728 editor \u6a21\u677f\u4e2d\u5c31\u662f\u4e00\u500b\u5f88\u597d\u7684\u4f8b\u5b50\u3002 Set \u6a19\u7c64 \u00b6 set \u6a19\u7c64\u5141\u8a31\u60a8\u5efa\u7acb\u4e00\u500b\u5c0d\u53e6\u4e00\u500b\u8b8a\u6578\u7684\u53c3\u8003\u6216\u5efa\u7acb\u4e00\u500b\u65b0\u7684\u8b8a\u6578\u3002\u4f60\u61c9\u8a72\u5728\u7a0b\u5f0f\u8a9e\u8a00\u4e2d\u4f7f\u7528\u8b8a\u6578\u7684\u4efb\u4f55\u5730\u65b9\u4f7f\u7528 set \u6a19\u7c64\u3002 <xf:set var=\"$visitor\" value=\"{$xf.visitor}\" /> Warning \u4e0d\u8981\u5c0d\u8981\u5728\u591a\u500b\u6a21\u677f\u4e2d\u4f7f\u7528\u7684\u4e00\u7d44\u5143\u7d20\u4f7f\u7528 Set \u6a19\u7c64\uff0c\u800c\u61c9\u4f7f\u7528 Macro \u6a19\u7c64\u3002 Warning \u8b8a\u6578\u540d\u7a31\uff08 var \u5c6c\u6027\uff09\u5fc5\u9808\u4ee5 $ \u958b\u982d\u3002 set \u6a19\u7c64\u5177\u6709\u4ee5\u4e0b\u5c6c\u6027\uff1a: var - \u60a8\u60f3\u5b9a\u7fa9\u8b8a\u6578\u7684\u540d\u7a31\uff08\u672c\u8cea\u4e0a\u662f\u5225\u540d\uff09\u3002 value - \u8981\u53c3\u8003\u7684\u8b8a\u6578\u6216\u8b8a\u6578\u503c\u3002 \u5176\u4ed6\u7528\u6cd5 \u00b6 <xf:set var=\"$myVariableName\"> \u6211\u7684\u8b8a\u6578\u503c! \u9019\u53ef\u4ee5\u662f\u4e00\u500b callback\uff0c\u6216\u8005\u53ea\u662f\u4e00\u7d44\u77ed\u8a9e\u3002 </xf:set> \u5982\u679c value \u672a\u63d0\u4f9b\u5c6c\u6027\u4e14\u6a19\u7c64\u4e0d\u70ba\u7a7a\uff0c\u5247\u8b8a\u6578\u503c\u5c07\u8a2d\u7f6e\u70ba\u6a19\u7c64\u7684\u5167\u5bb9\u3002 Warning \u7576\u60a8\u4ee5\u9019\u7a2e\u5f62\u5f0f\u4f7f\u7528 Set \u6a19\u7c64\u6642\uff0c\u8a72\u503c\u5c07\u88ab\u8f49\u7fa9\uff0c\u4e26\u4e14\u7d50\u679c\u503c\u5c07\u662f\u4e00\u500b\u5b57\u7b26\u4e32\u3002\u8a72 value \u5c6c\u6027\u96d6\u7136\u4e0d\u652f\u63f4 HTML \u6216\u985e\u4f3c HTML \u7684\u6a19\u7c64\uff0c\u4f46\u6c92\u6709\u6b64\u9650\u5236\u3002 Likes \u6a19\u7c64 \u00b6 \u986f\u793a\u5e16\u5b50\u7684\u559c\u6b61\u6b21\u6578\u4ee5\u53ca\u4e00\u4e9b\u559c\u6b61\u8a72\u5e16\u5b50\u7684\u7528\u6236\u3002 <xf:likes content=\"{$post}\" url=\"\" /> likes \u6a19\u7c64\u5177\u6709\u4ee5\u4e0b\u5c6c\u6027\uff1a content - \u8981\u986f\u793a '\u559c\u6b61' \u6587\u672c\u7684 XF\\Entity\\Post \u6216 XF\\Entity\\ProfilePost \u8cc7\u6599\u5be6\u9ad4\u3002 url - \u9ede\u64ca '\u559c\u6b61' \u6587\u672c\u6642\u986f\u793a\u7684 URL\u3002 \u683c\u5f0f \u00b6 \u4f60, \u91cc\u65af\u672c, kcho \u548c 2 \u5176\u4ed6\u4eba \u683c\u5f0f\u70ba [\ud83d\udc4d abc \u548c 2 \u5176\u4ed6\u4eba]\uff08\u5176\u4e2d \ud83d\udc4d \"\u5927\u62c7\u6307\" \u8868\u60c5\u7b26\u4ee3\u8868 \"\u9ede\u8b9a\" \u5716\u793a\uff0c abc \u4ee3\u8868\u6700\u5f8c\u4e09\u500b\u9ede\u8b9a\u8a72\u5e16\u5b50\u7684\u4f7f\u7528\u8005\u540d\u5b57\u3002\uff09 Sidebar \u6a19\u7c64 \u00b6 \u53c3\u898b Sectioned \u6a19\u7c64 . SideNav \u6a19\u7c64 \u00b6 \u53c3\u898b Sectioned \u6a19\u7c64 . Title \u6a19\u7c64 \u00b6 \u8a2d\u5b9a\u9801\u9762\u7684\u6a19\u984c\uff0c\u5305\u62ec\u9801\u9762\u4e0a\u7684 h1 \u6a19\u7c64\u548c\u700f\u89bd\u5668\u6a19\u7c64\u3002 <xf:title>{{ phrase('my_page_title') }}</xf:title> \u9032\u4e00\u6b65\u8aaa\u660e \u00b6 \u96d6\u7136\u53ef\u4ee5\u5c0d Title \u9032\u884c\u6c38\u4e45\u6027\u7de8\u8f2f\uff0c\u4f46\u662f \u5f37\u70c8\u5efa\u8b70 \u60a8\u4f7f\u7528\u4e00\u500b\u77ed\u8a9e\uff0c\u4ee5\u5be6\u73fe\u570b\u969b\u5316\uff0c\u4e26\u589e\u52a0\u7db2\u7ad9\u7ba1\u7406\u54e1\u7aef\u7684\u53ef\u5b9a\u88fd\u6027\u3002 Widget \u6a19\u7c64 \u00b6 \u5728\u9801\u9762\u4e2d\u5305\u542b\u5c0f\u5143\u4ef6\uff0c\u6216\u5c07\u5c0f\u5143\u4ef6\u6dfb\u52a0\u5230\u5c0f\u5143\u4ef6\u7684\u4f4d\u7f6e\u4e0a\u3002 <xf:widget key=\"widget_name\" /> widget \u6a19\u7c64\u5177\u6709\u4ee5\u4e0b\u5c6c\u6027\uff1a key - \u5c0f\u5143\u4ef6\u7684 key\uff0c\u5982\u5c0f\u5143\u4ef6\u8a2d\u5b9a\u4e2d\u5b9a\u7fa9\u7684\u3002 position - \u5982\u679c\u8a2d\u5b9a\uff0c\u5247\u6539\u8b8a\u5c0f\u5143\u4ef6\u5c07\u88ab\u6e32\u67d3\u7684\u4f4d\u7f6e\u3002 class - \u4e0d\u8981\u8207 HTML \u7684 class \u6df7\u6dc6\uff0c\u9019\u662f\u5305\u542b\u5c0f\u5143\u4ef6\u5b9a\u7fa9\u7684 PHP \u985e\u3002 title - \u7576\u4f7f\u7528 class \u5c6c\u6027\u6642\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528 title \u5c6c\u6027\u4f86\u8a2d\u7f6e\u5c0f\u5143\u4ef6\u7684\u6a19\u984c\u3002 \u7576\u4f7f\u7528 class \u5c6c\u6027\u6642\uff0c\u4f60\u4e5f\u53ef\u4ee5\u63d0\u4f9b\u5c0f\u5143\u4ef6\u7279\u5b9a\u7684\u9078\u9805\u4f5c\u70ba\u5c6c\u6027\u3002 Warning class \u6a19\u7c64\u4e0d\u80fd\u8207 key \u6a19\u7c64\u4e00\u8d77\u4f7f\u7528\u3002 UserActivity \u6a19\u7c64 \u00b6 \u6839\u64da\u7528\u6236\u4e0a\u4e00\u6b21\u64cd\u4f5c\u4ee5\u53ca\u8a72\u64cd\u4f5c\u767c\u751f\u7684\u6642\u9593\u4f86\u986f\u793a\u7528\u6236\u7684\u72c0\u614b\u3002 <xf:useractivity user=\"{$xf.visitor}\" /> UserActivity \u6a19\u7c64\u5177\u6709\u4ee5\u4e0b\u5c6c\u6027\uff1a user - \u7528\u6236\u986f\u793a\u7684\u72c0\u614b\u3002 \u683c\u5f0f \u00b6 \u67e5\u770b\u9801\u9762 \u6700\u65b0\u6848\u4f8b\u6a94\u6848 \u00b7 4\u5206\u9418\u524d \u683c\u5f0f\u70ba [\u6d3b\u52d5\u540d\u7a31] \u00b7 [\u6642\u9593] UserBanners \u6a19\u7c64 \u00b6 \u5728\u6c34\u5e73\u5217\u8868\u4e2d\u986f\u793a\u4f7f\u7528\u8005\u7684\u6a6b\u5e45\u3002 <xf:userbanners user=\"{$xf.visitor}\" /> UserBanners \u6a19\u7c64\u5177\u6709\u4ee5\u4e0b\u5c6c\u6027\uff1a user - \u986f\u793a\u8a72\u7528\u6236\u7684\u7528\u6236\u6a6b\u5e45\u3002 \u793a\u4f8b \u00b6 UserBanners \u6a19\u7c64\u7684\u793a\u4f8b\u7d50\u679c\u3002 UserBlurb tag \u00b6 \u986f\u793a\u7528\u6236\u500b\u4eba\u8cc7\u6599\u7684\u55ae\u884c\u6458\u8981\u3002 <xf:userblurb user=\"${xf.visitor}\" /> UserBlurb \u6a19\u7c64\u5177\u6709\u4ee5\u4e0b\u5c6c\u6027\uff1a user - \u986f\u793a XenForo \u4f7f\u7528\u8005\u5c0d\u8c61\u7684\u7c21\u4ecb\u3002 \u683c\u5f0f \u00b6 FBI \u9867\u554f \u00b7 43 \u00b7 \u4f86\u81ea\u7f8e\u570b \u683c\u5f0f\u70ba [\u89d2\u8272 / \u81ea\u5b9a\u7fa9\u6a19\u984c] \u00b7 \u5e74\u9f61 \u00b7 \u4f4d\u7f6e Username \u6a19\u7c64 \u00b6 Displays the user's username, optionally with a tool-tip. \u986f\u793a\u7528\u6236\u7684\u7528\u6236\u540d\uff0c\u53ef\u9078\u64c7\u4f7f\u7528\u5de5\u5177\u63d0\u793a\u3002 \u986f\u793a\u7528\u6236\u7684\u7528\u6236\u540d\uff08\u53ef\u9078\uff09\u548c\u5de5\u5177\u63d0\u793a\u3002 <xf:username user=\"{$xf.visitor.username}\" notooltip=\"true\" /> Username \u6a19\u7c64\u5177\u6709\u4ee5\u4e0b\u5c6c\u6027\uff1a user - \u8981\u986f\u793a\u5176\u540d\u7a31\u7684 XenForo \u7528\u6236\u5c0d\u8c61\u3002 notooltip - \u662f\u5426\u95dc\u9589\u5de5\u5177\u63d0\u793a\u3002 href - \u9ede\u64ca\u7528\u6236\u540d\u6642\u6240\u5c0e\u5411\u5230\u7684\u9023\u7d50\u3002 Warning \u5982\u679c\u8a2d\u5b9a\u4e86 href \uff0c\u5247\u4e0d\u6703\u986f\u793a\u5de5\u5177\u63d0\u793a\uff0c\u56e0\u70ba\u5b83\u4e0d\u8d77\u4f5c\u7528\uff0c\u800c\u4e14\u53ef\u80fd\u6703\u8aa4\u5c0e\u4f7f\u7528\u8005\u3002 UserTitle \u6a19\u7c64 \u00b6 Displays the user's title.\u986f\u793a\u4f7f\u7528\u8005\u7684\u982d\u929c\u3002 <xf:usertitle user=\"{$xf.visitor}\" /> UserTitle \u6a19\u7c64\u5177\u6709\u4ee5\u4e0b\u5c6c\u6027\uff1a user - \u6b64 XenForo \u7528\u6236\u7269\u4ef6\uff0c\u7528\u65bc\u986f\u793a\u7528\u6236\u982d\u929c\u3002 Sectioned \u6a19\u7c64 \u00b6 Sectioned \u6a19\u7c64\u5168\u90fd\u6703\u547c\u53eb\u51fd\u6578 modifySectionedHtml \u3002 \u5b83\u5011\u4fee\u6539\u7684 HTML \u5143\u7d20\u5c31\u662f\u6a19\u7c64\u540d\u7a31\u3002\u56e0\u6b64 sidebar \u6a19\u7c64\u6703\u4fee\u6539\u5074\u908a\u6b04\u7684 HTML \u7b49\u7b49\u3002 \u793a\u4f8b \u00b6 <xf:sidebar> <h1>\u6211\u7684\u795e\u5947\u5074\u908a\u6b04\uff01</h1> </xf:sidebar> \u5171\u540c\u5c6c\u6027 \u00b6 mode - \u4fee\u6539\u6a21\u5f0f\u3002\uff08\u8acb\u53c3\u95b1\u4fee\u6539\u6a21\u5f0f\uff09 \u4fee\u6539\u65b9\u5f0f \u00b6 \u9810\u8a2d\u60c5\u6cc1\u4e0b\uff0c\u4fee\u6539\u65b9\u5f0f\u70ba replace \u3002\uff08\u5373\uff0c\u5982\u679c\u6c92\u6709\u6307\u5b9a\u5c6c\u6027\u3002\uff09 prepend - \u5c07\u6a19\u7c64\u7684\u5167\u5bb9\u653e\u5728 HTML \u5143\u7d20\u7684\u958b\u982d\u3002 append - \u5c07\u6a19\u7c64\u7684\u5167\u5bb9\u653e\u5728 HTML \u5143\u7d20\u7684\u672b\u5c3e\u3002 replace - \u7528\u6a19\u7c64\u7684\u5167\u5bb9\u66ff\u63db HTML \u7684\u5143\u7d20\u3002","title":"\u6a21\u677f\u8a9e\u6cd5"},{"location":"template-syntax/#_1","text":"XenForo 2 \u6a21\u677f\u8a9e\u6cd5\u5c0d\u65bc\u958b\u767c\u4eba\u54e1\u548c\u8ad6\u58c7\u7ba1\u7406\u54e1\u90fd\u662f\u5f37\u5927\u7684\u5de5\u5177\uff0c\u4f7f\u60a8\u53ef\u4ee5\u5b8c\u5168\u63a7\u5236 XenForo \u9801\u9762\u7684\u6392\u7248\u3002","title":"\u6a21\u677f\u8a9e\u6cd5"},{"location":"template-syntax/#_2","text":"\u6309\u7167\u6163\u4f8b\uff0cXenForo \u7684\u6a19\u7c64\u662f lowercase \u3002 \u6240\u6709 XenForo \u6a19\u7c64\u90fd\u4ee5 xf: \u547d\u540d\u7a7a\u9593\u70ba\u524d\u7db4\u3002","title":"\u6700\u4f73\u793a\u4f8b"},{"location":"template-syntax/#_3","text":"","title":"\u6709\u5e6b\u52a9\u7684\u8a0a\u606f"},{"location":"template-syntax/#_4","text":"\u5982\u679c\u60a8\u60f3\u8a3b\u91cb\u6389\u4e00\u4e9b\u60a8\u4e0d\u60f3\u5728\u6700\u7d42\u9801\u9762\u539f\u59cb\u78bc\u4e2d\u770b\u5230\u7684\u6a21\u677f\u4ee3\u78bc\uff08\u6216\u8005\u52f5\u5fd7\u7684\u8a0a\u606f\uff09\uff0c\u5247\u53ef\u4ee5\u4f7f\u7528 xf:comment \u6a19\u7c64\u3002 <xf:comment> \u5982\u679c\u4f60\u4e0d\u518d\u4ee5\u4f60\u559c\u6b61\u4ec0\u9ebc\u548c\u4e0d\u559c\u6b61\u4ec0\u9ebc\u4f86\u770b\u5f85\u9019\u500b\u4e16\u754c\uff0c \u800c\u662f\u770b\u5230\u4e86\u4e8b\u7269\u672c\u8eab\u7684\u771f\u5be6\u9762\u76ee\uff0c \u4f60\u5c31\u6703\u767c\u73fe\u4f60\u7684\u751f\u6d3b\u5c07\u6703\u66f4\u52a0\u5730\u7965\u548c\u3002 </xf:comment>","title":"\u5c0d\u6a21\u677f\u9032\u884c\u8a3b\u91cb"},{"location":"template-syntax/#_5","text":"xf:include \u6a19\u7c64\u5141\u8a31\u4f60\u5728\u7576\u524d\u6a21\u677f\u4e2d\u52a0\u5165\u4e00\u500b\u4e0d\u540c\u7684\u6a21\u677f\u3002 <xf:include template=\"my_template\" /> \u53ea\u9700\u5c07 template \u5c6c\u6027\u8a2d\u5b9a\u70ba\u4f60\u60f3\u52a0\u5165\u7684\u6a21\u677f\u540d\u7a31\u5373\u53ef\u3002","title":"\u5728\u6a21\u677f\u4e2d\u52a0\u5165\u53e6\u4e00\u500b\u6a21\u677f"},{"location":"template-syntax/#_6","text":"\u6a21\u677f\u5de8\u96c6\u662f XenForo \u6a21\u677f\u8a9e\u6cd5\u7684\u4e00\u500b\u975e\u5e38\u5f37\u5927\u7684\u90e8\u5206\u3002 \u901a\u5e38\uff0c\u4f60\u61c9\u8a72\u5728\u7a0b\u5f0f\u8a2d\u8a08\u8a9e\u8a00\u4e2d\u4f7f\u7528\u51fd\u6578\u6216\u5b50\u7a0b\u5f0f\u7684\u4efb\u4f55\u5730\u65b9\u4f7f\u7528\u5de8\u96c6\u3002 \u5c0d\u65bc\u975e\u7a0b\u5f0f\u8a2d\u8a08\u5e2b\u4f86\u8aaa\uff0c\u6211\u628a\u9019\u4e00\u9ede\u7e3d\u7d50\u70ba\uff1a \u8981\u9ebc\u5728 \u4efb\u4f55\u60a8\u60f3\u5728\u591a\u500b\u4e0d\u540c\u6a94\u6848\u4e2d\u591a\u6b21\u7522\u751f\u76f8\u540c\u4e8b\u7269\u7684\u5730\u65b9\u4f7f\u7528\u5de8\u96c6\uff0c \u6216\u8005 \u5728\u4e0d\u540c\u60c5\u6cc1\u4e0b\u7522\u751f\u4e0d\u540c\u7684\u6771\u897f\uff08\u5982\u679c\u4f60\u67e5\u770b\u5b9a\u7fa9\u5de8\u96c6\u7684\u6307\u5357\uff0c\u9019\u53ef\u80fd\u6703\u66f4\u6709\u5e6b\u52a9\uff09\u3002 Warning \u51fa\u65bc\u53ef\u8b80\u6027\u539f\u56e0\uff0c\u60a8\u4e0d\u61c9\u8a72\u4f7f\u7528\u5de8\u96c6\u6a19\u7c64\u4f5c\u70ba\u8b8a\u6578\u3002 \u60a8\u61c9\u8a72\u4f7f\u7528 Set \u6a19\u7c64\uff0c\u4e26\u50cf\u5c0d\u5f85\u4efb\u4f55\u6a21\u677f\u8b8a\u91cf\u4e00\u6a23\u5c0d\u5f85\u8b8a\u91cf\u3002","title":"\u6a21\u677f\u5de8\u96c6"},{"location":"template-syntax/#_7","text":"<xf:macro name=\"my_macro_name\"> <!-- \u4f60\u7684\u5de8\u96c6\u5167\u5bb9 --> </xf:macro> \u6700\u7c21\u55ae\u7684\uff0c\u53ef\u4ee5\u7528 name \u5c6c\u6027\u5b9a\u7fa9\u4e00\u500b\u5de8\u96c6\uff0c\u4e26\u5728\u5de8\u96c6\u6a19\u7c64\u4e2d\u91cd\u8907\u4f60\u60f3\u8981\u7684\u5167\u5bb9\u3002 Note \u7576\u60a8\u5728\u591a\u500b\u6a94\u6848\u4e2d\u4f7f\u7528\u5de8\u96c6\u6642\uff0c\u6700\u4f73\u505a\u6cd5\u662f\u5c07\u5de8\u96c6\u653e\u5165\u81ea\u5df1\u7684\u6a21\u677f\u4e2d\u3002","title":"\u5b9a\u7fa9\u5de8\u96c6"},{"location":"template-syntax/#_8","text":"<xf:macro name=\"my_macro_name\" arg-message=\"\u6211\u8d85\u53b2\u5bb3\u7684\u5de8\u96c6\u8a0a\u606f\uff01\"> <h1>\u8a0a\u606f</h1> <p>{$message}</p> </xf:macro> \u5728\u6b64\u793a\u4f8b\u4e2d\uff0c\u70ba\u5de8\u96c6\u5b9a\u7fa9\u4e86 arg-message ( \u6211\u9a5a\u4eba\u7684\u5de8\u96c6\u8a0a\u606f\uff01 ) \u7684\u9810\u8a2d\u503c\u3002 \u5982\u679c\u4f7f\u7528 message \u53c3\u6578\u547c\u53eb\u5de8\u96c6\uff0c\u5247\u8a72\u503c\u5c07\u88ab\u8986\u84cb\u3002 \u6709\u6642\u9700\u8981\u5c07\u4e00\u500b\u53c3\u6578\u6a19\u8a18\u70ba\u5fc5\u586b\u9805\u3002 \u9019\u53ef\u4ee5\u901a\u904e\u5728\u5de8\u96c6\u5b9a\u7fa9\u4e2d\u628a\u53c3\u6578\u503c\u8a2d\u5b9a\u70ba ! \u4f86\u5be6\u73fe\u3002","title":"\u5de8\u96c6\u53c3\u6578"},{"location":"template-syntax/#_9","text":"<xf:macro template=\"my_macro_template\" name=\"my_macro_name\" /> \u6700\u7c21\u55ae\u7684\u65b9\u6cd5\u662f\uff0c\u901a\u904e\u8a2d\u7f6e name \u5c6c\u6027\u4e26\u5c07\u6a19\u7c64\u4fdd\u7559\u70ba\u7a7a\u4f86\u52a0\u5165\u5de8\u96c6\u3002 Note \u4f7f\u7528\u5de8\u96c6\u6a19\u7c64\u6642\uff0c\u4f60\u61c9\u8a72\u4f7f\u7528\u6a19\u7c64\u7684\u81ea\u52d5\u95dc\u9589\u5f62\u5f0f\uff0c\u4ee5\u4fbf\u8b93\u5225\u4eba\u66f4\u5bb9\u6613\u5340\u5206\u5de8\u96c6\u7684\u5b9a\u7fa9\u548c\u7528\u6cd5\u7684\u5340\u5225\u3002","title":"\u52a0\u5165\u548c\u4f7f\u7528\u5de8\u96c6"},{"location":"template-syntax/#_10","text":"\u60a8\u9084\u53ef\u4ee5\u70ba\u5de8\u96c6\u63d0\u4f9b\u53c3\u6578\uff1a <xf:macro template=\"my_macro_template\" name=\"my_macro_name\" arg-argName=\"argValue\" /> \u5176\u4e2d argName \u662f\u5de8\u96c6\u53c3\u6578\u7684\u540d\u7a31\u3002 Note \u60a8\u61c9\u8a72\u4f7f\u7528 lowerCamelCase \u4f86\u547d\u540d\u4f60\u7684\u5de8\u96c6\u53c3\u6578\u3002","title":"\u5de8\u96c6\u53c3\u6578"},{"location":"template-syntax/#_11","text":"XenForo 2 \u6a21\u677f\u8a9e\u6cd5\u652f\u63f4\u67d0\u4e9b\u63a7\u5236\u5143\u4ef6\u7d50\u69cb\uff0c\u4ee5\u4f7f\u67d0\u4e9b\u4efb\u52d9\u66f4\u6613\u65bc\u5be6\u73fe\u3002","title":"\u6a21\u677f\u63a7\u5236\u7d50\u69cb"},{"location":"template-syntax/#if","text":"if \u6a21\u677f\u6a19\u7c64\u53ef\u7528\u65bc\u6709\u689d\u4ef6\u5730\u986f\u793a\u4e00\u4e9b HTML \u6216\u6a21\u677f\u7684\u4e00\u90e8\u5206\u3002 <!-- Shows content only if a user is signed in... --> <xf:if is=\"$xf.visitor.user_id\"> <!-- \u505a\u9ede\u4ec0\u9ebc... --> </xf:if> if \u6a19\u7c64\u5177\u6709\u4ee5\u4e0b\u5c6c\u6027\uff1a is - \u6eff\u8db3\u689d\u4ef6\u6642\u61c9\u986f\u793a\u6a19\u7c64\u5167\u5bb9\u7684\u689d\u4ef6\u3002","title":"If \u6a19\u7c64"},{"location":"template-syntax/#_12","text":"\u8a72 is \u5c6c\u6027\u652f\u63f4\u4e00\u4e9b\u908f\u8f2f\u904b\u7b97\u7b26\uff1a OR - \u7528\u65bc\u9023\u63a5\u66ff\u4ee3\u689d\u4ef6\u3002\uff08\u4e8c\u64c7\u4e00\uff1a || \uff09 AND - \u7528\u65bc\u9023\u63a5\u5176\u4ed6\u689d\u4ef6\u3002 (\u4e8c\u64c7\u4e00: && \uff09 ! - \u653e\u5728\u689d\u4ef6\u524d\uff0c\u4f7f\u5176\u53cd\u8f49\u3002\uff08\u7a31\u70ba\uff1a\"\u5426\"\uff09 XOR - \u5982\u679c\u5169\u500b\u689d\u4ef6\u4e2d\u53ea\u6709\u4e00\u500b\u70ba true\uff0c\u5247\u8fd4\u56de true\u3002\uff08\u7a31\u70ba\uff1a\"\u7570\u6216\"\uff09","title":"\u689d\u4ef6"},{"location":"template-syntax/#elseelse-if","text":"else \u548c else-if \u6a19\u7c64\u8207 if \u6a19\u7c64\u7d50\u5408\u4f7f\u7528\uff0c\u4ee5\u6309\u540d\u7a31\u5efa\u8b70\u7684\u65b9\u5f0f\u6709\u689d\u4ef6\u5730\u986f\u793a HTML\u3002 else \u7528\u6cd5\u793a\u4f8b\uff1a <xf:if is=\"$xf.visitor.is_admin\"> <!-- \u9019\u88e1\u7684\u5167\u5bb9\u53ea\u6709\u7ba1\u7406\u54e1\u624d\u6703\u770b\u5230... --> <xf:else /> <!-- \u9019\u88e1\u7684\u5167\u5bb9\u5c07\u88ab\u986f\u793a\u7d66\u4efb\u4f55\u975e\u7ba1\u7406\u54e1\u7684\u4eba\u770b\u5230\uff01 --> </xf:if> else-if \u7684\u7528\u6cd5\u793a\u4f8b\uff1a <xf:if is=\"$xf.visitor.is_admin\"> <!-- \u9019\u88e1\u7684\u5167\u5bb9\u53ea\u6709\u7ba1\u7406\u54e1\u624d\u6703\u770b\u5230... --> <xf:elseif is=\"$xf.visitor.is_moderator\" /> <!-- \u9019\u88e1\u7684\u5167\u5bb9\u53ea\u6703\u986f\u793a\u7d66\u7248\u4e3b(\u4e0d\u5305\u62ec\u517c\u4efb\u7ba1\u7406\u54e1\u7684\u7528\u6236)\u3002 --> <xf:else /> <!-- \u9019\u88e1\u7684\u5167\u5bb9\u5c07\u986f\u793a\u7d66\u975e\u7ba1\u7406\u54e1\u6216\u7248\u4e3b\u7684\u4efb\u4f55\u4eba\u3002 --> </xf:if> \u6b63\u5982\u4f60\u6240\u770b\u5230\u7684\uff0c\u4e00\u65e6\u4e00\u500b\u689d\u4ef6\u88ab\u6eff\u8db3\uff0c\u5176\u9918\u7684 if \u8a9e\u53e5\u5c07\u88ab\u5ffd\u7565\u3002\uff08\u6240\u4ee5\uff0c\u5728\u9019\u7a2e\u60c5\u6cc1\u4e0b\uff0c\u5982\u679c\u4f7f\u7528\u8005\u662f\u7ba1\u7406\u54e1\uff0c\u4e0a\u9762\u7684 xf:if \u90e8\u5206\u88ab\u57f7\u884c\uff0c\u5176\u9918\u7684 if \u8a9e\u53e5\u5247\u88ab\u5ffd\u7565\u3002)","title":"Else/Else-If \u6a19\u7c64"},{"location":"template-syntax/#for-each","text":"for-each \u6a19\u7c64\u4f7f\u60a8\u53ef\u4ee5\u904d\u6b77\u9805\u76ee\u9663\u5217\uff0c\u70ba\u6bcf\u500b\u9805\u76ee\u5370\u51fa HTML \u5340\u584a\u3002 <xf:set var=\"$names\" value=\"{{ ['\u6d3e\u7fe0\u514b', '\u7279\u9e97\u838e', '\u91d1\u535a\u723e', '\u97cb\u6069', '\u683c\u96f7\u65af'] }}\" /> <xf:foreach loop=\"$names\" key=\"$key\" value=\"$name\" i=\"$i\"> <p>\u4f60\u597d\uff0c {$name}\u3002 \u9019\u662f\u540d\u5b57 {$i} \u3002 \u8a72\u5143\u7d20\u7684\u9663\u5217 key \u503c\u70ba\uff1a {$key}</p> </xf:foreach> for-each \u6a19\u7c64\u5177\u6709\u4ee5\u4e0b\u5c6c\u6027\uff1a loop - \u8981\u5faa\u74b0\u7684\u9663\u5217\u3002 key - \u5728\u5faa\u74b0\u4e2d\u4f7f\u7528\u7684\u8b8a\u6578\u540d\u7a31\uff0c\u4ee5\u7372\u53d6\u7576\u524d\u5143\u7d20\u7684\u9663\u5217 key\u3002 \u53ef\u4ee5\u662f\u6574\u6578\uff08\u666e\u901a\u9663\u5217\uff09\u6216\u5b57\u4e32\uff08\u95dc\u806f\u9663\u5217\uff09\u3002 value - \u5728\u5faa\u74b0\u4e2d\u4f7f\u7528\u7684\u8b8a\u6578\u540d\u7a31\uff0c\u5305\u542b\u7576\u524d\u9663\u5217\u9805\u3002 i - \u5728\u5faa\u74b0\u4e2d\u7528\u65bc\u7576\u524d\u7d22\u5f15\u7684\u8b8a\u6578\u540d\u7a31\u3002","title":"For-each \u6a19\u7c64"},{"location":"template-syntax/#_13","text":"\u4f60\u597d\uff0c\u6d3e\u7fe0\u514b\u3002 \u9019\u662f\u540d\u5b57 1\u3002 \u4f60\u597d\uff0c\u7279\u9e97\u838e\u3002 \u9019\u662f\u540d\u5b57 2\u3002 \u4f60\u597d\uff0c\u91d1\u535a\u723e\u3002 \u9019\u662f\u540d\u5b57 3\u3002 \u4f60\u597d\uff0c\u97cb\u6069\u3002 \u9019\u662f\u540d\u5b57 4\u3002 \u4f60\u597d\uff0c\u683c\u96f7\u65af\u3002 \u9019\u662f\u540d\u5b57 5\u3002","title":"\u8f38\u51fa\u793a\u4f8b"},{"location":"template-syntax/#_14","text":"","title":"\u6a21\u677f\u6a19\u7c64"},{"location":"template-syntax/#_15","text":"\u5728\u9801\u9762\u4e2d\u63d2\u5165\u7528\u6236\u7684\u982d\u50cf\u3002 <xf:avatar user=\"{$xf.visitor}\" size=\"o\" canonical=\"true\" /> \u982d\u50cf\u6a19\u7c64\u5177\u6709\u4ee5\u4e0b\u5c6c\u6027\uff1a user - \u8981\u7522\u751f\u982d\u50cf\u7684 XenForo \u7528\u6236\u7269\u4ef6\u3002 size - \u8981\u7522\u751f\u7684\u5716\u7247\u5927\u5c0f\u3002(\u53c3\u898b\u5716\u7247\u5c3a\u5bf8) canonical - \u662f\u5426\u4f7f\u7528\u6709\u5229\u65bc SEO \u7684\u5b8c\u6574 URL\u3002\u8a72\u503c\u53ea\u5c0d custom \u982d\u50cf\u6709\u6548\u3002 notooltip - \u7576\u6ed1\u9f20\u61f8\u505c\u5728\u982d\u50cf\u4e0a\u6642\u986f\u793a\u7684\u5de5\u5177\u63d0\u793a\u662f\u5426\u61c9\u8a72\u88ab\u95dc\u9589\u3002 forcetype - \u53ef\u4ee5\u7528\u4f86\u5f37\u5236\u53d6\u5f97 gravatar \u6216 custom \u982d\u50cf\uff0c\u8a2d\u5b9a\u503c\u70ba\u5176\u4e2d\u4e4b\u4e00\u3002 defaultname - \u5982\u679c user \u5c6c\u6027\u5305\u542b\u4e00\u500b\u7121\u6548\u7684\u4f7f\u7528\u8005\u6642\uff0c\u9810\u8a2d\u8981\u4f7f\u7528\u7684\u4f7f\u7528\u8005\u540d\u7a31\u3002","title":"\u982d\u50cf\u6a19\u7c64"},{"location":"template-syntax/#_16","text":"\u5982\u679c\u63d0\u4f9b\u7684\u982d\u50cf\u5927\u5c0f\u7121\u6548\uff0c\u5247\u4ee3\u78bc\u5c07\u56de\u9000\u5230\u5927\u5c0f ' s '\u3002 o - 384px h - 384px l - 192px m - 96px s - 48px","title":"\u5716\u7247\u5927\u5c0f"},{"location":"template-syntax/#_17","text":"\u4fee\u6539\u9801\u9762\u8def\u5f91\u5c0e\u89bd\u5217\u3002 <xf:breadcrumb href=\"{{ link('my_page') }}\">{{ phrase('my_page_name') }}</xf:breadcrumb> \u9801\u9762\u8def\u5f91\u5c0e\u89bd\u5217\u6a19\u7c64\u5177\u6709\u4ee5\u4e0b\u5c6c\u6027\uff1a href - \u70ba\u9801\u9762\u8def\u5f91\u5c0e\u89bd\u5217\u4e2d\u7684\u6700\u5f8c\u4e00\u500b\u5143\u7d20\u8a2d\u5b9a\u7684\u9023\u7d50\u3002 \u6a19\u7c64\u7684\u503c\u53ef\u7528\u65bc\u8a2d\u7f6e\u9801\u9762\u8def\u5f91\u5c0e\u89bd\u5217\u4e2d\u6700\u5f8c\u4e00\u500b\u5143\u7d20\u7684\u540d\u7a31\u3002","title":"\u9801\u9762\u8def\u5f91\u5c0e\u89bd\u5217\u6a19\u7c64"},{"location":"template-syntax/#_18","text":"<xf:breadcrumb source=\"$category.getBreadcrumbs(false)\" /> \u60a8\u9084\u53ef\u4ee5\u901a\u904e source \u5728\u9801\u9762\u8def\u5f91\u5c0e\u89bd\u5217\u6a19\u7c64\u7684\u5c6c\u6027\u4e2d\u547c\u53eb\u51fd\u6578\u4f86\u4ee5\u7a0b\u5f0f\u8a2d\u8a08\u65b9\u5f0f\u5b9a\u7fa9\u81ea\u5df1\u7684\u9801\u9762\u8def\u5f91\u5c0e\u89bd\u5217\u3002 \u8a72 source \u53c3\u6578\u57fa\u672c\u4e0a\u63a1\u7528\u4e00\u500b\u5177\u6709 href \u548c value \u5c6c\u6027\u7684\u7269\u4ef6\u9663\u5217\uff08\u591a\u7dad\u9663\u5217\uff09\uff0c\u5176\u4e2d\u6bcf\u500b\u7269\u4ef6\u90fd\u662f\u4e00\u500b\u9801\u9762\u8def\u5f91\u5c0e\u89bd\u5217\u5143\u7d20\u3002 Note \u5982\u679c\u8981\u66f4\u6539\u6839\u76ee\u9304\u9801\u9762\u8def\u5f91\u5c0e\u89bd\u5217\uff0c\u53ef\u4ee5\u5728 \"\u57fa\u672c\u4fe1\u606f\u9762\u677f\" \u9078\u9805\u90e8\u5206\u4e2d\u66f4\u6539 \"Root breadcrumb\" \u9078\u9805\u3002","title":"\u5176\u4ed6\u7528\u6cd5"},{"location":"template-syntax/#_19","text":"\u6dfb\u52a0\u5177\u6709\u9069\u7576\u985e\u7684\u6309\u9215\u5143\u7d20\u4ee5\u53ca\uff08\u53ef\u9078\uff09\u5716\u793a\u3002 <xf:button icon=\"save\"></xf:button> button \u6a19\u7c64\u5177\u6709\u4ee5\u4e0b\u5c6c\u6027\uff1a icon - \u61c9\u7528\u65bc\u6309\u9215\u7684\u5716\u793a\u985e\u3002(\u53c3\u898b\u6309\u9215\u5716\u793a)","title":"\u6309\u9215\u6a19\u7c64"},{"location":"template-syntax/#_20","text":"\u9ed8\u8a8d\u60c5\u6cc1\u4e0b\uff0cXenForo \u6309\u9215\u652f\u63f4\u4ee5\u4e0b\u5716\u793a\uff08\u4f7f\u7528CSS\u5275\u5efa\uff09\uff1a add confirm write import export download disable edit save reply quote purchase payment convert search sort upload attach login rate config refresh translate vote result history cancel preview conversation bolt list prev next markRead notificationsOn notificationsOff merge move copy approve unapprove delete undelete stick unstick lock unlock","title":"\u6309\u9215\u5716\u793a"},{"location":"template-syntax/#callback","text":"\u57f7\u884c\u4e00\u500b PHP Callback \u65b9\u6cd5\u3002 <xf:callback class=\"Vendor\\Addon\\Class\" method=\"getX\" params=\"['abc']\"></xf:callback> \u6b64 callback \u6a19\u7c64\u5177\u6709\u4ee5\u4e0b\u5c6c\u6027\uff1a class - \u8a72 class\uff08\u5f9e root \u547d\u540d\u7a7a\u9593\uff09\u5305\u542b\u8981\u57f7\u884c\u7684\u65b9\u6cd5\u3002 method - \u8981\u57f7\u884c\u7684\u65b9\u6cd5\u3002 (\u53c3\u898b callback \u65b9\u6cd5) params - \u63d0\u4f9b\u7d66\u6b64\u65b9\u6cd5\u7684\u53c3\u6578\u9663\u5217\u3002","title":"Callback \u6a19\u7c64"},{"location":"template-syntax/#callback_1","text":"\u70ba\u4e86\u4f7f\u4e00\u500b\u65b9\u6cd5\u88ab\u8a8d\u70ba\u662f callback \u65b9\u6cd5\uff0c\u5fc5\u9808\u5c0d\u5176\u9032\u884c\u9069\u7576\u7684\u547d\u540d\uff0c\u5426\u5247\u5b83\u5c07\u62cb\u51fa\u932f\u8aa4 ' callback_method_x_does_not_appear_to_indicate_read_only '\u3002\u70ba\u4e86\u4f7f\u5b83\u88ab\u8a8d\u70ba\u662f\u552f\u8b80\u7684\uff0c\u65b9\u6cd5\u540d\u7a31\u5fc5\u9808\u4ee5\u4e0b\u5217\u524d\u7db4\u4e4b\u4e00\u958b\u982d\uff1a are can count data display does exists fetch filter find get has is pluck print render return show total validate verify view","title":"Callback \u65b9\u6cd5"},{"location":"template-syntax/#css","text":"\u52a0\u5165\u4e00\u500b\u5916\u90e8 CSS \u6216 LESS \u6a21\u677f\u6a94\u6848\u3002 <xf:css src=\"mycss_file.css\" /> CSS \u6a19\u7c64\u5177\u6709\u4ee5\u4e0b\u5c6c\u6027\uff1a src - \u8981\u52a0\u5165\u7684 CSS \u6216 LESS \u6a21\u677f\u6a94\u6848\u3002","title":"CSS \u6a19\u7c64"},{"location":"template-syntax/#_21","text":"<xf:css> html, body { font-family: \"Roboto\", sans-serif; } </xf:css> \u5982\u679c CSS \u6a19\u7c64\u4e0d\u70ba\u7a7a\uff0c\u5247\u6a19\u7c64\u4e2d\u7684\u6240\u6709\u5167\u5bb9\u90fd\u5c07\u8f49\u63db\u70ba\u5d4c\u5165\u5f0f CSS\u3002","title":"\u5176\u4ed6\u7528\u6cd5"},{"location":"template-syntax/#_22","text":"\u5c0d\u65bc[CSS]\uff0c\u4e0d\u7528\u518d\u5c07\u5b83\u5011\u7a31\u70ba\u6a94\u6848\u4e86\u3002\u5c07\u5b83\u5011\u8907\u88fd\u4e26\u8cbc\u4e0a\u5230\u65b0\u6a21\u677f\u4e2d\uff0c\u4e26\u6309\u5982\u4e0b\u6240\u793a\u9032\u884c\u8abf\u7528\uff1a \u4f86\u6e90\u81ea\uff1a \u514b\u91cc\u65af\u00b7D\uff0cXenForo \u958b\u767c\u4eba\u54e1 <xf:css src=\"questionthreads_fonticonpicker.css\" /> <xf:css src=\"questionthreads_fonticonpicker_grey.css\" />","title":"\u9032\u4e00\u6b65\u8aaa\u660e"},{"location":"template-syntax/#js","text":"\u52a0\u5165\u4e00\u500bJavaScript\u6a94\u6848\u3002 <xf:js src=\"myaddon/vendor/scripts/myjs_file.js\" /> JS \u6a19\u7c64\u5177\u6709\u4ee5\u4e0b\u5c6c\u6027\uff1a src - \u8981\u52a0\u5165\u5230\u6a21\u677f\u4e2d\u7684 JS \u6a94\u6848\u3002 prod - \u8981\u52a0\u5165\u5230\u6a21\u677f\u4e2d\u7684 JS \u6a94\u6848\uff0c\u53ea\u9069\u7528\u65bc\u751f\u7522\u6a21\u5f0f\u3002 dev - \u8981\u52a0\u5165\u5230\u6a21\u677f\u4e2d\u7684 JS \u6a94\u6848\uff0c\u53ea\u9069\u7528\u65bc\u958b\u767c\u6a21\u5f0f\u3002 min - \u662f\u5426\u8981\u52a0\u5165\u6700\u5c0f\u5316\u7248\u672c\u7684\u6a94\u6848\u3002(\u7528 .min.js \u53d6\u4ee3 .js ) - \u53ea\u9700\u8981\u5728\u751f\u7522\u6a21\u5f0f\u4e0b\u95dc\u5fc3\u3002 addon - \u662f\u5426\u8981\u4f7f\u7528\u958b\u767c\u4e2d JS \u7684 URL\u3002 - \u53ea\u9700\u8981\u5728\u958b\u767c\u6a21\u5f0f\u4e0b\u95dc\u5fc3\u3002 Warning The src tag cannot be used in conjunction with either the prod or dev tags.","title":"JS \u6a19\u7c64"},{"location":"template-syntax/#_23","text":"<xf:js> alert(\"\u771f\u76f8\u5f88\u50b7\u4eba\uff0c\u6211\u77e5\u9053\u3002\u5176\u5be6\u9019\u662f\u57fa\u65bc\u751f\u7269\u5b78\u4e0a\u7684\u3002\"); </xf:js> \u5982\u679c JS \u6a19\u7c64\u4e0d\u70ba\u7a7a\uff0c\u5247\u6a19\u7c64\u4e2d\u7684\u6240\u6709\u5167\u5bb9\u90fd\u6703\u8f49\u63db\u70ba\u5d4c\u5165\u5f0f JS\u3002","title":"\u5176\u4ed6\u7528\u6cd5"},{"location":"template-syntax/#_24","text":"JavaScript \u6a94\u6848\u662f\u76f8\u5c0d\u65bc /js \u76ee\u9304\u63d0\u4f9b\u7684\u3002\u5118\u7ba1\u4e0d\u5efa\u8b70\u9019\u6a23\u505a\uff0c\u4f46\u60a8\u4e5f\u53ef\u4ee5\u5728\u6b64\u6a19\u7c64\u4e2d\u52a0\u5165\u5916\u90e8\u8cc7\u6e90\u3002 \u9019\u500b\u6a19\u7c64\u5728 editor \u6a21\u677f\u4e2d\u5c31\u662f\u4e00\u500b\u5f88\u597d\u7684\u4f8b\u5b50\u3002","title":"\u9032\u4e00\u6b65\u8aaa\u660e"},{"location":"template-syntax/#set","text":"set \u6a19\u7c64\u5141\u8a31\u60a8\u5efa\u7acb\u4e00\u500b\u5c0d\u53e6\u4e00\u500b\u8b8a\u6578\u7684\u53c3\u8003\u6216\u5efa\u7acb\u4e00\u500b\u65b0\u7684\u8b8a\u6578\u3002\u4f60\u61c9\u8a72\u5728\u7a0b\u5f0f\u8a9e\u8a00\u4e2d\u4f7f\u7528\u8b8a\u6578\u7684\u4efb\u4f55\u5730\u65b9\u4f7f\u7528 set \u6a19\u7c64\u3002 <xf:set var=\"$visitor\" value=\"{$xf.visitor}\" /> Warning \u4e0d\u8981\u5c0d\u8981\u5728\u591a\u500b\u6a21\u677f\u4e2d\u4f7f\u7528\u7684\u4e00\u7d44\u5143\u7d20\u4f7f\u7528 Set \u6a19\u7c64\uff0c\u800c\u61c9\u4f7f\u7528 Macro \u6a19\u7c64\u3002 Warning \u8b8a\u6578\u540d\u7a31\uff08 var \u5c6c\u6027\uff09\u5fc5\u9808\u4ee5 $ \u958b\u982d\u3002 set \u6a19\u7c64\u5177\u6709\u4ee5\u4e0b\u5c6c\u6027\uff1a: var - \u60a8\u60f3\u5b9a\u7fa9\u8b8a\u6578\u7684\u540d\u7a31\uff08\u672c\u8cea\u4e0a\u662f\u5225\u540d\uff09\u3002 value - \u8981\u53c3\u8003\u7684\u8b8a\u6578\u6216\u8b8a\u6578\u503c\u3002","title":"Set \u6a19\u7c64"},{"location":"template-syntax/#_25","text":"<xf:set var=\"$myVariableName\"> \u6211\u7684\u8b8a\u6578\u503c! \u9019\u53ef\u4ee5\u662f\u4e00\u500b callback\uff0c\u6216\u8005\u53ea\u662f\u4e00\u7d44\u77ed\u8a9e\u3002 </xf:set> \u5982\u679c value \u672a\u63d0\u4f9b\u5c6c\u6027\u4e14\u6a19\u7c64\u4e0d\u70ba\u7a7a\uff0c\u5247\u8b8a\u6578\u503c\u5c07\u8a2d\u7f6e\u70ba\u6a19\u7c64\u7684\u5167\u5bb9\u3002 Warning \u7576\u60a8\u4ee5\u9019\u7a2e\u5f62\u5f0f\u4f7f\u7528 Set \u6a19\u7c64\u6642\uff0c\u8a72\u503c\u5c07\u88ab\u8f49\u7fa9\uff0c\u4e26\u4e14\u7d50\u679c\u503c\u5c07\u662f\u4e00\u500b\u5b57\u7b26\u4e32\u3002\u8a72 value \u5c6c\u6027\u96d6\u7136\u4e0d\u652f\u63f4 HTML \u6216\u985e\u4f3c HTML \u7684\u6a19\u7c64\uff0c\u4f46\u6c92\u6709\u6b64\u9650\u5236\u3002","title":"\u5176\u4ed6\u7528\u6cd5"},{"location":"template-syntax/#likes","text":"\u986f\u793a\u5e16\u5b50\u7684\u559c\u6b61\u6b21\u6578\u4ee5\u53ca\u4e00\u4e9b\u559c\u6b61\u8a72\u5e16\u5b50\u7684\u7528\u6236\u3002 <xf:likes content=\"{$post}\" url=\"\" /> likes \u6a19\u7c64\u5177\u6709\u4ee5\u4e0b\u5c6c\u6027\uff1a content - \u8981\u986f\u793a '\u559c\u6b61' \u6587\u672c\u7684 XF\\Entity\\Post \u6216 XF\\Entity\\ProfilePost \u8cc7\u6599\u5be6\u9ad4\u3002 url - \u9ede\u64ca '\u559c\u6b61' \u6587\u672c\u6642\u986f\u793a\u7684 URL\u3002","title":"Likes \u6a19\u7c64"},{"location":"template-syntax/#_26","text":"\u4f60, \u91cc\u65af\u672c, kcho \u548c 2 \u5176\u4ed6\u4eba \u683c\u5f0f\u70ba [\ud83d\udc4d abc \u548c 2 \u5176\u4ed6\u4eba]\uff08\u5176\u4e2d \ud83d\udc4d \"\u5927\u62c7\u6307\" \u8868\u60c5\u7b26\u4ee3\u8868 \"\u9ede\u8b9a\" \u5716\u793a\uff0c abc \u4ee3\u8868\u6700\u5f8c\u4e09\u500b\u9ede\u8b9a\u8a72\u5e16\u5b50\u7684\u4f7f\u7528\u8005\u540d\u5b57\u3002\uff09","title":"\u683c\u5f0f"},{"location":"template-syntax/#sidebar","text":"\u53c3\u898b Sectioned \u6a19\u7c64 .","title":"Sidebar \u6a19\u7c64"},{"location":"template-syntax/#sidenav","text":"\u53c3\u898b Sectioned \u6a19\u7c64 .","title":"SideNav \u6a19\u7c64"},{"location":"template-syntax/#title","text":"\u8a2d\u5b9a\u9801\u9762\u7684\u6a19\u984c\uff0c\u5305\u62ec\u9801\u9762\u4e0a\u7684 h1 \u6a19\u7c64\u548c\u700f\u89bd\u5668\u6a19\u7c64\u3002 <xf:title>{{ phrase('my_page_title') }}</xf:title>","title":"Title \u6a19\u7c64"},{"location":"template-syntax/#_27","text":"\u96d6\u7136\u53ef\u4ee5\u5c0d Title \u9032\u884c\u6c38\u4e45\u6027\u7de8\u8f2f\uff0c\u4f46\u662f \u5f37\u70c8\u5efa\u8b70 \u60a8\u4f7f\u7528\u4e00\u500b\u77ed\u8a9e\uff0c\u4ee5\u5be6\u73fe\u570b\u969b\u5316\uff0c\u4e26\u589e\u52a0\u7db2\u7ad9\u7ba1\u7406\u54e1\u7aef\u7684\u53ef\u5b9a\u88fd\u6027\u3002","title":"\u9032\u4e00\u6b65\u8aaa\u660e"},{"location":"template-syntax/#widget","text":"\u5728\u9801\u9762\u4e2d\u5305\u542b\u5c0f\u5143\u4ef6\uff0c\u6216\u5c07\u5c0f\u5143\u4ef6\u6dfb\u52a0\u5230\u5c0f\u5143\u4ef6\u7684\u4f4d\u7f6e\u4e0a\u3002 <xf:widget key=\"widget_name\" /> widget \u6a19\u7c64\u5177\u6709\u4ee5\u4e0b\u5c6c\u6027\uff1a key - \u5c0f\u5143\u4ef6\u7684 key\uff0c\u5982\u5c0f\u5143\u4ef6\u8a2d\u5b9a\u4e2d\u5b9a\u7fa9\u7684\u3002 position - \u5982\u679c\u8a2d\u5b9a\uff0c\u5247\u6539\u8b8a\u5c0f\u5143\u4ef6\u5c07\u88ab\u6e32\u67d3\u7684\u4f4d\u7f6e\u3002 class - \u4e0d\u8981\u8207 HTML \u7684 class \u6df7\u6dc6\uff0c\u9019\u662f\u5305\u542b\u5c0f\u5143\u4ef6\u5b9a\u7fa9\u7684 PHP \u985e\u3002 title - \u7576\u4f7f\u7528 class \u5c6c\u6027\u6642\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528 title \u5c6c\u6027\u4f86\u8a2d\u7f6e\u5c0f\u5143\u4ef6\u7684\u6a19\u984c\u3002 \u7576\u4f7f\u7528 class \u5c6c\u6027\u6642\uff0c\u4f60\u4e5f\u53ef\u4ee5\u63d0\u4f9b\u5c0f\u5143\u4ef6\u7279\u5b9a\u7684\u9078\u9805\u4f5c\u70ba\u5c6c\u6027\u3002 Warning class \u6a19\u7c64\u4e0d\u80fd\u8207 key \u6a19\u7c64\u4e00\u8d77\u4f7f\u7528\u3002","title":"Widget \u6a19\u7c64"},{"location":"template-syntax/#useractivity","text":"\u6839\u64da\u7528\u6236\u4e0a\u4e00\u6b21\u64cd\u4f5c\u4ee5\u53ca\u8a72\u64cd\u4f5c\u767c\u751f\u7684\u6642\u9593\u4f86\u986f\u793a\u7528\u6236\u7684\u72c0\u614b\u3002 <xf:useractivity user=\"{$xf.visitor}\" /> UserActivity \u6a19\u7c64\u5177\u6709\u4ee5\u4e0b\u5c6c\u6027\uff1a user - \u7528\u6236\u986f\u793a\u7684\u72c0\u614b\u3002","title":"UserActivity \u6a19\u7c64"},{"location":"template-syntax/#_28","text":"\u67e5\u770b\u9801\u9762 \u6700\u65b0\u6848\u4f8b\u6a94\u6848 \u00b7 4\u5206\u9418\u524d \u683c\u5f0f\u70ba [\u6d3b\u52d5\u540d\u7a31] \u00b7 [\u6642\u9593]","title":"\u683c\u5f0f"},{"location":"template-syntax/#userbanners","text":"\u5728\u6c34\u5e73\u5217\u8868\u4e2d\u986f\u793a\u4f7f\u7528\u8005\u7684\u6a6b\u5e45\u3002 <xf:userbanners user=\"{$xf.visitor}\" /> UserBanners \u6a19\u7c64\u5177\u6709\u4ee5\u4e0b\u5c6c\u6027\uff1a user - \u986f\u793a\u8a72\u7528\u6236\u7684\u7528\u6236\u6a6b\u5e45\u3002","title":"UserBanners \u6a19\u7c64"},{"location":"template-syntax/#_29","text":"UserBanners \u6a19\u7c64\u7684\u793a\u4f8b\u7d50\u679c\u3002","title":"\u793a\u4f8b"},{"location":"template-syntax/#userblurb-tag","text":"\u986f\u793a\u7528\u6236\u500b\u4eba\u8cc7\u6599\u7684\u55ae\u884c\u6458\u8981\u3002 <xf:userblurb user=\"${xf.visitor}\" /> UserBlurb \u6a19\u7c64\u5177\u6709\u4ee5\u4e0b\u5c6c\u6027\uff1a user - \u986f\u793a XenForo \u4f7f\u7528\u8005\u5c0d\u8c61\u7684\u7c21\u4ecb\u3002","title":"UserBlurb tag"},{"location":"template-syntax/#_30","text":"FBI \u9867\u554f \u00b7 43 \u00b7 \u4f86\u81ea\u7f8e\u570b \u683c\u5f0f\u70ba [\u89d2\u8272 / \u81ea\u5b9a\u7fa9\u6a19\u984c] \u00b7 \u5e74\u9f61 \u00b7 \u4f4d\u7f6e","title":"\u683c\u5f0f"},{"location":"template-syntax/#username","text":"Displays the user's username, optionally with a tool-tip. \u986f\u793a\u7528\u6236\u7684\u7528\u6236\u540d\uff0c\u53ef\u9078\u64c7\u4f7f\u7528\u5de5\u5177\u63d0\u793a\u3002 \u986f\u793a\u7528\u6236\u7684\u7528\u6236\u540d\uff08\u53ef\u9078\uff09\u548c\u5de5\u5177\u63d0\u793a\u3002 <xf:username user=\"{$xf.visitor.username}\" notooltip=\"true\" /> Username \u6a19\u7c64\u5177\u6709\u4ee5\u4e0b\u5c6c\u6027\uff1a user - \u8981\u986f\u793a\u5176\u540d\u7a31\u7684 XenForo \u7528\u6236\u5c0d\u8c61\u3002 notooltip - \u662f\u5426\u95dc\u9589\u5de5\u5177\u63d0\u793a\u3002 href - \u9ede\u64ca\u7528\u6236\u540d\u6642\u6240\u5c0e\u5411\u5230\u7684\u9023\u7d50\u3002 Warning \u5982\u679c\u8a2d\u5b9a\u4e86 href \uff0c\u5247\u4e0d\u6703\u986f\u793a\u5de5\u5177\u63d0\u793a\uff0c\u56e0\u70ba\u5b83\u4e0d\u8d77\u4f5c\u7528\uff0c\u800c\u4e14\u53ef\u80fd\u6703\u8aa4\u5c0e\u4f7f\u7528\u8005\u3002","title":"Username \u6a19\u7c64"},{"location":"template-syntax/#usertitle","text":"Displays the user's title.\u986f\u793a\u4f7f\u7528\u8005\u7684\u982d\u929c\u3002 <xf:usertitle user=\"{$xf.visitor}\" /> UserTitle \u6a19\u7c64\u5177\u6709\u4ee5\u4e0b\u5c6c\u6027\uff1a user - \u6b64 XenForo \u7528\u6236\u7269\u4ef6\uff0c\u7528\u65bc\u986f\u793a\u7528\u6236\u982d\u929c\u3002","title":"UserTitle \u6a19\u7c64"},{"location":"template-syntax/#sectioned","text":"Sectioned \u6a19\u7c64\u5168\u90fd\u6703\u547c\u53eb\u51fd\u6578 modifySectionedHtml \u3002 \u5b83\u5011\u4fee\u6539\u7684 HTML \u5143\u7d20\u5c31\u662f\u6a19\u7c64\u540d\u7a31\u3002\u56e0\u6b64 sidebar \u6a19\u7c64\u6703\u4fee\u6539\u5074\u908a\u6b04\u7684 HTML \u7b49\u7b49\u3002","title":"Sectioned \u6a19\u7c64"},{"location":"template-syntax/#_31","text":"<xf:sidebar> <h1>\u6211\u7684\u795e\u5947\u5074\u908a\u6b04\uff01</h1> </xf:sidebar>","title":"\u793a\u4f8b"},{"location":"template-syntax/#_32","text":"mode - \u4fee\u6539\u6a21\u5f0f\u3002\uff08\u8acb\u53c3\u95b1\u4fee\u6539\u6a21\u5f0f\uff09","title":"\u5171\u540c\u5c6c\u6027"},{"location":"template-syntax/#_33","text":"\u9810\u8a2d\u60c5\u6cc1\u4e0b\uff0c\u4fee\u6539\u65b9\u5f0f\u70ba replace \u3002\uff08\u5373\uff0c\u5982\u679c\u6c92\u6709\u6307\u5b9a\u5c6c\u6027\u3002\uff09 prepend - \u5c07\u6a19\u7c64\u7684\u5167\u5bb9\u653e\u5728 HTML \u5143\u7d20\u7684\u958b\u982d\u3002 append - \u5c07\u6a19\u7c64\u7684\u5167\u5bb9\u653e\u5728 HTML \u5143\u7d20\u7684\u672b\u5c3e\u3002 replace - \u7528\u6a19\u7c64\u7684\u5167\u5bb9\u66ff\u63db HTML \u7684\u5143\u7d20\u3002","title":"\u4fee\u6539\u65b9\u5f0f"}]}